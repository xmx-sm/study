var wG=Object.defineProperty;var P2=(e,t)=>{if(t=Symbol[e])return t;throw Error("Symbol."+e+" is not defined")};var EG=(e,t,n)=>t in e?wG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var q=(e,t,n)=>(EG(e,typeof t!="symbol"?t+"":t,n),n),L2=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var B2=(e,t,n)=>(L2(e,t,"read from private field"),n?n.call(e):t.get(e)),Nx=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},O2=(e,t,n,s)=>(L2(e,t,"write to private field"),s?s.call(e,n):t.set(e,n),n);var M2=(e,t,n)=>(L2(e,t,"access private method"),n);var CG=function(e,t){this[0]=e,this[1]=t};var pf=e=>{var t=e[P2("asyncIterator")],n=!1,s,a={};return t==null?(t=e[P2("iterator")](),s=o=>a[o]=i=>t[o](i)):(t=t.call(e),s=o=>a[o]=i=>{if(n){if(n=!1,o==="throw")throw i;return i}return n=!0,{done:!1,value:new CG(new Promise(l=>{var c=t[o](i);if(!(c instanceof Object))throw TypeError("Object expected");l(c)}),1)}}),a[P2("iterator")]=()=>a,s("next"),"throw"in t?s("throw"):a.throw=o=>{throw o},"return"in t&&s("return"),a};import{i as XF,d as ue,a as os,v as Wc,j as r,c as fb,b as qe,r as y,S as kG,e as J_,f as TG,_ as vG,s as El,p as IG,g as Vv,h as Br,k as NG,l as jG,m as SG,n as DG,o as m,z as AG,q as An,t as KP,u as Ie,R as fn,w as js,x as Gu,y as RG,A as ll,P as PG,B as Pe,C as $v,D as LG,E as qn,F as Ps,G as Yn,H as wS,I as ol,T as BG,J as OG,K as MG,L as ka,M as Ls,N as YP,O as tm,Q as Hv,U as V1,V as _d,W as UG,X as ns,Y as nd,Z as sd,$ as If,a0 as qs,a1 as VG,a2 as $G,a3 as hp,a4 as HG,a5 as xk,a6 as zG,a7 as qG,a8 as GG,a9 as WG,aa as KG,ab as YG,ac as XG,ad as QG,ae as Ni,af as XP,ag as kn,ah as JG,ai as tc,aj as QP,ak as En,al as zv,am as Em,an as bu,ao as JP,ap as $t,aq as zf,ar as jo,as as Hp,at as yk,au as qv,av as ES,aw as ZG,ax as eW,ay as Jn,az as tW,aA as Fs,aB as bk,aC as nW,aD as Gv,aE as sW,aF as zp,aG as Wv,aH as ZP,aI as rW,aJ as Kv,aK as QF,aL as aW,aM as tu,aN as oW,aO as iW,aP as lW,aQ as cW,aR as dW,aS as eL,aT as tL,aU as qp,aV as JF,aW as nL,aX as ss,aY as uW,aZ as fW,a_ as Yv,a$ as mb,b0 as Fk,b1 as dc,b2 as sL,b3 as mW,b4 as $1,b5 as rL,b6 as nt,b7 as Mn,b8 as Xv,b9 as hb,ba as hW,bb as I_,bc as jx,bd as Xr,be as aL,bf as oL,bg as iL,bh as pW,bi as gW,bj as _W,bk as xW,bl as yW,bm as bW,bn as U2,bo as Z_,bp as Qv,bq as lL,br as xd,bs as FW,bt as wW,bu as Jv,bv as cL,bw as Mc,bx as Fu,by as Mr,bz as dL,bA as uL,bB as yd,bC as EW,bD as CW,bE as kW,bF as TW,bG as pp,bH as fL,bI as Zv,bJ as vW,bK as mL,bL as IW,bM as NW,bN as jW,bO as SW,bP as CS,bQ as ea,bR as Wn,bS as Is,bT as ti,bU as DW,bV as So,bW as AW,bX as RW,bY as PW,bZ as LW,b_ as BW,b$ as nm,c0 as Go,c1 as wk,c2 as Sx,c3 as OW,c4 as MW,c5 as ta,c6 as Jr,c7 as hL,c8 as pb,c9 as Zi,ca as UW,cb as pL,cc as VW,cd as $W,ce as HW,cf as zW,cg as qW,ch as GW,ci as WW,cj as KW,ck as Wu,cl as YW,cm as XW,cn as Es,co as QW,cp as H1,cq as e3,cr as JW,cs as ZW,ct as eK,cu as tK,cv as nK,cw as sK,cx as kS,cy as gL,cz as t3,cA as Dr,cB as rK,cC as aK,cD as _L,cE as z1,cF as n3,cG as q1,cH as oK,cI as e_,cJ as iK,cK as lK,cL as cK,cM as dK,cN as uK,cO as fK,cP as mK,cQ as hK,cR as pK,cS as gK,cT as e1,cU as yo,cV as _K,cW as xK,cX as yK,cY as bK,cZ as FK,c_ as wK,c$ as gf,d0 as EK,d1 as CK,d2 as kK,d3 as Ek,d4 as TK,d5 as vK,d6 as IK,d7 as NK,d8 as jK,d9 as SK,da as s3,db as xL,dc as DK,dd as bd,de as Cl,df as G1,dg as yL,dh as Ah,di as bL,dj as Rh,dk as TS,dl as vS,dm as AK,dn as RK,dp as FL,dq as PK,dr as r3,ds as LK,dt as BK,du as OK,dv as MK,dw as UK,dx as Dx,dy as jc,dz as VK,dA as $K,dB as HK,dC as Rr,dD as zK,dE as qK,dF as Ck,dG as GK,dH as wL,dI as EL,dJ as WK,dK as KK,dL as IS,dM as gb,dN as YK,dO as a3,dP as Gp,dQ as XK,dR as CL,dS as kL,dT as ZF,dU as ew,dV as tw,dW as kk,dX as TL,dY as vL,dZ as QK,d_ as JK,d$ as _b,e0 as ZK,e1 as IL,e2 as eY,e3 as tY,e4 as NL,e5 as nY,e6 as jL,e7 as sY,e8 as NS,e9 as rY,ea as jS,eb as Tk,ec as aY,ed as SL,ee as oY,ef as iY,eg as SS,eh as DL,ei as AL,ej as DS,ek as lY,el as RL,em as AS,en as cY,eo as _h,ep as dY,eq as uY,er as fY,es as mY,et as hY,eu as pY,ev as gY,ew as _Y,ex as xY,ey as yY,ez as RS,eA as PS,eB as bY,eC as FY,eD as zi,eE as wY,eF as EY,eG as CY}from"./vendor-2890c4d6.js";function KDe(){import("data:text/javascript,")}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();const nw=document.createElement("script");nw.src="https://lib.baomitu.com/mermaid/10.6.1/mermaid.min.js";nw.async=!0;nw.onerror=()=>{const e=document.createElement("script");e.src="https://cdn2.flowus.cn/emoji/mermaid.min.js",e.async=!0,document.head.append(e)};document.head.append(nw);const kY=()=>{try{return!1}catch(e){return!1}},Fi=()=>{try{return!1}catch(e){return!1}},TY=()=>{try{return!1}catch(e){return!1}},vY=()=>{try{return!1}catch(e){return!1}},Pf=()=>{var e,t;try{return(t=(e=import.meta)==null?void 0:e.env)!=null&&t.VITE_CDN_HOST||Fi()?"https://cdn.buildin.ai/":"https://cdn2.flowus.cn/"}catch(n){return""}},t1={isBuildIn:Fi(),cdnHost:Pf(),languageIsZh:TY()},IY=e=>{Object.assign(t1,e)},es=e=>new Promise(t=>{setTimeout(t,e)});let Wp=class{constructor(){q(this,"resolve");q(this,"reject");q(this,"promise",new Promise((t,n)=>{this.resolve=t,this.reject=n}))}};var Kp=(e=>(e.PASSWORD="psw",e.INVITE_CODE="invite-code",e.SHARE_INVITE_CODE="share-invite-code",e.SHARE_INVITE_PAGE_ID="share-invite-page-id",e.FROM_CREATE_SPACE="from-create-space",e.WECHAT_PAY_INFO="wechat-pay-info",e))(Kp||{});const o3=e=>{const t=sessionStorage.getItem(e);if(t!==null)return t},sw=(e,t)=>{sessionStorage.setItem(e,"".concat(t))},QDe=e=>{sessionStorage.removeItem(e)},i3={inviteCode:{get:()=>o3("invite-code"),set:e=>sw("invite-code",e)}};var Lf=(e=>(e.callbackPath="from",e.inviteCode="code",e.inviteTeam="team",e.page="page",e.inviteCodeByWeChat="invite_code",e.cooperate="cooperate",e.teamApplyCode="teamApplyCode",e.promotionChannel="promotionChannel",e.password="psw",e.quickRegister="quick-register",e.spaceId="space_id",e.openDialog="open",e.exChangeCode="exChangeCode",e.id="id",e.oss="oss",e.schemaId="sid",e.embed="embed",e.subscribe="subscribe",e.aiType="ai_type",e.searchAncestorId="search_ancestor_id",e.defaultPrompt="default_prompt",e.openAI="open_ai",e.pageId="page_id",e.hint="hint",e))(Lf||{});const gs=new Proxy({check:!1},{get:()=>!!(XF&&W1())}),W1=()=>{const{flowUsIpcRenderer:e}=window;return e},NY=1024,N_=NY*1024,LS="cm@allflow.cn";var Nt=(e=>(e.login="/login/",e.create="/create/",e.preview="/preview/",e.share="/share/",e.form="/form/",e.main="/",e.notFoundPage="/404",e.product="/product",e.callback="/callback",e.subscribe="/subscribe/share/",e.notion="/notion",e.pricing="/pricing",e.template="/template",e.download="/download",e))(Nt||{});const{VITE_CONTACT_ADMIN_LINK:JDe="",VITE_PUBLIC_LINK:BS,VITE_URL_SPLIT_TEXT:jY,VITE_PREFIX:Jh,VITE_WECHAT_ACCOUNT:SY}={VITE_DOCUMENT_TITLE:"FlowUs 息流｜一站式知识创作与发布平台",VITE_OSS_CDN_HOST:"https://cdn2.flowus.cn/",VITE_ENV:"production",VITE_VOLCENGINE_TRACK_ID:"303823",VITE_URL_SPLIT_TEXT:"【FlowUs 息流】",VITE_WECHAT_ACCOUNT:"wx1736ff051cca370b",VITE_NOTION_CLIENT_ID:"f843d557-50d6-4110-b05c-6e60029bd338",VITE_PRODUCT_ALL_NAME:"FlowUs 息流",VITE_TEMPLATE_ID:"6a4efea1-e023-4e99-bb69-d69af5909412",VITE_OSS_UPLOAD_URL:"https://oss.flowus.com.cn",VITE_PREFIX:"https://flowus.cn",VITE_WECHAT_APP_ID:"wx7de87594073bf09f",VITE_GIT_COMMIT:"582aec734b7f0b024b82d1a8b60184f8ae9ec2c7",VITE_IMPORTANT_FEATURE_COLLECTION_ID:"6fcef75c-2637-42e8-86d7-2d59bdef4807",VITE_PRODUCT_AI_NAME:"FlowUs AI",VITE_SUBSCRIBE_ID:"6301204f-7892-47c8-9a6a-d34f5c6a8855",VITE_DESCRIPTION:"使用 Flowus 构建您的知识平台，助您轻松创作与发布",VITE_WPS_KEY:"SX20231127MUOIEW",VITE_BUCKET:"flowus-1316188996",VITE_CDN_HOST:"https://cdn2.flowus.cn/",VITE_AD_COLLECTION_ID:"d103bcd6-5712-4aa4-8c03-385add1f2391",VITE_PRODUCT_NAME:"FlowUs",VITE_SERVICE_CENTER_COLLECTION_ID:"14620f35-b0be-4d28-8a10-f3ae4809af43|e077dd8f-a2d7-46e6-a97e-3167cf8665e0",BASE_URL:"https://cdn2.flowus.cn/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,LEGACY:!1},DY=()=>{try{return jY}catch(e){return" "}},gp=DY();var Kl=(e=>(e.splitView="splitView",e.code="code",e.preview="preview",e))(Kl||{}),$c=(e=>(e.lxgwWenKai='"LXGW WenKai", serif',e.sourceHanSerif="source-han-serif-sc-regular, SimSun, serif",e.lora="b-lora",e.DMMono="b-DMMono",e))($c||{});const Al=t1.isBuildIn&&!t1.languageIsZh,Wa={isEmpty:Al?"未填写_empty":"未填写",countEmpty:Al?"未填写_count_empty":"未填写",countNotEmpty:Al?"已填写_Count_not_empty":"已填写",isNotEmpty:Al?"已填写_Is_not_empty":"已填写",embedWebPage:Al?"嵌入网页_Create_embed":"嵌入网页",fixedWidth:Al?"固定宽度_Fixed_width":"固定宽度",fixed:"固定宽度",pageFont:Al?"默认字体_Page_font":"默认字体",linkToPage:Al?"引用页面_Link_to_page":"引用页面",yearly:Al?"年_ly":"年",monthly:Al?"月_ly":"月",count:"总数"},AY=["allflow.space"],l3=e=>{try{return AY.includes(location.hostname||"")?location.hostname:e}catch(t){return""}},RY=l3(Jh!=null?Jh:""),PL=(e=l3(RY))=>{const t={userAgreement:"".concat(e,"/share/51171168-3fcb-4b14-b359-53a58380da4c"),privacyPolicy:"".concat(e,"/share/29651bee-1323-4f0a-a9ba-535832469fe0"),product:"".concat(e,"/product"),pricing:"".concat(e,"/pricing"),appDownload:"".concat(e,"/download"),helpCenter:"".concat(e,"/share/e68380be-23cf-42c4-9b95-23a52713213d"),shortcut:"".concat(e,"/share/c19d16ae-56f0-4e29-bc20-f46302eeebfc"),shortcutCommand:"".concat(e,"/share/401e6d4a-ded8-4e23-a874-a1c30a5928d7"),paidServices:"".concat(e,"/share/734ccb8d-760d-4792-8c89-2d644dbe24d9"),integralRule:"".concat(e,"/share/c7e03855-8742-4453-abea-ab0625209955"),helperShare:"".concat(e,"/share/478fbe3f-8074-48ac-9357-6f0af02b894b"),problemFeedback:"".concat(e,"/form/a5ed5933-cf92-4c65-9bb1-d2ea974a5aaa"),updateLog:"".concat(e,"/share/b30dd458-7fb9-4e29-b5ed-e09274465c34"),applySchool:"".concat(e,"/form/42f08dfb-dc06-4582-bb8e-8385bdc6a3af"),authentication:"".concat(e,"/auth/school"),applyInvoice:"".concat(e,"/form/0fd2831b-2793-443a-95c3-2a753c0ecef0a"),learnMore:"".concat(e,"/share/19cc8990-ac51-43c9-9144-36cb7c09f9c9"),weChatClipper:"".concat(e,"/share/74fbd0eb-1255-484d-b9a1-a0bafd6be4c6"),cyclePlan:"".concat(e,"/share/7803ae51-aa1d-4d28-a8d6-6bbdbf42ab49"),importGuest:"".concat(e,"/share/8172adf1-bbe4-4d1f-99b9-8bbda920d5d9"),videoTeaching:"".concat(e,"/share/5b6ba2f7-f332-4d9b-a283-c0443b683646"),quoteSuggestion:"".concat(e,"/share/34d1188d-04b2-4502-a732-ae3b6ec69fb1"),quotePage:"".concat(e,"/share/c15b6489-60ba-480e-a84b-ad28f9a3f694"),templateContribution:"".concat(e,"/share/4ac3f00d-02db-4b24-aaed-48a19ceff78f"),campusMaster:"".concat(e,"/share/fe31151c-da91-4cab-9ec5-610df0ca480a"),importFromNotion:"".concat(e,"/share/7d5a2460-c632-401b-9880-a672565047e0#9ed2ef68-7345-4fb8-af9a-d1bc49f5df77"),howToImport:"".concat(e,"/share/7d5a2460-c632-401b-9880-a672565047e0"),templateFeedback:"".concat(e,"/share/185ba39c-721a-4088-8dda-7c6815e72cdb"),ai:"".concat(e,"/ai"),aiTerms:"".concat(e,"/share/55698213-8c16-4710-a147-2279853aa133"),dataPanel:"".concat(e,"/share/1af3d985-f43f-4ca0-b575-87ac8d1983e6"),shareDataPanel:"".concat(e,"/share/478fbe3f-8074-48ac-9357-6f0af02b894b"),collaborateInfo:"".concat(e,"/share/a84fff54-ca15-4516-8959-e1b50890dde0"),recommendSubscribe:"".concat(e,"/form/1b02734c-3a67-4dca-8e0b-284df5df6159"),distribution:"".concat(e,"/distribution"),invitePage:"".concat(e,"/share/a84fff54-ca15-4516-8959-e1b50890dde0"),sharePageLink:"".concat(e,"/share/478fbe3f-8074-48ac-9357-6f0af02b894b"),shareFormLink:"".concat(e,"/share/6e310b4f-cf88-4a02-8092-1a6a7b0240e0"),bitableLink:"".concat(e,"/share/689e1d3e-04ab-4388-bba4-8e6085b15b26"),tableViewLink:"".concat(e,"/share/e3041662-4374-4169-b5a8-60347781b879"),boardViewLink:"".concat(e,"/share/8646a5e1-ba30-4de4-8c40-03842dbf7bb3"),galleryViewLink:"".concat(e,"/share/875d347e-10e6-43c0-bed2-f56764946f2f"),listViewLink:"".concat(e,"/share/d6926b36-62cf-4f65-95d8-5af9550ac6c8"),timeViewLink:"".concat(e,"/share/e2d0c9d4-ca1d-4993-a2ab-ed75ff3cf86c"),calendarViewLink:"".concat(e,"/share/09b243c8-d310-4230-9a8a-882af611b281"),formViewLink:"".concat(e,"/share/3f4e57ad-ecdc-4a48-877a-519484cfaf09"),cancelAccount:"".concat(e,"/share/3c4d3d0e-f0d3-4ed3-a70c-ee0e7d44ae7d"),upgradeSpace:"".concat(e,"/share/769d984e-40b0-416b-9046-573439737dd0"),yzh:"".concat(e,"/share/0eb789dc-9634-4e91-84f8-2ff76b22b2e0"),creator:"".concat(e,"/share/eee6a7e5-e574-4efb-8991-c4aad9398999"),rebateRule:"".concat(e,"/share/889a74e8-8eeb-4db0-8f19-e8254e547bcc"),subscribeCenter:"".concat(e,"/subscribecenter"),subScribeDefaultPage:"".concat(e,"/share/93f01b87-fb24-4153-a021-d0a35b22ad71"),subscribeRule:"".concat(e,"/share/b9074bd9-6681-4ab8-800a-1045dd406234"),mySubscribePage:"/subscribe/share",quickRegister:"/login?quick-register=true"},n={userAgreement:"".concat(e,"/share/2120db09-65bd-46af-92c8-a13351a6844d"),privacyPolicy:"".concat(e,"/share/4ab3ac80-08b5-4796-a7b6-46db637630d3"),helpCenter:"".concat(e,"/share/ed00d504-90ac-4a3c-9914-2a7edf841d7a"),shortcut:"".concat(e,"/share/a96f6a1a-6f9b-463f-ac93-3ac4a642d329"),shortcutCommand:"".concat(e,"/share/4b0388a6-48a9-4328-b183-b7a63a8ff9b8"),paidServices:"".concat(e,"/share/2733e0cc-6c6a-423d-9740-296427b702f5"),updateLog:"".concat(e,"/share/c7488479-8b1e-4318-9b11-2f6b86378999"),learnMore:"/product",marketingProgramParticipantTerms:"".concat(e,"/share/da6dbbb4-d847-484b-8cc2-4159c57939a2"),aiSupplementaryTerms:"".concat(e,"/share/b8a645b4-e528-4a8a-b203-2e9c1a124c73"),importFromNotion:"".concat(e,"/share/af6d500a-6115-4fdb-a6ba-75e3588866f1#dfb6eca8-d77c-48bd-96b1-b5d42df38756"),howToImport:"".concat(e,"/share/af6d500a-6115-4fdb-a6ba-75e3588866f1"),tgLink:"https://t.me/+Dlt2PzXnphc5MjE1",ambassador:"".concat(e,"/form/e8258769-098f-4789-a003-bc91c0abb15e"),xLink:"https://x.com/buildinofficial"},s=Fi()?{...t,...n}:{...n,...t};if(BS)for(const a in s)os(s,{[a]:BS});if(gs.check)for(const a in s)["subscribeCenter","mySubscribePage"].includes(a)||os(s,{[a]:"".concat(s[a],"?out=true")});return{publicLink:s,buildInPublicLink:n}},vk=PL().publicLink,PY=8,LY=1,BY=5,Ax="x-oss-process",OY=3*24*60*60*1e3,MY=7*24*60*60*1e3,UY="AIzaSyB4kwyAIJ_DuPdyJX7N8VZfrBUMdygoAJ0",OS=ue(),VY=ue("2024-11-24"),$Y=ue("2024-12-6");OS.isAfter(VY)&&OS.isBefore($Y);const Uc=1,HY=()=>{const{pathname:e}=location;return e.split("/").find(Wc)},LL=(e,t)=>{const n=new URLSearchParams(location.search);t=t||HY(),e=e||n.get(Lf.inviteCodeByWeChat)||n.get(Lf.inviteCode),e&&e.length<PY&&i3.inviteCode.set(e),t&&sw(Kp.SHARE_INVITE_PAGE_ID,t)},zY={background:"linear-gradient(0deg, var(--grey8), var(--grey8)), var(--grey9)"},Kc={background:"linear-gradient(0deg, var(--white1), var(--white1)), var(--grey8)",boxShadow:"0px 4px 9.6px rgba(0, 0, 0, 0.12)",border:"1px solid var(--white2)"},Zh={id1:"absolute rounded-sm left-2 top-3 w-[128px] h-[96px] rotate-[-13deg] z-[3]",id2:"absolute rounded-sm left-[76px] top-[20px] w-[128px] h-[96px] rotate-[-16deg] z-[2]",id3:"absolute rounded-sm left-[136px] top-[-21px] w-[128px] h-[96px] rotate-[-9.30deg] z-[1]"},BL=Fi()?'ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"':"my-quote ui-sans-serif, -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica,'Apple Color Emoji', Arial, sans-serif, 'Segoe UI Emoji', 'Segoe UI Symbol'",OL=()=>{const e=document.createElement("style");let t="";Fi()?t="\n    html {\n      font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Helvetica, \"Apple Color Emoji\", Arial, sans-serif, \"Segoe UI Emoji\", \"Segoe UI Symbol\";\n    }\n\n    :root {\n      --loadingIcon: url('https://cdn.buildin.ai/assets/loading.svg');\n      --eraser-url: url('https://cdn.buildin.ai/assets/eraser.svg');\n      --pen-url: url('https://cdn.buildin.ai/assets/pen.svg');\n    }\n\n    /* --------- lora ---------- */\n    /* cyrillic-ext */\n    @font-face {\n      font-family: 'b-lora';\n      font-style: normal;\n      font-weight: 400;\n      font-display: swap;\n      src: url(https://fonts.gstatic.com/s/lora/v32/0QI6MX1D_JOuGQbT0gvTJPa787weuxJMkq18ndeYxZ2JTg.woff2)\n        format('woff2');\n      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;\n    }\n    /* cyrillic */\n    @font-face {\n      font-family: 'b-lora';\n      font-style: normal;\n      font-weight: 400;\n      font-display: swap;\n      src: url(https://fonts.gstatic.com/s/lora/v32/0QI6MX1D_JOuGQbT0gvTJPa787weuxJFkq18ndeYxZ2JTg.woff2)\n        format('woff2');\n      unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;\n    }\n    /* vietnamese */\n    @font-face {\n      font-family: 'b-lora';\n      font-style: normal;\n      font-weight: 400;\n      font-display: swap;\n      src: url(https://fonts.gstatic.com/s/lora/v32/0QI6MX1D_JOuGQbT0gvTJPa787weuxJOkq18ndeYxZ2JTg.woff2)\n        format('woff2');\n      unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0,\n        U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;\n    }\n    /* latin-ext */\n    @font-face {\n      font-family: 'b-lora';\n      font-style: normal;\n      font-weight: 400;\n      font-display: swap;\n      src: url(https://fonts.gstatic.com/s/lora/v32/0QI6MX1D_JOuGQbT0gvTJPa787weuxJPkq18ndeYxZ2JTg.woff2)\n        format('woff2');\n      unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB,\n        U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n    }\n    /* latin */\n    @font-face {\n      font-family: 'b-lora';\n      font-style: normal;\n      font-weight: 400;\n      font-display: swap;\n      src: url(https://fonts.gstatic.com/s/lora/v32/0QI6MX1D_JOuGQbT0gvTJPa787weuxJBkq18ndeYxZ0.woff2)\n        format('woff2');\n      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304,\n        U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF,\n        U+FFFD;\n    }\n    /* --------- lora ---------- */\n\n    /* --------- DMMono ---------- */\n    /* cyrillic-ext */\n    @font-face {\n      font-family: 'b-DMMono';\n      font-style: normal;\n      font-weight: 400;\n      font-display: swap;\n      src: url(https://fonts.gstatic.com/s/robotomono/v23/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SeW4AJi8SJQtQ4Y.woff2)\n        format('woff2');\n      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;\n    }\n    /* cyrillic */\n    @font-face {\n      font-family: 'b-DMMono';\n      font-style: normal;\n      font-weight: 400;\n      font-display: swap;\n      src: url(https://fonts.gstatic.com/s/robotomono/v23/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_QOW4AJi8SJQtQ4Y.woff2)\n        format('woff2');\n      unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;\n    }\n    /* greek */\n    @font-face {\n      font-family: 'b-DMMono';\n      font-style: normal;\n      font-weight: 400;\n      font-display: swap;\n      src: url(https://fonts.gstatic.com/s/robotomono/v23/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_R-W4AJi8SJQtQ4Y.woff2)\n        format('woff2');\n      unicode-range: U+0370-03FF;\n    }\n    /* vietnamese */\n    @font-face {\n      font-family: 'b-DMMono';\n      font-style: normal;\n      font-weight: 400;\n      font-display: swap;\n      src: url(https://fonts.gstatic.com/s/robotomono/v23/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_S-W4AJi8SJQtQ4Y.woff2)\n        format('woff2');\n      unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0,\n        U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;\n    }\n    /* latin-ext */\n    @font-face {\n      font-family: 'b-DMMono';\n      font-style: normal;\n      font-weight: 400;\n      font-display: swap;\n      src: url(https://fonts.gstatic.com/s/robotomono/v23/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SuW4AJi8SJQtQ4Y.woff2)\n        format('woff2');\n      unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB,\n        U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n    }\n    /* latin */\n    @font-face {\n      font-family: 'b-DMMono';\n      font-style: normal;\n      font-weight: 400;\n      font-display: swap;\n      src: url(https://fonts.gstatic.com/s/robotomono/v23/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_ROW4AJi8SJQt.woff2)\n        format('woff2');\n      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304,\n        U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF,\n        U+FFFD;\n    }\n    /* --------- DMMono ---------- */\n    ":t="\n    @import url('https://npm.elemecdn.com/lxgw-wenkai-webfont/lxgwwenkai-regular.css');\n    @import url('".concat(Pf(),"emoji/source-han-serif-regular/style.css');\n\n    html {\n      font-family: 'my-quote', 'PingFang SC', 'Microsoft YaHei', ui-sans-serif, -apple-system,\n      BlinkMacSystemFont, 'Segoe UI', Helvetica, Helvetica, 'Apple Color Emoji', Arial, sans-serif,\n      'Segoe UI Emoji', 'Segoe UI Symbol';\n    }\n\n    :root {\n      --loadingIcon: url('").concat(Pf(),"assets/loading.svg');\n      --eraser-url: url('").concat(Pf(),"assets/eraser.svg');\n      --pen-url: url('").concat(Pf(),"assets/pen.svg');\n    }\n    "),e.innerHTML=t,document.head.appendChild(e)};var dn=(e=>(e.callbackPath="from",e.inviteCode="code",e.inviteTeam="team",e.page="page",e.inviteCodeByWeChat="invite_code",e.cooperate="cooperate",e.teamApplyCode="teamApplyCode",e.promotionChannel="promotionChannel",e.password="psw",e.quickRegister="quick-register",e.spaceId="space_id",e.openDialog="open",e.exChangeCode="exChangeCode",e.id="id",e.oss="oss",e.schemaId="sid",e.embed="embed",e.subscribe="subscribe",e.aiType="ai_type",e.searchAncestorId="search_ancestor_id",e.defaultPrompt="default_prompt",e.openAI="open_ai",e.pageId="page_id",e.hint="hint",e))(dn||{});const ZDe="请输入邀请码（必填）",eAe="请输入邀请码领取额外积分（选填）",{VITE_PRODUCT_NAME:tAe}={VITE_DOCUMENT_TITLE:"FlowUs 息流｜一站式知识创作与发布平台",VITE_OSS_CDN_HOST:"https://cdn2.flowus.cn/",VITE_ENV:"production",VITE_VOLCENGINE_TRACK_ID:"303823",VITE_URL_SPLIT_TEXT:"【FlowUs 息流】",VITE_WECHAT_ACCOUNT:"wx1736ff051cca370b",VITE_NOTION_CLIENT_ID:"f843d557-50d6-4110-b05c-6e60029bd338",VITE_PRODUCT_ALL_NAME:"FlowUs 息流",VITE_TEMPLATE_ID:"6a4efea1-e023-4e99-bb69-d69af5909412",VITE_OSS_UPLOAD_URL:"https://oss.flowus.com.cn",VITE_PREFIX:"https://flowus.cn",VITE_WECHAT_APP_ID:"wx7de87594073bf09f",VITE_GIT_COMMIT:"582aec734b7f0b024b82d1a8b60184f8ae9ec2c7",VITE_IMPORTANT_FEATURE_COLLECTION_ID:"6fcef75c-2637-42e8-86d7-2d59bdef4807",VITE_PRODUCT_AI_NAME:"FlowUs AI",VITE_SUBSCRIBE_ID:"6301204f-7892-47c8-9a6a-d34f5c6a8855",VITE_DESCRIPTION:"使用 Flowus 构建您的知识平台，助您轻松创作与发布",VITE_WPS_KEY:"SX20231127MUOIEW",VITE_BUCKET:"flowus-1316188996",VITE_CDN_HOST:"https://cdn2.flowus.cn/",VITE_AD_COLLECTION_ID:"d103bcd6-5712-4aa4-8c03-385add1f2391",VITE_PRODUCT_NAME:"FlowUs",VITE_SERVICE_CENTER_COLLECTION_ID:"14620f35-b0be-4d28-8a10-f3ae4809af43|e077dd8f-a2d7-46e6-a97e-3167cf8665e0",BASE_URL:"https://cdn2.flowus.cn/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,LEGACY:!1},qY=e=>{const t=new URLSearchParams(location.search);e=e||t.get(dn.promotionChannel),e&&localStorage.setItem(dn.promotionChannel,JSON.stringify({promotionChannel:e,time:Date.now()}))},nAe=()=>{const e=localStorage.getItem(dn.promotionChannel);if(e){const t=JSON.parse(e),n=t.time;if(Date.now()-n<=30*24*60*60*1e3)return t.promotionChannel;GY()}},GY=()=>{localStorage.removeItem(dn.promotionChannel)},Zt={cdnHost:"https://cdn2.flowus.cn/",event:()=>{},message:{success:()=>{},error:()=>{},warning:()=>{}},request:{},setBrowserTitle:()=>{},EmojiIcon:e=>{var t;return r.jsx("div",{className:"flex items-center emoji",style:{fontSize:(t=e.size)!=null?t:24},children:e.value})},afterLogin:()=>{},wechatId:"",origin:"https://flowus.cn",cx:fb},WY=e=>{var t,n,s;e.cdnHost&&(Zt.cdnHost=e.cdnHost),e.event&&(Zt.event=e.event),(t=e.message)!=null&&t.success&&(Zt.message.success=e.message.success),(n=e.message)!=null&&n.error&&(Zt.message.error=e.message.error),(s=e.message)!=null&&s.warning&&(Zt.message.warning=e.message.warning),e.request&&(Zt.request=e.request),e.setBrowserTitle&&(Zt.setBrowserTitle=e.setBrowserTitle),e.EmojiIcon&&(Zt.EmojiIcon=e.EmojiIcon),e.afterLogin&&(Zt.afterLogin=e.afterLogin),e.wechatId&&(Zt.wechatId=e.wechatId),e.origin&&(Zt.origin=e.origin),e.cx&&(Zt.cx=e.cx)},rw=(...e)=>Zt.cx(e),KY="userId",YY="code",XY="state",sAe="wc",QY="/auth-callback",JY="/pay-access",qf=(e,t="flowus",n=!0)=>{const s=kG.hash(e+t);return n?s.toUpperCase():s},ca={Email:/[\w!#$%&'*+/=?^_`{|}~-]+(?:\.[\w!#$%&'*+/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?$/,Mobile:/^1[3456789]\d{9}$/,Password:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d!@#$%^&*()_+-~|\\}\\{\\"\\:\\?\\>\\<,.;'\\[\]]{6,16}$/,VerifyCode:/^[0-9]{6}$/},ML=qe();function Qn(e){return new Proxy({},{get(t,n){return y.lazy(()=>e().then(s=>({default:s[n]})))}})}const Ik=e=>new Promise(t=>{setTimeout(t,e)}),ZY="https://flowus.cn/share/c7e03855-8742-4453-abea-ab0625209955",rAe=()=>navigator.userAgent.toLowerCase().indexOf("micromessenger")!==-1,xb=()=>window.__wxjs_environment==="miniprogram",UL="fl_account",aAe=e=>{sessionStorage.setItem(UL,e)},oAe=()=>{sessionStorage.setItem(UL,"")},eX=()=>XF?{x_device_type:"desktop",x_platform:J_?"mac":"windows",platform:J_?"mac":"windows"}:{x_device_type:"web",x_platform:"web",platform:"web"},iAe=(e="")=>e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"),lAe="791725156680-k9ltfk4l1d91b5sieoj3m6vj7hv2igdq.apps.googleusercontent.com",yn=TG,In=vG,hi=(e,t)=>{if(typeof e=="object"&&e!==null&&typeof t=="object"&&t!==null){const n=Object.keys(e).filter(a=>e[a]!==void 0),s=Object.keys(t).filter(a=>t[a]!==void 0);if(n.sort(),s.sort(),!El(n,s))return!1;for(const a of n)if(!hi(e[a],t[a]))return!1;return!0}return yn(e,t)},Fd=e=>new Proxy({},{get:(n,s)=>Reflect.get(e.getState(),s)}),K1=(e,t,n)=>{const s="default",a=IG(t,{name:"persist:".concat(s,"-").concat(e)});return Vv(a)},Aa=e=>Vv(e),Qs=(e,t)=>(n,s)=>{const a=e.getState(),o=n instanceof Function?n(Br(a)):n;let i=o;t!=null&&t.assign&&!(s!=null&&s.replaceAll)&&(i={...a,...o}),s!=null&&s.replace||s!=null&&s.replaceAll?e.setState(i,!0):In(i,a)||e.setState(i)},tX=e=>{localStorage.setItem("persist-key",e)},nX=e=>{localStorage.setItem("persist-key-space",e)},sX="#2EA9DF",rX="#00AA90",aX="#1B813E",oX="#FFC408",iX="#F98B2A",lX="#CB4042",cX="#DB4D6D",dX="#C1328E",uX="#6A4C9C",fX="#005CAF",mX="#18A0FB",hX="#74673E",pX="#A2A4A6",gX="#000000",_X="#000000",xX="#000000",yX="#000000",bX="#333333",FX="#5F5E5B",wX="#91918E",EX="#BDBDBD",CX="#E0E0E0",kX="#E5E5E5",TX="#F0F0F0",vX="#F5F5F5",IX="#F7F7F7",NX="#FFFFFF",jX="#FFFFFF",SX="#FFFFFF",DX="#FFFFFF",AX="#FFFFFF",RX="#FFFFFF",PX="rgba(24,160,251,0.1)",LX="rgba(0,0,0,0.03)",BX="rgba(0,0,0,0.06)",OX="#FFFCBF",MX="#D1FFF0",UX="#CCF0FF",VX="#E5DAFF",$X="#FFD3D3",HX="#37352F",zX={black:"#d4d4d4",black1:"#252525",black2:"#2E2E2E",black3:"#A0A0A0",grey1:"#a3a3a3",grey2:"#A0A0A0",grey3:"#717171",grey4:"#595959",grey5:"#363636",grey6:"#2E2E2E",grey7:"#2E2E2E",grey8:"#1E1E1E",grey9:"#252525",white:"#D1D1D1",white1:"#191919",white2:"#202020",white3:"#252525",white4:"#2E2E2E",white5:"#363636",active_color:"#178BD8",active_color_10:"rgba(23,139,216,0.15)",black_003:"rgba(255,255,255,0.03)",black_006:"rgba(255,255,255,0.06)",light_yellow:"#675700",light_green:"#233D29",light_blue:"#253E5A",light_purple:"#322B62",light_red:"#4F2828",normal:"#d4d4d4"},Do={blue:sX,green_blue:rX,green:aX,yellow:oX,orange:iX,red:lX,pink:cX,pink_purple:dX,purple:uX,blue_cobalt:fX,active_color:mX,brown:hX,grey:pX,black:gX,black1:_X,black2:xX,black3:yX,grey1:bX,grey2:FX,grey3:wX,grey4:EX,grey5:CX,grey6:kX,grey7:TX,grey8:vX,grey9:IX,white:NX,white1:jX,white2:SX,white3:DX,white4:AX,white5:RX,active_color_10:PX,black_003:LX,black_006:BX,light_yellow:OX,light_green:MX,light_blue:UX,light_purple:VX,light_red:$X,normal:HX,"black-base":"#000000","black1-base":"#000000","black2-base":"#000000","black3-base":"#000000","grey1-base":"#333333","grey2-base":"#5F5E5B","grey3-base":"#91918E","grey4-base":"#BDBDBD","grey5-base":"#E0E0E0","grey6-base":"#E5E5E5","grey7-base":"#F0F0F0","grey8-base":"#F5F5F5","grey9-base":"#F7F7F7","white-base":"#FFFFFF","white1-base":"#FFFFFF","white2-base":"#FFFFFF","white3-base":"#FFFFFF","white4-base":"#FFFFFF","white5-base":"#FFFFFF","active_color-base":"#18A0FB","active_color_10-base":"rgba(24,160,251,0.1)","black_003-base":"rgba(0,0,0,0.03)","black_006-base":"rgba(0,0,0,0.06)","light_yellow-base":"#FFFCBF","light_green-base":"#D1FFF0","light_blue-base":"#CCF0FF","light_purple-base":"#E5DAFF","light_red-base":"#FFD3D3","normal-base":"#37352F",dark:zX},qX={".text-line-height":{lineHeight:"var(--common-line-height)"},".text-t0":{fontWeight:"400",fontSize:"22px",lineHeight:"var(--text-t0-line-height)"},".text-t0-medium":{fontWeight:"450",fontSize:"22px",lineHeight:"var(--text-t0-line-height)"},".text-t0-1":{fontWeight:"400",fontSize:"18px",lineHeight:"var(--text-t0-1-line-height)"},".text-t0-1-medium":{fontWeight:"500",fontSize:"18px",lineHeight:"var(--text-t0-1-line-height)"},".text-t1":{fontWeight:"400",fontSize:"16px",lineHeight:"var(--text-t1-line-height)"},".text-t1-medium":{fontSize:"16px",lineHeight:"var(--text-t1-line-height)",fontWeight:"500"},".text-t1-bold":{fontSize:"16px",lineHeight:"var(--text-t1-line-height)",fontWeight:"600"},".text-t2":{fontWeight:"400",fontSize:"14px",lineHeight:"var(--text-t2-line-height)"},".text-t2-medium":{fontSize:"14px",lineHeight:"var(--text-t2-line-height)",fontWeight:"500"},".text-t2-bold":{fontSize:"14px",lineHeight:"var(--text-t2-line-height)",fontWeight:"600"},".text-t3":{fontWeight:"400",fontSize:"13px",lineHeight:"var(--text-t3-line-height)"},".text-t3-medium":{fontSize:"13px",lineHeight:"var(--text-t3-line-height)",fontWeight:"500"},".text-t3-bold":{fontSize:"13px",lineHeight:"var(--text-t3-line-height)",fontWeight:"600"},".text-t4":{fontWeight:"400",fontSize:"12px",lineHeight:"var(--text-t4-line-height)"},".text-t4-medium":{fontSize:"12px",lineHeight:"var(--text-t4-line-height)",fontWeight:"500"},".text-t4-bold":{fontSize:"12px",lineHeight:"var(--text-t4-line-height)",fontWeight:"600"},".text-t5":{fontWeight:"400",fontSize:"12px",lineHeight:"var(--text-t5-line-height)"},".text-t5-medium":{fontSize:"12px",lineHeight:"var(--text-t5-line-height)",fontWeight:"500"},".text-t5-bold":{fontSize:"12px",lineHeight:"var(--text-t5-line-height)",fontWeight:"600"},".text-h0":{fontSize:"40px",lineHeight:"var(--text-h0-line-height)",fontWeight:"600"},".text-h1":{fontSize:"30px",lineHeight:"var(--text-h1-line-height)",fontWeight:"600"},".text-h2":{fontSize:"24px",lineHeight:"var(--text-h2-line-height)",fontWeight:"600"},".text-h3":{fontSize:"20px",lineHeight:"var(--text-h3-line-height)",fontWeight:"600"},".text-h4":{fontSize:"18px",lineHeight:"var(--text-h4-line-height)",fontWeight:"600"}},jy={};Object.keys(jy).forEach(e=>{const t=Object.keys(jy[e]);jy[e]=t});const GX=NG({theme:{...jy,colors:Object.keys(Do)},classGroups:{text:Object.keys(qX).map(e=>e.replace(".","")),fontFace:["text-mono"]}}),R=(...e)=>GX(fb(e)),rd=y.createContext(void 0),Ne=()=>{const e=y.useContext(rd);if(!e)throw new Error("useBitable");return e},WX=({className:e})=>r.jsx("svg",{viewBox:"0 0 16 16",className:R("fill-current inline",e),children:r.jsx("path",{d:"M3.86426 14.0459H5.32715C5.45475 14.0459 5.56185 14.0892 5.64844 14.1758L6.6875 15.2148C7.13411 15.6615 7.56934 15.8825 7.99316 15.8779C8.42155 15.8779 8.85677 15.6569 9.29883 15.2148L10.3379 14.1758C10.429 14.0892 10.5384 14.0459 10.666 14.0459H12.1221C12.751 14.0459 13.2158 13.8955 13.5166 13.5947C13.8219 13.2939 13.9746 12.8268 13.9746 12.1934V10.7305C13.9746 10.6029 14.0202 10.4958 14.1113 10.4092L15.1436 9.37012C15.5902 8.92806 15.8112 8.49284 15.8066 8.06445C15.8066 7.63607 15.5856 7.19857 15.1436 6.75195L14.1113 5.71289C14.0202 5.6263 13.9746 5.52148 13.9746 5.39844V3.92871C13.9746 3.30436 13.8242 2.83952 13.5234 2.53418C13.2227 2.22884 12.7555 2.07617 12.1221 2.07617H10.666C10.5384 2.07617 10.429 2.03288 10.3379 1.94629L9.29883 0.914062C8.85677 0.462891 8.42155 0.239583 7.99316 0.244141C7.56934 0.244141 7.13411 0.467448 6.6875 0.914062L5.64844 1.94629C5.56185 2.03288 5.45475 2.07617 5.32715 2.07617H3.86426C3.23535 2.07617 2.76823 2.22656 2.46289 2.52734C2.16211 2.82812 2.01172 3.29525 2.01172 3.92871V5.39844C2.01172 5.52148 1.96842 5.6263 1.88184 5.71289L0.849609 6.75195C0.402995 7.19857 0.179688 7.63607 0.179688 8.06445C0.179688 8.49284 0.402995 8.92806 0.849609 9.37012L1.88184 10.4092C1.96842 10.4958 2.01172 10.6029 2.01172 10.7305V12.1934C2.01172 12.8223 2.16211 13.2871 2.46289 13.5879C2.76823 13.8932 3.23535 14.0459 3.86426 14.0459ZM7.23438 11.4277C7.10221 11.4277 6.98372 11.4004 6.87891 11.3457C6.77409 11.291 6.67155 11.2021 6.57129 11.0791L4.89648 9.04199C4.83724 8.96452 4.79167 8.88477 4.75977 8.80273C4.72786 8.7207 4.71191 8.63639 4.71191 8.5498C4.71191 8.37663 4.77116 8.22852 4.88965 8.10547C5.0127 7.97786 5.16081 7.91406 5.33398 7.91406C5.44336 7.91406 5.54134 7.93685 5.62793 7.98242C5.71452 8.02799 5.80339 8.10775 5.89453 8.22168L7.20703 9.88965L10.0371 5.36426C10.1829 5.12728 10.3675 5.00879 10.5908 5.00879C10.7594 5.00879 10.9098 5.06348 11.042 5.17285C11.1787 5.28223 11.2471 5.42578 11.2471 5.60352C11.2471 5.68099 11.2288 5.76302 11.1924 5.84961C11.1559 5.93164 11.1149 6.00911 11.0693 6.08203L7.87012 11.0723C7.78809 11.1908 7.69238 11.2796 7.58301 11.3389C7.47819 11.3981 7.36198 11.4277 7.23438 11.4277Z"})}),Ke="".concat(Pf(),"fe-web-app-images"),KX={homeWikis:"".concat(Ke,"/website/wikis.png"),homeProject:"".concat(Ke,"/website/project.png"),homeAi:"".concat(Ke,"/website/ai.png"),homeDocs:"".concat(Ke,"/website/docs.png"),evernote:"".concat(Ke,"/website/evernote.png"),x:"".concat(Ke,"/website/x.png"),googleDoc:"".concat(Ke,"/website/google_doc.png"),googleDrive:"".concat(Ke,"/website/google_drive.png"),confluence:"".concat(Ke,"/website/confluence.png"),tg:"".concat(Ke,"/website/tg.png"),third1:"".concat(Ke,"/website/third1.png"),third2:"".concat(Ke,"/website/third2.png"),websiteBg:"".concat(Ke,"/website/bg.svg"),mac:"".concat(Ke,"/website/mac.png"),windows:"".concat(Ke,"/website/windows.png"),homeLocal:"".concat(Ke,"/website/local.png"),homeEmbed:"".concat(Ke,"/website/website_embed.png"),homeNotionImport:"".concat(Ke,"/website/notion_import.png"),homeDevice:"".concat(Ke,"/website/device.png"),android:"".concat(Ke,"/website/android.png")},Nk={...KX,weChatPay:"".concat(Ke,"/wechat-pay.png"),aliPay:"".concat(Ke,"/ali-pay.png"),weAppQr:"".concat(Ke,"/we-app-qr.jpg"),qr:"".concat(Ke,"/qr.png"),payAccessBg:"".concat(Ke,"/pay-access-bg.png"),icon:"".concat(Ke,"/icon.svg"),defaultAvatar:"".concat(Ke,"/default-avatar.svg"),loadingGif:"".concat(Ke,"/loading-gif.svg"),favicon:"".concat(Ke,"/favicon.png"),logo:"".concat(Ke,"/logo.svg"),logoWide:"".concat(Ke,"/logo_black_wide.svg"),logoWhite:"".concat(Ke,"/logo_white.svg"),logoBlackWide:"".concat(Ke,"/logo_black_wide.svg"),logoWhiteWide:"".concat(Ke,"/logo_white_wide.svg"),resizeLeft:"".concat(Ke,"/resize-left.svg"),loginAvatar:"".concat(Ke,"/login-avatar.svg"),spaceTeam:"".concat(Ke,"/space-team.svg"),spacePersonal:"".concat(Ke,"/space-personal.svg"),submit:"".concat(Ke,"/submit.png"),clearTemplate:"".concat(Ke,"/clear-template.png"),pointBg:"".concat(Ke,"/point-bg.svg"),createSpaceTeam:"".concat(Ke,"/create-space-team.svg"),createSpacePersonal:"".concat(Ke,"/create-space-personal.svg"),createSpacePersonalBottom:"".concat(Ke,"/create-space-personal-bottom.svg"),shareFormQr:"".concat(Ke,"/share-form-qr.png"),orderRemarks:"".concat(Ke,"/order-remarks.svg"),teamWechatQr:"".concat(Ke,"/team-wechat-qr.jpg"),templateEmpty:"".concat(Ke,"/template_empty.svg"),star:"".concat(Ke,"/star.svg"),importGuestLeft:"".concat(Ke,"/import-guest-left.png"),importGuestRight:"".concat(Ke,"/import-guest-right.png"),compactLayout:"".concat(Ke,"/layout/compact-layout.png"),defaultLayout:"".concat(Ke,"/layout/default-layout.png"),looseLayout:"".concat(Ke,"/layout/loose-layout.png"),wechatClipperFailed:"".concat(Ke,"/wechat-clipper-failed.png"),bindWechatClip:"".concat(Ke,"/bind-wechat-clip.png"),subscribeRecommend:"".concat(Ke,"/subscribe-recommend.png"),subscribeCenter:"".concat(Ke,"/subscribe-center.png"),templatesEmpty:"".concat(Ke,"/activity/web-big-image/templates-empty.jpg"),transparent:"".concat(Ke,"/transparent.png"),medal:"".concat(Ke,"/medal.png"),medalBg:"".concat(Ke,"/medal-bg.png"),littleMedal:"".concat(Ke,"/little-medal.png"),pdfSummary:"".concat(Ke,"/pdf-preview-home/summary.png"),pdfFile:"".concat(Ke,"/pdf-preview-home/file.png"),pdfCompare:"".concat(Ke,"/pdf-preview-home/compare.png"),pdfAsk:"".concat(Ke,"/pdf-preview-home/ask.png"),activityHelp:"".concat(Pf(),"activity/task/web/help.png"),accountInvite:"".concat(Ke,"/activity/account-invite.svg"),couponCountDown:"".concat(Ke,"/activity/coupon-count-down.svg"),s102Head:"".concat(Ke,"/activity/s102-header1.webp"),s102Body:"".concat(Ke,"/activity/s102-body1.webp"),s102TeamHead:"".concat(Ke,"/activity/s102-header2.webp"),aiCountExceed1:"".concat(Ke,"/ai/img1.png"),aiCountExceed2:"".concat(Ke,"/ai/img2.png"),aiCountExceed3:"".concat(Ke,"/ai/img3.png"),defaultWare:"".concat(Ke,"/score/default-ware.png"),chartBarBase:"".concat(Ke,"/chart/chart_bar_base.svg"),chartBarStack:"".concat(Ke,"/chart/chart_bar_stack.svg"),chartBarPercent:"".concat(Ke,"/chart/chart_bar_percent.svg"),chartHorizontalbarBase:"".concat(Ke,"/chart/chart_horizontalbar_base.svg"),chartHorizontalbarStack:"".concat(Ke,"/chart/chart_horizontalbar_stack.svg"),chartHorizontalbarPercent:"".concat(Ke,"/chart/chart_horizontalbar_percent.svg"),chartLineBase:"".concat(Ke,"/chart/chart_line_base.svg"),chartLineSmooth:"".concat(Ke,"/chart/chart_line_smooth.svg"),chartLineStep:"".concat(Ke,"/chart/chart_line_step.svg"),chartNumber:"".concat(Ke,"/chart/chart_number.svg"),chartPieBase:"".concat(Ke,"/chart/chart_pie_base.svg"),expandnode:"".concat(Ke,"/expandnode.svg"),pageEmpty:"".concat(Ke,"/page_empty.png"),personal:"".concat(Ke,"/all/personal.png"),smallTeam:"".concat(Ke,"/all/small_team.png"),team:"".concat(Ke,"/all/team.png"),spaceBg:"".concat(Ke,"/all/space_bg.png"),couponStar:"".concat(Ke,"/all/star.svg"),logoWithText:"".concat(Ke,"/all/logo_and_text.png"),payStripe:"".concat(Ke,"/pay/stripe.svg"),payYoomoney:"".concat(Ke,"/pay/yoomoney.svg"),paySbp:"".concat(Ke,"/pay/sbp.svg"),paySber:"".concat(Ke,"/pay/sber.svg"),payCard:"".concat(Ke,"/pay/card.svg"),subitemFeature:"".concat(Ke,"/subitem_feature.png")},VL={logoWide:"".concat(Ke,"/logo_white_wide.svg"),payAccessBg:"".concat(Ke,"/pay-access-bg-dark.png"),spacePersonal:"".concat(Ke,"/dark-image/space-personal.svg"),createSpaceTeam:"".concat(Ke,"/dark-image/create-space-team.svg"),createSpacePersonal:"".concat(Ke,"/dark-image/create-space-personal.svg"),clearTemplate:"".concat(Ke,"/dark-image/clear-template.svg"),spaceTeam:"".concat(Ke,"/dark-image/space-team.svg"),teamQrHeader:"".concat(Ke,"/dark-image/team-qr-header.svg"),templatesEmpty:"".concat(Ke,"/dark-image/templates-empty.png"),compactLayout:"".concat(Ke,"/layout/dark-compact-layout.png"),defaultLayout:"".concat(Ke,"/layout/dark-default-layout.png"),looseLayout:"".concat(Ke,"/layout/dark-loose-layout.png"),logoWithText:"".concat(Ke,"/all/dark/logo_and_text.png")},qo={reload:e=>{e?Object.assign(qo,VL):Object.assign(qo,Nk)},...Nk},YX=(e,t)=>"/".concat(t,"/").concat(e,".svg"),c3=(e,t)=>"".concat(t1.cdnHost,"assets/byte-icon/").concat(e?"dark":"light").concat(t);ue.extend(jG);ue.extend(SG);ue.extend(DG);const V2=new Map([[0,"日"],[1,"一"],[2,"二"],[3,"三"],[4,"四"],[5,"五"],[6,"六"]]),yb="YYYY-MM-DD",$L="YYYY年M月D日",XX=e=>{const t=ue(e),n=ue();if($2(t,0))return"今天";if($2(t,1))return"明天";if($2(t,2))return"后天";if(MS(t,1))return"昨天";if(MS(t,2))return"前天";const s=n.subtract(7+n.day()-1,"day"),a=s.add(6,"day");if(t.isBetween(s,a,"day","[]"))return["上周",V2.get(t.day())].join("");const o=a.add(1,"day"),i=o.add(6,"day");if(t.isBetween(o,i,"day","[]"))return["本周",V2.get(t.day())].join("");const l=i.add(1,"day"),c=l.add(6,"day");return t.isBetween(l,c,"day","[]")?["下周",V2.get(t.day())].join(""):t.format($L)},MS=(e,t)=>{const n=ue().subtract(t,"day");return e.format(yb)===n.format(yb)},$2=(e,t)=>{const n=ue().add(t,"day");return e.format(yb)===n.format(yb)},HL="YYYY/MM/DD HH:mm",zL="YYYY/MM/DD",qL=e=>{let t;return e.type===m.TextType.DATETIME?t=ue("".concat(e.startDate," ").concat(e.startTime),HL).startOf("minute").toDate():e.type===m.TextType.DATE?t=ue("".concat(e.startDate),zL).startOf("day").toDate():t=ue().toDate(),t},US=(e,t)=>ue(e,t,!0).isValid(),d3=(e,t,n,s)=>{t!=null||(t=m.DateFormat.YYYY_MM_DD),s!=null||(s=m.TimeFormat.H_MM);let a;switch(t){case m.DateFormat.LL:a=ue(e).format($L);break;case m.DateFormat.RELATIVE:a=XX(e);break;default:a=ue(e).format(t.toLocaleUpperCase())}return n?"".concat(a," ").concat(ue(e).format(s)):a},Yp=(e,t,n,s)=>{t!=null||(t=e.dateFormat),n!=null||(n=e.type===m.TextType.DATETIME);const a=qL(e);return s!=null||(s=e.timeFormat),d3(a.getTime(),t,n,s)},GL=60*1e3,WL=60*GL,VS=24*WL,KL=(e,t)=>{var n,s,a,o;if(t)if(t.unit==="day"){const i=ue(t.time,"HH:mm").get("hour");return t.time?ue(e).set("hour",i).unix()*1e3-((n=t.value)!=null?n:0)*VS:ue(e).unix()*1e3-((s=t.value)!=null?s:0)*VS}else{if(t.unit==="hour")return ue(e).unix()*1e3-((a=t.value)!=null?a:0)*WL;if(t.unit==="minute")return ue(e).unix()*1e3-((o=t.value)!=null?o:0)*GL}},YL=e=>{if(!e)return;const t=QX(e);if(t)return KL(t.timestamp,e.reminder)},QX=e=>{if(!e)return;const t=ue(qL(e));if(!isNaN(t.toDate().getTime())){if(e.type===m.TextType.DATE)return{dateString:t.format(zL),timestamp:t.valueOf(),textType:m.TextType.DATE};if(e.type===m.TextType.DATETIME)return{dateString:t.format(HL),timestamp:t.valueOf(),textType:m.TextType.DATETIME}}},Cm=(e="")=>e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"),aw=e=>{let t=!1;switch(e=e!=null?e:m.OrderFolderType.TIME_REVERSED,e){case m.OrderFolderType.SIZE_REVERSED:case m.OrderFolderType.NAME_REVERSED:case m.OrderFolderType.TIME_REVERSED:{t=!0;break}}return{reverse:t,sortType:e}};function*XL(e){const{maxWidth:t,minimalWidthHint:n=100,mode:s="half"}=e,a=Math.max(100,n);let o=t;do yield Math.floor(o),s==="half"?o=o/2:s==="gradual"&&(o=o-70);while(o>=a)}function JX(e,t){return{srcSet:AG(e,t).reverse().map(([n,s])=>"".concat(s||"about:blank"," ").concat(n,"w")).join(", ")}}const ZX=(e,t,n)=>{const s=[...XL({maxWidth:t!=null?t:1920})];return{...JX(s,s.map(a=>Q1(e,"/image/resize,w_".concat(a,"/quality,q_90")))),sizes:n&&"".concat(n==null?void 0:n.toFixed(0),"px")}},t_={},QL=(e,t,n=!1)=>(t_[e]||(t_[e]=new Promise((s,a)=>{let o;t==="script"?(o=document.createElement(t),o.async=n,o.src=e):(o=document.createElement(t),o.href=e,o.rel="stylesheet",o.type="text/css"),o.onload=()=>s(),o.onerror=i=>{delete t_[e],a(i)},document.head.insertBefore(o,document.head.firstChild)})),t_[e]),eQ=()=>/micromessenger|qqtheme|weibo/i.test(navigator.userAgent),tQ=(e="")=>{const t=An(e.split("/"));return{fileName:t,...rn(t)}},rn=(e="")=>{const t=e.lastIndexOf("."),n=e.substring(0,t);let s=e.substring(t+1);const a=s.match(/\w+/);return a!=null&&a[0]&&(s=a[0]),{name:n,extName:s}};let JL=class{constructor(){q(this,"resolve");q(this,"reject");q(this,"promise",new Promise((t,n)=>{this.resolve=t,this.reject=n}))}};class ZL{constructor(t="(prefers-color-scheme: dark)"){q(this,"queryList");q(this,"onChange",t=>{var n,s;return typeof((n=this.queryList)==null?void 0:n.addEventListener)=="function"?this.queryList.addEventListener("change",t):typeof((s=this.queryList)==null?void 0:s.addListener)=="function"&&this.queryList.addListener(t),()=>this.offChange(t)});q(this,"offChange",t=>{var n,s;typeof((n=this.queryList)==null?void 0:n.removeEventListener)=="function"?this.queryList.removeEventListener("change",t):typeof((s=this.queryList)==null?void 0:s.removeListener)=="function"&&this.queryList.removeListener(t)});this.queryList=window.matchMedia(t)}get media(){var t,n;return(n=(t=this.queryList)==null?void 0:t.media)!=null?n:""}get matches(){var t;return!!((t=this.queryList)!=null&&t.matches)}}const nQ="theme_mode",ad=()=>{try{return document.body.className.includes("dark")}catch(e){return!1}},wd=()=>{const[e,t]=y.useState(ad());return y.useEffect(()=>{const n=document.body,s=()=>t(ad()),a=new MutationObserver(o=>{o.forEach(i=>{i.type==="attributes"&&s()})});return s(),a.observe(n,{attributes:!0}),()=>{a.disconnect()}},[]),e},Bd={add:()=>{document.body.classList.add("dark"),qo.reload(!0)},remove:()=>{document.body.classList.remove("dark"),qo.reload(!1)}},sQ=()=>{const[e,t]=y.useState(!1);return y.useEffect(()=>{const n=new ZL("(prefers-color-scheme: dark)");t(n.matches);const s=a=>t(a.matches);return n.onChange(s)},[]),e},Rf=class Rf{constructor(){q(this,"resizeObserver");q(this,"elements");q(this,"elementsLastEntry");this.elements=new WeakMap,this.elementsLastEntry=new WeakMap,this.resizeObserver=new ResizeObserver(t=>{t.forEach(n=>{const{target:s}=n,a=this.elements.get(s);a&&(this.elementsLastEntry.set(s,n),a.forEach(o=>o(n)))})})}static getInstance(){return Rf.instance||(Rf.instance=new Rf),Rf.instance}observe(t,n){if(!this.elements.has(t))this.elements.set(t,new Set([n])),this.resizeObserver.observe(t);else{const s=this.elements.get(t);s==null||s.add(n);const a=this.elementsLastEntry.get(t);a&&n(a)}return()=>this.unobserve(t,n)}unobserve(t,n){if(!this.elements.has(t))return;const s=this.elements.get(t);s==null||s.delete(n),(s==null?void 0:s.size)===0&&(this.elements.delete(t),this.elementsLastEntry.delete(t),this.resizeObserver.unobserve(t))}};q(Rf,"instance");let jk=Rf;const Ku=jk.getInstance(),xn=new KP.Emitter;KP.Emitter.defaultMaxListeners=200;let g_=0;const rQ=10,aQ=["userId","lastViewPage","currentSpaceViewId"],ts=(e,t,n=localStorage)=>{g_=0,eB(e,t,n)},eB=async(e,t,n=localStorage)=>{try{await n.setItem(e,t)}catch(s){if(!(s instanceof Error)||!s.message.toLowerCase().includes("quota"))return;if(g_>rQ){const a={};aQ.forEach(async o=>{const i=await n.getItem(o);i&&(a[o]=i)}),await n.clear(),Object.entries(a).forEach(([o,i])=>{n.setItem(o,i)}),location.reload();return}g_++,g_===0?$S("expired"):g_>=1&&$S("safe-all"),oQ(),eB(e,t,n)}},oQ=(e=10,t=localStorage)=>{let n=0;for(let s=0;s<t.length;s++){if(n>=e)return;const a=t.key(s);a&&(a.startsWith("viewId:")||a.startsWith("inline-bitable:")||a.startsWith("LRU::"))&&(t.removeItem(a),n++)}},$S=(e="safe-all")=>{const t=new Set;for(let n=0;n<localStorage.length;n++){const s=localStorage.key(n);if(s!=null&&s.startsWith("Managed:")){const a=localStorage.getItem(s);if(e==="all"||a==null)t.add(s);else try{const o=JSON.parse(a),{expiredAt:i,safeToPurge:l}=o;(e==="safe-all"&&l||e==="expired"&&Date.now()>=i)&&t.add(s)}catch(o){t.add(s)}}}for(const n of t)localStorage.removeItem(n)},iQ=e=>{const t="Managed:".concat(e),n=localStorage.getItem(t);if(n!=null)try{const s=JSON.parse(n),{data:a,expiredAt:o}=s;if(Date.now()>=o){localStorage.removeItem(t);return}return a}catch(s){return}},HS=e=>{const t="Managed:".concat(e);localStorage.removeItem(t)},lQ=(e,t,n)=>{var c,d;const s=(c=n==null?void 0:n.expiredAt)!=null?c:null,a=(d=n==null?void 0:n.safeToPurge)!=null?d:!0,o="Managed:".concat(e),l=JSON.stringify({data:t,expiredAt:s,safeToPurge:a});try{return a?localStorage.setItem(o,l):ts(o,l),!0}catch(u){return!1}},Bf=(e,t=!1)=>{var n;try{return JSON.parse((n=localStorage.getItem(e))!=null?n:t?"[]":"{}")}catch(s){return t?[]:{}}},Y1=(e="")=>{try{return decodeURIComponent(e)}catch(t){return console.debug(t),e}};var Cn=(e=>(e.wxpay="wxpay",e.wxjsapi="wxjsapi",e.alipay="alipay",e.irpay="irpay",e.offline="offline",e.webpay="webpay",e.alipayH5="alipayH5",e.wxpayH5="wxpayH5",e.minipay="minipay",e.stripe="stripe",e.sbpRu="sbp_ru",e.cardRu="card_ru",e.yoomoneyRu="yoomoney_ru",e.sberPayRu="sberpay_ru",e))(Cn||{});const en=e=>{var t,n;return r.jsx("button",{disabled:e.disabled,onClick:s=>{var a;s.stopPropagation(),(a=e.onSwitch)==null||a.call(e,!e.open)},className:R({"opacity-20":e.disabled,"cursor-not-allowed":e.disabled},"relative flex-shrink-0 w-[30px] h-[18px] flex items-center rounded-full transition-all px-0.5",e.open?(t=e.customColor)!=null?t:"bg-active_color":"bg-grey4",e.bgClassName),children:r.jsx("span",{className:R("absolute bg-white w-3.5 h-3.5 rounded-full transition-all shadow-modal",e.switchClassName),style:{transition:"inherit",transform:e.open?"translateX(100%)":"translateX(0)",marginLeft:e.open?(n=e.fixPosition)!=null?n:"-2px":"0"}})})},u3=({time:e=0,prefix:t="",onFinish:n,onChange:s,autoStart:a=!0,className:o=""})=>{const[i,l]=y.useState(e);return y.useEffect(()=>{i===0&&n&&n(!0)},[i,n]),y.useEffect(()=>{s&&s(i)},[i,s]),y.useEffect(()=>{if(a){l(i);const c=setInterval(()=>{l(d=>d<1?(clearInterval(c),0):d-1)},1e3)}return()=>{l(0)}},[]),r.jsx("span",{className:o,children:i!==0?"".concat(t," ").concat(i,"s"):t})},cQ={auto:"h-full w-full min-h-[32px] text-t2-medium",middle:"w-80 h-12 text-t1-medium",large:"h-8 px-3 text-t2-medium"},dQ={primary:"bg-black border-black text-white1",secondary:"bg-white dark:bg-transparent text-black border-grey5",red:"text-red border-red",white:"bg-transparent text-white-base border-white",black:"bg-transparent text-black border-black",base_white:"bg-white text-black-base border-white",active:"bg-active_color text-white border-transparent",active_line:"bg-transparent text-active_color border-active_color",grey:"bg-grey9 text-black border-transparent"},uQ={primary:"hover:opacity-90",secondary:"hover:brightness-90 dark:hover:bg-black_003",red:"hover:bg-red/10",white:"hover:bg-black_003",black:"hover:bg-black_003",base_white:"hover:brightness-90",active:"hover:brightness-90 dark:hover:brightness-110",active_line:"hover:brightness-90 dark:hover:brightness-110",grey:"hover:brightness-90 dark:hover:brightness-110"},De=y.forwardRef((e,t)=>{const{colorType:n="secondary",disable:s,onClick:a,autoFocus:o=!1,size:i="large",className:l,children:c,hidden:d,...u}=e,f=y.useRef(null);return y.useImperativeHandle(t,()=>f.current,[]),d?null:r.jsx("button",{...u,ref:f,"data-color-type":n,onClick:a,autoFocus:o,disabled:s,onKeyDown:h=>{Ie("enter")(h)&&h.currentTarget.click()},className:R("flex justify-center items-center rounded border outline-none text-ellipsis select-none flex-shrink-0",cQ[i],dQ[n],s?"opacity-30 cursor-not-allowed":uQ[n],!s&&"animate-click",l),children:r.jsx(r.Fragment,{children:c})})}),fQ={middle:"0.5",max:"1",large:"0.75",small:"0.25"},$s=({className:e,size:t="max",style:n,...s})=>r.jsx("span",{className:R("loader-icon",e),style:{...n,zoom:fQ[t]},...s});function mQ(e){const t=[];return y.Children.toArray(e).forEach(n=>{fn.isValidElement(n)&&t.push({key:n.key,...n.props,node:n})}),t}const tB=({className:e,childrenClassName:t,children:n,defaultActiveIndex:s=0,customButtons:a,onChangeTab:o,active:i,displayMode:l="lazyLoad",style:c,border:d=!0,showHeader:u=!0,headerClassName:f=""})=>{var F;const[h,p]=y.useState(s),g=y.useRef(null),_=y.useRef(new Set([h]));y.useEffect(()=>{i!==void 0&&p(i)},[i]);const x=mQ(n);return _.current.add(h),r.jsxs("div",{className:e,style:c,"data-no-cancel-selected":!0,children:[u&&r.jsxs("div",{ref:g,className:R("h-[50px] flex py-2.5 justify-between items-center",{"border-b border-grey6 ":d},f),children:[r.jsx("span",{className:"flex items-center",children:x.map((b,w)=>{var E;return r.jsxs("span",{onClick:()=>{p(w),o==null||o(w)},className:R("text-t2 py-1 px-1.5 mx-1 rounded-sm flex-shrink-0",h===w?"bg-black_006 cursor-pointer text-t2-medium":"animate-hover",t),children:[b.icon&&b.icon,b.title]},(E=b.key)!=null?E:w)})}),a==null?void 0:a()]}),l==="singleNode"&&((F=x[h])==null?void 0:F.node),l!=="singleNode"&&x.map((b,w)=>_.current.has(w)||l==="preview"?r.jsx("div",{className:R({hidden:w!==h},t),children:b.node},b.key||w):null)]})},Sk=({children:e})=>r.jsx(r.Fragment,{children:e}),X1=({text:e,search:t,className:n,ignoreUpperCase:s=!0,containerClassName:a})=>{if(!e)return null;const o=(s?e.toUpperCase():e).indexOf(s?t.toUpperCase():t);if(o===-1)return r.jsx(r.Fragment,{children:e});const i=e.slice(0,o),l=e.slice(o,o+t.length),c=e.slice(o+t.length,e.length);return r.jsxs("span",{className:a,children:[r.jsx("span",{className:n,children:i}),r.jsx("span",{className:R(n,"text-active_color"),children:l}),r.jsx("span",{className:n,children:c})]})},hQ=e=>{const{limitLen:t,text:n,search:s,ignoreUpperCase:a=!0,...o}=e;if(!n)return null;const i=(a?n.toUpperCase():n).indexOf(a?s.toUpperCase():s);if(i===-1)return r.jsx(r.Fragment,{children:n});const l=Math.max(0,i-t/2),c=Math.min(l+t,n.length);return r.jsx(X1,{text:n.slice(l,c),search:s,ignoreUpperCase:a,...o})},j_=({children:e,className:t,...n})=>r.jsx("span",{className:R("whitespace-nowrap overflow-hidden overflow-ellipsis",t),...n,children:e}),{VITE_PRODUCT_NAME:pQ,VITE_PRODUCT:dAe,VITE_IS_WEBSITE:uAe}={VITE_DOCUMENT_TITLE:"FlowUs 息流｜一站式知识创作与发布平台",VITE_OSS_CDN_HOST:"https://cdn2.flowus.cn/",VITE_ENV:"production",VITE_VOLCENGINE_TRACK_ID:"303823",VITE_URL_SPLIT_TEXT:"【FlowUs 息流】",VITE_WECHAT_ACCOUNT:"wx1736ff051cca370b",VITE_NOTION_CLIENT_ID:"f843d557-50d6-4110-b05c-6e60029bd338",VITE_PRODUCT_ALL_NAME:"FlowUs 息流",VITE_TEMPLATE_ID:"6a4efea1-e023-4e99-bb69-d69af5909412",VITE_OSS_UPLOAD_URL:"https://oss.flowus.com.cn",VITE_PREFIX:"https://flowus.cn",VITE_WECHAT_APP_ID:"wx7de87594073bf09f",VITE_GIT_COMMIT:"582aec734b7f0b024b82d1a8b60184f8ae9ec2c7",VITE_IMPORTANT_FEATURE_COLLECTION_ID:"6fcef75c-2637-42e8-86d7-2d59bdef4807",VITE_PRODUCT_AI_NAME:"FlowUs AI",VITE_SUBSCRIBE_ID:"6301204f-7892-47c8-9a6a-d34f5c6a8855",VITE_DESCRIPTION:"使用 Flowus 构建您的知识平台，助您轻松创作与发布",VITE_WPS_KEY:"SX20231127MUOIEW",VITE_BUCKET:"flowus-1316188996",VITE_CDN_HOST:"https://cdn2.flowus.cn/",VITE_AD_COLLECTION_ID:"d103bcd6-5712-4aa4-8c03-385add1f2391",VITE_PRODUCT_NAME:"FlowUs",VITE_SERVICE_CENTER_COLLECTION_ID:"14620f35-b0be-4d28-8a10-f3ae4809af43|e077dd8f-a2d7-46e6-a97e-3167cf8665e0",BASE_URL:"https://cdn2.flowus.cn/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,LEGACY:!1},gQ=()=>window.wx,_Q=e=>{var t;e&&((t=gQ())==null||t.previewImage({current:e,urls:[e]}))},nB=async(e,t)=>{const{targetId:n,subscribed:s,cancelSubscribe:a,addSubscribe:o,user:i,openDialog:l,callback:c}=e,{pageId:d,needPay:u,userId:f,spaceId:h,createdBy:p,event:g}=t;g(s?"subscribe":"unsubscribe",{user_id:f,page_id:d,space_id:h,created_user_id:p,subscribe_type:u?"paid_subscribe":"free_subscribe"}),s?(await o(n),await xQ(i,l,()=>c(s)),js&&c(s)):await a(n)},xQ=async(e,t,n)=>{Fi()||await t({colorType:"active",minWidth:350,showCancel:!1,showConfirm:!1,noCancel:!0,closeAfterCallBack:()=>{n==null||n(!0)},title:"关注 ".concat(pQ," 公众号，接收订阅推送消息"),content:r.jsxs("div",{className:"text-grey3 text-t3 text-center space-y-2.5 flex items-center justify-center flex-col pt-2",children:[r.jsx("img",{onClick:()=>{_Q(qo.qr)},src:qo.qr,className:"w-32 rounded mx-auto"}),r.jsx(De,{colorType:"active",onClick:()=>{window.open(vk.subscribeCenter)},children:"更多精选专栏"}),r.jsx("a",{className:"text-active_color",href:vk.mySubscribePage,target:"_blank",rel:"noreferrer",children:"我的订阅"})]})})},vt={watermark_id:"wm_div_id",watermark_prefix:"mask_div_id",watermark_txt:"测试水印",watermark_x:20,watermark_y:20,watermark_rows:0,watermark_cols:0,watermark_x_space:50,watermark_y_space:50,watermark_font:"微软雅黑",watermark_color:"black",watermark_fontsize:"18px",watermark_alpha:.15,watermark_width:100,watermark_height:100,watermark_angle:15,watermark_parent_width:0,watermark_parent_height:0,watermark_parent_node:null,monitor:!0,print:!1};let Dk=!1,bb;const sB=MutationObserver!==void 0,zS={childList:!0,attributes:!0,subtree:!0},Lc=sB?new MutationObserver(yQ):null;function yQ(e){if(Dk){Dk=!1;return}(bb&&e.length===1||e.length===1&&e[0]&&e[0].removedNodes.length>=1)&&__(bb)}const __=e=>{var b;e&&Object.assign(vt,e);const t=document.getElementById(vt.watermark_id);t&&t.parentNode&&t.parentNode.removeChild(t);let n=vt.watermark_parent_node?document.getElementById(vt.watermark_parent_node):null;e.print&&(n=document.getElementById("next-space-page")||document.querySelector(".block-content")||document.body);const s=n||document.body,a=Math.max(s.scrollWidth,s.clientWidth),o=Math.max(s.scrollHeight,s.clientHeight),i=s;let l=0,c=0;e.watermark_parent_width||e.watermark_parent_height?i&&(l=i.offsetTop||0,c=i.offsetLeft||0,vt.watermark_x+=c,vt.watermark_y+=l):i&&(l=i.offsetTop||0,c=i.offsetLeft||0);let d=document.getElementById(vt.watermark_id),u=null;if(d)d.shadowRoot&&(u=d.shadowRoot);else{d=document.createElement("div"),d.id=vt.watermark_id,d.setAttribute("style","pointer-events: none !important; display: block !important"),typeof d.attachShadow=="function"?u=d.attachShadow({mode:"open"}):u=d;const w=s.children,E=Math.floor(Math.random()*(w.length-1));w[E]?s.insertBefore(d,w[E]):s.appendChild(d)}vt.watermark_cols=Math.floor((a-vt.watermark_x)/(vt.watermark_width+vt.watermark_x_space));const f=Math.floor((a-vt.watermark_x-vt.watermark_width*vt.watermark_cols)/vt.watermark_cols);vt.watermark_x_space=f&&vt.watermark_x_space,vt.watermark_rows=Math.floor((o-vt.watermark_y)/(vt.watermark_height+vt.watermark_y_space));const h=Math.floor((o-vt.watermark_y-vt.watermark_height*vt.watermark_rows)/vt.watermark_rows);vt.watermark_y_space=h&&vt.watermark_y_space;let p,g;n?(p=vt.watermark_x+vt.watermark_width*vt.watermark_cols+vt.watermark_x_space*(vt.watermark_cols-1),g=vt.watermark_y+vt.watermark_height*vt.watermark_rows+vt.watermark_y_space*(vt.watermark_rows-1)):(p=c+vt.watermark_x+vt.watermark_width*vt.watermark_cols+vt.watermark_x_space*(vt.watermark_cols-1),g=l+vt.watermark_y+vt.watermark_height*vt.watermark_rows+vt.watermark_y_space*(vt.watermark_rows-1));let _,x;for(let w=0;w<vt.watermark_rows;w++){n?x=l+vt.watermark_y+(vt.watermark_y_space+vt.watermark_height)*w:x=vt.watermark_y+(o-g)/2+(vt.watermark_y_space+vt.watermark_height)*w;for(let E=0;E<vt.watermark_cols;E++){n?_=c+vt.watermark_x+(a-p)/2+(vt.watermark_width+vt.watermark_x_space)*E:_=vt.watermark_x+(a-p)/2+(vt.watermark_width+vt.watermark_x_space)*E;const C=document.createElement("div"),k=document.createTextNode(vt.watermark_txt);C.appendChild(k),C.id=vt.watermark_prefix+w+E,C.style.webkitTransform="rotate(-".concat(vt.watermark_angle,"deg)"),C.style.MozTransform="rotate(-".concat(vt.watermark_angle,"deg)"),C.style.msTransform="rotate(-".concat(vt.watermark_angle,"deg)"),C.style.OTransform="rotate(-".concat(vt.watermark_angle,"deg)"),C.style.transform="rotate(-".concat(vt.watermark_angle,"deg)"),C.style.visibility="",C.style.position="absolute",C.style.left="".concat(_,"px"),C.style.top="".concat(x,"px"),C.style.overflow="hidden",C.style.zIndex="9999999",C.style.opacity=(b=vt.watermark_alpha)==null?void 0:b.toString(),C.style.fontSize=vt.watermark_fontsize,C.style.fontFamily=vt.watermark_font,C.style.color=vt.watermark_color,C.style.textAlign="center",C.style.width="".concat(vt.watermark_width,"px"),C.style.height="".concat(vt.watermark_height,"px"),C.style.display="block",C.style.whiteSpace="nowrap",C.style.msUserSelect="none",C.style.userSelect="none",u.appendChild(C)}}(e.monitor===void 0?vt.monitor:e.monitor)&&sB&&(Lc==null||Lc.observe(s,zS),Lc==null||Lc.observe(document.getElementById(vt.watermark_id).shadowRoot,zS))},bQ=e=>{const t=document.getElementById(e!=null?e:vt.watermark_id);t&&t.parentNode&&t.parentNode.removeChild(t),Lc==null||Lc.disconnect()},qS={init(e){bb=e,__(e),window.addEventListener("load",()=>{__(e)}),window.addEventListener("resize",()=>{__(e)})},load(e){bb=e,__(e)},remove(e){Dk=!0,bQ(e)}},FQ=(e,t)=>{const n=document.createElement("span");n.style.visibility="hidden",n.style.position="absolute",n.style.whiteSpace="nowrap",t.fontSize&&(n.style.fontSize=t.fontSize),t.fontFamily&&(n.style.fontFamily=t.fontFamily),t.fontWeight&&(n.style.fontWeight=t.fontWeight),t.fontStyle&&(n.style.fontStyle=t.fontStyle),t.textTransform&&(n.style.textTransform=t.textTransform),t.letterSpacing&&(n.style.letterSpacing=t.letterSpacing),t.wordSpacing&&(n.style.wordSpacing=t.wordSpacing),t.textDecoration&&(n.style.textDecoration=t.textDecoration),n.textContent=e,document.body.appendChild(n);const s=n.offsetWidth;try{document.body.removeChild(n)}catch(a){}return s},wQ=(e,t)=>{const n=CQ(e,[{key:Lf.inviteCode,value:i3.inviteCode.get()},{key:Lf.callbackPath,value:location.pathname}]);let s="https://flowus.cn";/alpha|test|test-tc|dev/.test(location.origin)&&(s=location.origin),sw(Kp.WECHAT_PAY_INFO,JSON.stringify(t));let a="".concat(s).concat(n);EQ()&&(a+="&~~debug~~"),a=encodeURIComponent(a.replace("".concat(Lf.inviteCode,"="),"".concat(Lf.inviteCodeByWeChat,"=")));const o="https://open.weixin.qq.com/connect/oauth2/authorize?appid=".concat(SY,"&redirect_uri=").concat(a,"&response_type=code&scope=snsapi_userinfo&state=flowus#wechat_redirect");console.log("url: ",o),window.location.href=o},EQ=()=>location.href.includes("~~debug~~"),CQ=(e,t)=>{const n=new URLSearchParams(location.search);Array.isArray(t)?t.forEach(({key:a,value:o})=>o&&n.set(a,o)):t.value&&n.set(t.key,t.value);const s=n.toString();return"".concat(e).concat(s?"?".concat(s):"")},Gl={Email:/[\w!#$%&'*+/=?^_`{|}~-]+(?:\.[\w!#$%&'*+/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?$/,Mobile:/^1[3456789]\d{9}$/,Password:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d!@#$%^&*()_+-~|\\}\\{\\"\\:\\?\\>\\<,.;'\\[\]]{6,16}$/,VerifyCode:/^[0-9]{6}$/},km=e=>{const t=location.host.split(".");if(/allflow|buildin|flowus/.test("".concat(e)))return!0;if(t.length===3){const[n,s,a]=t;return e==null?void 0:e.includes("".concat(s,".").concat(a))}return e==null?void 0:e.includes(location.host)},Xp=e=>{if(e)try{return new URL(e)}catch(t){return}},f3=e=>{if(!e||!km(e)||!Gu(e))return"";try{e=Y1(e);const t=new URL(e);return t.pathname.startsWith("/oss/")||t.pathname.startsWith("/oss-dev/")?t.pathname.substring(1):""}catch(t){return""}},kQ=navigator.userAgent.toLowerCase().indexOf("alipayclient")!==-1,Fb=navigator.userAgent.toLowerCase().indexOf("micromessenger")!==-1,TQ=e=>{var o,i;const t=atob("".concat(e.split(",")[1])),n=(i=(o=e.split(",")[0])==null?void 0:o.split(":")[1])==null?void 0:i.split(";")[0],s=new ArrayBuffer(t.length),a=new Uint8Array(s);for(let l=0;l<t.length;l++)a[l]=t.charCodeAt(l);return new Blob([s],{type:n})},vQ=e=>{if(RG(e)!==e)return!0;try{const t=new URL(e)}catch(t){return!1}return"%".includes(e)?!1:!!/[\u0080-\uFFFF]/.test(e)},Ak=(e="",t=800)=>Q1(e,"video/snapshot,t_1,f_jpg,w_".concat(t)),sm=(e="",t=640,n=80)=>Q1(e,"image/resize,w_".concat(t,"/quality,q_").concat(n)),Tm=(e,t)=>{let n="watermark";try{n=btoa(t)}catch(s){n=""}return Q1(e,"image/watermark,text_".concat(n))},Q1=(e,t)=>{if(!e)return e;if(t&&t.startsWith("/")&&(t=t.slice(1,t.length)),t&&t.endsWith("/")&&t.length>2&&(t=t.slice(0,t.length-2)),e&&e.includes(Ax)){const n=new URL(e),s=n.searchParams.get(Ax);if(s){const a="".concat(s,"/").concat(t);return n.searchParams.set(Ax,a),n.toString()}}return"".concat(e,"&").concat(Ax,"=").concat(t)},IQ=e=>{const t=Y1(window.location.href);if(t.includes(gp)){const[n]=t.split(gp);if(n)return e?e(n.trim()):window.location.replace(n.trim()),!0}if(t.includes(" ")){const n=ll(t.split(" "));if(n)return e?e(n):window.location.replace(n.trim()),!0}},NQ=e=>{const t=window.location.href,n=new URL(t);e.forEach(s=>{n.searchParams.delete(s)}),history.replaceState({},"",n.toString())},GS=new PG({concurrency:5}),m3=e=>{const t=e.indexOf("?");if(t>0&&(e=e.substring(0,t)),!e.endsWith("/")){const n=e.lastIndexOf("/")+1;if(n>0)return e.substring(n)}return"未知文件名"},jQ={},SQ=e=>{let t=jQ[e];if(!t){const n=km(e);t=(async()=>await fetch(e,{method:"GET",referrerPolicy:n?"strict-origin-when-cross-origin":"no-referrer"}))()}return t},rB=e=>{const t=window.location.origin.startsWith("http");return"".concat(t?window.location.origin:"https://flowus.cn","/api/download/img?url=").concat(encodeURIComponent(e))},DQ={},aB=async e=>{let t=DQ[e];return t||(t=(async()=>{const n=km(e),s=await fetch(e,{method:"GET",referrerPolicy:n?"strict-origin-when-cross-origin":"no-referrer"});if(s.status===200){const a=m3(e),o=await s.blob();return{fileName:a,blob:o,url:e}}})()),t},WS=async(e,t=!1)=>{let n=e;if(t)try{const a=(await Pe(()=>import("./heic2any-a356a5b3.js").then(i=>i.h),["assets/heic2any-a356a5b3.js","assets/vendor-2890c4d6.js"])).default,o=await a({blob:e});if(Array.isArray(o)){const[i]=o;i&&(n=i)}else n=o}catch(s){return e}return n},H2=new Map,oB=(e,t)=>{const n="".concat(e,"-").concat(t.tryHeic),s=new Wp,a=i=>{H2.set(n,i),t.callback(i)},o=()=>{GS.add(async()=>{var l;const i=await SQ(rB(e));i.status===200?i.blob().then(async c=>{const d=await WS(c,t.tryHeic),u={fileName:m3(e),blob:d,url:e};a(u),s.resolve()}).catch(()=>{var c;(c=t.onError)==null||c.call(t),s.resolve()}):((l=t.onError)==null||l.call(t),s.resolve())})};if(H2.has(n)){const i=H2.get(n);if(i){a(i);return}}return GS.add(()=>aB(e).then(async i=>{if(i){const l=await WS(i.blob,t.tryHeic),c={...i,blob:l};a(c),s.resolve()}else o()}).catch(()=>{o()})),s.promise},AQ={grey:"#F2F2F2",brown:"#F0EDE0",orange:"#FFE9D4",yellow:"#FEF7D2",green:"#D9F2EE",blue:"#DCEEFF",purple:"#E9E9FF",pink:"#FEEAF2",red:"#FEE6E2",light_yellow:"#FFFCBF",light_green:"#D1FFF0",light_blue:"#CCF0FF",light_purple:"#E5DAFF",light_red:"#FFD3D3",yellow_green:"#F9F592,#96FBC4",green_blue:"#84FAB0,#79D3FF",blue_purple:"#6BE4FF,#928FFF",purple_red:"#D4A5FF,#FF7697",red_orange:"#F9748F,#FFC6AD"},RQ={grey:"#414242",brown:"#373428",orange:"#503011",yellow:"#5C4D19",green:"#233D29",blue:"#253E5A",purple:"#322B62",pink:"#422238",red:"#4F2828",light_yellow:"#675700",light_green:"#005E47",light_blue:"#00597E",light_purple:"#3B1695",light_red:"#873634",yellow_green:"#4B492C,#2D4B3B",green_blue:"#284B35,#243F4C",blue_purple:"#20444C,#2C2B4C",purple_red:"#40314C,#4C232D",red_orange:"#4B232B,#4C3B34"},PQ={grey:"#929495",brown:"#845C21",orange:"#E96900",yellow:"#E5B007",green:"#009828",blue:"#206CCF",purple:"#5543D3",pink:"#CB1E83",red:"#CB272D",black:"#000000"},LQ={grey:"#7C7C7C",brown:"#95854C",orange:"#EA7E2A",yellow:"#BC9721",green:"#4DB972",blue:"#3A9FCA",purple:"#705EF4",pink:"#BB428B",red:"#D04B4B",black:"#B8B8B8"},BQ={grey:"#474D58",brown:"#51482B",orange:"#683D26",yellow:"#8C652F",green:"#3B5B46",blue:"#263C68",purple:"#472B84",pink:"#8B2B69",red:"#8B2730"},OQ={grey:"#FFFFFFCC",brown:"#FFFFFFCC",orange:"#FFFFFFCC",yellow:"#FFFFFFCC",green:"#FFFFFFCC",blue:"#FFFFFFCC",purple:"#FFFFFFCC",pink:"#FFFFFFCC",red:"#FFFFFFCC"},iB={grey:"#ECEDED",brown:"#E8E5D7",orange:"#F8DEC5",yellow:"#FFF2C5",green:"#D2ECD5",blue:"#D2E1F9",purple:"#DCDCF8",pink:"#F8DAE6",red:"#FFD8D7"},MQ={grey:"#4B4B4B",brown:"#423D2B",orange:"#623B1A",yellow:"#6E5710",green:"#26472E",blue:"#26466A",purple:"#3A307B",pink:"#512241",red:"#632E2E"},UQ={grey:"#40454F",brown:"#494127",orange:"#5E3722",yellow:"#5E4422",green:"#35523F",blue:"#22365E",purple:"#402777",pink:"#8B2B69",red:"#7D232B"},VQ={grey:"#AAAAAA",brown:"#A18151",orange:"#BC814F",yellow:"#B3973C",green:"#46A05E",blue:"#546D8F",purple:"#69629A",pink:"#945A7C",red:"#C1585C"},$Q={grey:"#40454FCC",brown:"#494127CC",orange:"#5E3722CC",yellow:"#5E4422CC",green:"#35523FCC",blue:"#22365ECC",purple:"#402777CC",pink:"#8B2B69CC",red:"#7D232BCC"},HQ={grey:"#747474",brown:"#6F5E43",orange:"#796A37",yellow:"#7D5E42",green:"#3D6F4A",blue:"#4C6380",purple:"#5E598A",pink:"#84526F",red:"#814749"},zQ={grey:"#F7F9F9",brown:"#F8F7F5",orange:"#FFF9F4",yellow:"#FFFCF3",green:"#F4F9F5",blue:"#F2F7FB",purple:"#F5F5FE",pink:"#FDF6F8",red:"#FDF6F6"},qQ={grey:"#252525",brown:"#27231E",orange:"#2A231D",yellow:"#29251B",green:"#1C261F",blue:"#1F242A",purple:"#23222C",pink:"#2A2027",red:"#2A1E1F"},GQ={grey:"#F6F6F6",brown:"#F4F3ED",orange:"#FFF2E6",yellow:"#FEFAE4",green:"#E4F6F3",blue:"#E9F6FF",purple:"#EFEFFF",pink:"#FEF0F6",red:"#FEEFEC",light_yellow:"#FFFDD5",light_green:"#E1FFF5",light_blue:"#D9F4FF",light_purple:"#EEE7FF",light_red:"#FFE3E3"},WQ={grey:"#252525",brown:"#2A2820",orange:"#3F2F1F",yellow:"#41381B",green:"#1F3729",blue:"#203246",purple:"#272230",pink:"#341F2D",red:"#362121",light_yellow:"#4F4407",light_green:"#074939",light_blue:"#07455F",light_purple:"#30166F",light_red:"#652D2B"},KQ={grey:"#E5E6E6",brown:"#E1DDCC",orange:"#FDD9B6",yellow:"#F9EBBC",green:"#C2E3C6",blue:"#CCDAF2",purple:"#D6D6F4",pink:"#F5DBE7",red:"#F7D2D1",black:"#000000"},YQ={grey:"#7C7C7C4D",brown:"#95854C4D",orange:"#EA7E2A4D",yellow:"#BC97214D",green:"#4DB9724D",blue:"#3A9FCA4D",purple:"#705EF44D",pink:"#BB428B4D",red:"#D04B4B4D",black:"#B8B8B84D"},XQ={grey:"#F2F2F2",brown:"#F0EDE0",orange:"#FFE9D4",yellow:"#FEF7D2",green:"#DEF3E0",blue:"#DCEEFF",purple:"#E9E9FF",pink:"#FEEAF2",red:"#FEE6E2"},QQ={grey:"#414242",brown:"#373428",orange:"#503011",yellow:"#5C4D19",green:"#233D29",blue:"#253E5A",purple:"#322B62",pink:"#422238",red:"#4F2828"},x_={grey:"#A2A4A6",brown:"#A9834A",orange:"#FB7145",yellow:"#FFC408",green:"#32B851",blue:"#5094ED",purple:"#7767E5",pink:"#EB58AE",red:"#F95959"},JQ={grey:"#7C7C7C",brown:"#95854C",orange:"#EA7E2A",yellow:"#BC9721",green:"#4DB972",blue:"#3A9FCA",purple:"#705EF4",pink:"#BB428B",red:"#D04B4B"},ZQ={grey:"#0000001A",brown:"#0000001A",orange:"#0000001A",yellow:"#0000001A",green:"#0000001A",blue:"#0000001A",purple:"#0000001A",pink:"#0000001A",red:"#0000001A"},eJ={grey:"#FFFFFF1A",brown:"#FFFFFF1A",orange:"#FFFFFF1A",yellow:"#FFFFFF1A",green:"#FFFFFF1A",blue:"#FFFFFF1A",purple:"#FFFFFF1A",pink:"#FFFFFF1A",red:"#FFFFFF1A"},tJ={grey:"#A2A4A6",brown:"#A9834A",orange:"#FB7145",yellow:"#FFC408",green:"#32B851",blue:"#5094ED",purple:"#7767E5",pink:"#EB58AE",red:"#F95959",black:"#000000"},nJ={grey:"#7C7C7C",brown:"#95854C",orange:"#EA7E2A",yellow:"#BC9721",green:"#4DB972",blue:"#3A9FCA",purple:"#705EF4",pink:"#BB428B",red:"#D04B4B",black:"#B8B8B8"},sJ={pink_purple:"pink",blue_cobalt:"blue"},ri=(e,t,n,s)=>{var i;if(!n)return n;if(n.startsWith("#"))return;["pink_purple","blue_cobalt"].includes(n)&&(n=(i=sJ[n])!=null?i:n);const o=(()=>s!=null&&s.onlyMode?s.onlyMode==="dark":ad())()?t[n]:e[n];if(!o)return n;if(o!=null&&o.includes(",")){const[l,c]=o.split(",");return"linear-gradient(to right, ".concat(l," 0%, ").concat(c," 100%)")}return o},lB=e=>(e==="green_blue"&&(e="green"),e==="gray"&&(e="grey"),e),cs=e=>ri(AQ,RQ,e),tr=e=>ri(PQ,LQ,e),ow=(e,t)=>ri(BQ,OQ,e,t),J1=e=>ri(iB,MQ,e),cB=e=>ri(UQ,VQ,e),rJ=e=>ri($Q,HQ,e),h3=e=>ri(zQ,qQ,e),dB=e=>(e=lB(e),ri(GQ,WQ,e)),KS=e=>(e=lB(e),ri(KQ,YQ,e)),aJ=e=>ri(XQ,QQ,e),Hd=e=>ri(x_,JQ,e),Ph=e=>ri(ZQ,eJ,e),rm=e=>ri(tJ,nJ,e);function oJ(e){let t;const n={};for(const s in e){t=e[s];for(let a=0,o,i=t.length;a<i;a++)o=t.charCodeAt(a),Object.prototype.hasOwnProperty.call(n,o)?n[o]+=",".concat(s):n[o]=s}return n}const uB=oJ(LG),n1=new $v(uB),fB=n1.convert.bind(n1);n1.compare.bind(n1);const{STYLE_NORMAL:mB}=$v,{STYLE_FIRST_LETTER:iJ}=$v;function hB(e){return(t,n)=>e(t,n)===0}function kf(e,t){return e-t}function Rk(e,t){return e.localeCompare(t)}function pi(e,t=!0){return t?(n,s)=>-e(n,s):e}function lJ(e){return(t,n)=>t==null&&n==null?0:t==null?-1:n==null?1:e(t,n)}function so(e){return(t,n)=>t==null&&n==null?0:t==null?1:n==null?-1:e(t,n)}function cJ(...e){return(t,n)=>{for(const s of e){const a=s(t,n);if(a!==0)return a}return 0}}function pB(e=vm){return(t,n)=>{if(t.length<n.length)return-1;if(t.length>n.length)return 1;for(let s=0;s<t.length;s++){const a=e(t[s],n[s]);if(a!==0)return a}return 0}}function Rx(e=vm){return(t,n)=>{const s=Math.max(t.length,n.length);for(let a=0;a<s;a++){const o=e(t[a],n[a]);if(o!==0)return o}return 0}}function dJ(e=vm){return(t,n)=>{const s=t[Symbol.iterator](),a=n[Symbol.iterator]();for(;;){const o=s.next(),i=a.next();if(o.done&&i.done)return 0;if(o.done)return-1;if(i.done)return 1;const l=e(o.value,i.value);if(l!==0)return l}}}function vm(e,t){return Array.isArray(e)&&Array.isArray(t)?pB(vm)(e,t):e===t?0:e<t?-1:1}function Hr(e,t=vm){return(n,s)=>t(e(n),e(s))}function*YS(e){const t=e.length;for(let n=0;n<t;n++){const s=e.charAt(n);if(/^[0-9]$/.test(s))yield[0,s];else if(/^[a-zA-Z]$/.test(s))yield[1,[s.toLowerCase(),s]];else if(uB[s.charCodeAt(0)]){const[a]=n1.single_pinyin(s,{style:mB});yield[2,[a.charAt(0),a,s]]}else yield[3,s.charCodeAt(0)]}}const el=(e,t)=>dJ(vm)(YS(e),YS(t)),Ts="因涉嫌违反平台分享政策，无法查看",Po="未命名用户",_p=()=>"".concat(t1.cdnHost,"fe-web-app-images/default-avatar.svg"),Pk=new Map,uJ=e=>{const{src:t,onError:n,onTryProxy:s}=e,[a,o]=y.useState(t),i=y.useRef(!1),l=y.useRef(!1),c=y.useRef(t),[d,u]=y.useState(!1),f=()=>{s==null||s(),u(!0);const p=Xp(c.current);let g=c.current;p&&(p.searchParams.delete("x-oss-process"),g=p.href),oB(g,{tryHeic:l.current,callback:async _=>{o(URL.createObjectURL(_.blob)),Pk.set(c.current,URL.createObjectURL(_.blob)),u(!1)},onError:()=>{o(_p()),u(!1)}})};return y.useEffect(()=>{if(t!==a){const p=Pk.get(t);o(p!=null?p:t),c.current=t,i.current=!!p,l.current=!1}},[t]),{imgUrl:a,setImgUrl:o,onError:p=>{if(!d){if(!c.current.startsWith("blob")){if(!i.current){i.current=!0,km(c.current)&&(l.current=!0),f();return}if(i.current&&!l.current){l.current=!0,f();return}}n==null||n(p),o(_p())}},isProxyUrl:i,tryHeic:l,proxyLoading:d}},gB=(e,t)=>(e.current===null&&(e.current=t()),e.current),XS={},rr=e=>{const t=y.useRef(XS);return t.current===XS&&(t.current=e()),t.current};function _B(){const[,e]=y.useState({}),t=y.useRef(!1);return t.current=!1,y.useCallback(n=>{t.current||(t.current=!0,Promise.resolve().then(()=>{e(()=>(n==null||n(),{}))}))},[])}function xB(e){const t=y.useRef();return t.current=e,t}function fJ(e){const t=y.useRef(e);return t.current=e,y.useCallback((...n)=>t.current(...n),[])}function yB(e,t){const[n,s]=y.useState(["pending"]);return y.useEffect(()=>{let a=!1;const o=new AbortController;return s(["pending"]),e(o.signal).then(i=>{s(["fulfilled",i])}).catch(i=>{s(["rejected",i])}).finally(()=>{a=!0}),()=>{a||o.abort()}},t),n}const Qp=fn.createContext(void 0),mJ=e=>typeof e=="function",am=e=>{const[t,n]=y.useState(e),s=y.useRef(t),a=y.useCallback(o=>{s.current=mJ(o)?o(s.current):o,n(s.current)},[]);return[t,a,s]},ja=(e,t)=>{const{wait:n=500,type:s="all",mode:a="debounce",enable:o=!0,leading:i=!1,trailing:l=!0}=t||{},[c,d,u]=am({width:(e==null?void 0:e.getBoundingClientRect().width)||0,height:(e==null?void 0:e.getBoundingClientRect().height)||0});return y.useEffect(()=>{if(!e)return;const h=(a==="debounce"?qn:Ps)(g=>{const _=g.target.getBoundingClientRect();if(s==="all")d({width:_.width,height:_.height});else{const x={...u.current,[s]:_[s]};yn(u.current,x)||d(x)}},n,{leading:i,trailing:l}),p=Ku.observe(e,h);return o||p(),()=>{p()}},[e,a,s,n,o,i,l]),c},p3=K1("$onceAnyDay",()=>({})),bB=Qs(p3),FB=(e,t)=>{const{endDay:n,enable:s=!0}=t,a=p3(u=>u[e]),o=y.useCallback(u=>{bB(Yn(f=>{f[e]=u}))},[e]),i=y.useMemo(()=>ue().startOf("day").valueOf(),[]),l=y.useMemo(()=>ue(i).diff(ue(a),"day"),[a,i]),c=y.useMemo(()=>s?n===-1?!a:!a||l>=n:!1,[l,s,n,a]),d=y.useCallback(()=>{o(ue(i).format("YYYY-MM-DD HH:mm"))},[o,i]);return y.useMemo(()=>({lastCloseTime:a,setLastCloseTime:o,showOnce:c,close:d}),[d,a,o,c])},fAe=(e,t)=>{const{endDay:n}=t,s=p3.getState()[e],a=d=>{bB(Yn(u=>{u[e]=d}))},o=ue().startOf("day").valueOf(),i=ue(o).diff(ue(s),"day");return{showOnce:!s||i>=n,close:()=>{a(ue(o).format("YYYY-MM-DD HH:mm"))},lastCloseTime:s,setLastCloseTime:a}},wB=10,iw=20,dr=30;class hJ{constructor(){q(this,"captureListenersMap",new Map);q(this,"normalListenersMap",new Map);q(this,"listenNormal",t=>{const n=this.normalListenersMap.get(t.type);if(n){for(const s of n)if(s.listener(t))break}});q(this,"listenCapture",t=>{const n=this.captureListenersMap.get(t.type);if(n){for(const s of n)if(s.listener(t))break}})}startListenEvent(t,n){window.addEventListener(t,n?this.listenCapture:this.listenNormal,n)}addEventListener(t,n,s=wB,a){const o=a?this.captureListenersMap:this.normalListenersMap;let i=o.get(t);return i||(i=[]),i.length===0&&this.startListenEvent(t,a),i.push({priority:s,listener:n}),i.sort(pJ),o.set(t,i),()=>{this.removeEventListener(t,n,a)}}removeEventListener(t,n,s){const o=(s?this.captureListenersMap:this.normalListenersMap).get(t),i=o==null?void 0:o.findIndex(l=>l.listener===n);i!==void 0&&i>=0&&(o==null||o.splice(i,1)),(o==null?void 0:o.length)===0&&window.removeEventListener(t,s?this.listenCapture:this.listenNormal,s)}}function pJ(e,t){const n=typeof t.priority=="function"?t.priority():t.priority,s=typeof e.priority=="function"?e.priority():e.priority;return n-s}const Ht=new hJ,gJ=()=>{const e=(n,s)=>Math.floor(Math.random()*(s-n+1))+n;let t="";for(let n=0;n<4;n++){const s=e(48,122);if(s>57&&s<65||s>90&&s<97){n--;continue}const a=String.fromCharCode(s);t+=a}return t},Vn=e=>{try{const t=new URL(e);if(t)return t}catch(t){}},QS=/(^\/r\/[^/]+\/?$)/,EB=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","tldraw.com","localhost:3000"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,overridePermissions:{"allow-top-navigation":!0},toEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(QS))return e},fromEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(QS))return e}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,toEmbedUrl:e=>{if(e.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!e.includes("figma.com/embed"))return"https://www.figma.com/embed?embed_host=share&url=".concat(e);try{const t=new URL(e);if(!t.searchParams.has("viewer"))return t.searchParams.set("embed_host","flowus"),t.searchParams.set("viewer","1"),t.toString()}catch(t){}},fromEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(/^\/embed\/?$/)){const n=t.searchParams.get("url");if(n)return n}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,overridePermissions:{"allow-presentation":!0},toEmbedUrl:e=>{if(e.includes("/maps/")){const t=e.match(/@(.*),(.*),(.*)z/);let n;if(t){const[,s,a,o]=t,i=new URL(e).host.replace("www.","");n="https://".concat(i,"/maps/embed/v1/view?key=").concat(UY,"&center=").concat(s,",").concat(a,"&zoom=").concat(o)}else n="";return n}},fromEmbedUrl:e=>{const t=Vn(e);if(!t)return;if(t.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&t.searchParams.has("center")&&t.searchParams.get("zoom")){const s=t.searchParams.get("zoom"),[a,o]=t.searchParams.get("center").split(",");return"https://www.google.com/maps/@".concat(a,",").concat(o,",").concat(s,"z")}}},{type:"val_town",title:"Val Town",hostnames:["val.town"],minWidth:260,minHeight:100,width:720,height:500,doesResize:!0,toEmbedUrl:e=>{const t=Vn(e),n=t&&t.pathname.match(/\/v\/(.+)\/?/);if(n)return"https://www.val.town/embed/".concat(n[1])},fromEmbedUrl:e=>{const t=Vn(e),n=t&&t.pathname.match(/\/embed\/(.+)\/?/);if(n)return"https://www.val.town/v/".concat(n[1])}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,toEmbedUrl:e=>{const t=Vn(e),n=t&&t.pathname.match(/\/s\/([^/]+)\/?/);if(n)return"https://codesandbox.io/embed/".concat(n[1])},fromEmbedUrl:e=>{const t=Vn(e),n=t&&t.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return"https://codesandbox.io/s/".concat(n[1])}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,toEmbedUrl:e=>{const t=/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/,n=e.match(t);if(n){const[s,a,o]=n;return"https://codepen.io/".concat(a,"/embed/").concat(o)}},fromEmbedUrl:e=>{const t=/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/,n=e.match(t);if(n){const[s,a,o]=n;return"https://codepen.io/".concat(a,"/pen/").concat(o)}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,toEmbedUrl:e=>{const t=/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/,n=e.match(t);if(n){const[s,a]=n;return"https://scratch.mit.edu/projects/embed/".concat(a)}},fromEmbedUrl:e=>{const t=/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/,n=e.match(t);if(n){const[s,a]=n;return"https://scratch.mit.edu/projects/".concat(a)}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,overridePermissions:{"allow-presentation":!0,"allow-popups-to-escape-sandbox":!0},isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=Vn(e);if(!t)return;const n=t.hostname.replace(/^www./,"");if(n==="youtu.be"){const s=t.pathname.split("/").filter(Boolean)[0];return"https://www.youtube.com/embed/".concat(s)}else if((n==="youtube.com"||n==="m.youtube.com")&&t.pathname.match(/^\/watch/)){const s=t.searchParams.get("v");return"https://www.youtube.com/embed/".concat(s)}},fromEmbedUrl:e=>{const t=Vn(e);if(!t)return;if(t.hostname.replace(/^www./,"")==="youtube.com"){const s=t.pathname.match(/^\/embed\/([^/]+)\/?/);if(s)return"https://www.youtube.com/watch?v=".concat(s[1])}}},{type:"facebook",title:"FaceBook",hostnames:["*.facebook.com","facebook.com"],width:800,height:450,doesResize:!0,overridePermissions:{"allow-presentation":!0,"allow-popups-to-escape-sandbox":!0},isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=Vn(e);if(!t)return;const n=t.hostname.replace(/^www./,"");if((n==="facebook.com"||n==="m.facebook.com")&&t.pathname.match(/^\/watch/)){const s=t.searchParams.get("v");return"https://www.facebook.com/video/embed?video_id=".concat(s)}},fromEmbedUrl:e=>{const t=Vn(e);if(!t)return;if(t.hostname.replace(/^www./,"")==="facebook.com"){const s=t.pathname.match(/^video_id=([^/]+)\/?/);if(s)return"https://www.facebook.com/watch?v=".concat(s[1])}}},{type:"rutube",title:"Rutube",hostnames:["*.rutube.ru","rutube.ru"],width:800,height:450,doesResize:!0,overridePermissions:{"allow-presentation":!0,"allow-popups-to-escape-sandbox":!0},isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=Vn(e);if(!t)return;const n=t.hostname.replace(/^www./,"");if((n==="rutube.ru"||n==="m.rutube.ru")&&t.pathname.match(/^\/video/)){const s=t.pathname.indexOf("video");if(s!==-1){const a=t.pathname.slice(s+5+1,t.pathname.length);return"https://rutube.ru/play/embed/".concat(a)}}},fromEmbedUrl:e=>{const t=Vn(e);if(!t)return;if(t.hostname.replace(/^www./,"")==="rutube.ru"){const s=t.pathname.match(/^\/embed\/([^/]+)\/?/);if(s)return"https://rutube.ru/video/".concat(s[1])}}},{type:"soundcloud",title:"Soundcloud",hostnames:["*.soundcloud.com","soundcloud.com"],width:800,height:450,doesResize:!0,overridePermissions:{"allow-presentation":!0,"allow-popups-to-escape-sandbox":!0},isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=Vn(e);if(!t)return;if(t.hostname.replace(/^www./,"")!=="w.soundcloud.com")return"https://w.soundcloud.com/player/?url=".concat(encodeURIComponent(e))},fromEmbedUrl:e=>{const t=Vn(e);if(!t)return;if(t.hostname.replace(/^www./,"")==="w.soundcloud.com")return t.searchParams.get("url")}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",overridePermissions:{"allow-popups-to-escape-sandbox":!0},toEmbedUrl:e=>{const t=Vn(e),n=t==null?void 0:t.searchParams.get("cid");if(t!=null&&t.pathname.match(/\/calendar\/u\/0/)&&n){t.pathname="/calendar/embed";const s=Array.from(t.searchParams.keys());for(const a of s)t.searchParams.delete(a);return t.searchParams.set("src",n),t.href}},fromEmbedUrl:e=>{const t=Vn(e),n=t==null?void 0:t.searchParams.get("src");if(t!=null&&t.pathname.match(/\/calendar\/embed/)&&n){t.pathname="/calendar/u/0";const s=Array.from(t.searchParams.keys());for(const a of s)t.searchParams.delete(a);return t.searchParams.set("cid",n),t.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,overridePermissions:{"allow-popups-to-escape-sandbox":!0},toEmbedUrl:e=>{const t=Vn(e);if(t!=null&&t.pathname.match(/^\/presentation/)&&(t!=null&&t.pathname.match(/\/pub\/?$/))){t.pathname=t.pathname.replace(/\/pub$/,"/embed");const n=Array.from(t.searchParams.keys());for(const s of n)t.searchParams.delete(s);return t.href}},fromEmbedUrl:e=>{const t=Vn(e);if(t!=null&&t.pathname.match(/^\/presentation/)&&(t!=null&&t.pathname.match(/\/embed\/?$/))){t.pathname=t.pathname.replace(/\/embed$/,"/pub");const n=Array.from(t.searchParams.keys());for(const s of n)t.searchParams.delete(s);return t.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,toEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/))return e.split("/").pop()?e:void 0},fromEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/))return e.split("/").pop()?e:void 0}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,toEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/))return"".concat(e,"?embed=true")},fromEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/)&&t.searchParams.has("embed"))return t.searchParams.delete("embed"),t.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,toEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(/^\/map\//))return"".concat(t.origin,"/embed").concat(t.pathname)},fromEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(/^\/embed\/map\//))return t.pathname=t.pathname.replace(/^\/embed/,""),t.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,toEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(/^\/(artist|album)\//))return"".concat(t.origin,"/embed").concat(t.pathname)},fromEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(/^\/embed\/(artist|album)\//))return t.origin+t.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=Vn(e);if(t&&t.hostname==="vimeo.com"&&t.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/".concat(t.pathname.split("/")[1],"?title=0&byline=0")},fromEmbedUrl:e=>{const t=Vn(e);if(t&&t.hostname==="player.vimeo.com"){const n=t.pathname.match(/^\/video\/([^/]+)\/?$/);if(n)return"https://vimeo.com/".concat(n[1])}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=Vn(e);if(t&&t.hash.match(/#room=/))return e},fromEmbedUrl:e=>{const t=Vn(e);if(t&&t.hash.match(/#room=/))return e}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return"".concat(t.origin,"/embed").concat(t.pathname,"?cell=*");if(t&&t.pathname.match(/^\/d\/([^/]+)\/?$/)){const n=t.pathname.replace(/^\/d/,"");return"".concat(t.origin,"/embed").concat(n,"?cell=*")}},fromEmbedUrl:e=>{const t=Vn(e);if(t&&t.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/))return"".concat(t.origin).concat(t.pathname.replace("/embed",""),"#cell-*");if(t&&t.pathname.match(/^\/embed\/([^/]+)\/?$/))return"".concat(t.origin).concat(t.pathname.replace("/embed","/d"),"#cell-*")}},{type:"desmos",title:"Desmos",hostnames:["desmos.com"],width:700,height:450,doesResize:!0,toEmbedUrl:e=>{const t=Vn(e);if(t&&t.hostname==="www.desmos.com"&&t.pathname.match(/^\/calculator\/([^/]+)\/?$/)&&t.search===""&&t.hash==="")return"".concat(e,"?embed")},fromEmbedUrl:e=>{const t=Vn(e);if(t&&t.hostname==="www.desmos.com"&&t.pathname.match(/^\/calculator\/([^/]+)\/?$/)&&t.search==="?embed"&&t.hash==="")return e.replace("?embed","")}}];EB.map(e=>e.type);function _J(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function xJ(e,t){const n=Vn(t);if(!n)return;const s=n.host.replace("www.","");for(const a of e)if(CB(a.hostnames,s)){const o=a.fromEmbedUrl(t);if(o)return{definition:a,url:o,embedUrl:t}}}const yJ=e=>e.split("*").map(t=>_J(t)).join(".+"),CB=(e,t)=>!!e.find(n=>{const s=new RegExp(yJ(n));return t.match(s)});function bJ(e,t){const n=Vn(t);if(!n)return;const s=n.host.replace("www.","");for(const a of e)if(CB(a.hostnames,s)){const o=a.toEmbedUrl(t);if(o)return{definition:a,embedUrl:o,url:t}}}function FJ(e,t){var n;try{return(n=bJ(e,t))!=null?n:xJ(e,t)}catch(s){return}}function Z1(e,t){return e.endsWith("/")&&(e=e.slice(0,-1)),e=e.trim(),om(e)?e:t?"https://".concat(e):"http://".concat(e)}const JS=e=>{if(!e)return e;const t=Z1(e);if(!om(t)||Gl.Email.test(e))return e;const n=new URL(t),a=n.hostname.startsWith("www")?n.hostname.slice(4):n.hostname;if(!e.includes(a))return e;if(n.pathname.length+n.search.length+n.hash.length<12)return a+n.pathname+n.search+n.hash;const o=n.pathname+n.search+n.hash,i="".concat(o.slice(0,4),"...").concat(o.slice(-6));return a+i};function om(e){try{return!!new URL(e)}catch(t){return!1}}var $r=(e=>(e.file="file",e.image="image",e.webpage="webpage",e.airtable="airtable",e.figma="figma",e.sketch="sketch",e.modao="modao",e.mockplus="mockplus",e.excalidraw="excalidraw",e.processon="processon",e.canva="canva",e.bilibili="bilibili",e.vqq="vqq",e.music163="music163",e.codesandbox="codesandbox",e.codepen="codepen",e.youku="youku",e.xigua="xigua",e.lusun="lusun",e))($r||{});const g3=async(e="")=>{var t,n,s,a,o;try{if(!e)return{link:e};const i=Z1(e,!0),l=new URL(i||"");let c;if(/airtable\.com/.test(l.host)&&!l.pathname.includes("/embed/"))return c="airtable",{link:"".concat(l.origin,"/embed").concat(l.pathname),website:c};if(/bilibili\.com/.test(l.host)&&!/player\.bilibili\.com/.test(l.host)){const d=l.pathname.split("/");let u=d[2];if(c="bilibili",d[1]==="video"&&u){const f=u.startsWith("BV");return!f&&u.startsWith("av")&&(u=u.replace("av","")),l.searchParams.set("autoplay","0"),{link:"https://player.bilibili.com/player.html?".concat(f?"bvid":"aid","=").concat(u,"&page=1&high_quality=1&as_wide=1&allowfullscreen=true").concat(l.search.replace("?","&")),website:c}}}if(/v\.qq\.com/.test(l.host)){const d=(t=l.pathname.split(".html")[0])==null?void 0:t.split("/"),u=(n=l.searchParams.get("vid"))!=null?n:d==null?void 0:d[d.length-1];if(c="vqq",u)return{link:"https://v.qq.com/txp/iframe/player.html?vid=".concat(u),website:c}}if(/music\.163\.com/.test(l.host)){const d=l.href.split("?"),u=new URLSearchParams(d[1]).get("id");if(c="music163",(s=d[0])!=null&&s.includes("song"))return{link:"https://music.163.com".concat(js?"/m":"","/outchain/player?type=2&id=").concat(u,"&auto=0&height=66"),website:c};if((a=d[0])!=null&&a.includes("playlist"))return{link:"https://music.163.com".concat(js?"/m":"","/outchain/player?type=0&id=").concat(u,"&auto=1"),website:c}}if(/modao\.cc/.test(l.host)&&!l.pathname.includes("/embed/"))return c="modao",{link:"".concat(i,"/embed/v2"),website:c};if(/app\.mockplus\.cn/.test(l.host)&&!l.pathname.includes("/s/"))return c="mockplus",{link:i.replace("/app/","/s/"),website:c};if(/canva\.cn/.test(l.host)&&!l.search.includes("/embed/")){const d=l.pathname.split("/");c="canva";const u=d.slice(0,d.length-1).join("/");return{link:"".concat(l.origin).concat(u,"/view?embed"),website:c}}if(/youku\.com/.test(l.host)&&!l.search.includes("/embed/")){const d=l.pathname.split("/");if(c="youku",(o=d[2])!=null&&o.includes("id"))return{link:"https://player.youku.com/embed/".concat(d[2].replace("id_","").replace(".html","")),website:c}}if(/ixigua\.com/.test(l.host)&&!l.pathname.includes("/iframe/")){const d=l.pathname.split("/");if(d.length>0)return c="xigua",{link:"https://www.ixigua.com/iframe/".concat(d[d.length-1]),website:c}}if(/lusun\.com/.test(l.host)&&!l.pathname.includes("/embed/")){const d=l.pathname.split("/v/"),u=An(d);if(c="lusun",u)return{link:"https://lusun.com/embed/?id=".concat(u,"&").concat(l.search.replace("?","&")),website:c}}if(!c){const d=FJ(EB,i);if(d)return{link:d.embedUrl,website:d.definition.type}}return{link:e,website:c}}catch(i){return{link:e}}},Jt={image:/^(apng|avif|bmp|gif|ico|cur|jpg|jpeg|jfif|pjep|pjp|png|svg|webp|heic|heif|pic|tif)$/i,audio:/^(mp3|wma|wave|flac|aac|cda|midi|ape|aiff|ra|rm|rmx|vqf|amr|aiff|ogg|ac3|m4a|wav)$/i,video:/^(mp4|mov|flv|webm|m4v|rm|rmvb|wmv|avi|mpg|mpeg|flc|mkv|f4v|3gp|asf)$/i,txt:/^(txt|rtf|ts|tsx|js|jsx|html|xml|css|less|scss|cpp|py|c|cs|h|asp|sh|go|java|php|json|yml|md|log|m|ini|lua|sql|rs|rb)$/i,office:/^(doc|docx|xls|xlsx|ppt|pptx)$/i,pdf:/^(pdf)$/i,zip:/^(7z|rar|jar|zip|cab|ace|tar)$/i,ppt:/^(ppt|pptx)$/i,csv:/^(csv)$/i,epub:/^(epub)$/i},wJ=(e="")=>Object.values(Jt).every(t=>!t.test(e)),_3=(e="")=>{const t=Jt.image.test(e),n=wJ(e);return!!(t||n)},Jp=e=>{const{extName:t}=rn(e);if(!(!t||!e)){if(Jt.image.test(t.toLocaleLowerCase())||Jt.video.test(t.toLocaleLowerCase()))return e;if(kB(t)){const[n]=e.split("/");return n?e==null?void 0:e.replace(n,"preview").replace(t.toLocaleLowerCase(),"png"):void 0}}},kB=e=>!!(Jt.office.test(e)||Jt.txt.test(e)||Jt.pdf.test(e)||Jt.csv.test(e)),EJ=["heic","heif","tif","bmp","tiff"],Jo=(e,t)=>EJ.includes(t.toLocaleLowerCase())?Q1(e,"/image/format,png"):e,CJ=e=>{const{key:t,items:n,reverse:s,isNumber:a}=e,o=i=>/^[0-9]*$/.test(i);return n.sort((i,l)=>{const c="".concat(i[t]),d="".concat(l[t]);return a||o(c)&&o(d)?Number(c)-Number(d):el(c,d)}),s?n.reverse():n};const TB=(e,t)=>{let n="";if(!t){try{wS.renderToString(e,{output:"html",displayMode:!0,throwOnError:!0})}catch(s){n="".concat(s.message).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}return{errorMsg:n}}try{wS.render(e,t,{output:"html",displayMode:!0,throwOnError:!0,strict:!1})}catch(s){n=s!=null&&s.message?"".concat(s.message).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):"公式错误"}return{errorMsg:n}},kJ="https://lib.baomitu.com/KaTeX/0.16.9/katex.min.css",TJ="https://cdn2.flowus.cn/emoji/katex.min.css",vJ="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css",IJ="https://cdn.buildin.ai/emoji/katex.min.css";Fi();const vB=e=>{const t=y.useRef(null),{className:n,text:s="",onClick:a,onRender:o,inline:i}=e;return y.useLayoutEffect(()=>{const{errorMsg:l}=TB(s,t.current);o==null||o(l)},[o,s]),r.jsxs("span",{className:n,onClick:a,children:[i?r.jsx("span",{ref:t,className:"inline-latex inline-block"}):r.jsx("div",{ref:t}),e.children]})},x3=(e,t,n="HTML")=>{if(t(e))return!0;let s=e;for(;s.tagName!==n;){if(t(s)||!s.parentNode)return!0;s=s.parentNode}return!1},ZS=e=>!!(e!=null&&e.tagName),Xn=(e,t)=>{if(!e||!t)return!1;switch(t){case m.PermissionRole.NONE:return!0;case m.PermissionRole.READER:return[m.PermissionRole.READER,m.PermissionRole.COMMENTER,m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(e);case m.PermissionRole.COMMENTER:return[m.PermissionRole.COMMENTER,m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(e);case m.PermissionRole.WRITER:return[m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(e);case m.PermissionRole.EDITOR:return e===m.PermissionRole.EDITOR;default:throw new Error("Unhandled role case")}},IB=e=>{const{size:t,success:n,className:s,onChange:a,onError:o,placeholder:i="请输入密码 区分大小写",showSwitchIcon:l=!0}=e,[c,d]=y.useState(""),[u,f]=y.useState(!1);return y.useEffect(()=>{c.length===t&&(/^[a-zA-Z0-9]+$/.test(c)?n(c):o==null||o())},[o,t,c,n]),r.jsxs("div",{className:"relative flex justify-center items-center w-full",children:[r.jsx("input",{autoFocus:!0,type:"text",maxLength:t,autoCorrect:"off",autoCapitalize:"off",placeholder:i,className:R("transition-all w-full text-t2 bg-grey9 border border-grey6 focus:border-black h-9 px-2.5 rounded placeholder-grey4 pr-6",u?"":"textSecurity",s),onInput:h=>{const p=h.currentTarget.value.replaceAll("'","");d(p),a==null||a(p)}}),l&&r.jsx("span",{className:"absolute right-2 animate-click",onClick:()=>f(!u),children:u?"😶":"😶‍🌫️"})]})};class NJ{constructor(){q(this,"queue",[]);q(this,"isRunning",!1);q(this,"run",async()=>{if(!this.isRunning){for(this.isRunning=!0;this.queue.length;){const t=this.queue.shift();if(!t)return;const{text:n,id:s,onError:a,onSuccess:o}=t;try{const{mermaid:i}=window,l=await(i==null?void 0:i.mermaidAPI.render(s,n));o(l.svg)}catch(i){a(i)}}this.isRunning=!1}});q(this,"render",t=>{this.queue.push(t),this.run()})}}const jJ=new NJ,SJ=y.memo(e=>{var h;const{text:t="",className:n,onRender:s,onClick:a}=e,o=y.useRef(null),[i,l]=y.useState(!1),c=y.useRef(qe()),d=wd(),[u,f]=y.useState(window.mermaid);return y.useEffect(()=>{let p=null;return!u&&!kQ&&(p=setInterval(()=>{f(window.mermaid)},1e3)),()=>{p&&clearInterval(p)}},[u]),y.useEffect(()=>{u==null||u.mermaidAPI.initialize({theme:d?"dark":"neutral"})},[d,u]),y.useEffect(()=>{const{mermaid:p}=window,g=o.current;if(g&&p){if(!t){l(!0),g.innerHTML="",s==null||s(!1);return}jJ.render({text:t,id:"mermaid-".concat(c.current),onSuccess:_=>{l(!1),g.innerHTML=_,s==null||s(!0)},onError:_=>{l(!0),g.innerHTML=_,s==null||s(!1)}})}},[t,u]),t?r.jsxs(r.Fragment,{children:[r.jsx("div",{onClick:a,className:R("flex justify-center",i&&"text-red text-t3",n),ref:o},c.current),i&&((h=o.current)==null?void 0:h.innerText.includes("dynamically"))&&r.jsx("div",{className:"text-t3 text-red text-center",children:"资源加载失败，请尝试重新登录"})]}):null}),DJ={[Kl.splitView]:"默认",[Kl.code]:"仅代码",[Kl.preview]:"仅预览"},AJ=["mermaid"],RJ=Object.entries(Kl).map(([e,t])=>({title:DJ[t],value:t})),NB=(e="",t=Kl.splitView)=>{let n=!0,s=!0,a=!0;return t===Kl.code&&(s=!1),t===Kl.preview&&(a=!1),AJ.includes(e.toLocaleLowerCase())||(n=!1,s=!1),{button:n,preview:s,code:a}},nu={[m.PermissionRole.NONE]:0,[m.PermissionRole.READER]:1,[m.PermissionRole.COMMENTER]:2,[m.PermissionRole.WRITER]:3,[m.PermissionRole.EDITOR]:4},jB=[m.BlockType.PAGE,m.BlockType.FOLDER,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION,m.BlockType.REFERENCE_COLLECTION_PAGE,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE],PJ=[m.BlockType.PAGE,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION,m.BlockType.REFERENCE_COLLECTION_PAGE,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE];m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION,m.BlockType.REFERENCE_COLLECTION_PAGE;const eD={[m.PermissionRole.EDITOR]:5,[m.PermissionRole.WRITER]:4,[m.PermissionRole.COMMENTER]:3,[m.PermissionRole.READER]:2,[m.PermissionRole.NONE]:1},tn=e=>e===void 0?!1:jB.includes(e),LJ={shared:!1,illegal:!1,isRestricted:!1,allowDuplicate:!0,allowSelectionCopy:!0,allowDownload:!0,allowShowSidebar:!1,password:void 0,permissions:[],role:m.PermissionRole.NONE,roleWithoutPublic:m.PermissionRole.NONE,publicRole:m.PermissionRole.NONE,allowSeo:!1,allowShowAIChat:!1,allowSubscribe:!1,allowShowBreadcrumb:!0,linkValidDate:void 0,accessFee:0,sharePageDistributionRatio:0,accessFeeValidDays:0,previewBlockCount:0,originPrice:0},BJ=(e,t)=>{var k,T,v,I;const{segmentsToText:n,blocks:s,discussions:a,comments:o,user:i,permissionGroups:l,isSharePage:c,spaces:d,userId:u}=e,f={...LJ},h=u!=null?u:i==null?void 0:i.uuid;if(t==null)return f;let p=s[t];if(!p){if(a[t]!=null){const j=(k=a[t])==null?void 0:k.parentId,S=j==null?void 0:ep(j,e);S!=null&&(p=s[S],t=S)}else if(o[t]!=null){const j=(T=o[t])==null?void 0:T.parentId,S=j==null?void 0:a[j],D=S==null?void 0:S.parentId,A=D==null?void 0:ep(D,e);A!=null&&(p=s[A],t=A)}if(p==null)return f}if(p.permissions.length){const j=p.permissions.some(S=>S.type===m.PermissionType.ILLEGAL);f.illegal=f.illegal||j}const g=new Set,_=j=>{var A,P,L,O,$,M,U,z;if(g.has(j))return;g.add(j);const S=s[j];if(!S||S.type==="SPACE"||S.type===void 0)return;const D=S.permissions.filter(K=>{var W;return K.type!==m.PermissionType.SPACE||((W=d[S.spaceId])==null?void 0:W.permissions)});if(D.length){const K=(te,Q,ne)=>{const se=f.permissions.find(ce=>ce[te]===Q);if(se&&ne&&se.role&&nu[se.role]>nu[ne])return se},W=D.filter(te=>te.type!==m.PermissionType.ILLEGAL&&te.type!==m.PermissionType.RESTRICTED).map(te=>te.type===m.PermissionType.SPACE?K("type",te.type,te.role)||te:te.type===m.PermissionType.GROUP?K("groupId",te.groupId,te.role)||te:te.type===m.PermissionType.USER?K("userId",te.userId,te.role)||te:te.type===m.PermissionType.PUBLIC&&K("type",te.type,te.role)||te),Y=f.permissions.filter(te=>te.type===m.PermissionType.ILLEGAL||te.type===m.PermissionType.RESTRICTED?!1:te.type===m.PermissionType.SPACE||te.type===m.PermissionType.PUBLIC?W.every(Q=>Q.type!==te.type):te.type===m.PermissionType.GROUP?W.every(Q=>Q.groupId!==te.groupId):W.every(Q=>Q.userId!==te.userId));f.permissions=[...W,...Y];const G=D.find(te=>te.type===m.PermissionType.PUBLIC),ee=D.some(te=>te.type===m.PermissionType.RESTRICTED);if(G&&G.openPreview!==void 0&&G.openPreview!==null&&j===t&&(f.openPreview=G.openPreview),G&&f.shared&&((G.allowDuplicate||ol(G.allowDuplicate))&&(f.allowDuplicate=!0),(G.allowSelectionCopy||ol(G.allowSelectionCopy))&&(f.allowSelectionCopy=!0),(G.allowDownload||ol(G.allowDownload))&&(f.allowDownload=!0),G.shareShowSidebar&&(f.allowShowSidebar=!0),G.allowShowBreadcrumb&&(f.allowShowBreadcrumb=!0),G.allowSeo&&(f.allowSeo=!0),G.allowSubscribe&&(f.allowSubscribe=!0),G.allowShowAIChat&&(f.allowShowAIChat=!0),G.accessFee&&(f.accessFee=G.accessFee),G.originPrice&&(f.originPrice=G.originPrice),G.sharePageDistributionRatio&&(f.sharePageDistributionRatio=G.sharePageDistributionRatio),G.accessFeeValidDays&&(f.accessFeeValidDays=G.accessFeeValidDays),G.previewBlockCount&&(f.previewBlockCount=G.previewBlockCount),f.linkValidDate=G.linkValidDate),G!=null&&G.password&&!f.password&&(f.password=G.password),G&&!f.shared&&(f.shared=!!G,f.allowDuplicate=(A=G.allowDuplicate)!=null?A:!0,f.allowSelectionCopy=(P=G.allowSelectionCopy)!=null?P:!0,f.allowDownload=(L=G.allowDownload)!=null?L:!0,f.allowShowBreadcrumb=(O=G.allowShowBreadcrumb)!=null?O:!0,f.allowShowSidebar=($=G.shareShowSidebar)!=null?$:!1,f.password=G.password,f.allowSeo=(M=G.allowSeo)!=null?M:!1,f.allowSubscribe=(U=G.allowSubscribe)!=null?U:!0,f.allowShowAIChat=(z=G.allowShowAIChat)!=null?z:!1,f.linkValidDate=G.linkValidDate,f.accessFee=G.accessFee,f.originPrice=G.originPrice,f.sharePageDistributionRatio=G.sharePageDistributionRatio,f.accessFeeValidDays=G.accessFeeValidDays,f.previewBlockCount=G.previewBlockCount,t!==j&&(f.parentId=S.uuid,f.title=n(S.data.segments))),ee){if(t===j&&(f.isRestricted=!0),S.parentId!==S.spaceId){let te=s[S.parentId];const Q=new Set;for(;te&&!tn(te.type);){const ne=te.parentId;if(Q.has(ne))break;Q.add(ne),te=s[te.parentId]}if(!te)return;f.parentId=te.uuid,f.title=n(te.data.segments)}return}}_(S.parentId)};_(t);const x=f.permissions.find(j=>j.userId===h),F=f.permissions.find(j=>j.type===m.PermissionType.PUBLIC),b=f.permissions.filter(j=>{const S=l==null?void 0:l.find(D=>D.id===j.groupId);return S==null?void 0:S.userIds.includes(h!=null?h:"")}),w=f.permissions.find(j=>j.type===m.PermissionType.SPACE);w||f.permissions.unshift({type:m.PermissionType.SPACE,role:m.PermissionRole.NONE});const E=[x,...b];x!=null&&x.isGuest||E.push(w),f.roleWithoutPublic=E.reduce((j,S)=>{var A;if(!S)return j;const D=(A=S.role)!=null?A:m.PermissionRole.NONE;return nu[D]>nu[j]?D:j},m.PermissionRole.NONE);const C=f.shared&&f.roleWithoutPublic===m.PermissionRole.NONE?m.PermissionRole.READER:f.roleWithoutPublic;return f.role=c?(v=F==null?void 0:F.role)!=null?v:m.PermissionRole.READER:C,f.publicRole=(I=F==null?void 0:F.role)!=null?I:m.PermissionRole.NONE,f},OJ=(e,t,n)=>{const{removeBlockPermission:s,setBlockPermission:a}=n,o={role:t.role,type:t.type};t.type===m.PermissionType.GROUP&&(o.groupId=t.groupId),t.type===m.PermissionType.USER&&(t.isGuest&&(o.isGuest=t.isGuest),o.userId=t.userId),t.role===m.PermissionRole.NONE?s(e,o):a(e,o)},ep=(e,t)=>{const{blocks:n,comments:s,discussions:a}=t,o=n[e];if(!o){const i=s[e];if(i)return ep(i.parentId,t);const l=a[e];return l?ep(l.parentId,t):void 0}return tn(o.type)||o.parentId===o.spaceId?o.uuid:ep(o.parentId,t)},wb=e=>{if(!e)return{showPageIcon:!0,showPage:!0};const t=![m.BlockType.TEXTAREA,m.BlockType.HEADER].includes(e),n=[m.BlockType.BOOKMARK,m.BlockType.EMBED,m.BlockType.DIVIDER,m.BlockType.TABLE,m.BlockType.TEMPLATE,m.BlockType.SYNC_CONTAINER,m.BlockType.SYNC_REFERENCE].includes(e);return{showPageIcon:t,showPage:n}},nc={blocks:{}},xp=(e=[])=>(e||(e=[]),e.map(t=>t.text).join("")),MJ=e=>{var n;const t=e==null?void 0:e.find(s=>s.type===BG.TextType.URL);return(n=t==null?void 0:t.url)!=null?n:xp(e)},SB=e=>{var s;const t={},n=nc.blocks[e];return n&&Object.entries((s=n.data.schema)!=null?s:{}).forEach(([a,o])=>{var l;const i=(l=o.name.split("（")[0])!=null?l:o.name;t[i]={id:a,schema:o}}),t},Eo=(e,t)=>{var i,l;let n;if(typeof e=="string"?n=nc.blocks[e]:n=e,!n)return"";const a=SB(n.parentId)[t],o=a==null?void 0:a.id;if(!o)return"";switch(a.schema.type){case m.CollectionSchemaType.TITLE:return xp(n.data.segments);case m.CollectionSchemaType.FILE:case m.CollectionSchemaType.URL:{const c=(i=n.data.collectionProperties)==null?void 0:i[o];return MJ(c)}default:return xp((l=n.data.collectionProperties)==null?void 0:l[o])}},DB=(e,t)=>{const n={};typeof localStorage<"u"&&(n["x-platform"]="web-cookie"),t={...t,headers:{...t==null?void 0:t.headers,...n}};const s=e.startsWith("http")?e:location.origin+e;return fetch(s,t).then(a=>a.json()).then(a=>a)},UJ="页面标题",VJ="推荐图片",$J="页面链接",tD="付费链接",Lk="一级分类",HJ="是否推荐",zJ="专栏内容定位",qJ="是否上线";var qP,GP;const Lh=(GP=(qP={}.SUBSCRIBE_ID)==null?void 0:qP.split("|")[0])!=null?GP:"6301204f-7892-47c8-9a6a-d34f5c6a8855";let Px;const mAe=async(e,t)=>Px||(Px=GJ(e,t),Px),GJ=async(e,t)=>{var p;const{code:n,data:s}=await DB("".concat(t!=null?t:"","/docs/").concat(Lh));if(n!==200)return;const{blocks:a,collectionViews:o}=s;nc.blocks={...nc.blocks,...a};const i=a[Lh!=null?Lh:""];if(!i)return;const l=(p=i.views)==null?void 0:p[0];if(!l)return;const c=o[l],d=new Set(c==null?void 0:c.pageSort),u=new Set(i.subNodes);c==null||c.pageSort.forEach(g=>{u.has(g)||d.delete(g)});for(const g of i.subNodes)d.has(g)||d.add(g);const h=[...d].map(g=>a[g]).filter(g=>!!g).filter(g=>Eo(g,qJ).toLocaleUpperCase()==="YES");return WJ(h)},WJ=e=>{var c;const t=[],n={};e.forEach(d=>{var p,g;const u=Eo(d,Lk);if(!u)return;const f=KJ(d);if(!f)return;let h=n[u];h||(h={name:u,subscribeInfo:[]},t.push(h),n[u]=h),(g=(p=n[u])==null?void 0:p.subscribeInfo)==null||g.push(f)});const s=SB(Lh);if(!nc.blocks[Lh])return;const{schema:o}=(c=s[Lk])!=null?c:{};if(!(o!=null&&o.options))return;const i={};return o.options.forEach(({value:d},u)=>i["1".concat(d)]=u),((d,u=1)=>{d.sort((f,h)=>{var p,g;return((p=i[u+f.name])!=null?p:0)-((g=i[u+h.name])!=null?g:0)})})(t),t},KJ=e=>{let t;if(typeof e=="string"?t=nc.blocks[e]:t=e,!t)return;const n=Eo(t,$J);let s="";try{const{pathname:i}=new URL(n);s=i.trim().substring(i.lastIndexOf("/")+1)}catch(i){}const a=Eo(t,tD);let o="";try{const{pathname:i}=new URL(a);o=i.trim().substring(i.lastIndexOf("/")+1)}catch(i){o=""}return{id:s||"",url:n,payLink:Eo(t,tD),recordId:t.uuid,title:Eo(t,UJ)||xp(t.data.segments),sourceImage:Eo(t,VJ),isRecommend:Eo(t,HJ).toUpperCase()==="YES",payDocId:o,firstCategoryName:Eo(t,Lk),tag:Eo(t,zJ)}},YJ="专栏链接",XJ="配图",QJ="上架",JJ="图片链接",z2={},ZJ=async(e,t,n)=>{if(z2[e])return z2[e];const s=eZ(e,n,t);return z2[e]=s,s},eZ=async(e,t,n)=>{var g;const{code:s,data:a}=await DB("".concat(n!=null?n:"","/api/docs/").concat(e));if(s!==200)return;const{blocks:o,collectionViews:i}=a;nc.blocks={...nc.blocks,...o};const l=o[e!=null?e:""];if(!l)return;const c=(g=l.views)==null?void 0:g[0];if(!c)return;const d=i[c],u=new Set(d==null?void 0:d.pageSort),f=new Set(l.subNodes);d==null||d.pageSort.forEach(_=>{f.has(_)||u.delete(_)});for(const _ of l.subNodes)u.has(_)||u.add(_);const p=[...u].map(_=>o[_]).filter(_=>!!_).filter(_=>Eo(_,QJ).toLocaleUpperCase()==="YES");return tZ(e,p)},tZ=(e,t)=>{const n=[];if(t.forEach(a=>{const o=nZ(a);o&&n.push(o)}),!!nc.blocks[e])return n},nZ=e=>{let t;if(typeof e=="string"?t=nc.blocks[e]:t=e,!t)return;const n=Eo(t,YJ),s=Eo(t,JJ),a=Eo(t,XJ);return{id:t.uuid,link:n,image:s||a}},nD={normal:"w-[1em] h-[1em]",tiny:"w-2 h-2",xxxsmall:"w-[9px] h-[9px]",xxxsmall_10:"w-2.5 h-2.5",xxsmall:"w-3 h-3",xsmall:"w-3.5 h-3.5",small:"w-4 h-4",middle:"w-5 h-5",large:"w-6 h-6",xlarge:"w-[26px] h-[26px]",xxlarge:"w-7 h-7",xxxlarge:"w-10 h-10",midMax:"w-[46px] h-[46px]",max:"w-[50px] h-[50px]",xmax:"w-20 h-20",preview:"w-[110px] h-[110px]",auto:"w-full h-full"},sD=Object.keys(MG),sZ=()=>{try{return!1}catch(e){return!1}},rZ={MIcInsertBlockText:sZ()?"MIcBinInsertBlockText":"MIcInsertBlockText"},V=e=>{var f;const t=wd(),{size:n="middle",className:s="",style:a={},onClick:o,boxSize:i,...l}=e;let{name:c}=e;if(!c)return null;try{if(c.startsWith("DmIc"))return null}catch(h){return console.log("name",c),null}if(c=(f=rZ[c])!=null?f:c,c.startsWith("MIc")&&t&&(c=c.replace("MIc","DmIc"),sD.includes(c)||(c=c.replace("DmIc","MIc"))),!sD.includes(c))return null;const d=R(s,{"cursor-pointer animate-click":!!o}),u=r.jsx(OG,{...l,"data-icon":c,className:R("flex-shrink-0 fill-current inline",nD[n],!i&&d),onClick:o,style:{verticalAlign:"-0.15em",...a},"aria-hidden":"true",name:c});return i?r.jsx("span",{className:R("flex items-center justify-center",nD[i],s,{"cursor-pointer animate-click":!!o}),children:u}):u},Ct=e=>{var M;const{type:t="text",visible:n=!0,showBorder:s=!0,focusWidthBorder:a=!0,value:o,onChange:i,placeholder:l,addonAfter:c,addonBefore:d,maxLength:u,autoFocus:f,warning:h,inputRef:p,onEnter:g,defaultValue:_,onBlur:x,onFocus:F,selection:b,inputClassName:w="",style:E,readonly:C=!1,onClick:k,onKeyDown:T,disableFloat:v=!1,focusHiddenPlaceholder:I=!1,warningClassName:j,delayFocus:S=0}=e,[D,A]=y.useState(!1),P=y.useRef(!1),L=y.useRef(null),O=y.useRef(!1),$=U=>{if(!i)return;const z=U.target.value;if(e.inputType==="number"&&z.includes("-"))return;let K=z;t==="number"&&v&&(K=parseInt(K,10)),Number.isNaN(K)&&(K=""),i(K)};return y.useEffect(()=>{var U;p&&(p.current=L.current),(b==null?void 0:b[0])!==void 0&&b[1]!==void 0&&((U=L.current)==null||U.setSelectionRange(b[0],b[1])),es(S).then(()=>{var z;f&&((z=L.current)==null||z.focus()),O.current=!0})},[]),r.jsxs("div",{style:E,className:R("text-t2 relative box-border flex items-center rounded border border-grey6 bg-grey9",{hidden:!n,"border-red":h,"focus-within-border":s&&!h&&a,"border-none":!s},e.className),onClick:()=>{var U;k==null||k(),!C&&!d&&!c&&((U=L.current)==null||U.focus())},children:[d&&r.jsx("span",{className:"mr-1 flex h-full items-center justify-center whitespace-nowrap",children:d}),r.jsx("input",{ref:L,spellCheck:!1,className:R("w-full flex-grow cursor-text bg-transparent px-3 align-middle text-black placeholder-grey4 outline-none",w),type:(M=e.inputType)!=null?M:"text",onKeyDown:U=>{if(T)T(U);else{if(U.stopPropagation(),Ie("mod+s")(U)&&U.preventDefault(),P.current)return;Ie("enter")(U)&&g&&g(U)}},disabled:C,onFocus:()=>{C||(F==null||F(),A(!0))},onBlur:()=>{O.current&&(x==null||x(),A(!1))},onClick:U=>{var z;(z=L.current)==null||z.focus(),U.stopPropagation()},autoFocus:f,maxLength:u||-1,value:o,defaultValue:_,placeholder:I&&D?"":l,onInput:$,onCompositionStart:()=>{var U;(U=e.onCompositionChange)==null||U.call(e,!0),P.current=!0},onCompositionEnd:()=>{var U;(U=e.onCompositionChange)==null||U.call(e,!1),P.current=!1},style:e.inputStyle}),c&&r.jsx("span",{className:"flex h-full items-center justify-center whitespace-nowrap mr-1",children:c}),h&&r.jsx("span",{className:R("text-t4 absolute bottom-full left-2 mb-0.5 text-red",j),children:h})]})},y3=e=>{const{inputProps:t,addonAfter:n,addonBefore:s,disabled:a,showBorder:o=!0,className:i,...l}=e;return r.jsxs("div",{className:R("flex items-center rounded relative box-border text-t1 border border-grey6 bg-grey9",{"transition-all focus-within:border-p6":o,"border-none":!o,"opacity-60":a},i),children:[s&&r.jsx("span",{className:"flex items-center justify-center h-full mr-1 whitespace-nowrap",children:s}),r.jsx("input",{spellCheck:!1,className:R("px-2.5 border-none align-middle cursor-text flex-grow text-black outline-none bg-transparent placeholder-grey4 w-full text-t2",{"text-grey2":a}),disabled:a,...t,...l}),n&&r.jsx("span",{className:"flex items-center justify-center h-full pl-2 whitespace-nowrap",children:n})]})},Bk=e=>y.useMemo(()=>{const t={};return n=>{let s=t[n];if(typeof s=="number")return s;s=0;let a=n;for(;a>0;)a-=1,s+=e(a);return t[n]=s,s}},[e]),AB=y.createContext(void 0),aZ=e=>{const t=y.useRef(null);return r.jsx(AB.Provider,{value:{...e,contentRef:t},children:e.children})},lw=()=>{const e=y.useContext(AB);if(!e)throw new Error("useGrid 需要在 GridProvider 内使用");const{scrollXRef:t,scrollYRef:n,colCount:s,rowCount:a,getColWidth:o,getRowHeight:i}=e,l=Bk(o),c=Bk(i),d=l(s-1)+o(s-1),u=c(a-1)+i(a-1),f=y.useCallback(h=>{const p=t.current;if(typeof h.x=="number"&&p){const _=l(h.x);p.scrollTo({left:_,behavior:"smooth"})}const g=n.current;if(typeof h.y=="number"&&g){const _=l(h.y);g.scrollTo({top:_,behavior:"smooth"})}},[l,t,n]);return{...e,totalWidth:d,totalHeight:u,getLeft:l,getTop:c,scrollTo:f}},Bh=(e,t,n=0)=>{let s=0,a=n;for(;s<e;)s+=t(a),a+=1;return a};function Ok(e){return e===window}const Lx=5,oZ=()=>{const{getLeft:e,getTop:t,getRowHeight:n,getColWidth:s,getRowKey:a,getColKey:o,renderCell:i,renderRow:l}=lw(),[[c,d],[u,f]]=iZ(),h=[];for(let p=u;p<f;p++){const g=t(p),_=n(p),x=a(p),F=[];for(let b=c;b<d;b++){const w=o(b),E=e(b),C=s(b);F.push(r.jsx("div",{className:"absolute cell",style:{top:0,left:E,width:C,height:_},children:i(b,p)},"".concat(w,"-").concat(x)))}l?h.push(r.jsx("div",{className:"absolute",style:{top:g,left:0},children:l(p,F)},x)):h.push(r.jsx("div",{className:"absolute",style:{top:g,left:0},children:F},x))}return h},iZ=()=>{const{contentRef:e,scrollXRef:t,scrollYRef:n,colCount:s,rowCount:a,getColWidth:o,getRowHeight:i}=lw(),[l,c]=y.useState([[0,0],[0,0]]);return y.useEffect(()=>{const d=e.current,u=t.current,f=n.current;if(!d||!u||!f)return;let h,p,g,_,x,F;const b=()=>{Ok(u)?(h=d.offsetLeft,p=window.innerWidth,F=()=>window.scrollX):(h=d.offsetLeft-u.offsetLeft,p=u.getBoundingClientRect().width,F=()=>u.scrollLeft),Ok(f)?(_=d.offsetTop,x=window.innerHeight,g=()=>window.scrollY):(_=d.offsetTop-f.offsetTop,x=f.getBoundingClientRect().height,g=()=>f.scrollTop)},w=()=>{const k=F()-h;let T=Bh(k,o),v=Bh(p,o,T);T=Math.max(T-Lx,0),v=Math.min(v+Lx,s),c(([,I])=>[[T,v],I])},E=()=>{const k=g()-_;let T=Bh(k,i),v=Bh(x,i,T);T=Math.max(T-Lx,0),v=Math.min(v+Lx,a),c(([I])=>[I,[T,v]])},C=qn(()=>{b(),w(),E()},60,{leading:!0});return C(),u.addEventListener("scroll",w),f.addEventListener("scroll",E),window.addEventListener("resize",C),()=>{u.removeEventListener("scroll",w),f.removeEventListener("scroll",E),window.removeEventListener("resize",C)}},[e,t,n,a,s,o,i]),l},lZ=()=>{const{totalWidth:e,totalHeight:t,contentRef:n}=lw(),s=oZ();return r.jsx("div",{className:"relative cell-container",ref:n,style:{width:e,height:t},children:s.length>0?s:r.jsx("span",{className:"relative pl-2 text-grey3 text-t3 top-1",children:"表格内容为空"})})};y.forwardRef((e,t)=>r.jsxs(aZ,{...e,children:[r.jsx(cZ,{ref:t}),r.jsx(lZ,{})]}));const cZ=y.forwardRef((e,t)=>{const n=lw();return y.useImperativeHandle(t,()=>n,[n]),null}),RB=y.createContext(void 0),dZ=e=>r.jsx(RB.Provider,{value:e,children:e.children}),cw=()=>{const e=y.useContext(RB);if(!e)throw new Error("useList 需要在 ListProvider 内使用");const{getItemSize:t,scrollRef:n,count:s,direction:a}=e,o=Bk(t),i=s-1,l=o(i)+t(i);return{...e,getItemOffset:o,scrollTo:d=>{var h;const u=(h=n==null?void 0:n.current)!=null?h:window,f=o(d);typeof u.scrollTo=="function"?u.scrollTo({[a==="horizontal"?"left":"top"]:f,behavior:"smooth"}):u instanceof Element&&(u[a==="horizontal"?"scrollLeft":"scrollTop"]=f)},totalSize:l}},ot=new Proxy({},{get(e,t){var s;return(s=new URLSearchParams(location.search).get(t))!=null?s:void 0}}),rD=(e,t)=>Math.max(Math.round(e/t*1e4)/100,0),uZ=y.forwardRef(({children:e},t)=>{const{totalSize:n,direction:s}=cw();return r.jsxs("div",{ref:t,style:s==="horizontal"?{width:n}:{height:n},className:"relative block-list",children:[e,fZ()]})}),fZ=()=>{const{getItemOffset:e,getItemSize:t,getItemKey:n,renderItem:s,direction:a}=cw(),[o,i]=mZ(),l=[];for(let c=o;c<i;c++){const d=e(c),u=t(c);l.push(r.jsx("div",{className:a==="horizontal"?"h-full print:min-h-fit":"min-w-full print:min-w-fit",style:a==="horizontal"?{position:"absolute",top:0,left:d,width:u}:{position:"absolute",top:d,left:0,height:u},children:s(c)},n(c)))}return l},mZ=()=>{const{contentRef:e,scrollRef:t,count:n,bufferSize:s=5,getItemSize:a,direction:o}=cw(),[i,l]=y.useState([0,s]);y.useEffect(()=>{var F;const u=e.current,f=(F=t==null?void 0:t.current)!=null?F:window;if(!u)return;let h=0,p,g;const _=qn(()=>{const b=o==="horizontal"?"left":"top";Ok(f)?(h=u.getBoundingClientRect()[b],p=o==="horizontal"?window.innerWidth:window.innerHeight,g=()=>window[o==="horizontal"?"scrollX":"scrollY"]):(h=u.getBoundingClientRect()[b]-f.getBoundingClientRect()[b]+f[o==="horizontal"?"scrollLeft":"scrollTop"],p=f.getBoundingClientRect()[o==="horizontal"?"width":"height"],g=()=>f[o==="horizontal"?"scrollLeft":"scrollTop"])},300,{leading:!0,trailing:!1}),x=()=>{_();const b=g()-h;let w=Bh(b,a),E=Bh(p,a,w);w=Math.max(w-1-s,0),E=Math.min(E+s,n),l([w,E])};return f.addEventListener("scroll",x),window.addEventListener("resize",x),x(),()=>{f.removeEventListener("scroll",x),window.removeEventListener("resize",x)}},[t,e,n,a,s,o]);const[c,d]=i;return[c,Math.min(d,n)]},b3=y.createContext(!1),Mk=y.forwardRef((e,t)=>{const n=y.useRef(null),{virtualized:s=!0,stickyIndex:a=-1,stickyClassName:o}=e;return ot.print||!s?a>=0?r.jsxs(r.Fragment,{children:[r.jsx(b3.Provider,{value:!0,children:r.jsxs("div",{className:R("flex bg-white1 items-center sticky left-0 z-[10] h-full",o),children:[e.beforeAppendChild,Array.from(Array(a+1)).map((i,l)=>e.renderItem(l)),e.afterAppendChild]})}),Array.from(Array(Math.max(e.count-a+1,0))).map((i,l)=>e.renderItem(l+a+1))]}):r.jsx(r.Fragment,{children:Array.from(Array(e.count)).map((i,l)=>e.renderItem(l))}):r.jsxs(dZ,{...e,contentRef:n,children:[r.jsx(hZ,{ref:t}),r.jsx(uZ,{ref:n,children:e.children})]})}),hZ=y.forwardRef((e,t)=>{const n=cw();return y.useImperativeHandle(t,()=>n),null}),Gs=e=>({"data-test-id":e});var Hs=(e=>(e.menuDown="menu-down",e.menuMore="menu-more",e.DocTitle="doc-title",e.asideHeader="aside-header",e.asideTocHeaderCreateByPrivate="aside-toc-header-create-by-private",e.asideTocHeaderCreateBySpace="aside-toc-header-create-by-space",e.asideDriveHeaderCreate="aside-drive-header-create",e.asideItemCreate="aside-item-create-by-private",e.asideItemCreateByPrivate="aside-item-create-by-private",e.asideItemCreateBySpace="aside-item-create-by-space",e.asideItemToc="aside-item-toc",e.asideItemFolder="aside-item-folder",e.asideItemMore="aside-item-more",e.asideSpaceItem="aside-space-item",e.asideSpaceCreate="aside-space-create",e.asideSpaceSetting="aside-space-setting",e.trashItemRestore="trash-item-restore",e.trashItemDelete="trash-item-delete",e.trashItem="trash-item",e.trashButton="trash-button",e.deleteBarRestore="delete-bar-restore",e.deleteBarDelete="delete-bar-delete",e.pageHeaderMore="page-header-more",e.moveToInput="move-to-input",e.moveToItem="move-to-item",e.emptyCreateDoc="empty-create-doc",e.settingAccountInput="setting-account-input",e.settingSpaceInput="setting-space-input",e.settingSpaceDelete="setting-space-delete",e.settingSave="setting-save",e.settingCancel="setting-cancel",e.createSpaceCancel="create-space-cancel",e.createSpaceInput="create-space-input",e.createSpaceSave="create-space-save",e.warningModalConfirm="warning-modal-confirm",e.warningModalCancel="warning-modal-cancel",e.driveHeaderUpload="drive-header-upload",e.driveHeaderFolder="drive-header-folder",e.driveTitle="drive-title",e.driveFileItem="drive-file-item",e.driveFileItemInput="drive-file-item-input",e.driveFileShare="drive-file-share",e.driveFileMore="drive-file-more",e))(Hs||{});const Uk=qe(),Yc={},pZ=8,PB=()=>{let e=0;Object.values(Yc).forEach((t,n)=>{const s=t.clientHeight;n===0&&(e+=40),e+=s+pZ;const a=e-s;t.classList.add("animate__animated","animate__faster","animate__fadeInDown","mt-4"),t.setAttribute("style","position:fixed; transition: all .15s; z-index:8849; top:-40px; left:0; right:0; width:fit-content; margin:0 auto; margin-top: ".concat(a,"px; animation-duration: 0.2s; max-width:90%;"))})},LB=e=>{var t;(t=Yc[e])==null||t.classList.add("animate__fadeOutUp"),setTimeout(()=>{var n;(n=Yc[e])==null||n.remove(),delete Yc[e],PB()},300)},aD=e=>{const{content:t,duration:n,icon:s,key:a,messageType:o}=e,i=a||qe();if(Yc[i])return o==="loading"&&Ls.render(r.jsx(oD,{icon:s,content:t,duration:n,itemId:i,messageType:o}),Yc[i]),i;const l=document.createElement("div");return l.id=i,document.getElementById("root").appendChild(l),Yc[i]=l,PB(),Ls.render(r.jsx(oD,{icon:s,content:t,duration:n,itemId:i,messageType:o}),l),i},oD=e=>{const{icon:t,content:n,duration:s=3e3,itemId:a,messageType:o}=e;return y.useEffect(()=>{s!==0&&setTimeout(()=>{LB(a)},s)},[s,a]),r.jsxs("div",{className:"flex items-center px-3 py-2 next-modal bg-white4 min-h-[40px] text-t3 w-full",children:[r.jsx("span",{className:R("mr-2 pointer-events-none text-[12px]",{"animate-flash":o==="loading"}),children:t}),r.jsx("span",{className:"break-words",children:n})]})},Bx=(e,t)=>{var s;const n={loading:"⌛️",warning:"😮",error:"😱",success:"🥳"};return aD(typeof t=="object"?{content:t.content,duration:t.duration,key:t.key,messageType:e,icon:(s=t.icon)!=null?s:n[e]}:{content:t,icon:n[e]})},be={success:e=>Bx("success",e),error:e=>Bx("error",e),warning:e=>Bx("warning",e),loading:e=>Bx("loading",typeof e=="string"?e:{duration:0,...e}),closeMessage:LB,exists:e=>!!Yc[e],getAll:()=>ka(Yc)},iD=(()=>{try{return{}.PROXY_TARGET||{}.NEXT_PUBLIC_PROXY_TARGET||{}.PROXY_TARGET}catch(e){return""}})(),gZ=e=>{const t=YP.create({validateStatus(){return!0},...e.config});t.interceptors.request.use(s=>{var l;let{url:a=""}=s;const{method:o,params:i}=s;return o==="get"&&i&&(a+="?",Object.keys(i).forEach(c=>{const d=i[c];d!==void 0&&(a+="".concat(c,"=").concat(encodeURIComponent(d),"&"))}),s.url=a.slice(0,a.length-1),s.params=void 0),((l=e.onRequest)==null?void 0:l.call(e,s))||s}),t.interceptors.response.use(s=>{var a;return((a=e.onResponse)==null?void 0:a.call(e,s))||s});const n=async s=>{const{method:a,path:o,headers:i,query:l,formData:c,body:d}=s,u=o.replace(/[:]/g,"_");let f=d;c&&(f=new FormData,Object.entries(f).forEach(([h,p])=>{p!=null&&f.append(h,p)}));try{const h=await t({method:a,url:u,params:l,data:f,headers:{"Content-Type":"application/json",...i}});return h.data.code!==200&&console.error(h.data),{url:u,ok:!0,status:h.status,statusText:h.statusText,body:h.data}}catch(h){return{url:u,ok:!0,status:500,statusText:"500",body:{code:500,msg:"network error"}}}};return{api:m.createRequest(n,e.onError),axios:t}},{api:_Z,axios:BB}=gZ({onError:e=>{if(e.code===502)return;const t=e.msg||e.message,n=String(t).toLocaleLowerCase();try{t&&(/内部错误|超时|server error|timeout/.test(n)||be.error({key:"msg",content:t}));const s=be.getAll();setTimeout(()=>{s.forEach(be.closeMessage)},5*1e3)}catch(s){console.error(n)}},config:{baseURL:iD?"".concat(iD,"/api"):"/api",withCredentials:!0}}),Eb=(e,...t)=>new Promise(n=>{const s=W1();s==null||s.invoke(e,...t).then(n)}),xh=(e,t)=>{const n=W1();n==null||n.on(e,t)},Zp=(e,...t)=>{const n=W1();n==null||n.send(e,...t)},{VITE_PREFIX:e0="https://flowus.cn",VITE_CDN_HOST:Lo,VITE_STRIPE_PUBLIC_KEY:xZ,VITE_OSS_CDN_HOST:yZ,VITE_SUBSCRIBE_ID:hAe,VITE_NOTION_CLIENT_ID:bZ}={VITE_DOCUMENT_TITLE:"FlowUs 息流｜一站式知识创作与发布平台",VITE_OSS_CDN_HOST:"https://cdn2.flowus.cn/",VITE_ENV:"production",VITE_VOLCENGINE_TRACK_ID:"303823",VITE_URL_SPLIT_TEXT:"【FlowUs 息流】",VITE_WECHAT_ACCOUNT:"wx1736ff051cca370b",VITE_NOTION_CLIENT_ID:"f843d557-50d6-4110-b05c-6e60029bd338",VITE_PRODUCT_ALL_NAME:"FlowUs 息流",VITE_TEMPLATE_ID:"6a4efea1-e023-4e99-bb69-d69af5909412",VITE_OSS_UPLOAD_URL:"https://oss.flowus.com.cn",VITE_PREFIX:"https://flowus.cn",VITE_WECHAT_APP_ID:"wx7de87594073bf09f",VITE_GIT_COMMIT:"582aec734b7f0b024b82d1a8b60184f8ae9ec2c7",VITE_IMPORTANT_FEATURE_COLLECTION_ID:"6fcef75c-2637-42e8-86d7-2d59bdef4807",VITE_PRODUCT_AI_NAME:"FlowUs AI",VITE_SUBSCRIBE_ID:"6301204f-7892-47c8-9a6a-d34f5c6a8855",VITE_DESCRIPTION:"使用 Flowus 构建您的知识平台，助您轻松创作与发布",VITE_WPS_KEY:"SX20231127MUOIEW",VITE_BUCKET:"flowus-1316188996",VITE_CDN_HOST:"https://cdn2.flowus.cn/",VITE_AD_COLLECTION_ID:"d103bcd6-5712-4aa4-8c03-385add1f2391",VITE_PRODUCT_NAME:"FlowUs",VITE_SERVICE_CENTER_COLLECTION_ID:"14620f35-b0be-4d28-8a10-f3ae4809af43|e077dd8f-a2d7-46e6-a97e-3167cf8665e0",BASE_URL:"https://cdn2.flowus.cn/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,LEGACY:!1},FZ=null,wu=()=>{try{return!1}catch(e){return{}.VITE_PRODUCT==="buildin"}},Vk="tocCollapsed",s1="userId",lD="lastViewPage",cD="expandFoldList",$k="token",Hk="currentSpaceViewId",t0="color_picker_last_used_color_info",wZ="create_form",OB="theme_mode",pAe="last_get_notification_time",MB="folder_view_type_list",UB="pdfHistorySidebar",EZ="TABLE_CELL_MENU",F3="未命名成员组",fo="未命名页面",VB="未命名收集表",y_="未命名多维表",$B="未命名文件夹",HB="未命名文件",dD="未命名思维导图",w3="未命名代码块",E3="公开分享",CZ="链接分享",kZ="无访问权限",gAe="new_space",tp="00000000-0000-0000-0000-000000000000",uD={[m.BlockType.PAGE]:fo,[m.BlockType.FOLDER]:$B,[m.BlockType.FILE]:HB,[m.BlockType.COLLECTION_VIEW]:y_,[m.BlockType.COLLECTION_VIEW_PAGE]:y_,[m.BlockType.REFERENCE_COLLECTION]:y_,[m.BlockType.REFERENCE_COLLECTION_PAGE]:y_,[m.BlockType.CODE]:w3,[m.BlockType.MIND_MAPPING_PAGE]:dD,[m.BlockType.MIND_MAPPING]:dD},TZ=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST],dw=new URL(e0).host,On="YYYY/MM/DD HH:mm",vZ="YYYY/MM/DD HH:mm:ss",Et="YYYY/MM/DD",np="MM/DD",co="HH:mm",uo=708,Od=l3(e0),{publicLink:ds}=PL(),uc={PAGE_HISTORY:"PAGE_HISTORY",PAGE_FEEDS:"PAGE_FEEDS",NOTIFICATION:"NOTIFICATION",FORM_PREVIEW:"FORM_PREVIEW",PAGE_TEMPLATE:"PAGE_TEMPLATE",RIGHT_PAGE:"RIGHT_PAGE",RIGHT_PAGE_TITLE:"RIGHT_PAGE_TITLE",RIGHT_PAGE_MIND:"RIGHT_PAGE_MIND",MAIN_PAGE:"MAIN_PAGE",FORM_END_PAGE:"FORM_END_PAGE",PAGE_LITE:"PAGE_LITE"},IZ=2,NZ="1.126.0-2024/12/10 20:49:13".split("-")[0]||"",jZ="".concat(e0,"/login?promotionChannel=Share_02"),zB="200MB",SZ=" 3 次",eg=()=>{var e;return(e=tm.get("next_auth"))!=null?e:localStorage.getItem($k)},Im=/^(jpg|jpeg|png|bmp|webp|tiff)$/i;function qB(e){try{return new URL(Z1(e)).hostname}catch(t){return e}}function DZ(e){if(!e)return"";const t=e.lastIndexOf("."),n=e.substring(t+1);let s="";return Im.test(n.toLocaleLowerCase())&&(s="x-oss-process=image/resize,w_".concat(Math.floor(500*Math.ceil(window.devicePixelRatio)),"/quality,q_100/")),"".concat(yZ).concat(encodeURIComponent(e),"?").concat(s)}const GB=e=>{if(Qr(Nt.share,"startsWith",e)||Qr(Nt.form,"startsWith",e))return;const t=e.slice(-36);if(!Wc(t))return;const n=e.split("/");if(n.length>=3&&n.length<=4)return n[1]},Qr=(e,t="includes",n=location.pathname)=>(n.endsWith("/")||(n="".concat(n,"/")),t==="startsWith"?n.startsWith(e):t==="endsWith"?n.endsWith(e):n.includes(e)),_Ae=(e,t)=>{var a;const{pathname:n}=t;if(n==="/".concat(e))return;const s=GB(n);if(s!==e){const o=n.indexOf(s!=null?s:""),i=t.pathname.slice(o+((a=s==null?void 0:s.length)!=null?a:0));return e?"/".concat(e).concat(i):"".concat(i)}},WB=["test","staging","dev","alpha"].includes("production")?4:3,AZ=e=>/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(e),Eu=()=>{const e=window.location.hostname.split("."),[t=""]=e;if(e.length===WB&&t!=="www")return AZ(window.location.hostname)||/flowus|allflow/.test(t)?void 0:t},r1=()=>{const{hostname:e,protocol:t,port:n}=window.location,s=e.split(".");return s.length===WB&&s.shift(),"".concat(t,"//").concat(s.join(".")).concat(n?":".concat(n):"")},RZ={"X-SENDER-ID":Uk,"x-platform":gs.check?"desktop":"web-cookie","x-product":"flowus",app_version_name:NZ,"x-app-origin":"web","Accept-Language":void 0};BB.interceptors.request.use(e=>{const t=eg();t&&(e.headers.Authorization="Bearer ".concat(t));const n=o3(Kp.PASSWORD);return n&&(e.headers["share-password"]=n),Object.assign(e.headers,RZ),e});BB.interceptors.response.use(e=>{if(e.status===401||e.data&&e.data.code===401){if(e.config.url==="/users/me")return e;if(localStorage.removeItem(s1),localStorage.removeItem($k),!Qr(Nt.login)){if(window.location.pathname===Nt.main&&Eu())return e;if(Qr(Nt.form,"startsWith"))return;window.location.pathname=Nt.login}}else{const t=e.headers["x-set-token"];t&&localStorage.setItem($k,t)}return e});const ve=_Z,PZ={activityList:[],basicList:[],advancedList:[],otherList:{}},n0=Aa(()=>PZ),LZ=Qs(n0),S_=()=>n0.getState(),BZ=e=>{const{activityList:t,basicList:n=[],advancedList:s=[],otherList:a=[]}=e;LZ(o=>({...o,activityList:t,basicList:n,advancedList:s,otherList:Hv(a,"uuid")}))},KB=()=>n0(e=>e.activityList),OZ=new Date("2023-04-10").getTime(),YB=()=>{const e=KB();return y.useMemo(()=>{const t=new Date().getTime();return e.some(n=>{const s=n.status==="abandoned";return!n.viewed&&!s?!(n.startTime&&n.startTime<OZ||n.endTime&&n.endTime<t):!1})},[e])},fD="getNewWelfareCodeCountTime",XB=()=>{const e=localStorage.getItem(fD),t=e?Number(e):Date.now();ve.infra.getNewWelfareCodeCount(t).then(n=>{const{unread:s=0}=n;st({$exChangeCodeRedBadge:!!s}),localStorage.setItem(fD,String(Date.now()))})};class MZ{constructor(){q(this,"status","online");q(this,"statusChange$",new V1)}get online(){return this.status==="online"}get offline(){return this.status==="offline"}setStatus(t){this.status!==t&&(this.status=t,this.statusChange$.next())}get onStatusChange(){return this.statusChange$.asObservable()}}const Ta=new MZ,UZ=e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([n,s])=>{Array.isArray(s)?s.forEach(a=>{t.append(n,"".concat(a))}):t.append(n,"".concat(s!=null?s:""))}),t.toString()},VZ=e=>{const t=new URLSearchParams(e),n={};for(const[s,a]of t.entries())n[s]!=null?(Array.isArray(n[s])||(n[s]=[n[s]]),n[s].push(a)):n[s]=a;return n},uw={stringify:UZ,parse:VZ},QB=()=>{const e=localStorage.getItem(MB);return e?JSON.parse(e):{}};var Ti=(e=>(e.system="system",e.light="light",e.dark="dark",e))(Ti||{}),Xs=(e=>(e[e.TABLE=0]="TABLE",e[e.THUMBNAIL=1]="THUMBNAIL",e[e.PREVIEW=2]="PREVIEW",e))(Xs||{});const JB=()=>{const e=localStorage.getItem(OB);return e?Ti[e]:Ti.system},$Z=50;function HZ(e){return{itemsKeys:e.itemsKeys,items:new Map(e.items)}}let Ai=class{constructor(t,n,s){q(this,"storage");q(this,"saveKey");q(this,"capacity");q(this,"lruInfo");q(this,"listeners");q(this,"isBatch",!1);q(this,"batch",t=>{this.isBatch=!0,t(),this.isBatch=!1;try{this.persistence()}catch(n){console.error(n)}});q(this,"addChangeListener",t=>{this.listeners.push(t)});q(this,"removeChangeListener",t=>{const n=this.listeners.indexOf(t);n!==-1&&mD(this.listeners,n)});q(this,"notifyChangeListener",()=>{this.listeners.forEach(t=>{t()})});this.storage=t,this.saveKey=n,this.capacity=s!=null?s:$Z,this.lruInfo={itemsKeys:[],items:new Map},this.listeners=[];try{const a=this.storage.getItem("LRU::".concat(this.saveKey));if(a){const o=JSON.parse(a),i=HZ(o);i.items.size===i.itemsKeys.length&&(this.lruInfo=i),this.tryClearData()}}catch(a){}this.clearOldData()}clearOldData(){this.storage.removeItem("".concat(this.saveKey,"_count")),this.storage.removeItem("".concat(this.saveKey,"_keys")),this.storage.removeItem("".concat(this.saveKey,"_map"))}put(t,n,s){this.lruInfo.items.set(t,{value:n,expireTime:s});const a=this.lruInfo.itemsKeys.indexOf(t);if(a>=0?hD(this.lruInfo.itemsKeys,a,0):this.lruInfo.itemsKeys.splice(0,0,t),this.tryClearData(),!this.isBatch){try{this.persistence()}catch(o){console.error(o)}this.notifyChangeListener()}}tryClearData(){for(;this.lruInfo.itemsKeys.length>this.capacity;){const t=[],n=Date.now();if(this.lruInfo.items.forEach((s,a)=>{s.expireTime&&s.expireTime<n&&t.push(a)}),t.forEach(s=>{this.delete(s)}),t.length===0){const s=this.lruInfo.itemsKeys.pop();s!==void 0&&this.lruInfo.items.delete(s)}}}clear(){this.lruInfo.itemsKeys=[],this.lruInfo.items.clear(),this.storage.removeItem("LRU::".concat(this.saveKey)),this.notifyChangeListener()}get(t){const n=this.lruInfo.itemsKeys.indexOf(t);if(n===-1)return null;const s=this.lruInfo.items.get(t);if(s&&s.expireTime&&s.expireTime<Date.now()){this.delete(t);return}return hD(this.lruInfo.itemsKeys,n,0),s==null?void 0:s.value}delete(t){const n=this.lruInfo.itemsKeys.indexOf(t);if(n===-1)return!1;mD(this.lruInfo.itemsKeys,n);const s=this.lruInfo.items.delete(t);return this.persistence(),this.notifyChangeListener(),s}log(){console.log(this.lruInfo)}persistence(){const n={items:Array.from(this.lruInfo.items.entries()),itemsKeys:this.lruInfo.itemsKeys};ts("LRU::".concat(this.saveKey),JSON.stringify(n),this.storage)}length(){return this.lruInfo.items.size}getSortItems(){const t=[],n=this.lruInfo.items;return this.lruInfo.itemsKeys.forEach(s=>{var o;const a=(o=n.get(s))==null?void 0:o.value;a!==void 0&&t.push({key:s,value:a})}),t}};const mD=(e,t)=>{e.splice(t,1)},hD=(e,t,n)=>{if(t===n)return;const s=e.splice(t,1);e.splice(n,0,s[0])},D_=new Ai(localStorage,"expand-block-list",1e3),q2=new Map,G2=new Map,W2=new Map,ZB={},C3="一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),Cu="日_一_二_三_四_五_六".split("_"),e9="星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),k3=60*1e3,Hc=15*k3,fw=4*Hc,as=24*fw,Us=e=>{if(q2.has(e))return q2.get(e);const t=new Date(new Date(e).toDateString()).getTime();return q2.set(e,t),t},a1=e=>["周",e].join(""),zZ={$currentSpaceId:"",$isDarkMode:document.body.className.includes("dark"),$firstLoadPage:!0,$isMobileSize:!1,$isEditingPage:!1,$today:Us(Date.now()),$pageRootLoaded:!1,$createBlockMenuListId:"",$blockMenuListId:"",$theme:JB(),$isCollapsed:localStorage.getItem(Vk)==="true",$columnResizing:!1,$menuListKeywords:"",$isFocusInRightPanel:!1,$textareaPlaceHolder:void 0,$slashSelection:{},$ignoreSlash:!1,$focusedInSyncBlockId:"",$serviceCenterRedBadge:!1,$pressedSpace:!1,$editingBlockId:void 0,$focusBlockId:void 0,$fatalError:void 0,$publicHomePage:void 0,$isSelecting:!1,$expandPageRecord:{},$expandFoldRecord:D_.getSortItems().reduce((e,t)=>(e[t.key]=t.value,e),{}),$fileIllegal:!1,$dirty:!1,$syncUpFault:{backup:!1,noPermission:!1},$membersStates:{},$collectionSearch:{},$folderListViewTypeList:QB(),$sharedPages:[],$subscriptionData:{},$notificationsMagic:{},$guestsList:[],$toolbarInfo:void 0,$tableShowHiddenGroup:{},$tableGroupFoldStatus:{},$newTableProperty:void 0,$allowEmojiPanel:!0,$bodyWidth:document.body.offsetWidth,$bodyHeight:document.body.offsetHeight,$isOpenImagePreview:!1,$readyUpdate:!1,$isCtrlKeyDown:!1,$showTransferList:!1,$aiCommands:[],$aiMembers:[],$pdfQuotes:[],$pdfAIContents:[],$showPDFSidebar:!1,$pdfHistorySidebar:localStorage.getItem(UB)==="true",$pdfAIHistory:[],$lastRefreshTime:Date.now(),$subscribePages:void 0,$exChangeCodeRedBadge:!1},s0=Vv(()=>zZ);var WP;const Cb=(WP=(()=>{try{return window!==top&&(top==null?void 0:top.location.href.startsWith("".concat(location.origin,"/template")))}catch(e){return!1}})())!=null?WP:!1,qZ=()=>{var e;return(e=top.getPreviewTemplateId)==null?void 0:e.call(top)},T3=()=>xt.$publicHomePage,pt=()=>{try{return T3()?!0:Qr(Nt.share)||Qr(Nt.form)}catch(e){return!1}},o1=()=>T3()?!0:Qr(Nt.subscribe);function mw(e){var o;const t=xt.$publicHomePage;if(t&&window.location.pathname==="/")return t;const n=GB(e);let s="";Qr(Nt.preview,void 0,e)?s="".concat(Nt.preview,":pageId"):Qr(Nt.subscribe,void 0,e)?s="".concat(Nt.subscribe,":pageId"):Qr(Nt.share,void 0,e)?s=n?"/".concat(n).concat(Nt.share,":pageId"):"".concat(Nt.share,":pageId"):Qr(Nt.form,void 0,e)?s="".concat(Nt.form,":pageId"):s=n?"/".concat(n,"/:pageId"):"/:pageId";const a=UG(e,{path:s,sensitive:!0});if(a){const i=(o=a.params.pageId)==null?void 0:o.substring(0,36);if(i&&Wc(i))return i}return""}function GZ(e){return e=gw(e),mw(e.pathname)}const lt=()=>{const e=_d(),t=gw(e);return mw(t.pathname)},WZ=()=>{const e=Ed();let{location:t}=e;return t=gw(t),GZ(t)},Ri=e=>{var a;const t=xt.$publicHomePage;if(t)return t;const n=window.location.pathname.slice(-36);if(e==="left")return n;const s=(a=Cd(window.location.search))!=null?a:"";return e==="right"||xt.$isFocusInRightPanel?s:n},v3=e=>mw(e),KZ=()=>v3(location.pathname),YZ=()=>{const e=Ed();return y.useCallback(()=>{const t=e.location,n=Cd(t.search),{pathname:s}=e.location,a=v3(t.pathname),o=s.replace(a,n!=null?n:"");e.push({pathname:o,search:uw.stringify({"right-page-id":a}),hash:location.hash})},[e])},hw=(e=location.href)=>{var t;return(t=Xp(e))==null?void 0:t.pathname.includes(Nt.share)},XZ=e=>{var t;return(t=Xp(e))==null?void 0:t.pathname.includes(Nt.form)},od=y.createContext(null),Ln=()=>!!y.useContext(od),t9=()=>!y.useContext(od),Ed=()=>{const e=y.useContext(od),t=ns();return e!=null?e:t},Cd=e=>uw.parse(e)["right-page-id"],n9=()=>(_d(),Cd(location.search)),QZ=()=>Cd(location.search),pw=()=>{const e=Ed();return y.useCallback(()=>{const{location:t}=e;e.push({pathname:t.pathname,hash:t.hash})},[e])},JZ=()=>{const e=Ed();return y.useCallback(()=>{const t=e.location,n=v3(t.pathname),s=Cd(t.search),a=t.pathname.replace(n,s!=null?s:"");e.push({pathname:a})},[e])},gw=e=>(typeof e.location=="object"&&(e=e.location),e),pD={lastPageId:""},xt=Fd(s0),ZZ=Qs(s0),on=e=>s0(e,In),st=e=>{ZZ(Yn(t=>os(t,e)))},s9=()=>{const e=Ln();return y.useCallback(t=>{let n=xt.$isFocusInRightPanel;e&&t&&!n&&(n=!0),st({$isEditingPage:t,$isFocusInRightPanel:n})},[e])},eee=()=>on(e=>e.$firstLoadPage),tee=()=>on(e=>e.$showPDFSidebar),yAe=()=>s0(e=>e.$pdfAIHistory),r9=()=>s0(e=>e.$pdfHistorySidebar),nee=()=>on(e=>e.$pdfQuotes),see=()=>on(e=>e.$pdfAIContents),bAe=()=>on(e=>e.$isFocusInRightPanel),a9=()=>on(e=>e.$bodyWidth),o9=()=>on(e=>e.$bodyHeight),i9=()=>on(e=>e.$theme),ree=()=>on(e=>e.$fatalError),FAe=()=>{const e=YB();return on(n=>n.$serviceCenterRedBadge)||e},tg=()=>on(e=>e.$pressedSpace),I3=()=>on(e=>e.$isEditingPage),l9=()=>on(e=>e.$today),wAe=()=>on(e=>e.$pageRootLoaded),_w=()=>on(e=>e.$createBlockMenuListId),xw=()=>nd(()=>Ta.onStatusChange.pipe(sd(()=>Ta.offline)),Ta.offline),Qa=()=>on(e=>e.$isMobileSize),yw=()=>on(e=>e.$isCollapsed),ng=()=>on(e=>e.$columnResizing),c9=()=>on(e=>e.$menuListKeywords),sg=(e,t)=>{const[n,s]=on(a=>{var o,i;return a.$textareaPlaceHolder&&((o=a.$textareaPlaceHolder)==null?void 0:o.blockId)===e?[a.$textareaPlaceHolder.alwaysShow,a.$textareaPlaceHolder.placeHolder]:[!1,(i=t==null?void 0:t.defaultPlaceholder)!=null?i:"请输入文字"]});return{alwaysShowPlaceHolder:n,placeHolder:s}},N3=()=>on(e=>e.$slashSelection),d9=()=>on(e=>e.$focusedInSyncBlockId),rg=()=>on(e=>e.$isSelecting),EAe=e=>on(t=>!!t.$expandPageRecord[e]),j3=(e,t)=>{const n={...xt.$expandPageRecord};e.forEach(s=>{n[s]=t}),st({$expandPageRecord:n})},aee=e=>on(t=>t.$expandFoldRecord[e]),oee=(e,t)=>{const n={...xt.$expandFoldRecord};e.forEach(s=>{n[s]=t}),st({$expandFoldRecord:n})},iee=()=>{const e=xw();return on(t=>!!(t.$isEditingPage&&!(t.$syncUpFault.backup||t.$syncUpFault.noPermission||e&&t.$dirty)))},S3=()=>on(e=>e.$fileIllegal),lee=()=>on(e=>e.$dirty),u9=()=>on(e=>e.$syncUpFault),D3=()=>{const e=on(t=>t.$membersStates);return e!=null?e:{}},CAe=e=>{st({$membersStates:{...xt.$membersStates,[e.userId]:e}})},cee=()=>on(e=>e.$aiMembers),ag=()=>on(e=>e.$newCreatedRecord),og=e=>on(t=>{var n;return(n=t.$collectionSearch[e])==null?void 0:n.trim()}),dee=e=>on(t=>t.$editingBlockId===e),f9=e=>on(t=>{const n=t.$folderListViewTypeList[e];return n!=null?n:Xs.TABLE}),m9=()=>on(e=>e.$sharedPages),kAe=()=>on(e=>e.$notificationsMagic),TAe=()=>{st({$notificationsMagic:{}})},kd=()=>on(e=>e.$guestsList),uee=e=>on(t=>{var n;return((n=t.$toolbarInfo)==null?void 0:n.syncId)===e&&t.$toolbarInfo.showing}),fee=e=>on(t=>{var n;return((n=t.$tableShowHiddenGroup)==null?void 0:n[e])===!0}),ig=(e,t)=>on(n=>{var s,a;return((a=(s=n.$tableGroupFoldStatus)==null?void 0:s[e])==null?void 0:a[t])!==!1}),A3=(e,t)=>on(n=>{var s;return((s=n.$newTableProperty)==null?void 0:s.propertyId)===e&&n.$newTableProperty.from===t}),Nm=()=>on(e=>!!e.$allowCommentInSharePage),mee=(e,t,n)=>on(s=>{const{$newTableProperty:a}=s;let o=!0;return a!=null&&a.groupInfo&&(o=a.groupInfo===n),o&&(a==null?void 0:a.propertyId)===e&&a.from===t}),bw=()=>on(e=>e.$isCtrlKeyDown),vAe=()=>on(e=>e.$subscribePages),h9=()=>on(e=>e.$exChangeCodeRedBadge),hee=e=>{if(!e)return;const t=new Event("click",{bubbles:!0,cancelable:!0});e.dispatchEvent(t)},pee=e=>{if(!e)return;const t=new MouseEvent("mouseenter",{view:window,bubbles:!0,cancelable:!0});e.dispatchEvent(t)},gee=e=>{if(!e)return;const t=new MouseEvent("mouseleave",{view:window,bubbles:!0,cancelable:!0,altKey:!0});e.dispatchEvent(t)},_ee=e=>{if(!e)return;const t=new MouseEvent("blur",{view:window,bubbles:!0,cancelable:!0,altKey:!0});e.dispatchEvent(t)},R3=(e,t,n,s=dr,a={})=>{var _,x,F;const o=Qa(),i=(_=a.autoResetActiveIndex)!=null?_:!0,l=(x=a.defaultActiveIndex)!=null?x:-1,[c,d]=y.useState(l),u=y.useRef(l);u.current=(F=a.activeIndex)!=null?F:c;const f=y.useRef(t),h=y.useRef(n),p=y.useRef(a.onGlobalCaptureKeydown),g=y.useRef(a.onSelectedActiveIndex);return f.current=t,h.current=n,p.current=a.onGlobalCaptureKeydown,g.current=a.onSelectedActiveIndex,y.useEffect(()=>{var T;const b=(T=a.enableKeyDown)!=null?T:!0,w=v=>{var I,j,S;if(b&&!(v<0)&&((I=g.current)==null||I.call(g,v),a.scrollContainer&&a.scrollContainer.current)){const D=f.current(v);if((j=a==null?void 0:a.virtuoso)!=null&&j.current&&!D){(S=a==null?void 0:a.virtuoso)==null||S.current.scrollToIndex({index:v,align:"center",behavior:"auto"}),o||(a.scrollContainer.current.style.pointerEvents="none");return}if(D||console.warn("could not found item element, index[".concat(v,"]")),D){const A=D.getBoundingClientRect(),P=a.scrollContainer.current.getBoundingClientRect();A.top+A.height>P.top+P.height?D.scrollIntoView({behavior:"auto",block:"end"}):A.top<P.top&&D.scrollIntoView({behavior:"auto",block:"start"}),o||(a.scrollContainer.current.style.pointerEvents="none")}}};let E=!1;const C=v=>{var D;if(!b)return;const I=document.activeElement;let j=!1;if(I){let A=!1;if(I.closest(".ignore-control-list"))return;if(["INPUT","TEXTAREA","BUTTON"].includes(I.tagName)){let L=I;for(;L.parentElement;){if(L.parentElement.getAttribute("data-modal-id")){A=!0;break}L=L.parentElement}if(!A)return j}if(A&&["BUTTON"].includes(I.tagName))return j}let S=u.current;switch(!0){case If("ArrowUp")(v):{if(e===0)break;v.preventDefault(),v.stopImmediatePropagation(),S=h.current(S,"up"),j=!0;break}case If("ArrowDown")(v):{if(e===0)break;v.preventDefault(),v.stopImmediatePropagation(),S=h.current(S,"down"),j=!0;break}case If("Enter")(v):{if(E)return;if(E=!0,setTimeout(()=>E=!1,300),e===0||S===-1)break;v.preventDefault(),v.stopImmediatePropagation();const A=f.current(S);A||console.warn("could not found item element, index[".concat(S,"]")),hee(A),j=!0;break}case If("ArrowLeft")(v):{if(e===0)break;const A=h.current(S,"left");if(A===-1){const P=f.current(S);gee(P),_ee(P),(P==null?void 0:P.closest("[data-prevent-event]"))&&v.preventDefault()}else S=A,v.preventDefault(),v.stopImmediatePropagation(),j=!0;break}case If("ArrowRight")(v):{if(e===0)break;const A=h.current(S,"right");if(A===-1){const P=f.current(S);pee(P),(P==null?void 0:P.closest("[data-prevent-event]"))&&v.preventDefault()}else S=A,v.preventDefault(),v.stopImmediatePropagation(),j=!0;break}}return S!==u.current&&(w(S),d(S)),j||(D=p.current)==null||D.call(p,v),j},k=Ht.addEventListener("keydown",C,s,!0);return setTimeout(()=>{var S,D;const v=(D=(S=a.scrollContainer)==null?void 0:S.current)==null?void 0:D.getBoundingClientRect();if(!v){k();return}const{height:I,width:j}=v;if(I===void 0||j===void 0){k();return}if(I===0||j===0){k();return}u.current<e?w(u.current):d(0)},100),()=>{k()}},[e,s,a.scrollContainer,o,a==null?void 0:a.virtuoso,a.enableKeyDown]),y.useEffect(()=>{var w,E;if(o&&((w=a.scrollContainer)!=null&&w.current)){a.scrollContainer.current.style.pointerEvents="",a.scrollContainer.current.style.cursor="";return}(E=a.scrollContainer)!=null&&E.current&&(a.scrollContainer.current.style.pointerEvents="none",a.scrollContainer.current.style.cursor="none");const b=()=>{var C;(C=a.scrollContainer)!=null&&C.current&&(a.scrollContainer.current.style.pointerEvents="",a.scrollContainer.current.style.cursor="")};return Ht.addEventListener("mousemove",b,s),()=>{Ht.removeEventListener("mousemove",b)}},[o,a.scrollContainer,s]),y.useEffect(()=>{i&&d(l)},[l,e,i]),[u.current,d]},xee=10;function gD(e){return e.getPerPage?e.getPerPage():xee}function p9(e){const t=y.useRef(!1),n=y.useRef(!0),[s,a]=y.useState([]),[o,i]=y.useState(!1),l=y.useCallback(async(c,d)=>{var h;if(!d&&!e.canSearchWithEmpty){a((h=e.defaultList)!=null?h:[]);return}i(!0);const u=await e.search(c,d.trim(),gD(e)).catch(()=>{t.current=!1,n.current=!1,i(!1)});if(n.current=!1,!u)return;const f=await e.convert(u).catch(()=>{t.current=!1,i(!1)});f&&(i(!1),t.current=f.length>=gD(e),a(p=>{let g=[];return c===1?g=[...f]:g=[...p,...f],g}))},[e]);return y.useEffect(()=>{var c;a((c=e.defaultList)!=null?c:[])},[e]),{firstTime:n.current,resultList:s,loading:o,hasMore:!o&&t.current,search:l}}const Ao=e=>new Promise(t=>{setTimeout(t,e)}),Ox={},mo=(e,t="normal")=>{var s;Ox[t]||(Ox[t]=Promise.resolve());const n=(s=Ox[t])==null?void 0:s.then(e,e);return n&&(Ox[t]=n),n};class P3{constructor(){q(this,"resolve");q(this,"reject");q(this,"promise",new Promise((t,n)=>{this.resolve=t,this.reject=n}))}}const _D="virtuoso-list-id",yee=({items:e,renderItem:t,computeItemKey:n,virtuosoRef:s,maxHeight:a="40vh",className:o,defaultHeight:i})=>{const[l,c]=y.useState(i||document.body.clientHeight/2),d=async f=>{if(!f)return;await Ao(200);const h=document.querySelector(".".concat(_D,' [data-testid="virtuoso-item-list"]'));if(h){const p=h.getBoundingClientRect();c(p.height||40)}},u=f=>{const h=e[f];return h?t(h,f):null};return r.jsx(qs,{className:R(_D,"overflow-y-auto",o),data:e,scrollerRef:d,overscan:100,style:{height:l,maxHeight:a},ref:s,computeItemKey:n,itemContent:u})},g9={},_9=new Set,fc=(e,t,n)=>{g9[e]=t,n&&_9.add(e)},Yu="py-1.5 px-2.5 mx-1 ",L3="max-h-[65vh] w-[260px] rounded py-2 overflow-y-auto",Ra="next-modal ".concat(L3),zk=["／","/","、"],B3=(e="")=>zk.includes(e),id=(e="")=>VG($G(e,/\s+/g,"")),bee=(e,t,n,s)=>{if(!e)return t;if(!t)return e;const a=hp(e,"");return a.splice(n,s!=null?s:0,t),a.join("")},IAe=(e="")=>e.charAt(0).toLowerCase()+e.slice(1),Cs=e=>{var K,W;const{root:t}=y.useContext(Fee),{offset:n,placement:s="top",children:a,popup:o,popupClassName:i,className:l,onClick:c,isPopover:d,event:u,content:f,duration:h=200,delay:p,flexCenter:g=!0,maxWidth:_=200,style:x,id:F,disabled:b,...w}=e,E=(W=(K=e.portalRoot)!=null?K:t)!=null?W:document.body,[C,k]=y.useState(!1),[T,v]=y.useState(null),{context:I,refs:j,floatingStyles:S}=HG({placement:s,open:C,onOpenChange:k,whileElementsMounted:xk,middleware:[zG(n!=null?n:8),qG({crossAxis:s==null?void 0:s.includes("-"),fallbackAxisSideDirection:"start",padding:5}),GG({padding:5})]}),{setReference:D,setFloating:A,domReference:P}=j,L=WG(I,{delay:p!=null?p:{open:200,close:150},enabled:!u}),O=KG(I,{event:u,enabled:!!u}),{getReferenceProps:$,getFloatingProps:M}=YG([L,O]),{styles:U}=XG(I,{duration:{open:h,close:50},initial:{opacity:.5},close:{opacity:0}});y.useEffect(()=>{if(!T||!P.current)return;const Y=G=>{var Q;const te=G.composedPath()[0];!T.contains(te)&&!((Q=P.current)!=null&&Q.contains(te))&&k(!1)};return document.addEventListener("click",Y),()=>{document.removeEventListener("click",Y)}},[T]);const z=()=>k(!1);return r.jsxs(r.Fragment,{children:[r.jsx("div",{ref:Y=>{D(Y)},className:R(c&&"animate-click",g?"flex justify-center items-center":"text-left",l),"data-state":I.open?"open":"closed",style:x,id:F,...w,...$({onClick:c}),children:a}),C&&!b&&(o||f)&&r.jsx(QG,{root:E,children:r.jsx("div",{ref:Y=>{v(Y),A(Y)},style:S,...M(),className:"z-[10000]",children:r.jsx("div",{style:{...U,maxWidth:_},className:R(!d&&"bg-black2 px-2 py-1 text-t4-medium text-white next-modal !rounded whitespace-pre-line",i),children:f?f(z):o})})})]})},Fee=y.createContext({root:null});const Fe=y.memo(e=>{var U,z;const{popup:t,offset:n=[0,10],placement:s="top",children:a,className:o,duration:i=[200,50],delay:l=[200,50],popupClass:c="",popupClick:d,equalWidth:u,arrow:f=!1,onClick:h,style:p,trigger:g="mouseenter",interactive:_=!1,maxWidth:x=200,theme:F="next-tooltip",animation:b="fade",visible:w,appendTo:E=()=>document.body,disabled:C,lazyLoad:k=!1,onShow:T,onShown:v,onHidden:I,...j}=e,S=y.useRef(null),D=y.useMemo(()=>typeof w=="boolean"?{visible:w}:{trigger:g},[g,w]),A=y.useMemo(()=>["data-no-cancel-selected","data-test-id","id","data-menu-id"],[]),[P,L]=y.useState(!k),O=!!(C||!t);y.useEffect(()=>{w!==void 0&&(w?L(w):es(100).then(()=>{L(w)}))},[w]);const $=y.useMemo(()=>r.jsx("div",{"data-no-cancel-selected":!0,ref:S,className:R("flex",o),style:p,onClick:h,...Ni(j,A),children:a}),[a,o,A,h,j,p]),M=y.useMemo(()=>{var Y,G;let K=200,W=0;return typeof l=="number"?K=l:Array.isArray(l)&&(K=(Y=l[0])!=null?Y:200,W=(G=l[1])!=null?G:0),{open:K,close:W}},[l]);return!_&&F==="next-tooltip"&&g==="mouseenter"&&!d?r.jsx(Cs,{flexCenter:!1,placement:s,delay:M,offset:n,popup:t,className:R("flex",o),popupClassName:R("break-words",c),maxWidth:u?(U=S.current)==null?void 0:U.clientWidth:x,onClick:h,style:p,disabled:O,...Ni(j,A),children:a}):r.jsx(XP,{onHidden:K=>{k&&L(!1),I==null||I(K)},onShow:K=>{k&&L(!0),T==null||T(K)},onShown:K=>{k&&L(!0),v==null||v(K)},interactive:_,arrow:f,delay:l,duration:i,disabled:O,theme:F,placement:s,offset:n,maxWidth:u?(z=S.current)==null?void 0:z.clientWidth:x,appendTo:E,animation:b,content:P&&r.jsx("div",{className:R("text-t4-medium whitespace-pre-line",c),onClick:d,children:P&&t}),...kn(j,A),...D,children:$})},yn),wee=e=>{const t=e.listItem.data;if(!t)return null;const{icon:n,image:s,textColor:a,backgroundColor:o,iconSize:i="middle"}=t,l=o!==void 0;return r.jsx("div",{...e.attribute,onClick:c=>{e.onItemClick&&e.onItemClick(e.listItem,e.index,c)},className:R(Yu,"rounded cursor-pointer active-bg animate-hover text-ellipsis",{"normal-bg":e.selected}),children:r.jsxs(Fe,{className:"flex items-center justify-between h-full space-x-2",placement:"right",theme:"none",offset:[0,16],popup:t.context,children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[n&&typeof n=="string"?r.jsx(V,{name:n,size:i,className:t.iconClassName}):n,s&&r.jsx("img",{className:"flex-shrink-0 object-fill w-5 h-5 rounded border-grey4",src:t.image,style:t.imageStyle}),(a||l)&&r.jsx("div",{className:"border border-black_006 rounded-full flex items-center justify-center w-5 h-5",style:{background:l?cs(o):void 0},children:r.jsx("span",{className:"text-t2-bold text-black",style:{color:a?tr(a):void 0},children:"A"})}),r.jsx("span",{className:"text-black text-t2",children:t.title})]}),r.jsx("div",{className:"text-grey3 text-t4 text-ellipsis max-w-[130px]",children:r.jsx(Eee,{dataScheme:t})}),t.rightText&&r.jsx("span",{className:R("text-t3 text-grey3",t.textClassName),children:t.rightText})]})})},Eee=y.memo(({dataScheme:e})=>{var l,c,d;const t=c9(),n=B3((l=t[0])!=null?l:""),s=n?t.slice(1):t,a=JG([...(c=e.keywords)!=null?c:[]],void 0),o=y.useMemo(()=>s?a.find(f=>id(f).includes(s)&&f&&s?f:null):null,[a,s]),i="".concat((d=o!=null?o:a[0])!=null?d:"");return r.jsxs(r.Fragment,{children:[n&&!!a.length&&r.jsx("span",{className:"text-active_color",children:"/"}),r.jsx(X1,{text:i,search:s})]})}),Cee=e=>{const t=e.listItem.data;return t?r.jsx("div",{className:R(Yu,"flex items-center text-t2 text-grey3",t.className),children:r.jsxs("div",{className:"flex justify-between items-center w-full",children:[t.titleSuffix?r.jsxs("div",{children:[r.jsx("span",{children:t.title}),t.titleSuffix]}):r.jsx("span",{children:t.title}),t.icon]})}):null},kee=e=>{const t=e.listItem.data;return t?r.jsxs("div",{...e.attribute,className:R("flex items-center px-2 mx-2 h-9 text-t2 text-black rounded animate-hover cursor-pointer justify-between",t.className,{"normal-bg":e.selected}),onClick:n=>e.onItemClick&&e.onItemClick(e.listItem,e.index,n),children:[r.jsx("span",{children:t.title}),t.selected&&t.followTitle&&r.jsx(V,{name:"IcCheck02",size:"middle",style:{color:t.selectColor}}),r.jsx("span",{className:R("text-grey4 text-t2 ml-auto",t==null?void 0:t.textClassName),children:t.desc}),t.selected&&!t.followTitle&&r.jsx(V,{name:"IcCheck02",size:"middle",className:"ml-auto",style:{color:t.selectColor}})]}):null},Tee=e=>{const t=e.listItem.data;if(!t)return null;const{icon:n}=t;return r.jsx("div",{...e.attribute,onPointerDown:s=>{s.preventDefault()},onClick:s=>{var a,o;(a=t.onClick)==null||a.call(t,s),(o=e.onItemClick)==null||o.call(e,e.listItem,e.index,s)},className:R(Yu," rounded cursor-pointer active-bg animate-hover",{"normal-bg":e.selected}),children:r.jsxs(Fe,{className:"flex items-center justify-between h-full",placement:"right",theme:"none",offset:[0,16],popup:t.context,children:[r.jsxs("div",{className:"flex items-center",children:[typeof n=="string"?r.jsx(V,{name:n,size:"xxlarge",className:"mr-2"}):n,t.image&&r.jsx("img",{className:"flex-shrink-0 object-fill w-[26px] h-[26px] rounded border-grey4 mr-2",src:t.image}),r.jsx("div",{className:"flex flex-col",children:r.jsx("span",{className:"text-black text-t2",children:t.title})})]}),t.selected&&r.jsx(V,{name:"IcCheck02",size:"middle"})]})})},vee=e=>r.jsx("div",{className:"flex items-center mx-4 my-1",children:r.jsx("div",{className:"w-full h-px bg-grey6"})}),Iee=e=>{const{dataScheme:t,isSelected:n}=e,s=Qa(),a=y.useRef(null),[o,i]=y.useState(!1),[l,c]=y.useState(!1);return y.useEffect(()=>{if(!a.current)return;const d=a.current,u=()=>i(!0),f=()=>i(!1);d.addEventListener("mouseenter",u),d.addEventListener("focus",u),d.addEventListener("blur",f);const h=()=>{d.removeEventListener("blur",f),d.removeEventListener("mouseenter",u),d.removeEventListener("focus",u)};return d||h(),h},[]),y.useEffect(()=>{n||i(!1)},[n]),tc(()=>{o?c(o):es(50).then(()=>{c(o)})},[o],{leading:!0,trailing:!0,wait:50}),r.jsx("div",{children:t.renderSubMenu&&!t.disable?r.jsx(XP,{ref:a,visible:o,delay:[200,0],duration:[150,50],offset:s?[0,0]:t.offset||[0,-8],placement:s?"bottom":"right",theme:"none",interactive:!0,interactiveDebounce:0,arrow:!1,animation:"shift-away",appendTo:()=>document.body,content:l&&t.renderSubMenu(),children:r.jsx("div",{children:e.children})}):e.children})},Nee=e=>{var s,a;const t=y.useRef(),n=e.listItem.data;return n?r.jsx(Iee,{dataScheme:n,divRef:t,isSelected:e.selected,children:r.jsx(Fe,{popup:n.tip,placement:(s=n.placement)!=null?s:"left",children:r.jsxs("div",{...e.attribute,ref:t,onClick:o=>{var i,l;n.disable||((i=e.onItemClick)==null||i.call(e,e.listItem,e.index,o),(l=n.onClick)==null||l.call(n,o))},className:R(Yu,"relative flex items-center w-full justify-between rounded cursor-pointer active-bg animate-hover text-ellipsis",{"normal-bg":e.selected,"opacity-30 cursor-not-allowed":n.disable},n.className),children:[r.jsx("div",{className:"flex min-w-0 items-center",children:n.content?n.content:r.jsxs(r.Fragment,{children:[typeof n.icon=="string"?r.jsx(V,{name:n.icon,size:"small",className:n.iconClassName}):n.icon,r.jsx("span",{className:R("flex-1 min-w-0 overflow-hidden text-black whitespace-nowrap overflow-ellipsis text-t2",n.icon&&"ml-2"),children:n.title}),n.label]})}),r.jsxs(r.Fragment,{children:[n.rightText&&r.jsx("span",{className:R("text-t4 text-grey3 mr-1",n.textClassName),children:n.rightText}),n.hasArrow&&((a=n.arrow)!=null?a:r.jsx(V,{name:"IcMenuNext",size:"small",className:"text-grey4"}))]}),n.selected&&r.jsx(V,{name:"IcCheck02",size:"small",style:{color:n.selectColor}})]})})}):null},Bc={cache:QP.Map(),getCache:()=>Bc.cache,getToc:e=>Bc.cache.get(e),setToc:(e,t)=>{},deleteToc:e=>{Bc.cache=Bc.cache.delete(e)},clear:()=>{Bc.cache=Bc.cache.clear()}},Wi={cache:QP.Map(),getCache:()=>Wi.cache,getShare:e=>Wi.cache.get(e),deleteShare:e=>{Wi.cache=Wi.cache.delete(e)},setShare:(e,t)=>{Wi.cache=Wi.cache.set(e,t)},clear:()=>{Wi.cache=Wi.cache.clear()}},Sy=e=>{Bc.deleteToc(e)},Fw=()=>{Bc.clear()},Mx=(e,t)=>{const n=ks(e,{blocks:t().blocks});n!=null&&Sy(n)},Ml=()=>{Wi.clear()},lg=Aa(()=>({})),Td=Fd(lg),Tf=Qs(lg),mc=e=>lg(e,In),qk=e=>{Ml(),Fw(),Tf(Yn(t=>(os(t,e),ka(e).forEach(n=>{var a;const s=e[n];t[n]&&!((a=t[n])!=null&&a.setting)&&(t[n].setting={inlinePageIcon:s.inlinePageIcon})}),t)))},yh={create:e=>{Tf(Yn(t=>{t[e.uuid]=e}))},update:e=>{Tf(Yn(t=>{const n=t[e.uuid];if(!n)return;const{setting:s,...a}=e.patch;Object.assign(n,a),n.setting?Object.assign(n.setting,s):n.setting={...s}}))},listRemoveTemplate:e=>{Tf(Yn(t=>{var a,o;const n=t[e.parentId];if(!n)return;const s=(a=n.customTemplates)==null?void 0:a.indexOf(e.uuid);s>-1&&((o=n.customTemplates)==null||o.splice(s,1))}))},addMarkName:e=>{Tf(Yn(t=>{const n=e.patch,s=t[e.uuid];if(s){s.userRemark||(s.userRemark={});for(const a of n)s.userRemark[a.userId]=a.markName}}))},listBeforeTemplate:e=>{Tf(Yn(t=>{var s,a,o,i;const n=t[e.parentId];if(n)if(e.before){const l=(s=n.customTemplates)==null?void 0:s.indexOf(e.before);l<0?(a=n.customTemplates)==null||a.splice(0,0,e.uuid):(o=n.customTemplates)==null||o.splice(l,0,e.uuid)}else(i=n.customTemplates)==null||i.splice(0,0,e.uuid)}))},listAfterTemplate:e=>{Tf(Yn(t=>{var s,a,o,i;const n=t[e.parentId];if(n)if(e.after){const l=(s=n.customTemplates)==null?void 0:s.indexOf(e.after);l<0?(a=n.customTemplates)==null||a.splice(0,0,e.uuid):(o=n.customTemplates)==null||o.splice(l+1,0,e.uuid)}else(i=n.customTemplates)==null||i.splice(0,0,e.uuid)}))}},ww=(e,t=pe())=>ep(e,{...t,segmentsToText:fe,spaces:Td}),$a=En("block/create"),Sn=En("block/update"),cl=En("block/list-before"),ws=En("block/list-after"),Tr=En("block/list-remove"),r0=En("block/destroy"),Ew=En("block/set-permission"),Cw=En("block/remove-permission"),ku=En("collection-view/create"),Xc=En("collection-view/update"),Tu=En("collection-view/list-after"),im=En("collection-view/list-before"),lm=En("collection-view/list-remove"),ld=En("collection-view/list-after-pagesort"),cm=En("collection-view/list-before-pagesort"),cd=En("collection-view/list-remove-pagesort"),i1=new Map,O3=En("history/start"),kb=En("history/end"),jm=En("history/undo"),cg=En("history/redo"),sr=En("history/effects",e=>{const t=zv("history/effects");return i1.set(t,e),{payload:t}}),x9=En("history/clear"),y9=En("space/create"),M3=En("space/update"),kw=En("space/mark-ame"),l1=En("template/list-before"),c1=En("template/list-after"),d1=En("template/list-remove"),jee=En("space-view/create"),Tw=En("space-view/update"),See=En("space-view/delete"),yp=En("favorite/list-before"),bp=En("favorite/list-after"),dm=En("favorite/list-remove"),a0=En("transaction/flush"),Sa=En("transaction/fire"),Fp=En("discussion/create"),su=En("discussion/update"),o0=En("discussion/list-after"),i0=En("discussion/list-remove"),Dee={},U3=Em({name:"blocks",initialState:Dee,reducers:{update(e,t){var n,s;for(const a of Object.keys((n=t.payload.blocks)!=null?n:{})){const o=e[a],i=(s=t.payload.blocks)==null?void 0:s[a];if(!i)continue;const l={...i,data:{...i.data}};!t.payload.force&&o!=null&&l.version<=o.version||((o==null?void 0:o.type)!==m.BlockType.PDF_ANNOTATION&&(l.data.localUrl=o==null?void 0:o.data.localUrl),l.data.iconUrl=o==null?void 0:o.data.iconUrl,l.data.showEmptyCaption=o==null?void 0:o.data.showEmptyCaption,e[a]=l)}},clear(){return{}},incVersion(e,t){t.payload.forEach(n=>{const s=e[n];s&&s.version!==-1&&(s.version+=1)})}},extraReducers(e){e.addCase($a,(t,{payload:n})=>{var s;(n.block.type===m.BlockType.PAGE||n.block.type===m.BlockType.FOLDER)&&(n.block={...n.block,local:(s=n.local)!=null?s:!0}),t[n.block.uuid]=n.block}),e.addCase(Sn,(t,{payload:n})=>{const{uuid:s,patch:a,path:o}=n,i=t[s];if(!i)return;if(delete i.local,o){const f=bu(a,o);JP(i,o,os(bu(i,o),f));return}const{data:l={},...c}=a,{format:d,...u}=l;os(i,c),os(i.data,u),i.data.format||(i.data.format={}),os(i.data.format,l==null?void 0:l.format)}),e.addCase(cl,(t,{payload:n})=>{const{uuid:s,parentId:a,before:o,ignoreUpdateTime:i}=n,l=t[a],c=t[s];if(c&&(c.parentId=a,c.status=m.BlockStatus.NORMAL,i||(c.updatedAt=Date.now()),!!l))if(o){const d=l.subNodes.indexOf(o);d<0?l.subNodes.unshift(s):l.subNodes.splice(d,0,s)}else l.subNodes.unshift(s)}),e.addCase(ws,(t,{payload:n})=>{const{uuid:s,parentId:a,after:o,ignoreUpdateTime:i}=n,l=t[a],c=t[s];if(c&&(c.parentId=a,c.status=m.BlockStatus.NORMAL,i||(c.updatedAt=Date.now()),!!l))if(o){const d=l.subNodes.indexOf(o);d<0?l.subNodes.push(s):l.subNodes.splice(d+1,0,s)}else l.subNodes.push(s)}),e.addCase(Tr,(t,{payload:n})=>{const{uuid:s}=n,a=t[s];if(!a)return;const o=t[a.parentId];o&&(o.subNodes=o.subNodes.filter(i=>i!==s))}),e.addCase(r0,(t,{payload:n})=>{const{uuid:s}=n;delete t[s]}),e.addCase(Ew,(t,{payload:n})=>{const{uuid:s,permission:a}=n,o=t[s];o&&((a.type===m.PermissionType.PUBLIC||a.type===m.PermissionType.RESTRICTED)&&(o.permissions=o.permissions.filter(i=>i.type!==a.type),o.permissions.push(a)),a.type===m.PermissionType.SPACE&&(o.permissions.some(i=>i.type===m.PermissionType.SPACE)?o.permissions=o.permissions.map(i=>i.type===m.PermissionType.SPACE?a:i):o.permissions.push(a)),a.type===m.PermissionType.GROUP&&(o.permissions.some(i=>i.groupId===a.groupId)?o.permissions=o.permissions.map(i=>i.groupId===a.groupId?a:i):o.permissions.push(a)),a.type===m.PermissionType.USER&&(o.permissions.some(i=>i.userId===a.userId)?o.permissions=o.permissions.map(i=>i.userId===a.userId?a:i):o.permissions.push(a)))}),e.addCase(Cw,(t,{payload:n})=>{const{uuid:s,permission:a}=n,o=t[s];o&&((a.type===m.PermissionType.SPACE||a.type===m.PermissionType.PUBLIC||a.type===m.PermissionType.RESTRICTED)&&(o.permissions=o.permissions.filter(i=>i.type!==a.type)),a.type===m.PermissionType.GROUP&&(o.permissions=o.permissions.filter(i=>i.groupId!==a.groupId)),a.type===m.PermissionType.USER&&(o.permissions=o.permissions.filter(i=>i.userId!==a.userId)))}),e.addCase(Tu,(t,{payload:n})=>{const{uuid:s,after:a,parentId:o}=n,i=t[o];if(i)if(!i.views)i.views=[s];else if(a){const l=i.views.indexOf(a);l<0?i.views.push(s):i.views.splice(l+1,0,s)}else i.views.push(s)}),e.addCase(im,(t,{payload:n})=>{const{uuid:s,before:a,parentId:o}=n,i=t[o];if(i)if(i.views||(i.views=[s]),a){const l=i.views.indexOf(a);l<0?i.views.push(s):i.views.splice(l,0,s)}else i.views.unshift(s)}),e.addCase(lm,(t,{payload:n})=>{var i;const{uuid:s,parentId:a}=n,o=t[a];o&&(o.views=(i=o.views)==null?void 0:i.filter(l=>l!==s))}),e.addCase(o0,(t,{payload:n})=>{const{uuid:s,after:a,parentId:o}=n,i=t[o];if(i)if(!i.discussions)i.discussions=[s];else if(a){const l=i.discussions.indexOf(a);l<0?i.discussions.push(s):i.discussions.splice(l+1,0,s)}else i.discussions.push(s)}),e.addCase(i0,(t,{payload:n})=>{var i;const{uuid:s,parentId:a}=n,o=t[a];o&&(o.discussions=(i=o.discussions)==null?void 0:i.filter(l=>l!==s))})}}),Aee=U3.reducer,Tn=U3.actions,Ree=({getState:e})=>t=>n=>{var s;if($t(ws,cl)(n)){if(Ml(),n.payload.parentId!=null){const a=ww(n.payload.parentId,e());a!=null&&(Sy(a),Mx(n.payload.parentId,e))}}else if($t(Sn)(n))n.payload.patch.type===m.BlockType.PAGE&&(Ml(),Mx(n.payload.uuid,e)),zf(n.payload.patch,"subNodes")&&(Ml(),Sy(n.payload.uuid)),(zf(n.payload.patch,"permissions")||zf(n.payload.patch,"parentId"))&&(Ml(),Mx(n.payload.uuid,e));else if($t(Ew,Cw)(n)){Ml();const a=(s=e().blocks[n.payload.uuid])==null?void 0:s.parentId;a!=null&&Sy(a)}else $t(r0,Tr)(n)?(Ml(),Mx(n.payload.uuid,e)):$t(Tn.update,Tn.clear)(n)&&(Ml(),Fw());t(n)},l0=Aa(()=>({})),vf=Qs(l0),Sm=Fd(l0),b9=e=>l0(e,In),Pee=e=>{vf(()=>e)},bh={create:e=>{vf(Yn(t=>{t[e.spaceView.uuid]=e.spaceView}))},delete:e=>{vf(Yn(t=>{delete t[e.uuid]}))},updateSpaceView:e=>{vf(Yn(t=>{const n=t[e.uuid];if(!n)return;const{setting:s,...a}=e.patch;os(n,a),n.setting||(n.setting={}),s&&os(n.setting,s),t[e.uuid]=n}))},listRemoveFavorite:e=>{vf(Yn(t=>{const n=t[e.parentId];if(!n)return;const s=n.favoritePages.indexOf(e.uuid);s>-1&&n.favoritePages.splice(s,1)}))},listBeforeFavorite:e=>{vf(Yn(t=>{const n=t[e.parentId];if(n)if(e.before){const s=n.favoritePages.indexOf(e.before);s<0?n.favoritePages.splice(0,0,e.uuid):n.favoritePages.splice(s,0,e.uuid)}else n.favoritePages.splice(0,0,e.uuid)}))},listAfterFavorite:e=>{vf(Yn(t=>{const n=t[e.parentId];if(n)if(e.after){const s=n.favoritePages.indexOf(e.after);s<0?n.favoritePages.splice(0,0,e.uuid):n.favoritePages.splice(s+1,0,e.uuid)}else n.favoritePages.splice(0,0,e.uuid)}))}};var Or=(e=>(e.AI="AI",e.Turn="Turn",e.LinkPage="LinkPage",e.Comment="Comment",e.Bold="Bold",e.Italic="Italic",e.Underline="Underline",e.Delete="Delete",e.Code="Code",e.Equation="Equation",e.Url="Url",e.Color="Color",e.More="More",e))(Or||{});const Lee=jo(Or),Gk=kn(Hp(Or,e=>({id:e,index:Lee.findIndex(t=>t===e),type:"base",fixed:!0})),["More"]),F9="toolbar",Ka="".concat(F9,"-btn-"),w9={uuid:"",phone:"",email:"",nickname:"",backgroundColor:"",spaceViews:[],inviteCode:"",version:0,status:m.BlockStatus.NORMAL,currentSpaceViewId:"",occupation:0,avatar:"",setting:{toolbarShortcut:Gk}},Dm=Aa(()=>w9),yt=Fd(Dm),V3=Qs(Dm),vw=e=>{const{setting:t,...n}=e;Ml(),Fw(),nX("".concat(n.uuid,"-").concat(n.currentSpaceViewId)),V3(Yn(s=>{t&&(s.setting||(s.setting={}),os(s.setting,t)),os(s,n)}))},Bee=()=>{Ml(),Fw(),V3(()=>w9)},Oee=e=>{V3(Yn(t=>{const n=t.spaceViews.findIndex(s=>s===e);n!==-1&&t.spaceViews.splice(n,1)}))},c0=En("comment/create"),u1=En("comment/update"),d0=En("comment/list-after"),u0=En("comment/list-remove");let Ux=!1;const zd=[],Tb=[];let zc=0;const Mee=e=>{const t=zd.pop();t&&(yk(t,n=>{var o,i,l,c;const{action:s,snapshot:a}=n;if($t(sr)(s)){const d=s.payload;(o=i1.get(d))==null||o.undo()}if($t($a)(s)){const{block:{uuid:d},ignoreOp:u}=s.payload;e(Sn({uuid:d,patch:{status:-1},ignoreOp:u}))}if($t(ku)(s)){const{uuid:d}=s.payload.collectionView;e(Xc({uuid:d,patch:{status:-1}}))}if($t(lm)(s)){const{uuid:d,parentId:u}=s.payload,f=(i=a.blocks[u])==null?void 0:i.views;if(!f)return;const h=f.indexOf(d),p=f[h-1],g=f[h+1];e(g?im({uuid:d,parentId:u,before:g}):Tu({uuid:d,parentId:u,after:p}))}if($t(cd)(s)){const{uuid:d,viewId:u}=s.payload,f=(l=a.collectionViews[u])==null?void 0:l.pageSort;if(!f)return;const h=f.indexOf(d),p=f[h-1],g=f[h+1];e(g?cm({uuid:d,viewId:u,before:g}):ld({uuid:d,viewId:u,after:p}))}if($t(Tu,im)(s)){const{uuid:d,parentId:u}=s.payload;e(lm({uuid:d,parentId:u}))}if($t(ld,cm)(s)){const{uuid:d,viewId:u}=s.payload;e(cd({uuid:d,viewId:u}))}if($t(Sn)(s)){const{uuid:d,patch:u,ignoreOp:f}=s.payload,h=a.blocks[d];if(!h)return;const p={};Object.keys(u).forEach(g=>{["type","backgroundColor","textColor","status"].includes(g)&&(p[g]=h[g])}),p.data=Hp(u.data,(g,_)=>bu(h.data,_)),e(Sn({uuid:d,patch:p,ignoreOp:f}))}if($t(ws,cl)(s)){const{uuid:d,ignoreOp:u}=s.payload;e(Tr({uuid:d,ignoreOp:u}))}if($t(Tr)(s)){const{payload:d}=s,u=a.blocks[d.uuid];if(!u)return;const f=a.blocks[u.parentId];if(!f)return;const h=f.subNodes.indexOf(d.uuid),p=f.subNodes[h-1],g=f.subNodes[h+1];e(g?cl({uuid:d.uuid,parentId:f.uuid,before:g,ignoreOp:d.ignoreOp}):ws({uuid:d.uuid,parentId:f.uuid,after:p,ignoreOp:d.ignoreOp}))}if($t(Xc)(s)){const{payload:d}=s,u=a.collectionViews[d.uuid];if(!u)return;const f={pageSort:u.pageSort,format:u.format,status:u.status,updatedAt:u.updatedAt};e(Xc({uuid:d.uuid,patch:f}))}if($t(bp,yp)(s)){const{payload:d}=s;e(dm({uuid:d.uuid,parentId:a.user.currentSpaceViewId}))}if($t(dm)(s)){const{payload:d}=s,u=a.spaceViews[a.user.currentSpaceViewId];if(!u)return;const f=u.favoritePages.indexOf(d.uuid);if(f===0)e(yp({uuid:d.uuid,parentId:a.user.currentSpaceViewId}));else{const h=u.favoritePages[f-1];h&&e(bp({uuid:d.uuid,parentId:a.user.currentSpaceViewId,after:h}))}}if($t(c1,l1)(s)){const{payload:d}=s,u=a.spaceViews[a.user.currentSpaceViewId];if(!u)return;const f=a.spaces[u.spaceId];if(!f)return;e(d1({uuid:d.uuid,parentId:f.uuid}))}if($t(d1)(s)){const{payload:d}=s,u=a.spaceViews[a.user.currentSpaceViewId];if(!u)return;const f=a.spaces[u.spaceId];if(!f)return;const h=(c=f.customTemplates)==null?void 0:c.indexOf(d.uuid);if(h===0)e(l1({uuid:d.uuid,parentId:f.uuid}));else{const p=u.favoritePages[h-1];p&&e(c1({uuid:d.uuid,parentId:f.uuid,after:p}))}}}),e(a0()),Tb.push(t))},Uee=e=>{const t=Tb.pop();t&&(t.forEach(n=>{var a;const{action:s}=n;if($t(sr)(s)){const o=s.payload;(a=i1.get(o))==null||a.redo()}else e(s)}),e(a0()),zd.push(t))};let Vx;const Vee=({getState:e,dispatch:t})=>n=>s=>{var a,o,i;if($t(O3)(s)){for(zc=1,Ux=!0,Tb.length=0;zd.length>49;)zd.shift();((a=An(zd))==null?void 0:a.length)!==0&&zd.push([]),Vx=s.payload.state}if($t(kb)(s)&&(Ux=!1,Vx=void 0),Ux&&$t($a,Sn,Tr,ws,cl,ku,Xc,lm,Tu,im,cd,ld,cm,sr,bp,yp,dm,Tw,Fp,su,o0,i0,c0,u1,d0,u0)(s)){const l=Vx||e();(o=An(zd))==null||o.push({snapshot:{...l,user:{...yt},spaceViews:{...Sm},spaces:{...Td}},action:s})}if($t(sr)(s)){const l=s.payload;(i=i1.get(l))==null||i.init()}if($t(jm)(s)){n(s),Mee(t);return}if($t(cg)(s)){n(s),Uee(t);return}$t(x9)(s)&&(i1.clear(),zd.length=0,Tb.length=0,Ux=!1,Vx=void 0),n(s)},Wk=!0,$ee=!1,Hee=!0,$3=K1("$local-state",()=>({beta:!0,$showCountDown:void 0})),zee=Qs($3,{assign:!0}),NAe=$3,jAe=(e,t)=>{zee(n=>({...n,$showCountDown:{...n.$showCountDown,[e]:{startTime:t}}}))},f1={cacheVersion:qe(),cache:new Map,clear:()=>{f1.cache.clear(),f1.cacheVersion=qe()}};class vd{constructor(t,n,s){q(this,"cache",new Map);q(this,"getCacheKey");q(this,"opt",{enable:!0});this.fn=t,this.getCacheKey=n,s!=null&&s.enable&&(this.opt.enable=s.enable)}getMemoizedFunction(){const t=qv((...s)=>this.fn(...s),{isEqual:In});return(...s)=>{if($3.getState().beta&&this.opt.enable){const a=this.getCacheKey?ES([f1.cacheVersion,this.getCacheKey(...s)]):ES([f1.cacheVersion,...s]);if(this.cache.has(a))return this.cache.get(a);const o=t(...s);return this.cache.set(a,o),o}return t(...s)}}static create(t,n,s){return new vd(t,n,s).getMemoizedFunction()}}const xD={run:Ps(()=>{const e=bs.getMap(),t=(n,s)=>{n.subscribe.listenerCount(s)||bs.deleteObs(s)};e.normal.forEach(t),e.select.forEach(t)},3e3)};class qee{constructor(){q(this,"observableGroupMap");this.observableGroupMap={normal:new Map,select:new Map}}getObsGroup(t){return Kk(t)?this.observableGroupMap.select:this.observableGroupMap.normal}patch(t,n,s){xD.run();const a=n!=null?n:typeof t=="symbol"?t:Symbol(t),o=this.getObsGroup(t);if(o.has(t)){const l=o.get(t);return(!In(l.value,a)||s!=null&&s.force)&&(l.value=a,l.subscribe.emit(t)),l}const i={value:a,subscribe:new ZG};return o.set(t,i),i}onlyPatch(t,n,s){if(this.getObsGroup(t).has(t))return this.patch(t,n,s)}deleteObs(t){const n=this.getObsGroup(t).get(t);n&&(n.subscribe.removeAllListeners(),this.getObsGroup(t).delete(t),xD.run())}get(t){const n=this.getObsGroup(t).get(t);return n||(Kk(t)?this.patch(t):Yee(t)?this.patch(t):this.patch(t))}clear(){this.observableGroupMap.normal.forEach(t=>t.subscribe.removeAllListeners()),this.observableGroupMap.select.forEach(t=>t.subscribe.removeAllListeners()),this.observableGroupMap.select.clear(),this.observableGroupMap.normal.clear()}getMap(){return this.observableGroupMap}has(t){return this.getObsGroup(t).has(t)}}const tl="select=block",Yi="select=cell",Gee=!1,Kk=(e="")=>{var t,n;return typeof e=="string"?((t=e==null?void 0:e.startsWith)==null?void 0:t.call(e,tl))||((n=e==null?void 0:e.startsWith)==null?void 0:n.call(e,Yi)):!1},Nf=e=>e.viewId&&e.blockId&&e.syncId?"".concat(tl,"&blockId=").concat(e.blockId,"&syncId=").concat(e.syncId,"&viewId=").concat(e.viewId):e.blockId?C9(e.blockId):e.syncId?E9(e.syncId):e.viewId?k9(e.viewId):e.all?Wee():"".concat(tl),E9=e=>"".concat(tl,"&syncId=").concat(e),C9=e=>"".concat(tl,"&blockId=").concat(e),k9=e=>"".concat(tl,"&viewId=").concat(e),Wee=()=>"".concat(tl,"&all"),$l=e=>e.propertyId&&e.recordId&&e.viewId?"".concat(Yi,"&recordId=").concat(e.recordId,"&viewId=").concat(e.viewId,"&propertyId=").concat(e.propertyId):e.recordId?"".concat(Yi,"&recordId=").concat(e.recordId):e.viewId?"".concat(Yi,"&viewId=").concat(e.viewId):e.propertyId?"".concat(Yi,"&propertyId=").concat(e.propertyId):e.all?"".concat(Yi,"&all"):Yi,H3="&simpleTable",Kee=(e="")=>typeof e=="string"?e.startsWith(H3):!1,Yk="&update=permission",T9=e=>e?"".concat(Yk,"&id=").concat(e):Yk,Yee=e=>{if(typeof e=="string")return e==null?void 0:e.includes(Yk)},yD="&update=ignoreDeep",v9=e=>e?"".concat(yD,"&id=").concat(e):yD,bD="&update=ignoreOtherData",I9=e=>e?"".concat(bD,"&id=").concat(e):bD,FD="&isCut",N9=e=>e?"".concat(FD,"&id=").concat(e):FD;var Vc=(e=>(e.ALL_USERS="ALL_USERS",e.HAS_SELECT_BLOCK="HAS_SELECT_BLOCK",e.HAS_SELECT_CELL="HAS_SELECT_CELL",e.ALL_DISCUSSIONS="ALL_DISCUSSIONS",e))(Vc||{});const Xee=e=>{const t={};for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const s=e[n];(s===null||s instanceof Date||s instanceof Error||typeof s!="object"&&typeof s!="function")&&(t[n]=s)}return t},bs=new qee,Qee={},j9=Em({initialState:Qee,name:"collectionViews",reducers:{update(e,t){Object.assign(e,t.payload)},clear(){return{}}},extraReducers(e){e.addCase(ku,(t,{payload:n})=>{t[n.collectionView.uuid]=n.collectionView}),e.addCase(Xc,(t,{payload:n})=>{const s=t[n.uuid];if(s){n.patch.format&&Object.assign(s.format,n.patch.format);const a=kn(n.patch,"format");Object.keys(a).length>0&&Object.assign(s,a)}}),e.addCase(cd,(t,{payload:n})=>{const{uuid:s,viewId:a}=n,o=t[a];o&&(o.pageSort=o.pageSort.filter(i=>i!==s))}),e.addCase(cm,(t,{payload:n})=>{const{uuid:s,viewId:a,before:o}=n,i=t[a];if(i)if(o){const l=i.pageSort.indexOf(o);l<0?i.pageSort.unshift(s):i.pageSort.splice(l,0,s)}else i.pageSort.unshift(s)}),e.addCase(ld,(t,{payload:n})=>{const{uuid:s,after:a,viewId:o}=n,i=t[o];if(i)if(a){const l=i.pageSort.indexOf(a);l<0?i.pageSort.push(s):i.pageSort.splice(l+1,0,s)}else i.pageSort.push(s)})}}),Jee=j9.reducer,kl=j9.actions,Zee={},S9=Em({initialState:Zee,name:"comments",reducers:{update(e,t){Object.assign(e,t.payload)},clear(){return{}}},extraReducers(e){e.addCase(c0,(t,{payload:n})=>{t[n.comment.uuid]=n.comment}),e.addCase(u1,(t,{payload:n})=>{const s=t[n.uuid];s&&Object.assign(s,n.patch)})}}),ete=S9.reducer,z3=S9.actions,tte={},D9=Em({initialState:tte,name:"discussions",reducers:{update(e,t){Object.assign(e,t.payload)},clear(){return{}}},extraReducers(e){e.addCase(Fp,(t,{payload:n})=>{t[n.discussion.uuid]=n.discussion}),e.addCase(su,(t,{payload:n})=>{const s=t[n.uuid];s&&Object.assign(s,n.patch)}),e.addCase(d0,(t,{payload:n})=>{const{uuid:s,after:a,parentId:o}=n,i=t[o];if(i)if(!i.comments)i.comments=[s];else if(a){const l=i.comments.indexOf(a);l<0?i.comments.push(s):i.comments.splice(l+1,0,s)}else i.comments.push(s)}),e.addCase(u0,(t,{payload:n})=>{var i;const{uuid:s,parentId:a}=n,o=t[a];o&&(o.comments=(i=o.comments)==null?void 0:i.filter(l=>l!==s))})}}),nte=D9.reducer,Oh=D9.actions,ste={},A9=Em({name:"simple-table",initialState:ste,reducers:{update(e,t){Object.assign(e,t.payload)}}}),rte=A9.reducer,Ns=A9.actions,ate={selectedBlocks:[],selectedCells:[]},R9=Em({name:"ui",initialState:ate,reducers:{update(e,t){t.payload.selectedBlocks&&(e.isSelectTopToBottom=!0),Object.assign(e,t.payload)},updateSelectBlocks(e,t){e.selectedBlocks=t.payload,t.payload.length&&(e.selectedCells=[]),e.isSelectTopToBottom=!0},addSelectBlock(e,t){e.selectedBlocks.find(s=>s.blockId===t.payload.blockId)||e.selectedBlocks.push(t.payload)},removeSelectBlock(e,t){const n=e.selectedBlocks.findIndex(s=>s.blockId===t.payload.blockId);n>=0&&e.selectedBlocks.splice(n,1)},updateSelectCells(e,t){e.selectedCells=t.payload,t.payload.length&&(e.selectedBlocks=[],e.isSelectTopToBottom=!0)}},extraReducers(){}}),ote=R9.reducer,at=R9.actions,f0=(e="")=>fB(e,{style:iJ}).join(""),dd=(e="",t=!1)=>fB(e,{style:mB,heteronym:t}).join(""),ite={},P9=Em({name:"users",initialState:ite,reducers:{update(e,t){Object.assign(e,t.payload)},clear(){return{}},updateSpaceUsers(e,t){const{users:n,space:s}=t.payload,a=Object.entries(n).reduce((o,[i,l])=>{var d,u,f,h;const c=(u=(d=s==null?void 0:s.userRemark)==null?void 0:d[i])!=null?u:"";return o[i]={...l,pinyin:"".concat(dd(l.nickname||Po,!0)).concat(l.phone).concat(dd(c)),spaceRole:(h=(f=s==null?void 0:s.permissions)==null?void 0:f.find(({userId:p})=>p===i))==null?void 0:h.role},o},{});Object.assign(e,a)},removeUser(e,t){delete e[t.payload]}}}),lte=P9.reducer,Ha=P9.actions,cte=({getState:e})=>{const t=(i,l)=>{const c=e(),d=c.blocks[i]||c.collectionViews[i]||c.comments[i]||c.discussions[i]||c.users[i];if(bs.onlyPatch(i,d,l),bs.onlyPatch(T9(i),d==null?void 0:d.permissions,l),d){const u=v9(i),f=I9(i),h=bs.has(u),p=bs.has(f);if(h||p){const g=kn(d,["updatedAt","updatedBy","createdAt","createdBy","version"]),_=Xee(g);bs.onlyPatch(u,_,l),bs.onlyPatch(f,g,l)}}},n=i=>{if(i.syncId){const c=Nf({syncId:i.syncId});bs.onlyPatch(c)}if(i.blockId){const c=Nf({blockId:i.blockId});bs.onlyPatch(c)}if(i.viewId){const c=Nf({viewId:i.viewId});bs.onlyPatch(c)}if(i.blockId&&i.syncId&&i.viewId){const c=Nf(i);bs.onlyPatch(c)}const l=Nf({all:!0});bs.onlyPatch(l),bs.onlyPatch(Vc.HAS_SELECT_BLOCK)},s=i=>{if(i.recordId){const c=$l({recordId:i.recordId});bs.onlyPatch(c)}if(i.viewId){const c=$l({viewId:i.viewId});bs.onlyPatch(c)}if(i.recordId){const c=$l({recordId:i.recordId});bs.onlyPatch(c)}if(i.recordId&&i.viewId&&i.propertyId){const c=$l(i);bs.onlyPatch(c)}const l=$l({all:!0});bs.onlyPatch(l),bs.onlyPatch(Vc.HAS_SELECT_CELL)},a=i=>{bs.onlyPatch(Vc.HAS_SELECT_BLOCK),bs.getMap().select.forEach((c,d)=>{d!=null&&d.includes(i)&&c.value!==!1&&bs.onlyPatch(d,Gee)})},o=()=>{a(tl),a(Yi)};return i=>l=>{const c=()=>{var d,u,f,h,p,g,_,x,F;if($t(Oh.update,Oh.clear,su,Fp,d0,u0)(l)&&bs.onlyPatch(Vc.ALL_DISCUSSIONS),$t(Tn.incVersion,Xc,ku,Tn.update,Tn.clear,Sn)(l)&&f1.clear(),!$t(Tn.incVersion)(l)){if($t(Tn.clear,Oh.clear)(l)){bs.clear();return}if($t(Ha.clear,Ha.removeUser,Ha.update,Ha.updateSpaceUsers)(l)&&bs.onlyPatch(Vc.ALL_USERS),$t(at.addSelectBlock,at.removeSelectBlock,at.update,at.updateSelectBlocks,at.updateSelectCells)(l)||((d=l.payload)!=null&&d.uuid&&t(l.payload.uuid),(u=l.payload)!=null&&u.discussionId&&t(l.payload.uuid),(f=l.payload)!=null&&f.viewId&&t(l.payload.viewId),(h=l.payload)!=null&&h.parentId&&t(l.payload.parentId),(p=l.payload)!=null&&p.after&&t(l.payload.after),(g=l.payload)!=null&&g.before&&t(l.payload.before)),$t(kl.update)(l)){ka(l.payload).forEach(b=>{t(b)});return}if($t(ku)(l)){t(l.payload.collectionView.uuid);return}if($t(Sn)(l)&&(_=l.payload.patch.data)!=null&&_.collectionProperties){const{blocks:b}=e(),w=b[l.payload.uuid];if(w!=null&&w.parentId){const E=b[w.parentId];(E==null?void 0:E.type)===m.BlockType.COLLECTION_VIEW&&t(w.parentId,{force:!0})}}if($t(Ns.update)(l)){bs.onlyPatch(H3);return}if($t(Tr,ws,cl,Tu,im,lm,cd)(l)){const b=e().blocks[l.payload.uuid];b!=null&&b.parentId&&t(b.parentId);return}if($t($a)(l)){const{block:b}=l.payload;t(b.uuid);return}if($t(r0)(l)){const{uuid:b}=l.payload;bs.deleteObs(b);return}if($t(Tn.update)(l)){ka(l.payload.blocks).forEach(b=>{t(b)});return}if($t(Tn.incVersion)(l)){l.payload.forEach(w=>{e().blocks[w]&&t(w)});return}if($t(y9)(l)){yh.create(l.payload.space);return}if($t(M3)(l)){yh.update(l.payload);return}if($t(kw)(l)){yh.addMarkName(l.payload);return}if($t(d1)(l)){yh.listRemoveTemplate(l.payload);return}if($t(l1)(l)){yh.listBeforeTemplate(l.payload);return}if($t(c1)(l)){yh.listAfterTemplate(l.payload);return}if($t(jee)(l)){bh.create(l.payload);return}if($t(See)(l)){bh.delete(l.payload);return}if($t(Tw)(l)){bh.updateSpaceView(l.payload);return}if($t(dm)(l)){bh.listRemoveFavorite(l.payload);return}if($t(yp)(l)){bh.listBeforeFavorite(l.payload);return}if($t(bp)(l)){bh.listAfterFavorite(l.payload);return}if($t(Oh.update)(l)){ka(l.payload).forEach(b=>{t(b)});return}if($t(Fp)(l)){t(l.payload.discussion.uuid);return}if($t(z3.update)(l)){ka(l.payload).forEach(b=>{t(b)});return}if($t(c0)(l)){t(l.payload.comment.uuid);return}if($t(at.update)(l)){if(((x=l.payload.selectedBlocks)==null?void 0:x.length)===0&&((F=l.payload.selectedCells)==null?void 0:F.length)===0){o();return}l.payload.selectedBlocks&&(a(tl),l.payload.selectedBlocks.forEach(n)),l.payload.selectedCells&&(a(Yi),l.payload.selectedCells.forEach(s))}$t(at.updateSelectBlocks)(l)&&(l.payload.length&&a(Yi),a(tl),l.payload.forEach(n)),$t(at.addSelectBlock,at.removeSelectBlock)(l)&&n(l.payload),$t(at.updateSelectCells)(l)&&(l.payload.length&&a(tl),a(Yi),l.payload.forEach(s))}};i(l),c()}};var Ca=(e=>(e.Log="flowus:log",e.CheckForUpdates="flowus:check-for-updates",e.UpdateNotAvailable="flowus:update-not-available",e.UpdateAvailable="flowus:update-available",e.CanHistoryBackAndForward="flowus:can-history-back-and-forward",e.OnOpenSetting="flowus:on-open-setting",e.Reload="flowus:reload",e.Zoom="flowus:zoom",e.IsFullScreen="flowus:is-full-screen",e.OnFullScreenToggle="flowus:on-full-screen-toggle",e.GetAppVersion="flowus:get-app-version",e.OnFind="flowus:on-find",e.GetWebContents="flowus:get-web-contents",e.DownloadUrl="flowus:download-url",e.DownloadMessage="flowus:download-message",e.WebDownloaded="flowus:web-downloaded",e.CopyText="flowus:copy-text",e.CopyImage="flowus:copy-image",e.UpdateReload="flowus:update-reload",e.UpdateDownloadComplete="flowus:update-download-complete",e.UpdateError="flowus:update-error",e.HotUpdateComplete="flowus:hot-update-complete",e.HotUpdateDowning="flowus:hot-update-downing",e.NotHotUpdate="flowus:no-hot-update",e.Message="flowus:message",e.ClearCacheAndReload="flowus:clear-cache-and-reload",e))(Ca||{}),Ve=(e=>(e.AI_PAGE="AI_PAGE",e.ORDER_RECORD_MODAL="ORDER_RECORD_MODAL",e.REWARD_TASK="REWARD_TASK",e.CREATE_SPACE_AFTER="CREATE_SPACE_AFTER",e.STRIPE_CHECKOUT="STRIPE_CHECKOUT",e.PAY_MODAL="PAY_MODAL",e.AD_ERROR="AD_ERROR",e.WELFARE_HISTORY="WELFARE_HISTORY",e.HOT_SPOT="HOT_SPOT",e.AI_NOVICE="AI_NOVICE",e.UPDATE_LOG="UPDATE_LOG",e.IMPORTANT_FEATURE="IMPORTANT_FEATURE",e.MAXIMUM_CAPACITY_DIALOG="MAXIMUM_CAPACITY_DIALOG",e.AI_EDITOR="AI_EDITOR",e.CHECK_SPACE="CHECK_SPACE",e.SERVICE_CENTER="SERVICE_CENTER",e.TRASH="TRASH",e.SETTING="SETTING",e.DRIVE_FILE_CONTEXTMENU="DRIVE_FILE_CONTEXTMENU",e.FILE_PREVIEW="FILE_PREVIEW",e.PAGE_HEADER_MENU_LIST="PAGE_HEADER_MENU_LIST",e.BITABLE_PROPERTY_WIDGET="BITABLE_PROPERTY_WIDGET",e.DRIVE_UPLOAD_MENU="DRIVE_UPLOAD_MENU",e.TEMPLATE_PREVIEW="TEMPLATE_PREVIEW",e.TEMPLATE_CENTER="TEMPLATE_CENTER",e.MESSAGE_NOTIFICATION="MESSAGE_NOTIFICATION",e.HEADER_COVER_IMAGE="HEADER_COVER_IMAGE",e.CREATE_PAGE_TIP="CREATE_PAGE_TIP",e.KOL_SALES="KOL_SALES",e.COMMENTS="COMMENTS_AT_CARET",e.SELECT_UPDATE_PLAN="SELECT_UPDATE_PLAN",e.SINGLE_CAPACITY="SINGLE_CAPACITY",e.QUICK_SEARCH="QUICK_SEARCH",e.TABLE_HEADER_MENU_LIST="TABLE_HEADER_MENU_LIST",e.PREVIEW_FORM="PREVIEW_FORM",e.BITABLE_OPTION_MENU="BITABLE_OPTION_MENU",e.BITABLE_TEMPLATE_RECORDS="BITABLE_TEMPLATE_RECORDS",e.INLINE_PANEL="INLINE_PANEL",e.CLEAR_TEMPLATE="CLEAR_TEMPLATE",e.DOC_HISTORY_MODAL_ID="DOC_HISTORY_MODAL_ID",e.CONTEXT_DISCUSSIONS="CONTEXT_DISCUSSIONS",e.HIGH_PERFORMANCE_MODE="HIGH_PERFORMANCE_MODE",e.SYNC_UP_FAULT="SYNC_UP_FAULT",e.SYNC_BLACK_LINK="SYNC_BLACK_LINK",e.UPGRADE_SUPPORT="UPGRADE_SUPPORT",e.ORDER_LIST_SUPPORT="ORDER_LIST_SUPPORT",e.CAPACITY_ORDER_LIST_ID="CAPACITY_ORDER_LIST_ID",e.TRANSFER_LIST_ID="TRANSFER_LIST_ID",e.TOOLBAR_ID="TOOLBAR_ID",e.EXCHANGE_CODE_ID="EXCHANGE_CODE_ID",e.SCORE_SHOP="SCORE_SHOP",e.WARE_RECORD="WARE_RECORD",e.MINI_PRICE_PLAN_MODAL="MINI_PRICE_PLAN_MODAL",e.CHART_PANEL_ID="CHART_PANEL_ID",e.CHART_THEME="CHART_THEME",e.EXPAND_NODE="EXPAND_NODE",e.SHARE_POSTER="SHARE_POSTER",e))(Ve||{}),vu=(e=>(e.UPLOAD_ICON="UPLOAD_ICON",e.NO_PERMISSION_SYNC_WARNING_ID="NO_PERMISSION_SYNC_WARNING_ID",e))(vu||{}),L9=(e=>(e.SettingProfitRedPoint="SettingProfitRedPoint",e))(L9||{}),St=(e=>(e.pro="personal",e.freePersonal="freePersonal",e.team="team",e.freeTeam="freeTeam",e.smallTeam="smallTeam",e))(St||{}),dte=(e=>(e.DARK_MODE="dark-mode",e.PAGE_ID="page-id",e))(dte||{}),B9=(e=>(e.OPEN_PAGE="go_to_page",e.OPEN_PAY_SUBSCRIPTION_PAGE="open_pay_subscription_page",e.GET_WPS_TOKEN="get_wps_token",e.GET_GLOBAL_CONFIG="get_global_config",e.UPDATE_GLOBAL_CONFIG="update_global_config",e.CLOSE_WINDOW="close_window",e))(B9||{}),is=(e=>(e.uploading="uploading",e.success="success",e.failure="failure",e))(is||{}),fr=(e=>(e.normal="normal",e.card="card",e.preview="preview",e))(fr||{});class ute{constructor(){q(this,"mainMgr");q(this,"_tasks",[]);q(this,"change$",new V1);q(this,"pollTimer");q(this,"allowStopSince",-1/0);if(!gs.check)return;const{port1:t,port2:n}=new MessageChannel,s=W1();s==null||s.postMessage("comlink-download-manager-port",null,[t]),Pe(()=>import("./index-cb1b951e.js"),[]).then(a=>{this.mainMgr=a.wrap(n),this.startPoll()})}get tasks(){return this._tasks}get onChange(){return this.change$.asObservable()}startPoll(t=1e3){this.allowStopSince=Math.max(this.allowStopSince,Date.now()+t),!(this.pollTimer||this.mainMgr==null)&&(this.pollTimer=window.setInterval(async()=>{if(!this.mainMgr)return;const n=await this.mainMgr.getTasks();In(n,this._tasks)||(this._tasks=n,this.change$.next()),!this._tasks.some(s=>s.state==="progressing")&&Date.now()>=this.allowStopSince&&(clearInterval(this.pollTimer),this.pollTimer=void 0)},50))}async download(t){var n;await((n=this.mainMgr)==null?void 0:n.download(t)),this.startPoll()}async downloadMany(t){var n;await((n=this.mainMgr)==null?void 0:n.downloadMany(t)),this.startPoll()}async cancel(t){var n;await((n=this.mainMgr)==null?void 0:n.cancel(t)),this.startPoll()}async remove(t){var n;await((n=this.mainMgr)==null?void 0:n.remove(t)),this.startPoll()}}const du=new ute,Am=Aa(()=>({})),q3=Qs(Am),O9=()=>Am.getState(),fte=e=>{q3(Yn(t=>os(t,e)),{replace:!0})},G3=e=>{q3(Yn(t=>kn(t,e)),{replace:!0})},SAe=()=>{q3(e=>{const t={};return jo(e).forEach(n=>{n.status===is.uploading&&(t[n.key]=n)}),t},{replace:!0}),du.tasks.forEach(e=>{e.state!=="progressing"&&du.remove(e.id)})},mte=()=>Am(e=>e,In),DAe=()=>Am(e=>e.length),hc=e=>Am(t=>Object.values(t).find(n=>n.key.endsWith(e)),In),qc=e=>{var n;const{key:t}=e;if(t){const s=(n=O9()[t])!=null?n:{};fte({[t]:{...s,...e}})}},M9=e=>Am(t=>Object.entries(t).filter(([n,s])=>n.startsWith(e)&&s.status&&[is.uploading,is.failure].includes(s.status)).flatMap(([n,s])=>s).sort((n,s)=>s.createdAt-n.createdAt),In),U9=e=>Am(t=>Object.entries(t).filter(([n,s])=>n.startsWith(e)&&s.status&&[is.uploading,is.failure].includes(s.status)).length),$x=()=>{var e,t;return(t=(e=hte(yt.currentSpaceViewId))==null?void 0:e.uuid)!=null?t:""},hte=e=>{var t,n;return Td[(n=(t=Sm[e])==null?void 0:t.spaceId)!=null?n:""]},uu="flowus.backup_transactions",Hx="flowus.backup_no_permission_transactions",K2="flowus.backup_error_transactions",zx="flowus.backup_any_time_",Fh="flowus.backup_any_time",pte=7;let A_={};const nl=eW.expanding();let Ar=[];const vb=new V1;let Mh=Date.now(),wD=0;const Y2=new Set,jn=(e,t)=>{var s;((s=A_[e])!=null?s:A_[e]=[]).push(t)},gte=e=>{const t=[];return e.forEach(n=>t.push(...Cte(n))),t},X2=()=>ue().format("YYYY-MM-DD.HH:mm"),Hn={loading:!1,timer:null,all:[],noPermission:[],error:[],get:e=>Hn[e],set:(e,t)=>{switch(e){case"all":{const n=X2();return Fs.setItem("".concat(zx).concat(n),t)}case"error":return Fs.setItem(K2,t);case"noPermission":return Fs.setItem(Hx,t)}},getDB:async e=>{var t,n,s,a;if(e==="all"){const o=X2(),i=(t=await Fs.getItem(Fh))!=null?t:[],[l]=i;return l&&ue(l).diff(ue(),"day")>=pte&&(i.shift(),Fs.removeItem("".concat(zx).concat(l)),Fs.setItem(Fh,i)),i!=null&&i.includes(o)||(i.push(o),Fs.setItem(Fh,i)),(n=await Fs.getItem("".concat(zx).concat(o)))!=null?n:{}}return e==="error"?(s=await Fs.getItem(K2))!=null?s:[]:e==="noPermission"?(a=await Fs.getItem(Hx))!=null?a:[]:[]},update:(e,t)=>{Hn[e]=[...Hn[e],...t],Hn.start()},start:()=>{Hn.loading||Hn.all.length+Hn.error.length+Hn.noPermission.length&&(Hn.stop(),Hn.timer=setTimeout(async()=>{var e;if(Hn.loading=!0,Hn.stop(),Hn.noPermission.length){const t=await Hn.getDB("noPermission");await Hn.set("noPermission",[...t,...Hn.noPermission]),Hn.noPermission=[]}if(Hn.error.length){const t=await Hn.getDB("error");await Hn.set("error",[...t,...Hn.error]),Hn.error=[]}if(Hn.all.length){const t=X2(),n=await Hn.getDB("all");n[t]=[...(e=n[t])!=null?e:[],...Hn.all],await Hn.set("all",n),Hn.all=[]}Hn.loading=!1,Hn.start()},3e3))},stop:()=>{clearTimeout(Hn.timer)},clear:async()=>{var t;const e=(t=await Fs.getItem(Fh))!=null?t:[];Fs.removeItem(K2),Fs.removeItem(Hx),Fs.removeItem(Hx);for(const n of e)Fs.removeItem(n);Fs.removeItem(Fh)},getAllTrs:async()=>{var n,s;const e=(n=await Fs.getItem(Fh))!=null?n:[],t={};for(const a of e){const o=(s=await Fs.getItem("".concat(zx).concat(a)))!=null?s:[];o&&os(t,o)}return t}},_te=async()=>{const e=await Hn.getDB("error"),t=await Hn.getDB("noPermission"),n=await Hn.getAllTrs();await Ete({all:n,error:e,noPermission:t})},xte=async()=>{await Hn.clear()},ED=async e=>{await wte(),Ar=gte([...Ar,...nl.flush()]),Mh=Date.now();const t=[],n=[],s=[];if(Ar.length>0){Ta.offline&&await bk(Ta.onStatusChange.pipe(ZP(()=>Ta.online)));const a=[];for(;Ar.length>0;){const o=Ar.shift();Mh=Date.now(),a.push(o);let i=!1;if(W3(a,32*1024)){const l=a.pop();a.length===0?a.push(l):(Ar.unshift(l),Mh=Date.now()),i=!0}else Ar.length<=0&&(i=!0);if(i){const l=a.slice(0);a.length=0;try{await ve.editor.transactionRecords({requestId:qe(),transactions:l}),s.push(...l)}catch(c){if(n.push(...l),c.code!==1403)throw Ar=[...l,...Ar],c;t.push(...l)}Ta.setStatus("online"),st({$syncUpFault:{noPermission:!1,backup:!1}}),l.forEach(c=>{const d=sp.get(c.id);d==null||d(),sp.delete(c.id)})}}Ar.length<=0&&nl.isEmpty()&&st({$dirty:!1}),Ar.length<=0&&Fs.removeItem(uu)}Hn.update("all",s),t.length&&Hn.update("noPermission",t),n.length&&Hn.update("error",n),Mh=Date.now()},CD=1e3,yte=async e=>{const t=await Fs.getItem(uu);if(t!=null&&t.transactions.length>0){for(const o of t.transactions)nl.put(o);try{await ED(e)}catch(o){}if(Ar.length===0)await kD(),location.reload();else{const o=[...Ar,...nl.flush()];Ar=[];let i=0,l=o.length;for(;!(l<=i);){const c=o.slice(i,l);try{await ve.editor.transactionRecords({requestId:qe(),transactions:c}),i=l,l=o.length}catch(d){l=Math.floor((i+l)/2)}}await kD(),location.reload()}}let n=[],s=-1/0,a=0;for(;;){let o="defer";if(Ar.length===0&&nl.isEmpty()&&(o=await bk(vb)),o==="defer"){const i=Date.now();if(i-s<CD){const l=CD-(i-s);await bk(nW(sW(l),vb.pipe(Gv())))}}if(Ar.length>0||!nl.isEmpty()){try{await ED(e),n=[],a=0}catch(i){const l=/502/i.test("".concat(i==null?void 0:i.code)),c=/Network Error/i.test("".concat(i==null?void 0:i.message)),d=/^13/.test("".concat(i==null?void 0:i.code));if(c&&!navigator.onLine&&Ta.setStatus("offline"),l||d)a=Math.min(a+8,32),await es(1e3*a);else if(!c){const u=Date.now();n.push({error:i,timestamp:u}),n=n.filter(f=>u-f.timestamp<15*60*1e3),n.length>=3&&(zp(i),st({$syncUpFault:{...xt.$syncUpFault,backup:!0}}),await es(15*60*1e3))}}s=Date.now()}}},V9=e=>{const t=e.flush();for(const n of t)e.put(n);return t},bte=()=>[...Ar,...V9(nl)],$9=async e=>{var t,n,s,a;if(wD<Mh){const o=[...Ar,...V9(nl)],i={};for(const l of o)for(const c of l.operations){const d=(a=(s=(t=c.args)==null?void 0:t.uuid)!=null?s:(n=c.args)==null?void 0:n.parentId)!=null?a:c.id,u=ww(d,e());u!=null&&(i[u]=e().blocks[u].version)}o.length>0?await Fs.setItem(uu,{affectedPages:i,transactions:o}):await Fs.removeItem(uu),wD=Date.now()}},Fte=async e=>{for(;;)await $9(e),await es(1e3)},kD=async()=>{Ar=[],nl.flush(),await Fs.removeItem(uu)},wte=async e=>{var n;const t=JSON.stringify(e!=null?e:bte(),null,2);try{const s=(n=await Fs.getItem("".concat(uu,".$")))!=null?n:0;await Fs.setItem("".concat(uu,".").concat(s),t),await Fs.setItem("".concat(uu,".$"),(s+1)%5)}catch(s){rW("backupTransactionsAndTriggerDownload: backup fail")}},Ete=async(e,t)=>{const n=JSON.stringify(e,null,2),s=new Blob([n],{type:"application/json; charset=UTF-8"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=t||"backup.json",o.style.cssText="position: fixed; left: -9999px; top: -9999px;",document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout(()=>{URL.revokeObjectURL(a)},60*1e3*3)},Q2=e=>(e==null?void 0:e.type)==="SPACE"?"space":"block",sp=new Map,W3=(e,t)=>{try{return JSON.stringify(e).length>=t}catch(n){return!0}},Cte=e=>{const t=[],{operations:n,spaceId:s,id:a}=e,o=sp.get(a);let i=!1;const l=()=>{i||(o==null||o(),sp.delete(a),i=!0)},d=W3(n,32*1024)?Wv(n,12):[n];return d.forEach((u,f)=>{const h=qe(),p={id:h,spaceId:s,operations:u};o!=null&&f===d.length-1&&sp.set(h,l),t.push(p)}),t},kte=({getState:e,dispatch:t})=>{yte(t),Fte(e);const n=s=>{const{callback:a=()=>{}}=s||{};let o=!1;const i=()=>{o||(a==null||a(),o=!0)};let l=!1;for(const[d,u]of Object.entries(A_)){const h=W3(u,65536)?Wv(u,12):[u];h.forEach((p,g)=>{const _=qe(),x={id:_,spaceId:d,operations:p};a!=null&&g===h.length-1&&sp.set(_,i),nl.put(x)}),l=!0,Mh=Date.now()}const c=[...Y2];t(U3.actions.incVersion(c)),c.length>0&&st({$dirty:!0}),Y2.clear(),A_={},l||i==null||i()};return window.addEventListener("beforeunload",s=>{$9(e),(Object.keys(A_).length||!nl.isEmpty()||Ar.length>0)&&(s.preventDefault(),s.returnValue="同步操作未完成, 是否离开?"),Object.entries(O9()).some(o=>o[1].progress!==100&&o[1].status===is.uploading)&&(s.preventDefault(),s.returnValue="图片仍在上传, 是否离开?")}),s=>a=>{var o,i;if(!Tte(a)||(o=a.payload)!=null&&o.ignoreOp)return s(a);if(Jn(a0)(a))return n(),vb.next("defer"),s(a);if(Jn(Sa)(a)){const l=new P3;return n({callback:()=>{l.resolve()}}),vb.next("immediate"),mo(()=>l.promise),s(a)}if(Y2.add(a.payload.uuid),Jn($a)(a)){const{payload:l}=a;return jn(l.block.spaceId,{id:l.block.uuid,command:m.CommandType.SET,table:"block",path:[],args:{...kn(l.block,["local","version","subNodes","data"]),data:TD(l.block.data)}}),s(a)}if(Jn(Tr)(a)){const{payload:l}=a,{blocks:c}=e(),d=c[l.uuid];if(d){const u=d.spaceId===d.parentId?"space":Q2(c[d.parentId]);jn(d.spaceId,{id:d.parentId,command:m.CommandType.LIST_REMOVE,table:u,path:["subNodes"],args:{uuid:d.uuid}})}return s(a)}if(Jn(ws)(a)){const{payload:l}=a,{blocks:c}=e(),d=c[l.uuid],u=c[l.parentId];if(d){const f=d.spaceId===l.parentId?"space":Q2(u);jn(d.spaceId,{id:d.uuid,command:m.CommandType.UPDATE,table:"block",path:[],args:{status:m.BlockStatus.NORMAL,parentId:l.parentId}}),jn(d.spaceId,{id:l.parentId,command:m.CommandType.LIST_AFTER,table:f,path:["subNodes"],args:{uuid:d.uuid,after:l.after}})}return s(a)}if(Jn(cl)(a)){const{payload:l}=a,{blocks:c}=e(),d=c[l.uuid],u=c[l.parentId];if(d){const f=d.spaceId===l.parentId?"space":Q2(u);d.parentId!==l.parentId&&jn(d.spaceId,{id:d.uuid,command:m.CommandType.UPDATE,table:"block",path:[],args:{status:m.BlockStatus.NORMAL,parentId:l.parentId}}),jn(d.spaceId,{id:l.parentId,command:m.CommandType.LIST_BEFORE,table:f,path:["subNodes"],args:{uuid:d.uuid,before:l.before}})}return s(a)}if(Jn(Sn)(a)){const{payload:l}=a,c=e().blocks[l.uuid];if(c&&(c!=null&&c.parentId)){const d=(i=l.patch.data)==null?void 0:i.segments;l.patch.data&&(d!=null&&d.length)&&JSON.stringify(d).includes('"text":false')&&(l.patch.data.segments=d.map(f=>({...f,enhancer:kn(f.enhancer,"textColor")})));const u=kn(l.patch,["local","version","subNodes","data"]);if(Object.keys(u).length&&jn(c.spaceId,{id:c.uuid,path:[],command:m.CommandType.UPDATE,table:"block",args:u}),l.path)jn(c.spaceId,{id:c.uuid,path:l.path,command:m.CommandType.UPDATE,table:"block",args:bu(l.patch,l.path)});else if(l.patch.data){const f=kn(l.patch.data,["format"]);jn(c.spaceId,{id:c.uuid,path:["data"],command:m.CommandType.UPDATE,table:"block",args:TD(f)}),l.patch.data.format&&jn(c.spaceId,{id:c.uuid,path:["data","format"],command:m.CommandType.UPDATE,table:"block",args:{...l.patch.data.format}})}}return s(a)}if(Jn(Ew)(a)){const{payload:l}=a,c=e().blocks[l.uuid];return c&&jn(c.spaceId,{id:c.uuid,path:[],command:m.CommandType.SET_PERMISSION,table:"block",args:l.permission}),s(a)}if(Jn(Cw)(a)){const{payload:l}=a,c=e().blocks[l.uuid];return c&&jn(c.spaceId,{id:c.uuid,path:[],command:m.CommandType.REMOVE_PERMISSION,table:"block",args:l.permission}),s(a)}if(Jn(ku)(a)){const{payload:l}=a;return jn(l.collectionView.spaceId,{id:l.collectionView.uuid,command:m.CommandType.SET,table:"collectionView",path:[],args:l.collectionView}),s(a)}if(Jn(Xc)(a)){const{payload:l}=a,{collectionViews:c}=e(),d=c[l.uuid];if(d){const u=kn(l.patch,["format"]);jn(d.spaceId,{id:l.uuid,command:m.CommandType.UPDATE,table:"collectionView",path:[],args:u}),l.patch.format&&jn(d.spaceId,{id:l.uuid,command:m.CommandType.UPDATE,table:"collectionView",path:["format"],args:{...l.patch.format}})}return s(a)}if(Jn(Tu)(a)){const{payload:l}=a,{collectionViews:c}=e(),d=c[l.uuid];return d&&(d.parentId!==l.parentId&&jn(d.spaceId,{id:d.uuid,command:m.CommandType.UPDATE,table:"collectionView",path:[],args:{status:m.BlockStatus.NORMAL,parentId:l.parentId}}),jn(d.spaceId,{id:l.parentId,table:"block",command:m.CommandType.LIST_AFTER,path:["views"],args:{uuid:l.uuid,after:l.after}})),s(a)}if(Jn(im)(a)){const{payload:l}=a,{collectionViews:c}=e(),d=c[l.uuid];return d&&(l.parentId!==d.parentId&&jn(d.spaceId,{id:d.uuid,command:m.CommandType.UPDATE,table:"collectionView",path:[],args:{status:m.BlockStatus.NORMAL,parentId:l.parentId}}),jn(d.spaceId,{id:l.parentId,table:"block",command:m.CommandType.LIST_BEFORE,path:["views"],args:{uuid:l.uuid,before:l.before}})),s(a)}if(Jn(cm)(a)){const{payload:l}=a,{collectionViews:c}=e(),d=c[l.viewId];return d&&jn(d.spaceId,{id:l.viewId,table:"collectionView",command:m.CommandType.LIST_BEFORE,path:["pageSort"],args:{uuid:l.uuid,before:l.before}}),s(a)}if(Jn(ld)(a)){const{payload:l}=a,{collectionViews:c}=e(),d=c[l.viewId];return d&&jn(d.spaceId,{id:l.viewId,table:"collectionView",command:m.CommandType.LIST_AFTER,path:["pageSort"],args:{uuid:l.uuid,after:l.after}}),s(a)}if(Jn(cd)(a)){const{payload:l}=a,{collectionViews:c}=e(),d=c[l.viewId];return d&&jn(d.spaceId,{id:l.viewId,table:"collectionView",command:m.CommandType.LIST_REMOVE,path:["pageSort"],args:{uuid:l.uuid}}),s(a)}if(Jn(cd)(a)){const{payload:l}=a,{collectionViews:c}=e(),d=c[l.uuid];return d&&jn(d.spaceId,{id:l.viewId,table:"collectionView",command:m.CommandType.LIST_REMOVE,path:["pageSort"],args:{uuid:l.uuid}}),s(a)}if(Jn(lm)(a)){const{payload:l}=a,{collectionViews:c}=e(),d=c[l.uuid];return d&&jn(d.spaceId,{id:l.parentId,table:"block",command:m.CommandType.LIST_REMOVE,path:["views"],args:{uuid:l.uuid}}),s(a)}if(Jn(bp)(a)){const{payload:l}=a,c=e().blocks[l.uuid];return c&&jn(c.spaceId,{id:l.parentId,table:"spaceView",command:m.CommandType.LIST_AFTER,path:["favoritePages"],args:{uuid:l.uuid,after:l.after}}),s(a)}if(Jn(yp)(a)){const{payload:l}=a,c=e().blocks[l.uuid];return c&&jn(c.spaceId,{id:l.parentId,table:"spaceView",command:m.CommandType.LIST_BEFORE,path:["favoritePages"],args:{uuid:l.uuid,before:l.before}}),s(a)}if(Jn(dm)(a)){const{payload:l}=a,c=$x();return jn(c,{id:l.parentId,table:"spaceView",command:m.CommandType.LIST_REMOVE,path:["favoritePages"],args:{uuid:l.uuid}}),s(a)}if(Jn(Tw)(a)){const{payload:l}=a,c=kn(l.patch,["setting"]),d=$x();return jn(d,{id:l.uuid,table:"spaceView",command:m.CommandType.UPDATE,path:[],args:c}),l.patch.setting&&jn(d,{id:l.uuid,table:"spaceView",command:m.CommandType.UPDATE,path:["setting"],args:{...l.patch.setting}}),s(a)}if(Jn(M3)(a)){const{payload:l}=a,c=$x(),d=Ni(l.patch,["title","icon","permissionGroups","domain","publicHomePage","isShowAd","setting"]);jn(c,{id:l.uuid,table:"space",command:m.CommandType.SET,path:[],args:d})}if(Jn(c1)(a)){const{payload:l}=a,c=e().blocks[l.uuid];return c&&jn(c.spaceId,{id:l.parentId,table:"space",command:m.CommandType.LIST_AFTER,path:["customTemplates"],args:{uuid:l.uuid,after:l.after}}),s(a)}if(Jn(l1)(a)){const{payload:l}=a,c=e().blocks[l.uuid];return c&&jn(c.spaceId,{id:l.parentId,table:"space",command:m.CommandType.LIST_BEFORE,path:["customTemplates"],args:{uuid:l.uuid,before:l.before}}),s(a)}if(Jn(d1)(a)){const{payload:l}=a,c=$x();return jn(c,{id:l.parentId,table:"space",command:m.CommandType.LIST_REMOVE,path:["customTemplates"],args:{uuid:l.uuid}}),s(a)}if(Jn(Fp)(a)){const{payload:l}=a;return jn(l.discussion.spaceId,{id:l.discussion.uuid,command:m.CommandType.SET,table:"discussion",path:[],args:l.discussion}),s(a)}if(Jn(su)(a)){const{payload:l}=a,{discussions:c}=e(),d=c[l.uuid];return d&&jn(d.spaceId,{id:l.uuid,command:m.CommandType.UPDATE,table:"discussion",path:[],args:l.patch}),s(a)}if(Jn(o0)(a)){const{payload:l}=a,c=e().discussions[l.uuid];return c&&jn(c.spaceId,{id:l.parentId,table:"block",command:m.CommandType.LIST_AFTER,path:["discussions"],args:{uuid:l.uuid,after:l.after}}),s(a)}if(Jn(i0)(a)){const{payload:l}=a;return jn(l.spaceId,{id:l.parentId,table:"block",command:m.CommandType.LIST_REMOVE,path:["discussions"],args:{uuid:l.uuid}}),s(a)}if(Jn(c0)(a)){const{payload:l}=a;return jn(l.comment.spaceId,{id:l.comment.uuid,command:m.CommandType.SET,table:"comment",path:[],args:l.comment}),s(a)}if(Jn(u1)(a)){const{payload:l}=a,{comments:c}=e(),d=c[l.uuid];return d&&jn(d.spaceId,{id:l.uuid,command:m.CommandType.UPDATE,table:"comment",path:[],args:l.patch}),s(a)}if(Jn(d0)(a)){const{payload:l}=a,c=e().comments[l.uuid];return c&&jn(c.spaceId,{id:l.parentId,table:"discussion",command:m.CommandType.LIST_AFTER,path:["comments"],args:{uuid:l.uuid,after:l.after}}),s(a)}if(Jn(u0)(a)){const{payload:l}=a;return jn(l.spaceId,{id:l.parentId,table:"discussion",command:m.CommandType.LIST_REMOVE,path:["comments"],args:{uuid:l.uuid}}),s(a)}s(a)}};function TD(e){return tW(e)?Ni(e,["pageId","cover","coverPos","icon","segments","checked","level","width","height","ratio","ossName","fileType","caption","widths","size","text","ref","link","extName","display","pageFixedWidth","directoryMenu","format","embedType","viewMode","columnRatio","permissions","schema","collectionProperties","collectionPageProperties","collectionCardColor","description","linkInfo","header","createdTemplateBy","pdfAnnotation","isByAI","openLink","defaultTemplateId"]):{}}function Tte(e){return/^(block|collection-view|space-view|transaction|favorite|space|template|discussion|comment)\//.test(e==null?void 0:e.type)}const vte=(e={})=>e,Iw=Object.freeze(Object.defineProperty({__proto__:null,blocks:Aee,cache:vte,collectionViews:Jee,comments:ete,discussions:nte,simpleTable:rte,ui:ote,users:lte},Symbol.toStringTag,{value:"Module"})),K3=Kv({reducer:Iw,devTools:!1,middleware:e=>e({serializableCheck:!1}).concat(kte,cte,Vee,Ree)}),{getState:pe,dispatch:re,subscribe:AAe}=K3,J=new Proxy(pe(),{get(e,t){return Reflect.get(pe(),t)}}),Nw=e=>e==null?!1:[m.BlockType.TEXTAREA,m.BlockType.HEADER,m.BlockType.TODO,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.MARK,m.BlockType.QUOTE,m.BlockType.CODE].includes(e),Ite=e=>e?e.type===m.BlockType.FILE&&e.data.display==="image"?!0:[m.BlockType.TEXTAREA,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.TEMPLATE,m.BlockType.TODO,m.BlockType.MARK,m.BlockType.QUOTE,m.BlockType.HEADER,m.BlockType.MIND_MAPPING].includes(e.type):!1,ga=e=>e===m.BlockType.COLLECTION_VIEW_PAGE||e===m.BlockType.COLLECTION_VIEW||e===m.BlockType.REFERENCE_COLLECTION||e===m.BlockType.REFERENCE_COLLECTION_PAGE,wp=e=>{var t,n,s;if(!e)return!1;if(e.type===m.BlockType.FILE&&e.data.ossName||e.type===m.BlockType.EXTERNAL_FILE&&e.data.link||e.type===m.BlockType.REFERENCE&&e.data.display==="image"||(e.type===m.BlockType.EMBED||e.type===m.BlockType.BOOKMARK)&&e.data.link||e.type===m.BlockType.CODE||e.type===m.BlockType.CHART&&((s=(n=(t=e.data.format)==null?void 0:t.chartFormat)==null?void 0:n.ref)!=null&&s.uuid))return!0},Xk=e=>wp(e)&&(e==null?void 0:e.data.showEmptyCaption),Yl=e=>e?e.type===m.BlockType.REFERENCE&&e.data.display==="linkPage"||e.type===m.BlockType.REFERENCE_COLLECTION||e.type===m.BlockType.REFERENCE_COLLECTION_PAGE:!1,Ib=e=>e?e.type===m.BlockType.REFERENCE_COLLECTION||e.type===m.BlockType.REFERENCE_COLLECTION_PAGE:!1,Nte=e=>e?e.type===m.BlockType.CHART:!1,ir=e=>e===m.BlockType.MIND_MAPPING||e===m.BlockType.MIND_MAPPING_PAGE,jte=e=>e?e.type===m.BlockType.FILE&&e.data.display==="image"&&(e.data.link||e.data.ossName):!1,ks=(e,t={blocks:pe().blocks})=>{var o;const{blocks:n}=t!=null?t:pe(),s=n[e];if(!s)return;let a=n[s.parentId];for(;a&&a.spaceId!==a.uuid&&a.uuid!==a.parentId&&a.uuid!==((o=n[a.parentId])==null?void 0:o.parentId);){if(tn(a.type))return a.uuid;a=n[a.parentId]}},Ste=()=>XF?{x_device_type:"desktop",x_platform:J_?"mac":"windows",platform:J_?"mac":"windows"}:{x_device_type:"web",x_platform:"web",platform:"web"},Dte={},jw=Aa(()=>Dte),Ate=Fd(jw),Rte=Qs(jw),Pte=e=>{Rte(Yn(t=>os(t,{...e,setting:{...e.setting,inlinePageIcon:e.inlinePageIcon}})))};class Lte{constructor(t,n,s){q(this,"windowFunName");q(this,"login",(t,n,s)=>(this.trackEvent("config",{user_unique_id:t,...n},s),this));q(this,"logout",()=>(this.trackEvent("config",{user_unique_id:""},!0),this));q(this,"trackEvent",(t,n,s)=>(["page_enter","page_enter_time","block_fold","node_fold","rtf_choose"].includes(t)||Reflect.get(window,this.windowFunName)(t,n),this));q(this,"addUserAttribute",(t,n)=>(this.trackEvent("profileSet",t,n),this));q(this,"evtParams",{});q(this,"setCommonParams",(t,n)=>(this.evtParams=t,this.trackEvent("config",{...this.evtParams},n),this));q(this,"addCommonParams",(t,n)=>(Object.assign(this.evtParams,t),this.trackEvent("config",{evtParams:{...this.evtParams}},n),this));this.windowFunName=s;const a=document.createElement("script");a.innerHTML="(function(win, export_obj) {\n      win['TeaAnalyticsObject'] = export_obj;\n      if (!win[export_obj]) {\n          function _collect() {\n              _collect.q.push(arguments);\n          }\n          _collect.q = _collect.q || [];\n          win[export_obj] = _collect;\n      }\n      win[export_obj].l = +new Date();\n  })(window, '".concat(this.windowFunName,"');"),document.body.appendChild(a);const o=document.createElement("script");o.src="https://lf3-data.volccdn.com/obj/data-static/log-sdk/collect/5.0/collect-rangers-v5.0.0.js",o.async=!0,document.body.appendChild(o),Reflect.get(window,this.windowFunName)("init",{app_id:t,channel:"cn",log:n}),this.trackEvent("config",{disable_auto_pv:!0}),Reflect.get(window,this.windowFunName)("start")}}class Bte{constructor(t="collect"){q(this,"stayTimeMap",new Map);q(this,"tracker");q(this,"login",(t,n,s)=>(this.tracker.login(t,n,s),this));q(this,"logout",()=>(this.tracker.logout(),this));q(this,"setCommonParams",(t,n)=>(this.tracker.setCommonParams(t,n),this));q(this,"addCommonParams",(t,n)=>(this.tracker.setCommonParams(t,n),this));q(this,"event",(t,n={},s)=>{this.tracker.trackEvent(t,n,s)});q(this,"pageEnter",t=>{this.stayTimeMap.set(t,Date.now())});q(this,"pageLeave",(t,n={},s)=>{const a=this.stayTimeMap.get(t);if(!a)return;const o=(Date.now()-a)/1e3;this.tracker.trackEvent(t,{...n,time:o.toFixed(1)},s)});q(this,"addUserAttribute",(t,n)=>{this.tracker.addUserAttribute(t,n)});this.tracker=new Lte(parseInt("303823",10),!1,t)}}const me=new Bte("webCollectEvent"),Nb=1,jb=2,Sb=2,H9=async(e=Nb|jb|Sb,t,n)=>{var x,F,b;const s=localStorage.getItem(s1);if(!s)return;const a=await ve.infra.getUserRoot.raw(s);if(a.code!==200){n&&be.error(a.msg),a.code===1403&&localStorage.removeItem(s1);return}const o=a.data,{users:i,spaces:l,spaceViews:c}=o;let d;if(c){const w=Object.values(c).filter(E=>!(l&&l[E.spaceId])).map(E=>E.spaceId);if(w.length){const E=await ve.infra.getSpacesPublicData({spaceIds:w});d=E.spaces,qk(d),Pte(E.spaces)}}const u=yt.currentSpaceViewId;let f=t?u:localStorage.getItem(Hk);const h=i==null?void 0:i[s];if(!h)return;const p=c==null?void 0:c[f!=null?f:""];return!!!((l==null?void 0:l[(x=p==null?void 0:p.spaceId)!=null?x:""])||(d==null?void 0:d[(F=p==null?void 0:p.spaceId)!=null?F:""]))&&h.spaceViews.length>0&&(f=(b=(()=>h.spaceViews.find(E=>{var T,v,I,j;const C=l==null?void 0:l[(v=(T=c==null?void 0:c[E])==null?void 0:T.spaceId)!=null?v:""],k=d==null?void 0:d[(j=(I=c==null?void 0:c[E])==null?void 0:I.spaceId)!=null?j:""];return!!(C||k)}))())!=null?b:"",f&&ts(Hk,f)),Ls.unstable_batchedUpdates(()=>{if(l&&J2(e,jb)){qk(l);const w={...Hp(l,E=>({spaceId:E.uuid,type:"SPACE",data:{icon:E.icon},permissions:[],...E}))};re(Tn.update({blocks:w}))}o.spaceViews&&J2(e,Sb)&&Pee(o.spaceViews),J2(e,Nb)&&(vw({currentSpaceViewId:f!=null?f:""}),me.addCommonParams({promotion_channel:h.promotionChannel,...Ste()}))}),o},J2=(e,t)=>(e&t)!==0;function dg(e,t){const n=[];return e.forEach(s=>{n.some(a=>a[t]===s[t])||n.push(s)}),n}const z9=()=>mc(e=>e),Qk=()=>{const e=[];return yt.spaceViews.forEach(t=>{var s,a;const n=Td[(a=(s=Sm[t])==null?void 0:s.spaceId)!=null?a:""];n&&e.push(n)}),dg(e,"uuid")},Y3=()=>{const e=_0(t=>t.spaceViews);return mc(t=>{const n=[];return e.forEach(s=>{var o,i;const a=t[(i=(o=Sm[s])==null?void 0:o.spaceId)!=null?i:""];a&&n.push(a)}),dg(n,"uuid")})},Db=async e=>{const t=await ve.editor.getBlock.raw(e);return t.code===200&&re(Tn.update({blocks:{[e]:t.data}})),t},q9=e=>{ts(Hk,e),vw({currentSpaceViewId:e})},G9=(e,t=!1)=>{const n=Ab(e);n&&q9(n),t&&(st({$sharedPages:[]}),st({$pageRootLoaded:!1}))},Ab=e=>{for(const[t,n]of Object.entries(l0.getState()))if(n.spaceId===e)return t;return""},Ot=()=>{var t,n;const{$currentSpaceId:e}=xt;return(n=(t=W9(yt.currentSpaceViewId))==null?void 0:t.uuid)!=null?n:e},Iu=()=>K9(yt.currentSpaceViewId),W9=e=>{var n,s;const t=(s=(n=Sm[e])==null?void 0:n.spaceId)!=null?s:"";return Rm(t)},Rm=e=>{var t;return(t=Td[e])!=null?t:Ate[e]},K9=e=>Sm[e],m1={uuid:"",setting:{},domain:"",isShowAd:!0,publicHomePage:"",customTemplates:[],title:"",icon:{},backgroundColor:"",subNodes:[],version:0,status:m.BlockStatus.NORMAL},Ote=(e="")=>b9(t=>t[e]),Dt=()=>{const e=Id(),t=on(n=>n.$currentSpaceId);return mc(n=>{var a,o;if(!e&&!t)return m1;const s={...(o=n[(a=e==null?void 0:e.spaceId)!=null?a:t])!=null?o:m1};return s.setting||(s.setting={}),s})},X3=()=>{const e=Id();return mc(t=>{var s,a;let n;return e?n=t[e.spaceId]:n=m1,(a=(s=n==null?void 0:n.setting)==null?void 0:s.daySetting)!=null?a:m.DaySetting.MON})},Y9=()=>_0(e=>e.currentSpaceViewId),Id=()=>{const e=Y9();return Ote(e)},pc=e=>{const t=Dw(e);return mc(n=>{if(e){const s=n[e];if(s)return s;if((t==null?void 0:t.uuid)===e)return t}return m1})},Pn=()=>{var e;return(e=W9(yt.currentSpaceViewId))!=null?e:m1},RAe=()=>{const e=Id();return mc(t=>{var n;if(e)return(n=t[e.spaceId])==null?void 0:n.domain})},Sw=e=>mc(t=>{var s,a;if(!e||Eu())return"";const n=(a=(s=t[e])==null?void 0:s.domain)!=null?a:"";return n?"/".concat(n):""}),Dw=(e="")=>jw(t=>t[e]),X9=()=>{var t;return(t=Dt().setting.inlinePageIcon)!=null?t:m.ShowInLinePageIconType.SHOW_ALL},Nd=()=>y.useCallback(async()=>{const e=await ve.infra.getMyUserInfo.raw();return e.code===200&&vw(e.data),e},[]),PAe=()=>{const e=Nd();return y.useCallback(async(t,n)=>{const s=await ve.infra.createUserSpace(t,n);try{await ve.infra.initSpacePage.raw(s.uuid)}catch(a){zp(a)}return re(y9({space:s})),e(),s.uuid},[e])},Q9=()=>ka(lg.getState()).length===0;function J9(e,t,n,s){const[a,o,i]=am(s),[l,c]=y.useState(n);return y.useEffect(()=>{In(l,n)||c(n)},[n]),y.useEffect(()=>{const d=e.subscribe(u=>{const f=t(u);In(i.current,f)||o(f)});return()=>{d&&!d.closed&&d.unsubscribe()}},l),a}const Jk=new Map,Q3=y.createContext({state:new QF({})}),Aw=()=>y.useContext(Q3).state,Z9=()=>y.useContext(Q3).config,Mte=()=>{const e=Aw();return J9(e,jo,[],[])},m0=e=>{const t=Aw();return J9(t,n=>!!n[e],[e],!1)},LAe=()=>{const e=Aw();return y.useCallback(t=>!!e.getValue()[t],[e])},J3=()=>{const e=Aw();return y.useCallback(t=>{const n=e.getValue(),s=t(n);In(n,s)||e.next(s)},[e])},e5=y.createContext(!1),Ute=()=>y.useContext(e5),ln=()=>{const e=J3(),t=Z9();return y.useCallback((n,s)=>{var l;if(!n)return;const a=c=>{var u,f,h,p;return(f=(u=t==null?void 0:t.getRootDom)==null?void 0:u.call(t))!=null&&f.querySelector?(p=(h=t.getRootDom)==null?void 0:h.call(t))==null?void 0:p.querySelector(c):document.querySelector(c)},o=()=>{var d,u;const c=Jk.get(n);(d=c==null?void 0:c.deref())==null||d.destroy(),Jk.delete(n),e(f=>kn(f,n)),(u=s==null?void 0:s.closeAfterCallBack)==null||u.call(s)},i=(l=s==null?void 0:s.noAnimation)!=null?l:!1;try{const c=a('[data-modal-id="'.concat(n,'"]'));if(c)if(s!=null&&s.ignoreEmitter||xn.emit("closeModal",n),i)o();else{c.className.includes("animate__fadeIn")?c.classList.add("animate__fadeOut"):c.classList.add("dropdown_hidden");const d=a('[data-modal-mask-id="'.concat(n,'"]'));d==null||d.remove(),es(100).then(()=>{o()})}else o()}catch(c){o()}},[t,e])},Vte=e=>{const{popcorn:t,content:n,contentProps:s,placement:a,modalId:o,modifiers:i=[],escCloseBeforeCallBack:l,mask:c=!0,autoClose:d=!0,closeBeforeCallBack:u,closeAfterCallBack:f,offset:h=[0,8],className:p="",keyboard:g=!0,flip:_=!0,id:x="dropDownContent",closeNoAnimate:F=!1,arrow:b,arrowClassName:w,disableEsc:E,animation:C="slideIn",blockMaskClick:k=!0}=e,T=y.useRef(null),v=ja(document.body),I=ja(ZS(t)?t:null),j=ln(),S=y.useRef(null),D=y.useRef(null),A=y.useRef(!1),P=y.useRef({height:0,width:0,x:0,y:0}),L=y.useCallback(M=>{let U=M;if(A.current)return;const z=u==null?void 0:u();if(A.current=!0,z==="prevent"){A.current=!1;return}U={closeAfterCallBack:()=>{var K;f==null||f(),(K=M==null?void 0:M.closeAfterCallBack)==null||K.call(M)},noAnimation:(M==null?void 0:M.noAnimation)||F},o&&j(o,U)},[f,u,j,F,o]);aW(()=>{!c&&d&&L()},T,"pointerdown");const O=y.useCallback(M=>{Ie("esc")(M)&&(M.preventDefault(),M.stopPropagation(),l==null||l(),L())},[L,l]),$=()=>{var M;try{T.current&&((M=S.current)==null||M.update())}catch(U){}};return y.useEffect(()=>{es(500).then($)},[v,I]),y.useEffect(()=>{if(!T.current)return;const M=[{name:"computeStyles",options:{gpuAcceleration:!1}},{name:"offset",options:{offset:h}},{name:"checkHeight",enabled:!0,phase:"afterMain",fn:({state:z})=>{ZS(z.elements.reference)&&(z.rects.reference.x===0&&z.rects.reference.y===0?(z.rects.reference=P.current,z.reset=!0):P.current=z.rects.reference)}}];_?M.push({name:"preventOverflow",options:{tether:!1,altAxis:!0}}):M.push({name:"flip",enabled:!1}),b&&M.push({name:"arrow",options:{element:D.current}}),M.push(...i),S.current=tu(t,T.current,{placement:a||"bottom-end",strategy:"fixed",modifiers:M}),Jk.set(o!=null?o:"",new WeakRef(S.current));const U=Ku.observe(T.current,()=>$());if(g){if(E)return;Ht.addEventListener("keydown",O,dr,!0)}return()=>{var z;if(g){if(E)return;Ht.removeEventListener("keydown",O,!0)}U(),(z=S.current)==null||z.destroy(),L()}},[]),r.jsxs(r.Fragment,{children:[c&&r.jsx("div",{"data-modal-mask-id":o,className:"fixed inset-0",onContextMenuCapture:M=>M.preventDefault(),onPointerDown:M=>{k&&M.preventDefault()},onClick:M=>{M.stopPropagation(),d&&L()}}),r.jsxs("div",{ref:T,id:x,"data-modal-id":o,className:R("-inset-full next-modal-dropdown",C==="slideIn"&&"dropDownContent",C==="fadeIn"&&"animate__animated animate__fadeIn",p),style:C==="fadeIn"?{animationDuration:"0.1s"}:{},onClick:M=>M.stopPropagation(),children:[r.jsx(n,{onCloseModal:L,...s!=null?s:{},popper:S}),b&&r.jsx("div",{id:"arrow",ref:D,className:R("w-5 h-5 top-[-9px] z-1",w),children:r.jsx("div",{id:"arrow-inner"})})]})]})},h0=({children:e,className:t,visible:n=!1,onClose:s,onChange:a,content:o,onClick:i,placement:l="bottom",disable:c=!1})=>{const d=ja(document.body),[u,f]=y.useState(n),{x:h,y:p,reference:g,floating:_,strategy:x,context:F,refs:b,update:w}=oW({open:u,middleware:[iW(),lW({crossAxis:!0})],onOpenChange:f,placement:l}),{getReferenceProps:E,getFloatingProps:C}=cW([dW(F,{toggle:!0})]);return y.useEffect(()=>{u&&b.reference.current&&b.floating.current&&xk(b.reference.current,b.floating.current,w)},[u,w,b.reference,b.floating]),y.useEffect(()=>{setTimeout(()=>{u&&b.reference.current&&b.floating.current&&xk(b.reference.current,b.floating.current,w)},100)},[u,b.floating,b.reference,w,d]),y.useEffect(()=>{f(n)},[n]),y.useEffect(()=>{!u&&(s==null||s())},[s,u]),y.useEffect(()=>{a==null||a(u)},[a,u]),r.jsxs(r.Fragment,{children:[r.jsx("div",{ref:g,...E({ref:g}),className:t,onClick:c?void 0:()=>f(!u),children:e}),u&&!c&&eL.createPortal(r.jsx(tL,{lockScroll:!0,className:"z-[8848] animate__animated animate__fadeIn",style:{animationDuration:"0.1s"},onClick:()=>f(!1),children:r.jsx("div",{ref:_,...C({ref:_,style:{position:x,top:p!=null?p:"",left:h!=null?h:""},onClick:k=>{k.stopPropagation(),i==null||i(k)}}),children:o})}),document.body)]})};const Z3=e=>{const{content:t,modalId:n,className:s,center:a=!0,autoClose:o=!0,keyboard:i=!0,containerClassName:l,closeAfterCallBack:c,closeBeforeCallBackForClickOutSide:d,noAnimation:u=!1,disableDefaultStyle:f}=e,h=Z9(),p=ln(),g=y.useCallback(x=>{n&&p(n,x)},[p,n]),_=y.useCallback(x=>{if(Ie("esc")(x)){if(x.stopPropagation(),x.preventDefault(),!o)return;d==null||d(),g(),c==null||c()}},[o,d,g,c]);return y.useEffect(()=>(i&&Ht.addEventListener("keydown",_,dr,!0),()=>{i&&Ht.removeEventListener("keydown",_,!0)}),[]),r.jsx(tL,{id:"modalContent",className:R("next-modal-modal fixed inset-0 flex justify-center w-screen h-screen mask animate__animated animate__fadeIn bg-black/20 dark:bg-black-base/50",a?"items-center":"items-start pt-[calc(25vh)]",h==null?void 0:h.maskClassName,l),"data-modal-id":n,style:{animationDuration:"0.2s"},onContextMenuCapture:x=>x.preventDefault(),onClick:x=>{x.stopPropagation(),o&&(d==null||d(),g(),c==null||c())},children:r.jsx("div",{className:R(!f&&"next-modal-scroll",!u&&!(h!=null&&h.noAnimation)&&!js&&"enlarge",h==null?void 0:h.modalClassName,s),onClick:x=>x.stopPropagation(),style:{animationDuration:"0.2s"},children:r.jsx(t,{onCloseModal:g})})})},$te=e=>{const{modalId:t,title:n,customIcon:s,className:a,...o}=e;return r.jsx(Z3,{center:!0,autoClose:!1,...o,modalId:t,className:R("flex flex-col items-center justify-center min-w-80 min-h-28 py-6 px-8",a),content:()=>r.jsxs("div",{className:"text-t2 space-y-4 flex flex-col justify-center items-center",children:[s!=null?s:r.jsx($s,{}),r.jsx("span",{className:"text-grey3 whitespace-pre-wrap text-center",children:n})]})})},Hte=e=>{const{title:t,content:n,confirm:s,cancel:a,confirmText:o,cancelText:i,noCancel:l=!1,showConfirm:c=!0,countTime:d,modalId:u,keyboard:f,colorType:h="red",maxWidth:p,minWidth:g=300,footer:_,cancelColorType:x,className:F,closeAfterCallBack:b,...w}=e,[E,C]=y.useState(!!d),k=()=>C(!1),T=y.useMemo(()=>qn(()=>s==null?void 0:s(),100,{leading:!0,trailing:!1}),[s]);return r.jsx(Z3,{...w,closeAfterCallBack:b,keyboard:f,center:!0,modalId:u,className:"bg-white3",content:({onCloseModal:v})=>r.jsxs("div",{className:R("flex flex-col justify-center items-center px-7 py-6 max-w-xs text-center",F),style:{maxWidth:p,minWidth:g},children:[t&&r.jsx("div",{className:"text-t1-medium whitespace-pre-line ".concat(n?"":"mb-8"),children:t}),n&&r.jsx("div",{className:"my-2.5 text-t2 w-full whitespace-pre-line break-words max-h-[50vh] overflow-y-auto",children:n}),(c||!l)&&r.jsxs("div",{className:"flex flex-col w-full space-y-2.5",children:[c&&r.jsx(De,{colorType:h,autoFocus:!0,disable:E,onClick:()=>{E||(T(),v(),b==null||b())},children:E?r.jsx(u3,{time:d,onFinish:k}):o||"确定"}),!l&&r.jsx(De,{colorType:x,onClick:()=>{a==null||a(),v(),b==null||b()},children:i||"取消"})]}),_]})})},ie=()=>{const e=ln(),t=J3(),n=y.useCallback((a,o,i)=>{const l=(a==null?void 0:a.modalId)||qe();return t(c=>{const d=!!c[l],u={...c};if(!d){const f={[l]:{id:l,config:a,element:r.jsx(o,{...a,modalId:l})}};Object.assign(u,f)}if(d&&(i===2||a!=null&&a.forceUpdate)){const f={[l]:{id:l,config:a,element:r.jsx(o,{...a,noAnimation:!0,modalId:l})}};Object.assign(u,f)}return u}),{modalId:l}},[t]);return y.useMemo(()=>({modal:a=>n(a,Z3,0),dropdown:a=>n(a,Vte,1),warning:a=>n(a,Hte,3),loading:a=>n(a,$te,2),closeModal:e}),[e,n])},Oo=e=>{const t=y.useRef(new QF({})).current,n=y.useRef(e.config).current;return r.jsxs(Q3.Provider,{value:{state:t,config:n},children:[r.jsx(zte,{...e}),e.children]})},zte=y.memo(e=>{const{element:t,config:n}=e,s=Mte(),a=ln(),[o,i]=y.useState();return y.useEffect(()=>{var l;t?setTimeout(()=>{const c=t();if(!c){i(document.body);return}i(c)},(l=e.initDelay)!=null?l:0):i(document.body)},[]),y.useEffect(()=>{const l=c=>{s.some(d=>d.id===c)&&a(c,{ignoreEmitter:!0})};return xn.on("closeModal",l),()=>{xn.off("closeModal",l)}},[a,s]),o?Ls.createPortal(r.jsx(r.Fragment,{children:r.jsx(e5.Provider,{value:!0,children:s.map(l=>r.jsx("div",{className:R("fixed z-[8848]",n==null?void 0:n.nodeClassName),children:l.element},l.id))})}),o):null},yn),qte=[St.team,St.pro,St.smallTeam],t5=[St.team,St.smallTeam],Gte=[St.freePersonal,St.pro],h1=e=>!!(e&&t5.includes(e)),eI=e=>!!(e&&Gte.includes(e)),Ur=e=>{const t=Dt(),n=pc(e!=null?e:t.uuid);return n.planType===St.team||n.planType===St.pro||n.planType===St.smallTeam},Wte=e=>{const t=Dt(),n=pc(e!=null?e:t.uuid);return n.planType===St.team||n.planType===St.pro},Rw=e=>{const t=e?Rm(e):Pn();return t===void 0?!1:t.planType===St.team||t.planType===St.pro||t.planType===St.smallTeam},n5=e=>(e?Rm(e):Pn()).planType===St.freePersonal,po=e=>{const t=Dt();return pc(e!=null?e:t.uuid).planType===St.freePersonal},s5=e=>{const t=Dt();e=e!=null?e:t.uuid;const n=po(e),s=pc(e),{isShowAd:a=!0}=s;return n?!0:a},Er=(e,t)=>{if(window.location.pathname!==e){const s=new URLSearchParams(Y1(location.search)).toString(),a=t&&s?"?".concat(s):"";if(gs.check)if(om(e)){const o=new URL(e);window.location.href="".concat(o.pathname).concat(o.search||"")}else window.location.href="".concat(e).concat(a);else window.location.href=om(e)?"".concat(e).concat(a):"".concat(_n()).concat(e)}},tI=e=>{if(gs.check)if(om(e)){const t=new URL(e);window.location.replace("".concat(t.pathname).concat(t.search||""))}else window.location.replace(e);else{const t=om(e)?e:"".concat(_n()).concat(e);window.location.replace(t)}},_n=()=>gs.check?e0:window.location.origin,um=()=>pt()?"share":"preview",R_=()=>ot.ossName&&ot.propertyId,Rb=e=>Q9()?(Er(Nt.create,e),!0):!1,r5=()=>y.useCallback(async e=>{const t=Ab(e);Ls.unstable_batchedUpdates(()=>{var n;Oee(t),q9((n=yt.spaceViews[0])!=null?n:"")}),await ve.infra.deleteSpace(e)},[]),a5=()=>{const e=ie(),t=Ur(),n=r5(),s=Dt(),a=ns();return y.useCallback(()=>{const o=new JL;return t?(e.warning({title:"当前空间还未到期，无法删除",confirmText:"知道了"}),o.reject(new Error("cancel")),o.promise):(e.warning({title:"此操作无法撤销。",content:"删除工作空间，将永久删除其中所包含的所有页面和文件",countTime:10,confirmText:"确认删除",confirm:async()=>{await n(s.uuid),Rb()||a.push(Nt.main),o.resolve()},cancel:()=>{o.reject(new Error("cancel"))}}),o.promise)},[s.uuid,n,a,t,e])},p0=async e=>{await H9(Nb|jb|Sb,e)},g0=()=>y.useCallback((e,t)=>{re(M3({uuid:e,patch:t}))},[]),nI=e=>{var t;return(t=Sm[yt.currentSpaceViewId])==null?void 0:t.favoritePages.includes(e)},sI=e=>{const t=Y9();return b9(n=>{var s;return(s=n[t])==null?void 0:s.favoritePages.includes(e)})},Kte=async()=>{await Fs.clear(),localStorage.clear()},rI=()=>y.useCallback(async()=>{sessionStorage.clear(),await Kte(),await es(500),tm.remove("next_auth"),document.cookie="",Bee()},[]),Yte={blocks:{},collectionViews:{},comments:{},discussions:{},simpleTable:{},ui:{selectedBlocks:[],selectedCells:[]},users:{},cache:{}},o5=qp(()=>Yte),i5=JF({$state:o5,isInit:!1,once:!1}),aI=(e,t)=>{const{equalityFn:n=In}=t||{},s=nL(i5,o=>o.once),a=ss();return s||t!=null&&t.once?(()=>e(a.getState()))():uW(e,n)},Xte=aI;var wt=(e=>(e.MAIN="main",e.PAGE_HISTORY="page_history",e.PAGE_FEEDS="page_feeds",e.TEMPLATE="template",e.SHARE="share",e.NOTIFICATION="notification",e.UPDATE_LOG="update_log",e.FORM_ENG_PAGE="form_end_page",e.PAGE_LITE_PREVIEW="page-lite-preview",e.ONLY_IMAGE="only-image",e.PAGE_CHART="page_chart",e))(wt||{});const Mo=y.createContext(void 0),Un=()=>y.useContext(Mo),l5=()=>{const e=Un();return!!(e&&[wt.PAGE_HISTORY,wt.PAGE_FEEDS,wt.PAGE_CHART].includes(e))},Qte=(e,t)=>{},Jte=!0,Zte=!0,ene=20,tne=30,nne=e=>{const t=ss();return y.useCallback((n,s)=>new Proxy(t.getState()[n],{get(a,o,i){return e!=null&&e.log,s==null||s(o),Reflect.get(a,o,i)}}),[])};function Ce(e,t,n){const s=l5();if(!(n!=null&&n.useRx)&&(s||n!=null&&n.useRedux))return Xte(ee=>(Qte(e,{...n,dep:t}),e(ee)),n);const{obsSelectBlocks:a=[],obsSelectCell:o=[],wait:i,waitMode:l="throttle",obsSimpleTable:c,log:d,equal:u=In,leading:f=Jte,trailing:h=Zte,enable:p=!0,onlyPermissions:g,onlyCut:_,allUser:x,hasSelectBlock:F,allDiscussions:b,enableAuditTime:w=!0,ignoreDeep:E,ignoreOtherData:C=!0,enableProxyState:k=!0}=n||{},T=ss(),v=nne({log:d}),I=y.useRef(new Set),[j,S]=am([...I.current]),D=[p,t,j,a,o,c,i,l],A=y.useRef(!1),P=y.useRef(0),L=y.useRef(),O=y.useRef([]),[$,M]=am(0),U=y.useCallback(()=>{if(A.current)return;if(P.current>2&&!In(O.current,D)){O.current=D;return}const ee=G("patch");u(L.current,ee)||(P.current++,L.current=ee,O.current=D,M(P.current))},[]),z=y.useRef(qn(U,i!=null?i:ene,{leading:f,trailing:h})),K=y.useRef(Ps(U,i!=null?i:tne,{leading:f,trailing:h})),W=y.useMemo(()=>{const ee=te=>{if(!i||l==="none"){z.current.cancel(),K.current.cancel(),U();return}if(!!(Kk(te)||Kee(te))||l==="throttle"){K.current();return}K.current()};return w?qn(ee,0,{leading:!0}):ee},[w,U,i,l]);tc(()=>{A.current||S([...I.current])},[I.current],{wait:2e3});const Y=y.useCallback(ee=>{!I.current.has(ee)&&Wc(ee)&&I.current.add(ee)},[]),G=fW(ee=>{const te=T.getState(),Q=new Proxy(te,{get(ne,se,ce){return typeof se=="string"&&/users|blocks|simpleTable|discussions|comments|collectionViews|ui/.test(se)?v(se,Y):Reflect.get(ne,se,ce)}});return e(k?{...Q,discussions:b?te.discussions:Q.discussions}:te)});return Yv(()=>{A.current=!1;const ee=new Set(j),te=new Map;return p&&(()=>{t.forEach(se=>{ee.has(se)||!Wc(se)||ee.add(se)}),c&&ee.add(H3),a.forEach(se=>{if(se.syncId&&se.blockId&&se.viewId){const ce=Nf(se);ee.add(ce)}else{if(se.blockId){const ce=C9(se.blockId);ee.add(ce)}if(se.viewId){const ce=k9(se.viewId);ee.add(ce)}if(se.syncId){const ce=E9(se.syncId);ee.add(ce)}}if(se.all){const ce=Nf({all:!0});ee.add(ce)}}),o.forEach(se=>{if(se.recordId&&se.viewId&&se.propertyId){const ce=$l(se);ee.add(ce)}else{if(se.recordId){const ce=$l({recordId:se.recordId});ee.add(ce)}if(se.viewId){const ce=$l({viewId:se.viewId});ee.add(ce)}if(se.propertyId){const ce=$l({propertyId:se.propertyId});ee.add(ce)}}if(se.all){const ce=$l({all:!0});ee.add(ce)}}),x&&ee.add(Vc.ALL_USERS),b&&ee.add(Vc.ALL_DISCUSSIONS),F&&ee.add(Vc.HAS_SELECT_BLOCK);const ne=T.getState();ee.forEach(se=>{const ce=ne.collectionViews[se];ce!=null&&ce.parentId&&ee.add(ce.parentId)}),ee.forEach(se=>{if(!se||se==="undefined")return null;if(Wc(se)&&(_?se=N9(se):g?se=T9(se):E?se=v9(se):C&&(se=I9(se))),te.has(se))return;const ce=bs.get(se);ce.subscribe.on(se,W),te.set(se,()=>ce.subscribe.off(se,W))})})(),()=>{A.current=!0,te.forEach(ne=>ne()),K.current.cancel(),z.current.cancel()}},D),mb(()=>{p&&(A.current||(L.current=G("memo")))},D),L.current}function Ut(){return Dm(e=>e)}const _0=Dm;function Pw(){return Dm(e=>e.uuid)}const xa=()=>yt,c5=()=>{const e=Dm(t=>t.uuid);return Ce(t=>t.users[e],[e])},d5=()=>Dm(e=>{const t=e.setting.toolbarShortcut,n=Fk(ka(Gk),ka(t));return os({},t,Ni(Gk,n))}),sne=()=>y.useCallback(()=>{if(yt.uuid){if(!ot.print&&(!yt.nickname||!yt.occupation))return Qr(Nt.login)?!1:(Er(Nt.login),!0);if(Q9())return Qr(Nt.create)?!1:(Er(Nt.create),!0)}else return Qr(Nt.login)?!1:(Er(Nt.login,!0),!0);return ot.from?(tI(ot.from),!0):!1},[]),ug=()=>{const e=rI();return y.useCallback(async()=>{yt.uuid&&ve.infra.logoutUser.raw(yt.uuid),await e(),Er(Nt.login)},[e])},Pm=()=>y.useCallback(async(e,t=!0)=>{vw(e);const n=yt;if(n.uuid&&ts(s1,n.uuid),t){const s=kn(e,["spaceViews"]),a=os(n.setting,s.setting);return await ve.infra.updateUser(n.uuid,{...s,setting:a})}},[]),_r=(e,t=Po)=>{const n=Dt(),s=Ut(),a=Ce(o=>{var i;return s.uuid===e?s.nickname:(i=o.users[e])==null?void 0:i.nickname},[s,e]);return y.useMemo(()=>{var o,i;return(i=((o=n.userRemark)==null?void 0:o[e])||a)!=null?i:t},[t,a,n.userRemark,e])},Rn=(e,t=Po)=>{var s,a,o;return(o=((s=Pn().userRemark)==null?void 0:s[e])||((a=J.users[e])==null?void 0:a.nickname))!=null?o:t},qt=e=>{var t,n;return e==null?"":(n=(t=uD[e])!=null?t:uD[m.BlockType.PAGE])!=null?n:""},oI=(e,t)=>{const n=fe(t);return n||qt(e)},Pb=1,fe=(e=[],t=0,n=!0)=>(e||(e=[]),e.map(s=>{var a,o;if(s.type===m.TextType.LINK_PAGE&&s.uuid){if(t>Pb)return"";const i=J.blocks[s.uuid];if(i){const l=n?"@":"";return"".concat(l).concat(fe(i.data.segments,t+1,n)||qt(i.type))}return""}else if([m.TextType.DATETIME,m.TextType.DATE].includes(s.type)){const i=Yp(s);return"@".concat(i)}else{if(s.type===m.TextType.USER&&s.uuid)return"@".concat(Rn(s.uuid));if(s.type===m.TextType.MENTION_BLOCK&&s.uuid){const i=n?"@":"";if(t>Pb)return"".concat(i,"块引用");const l=J.blocks[s.uuid];if(!l)return"".concat(i,"块引用");if(l.type===m.BlockType.PDF_ANNOTATION)return"".concat(i).concat((o=(a=l.data.pdfAnnotation)==null?void 0:a.text)!=null?o:"");if(s.text)return s.text;const{showPage:c}=wb(l.type);if(!ks(s.uuid))return"".concat(i,"块引用");if(c){const u=J.blocks[s.uuid];if(u)return"".concat(i).concat(fe(u.data.segments,t+1)||qt(u.type))}return"".concat(i).concat(fe(l.data.segments,t+1)||qt(l.type))}}return s.text}).join("")),ht=e=>e==null?[]:[{text:e.toString(),type:m.TextType.TEXT,enhancer:{}}],Ep=e=>!e||!e.segments||e.segments.length===0?!0:!fe(e.segments)&&e.segments.length===0,Zk=e=>{const{name:t,ossName:n,size:s,width:a,height:o}=e;return{uuid:qe(),type:m.TextType.URL,enhancer:{},fileStorageType:"internal",text:t,url:n,size:s,width:a,height:o}};function ft(e="",t,n,s){return Ce(a=>t?t(a.blocks[e]):a.blocks[e],[e,n],s)}JF({});const rne=({uuid:e="",children:t})=>r.jsx(r.Fragment,{children:t}),mt=(e,t)=>ane(e,t),ane=(e,t)=>{const{wait:n,waitMode:s="debounce"}=t!=null?t:{},a=mb(()=>({waitMode:s,equal:(o,i)=>o.cacheVersion&&i.cacheVersion&&o.cacheVersion===i.cacheVersion?!0:In(o,i),wait:n!=null?n:e&&J.blocks[e]?500:100,onlyPermissions:!0}),[e,n,s]);return Ce(o=>mn(e,o),[e],a)},mn=(e="",t=pe())=>{const n=Wi.getShare(e);if(e!=null&&n)return n;const s=BJ({...t,user:yt,permissionGroups:Pn().permissionGroups,segmentsToText:fe,isSharePage:pt(),spaces:Td},e);return s.cacheVersion=qe(),e!=null&&Wi.setShare(e,s),s};function u5(e,t,n){if(!e||!t)return;const s=Ni(e,["uuid","spaceId","parentId","type",...t]);if(n){const a=Ni(e.data,n);return{...s,data:a}}return s}const ye=(e,t=[],n,s)=>ft(e,a=>u5(a,t,n),[e],{ignoreDeep:!(t!=null&&t.length),...s}),x0=({navs:e=[],className:t,placement:n,untitled:s,showTooltip:a=!0,showAll:o})=>{var l,c,d,u;if(e.length===0)return null;if(o)return r.jsx("div",{className:R("flex text-t4 text-grey3",t),children:e.map((f,h)=>r.jsxs(y.Fragment,{children:[h>0&&r.jsx("span",{children:" / "}),r.jsx(qx,{title:fe(f.data.segments),uuid:f.uuid})]},h))});if(e.length<3)return r.jsx("div",{className:R("flex text-t4 text-grey3",t),children:e.map((f,h)=>r.jsxs(y.Fragment,{children:[h>0&&r.jsx("span",{children:" / "}),r.jsx(j_,{children:r.jsx(qx,{title:fe(f.data.segments),uuid:f.uuid})})]},h))});const i=e.slice(1,e.length-1).map(f=>fe(f.data.segments)||qt(f.type)||s).join(" / ");return r.jsxs("div",{className:R("flex text-t4 text-grey3",t),children:[r.jsx(j_,{children:r.jsx(qx,{title:fe((l=ll(e))==null?void 0:l.data.segments),uuid:(c=ll(e))==null?void 0:c.uuid})}),a?r.jsx(Fe,{maxWidth:1e3,className:"flex-shrink-0",popup:i,placement:n,children:r.jsx("span",{children:" / ... / "})}):r.jsx("span",{children:" / ... / "}),r.jsx(j_,{children:r.jsx(qx,{title:fe((d=An(e))==null?void 0:d.data.segments),uuid:(u=An(e))==null?void 0:u.uuid,untitled:s})})]})},qx=({uuid:e="",title:t,untitled:n})=>{const s=ye(e,["data"]),{illegal:a}=mt(e);return r.jsx("div",{children:a?Ts:t||qt(s==null?void 0:s.type)||n})},one=e=>{const t=e.listItem.data;if(!t)return null;const n=t.navs&&t.navs.length>0;return r.jsxs("div",{...e.attribute,onClick:s=>{e.onItemClick&&e.onItemClick(e.listItem,e.index,s)},className:R(Yu,"flex flex-col justify-center rounded cursor-pointer active-bg animate-hover",n?"h-[58px]":"h-10",{"normal-bg":e.selected}),children:[r.jsxs("div",{className:"flex flex-row items-center",children:[r.jsx(V,{name:t.iconName,size:"middle"}),r.jsx("span",{className:"ml-2 text-black text-t2 text-ellipsis",children:t.title})]}),r.jsx("div",{className:"flex flex-col ml-7",children:t.navs&&t.navs.length>0&&r.jsx(x0,{navs:t.navs})})]})},fg=e=>{var o;if(!e)return null;const{type:t,uuid:n,data:s,backgroundColor:a}=e;return{backgroundColor:a,type:t,uuid:n,data:s,title:fe((o=e.data.segments)!=null?o:[])||qt(t),parentId:e.parentId}};var Xe=(e=>(e[e.DELETE=1]="DELETE",e[e.COPY=2]="COPY",e[e.RENAME=3]="RENAME",e[e.MOVETO=4]="MOVETO",e[e.TURN_INTO=5]="TURN_INTO",e[e.CREATE=6]="CREATE",e[e.COLOR=7]="COLOR",e[e.TURN_TO_PAGE=8]="TURN_TO_PAGE",e[e.TURN_TO_EMBED=9]="TURN_TO_EMBED",e[e.TEMPLATE=10]="TEMPLATE",e[e.TABLE_CONVERT=11]="TABLE_CONVERT",e[e.COPY_MOVE=12]="COPY_MOVE",e[e.CUT=13]="CUT",e[e.COPY_CLIPBOARD=14]="COPY_CLIPBOARD",e[e.OPEN_RIGHT_PAGE=15]="OPEN_RIGHT_PAGE",e[e.AI_EDITOR=16]="AI_EDITOR",e[e.OPEN_TAB=17]="OPEN_TAB",e))(Xe||{}),ma=(e=>(e.DATE="date",e.PEOPLE="people",e.LINK_PAGE="link_page",e.EQUATION="equation",e.EMOJI="emoji",e.PAGE="page",e))(ma||{}),Qi=(e=>(e.aiAssistantWithEmptyDoc="AI 辅助",e.aiAssistantWithNotEmptyDoc="AI 辅助",e.basicBlock="基础块",e.media="媒体",e.embed="嵌入内容",e.inlineElement="行内元素",e.layout="布局",e.turninto="转换为",e.action="快捷操作",e.lastUsedColor="上次使用颜色",e.color="文字颜色",e.colorBackground="背景颜色",e.database="多维表",e.advanced="高级块",e))(Qi||{});const f5=Hp(Qi,e=>({pinyin:dd(e),initials:f0(e)})),m5=[{title:"圆点",value:"disc"},{title:"圆圈",value:"circle"},{title:"方块",value:"square"}],h5=[{title:"数字",value:"numbers"},{title:"字母",value:"letters"},{title:"罗马",value:"roman"}],BAe=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.HEADER,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.QUOTE,m.BlockType.MARK,m.BlockType.EQUATION,m.BlockType.PAGE,m.BlockType.CODE],iI=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.HEADER,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.QUOTE,m.BlockType.MARK,m.BlockType.EQUATION,m.BlockType.PAGE,m.BlockType.CODE,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE,m.BlockType.FILE,m.BlockType.FOLDER],lI=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.HEADER,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.QUOTE,m.BlockType.MARK,m.BlockType.EQUATION,m.BlockType.PAGE,m.BlockType.CODE,m.BlockType.MIND_MAPPING,m.BlockType.FOLDER],cI=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.QUOTE,m.BlockType.MARK,m.BlockType.EQUATION,m.BlockType.PAGE,m.BlockType.CODE,m.BlockType.FOLDER],ine=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.HEADER,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.FOLD_LIST,m.BlockType.QUOTE,m.BlockType.MARK],p5="last_selected_code_language",Lm="Plain Text",lne=dc((e,t)=>e,(e,t)=>t,(e,t)=>sc(t,e),{memoizeOptions:{resultEqualityCheck:In}}),Lw=()=>{const e=t=>lne(pe().blocks,t);return y.useCallback(e,[])},eT=e=>{let t=J.blocks[e];const n=[];for(;t;){if(n.push(t),tn(t==null?void 0:t.type)&&t.uuid!==e)return n;t=J.blocks[t.parentId]}return n},sc=(e,t=pe().blocks,n)=>{const s=new Set;let a=t[e];const o=new Set;for(;a&&!o.has(a.uuid);){if(o.add(a.uuid),s.add(a.uuid),n&&a.uuid===n)return s;a=t[a.parentId]}return s},g5=dc((e,t)=>e.blocks,(e,t)=>t,(e,t,n)=>n,(e,t,n)=>{const s=new Set,a=o=>{var i,l,c;n.includes((l=(i=e[o])==null?void 0:i.type)!=null?l:0)||(c=e[o])==null||c.subNodes.forEach(d=>{s.add(d),a(d)})};return a(t),s},{memoizeOptions:{resultEqualityCheck:In}});dc((e,t)=>e.blocks,(e,t)=>t,(e,t,n)=>n,(e,t,n)=>{const s=new Set,a=o=>{var i,l,c;n.includes((l=(i=e[o])==null?void 0:i.type)!=null?l:0)&&((c=e[o])==null||c.subNodes.forEach(d=>{s.add(d),a(d)}))};return a(t),s},{memoizeOptions:{resultEqualityCheck:In}});const _5=()=>{const e=(t,n=[])=>g5(pe(),t,n);return y.useCallback(e,[])};var wi=(e=>(e.SPACE="aside-space",e.FAVORITE="aside-favorite",e.SHARE="aside-share",e.PRIVATE="aside-private",e.BOTTOM="aside-bottom",e))(wi||{}),Of=(e=>(e.MIDDLE="main-panel-middle",e.LEFT="main-panel-left",e.RIGHT="main-panel-right",e.BOTTOM="main-panel-bottom",e))(Of||{}),sl=(e=>(e.MIDDLE="right-panel-middle",e.LEFT="right-panel-left",e.RIGHT="right-panel-right",e.BOTTOM="right-panel-bottom",e))(sl||{}),dI=(e=>(e.ALL="drive-all",e))(dI||{});const gc=Aa(()=>{}),x5=Qs(gc),uI=()=>gc.getState(),Lb=()=>{x5(()=>{})},cne=e=>{x5(()=>e)},y5=()=>gc(e=>!!e),dne=e=>gc(t=>{if((t==null?void 0:t.cursorArea)===dI.ALL)return e===(t==null?void 0:t.dropId)}),OAe=()=>gc(e=>{if(e&&e.cursorArea===wi.BOTTOM)return!0}),une=e=>gc(t=>{if((t==null?void 0:t.dropId)===e)return t.position},In),MAe=()=>gc(e=>e==null?void 0:e.cursorArea,In),Bw=()=>{const e=rg(),t=y5(),n=I3(),s=ng();return y.useMemo(()=>e||t||n||s,[s,t,n,e])},fne="toc-container",vD="aside-private",mne="aside-space",hne="aside-favorite",pne="aside-share",y0="hoverMenu",gne="hoverMenuContainer",UAe="recordHoverMenu",Bm="drive",VAe="TOC_PRIVATE",Bb=e=>{var t;return(t=document.getElementById(e))==null?void 0:t.getBoundingClientRect()},Gx=(e,t)=>{const n=Bb(t);return n&&e>=n.top&&e<=n.bottom},_ne=e=>{var t,n;return e>=0&&e<((n=(t=Bb(fne))==null?void 0:t.right)!=null?n:-1)},xne=e=>e===wi.FAVORITE||e===wi.SPACE||e===wi.SHARE||e===wi.PRIVATE,yne=e=>xne(e)||e===wi.BOTTOM,bne=e=>e===sl.BOTTOM||e===sl.LEFT||e===sl.MIDDLE||e===sl.RIGHT,$Ae=e=>e===Of.LEFT||e===Of.RIGHT||e===sl.LEFT||e===sl.RIGHT,Fne=e=>{var n,s;const t=(s=(n=document.querySelector(".right-panel"))==null?void 0:n.getBoundingClientRect().left)!=null?s:0;return t>0&&e>=t},ID=e=>"".concat(e?"right":"main","-panel"),HAe=(e,t,n)=>{var a,o,i;const s=n?sl.MIDDLE:Of.MIDDLE;if(_ne(e)){const l=Bb(vD);if(l&&t>l.bottom)return wi.BOTTOM;if(Gx(t,hne))return wi.FAVORITE;if(Gx(t,mne))return wi.SPACE;if(Gx(t,pne))return wi.SHARE;if(Gx(t,vD))return wi.PRIVATE}else{if(Bb(Bm))return dI.ALL;const c=document.querySelector(".".concat(ID(n)," .page-footer")),d=c==null?void 0:c.getBoundingClientRect();if(d&&t>d.top)return n?sl.BOTTOM:Of.BOTTOM;const u=(a=document.querySelector(".".concat(ID(n)," .block-content")))==null?void 0:a.firstElementChild,f=(o=u==null?void 0:u.getBoundingClientRect().left)!=null?o:0,h=(i=u==null?void 0:u.getBoundingClientRect().right)!=null?i:0,p=200;if(e<f)return e<f-p?s:n?sl.LEFT:Of.LEFT;if(e>h)return e>h+p?s:n?sl.RIGHT:Of.RIGHT}return s},zAe=e=>{var n;const t=((n=uI())==null?void 0:n.tocInfo)||{};cne(e?{...e,tocInfo:{...t,...e.tocInfo}}:{})},wne=(e,t)=>{var n;return!t||e===t||!!((n=J.blocks[e])!=null&&n.subNodes.some(s=>wne(s,t)))},b5=e=>fI(e,document.body),fI=(e,t)=>{const n={left:0,top:0};for(;e!==t&&e;)n.left+=e.offsetLeft||0,n.top+=e.offsetTop||0,e=e.offsetParent;return n},bn=(e,t)=>t?document.querySelector(".right-panel ".concat(e)):document.querySelector(".main-panel ".concat(e)),b0=(e,t)=>t?document.querySelectorAll(".right-panel ".concat(e)):document.querySelectorAll(".main-panel ".concat(e)),Co=e=>{var t;(t=document.activeElement)==null||t.blur(),e&&(window.getSelection().removeAllRanges(),document.dispatchEvent(new Event("_clearTextSelection")))},F0=e=>{if(!e)return;const t=document.createElement("a");t.setAttribute("target","_blank"),t.setAttribute("href",e),t.click()},Cp=(e=[])=>rn(fe(e)),Ene=(e="")=>Jt.audio.test(e)?"audio":Jt.video.test(e)?"video":Jt.image.test(e)?"image":"file",Cne=(e="",t=4)=>{if(e.length<=t)return[e,""];const n=e.substring(0,e.length-t),s=e.substring(e.length-t);return[n,s]},Ya=(e="")=>{let t="IcBlockFile";if(!e)return"IcBlockFile";if(e=e.toLocaleLowerCase(),Jt.image.test(e))t="list_image";else if(Jt.audio.test(e))t="voice";else if(Jt.video.test(e))t="video";else if(Jt.zip.test(e))t="zip";else if(Jt.ppt.test(e))t="ppt";else if(Jt.txt.test(e))switch(e){case"md":case"html":t=e;break;default:t="txt"}else switch(e){case"pdf":case"ppt":case"apk":case"torrent":t=e;break;case"xls":case"xlsx":t="excel";break;case"doc":case"docx":t="word";break}return t==="IcBlockFile"?"IcBlockFile":"MIc".concat(sL(mW(t)))},mI=(e,t)=>t?"".concat(e,".").concat(t):e!=null?e:"",hI=e=>new Promise((t,n)=>{const s=new Image;s.setAttribute("crossOrigin","anonymous"),s.onload=()=>{t({width:s.width,height:s.height,size:e.size,url:s.src})},s.onerror=()=>{n(new Error("图片解析失败"))},s.src=URL.createObjectURL(e)}),F5=e=>new Promise((t,n)=>{const s=document.createElement("video");s.preload="metadata",s.onloadedmetadata=()=>{window.URL.revokeObjectURL(s.src),t({width:s.videoWidth,height:s.videoHeight,size:e.size,url:s.src})},s.onerror=()=>{n(new Error("视频解析失败"))},s.src=URL.createObjectURL(e)}),kne=e=>e?e.type===m.BlockType.CODE:!1,w0=e=>{if(!e)return!1;switch(e.type){case m.BlockType.DIVIDER:return!1;case m.BlockType.REFERENCE:return!1;case m.BlockType.PAGE:return!1;case m.BlockType.SYNC_REFERENCE:return!1;case m.BlockType.SYNC_CONTAINER:return!1;case m.BlockType.FOLDER:return!1;default:return!0}},ND=(e,t,n=!1)=>{const s={[m.BlockType.PAGE]:t?"IcPageEmpty":"IcPages",[m.BlockType.FOLDER]:t?"IcFolder":"IcFolderContent",[m.BlockType.COLLECTION_VIEW_PAGE]:"IcTable",[m.BlockType.COLLECTION_VIEW]:"IcTable",[m.BlockType.REFERENCE_COLLECTION]:"IcTable",[m.BlockType.REFERENCE_COLLECTION_PAGE]:"IcTable",[m.BlockType.MIND_MAPPING]:"IcMindmap",[m.BlockType.MIND_MAPPING_PAGE]:"IcMindmap",[m.BlockType.TEXTAREA]:"MIcInsertBlockText",[m.BlockType.FILE]:"IcBlockFile"};n&&os(s,{[m.BlockType.PAGE]:t?"MIcPageMaxColor":"MIcPagesMaxColor",[m.BlockType.FOLDER]:t?"MIcFileEmptyMaxColor":"MIcFileFillMaxColor",[m.BlockType.COLLECTION_VIEW_PAGE]:"MIcTableMaxColor",[m.BlockType.COLLECTION_VIEW]:"MIcTableMaxColor",[m.BlockType.REFERENCE_COLLECTION]:"MIcTableMaxColor",[m.BlockType.REFERENCE_COLLECTION_PAGE]:"MIcTableMaxColor",[m.BlockType.MIND_MAPPING]:"MIcMindmapMaxColor",[m.BlockType.MIND_MAPPING_PAGE]:"MIcMindmapMaxColor"});const a=s[e];return a||s[m.BlockType.PAGE]},Om=(e,t=J.blocks)=>{var s;const n=t[e];if(Yl(n)&&n){const a=(s=n.data.ref)==null?void 0:s.uuid;if(a){const o=J.blocks[a];if(o)return o}}},p1=e=>{var c;const{ancestorId:t,findTypes:n,filterTypes:s,filterIds:a}=e,{blocks:o}=pe(),i=[];let l=(c=o[t])==null?void 0:c.subNodes;return a&&l&&(l=l.filter(d=>a.indexOf(d)===-1)),n&&l&&(l=l.filter(d=>{const u=o[d];return u&&n.includes(u.type)})),s&&l&&(l=l.filter(d=>{const u=o[d];return u&&!s.includes(u.type)})),l==null||l.forEach(d=>{const u=fg(o[d]);u&&i.push(u)}),i},Tne=e=>{var t;return localStorage.getItem("viewId:".concat(e.uuid))||((t=e.views)==null?void 0:t[0])},vne=(e,t)=>{const n=new Set;let s=e[t];for(;s;){const a=An(s.subNodes);a?(n.add(a),s=e[a]):s=void 0}return n},Zo=e=>{if(e===St.pro)return"专业版";if(e===St.freePersonal||e===St.freeTeam)return"免费版";if(e===St.smallTeam||e===St.team)return"团队版"},Ine=e=>{var a;const t=(a=J.blocks[e])==null?void 0:a.parentId;if(!t)return;const n=J.blocks[t];if(!n)return;let s;for(const o of n.subNodes){if(o===e)break;s=o}if(s)return J.blocks[s]},Nne=e=>e.filter(t=>!jne(e,t)),jne=(e,t)=>{var s,a,o,i;let n=J.blocks[(a=(s=J.blocks[t.blockId])==null?void 0:s.parentId)!=null?a:""];for(;n&&n.spaceId!==n.parentId;){if(e.findIndex(l=>l.blockId===(n==null?void 0:n.uuid))>-1)return!0;n=J.blocks[n.parentId]}for(const l of e){let c=J.blocks[l.blockId];if((c==null?void 0:c.type)===m.BlockType.REFERENCE_COLLECTION){const d=Tne(c);if(c=J.blocks[(i=(o=c.data.ref)==null?void 0:o.uuid)!=null?i:""],!c)continue;if(g5(J,c.uuid,[]).has(t.blockId)&&d===t.viewId)return!0}}return!1},qAe=e=>{const t=[],n=b0(".block-content [data-block-id]:not(#".concat(y0,")"),e),{blocks:s}=J;for(const a of n){const{blockId:o,viewId:i,syncId:l}=a.dataset;if(!o)return;const c=s[o];!c||!s[c.parentId]||t.push({blockId:o,viewId:i,syncId:l})}return t},Nu=e=>{var a;const t=[],n=b0(".block-content [data-block-id] [data-editor]",e),{blocks:s}=J;for(const o of n){const i=o.closest("[data-block-id]");if(!i)continue;const{editor:l}=o.dataset,{blockId:c,viewId:d,syncId:u}=i.dataset;if(!c||tn((a=J.blocks[c])==null?void 0:a.type))continue;const f=s[c];!f||!s[f.parentId]||t.push({blockId:c,viewId:d,syncId:u,editorKey:l})}return t},Sne=(e,t)=>{var a;let n;e===m.BlockType.ORDER_LIST?n=h5.map(o=>o.value):n=m5.map(o=>o.value);const s=(n.indexOf(t)+1)%n.length;return(a=n[s])!=null?a:"numbers"},Dne=(e,t,n)=>{const s=t[e];if(!s)return;const a=t[s.parentId];if(!a)return;let o=a.subNodes.indexOf(e);if(o<=0)return{firstBlock:s,firstBlockIndex:0};let i;for(;o>0;){o--;const l=a.subNodes[o];if(!l)break;const c=t[l];if(c){if(c.type!==n)break;i=c}}if(i)return{firstBlock:i,firstBlockIndex:a.subNodes.indexOf(i.uuid)}},Ane=(e,t,n)=>{var l,c;const s=t[e];if(!s)return;const a=t[s.parentId];if(!a)return;let o=a.subNodes.indexOf(e);if(o<=0)return{firstBlock:s,firstBlockIndex:0};let i;for(;o>0;){o--;const d=a.subNodes[o];if(!d)break;const u=t[d];if(u){if(u.type!==n)break;if(n===m.BlockType.ORDER_LIST&&((l=u.data.format)!=null&&l.orderListFormat)){i=u;break}else if(n===m.BlockType.LIST&&((c=u.data.format)!=null&&c.listFormat)){i=u;break}}}if(i)return{firstBlock:i,firstBlockIndex:a.subNodes.indexOf(i.uuid)}},E0=(e,t,n)=>{var f,h,p,g,_,x;const s=t[e];if(!s)return;let a=((f=s.data.format)==null?void 0:f.listStartIndex)||1;const o=n===m.BlockType.ORDER_LIST?(h=s.data.format)==null?void 0:h.orderListFormat:(p=s.data.format)==null?void 0:p.listFormat,i=n===m.BlockType.ORDER_LIST?"numbers":"disc",l=t[s.parentId];if(!l)return;const c=Dne(e,t,n),d=Ane(e,t,n);if(c){const{firstBlock:F,firstBlockIndex:b}=c;a=l.subNodes.indexOf(e)-b+1,(g=F.data.format)!=null&&g.listStartIndex&&(a=a+F.data.format.listStartIndex-1)}if(o)return{format:o,listNo:a,defaultFormat:i};let u;if(n===m.BlockType.ORDER_LIST?u=(_=d==null?void 0:d.firstBlock.data.format)==null?void 0:_.orderListFormat:u=(x=d==null?void 0:d.firstBlock.data.format)==null?void 0:x.listFormat,u)return{format:u,listNo:a,defaultFormat:i};if(l.type===n){const F=E0(s.parentId,t,n);if(F)return F.format?{format:F.format,listNo:a,defaultFormat:i}:{format:o,listNo:a,defaultFormat:Sne(n,F.defaultFormat)}}return{format:o,listNo:a,defaultFormat:i}},Rne=(e,t,n=pe().blocks)=>{let s=n[e];if(!s)return;s=n[s.parentId];let a;for(;s;){if(t.includes(s.type)){a=s;break}s=n[s.parentId]}return a},Pne=(e,t,n=pe().blocks)=>!!Rne(e,t,n),w5=(e,t=pe().blocks)=>{const n=t[e];if(!n)return;const s=t[n.parentId];if(!s)return;const a=s.subNodes.indexOf(e);if(!(a<=0))return s.subNodes[a-1]},GAe=(e,t=pe().blocks)=>{const n=t[e];if(!n)return;const s=t[n.parentId];if(!s)return;const a=s.subNodes.indexOf(e);return s.subNodes[a+1]},Lne=e=>{re(at.update({selectedBlocks:[{blockId:e}]})),document.execCommand("copy")},jD=(e,t)=>{const n=[];return e.forEach(o=>{var i;if(((i=J.blocks[o.blockId])==null?void 0:i.type)===m.BlockType.SYNC_CONTAINER||t){const l=document.querySelector('[data-block-id="'.concat(o.blockId,'"]'));l instanceof HTMLElement&&l.dataset.syncCount&&n.push(parseFloat(l.dataset.syncCount))}}),n.length===0||!n.some(o=>o>0)?void 0:{onlyOne:n.reduce((o,i)=>o+i,0)===1}},E5=e=>{const t=J.blocks[e];return t?t.type===m.BlockType.SYNC_CONTAINER||t.type===m.BlockType.SYNC_REFERENCE?!0:tn(t.type)?!1:t.subNodes.some(n=>E5(n)):!1},Bne=e=>e===m.BlockType.SYNC_CONTAINER||e===m.BlockType.SYNC_REFERENCE,One=e=>{const t=e.slice(1);if(!Wc(t))return;const n=J.blocks[t];if(n&&!tn(n.type))return t},Ob=e=>{if(!e)return 0;const t=n=>{switch(n.type){case m.TextType.DATE:case m.TextType.DATETIME:return 0;default:return fe([n]).length}};return e.reduce((n,s)=>n+t(s),0)},Mne=(e,t=J.blocks)=>{const n=t[e];if((n==null?void 0:n.type)!==m.BlockType.TABLE)return 0;const s=a=>{var l,c;const o=t[a];return(o==null?void 0:o.type)!==m.BlockType.TABLE_ROW?0:((c=(l=n.data.format)==null?void 0:l.tableBlockColumnOrder)!=null?c:[]).reduce((d,u)=>{var h;const f=(h=o.data.collectionProperties)==null?void 0:h[u];return d+Ob(f)},0)};return n.subNodes.reduce((a,o)=>a+s(o),0)},tT=(e,t=J.blocks,n={})=>{var o,i;const s={word:0,blocksNum:0};if(!e)return s;const a=t[e];if(!a||n[e])return s;if(s.blocksNum+=1,tn(a.type))return s.word=fe(a.data.segments).length+fe(a.data.description).length,s;if(n[e]=!0,Nw(a.type)&&(s.word+=Ob(a.data.segments)),wp(a)&&(s.word+=Ob(a.data.caption)),a.subNodes.length>0&&a.subNodes.forEach(l=>{const c=tT(l,t,n);s.blocksNum+=c.blocksNum,s.word+=c.word}),s.word>1e5)return s;if(Yl(a)||a.type===m.BlockType.SYNC_REFERENCE){const l=tT((i=(o=a.data.ref)==null?void 0:o.uuid)!=null?i:"",t,n);s.word+=l.word,s.blocksNum+=l.blocksNum}return a.type===m.BlockType.TABLE&&(s.word+=Mne(a.uuid)),s},pI=(e,t,n,s=pe().blocks)=>{const a=[],o=s[e];return(o==null?void 0:o.type)!==void 0&&t.includes(o==null?void 0:o.type)&&(!n||n!=null&&n(o))&&a.push(e),o==null||o.subNodes.forEach(i=>{var l;if(!tn((l=s[i])==null?void 0:l.type)){const c=pI(i,t,n);a.push(...c)}}),a},WAe=e=>{let t=e;for(;t;){const n=J.blocks[t];if(!n)return;const{type:s}=n;if(s===m.BlockType.SYNC_CONTAINER||s===m.BlockType.SYNC_REFERENCE)return!0;t=n.parentId}return!1},Xu=(e,t)=>{const{blocks:n}=pe();return[...sc(e,n,t)].some(o=>{var i;return((i=n[o])==null?void 0:i.type)===m.BlockType.COLUMN_LIST})},Une=e=>e.filter(n=>{var c,d,u,f;const s=J.blocks[n.blockId],a=(s==null?void 0:s.type)===m.BlockType.REFERENCE&&s.data.display==="image",o=(s==null?void 0:s.type)===m.BlockType.EXTERNAL_FILE&&s.data.display==="image",i=a||o||(s==null?void 0:s.type)===m.BlockType.FILE&&s.data.display==="image";return(s==null?void 0:s.type)===m.BlockType.CHART&&((u=(d=(c=s.data.format)==null?void 0:c.chartFormat)==null?void 0:d.ref)==null?void 0:u.uuid)||i||[m.BlockType.TEXTAREA,m.BlockType.HEADER].includes((f=s==null?void 0:s.type)!=null?f:0)}).map(n=>n.blockId),mg=()=>localStorage.getItem(p5),Vne=e=>{switch(e){case m.BlockType.TODO:case m.BlockType.MARK:case m.BlockType.HEADER:case m.BlockType.TEXTAREA:case m.BlockType.LIST:case m.BlockType.ORDER_LIST:case m.BlockType.FOLD_LIST:case m.BlockType.QUOTE:return!0}return!1},gI=(e,t=pe().blocks)=>{var s;const n=t[e];if(n){if(Vne(n.type)&&fe(n.data.segments).trim())return e;for(const a of n.subNodes){if(tn((s=t[a])==null?void 0:s.type))continue;const o=gI(a);if(o)return o}}},nT=e=>{const t=s=>{const a=J.blocks[s];if(!a||!tn(a==null?void 0:a.type))return;const o=a==null?void 0:a.permissions.filter(l=>l.type===m.PermissionType.PUBLIC);return(o==null?void 0:o.some(l=>l.allowSubscribe))?s:t(a.parentId)};return t(e)},C5=e=>{var a;const t=J.blocks[e];return!(!t||!t.subNodes.every(o=>!!J.blocks[o])||!((a=t.views)==null?void 0:a.every(o=>J.collectionViews[o])))},hn=(e,t)=>{let n;return Ls.unstable_batchedUpdates(()=>{const{state:s,noThrottle:a}=t||{};re(O3({state:s})),n=e(),re(kb()),re(a?Sa():a0())}),n},Oe=()=>y.useCallback(hn,[]),_I=()=>{const e=(t,n=!1,s)=>{let a;return Ls.unstable_batchedUpdates(async()=>{re(O3({state:s}));const o=setTimeout(()=>{re(kb())},20*1e3);a=await t(),clearTimeout(o),re(kb()),re(n?Sa():a0())}),a};return y.useCallback(e,[])},fu=()=>({updatedBy:yt.uuid,updatedAt:Date.now()}),C0=(e,t=!1,n)=>{var u;const s=n?n.getState.bind(n):pe,a=n?n.dispatch.bind(n):re,{blocks:o}=s(),i=o[e];if(!i)return;const c=ks(i.uuid),d=ga((u=o[c!=null?c:""])==null?void 0:u.type);if(!tn(i.type)||d){const f=o[c!=null?c:""];f&&mn(f.uuid).role!==m.PermissionRole.READER&&a(Sn({uuid:f.uuid,patch:fu(),ignoreOp:t}))}a(Sn({uuid:e,patch:fu(),ignoreOp:t}))},ju=(e,t)=>{C0(e),re(Cw({uuid:e,permission:t}))},dl=(e,t)=>{C0(e),re(Ew({uuid:e,permission:t}))},mu=(e,t)=>{OJ(e,t,{removeBlockPermission:ju,setBlockPermission:dl})},Dy=(e,t)=>e.type===m.PermissionType.SPACE&&e.type===t.type||e.type===m.PermissionType.GROUP&&e.groupId===t.groupId||e.type===m.PermissionType.USER&&e.userId===t.userId,Ow=e=>{const t=ye(e,["data"],["segments"]),n=Sw(t==null?void 0:t.spaceId),s=Ut();return y.useCallback(a=>{const{embed:o,inviteCode:i=s.inviteCode,password:l}=a!=null?a:{},c=new URL("".concat(_n()).concat(n,"/share/").concat(e)),d="\n".concat(gp).concat(fe(t==null?void 0:t.data.segments));o&&c.searchParams.set(dn.embed,"true"),i&&c.searchParams.set(dn.inviteCode,i),l&&c.searchParams.set(dn.password,l);const u=c.href;return{url:u,text:d,textAndUrl:"".concat(u).concat(d)}},[t==null?void 0:t.data.segments,s.inviteCode,n,e])},k5=e=>e.filter(t=>t.type===m.PermissionType.SPACE||t.type===m.PermissionType.USER||t.type===m.PermissionType.GROUP),xI=e=>({spacePermission:e.find(t=>t.type===m.PermissionType.SPACE),groupPermissions:e.filter(t=>t.type===m.PermissionType.GROUP),userPermissions:e.filter(t=>t.type===m.PermissionType.USER)}),T5=e=>{var a;const t=ye(e,["permissions"]),n=!!t,{permissions:s}=mt((a=t==null?void 0:t.parentId)!=null?a:"");return y.useCallback(()=>{var i;if(!n)return;k5((i=t==null?void 0:t.permissions)!=null?i:[]).filter(l=>s.some(c=>!!(Dy(l,c)&&c.role&&l.role&&nu[l.role]<nu[c.role]))).forEach(l=>mu(e,{...l,role:m.PermissionRole.NONE})),ju(e,{type:m.PermissionType.RESTRICTED}),ju(e,{type:m.PermissionType.PUBLIC})},[t==null?void 0:t.permissions,n,s,e])},k0=e=>{var a;const t=ye(e,[]),{role:n}=mt((a=t==null?void 0:t.parentId)!=null?a:""),s=ai();return t?t.parentId===t.spaceId?!s:n===m.PermissionRole.EDITOR||n===m.PermissionRole.WRITER:!1},Mw=e=>{const{role:t,isRestricted:n}=mt(e),s=k0(e),a=ft(e,i=>{var l;return(l=i==null?void 0:i.isTemplate)!=null?l:!1}),o=n?t===m.PermissionRole.WRITER||t===m.PermissionRole.EDITOR:t===m.PermissionRole.EDITOR;return s&&o&&!a},ai=()=>{const e=Dt();return Uw(e)},Uw=(e=Pn())=>!(e!=null&&e.permissions),hg=e=>{const t=z9(),n=Dt(),s=y.useMemo(()=>e&&t[e]?t[e]:n,[n,e,t]);return y.useCallback(a=>{var i;const o=(i=s==null?void 0:s.permissions)==null?void 0:i.find(l=>l.userId===a);return{reader:(o==null?void 0:o.role)==="reader",writer:(o==null?void 0:o.role)==="writer",editor:(o==null?void 0:o.role)==="editor"}},[s==null?void 0:s.permissions])},pg=e=>{var s;const n=(s=Pn().permissions)==null?void 0:s.find(a=>a.userId===e);return{reader:(n==null?void 0:n.role)==="reader",writer:(n==null?void 0:n.role)==="writer",editor:(n==null?void 0:n.role)==="editor"}},yI=Aa(()=>({})),$ne=Qs(yI),P_=(e,t)=>{$ne(Yn(n=>{n[e]||(n[e]={spacePlans:[]}),n[e]=os(n[e],t)}))},Qu=()=>v5(),v5=e=>{const t=Dt(),n=e!=null?e:t.uuid;return yI(()=>I5(n),In)},I5=(e=Ot())=>{const t=yI.getState()[e];return Hne(e,t)},Hne=(e,t)=>{var a;const n=Rm(e),s=(a=t==null?void 0:t.spacePlans)==null?void 0:a.find(o=>o.planType===n.planType);return{...t,currentSpacePlanConfig:s}},zne=async e=>{const t=await ve.infra.getSpacePlans(),n=await ve.infra.getCurrentPlan.raw(e),s=await ve.infra.getUserPlanConfig(xa().uuid),a=t.map(o=>{const i=s[o.planType];return i&&Object.assign(o,i),o});return P_(e,{spacePlans:a,currentPlan:n.code===200?n.data:void 0}),a},sT=async e=>{const t=Pn();if(Uw(t))return;const s=await ve.infra.getSpacePlan(e!=null?e:t.uuid);return P_(e!=null?e:t.uuid,{spacePlan:s}),s},SD=async e=>{const t=Pn(),n=xa(),s=pg(n.uuid).editor;if(e){P_(t.uuid,{spaceShareInfo:{inviterId:e.inviterId,createdAt:e.createdAt,expirationAt:e.expirationAt}});return}if(s){const a=await ve.infra.getSpaceInvitation(t.uuid);P_(t.uuid,{spaceShareInfo:{inviterId:a.uuid,createdAt:a.createdAt,expirationAt:a.expirationAt}})}else P_(t.uuid,{spaceShareInfo:{inviterId:"",createdAt:0,expirationAt:0}})},qne=e=>on(t=>{var n,s;return(s=(n=t.$subscriptionData[e])==null?void 0:n.users)!=null?s:[]}),Gne=({spaceId:e,data:t})=>{st({$subscriptionData:{...xt.$subscriptionData,[e]:t}})},Wne=e=>on(t=>t.$subscriptionData[e]),bI=async(e=Ot())=>{const t=await ve.infra.getSpaceSubscriptionData(e);return Gne({spaceId:e,data:t}),t},_c=(e=Ot())=>{const t=Wne(e),n=v5(e),s=kd();return y.useMemo(()=>T0(e,{subscriptionData:t,spacePlanInfo:n,guests:s}),[e,n,t,s])},Wx={maxBlockLimit:-1,blockUsage:0,mindMapMaxLimit:-1,guestMaxLimit:-1},Z2=e=>e===-1?1/0:e,T0=(e=Ot(),t)=>{var p,g,_,x,F,b,w;const{subscriptionData:n=xt.$subscriptionData[e],spacePlanInfo:s=I5(e)}=t||{},a=s.currentPlan||s.currentSpacePlanConfig,o=Z2((p=a==null?void 0:a.block.max)!=null?p:Wx.maxBlockLimit),i=(g=n==null?void 0:n.blockUsage)!=null?g:Wx.blockUsage,l=Z2((_=a==null?void 0:a.mapNodes.max)!=null?_:Wx.mindMapMaxLimit),c=Z2((F=(x=a==null?void 0:a.guest)==null?void 0:x.max)!=null?F:Wx.guestMaxLimit),d=(a==null?void 0:a.members.max)||BY,u=c===1/0?"无限":c,f=d===999?"无限":d,h=((w=(b=t==null?void 0:t.guests)==null?void 0:b.length)!=null?w:0)>=c;return{guestMaxLimitDesc:u,blocksMaxLimit:o,blocksUsage:i,blocksStock:Math.max(o-i,0),blocksIsMax:i>=o,mindMapMaxLimit:l,guestMaxLimit:c,membersMaxLimit:d,isMaxGuests:h,memberMaxLimitDesc:f}},Ju=(e=Ot())=>{const t=e===Ot();if(T0(e).blocksIsMax)throw t?xn.emit("modalId",{modalId:Ve.MAXIMUM_CAPACITY_DIALOG,spaceId:e}):be.error("目标空间容量已达到上限"),new Error("blocks 数量达到最高限制")},KAe={[m.BlockType.PAGE]:"创建子页面",[m.BlockType.FOLDER]:"创建子文件夹",[m.BlockType.COLLECTION_VIEW_PAGE]:"创建记录"};var Ss=(e=>(e[e.PRIVATE=0]="PRIVATE",e[e.SPACE=1]="SPACE",e[e.SHARE=2]="SHARE",e[e.FAVORITE=3]="FAVORITE",e[e.RECOMMEND=4]="RECOMMEND",e))(Ss||{});const Kne={0:"private",1:"space",2:"share",3:"favorite",4:"recommend"},Yne="toc_group_hidden";var Mb=(e=>(e.FIXED="fixed",e.AUTO="auto",e))(Mb||{});const FI=()=>{var e;return(((e=yt.setting)==null?void 0:e.pageWidthMode)||"fixed")==="fixed"},jd=()=>{const e=Oe(),t=Ut(),n=(s,a,o,i)=>{Ju();const{blocks:l}=pe(),c=l[a.parentId];if(!c)return;const d=(c.type==="space"?c.uuid:c.spaceId)||Pn().uuid,u=qe(),f=[];return o===Ss.PRIVATE&&f.push({role:m.PermissionRole.EDITOR,type:m.PermissionType.USER,userId:t.uuid}),o===Ss.SPACE&&f.push({role:m.PermissionRole.EDITOR,type:m.PermissionType.SPACE}),e(()=>{var p,g,_,x,F;const h=Date.now();re($a({block:{uuid:u,spaceId:d,parentId:a.parentId,textColor:"",backgroundColor:"",type:s,version:0,status:m.BlockStatus.NORMAL,local:!0,data:{segments:i!=null?i:[],pageFixedWidth:FI(),directoryMenu:(p=yt.setting)==null?void 0:p.directoryMenu,format:{pageLayout:(g=Iu())==null?void 0:g.setting.pageLayout,fontFormat:(_=Iu())==null?void 0:_.setting.fontFormat,commentAlignment:(F=(x=Pn().setting)==null?void 0:x.commentAlignment)!=null?F:"top"}},subNodes:[],permissions:f,updatedBy:yt.uuid,createdAt:h,updatedAt:h}})),a.first||a.before?re(cl({uuid:u,parentId:a.parentId,before:a.before,ignoreUpdateTime:!0})):re(ws({uuid:u,parentId:a.parentId,after:a.after,ignoreUpdateTime:!0}))},{noThrottle:!0}),u};return y.useCallback(n,[t.uuid,e])},fm=(e,t)=>{const{blocks:n}=pe(),s=n[e];if(!s)return;const a=n[t];if(!a||a.type!==m.BlockType.COLUMN)return;const o=Ot();if([s.uuid,a.parentId].includes(o))return;const i=n[a.parentId];if(!i)return;const l=[],c=i.subNodes.filter(d=>{const u=n[d];return(u==null?void 0:u.subNodes.length)===0?(l.push({uuid:d,type:"remove"}),!1):!0});if(c.length===1){const[d]=c;if(!d)return;const u=n[d];u==null||u.subNodes.forEach(f=>{var g;const h=u.subNodes.indexOf(f),p=(g=u.subNodes[h-1])!=null?g:i.uuid;l.push({type:"move",uuid:f,target:i.parentId,after:p})}),l.push({type:"remove",uuid:i.uuid}),l.push({type:"remove",uuid:d})}l.forEach(d=>{re(Tr({uuid:d.uuid})),d.type==="remove"&&re(Sn({uuid:d.uuid,patch:{status:-1}})),d.type==="move"&&re(ws({uuid:d.uuid,parentId:d.target,after:d.after}))})},wI=(e,t)=>{const{ui:n}=pe(),{selectedBlocks:s}=n;t&&s.findIndex(a=>a.blockId===t)===-1?_e(t,e):s.forEach(a=>_e(a.blockId,e))},_e=(e,t,n=!1,s)=>{const a=s?s.getState.bind(s):pe,o=s?s.dispatch.bind(s):re,{blocks:i}=a();i[e]&&(o(Sn({uuid:e,patch:t,ignoreOp:n})),n||C0(e,n,s))},EI=(e,t,n)=>{re(Sn({uuid:e,patch:{data:{schema:t}},path:["data","schema"],ignoreOp:n==null?void 0:n.ignoreOp})),n!=null&&n.ignoreOp||C0(e)},N5=(e,t,n=!1)=>{e===t.parentId||!t.parentId||(t.first||t.before?re(yp({uuid:e,parentId:t.parentId,before:t.before,ignoreOp:n})):re(bp({uuid:e,parentId:t.parentId,after:t.after,ignoreOp:n})))},L_=(e,t,n=!1)=>{e===t.parentId||!t.parentId||re(dm({parentId:t.parentId,uuid:e,ignoreOp:n}))},Xne={},CI=Aa(()=>Xne),YAe=Fd(CI),Qne=Qs(CI),Zd=e=>{Qne(Yn(t=>os(t,e)))},Jne=()=>{const e=Oe(),t=Dt(),n=async s=>{const{blocks:a}=pe(),o=Array.isArray(s)?s:[s],[i]=o;if(!i)return;const l={};Ls.unstable_batchedUpdates(()=>{e(()=>{o.forEach(c=>{l[c]={tag:"NOT_FOUND"};const d=f=>{var p;const h=a[f];_e(f,{status:m.BlockStatus.DELETED_COMPLETE},!0),h&&tn(h.type)&&Zd({[f]:{tag:"NOT_FOUND"}}),nI(f)&&e(()=>{L_(f,{parentId:yt.currentSpaceViewId})}),(p=a[f])==null||p.subNodes.forEach(d)};d(c);const u=a[c];u&&fm(u.uuid,u.parentId)},{noThrottle:!0})})}),await ve.infra.clearTrash(t.uuid,{blockIds:o}),Zd(l)};return y.useCallback(n,[t.uuid,e])},Zne=()=>y.useCallback(e=>{const{blocks:t}=pe();if(!t[e])return;const s=a=>{var o;re(r0({uuid:a})),(o=t[a])==null||o.subNodes.forEach(s)};s(e)},[]),kI=Aa(()=>({})),ese=Qs(kI),tse=Fd(kI),XAe=()=>kI(e=>e),nse=e=>{ese(Yn(t=>os(t,{[e]:!0})))},j5=()=>{const e=$1(),t=ss();return y.useCallback(async function n(s,a){const o=await ve.editor.getDoc.raw(s);if(o.code===200){const{blocks:i,collectionViews:l,discussions:c,comments:d}=o.data;l&&e(kl.update(l)),c&&e(Oh.update(c)),d&&e(z3.update(d)),e(Tn.update({blocks:i,force:a==null?void 0:a.force})),jo(i).forEach(u=>{var f,h;tn(u.type)&&(f=u.data.ref)!=null&&f.uuid&&!t.getState().blocks[u.data.ref.uuid]&&n((h=u.data.ref)==null?void 0:h.uuid)})}return o},[e,t])},sse=[m.BlockType.TEXTAREA,m.BlockType.HEADER,m.BlockType.TODO,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.MARK,m.BlockType.QUOTE,m.BlockType.IMAGE,m.BlockType.FILE,m.BlockType.PAGE,m.BlockType.REFERENCE,m.BlockType.COLUMN_LIST,m.BlockType.COLUMN,m.BlockType.SYNC_CONTAINER,m.BlockType.SYNC_REFERENCE,m.BlockType.EXTERNAL_FILE],S5=new Map,rse=(e,t)=>{S5.set(e,t)},ase=e=>S5.get(e),Ay=(e,t,n=pe().blocks)=>{var a,o,i,l,c;const s=new Set(sse);for(const d of e){if(t.imageBlockId)return;const u=n[d];if(!u)continue;const f=u.type;if(s.has(f))switch(f){case m.BlockType.TODO:case m.BlockType.MARK:case m.BlockType.HEADER:case m.BlockType.TEXTAREA:case m.BlockType.LIST:case m.BlockType.ORDER_LIST:case m.BlockType.FOLD_LIST:case m.BlockType.TOGGLE_HEADER:case m.BlockType.QUOTE:{fe(u.data.segments).trim()&&(t.ids.push(d),f!==m.BlockType.FOLD_LIST&&f!==m.BlockType.TOGGLE_HEADER&&Ay((a=u.subNodes)!=null?a:[],t,n));break}case m.BlockType.COLUMN_LIST:case m.BlockType.SYNC_CONTAINER:case m.BlockType.COLUMN:{Ay((o=u.subNodes)!=null?o:[],t,n);break}case m.BlockType.SYNC_REFERENCE:{const h=n[(l=(i=u.data.ref)==null?void 0:i.uuid)!=null?l:""];h&&Ay((c=h.subNodes)!=null?c:[],t,n);break}case m.BlockType.EXTERNAL_FILE:{u.data.link&&(t.imageBlockId=d);break}case m.BlockType.FILE:{const{extName:h}=rn(fe(u.data.segments));(u.data.ossName||u.data.localUrl)&&Jt.image.test(h)&&(t.imageBlockId=d);break}case m.BlockType.PAGE:case m.BlockType.REFERENCE_COLLECTION_PAGE:{t.ids.push(d);break}case m.BlockType.REFERENCE:{u.data.display==="linkPage"&&t.ids.push(d);break}}}t.ids=t.ids.slice(0,6)},ose=e=>Ce(({blocks:n})=>{var i;const s=n[e],a=(i=s==null?void 0:s.subNodes)!=null?i:[],o={ids:[],imageBlockId:void 0};return Ay(a,o,n),o},[e]),ise=async(e,t)=>{var c,d,u,f;const n=(u=(d=t.blocks[(c=e[0])!=null?c:""])==null?void 0:d.spaceId)!=null?u:"",s=await ve.editor.docsPreviewBatch({spaceId:n,blockIds:e}),{blocks:a={},collectionViews:o}=s,i=a[n];i&&(i.type="SPACE");const l=(f=s.blockToImage)!=null?f:{};return Object.keys(l).forEach(h=>{const p=l[h];p&&rse(h,p)}),re(Tn.update({blocks:s.imageBlocks})),re(Tn.update({blocks:a})),o&&re(kl.update(o)),{...s,blocks:a}},TI=async(e,t,n)=>{t=t!=null?t:"";const s=await ve.editor.docsSharePagePreview({spaceId:t,blockId:e,previewCount:n}),{blocks:a={},collectionViews:o}=s,i=a[t];return i&&(i.type="SPACE"),re(Tn.update({blocks:a})),o&&re(kl.update(o)),{...s,blocks:a}},lse=y.createContext(""),cse=()=>y.useContext(lse),n_={},Ja=e=>{const t=Zne(),n=$1(),s=j5(),a=cse(),o=(i,l)=>{var f,h;let c=n_[i];const d=(f=l==null?void 0:l.force)!=null?f:!1,u=(h=l==null?void 0:l.prefetch)!=null?h:!1;return c||(c=mo(async()=>{var g;pt()&&i===location.pathname.slice(1)&&n(Tn.clear()),st({$fileIllegal:!1});const p=await s(i,{force:d});if(p.code!==200&&a){await TI(i,a);return}if(u||(n_[i]=void 0),[1407].includes(p.code)){const _=await DD(i);Zd({[i]:{..._,tag:"NEED_PAY"}})}else[1406,1405].includes(p.code)?Zd({[i]:{tag:"NEED_PASSWORD"}}):p.code===1403?(t(i),Zd({[i]:{tag:"NO_PERMISSION"}})):p.code===3005?Zd({[i]:{tag:"NOT_FOUND"}}):p.code===1600?(e==null||e)&&st({$fileIllegal:!0}):p.code===200&&Zd({[i]:void 0});![1407].includes(p.code)&&pt()&&DD(i),(g=l==null?void 0:l.callback)==null||g.call(l,p),nse(i)},l==null?void 0:l.taskType),n_[i]=c,c.catch(()=>{n_[i]=void 0})),u?c:c.then(()=>{n_[i]=void 0})};return y.useCallback(o,[e,n,s,a,t])},vI=Aa(()=>({})),dse=Qs(vI),DD=async e=>{var s,a,o;const t=vI.getState()[e];if(t)return t;const n=await ve.editor.getDocPublicData.raw(e);if(n.code===200){const i=(s=n.data.publishAccessFee)!=null?s:0,l=(a=n.data.publishAccessPageId)!=null?a:"",c=(o=n.data.openPreview)!=null?o:!1;c&&i&&await TI(e,n.data.spaceId);const d={...n.data,openPreview:c,accessFee:i,accessPageId:l};return dse(u=>({...u,[e]:d})),d}},use=e=>vI(t=>t[e]),D5={currentCapacity:0,maxCapacity:200*N_,singleFileMaxSize:2*N_,dataBaseSingleFileMaxSize:2*N_,isNovice:!1,peopleCapacity:0,buyCapacity:0,expirationCapacity:0,baseCapacity:0,giveCapacity:0,autoRenewal:!1},fse={usage:0,basic:0,seat:0,additional:0,resetDate:0,aiRestUsage:0,monthlyEndDate:0,pdf:{todayUsed:0,monthUsed:0,totalLimit:0,dayLimit:0,monthLimit:0,leftReward:0},gpt3_5:{todayUsed:0,monthUsed:0,totalLimit:0,dayLimit:0,monthLimit:0,leftReward:0}},A5={...D5,...fse},v0=Aa(()=>({})),mse=Qs(v0),Mm=(e=Ot())=>v0(()=>Br(Zu(e))),Vw=(e=Ot())=>v0(()=>{const t=Zu(e);return ue().isBefore(t.monthlyEndDate)}),Zu=(e,t)=>{const{isDatabase:n}=t||{},s=A5,a=v0.getState()[e];return a&&os(s,a),n&&(s.singleFileMaxSize=s.dataBaseSingleFileMaxSize),s.isNovice=!1,s.aiRestUsage=s.basic+s.seat+s.additional,s},hse=e=>!!v0.getState()[e],R5=(e,t)=>{mse(Yn(n=>{os(n,{[e]:{...A5,...n[e]||{},...t}})}))},P5=async(e=Ot())=>{const t=await ve.infra.getSpaceAiUsage(e);return R5(e,t),t},L5=K1("$checkCopySubNodes",()=>({})),pse=Qs(L5,{assign:!0}),gse=Fd(L5),AD=qn(async e=>{const t=await ve.editor.checkCapacityForCopy.raw({targetSpaceId:e.spaceId,ids:e.ids});t.code===200&&pse({[e.spaceId]:t.data})},5e3,{leading:!0}),xc=()=>y.useCallback(B5,[]),B5=async(e=Ot())=>{const t=await ve.editor.capacityBlock(e);return R5(e,os(D5,t)),t},$w=()=>{const e=xc(),t=async(n,s)=>{const a=await ve.infra.getSpaceRoot.raw(n);if(a.code===200){const{blocks:o,spaces:i,collectionViews:l,users:c}=a.data,d={...Hp(i,u=>({spaceId:u.uuid,type:"SPACE",data:{icon:u.icon},permissions:[],...u})),...o};if(re(Tn.update({blocks:d})),l&&re(kl.update(l)),c&&i){qk(i);const u=i[n];u!=null&&u.permissions&&re(Ha.updateSpaceUsers({users:c,space:u}))}e(n)}else if(!(s!=null&&s.notJumpLocation)&&(a.code===1403||a.code===3005)){be.error("空间不存在");const o=Qk().filter(i=>i.uuid!==Ot())[0];o?(G9(o.uuid),Er(Nt.main)):Er(Nt.create)}};return y.useCallback(t,[e])},go=(e,t)=>II()(e,t),II=()=>{const e=Ln();return y.useCallback((t,n)=>{var d,u,f;const s=pt(),a=o1(),o=(d=J.blocks[t])==null?void 0:d.spaceId,i=(u=lg.getState()[o!=null?o:""])==null?void 0:u.domain;let l=s?a&&!T3()?"".concat(Nt.subscribe).concat(t):"".concat(Nt.share).concat(t):"/".concat(t),c=!a&&i&&!Eu()?"/".concat(i):"";return((f=J.blocks[t])==null?void 0:f.type)===m.BlockType.FILE&&!s&&(l="/preview".concat(l),c=""),e||(l="".concat(c).concat(l)),n&&(l="".concat(n).concat(t)),l},[e])},Tl=e=>ft(e,t=>{var n;return e?(n=t==null?void 0:t.data.format)==null?void 0:n.locked:!1}),NI=y.createContext(!1),Su=y.createContext(!1),jI=y.createContext(!1),We=(e,t=!0,n=!1)=>{const s=Un();let a=s===wt.PAGE_HISTORY||s===wt.PAGE_FEEDS||s===wt.TEMPLATE||s===wt.NOTIFICATION||s===wt.UPDATE_LOG||s===wt.FORM_ENG_PAGE||s===wt.PAGE_CHART||s===wt.PAGE_LITE_PREVIEW;n&&s&&[wt.NOTIFICATION,wt.PAGE_FEEDS].includes(s)&&(a=!1);const o=y.useContext(NI),i=y.useContext(Su),{role:l}=mt(e),c=e?Xn(l,n?m.PermissionRole.COMMENTER:m.PermissionRole.WRITER):!0;return y.useMemo(()=>i||!!ot.print||a||!c||t&&o,[c,t,o,a,i])},O5=()=>{const e=Oe(),t=Ut(),n=async s=>{const{blocks:a}=pe(),o=a[s];o&&e(()=>{var d;re(Sn({uuid:s,patch:{updatedAt:Date.now(),status:m.BlockStatus.NORMAL}})),o.status!==m.BlockStatus.DELETED&&re(Tr({uuid:s,parentId:o.parentId}));const i=a[o.parentId];let l=i,c=!l;for(;l;){if(l.status===m.BlockStatus.DELETED){c=!0;break}const u=l.type!=="SPACE";l=a[l.parentId],!l&&u&&(c=!0)}if(c||(i==null?void 0:i.type)===m.BlockType.COLLECTION_VIEW_PAGE&&[m.BlockType.FOLDER,m.BlockType.COLLECTION_VIEW_PAGE].includes(o.type)&&(c=!0),c)o.type===m.BlockType.COLLECTION_VIEW&&re(Sn({uuid:s,patch:{type:m.BlockType.COLLECTION_VIEW_PAGE}})),o.type===m.BlockType.MIND_MAPPING&&re(Sn({uuid:s,patch:{type:m.BlockType.MIND_MAPPING_PAGE}})),o.isTemplate&&re(Sn({uuid:s,patch:{isTemplate:!1}})),re(Sn({uuid:s,patch:{permissions:[{type:m.PermissionType.USER,userId:t.uuid,role:m.PermissionRole.EDITOR}]}})),re(ws({uuid:s,parentId:o.spaceId}));else if(o.isTemplate&&i!=null){const u=(d=i.templatePages)!=null?d:[];re(Sn({uuid:i.uuid,patch:{templatePages:[...u,o.uuid]}}))}else if((i==null?void 0:i.type)===m.BlockType.COLLECTION_VIEW_PAGE){const u=i.uuid;re(ws({uuid:s,parentId:u}))}else re(ws({uuid:s,parentId:o.parentId}))})};return y.useCallback(n,[t.uuid,e])},M5=new Ai(sessionStorage,"page_layout",30),_se=(e,t)=>{M5.put(e,t)},xse=e=>M5.get(e),Xl={lastGoBackPath:"",tmpDisable:!1},U5=(e,t)=>{const n=_d(),s=Ln(),a=y.useRef();a.current=n;const o=ns(),i=Un();y.useEffect(()=>{var h;if(!t.current||pt()||[i&&wt.PAGE_HISTORY,wt.TEMPLATE].includes(i))return;let l;const d=qn(()=>{var p,g;_se(e,{scrollTop:(g=(p=t.current)==null?void 0:p.scrollTop)!=null?g:0})},300);t.current.addEventListener("scroll",d);const u=()=>{var p;l&&clearTimeout(l),(p=t.current)==null||p.removeEventListener("scroll",d)};if(!Xl.lastGoBackPath||Xl.lastGoBackPath!==((h=a.current)==null?void 0:h.pathname))return u;const f=xse(e);return f&&(l=setTimeout(()=>{t.current&&t.current.scrollTo({top:f.scrollTop})},100)),u},[o,s,e,i,t])},yse=e=>Ce(t=>e?Hw(t.blocks,e):[],[e],{wait:200}),Hw=(e,t)=>{let n=Bc.getToc(t);if(n)return n;const s=new Set,a=o=>{var l;const i=e[o];i&&(o!==t&&((l=i.data.segments)==null||l.forEach(c=>{if(c.type===m.TextType.LINK_PAGE){const d=c.uuid;if(!d)return;const u=e[d];if(!u||u.status===m.BlockStatus.DELETED)return;u&&u.parentId===o&&s.add(d)}})),i.subNodes.forEach(c=>{const d=e[c];if(!d)return;const u=Yl(d);if(tn(d.type)||u){const{role:f}=mn(d.uuid);f!==m.PermissionRole.NONE&&s.add(c)}tn(d.type)||d.type===m.BlockType.TEMPLATE||a(c)}))};return a(t),n=[...s],n},V5=e=>{var o,i;const t=ye(e,["data"],["format"]),n=We(e),s=Oe(),{sortType:a}=aw((i=(o=t==null?void 0:t.data)==null?void 0:o.format)==null?void 0:i.orderFolder);return l=>{if(n)return;let c=a;switch(l){case"size":me.event("sort_file_size"),a===m.OrderFolderType.SIZE?c=m.OrderFolderType.SIZE_REVERSED:c===m.OrderFolderType.SIZE_REVERSED?c=m.OrderFolderType.SIZE:c=m.OrderFolderType.SIZE_REVERSED;break;case"time":me.event("sort_update_time"),a===m.OrderFolderType.TIME?c=m.OrderFolderType.TIME_REVERSED:c===m.OrderFolderType.TIME_REVERSED?c=m.OrderFolderType.TIME:c=m.OrderFolderType.TIME_REVERSED;break;default:case"name":me.event("sort_file_name"),a===m.OrderFolderType.NAME?c=m.OrderFolderType.NAME_REVERSED:c===m.OrderFolderType.NAME_REVERSED?c=m.OrderFolderType.NAME:c=m.OrderFolderType.NAME_REVERSED;break}s(()=>{_e(e,{data:{format:{orderFolder:c}}})})}},$5=()=>!J.ui.selectedBlocks.every(e=>{var n;const t=(n=J.blocks[e.blockId])==null?void 0:n.type;return t&&[m.BlockType.FILE,m.BlockType.FOLDER].includes(t)}),H5=JF({isDriveIcon:!1}),bse=()=>rL(H5),_s=e=>{var c;const{uuid:t,size:n="normal",className:s,...a}=e,{isDriveIcon:o}=bse(),i=ft(t,d=>{var u;if(d)return{type:d.type,hasContent:((u=d.subNodes)==null?void 0:u.length)>0}});if(!i||!t)return r.jsx(V,{className:s,name:ND(m.BlockType.PAGE,!1,!1),size:n,...a});let l;if(i.type===m.BlockType.FILE){const{extName:d}=Cp((c=J.blocks[t])==null?void 0:c.data.segments);l=Ya(d)}return l?r.jsx(V,{className:s,name:l,size:n,...a}):(l=ND(i.type,!i.hasContent,o),r.jsx(V,{className:s,name:l,size:n,...a}))},Fse=!0,wse=[{id:"people",name:"Smileys & People",emojis:["grinning","smiley","smile","grin","laughing","sweat_smile","rolling_on_the_floor_laughing","joy","slightly_smiling_face","upside_down_face","wink","blush","innocent","smiling_face_with_3_hearts","heart_eyes","star-struck","kissing_heart","kissing","relaxed","kissing_closed_eyes","kissing_smiling_eyes","yum","stuck_out_tongue","stuck_out_tongue_winking_eye","zany_face","stuck_out_tongue_closed_eyes","money_mouth_face","hugging_face","face_with_hand_over_mouth","shushing_face","thinking_face","zipper_mouth_face","face_with_raised_eyebrow","neutral_face","expressionless","no_mouth","smirk","unamused","face_with_rolling_eyes","grimacing","lying_face","relieved","pensive","sleepy","drooling_face","sleeping","mask","face_with_thermometer","face_with_head_bandage","nauseated_face","face_vomiting","sneezing_face","hot_face","cold_face","woozy_face","dizzy_face","exploding_head","face_with_cowboy_hat","partying_face","sunglasses","nerd_face","face_with_monocle","confused","worried","slightly_frowning_face","white_frowning_face","open_mouth","hushed","astonished","flushed","pleading_face","frowning","anguished","fearful","cold_sweat","disappointed_relieved","cry","sob","scream","confounded","persevere","disappointed","sweat","weary","tired_face","yawning_face","triumph","rage","angry","face_with_symbols_on_mouth","smiling_imp","imp","skull","skull_and_crossbones","hankey","clown_face","japanese_ogre","japanese_goblin","ghost","alien","space_invader","robot_face","smiley_cat","smile_cat","joy_cat","heart_eyes_cat","smirk_cat","kissing_cat","scream_cat","crying_cat_face","pouting_cat","see_no_evil","hear_no_evil","speak_no_evil","wave","raised_back_of_hand","raised_hand_with_fingers_splayed","hand","spock-hand","ok_hand","pinching_hand","v","crossed_fingers","i_love_you_hand_sign","the_horns","call_me_hand","point_left","point_right","point_up_2","middle_finger","point_down","point_up","+1","-1","fist","facepunch","left-facing_fist","right-facing_fist","clap","raised_hands","open_hands","palms_up_together","handshake","pray","writing_hand","nail_care","selfie","muscle","mechanical_arm","mechanical_leg","leg","foot","ear","ear_with_hearing_aid","nose","brain","tooth","bone","eyes","eye","tongue","lips","baby","child","boy","girl","adult","person_with_blond_hair","man","bearded_person","red_haired_man","curly_haired_man","white_haired_man","bald_man","woman","red_haired_woman","red_haired_person","curly_haired_woman","curly_haired_person","white_haired_woman","white_haired_person","bald_woman","bald_person","blond-haired-woman","blond-haired-man","older_adult","older_man","older_woman","person_frowning","man-frowning","woman-frowning","person_with_pouting_face","man-pouting","woman-pouting","no_good","man-gesturing-no","woman-gesturing-no","ok_woman","man-gesturing-ok","woman-gesturing-ok","information_desk_person","man-tipping-hand","woman-tipping-hand","raising_hand","man-raising-hand","woman-raising-hand","deaf_person","deaf_man","deaf_woman","bow","man-bowing","woman-bowing","face_palm","man-facepalming","woman-facepalming","shrug","man-shrugging","woman-shrugging","health_worker","male-doctor","female-doctor","student","male-student","female-student","teacher","male-teacher","female-teacher","judge","male-judge","female-judge","farmer","male-farmer","female-farmer","cook","male-cook","female-cook","mechanic","male-mechanic","female-mechanic","factory_worker","male-factory-worker","female-factory-worker","office_worker","male-office-worker","female-office-worker","scientist","male-scientist","female-scientist","technologist","male-technologist","female-technologist","singer","male-singer","female-singer","artist","male-artist","female-artist","pilot","male-pilot","female-pilot","astronaut","male-astronaut","female-astronaut","firefighter","male-firefighter","female-firefighter","cop","male-police-officer","female-police-officer","sleuth_or_spy","male-detective","female-detective","guardsman","male-guard","female-guard","construction_worker","male-construction-worker","female-construction-worker","prince","princess","man_with_turban","man-wearing-turban","woman-wearing-turban","man_with_gua_pi_mao","person_with_headscarf","man_in_tuxedo","bride_with_veil","pregnant_woman","breast-feeding","angel","santa","mrs_claus","superhero","male_superhero","female_superhero","supervillain","male_supervillain","female_supervillain","mage","male_mage","female_mage","fairy","male_fairy","female_fairy","vampire","male_vampire","female_vampire","merperson","merman","mermaid","elf","male_elf","female_elf","genie","male_genie","female_genie","zombie","male_zombie","female_zombie","massage","man-getting-massage","woman-getting-massage","haircut","man-getting-haircut","woman-getting-haircut","walking","man-walking","woman-walking","standing_person","man_standing","woman_standing","kneeling_person","man_kneeling","woman_kneeling","person_with_probing_cane","man_with_probing_cane","woman_with_probing_cane","person_in_motorized_wheelchair","man_in_motorized_wheelchair","woman_in_motorized_wheelchair","person_in_manual_wheelchair","man_in_manual_wheelchair","woman_in_manual_wheelchair","runner","man-running","woman-running","dancer","man_dancing","man_in_business_suit_levitating","dancers","man-with-bunny-ears-partying","woman-with-bunny-ears-partying","person_in_steamy_room","man_in_steamy_room","woman_in_steamy_room","person_climbing","man_climbing","woman_climbing","fencer","horse_racing","skier","snowboarder","golfer","man-golfing","woman-golfing","surfer","man-surfing","woman-surfing","rowboat","man-rowing-boat","woman-rowing-boat","swimmer","man-swimming","woman-swimming","person_with_ball","man-bouncing-ball","woman-bouncing-ball","weight_lifter","man-lifting-weights","woman-lifting-weights","bicyclist","man-biking","woman-biking","mountain_bicyclist","man-mountain-biking","woman-mountain-biking","person_doing_cartwheel","man-cartwheeling","woman-cartwheeling","wrestlers","man-wrestling","woman-wrestling","water_polo","man-playing-water-polo","woman-playing-water-polo","handball","man-playing-handball","woman-playing-handball","juggling","man-juggling","woman-juggling","person_in_lotus_position","man_in_lotus_position","woman_in_lotus_position","bath","sleeping_accommodation","people_holding_hands","two_women_holding_hands","couple","two_men_holding_hands","couplekiss","woman-kiss-man","man-kiss-man","woman-kiss-woman","couple_with_heart","woman-heart-man","man-heart-man","woman-heart-woman","family","man-woman-boy","man-woman-girl","man-woman-girl-boy","man-woman-boy-boy","man-woman-girl-girl","man-man-boy","man-man-girl","man-man-girl-boy","man-man-boy-boy","man-man-girl-girl","woman-woman-boy","woman-woman-girl","woman-woman-girl-boy","woman-woman-boy-boy","woman-woman-girl-girl","man-boy","man-boy-boy","man-girl","man-girl-boy","man-girl-girl","woman-boy","woman-boy-boy","woman-girl","woman-girl-boy","woman-girl-girl","speaking_head_in_silhouette","bust_in_silhouette","busts_in_silhouette","footprints","kiss","love_letter","cupid","gift_heart","sparkling_heart","heartpulse","heartbeat","revolving_hearts","two_hearts","heart_decoration","heavy_heart_exclamation_mark_ornament","broken_heart","heart","orange_heart","yellow_heart","green_heart","blue_heart","purple_heart","brown_heart","black_heart","white_heart","100","anger","boom","dizzy","sweat_drops","dash","hole","bomb","speech_balloon","eye-in-speech-bubble","left_speech_bubble","right_anger_bubble","thought_balloon","zzz"]},{id:"nature",name:"Animals & Nature",emojis:["monkey_face","monkey","gorilla","orangutan","dog","dog2","guide_dog","service_dog","poodle","wolf","fox_face","raccoon","cat","cat2","lion_face","tiger","tiger2","leopard","horse","racehorse","unicorn_face","zebra_face","deer","cow","ox","water_buffalo","cow2","pig","pig2","boar","pig_nose","ram","sheep","goat","dromedary_camel","camel","llama","giraffe_face","elephant","rhinoceros","hippopotamus","mouse","mouse2","rat","hamster","rabbit","rabbit2","chipmunk","hedgehog","bat","bear","koala","panda_face","sloth","otter","skunk","kangaroo","badger","feet","turkey","chicken","rooster","hatching_chick","baby_chick","hatched_chick","bird","penguin","dove_of_peace","eagle","duck","swan","owl","flamingo","peacock","parrot","frog","crocodile","turtle","lizard","snake","dragon_face","dragon","sauropod","t-rex","whale","whale2","dolphin","fish","tropical_fish","blowfish","shark","octopus","shell","snail","butterfly","bug","ant","bee","beetle","cricket","spider","spider_web","scorpion","mosquito","microbe","bouquet","cherry_blossom","white_flower","rosette","rose","wilted_flower","hibiscus","sunflower","blossom","tulip","seedling","evergreen_tree","deciduous_tree","palm_tree","cactus","ear_of_rice","herb","shamrock","four_leaf_clover","maple_leaf","fallen_leaf","leaves"]},{id:"foods",name:"Food & Drink",emojis:["grapes","melon","watermelon","tangerine","lemon","banana","pineapple","mango","apple","green_apple","pear","peach","cherries","strawberry","kiwifruit","tomato","coconut","avocado","eggplant","potato","carrot","corn","hot_pepper","cucumber","leafy_green","broccoli","garlic","onion","mushroom","peanuts","chestnut","bread","croissant","baguette_bread","pretzel","bagel","pancakes","waffle","cheese_wedge","meat_on_bone","poultry_leg","cut_of_meat","bacon","hamburger","fries","pizza","hotdog","sandwich","taco","burrito","stuffed_flatbread","falafel","egg","fried_egg","shallow_pan_of_food","stew","bowl_with_spoon","green_salad","popcorn","butter","salt","canned_food","bento","rice_cracker","rice_ball","rice","curry","ramen","spaghetti","sweet_potato","oden","sushi","fried_shrimp","fish_cake","moon_cake","dango","dumpling","fortune_cookie","takeout_box","crab","lobster","shrimp","squid","oyster","icecream","shaved_ice","ice_cream","doughnut","cookie","birthday","cake","cupcake","pie","chocolate_bar","candy","lollipop","custard","honey_pot","baby_bottle","glass_of_milk","coffee","tea","sake","champagne","wine_glass","cocktail","tropical_drink","beer","beers","clinking_glasses","tumbler_glass","cup_with_straw","beverage_box","mate_drink","ice_cube","chopsticks","knife_fork_plate","fork_and_knife","spoon","hocho","amphora"]},{id:"activity",name:"Activities",emojis:["jack_o_lantern","christmas_tree","fireworks","sparkler","firecracker","sparkles","balloon","tada","confetti_ball","tanabata_tree","bamboo","dolls","flags","wind_chime","rice_scene","red_envelope","ribbon","gift","reminder_ribbon","admission_tickets","ticket","medal","trophy","sports_medal","first_place_medal","second_place_medal","third_place_medal","soccer","baseball","softball","basketball","volleyball","football","rugby_football","tennis","flying_disc","bowling","cricket_bat_and_ball","field_hockey_stick_and_ball","ice_hockey_stick_and_puck","lacrosse","table_tennis_paddle_and_ball","badminton_racquet_and_shuttlecock","boxing_glove","martial_arts_uniform","goal_net","golf","ice_skate","fishing_pole_and_fish","diving_mask","running_shirt_with_sash","ski","sled","curling_stone","dart","yo-yo","kite","8ball","crystal_ball","nazar_amulet","video_game","joystick","slot_machine","game_die","jigsaw","teddy_bear","spades","hearts","diamonds","clubs","chess_pawn","black_joker","mahjong","flower_playing_cards","performing_arts","frame_with_picture","art","thread","yarn"]},{id:"places",name:"Travel & Places",emojis:["earth_africa","earth_americas","earth_asia","globe_with_meridians","world_map","japan","compass","snow_capped_mountain","mountain","volcano","mount_fuji","camping","beach_with_umbrella","desert","desert_island","national_park","stadium","classical_building","building_construction","bricks","house_buildings","derelict_house_building","house","house_with_garden","office","post_office","european_post_office","hospital","bank","hotel","love_hotel","convenience_store","school","department_store","factory","japanese_castle","european_castle","wedding","tokyo_tower","statue_of_liberty","church","mosque","hindu_temple","synagogue","shinto_shrine","kaaba","fountain","tent","foggy","night_with_stars","cityscape","sunrise_over_mountains","sunrise","city_sunset","city_sunrise","bridge_at_night","hotsprings","carousel_horse","ferris_wheel","roller_coaster","barber","circus_tent","steam_locomotive","railway_car","bullettrain_side","bullettrain_front","train2","metro","light_rail","station","tram","monorail","mountain_railway","train","bus","oncoming_bus","trolleybus","minibus","ambulance","fire_engine","police_car","oncoming_police_car","taxi","oncoming_taxi","car","oncoming_automobile","blue_car","truck","articulated_lorry","tractor","racing_car","racing_motorcycle","motor_scooter","manual_wheelchair","motorized_wheelchair","auto_rickshaw","bike","scooter","skateboard","busstop","motorway","railway_track","oil_drum","fuelpump","rotating_light","traffic_light","vertical_traffic_light","octagonal_sign","construction","anchor","boat","canoe","speedboat","passenger_ship","ferry","motor_boat","ship","airplane","small_airplane","airplane_departure","airplane_arriving","parachute","seat","helicopter","suspension_railway","mountain_cableway","aerial_tramway","satellite","rocket","flying_saucer","bellhop_bell","luggage","hourglass","hourglass_flowing_sand","watch","alarm_clock","stopwatch","timer_clock","mantelpiece_clock","clock12","clock1230","clock1","clock130","clock2","clock230","clock3","clock330","clock4","clock430","clock5","clock530","clock6","clock630","clock7","clock730","clock8","clock830","clock9","clock930","clock10","clock1030","clock11","clock1130","new_moon","waxing_crescent_moon","first_quarter_moon","moon","full_moon","waning_gibbous_moon","last_quarter_moon","waning_crescent_moon","crescent_moon","new_moon_with_face","first_quarter_moon_with_face","last_quarter_moon_with_face","thermometer","sunny","full_moon_with_face","sun_with_face","ringed_planet","star","star2","stars","milky_way","cloud","partly_sunny","thunder_cloud_and_rain","mostly_sunny","barely_sunny","partly_sunny_rain","rain_cloud","snow_cloud","lightning","tornado","fog","wind_blowing_face","cyclone","rainbow","closed_umbrella","umbrella","umbrella_with_rain_drops","umbrella_on_ground","zap","snowflake","snowman","snowman_without_snow","comet","fire","droplet","ocean"]},{id:"objects",name:"Objects",emojis:["eyeglasses","dark_sunglasses","goggles","lab_coat","safety_vest","necktie","shirt","jeans","scarf","gloves","coat","socks","dress","kimono","sari","one-piece_swimsuit","briefs","shorts","bikini","womans_clothes","purse","handbag","pouch","shopping_bags","school_satchel","mans_shoe","athletic_shoe","hiking_boot","womans_flat_shoe","high_heel","sandal","ballet_shoes","boot","crown","womans_hat","tophat","mortar_board","billed_cap","helmet_with_white_cross","prayer_beads","lipstick","ring","gem","mute","speaker","sound","loud_sound","loudspeaker","mega","postal_horn","bell","no_bell","musical_score","musical_note","notes","studio_microphone","level_slider","control_knobs","microphone","headphones","radio","saxophone","guitar","musical_keyboard","trumpet","violin","banjo","drum_with_drumsticks","iphone","calling","phone","telephone_receiver","pager","fax","battery","electric_plug","computer","desktop_computer","printer","keyboard","three_button_mouse","trackball","minidisc","floppy_disk","cd","dvd","abacus","movie_camera","film_frames","film_projector","clapper","tv","camera","camera_with_flash","video_camera","vhs","mag","mag_right","candle","bulb","flashlight","izakaya_lantern","diya_lamp","notebook_with_decorative_cover","closed_book","book","green_book","blue_book","orange_book","books","notebook","ledger","page_with_curl","scroll","page_facing_up","newspaper","rolled_up_newspaper","bookmark_tabs","bookmark","label","moneybag","yen","dollar","euro","pound","money_with_wings","credit_card","receipt","chart","currency_exchange","heavy_dollar_sign","email","e-mail","incoming_envelope","envelope_with_arrow","outbox_tray","inbox_tray","package","mailbox","mailbox_closed","mailbox_with_mail","mailbox_with_no_mail","postbox","ballot_box_with_ballot","pencil2","black_nib","lower_left_fountain_pen","lower_left_ballpoint_pen","lower_left_paintbrush","lower_left_crayon","memo","briefcase","file_folder","open_file_folder","card_index_dividers","date","calendar","spiral_note_pad","spiral_calendar_pad","card_index","chart_with_upwards_trend","chart_with_downwards_trend","bar_chart","clipboard","pushpin","round_pushpin","paperclip","linked_paperclips","straight_ruler","triangular_ruler","scissors","card_file_box","file_cabinet","wastebasket","lock","unlock","lock_with_ink_pen","closed_lock_with_key","key","old_key","hammer","axe","pick","hammer_and_pick","hammer_and_wrench","dagger_knife","crossed_swords","gun","bow_and_arrow","shield","wrench","nut_and_bolt","gear","compression","scales","probing_cane","link","chains","toolbox","magnet","alembic","test_tube","petri_dish","dna","microscope","telescope","satellite_antenna","syringe","drop_of_blood","pill","adhesive_bandage","stethoscope","door","bed","couch_and_lamp","chair","toilet","shower","bathtub","razor","lotion_bottle","safety_pin","broom","basket","roll_of_paper","soap","sponge","fire_extinguisher","shopping_trolley","smoking","coffin","funeral_urn","moyai"]},{id:"symbols",name:"Symbols",emojis:["atm","put_litter_in_its_place","potable_water","wheelchair","mens","womens","restroom","baby_symbol","wc","passport_control","customs","baggage_claim","left_luggage","warning","children_crossing","no_entry","no_entry_sign","no_bicycles","no_smoking","do_not_litter","non-potable_water","no_pedestrians","no_mobile_phones","underage","radioactive_sign","biohazard_sign","arrow_up","arrow_upper_right","arrow_right","arrow_lower_right","arrow_down","arrow_lower_left","arrow_left","arrow_upper_left","arrow_up_down","left_right_arrow","leftwards_arrow_with_hook","arrow_right_hook","arrow_heading_up","arrow_heading_down","arrows_clockwise","arrows_counterclockwise","back","end","on","soon","top","place_of_worship","atom_symbol","om_symbol","star_of_david","wheel_of_dharma","yin_yang","latin_cross","orthodox_cross","star_and_crescent","peace_symbol","menorah_with_nine_branches","six_pointed_star","aries","taurus","gemini","cancer","leo","virgo","libra","scorpius","sagittarius","capricorn","aquarius","pisces","ophiuchus","twisted_rightwards_arrows","repeat","repeat_one","arrow_forward","fast_forward","black_right_pointing_double_triangle_with_vertical_bar","black_right_pointing_triangle_with_double_vertical_bar","arrow_backward","rewind","black_left_pointing_double_triangle_with_vertical_bar","arrow_up_small","arrow_double_up","arrow_down_small","arrow_double_down","double_vertical_bar","black_square_for_stop","black_circle_for_record","eject","cinema","low_brightness","high_brightness","signal_strength","vibration_mode","mobile_phone_off","female_sign","male_sign","medical_symbol","infinity","recycle","fleur_de_lis","trident","name_badge","beginner","o","white_check_mark","ballot_box_with_check","heavy_check_mark","heavy_multiplication_x","x","negative_squared_cross_mark","heavy_plus_sign","heavy_minus_sign","heavy_division_sign","curly_loop","loop","part_alternation_mark","eight_spoked_asterisk","eight_pointed_black_star","sparkle","bangbang","interrobang","question","grey_question","grey_exclamation","exclamation","wavy_dash","copyright","registered","tm","hash","keycap_star","zero","one","two","three","four","five","six","seven","eight","nine","keycap_ten","capital_abcd","abcd","1234","symbols","abc","a","ab","b","cl","cool","free","information_source","id","m","new","ng","o2","ok","parking","sos","up","vs","koko","sa","u6708","u6709","u6307","ideograph_advantage","u5272","u7121","u7981","accept","u7533","u5408","u7a7a","congratulations","secret","u55b6","u6e80","red_circle","large_orange_circle","large_yellow_circle","large_green_circle","large_blue_circle","large_purple_circle","large_brown_circle","black_circle","white_circle","large_red_square","large_orange_square","large_yellow_square","large_green_square","large_blue_square","large_purple_square","large_brown_square","black_large_square","white_large_square","black_medium_square","white_medium_square","black_medium_small_square","white_medium_small_square","black_small_square","white_small_square","large_orange_diamond","large_blue_diamond","small_orange_diamond","small_blue_diamond","small_red_triangle","small_red_triangle_down","diamond_shape_with_a_dot_inside","radio_button","white_square_button","black_square_button"]},{id:"flags",name:"Flags",emojis:["checkered_flag","cn","crossed_flags","de","es","flag-ac","flag-ad","flag-ae","flag-af","flag-ag","flag-ai","flag-al","flag-am","flag-ao","flag-aq","flag-ar","flag-as","flag-at","flag-au","flag-aw","flag-ax","flag-az","flag-ba","flag-bb","flag-bd","flag-be","flag-bf","flag-bg","flag-bh","flag-bi","flag-bj","flag-bl","flag-bm","flag-bn","flag-bo","flag-bq","flag-br","flag-bs","flag-bt","flag-bv","flag-bw","flag-by","flag-bz","flag-ca","flag-cc","flag-cd","flag-cf","flag-cg","flag-ch","flag-ci","flag-ck","flag-cl","flag-cm","flag-co","flag-cp","flag-cr","flag-cu","flag-cv","flag-cw","flag-cx","flag-cy","flag-cz","flag-dg","flag-dj","flag-dk","flag-dm","flag-do","flag-dz","flag-ea","flag-ec","flag-ee","flag-eg","flag-eh","flag-england","flag-er","flag-et","flag-eu","flag-fi","flag-fj","flag-fk","flag-fm","flag-fo","flag-ga","flag-gd","flag-ge","flag-gf","flag-gg","flag-gh","flag-gi","flag-gl","flag-gm","flag-gn","flag-gp","flag-gq","flag-gr","flag-gs","flag-gt","flag-gu","flag-gw","flag-gy","flag-hk","flag-hm","flag-hn","flag-hr","flag-ht","flag-hu","flag-ic","flag-id","flag-ie","flag-il","flag-im","flag-in","flag-io","flag-iq","flag-ir","flag-is","flag-je","flag-jm","flag-jo","flag-ke","flag-kg","flag-kh","flag-ki","flag-km","flag-kn","flag-kp","flag-kw","flag-ky","flag-kz","flag-la","flag-lb","flag-lc","flag-li","flag-lk","flag-lr","flag-ls","flag-lt","flag-lu","flag-lv","flag-ly","flag-ma","flag-mc","flag-md","flag-me","flag-mf","flag-mg","flag-mh","flag-mk","flag-ml","flag-mm","flag-mn","flag-mo","flag-mp","flag-mq","flag-mr","flag-ms","flag-mt","flag-mu","flag-mv","flag-mw","flag-mx","flag-my","flag-mz","flag-na","flag-nc","flag-ne","flag-nf","flag-ng","flag-ni","flag-nl","flag-no","flag-np","flag-nr","flag-nu","flag-nz","flag-om","flag-pa","flag-pe","flag-pf","flag-pg","flag-ph","flag-pk","flag-pl","flag-pm","flag-pn","flag-pr","flag-ps","flag-pt","flag-pw","flag-py","flag-qa","flag-re","flag-ro","flag-rs","flag-rw","flag-sa","flag-sb","flag-sc","flag-scotland","flag-sd","flag-se","flag-sg","flag-sh","flag-si","flag-sj","flag-sk","flag-sl","flag-sm","flag-sn","flag-so","flag-sr","flag-ss","flag-st","flag-sv","flag-sx","flag-sy","flag-sz","flag-ta","flag-tc","flag-td","flag-tf","flag-tg","flag-th","flag-tj","flag-tk","flag-tl","flag-tm","flag-tn","flag-to","flag-tr","flag-tt","flag-tv","flag-tz","flag-ua","flag-ug","flag-um","flag-uy","flag-uz","flag-va","flag-vc","flag-ve","flag-vg","flag-vi","flag-vn","flag-vu","flag-wales","flag-wf","flag-ws","flag-xk","flag-ye","flag-yt","flag-za","flag-zm","flag-zw","fr","gb","it","jp","kr","pirate_flag","rainbow-flag","ru","triangular_flag_on_post","us","waving_black_flag","waving_white_flag"]}],Ese={100:{a:"Hundred Points Symbol",b:"1F4AF",d:!0,e:!0,f:!0,h:!0,j:["一百分","得分","完善","数字","世纪","考试","测验","测试","通过","百","score","perfect","numbers","century","exam","quiz","test","pass","hundred"],k:[26,5],o:2},1234:{a:"Input Symbol for Numbers",b:"1F522",d:!0,e:!0,f:!0,h:!0,j:["输入数字","数字","蓝色方块","numbers","blue-square"],k:[28,5],o:2},grinning:{a:"Grinning Face",b:"1F600",d:!0,e:!0,f:!0,h:!0,j:["笑嘻嘻","脸","微笑","快乐","喜悦",":D","笑容","face","smile","happy","joy",":D","grin"],k:[30,35],m:":D",o:2},monkey_face:{a:"Monkey Face",b:"1F435",d:!0,e:!0,f:!0,h:!0,j:["猴面","动物","自然界","马戏团","animal","nature","circus"],k:[12,25],l:[":o)"],o:2},grapes:{a:"Grapes",b:"1F347",d:!0,e:!0,f:!0,h:!0,j:["葡萄","水果","食物","酒","fruit","food","wine"],k:[6,31],o:2},eyeglasses:{a:"Eyeglasses",b:"1F453",d:!0,e:!0,f:!0,h:!0,j:["眼镜","时尚","辅料","目力","宅","笨蛋","怪胎","fashion","accessories","eyesight","nerdy","dork","geek"],k:[14,7],o:2},checkered_flag:{a:"Chequered Flag",b:"1F3C1",d:!0,e:!0,f:!0,h:!0,j:["方格旗","比赛","终点线","比赛","卡 丁 车","contest","finishline","race","gokart"],k:[8,39],o:2},jack_o_lantern:{a:"Jack-O-Lantern",b:"1F383",d:!0,e:!0,f:!0,h:!0,j:["南瓜灯","万圣节","光","南瓜","恐怖","秋天","halloween","light","pumpkin","creepy","fall"],k:[7,34],o:2},wave:{skin_variations:{"1F3FB":{unified:"1F44B-1F3FB",non_qualified:null,image:"1f44b-1f3fb.png",sheet_x:13,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F44B-1F3FC",non_qualified:null,image:"1f44b-1f3fc.png",sheet_x:13,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F44B-1F3FD",non_qualified:null,image:"1f44b-1f3fd.png",sheet_x:13,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F44B-1F3FE",non_qualified:null,image:"1f44b-1f3fe.png",sheet_x:13,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F44B-1F3FF",non_qualified:null,image:"1f44b-1f3ff.png",sheet_x:13,sheet_y:31,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Waving Hand Sign",b:"1F44B",d:!0,e:!0,f:!0,h:!0,j:["挥手","手","手势","再见","单","告别","你好","你好","手掌","hands","gesture","goodbye","solong","farewell","hello","hi","palm"],k:[13,26],o:2},earth_africa:{a:"Earth Globe Europe-Africa",b:"1F30D",d:!0,e:!0,f:!0,h:!0,j:["地球显示欧洲 - 非洲","球","世界","国际","globe","world","international"],k:[5,32],o:2},atm:{a:"Automated Teller Machine",b:"1F3E7",d:!0,e:!0,f:!0,h:!0,j:["ATM标志","钱","销售","现金","蓝色方块","付款","岸","money","sales","cash","blue-square","payment","bank"],k:[11,1],o:2},melon:{a:"Melon",b:"1F348",d:!0,e:!0,f:!0,h:!0,j:["瓜","水果","自然界","食物","fruit","nature","food"],k:[6,32],o:2},triangular_flag_on_post:{a:"Triangular Flag on Post",b:"1F6A9",d:!0,e:!0,f:!0,h:!0,j:["三角标志","马克","里程碑","地方","mark","milestone","place"],k:[35,0],o:2},put_litter_in_its_place:{a:"Put Litter in Its Place Symbol",b:"1F6AE",d:!0,e:!0,f:!0,h:!0,j:["垃圾桶标志","蓝色方块","标志","人","信息","blue-square","sign","human","info"],k:[35,5],o:2},christmas_tree:{a:"Christmas Tree",b:"1F384",d:!0,e:!0,f:!0,h:!0,j:["圣诞树","节日","假期","十二月","圣诞","庆祝","festival","vacation","december","xmas","celebration"],k:[7,35],o:2},monkey:{a:"Monkey",b:"1F412",d:!0,e:!0,f:!0,h:!0,j:["猴","动物","自然界","香蕉","马戏团","animal","nature","banana","circus"],k:[11,46],o:2},earth_americas:{a:"Earth Globe Americas",b:"1F30E",d:!0,e:!0,f:!0,h:!0,j:["环球美洲显示","球","世界","美国","国际","globe","world","USA","international"],k:[5,33],o:2},dark_sunglasses:{a:"Dark Sunglasses",b:"1F576-FE0F",c:"1F576",d:!0,e:!0,f:!0,h:!0,j:["墨镜","脸","凉","辅料","face","cool","accessories"],k:[29,33],o:2},raised_back_of_hand:{skin_variations:{"1F3FB":{unified:"1F91A-1F3FB",non_qualified:null,image:"1f91a-1f3fb.png",sheet_x:37,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F91A-1F3FC",non_qualified:null,image:"1f91a-1f3fc.png",sheet_x:37,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F91A-1F3FD",non_qualified:null,image:"1f91a-1f3fd.png",sheet_x:37,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F91A-1F3FE",non_qualified:null,image:"1f91a-1f3fe.png",sheet_x:37,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F91A-1F3FF",non_qualified:null,image:"1f91a-1f3ff.png",sheet_x:37,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Raised Back of Hand",b:"1F91A",d:!0,e:!0,f:!0,h:!0,j:["举手","手指","提出","反手","fingers","raised","backhand"],k:[37,43],o:4},smiley:{a:"Smiling Face with Open Mouth",b:"1F603",d:!0,e:!0,f:!0,h:!0,j:["笑嘻嘻的大眼睛的脸","脸","快乐","喜悦","哈哈",":D",":)","微笑","有趣","face","happy","joy","haha",":D",":)","smile","funny"],k:[30,38],l:["=)","=-)"],m:":)",o:2},earth_asia:{a:"Earth Globe Asia-Australia",b:"1F30F",d:!0,e:!0,f:!0,h:!0,j:["地球仪显示亚澳","球","世界","东","国际","globe","world","east","international"],k:[5,34],o:2},crossed_flags:{a:"Crossed Flags",b:"1F38C",d:!0,e:!0,f:!0,h:!0,j:["交叉旗帜","日语","国家","国家","边境","japanese","nation","country","border"],k:[7,48],o:2},watermelon:{a:"Watermelon",b:"1F349",d:!0,e:!0,f:!0,h:!0,j:["西瓜","水果","食物","野餐","夏天","fruit","food","picnic","summer"],k:[6,33],o:2},goggles:{a:"Goggles",b:"1F97D",d:!0,e:!0,f:!0,h:!0,k:[42,15],o:11,j:["护目镜"]},raised_hand_with_fingers_splayed:{skin_variations:{"1F3FB":{unified:"1F590-1F3FB",non_qualified:null,image:"1f590-1f3fb.png",sheet_x:29,sheet_y:49,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F590-1F3FC",non_qualified:null,image:"1f590-1f3fc.png",sheet_x:29,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F590-1F3FD",non_qualified:null,image:"1f590-1f3fd.png",sheet_x:29,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F590-1F3FE",non_qualified:null,image:"1f590-1f3fe.png",sheet_x:29,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F590-1F3FF",non_qualified:null,image:"1f590-1f3ff.png",sheet_x:29,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Raised Hand with Fingers Splayed",b:"1F590-FE0F",c:"1F590",d:!0,e:!0,f:!0,h:!0,j:["张开的手掌","手","手指","手掌","hand","fingers","palm"],k:[29,48],o:2},smile:{a:"Smiling Face with Open Mouth and Smiling Eyes",b:"1F604",d:!0,e:!0,f:!0,h:!0,j:["笑嘻嘻的脸","脸","快乐","喜悦","有趣","哈哈","笑","喜欢",":D",":)","face","happy","joy","funny","haha","laugh","like",":D",":)"],k:[30,39],l:["C:","c:",":D",":-D"],m:":)",o:2},potable_water:{a:"Potable Water Symbol",b:"1F6B0",d:!0,e:!0,f:!0,h:!0,j:["饮用水","蓝色方块","液","厕所","清洗","龙头","blue-square","liquid","restroom","cleaning","faucet"],k:[35,7],o:2},fireworks:{a:"Fireworks",b:"1F386",d:!0,e:!0,f:!0,h:!0,j:["烟花","相片","节日","狂欢节","祝贺","photo","festival","carnival","congratulations"],k:[7,42],o:2},gorilla:{a:"Gorilla",b:"1F98D",d:!0,e:!0,f:!0,h:!0,j:["大猩猩","动物","自然界","马戏团","animal","nature","circus"],k:[42,31],o:4},lab_coat:{a:"Lab Coat",b:"1F97C",d:!0,e:!0,f:!0,h:!0,k:[42,14],o:11,j:["实验工作服"]},tangerine:{a:"Tangerine",b:"1F34A",d:!0,e:!0,f:!0,h:!0,j:["柑橘","食物","水果","自然界","橙","food","fruit","nature","orange"],k:[6,34],o:2},wheelchair:{a:"Wheelchair Symbol",b:"267F",d:!0,e:!0,f:!0,h:!0,j:["轮椅标志","蓝色方块","禁用","a11y","可及性","blue-square","disabled","a11y","accessibility"],k:[53,40],o:2},waving_black_flag:{a:"Waving Black Flag",b:"1F3F4",d:!0,e:!0,f:!0,h:!0,k:[11,17],o:2,j:["黑旗"]},orangutan:{a:"Orangutan",b:"1F9A7",d:!0,e:!0,f:!0,h:!0,k:[42,55],o:12,j:["猩猩"]},sparkler:{a:"Firework Sparkler",b:"1F387",d:!0,e:!0,f:!0,h:!0,j:["烟火","星星","晚上","照","stars","night","shine"],k:[7,43],o:2},globe_with_meridians:{a:"Globe with Meridians",b:"1F310",d:!0,e:!0,f:!0,h:!0,j:["带经纬线的地球","地球","国际","世界","互联网","互联网络","i18n","earth","international","world","internet","interweb","i18n"],k:[5,35],o:2},grin:{a:"Grinning Face with Smiling Eyes",b:"1F601",d:!0,e:!0,f:!0,h:!0,j:["喜气洋洋的脸","脸","快乐","微笑","喜悦","卡哇伊","face","happy","smile","joy","kawaii"],k:[30,36],o:2},hand:{skin_variations:{"1F3FB":{unified:"270B-1F3FB",non_qualified:null,image:"270b-1f3fb.png",sheet_x:54,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"270B-1F3FC",non_qualified:null,image:"270b-1f3fc.png",sheet_x:54,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"270B-1F3FD",non_qualified:null,image:"270b-1f3fd.png",sheet_x:54,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"270B-1F3FE",non_qualified:null,image:"270b-1f3fe.png",sheet_x:54,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"270B-1F3FF",non_qualified:null,image:"270b-1f3ff.png",sheet_x:54,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Raised Hand",b:"270B",d:!0,e:!0,f:!0,h:!0,k:[54,49],n:["raised_hand"],o:2,j:["举手"]},firecracker:{a:"Firecracker",b:"1F9E8",d:!0,e:!0,f:!0,h:!0,k:[51,27],o:11,j:["鞭炮"]},lemon:{a:"Lemon",b:"1F34B",d:!0,e:!0,f:!0,h:!0,j:["柠檬","水果","自然界","fruit","nature"],k:[6,35],o:2},dog:{a:"Dog Face",b:"1F436",d:!0,e:!0,f:!0,h:!0,j:["狗脸","动物","朋友","自然界","汪","小狗","宠物","忠实","animal","friend","nature","woof","puppy","pet","faithful"],k:[12,26],o:2},mens:{a:"Mens Symbol",b:"1F6B9",d:!0,e:!0,f:!0,h:!0,j:["男厕所标志","厕所","厕所","厕所","蓝色方块","性","雄","toilet","restroom","wc","blue-square","gender","male"],k:[36,10],o:2},"spock-hand":{skin_variations:{"1F3FB":{unified:"1F596-1F3FB",non_qualified:null,image:"1f596-1f3fb.png",sheet_x:30,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F596-1F3FC",non_qualified:null,image:"1f596-1f3fc.png",sheet_x:30,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F596-1F3FD",non_qualified:null,image:"1f596-1f3fd.png",sheet_x:30,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F596-1F3FE",non_qualified:null,image:"1f596-1f3fe.png",sheet_x:30,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F596-1F3FF",non_qualified:null,image:"1f596-1f3ff.png",sheet_x:30,sheet_y:8,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Raised Hand with Part Between Middle and Ring Fingers",b:"1F596",d:!0,e:!0,f:!0,h:!0,k:[30,3],o:2,j:["瓦肯举手礼"]},world_map:{a:"World Map",b:"1F5FA-FE0F",c:"1F5FA",d:!0,e:!0,f:!0,h:!0,j:["世界地图","位置","方向","location","direction"],k:[30,29],o:2},laughing:{a:"Smiling Face with Open Mouth and Tightly-Closed Eyes",b:"1F606",d:!0,e:!0,f:!0,h:!0,j:["眯眼笑着的脸","快乐","喜悦","大声笑","满意","哈哈","脸","高兴","断续器","笑","happy","joy","lol","satisfied","haha","face","glad","XD","laugh"],k:[30,41],l:[":>",":->"],n:["satisfied"],o:2},waving_white_flag:{a:"Waving White Flag",b:"1F3F3-FE0F",c:"1F3F3",d:!0,e:!0,f:!0,h:!0,k:[11,12],o:2,j:["白旗"]},safety_vest:{a:"Safety Vest",b:"1F9BA",d:!0,e:!0,f:!0,h:!0,k:[43,54],o:12,j:["安全背心"]},sweat_smile:{a:"Smiling Face with Open Mouth and Cold Sweat",b:"1F605",d:!0,e:!0,f:!0,h:!0,j:["尴尬脸","脸","热","快乐","笑","汗","微笑","救济","face","hot","happy","laugh","sweat","smile","relief"],k:[30,40],o:2},sparkles:{a:"Sparkles",b:"2728",d:!0,e:!0,f:!0,h:!0,j:["闪闪发光","星星","照","闪亮","凉","棒","好","魔法","stars","shine","shiny","cool","awesome","good","magic"],k:[55,16],o:2},banana:{a:"Banana",b:"1F34C",d:!0,e:!0,f:!0,h:!0,j:["香蕉","水果","食物","猴子","fruit","food","monkey"],k:[6,36],o:2},"rainbow-flag":{a:"Rainbow Flag",b:"1F3F3-FE0F-200D-1F308",c:"1F3F3-200D-1F308",d:!0,e:!0,f:!0,h:!0,k:[11,11],o:4,j:["彩虹旗"]},ok_hand:{skin_variations:{"1F3FB":{unified:"1F44C-1F3FB",non_qualified:null,image:"1f44c-1f3fb.png",sheet_x:13,sheet_y:33,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F44C-1F3FC",non_qualified:null,image:"1f44c-1f3fc.png",sheet_x:13,sheet_y:34,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F44C-1F3FD",non_qualified:null,image:"1f44c-1f3fd.png",sheet_x:13,sheet_y:35,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F44C-1F3FE",non_qualified:null,image:"1f44c-1f3fe.png",sheet_x:13,sheet_y:36,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F44C-1F3FF",non_qualified:null,image:"1f44c-1f3ff.png",sheet_x:13,sheet_y:37,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Ok Hand Sign",b:"1F44C",d:!0,e:!0,f:!0,h:!0,j:["OK手势","手指","四肢","完善","还行","好","fingers","limbs","perfect","ok","okay"],k:[13,32],o:2},japan:{a:"Silhouette of Japan",b:"1F5FE",d:!0,e:!0,f:!0,h:!0,j:["地图日本","国家","国家","日语","亚洲","nation","country","japanese","asia"],k:[30,33],o:2},dog2:{a:"Dog",b:"1F415",d:!0,e:!0,f:!0,h:!0,j:["狗","动物","自然界","朋友","总督","宠物","忠实","animal","nature","friend","doge","pet","faithful"],k:[11,50],o:2},womens:{a:"Womens Symbol",b:"1F6BA",d:!0,e:!0,f:!0,h:!0,j:["女厕所标志","紫色方块","女人","女性","厕所","洗手间","厕所","性","purple-square","woman","female","toilet","loo","restroom","gender"],k:[36,11],o:2},necktie:{a:"Necktie",b:"1F454",d:!0,e:!0,f:!0,h:!0,j:["领带","衬衫","西装革履","正式","时尚","布","商","shirt","suitup","formal","fashion","cloth","business"],k:[14,8],o:2},pirate_flag:{a:"Pirate Flag",b:"1F3F4-200D-2620-FE0F",c:"1F3F4-200D-2620",d:!0,e:!0,f:!0,h:!0,k:[11,13],o:11,j:["海盗旗"]},guide_dog:{a:"Guide Dog",b:"1F9AE",d:!0,e:!0,f:!0,h:!0,k:[43,2],o:12,j:["导盲犬"]},restroom:{a:"Restroom",b:"1F6BB",d:!0,e:!0,f:!0,h:!0,j:["卫生间标志","蓝色方块","厕所","刷新","厕所","性","blue-square","toilet","refresh","wc","gender"],k:[36,12],o:2},compass:{a:"Compass",b:"1F9ED",d:!0,e:!0,f:!0,h:!0,k:[51,32],o:11,j:["罗盘"]},rolling_on_the_floor_laughing:{a:"Rolling on the Floor Laughing",b:"1F923",d:!0,e:!0,f:!0,h:!0,k:[38,20],o:4,j:["在地上打滚大笑"]},balloon:{a:"Balloon",b:"1F388",d:!0,e:!0,f:!0,h:!0,j:["气球","党","庆祝","生日","马戏团","party","celebration","birthday","circus"],k:[7,44],o:2},pinching_hand:{skin_variations:{"1F3FB":{unified:"1F90F-1F3FB",non_qualified:null,image:"1f90f-1f3fb.png",sheet_x:37,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F90F-1F3FC",non_qualified:null,image:"1f90f-1f3fc.png",sheet_x:37,sheet_y:19,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F90F-1F3FD",non_qualified:null,image:"1f90f-1f3fd.png",sheet_x:37,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F90F-1F3FE",non_qualified:null,image:"1f90f-1f3fe.png",sheet_x:37,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F90F-1F3FF",non_qualified:null,image:"1f90f-1f3ff.png",sheet_x:37,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Pinching Hand",b:"1F90F",d:!0,e:!0,f:!0,h:!0,k:[37,17],o:12,j:["捏手"]},pineapple:{a:"Pineapple",b:"1F34D",d:!0,e:!0,f:!0,h:!0,j:["菠萝","水果","自然界","食物","fruit","nature","food"],k:[6,37],o:2},shirt:{a:"T-Shirt",b:"1F455",d:!0,e:!0,f:!0,h:!0,k:[14,9],n:["tshirt"],o:2,j:["T恤"]},service_dog:{a:"Service Dog",b:"1F415-200D-1F9BA",d:!0,e:!0,f:!0,h:!0,k:[11,49],o:12,j:["服务犬"]},baby_symbol:{a:"Baby Symbol",b:"1F6BC",d:!0,e:!0,f:!0,h:!0,j:["育婴室标志","橙色方块","孩子","orange-square","child"],k:[36,13],o:2},joy:{a:"Face with Tears of Joy",b:"1F602",d:!0,e:!0,f:!0,h:!0,j:["笑Cry脸","脸","哭","眼泪","哭","快乐","快乐的茶","哈哈","face","cry","tears","weep","happy","happytears","haha"],k:[30,37],o:2},tada:{a:"Party Popper",b:"1F389",d:!0,e:!0,f:!0,h:!0,j:["派对礼花","党","祝贺","生日","魔法","马戏团","庆祝","party","congratulations","birthday","magic","circus","celebration"],k:[7,45],o:2},mango:{a:"Mango",b:"1F96D",d:!0,e:!0,f:!0,h:!0,k:[42,3],o:11,j:["芒果"]},v:{skin_variations:{"1F3FB":{unified:"270C-1F3FB",non_qualified:null,image:"270c-1f3fb.png",sheet_x:54,sheet_y:56,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"270C-1F3FC",non_qualified:null,image:"270c-1f3fc.png",sheet_x:55,sheet_y:0,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"270C-1F3FD",non_qualified:null,image:"270c-1f3fd.png",sheet_x:55,sheet_y:1,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"270C-1F3FE",non_qualified:null,image:"270c-1f3fe.png",sheet_x:55,sheet_y:2,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"270C-1F3FF",non_qualified:null,image:"270c-1f3ff.png",sheet_x:55,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Victory Hand",b:"270C-FE0F",c:"270C",d:!0,e:!0,f:!0,h:!0,j:["剪刀手","手指","哦耶","手","和平","胜利","二","fingers","ohyeah","hand","peace","victory","two"],k:[54,55],o:2},snow_capped_mountain:{a:"Snow Capped Mountain",b:"1F3D4-FE0F",c:"1F3D4",d:!0,e:!0,f:!0,h:!0,k:[10,39],o:2,j:["雪山"]},"flag-ac":{a:"Ascension Island Flag",b:"1F1E6-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[0,31],o:2,j:["阿森松岛旗"]},jeans:{a:"Jeans",b:"1F456",d:!0,e:!0,f:!0,h:!0,j:["牛仔裤","时尚","购物","fashion","shopping"],k:[14,10],o:2},poodle:{a:"Poodle",b:"1F429",d:!0,e:!0,f:!0,h:!0,j:["贵宾犬","狗","动物","101","自然界","宠物","dog","animal","101","nature","pet"],k:[12,13],o:2},crossed_fingers:{skin_variations:{"1F3FB":{unified:"1F91E-1F3FB",non_qualified:null,image:"1f91e-1f3fb.png",sheet_x:38,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F91E-1F3FC",non_qualified:null,image:"1f91e-1f3fc.png",sheet_x:38,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F91E-1F3FD",non_qualified:null,image:"1f91e-1f3fd.png",sheet_x:38,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F91E-1F3FE",non_qualified:null,image:"1f91e-1f3fe.png",sheet_x:38,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F91E-1F3FF",non_qualified:null,image:"1f91e-1f3ff.png",sheet_x:38,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Hand with Index and Middle Fingers Crossed",b:"1F91E",d:!0,e:!0,f:!0,h:!0,j:["两指交叉","好","幸运","good","lucky"],k:[38,5],n:["hand_with_index_and_middle_fingers_crossed"],o:4},"flag-ad":{a:"Andorra Flag",b:"1F1E6-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[0,32],o:2,j:["安道尔国旗"]},slightly_smiling_face:{a:"Slightly Smiling Face",b:"1F642",d:!0,e:!0,f:!0,h:!0,j:["浅笑脸","脸","微笑","face","smile"],k:[31,44],l:[":)","(:",":-)"],o:2},apple:{a:"Red Apple",b:"1F34E",d:!0,e:!0,f:!0,h:!0,j:["红苹果","水果","苹果电脑","学校","fruit","mac","school"],k:[6,38],o:2},wc:{a:"Water Closet",b:"1F6BE",d:!0,e:!0,f:!0,h:!0,j:["盥洗室标志","厕所","厕所","蓝色方块","toilet","restroom","blue-square"],k:[36,15],o:2},scarf:{a:"Scarf",b:"1F9E3",d:!0,e:!0,f:!0,h:!0,k:[51,22],o:5,j:["围巾"]},mountain:{a:"Mountain",b:"26F0-FE0F",c:"26F0",d:!0,e:!0,f:!0,h:!0,j:["山","相片","自然界","环境","photo","nature","environment"],k:[54,11],o:2},confetti_ball:{a:"Confetti Ball",b:"1F38A",d:!0,e:!0,f:!0,h:!0,j:["五彩纸屑球","节日","党","生日","马戏团","festival","party","birthday","circus"],k:[7,46],o:2},i_love_you_hand_sign:{skin_variations:{"1F3FB":{unified:"1F91F-1F3FB",non_qualified:null,image:"1f91f-1f3fb.png",sheet_x:38,sheet_y:12,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F91F-1F3FC",non_qualified:null,image:"1f91f-1f3fc.png",sheet_x:38,sheet_y:13,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F91F-1F3FD",non_qualified:null,image:"1f91f-1f3fd.png",sheet_x:38,sheet_y:14,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F91F-1F3FE",non_qualified:null,image:"1f91f-1f3fe.png",sheet_x:38,sheet_y:15,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F91F-1F3FF",non_qualified:null,image:"1f91f-1f3ff.png",sheet_x:38,sheet_y:16,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"I Love You Hand Sign",b:"1F91F",d:!0,e:!0,f:!0,h:!0,k:[38,11],o:5,j:["爱你手势"]},wolf:{a:"Wolf Face",b:"1F43A",d:!0,e:!0,f:!0,h:!0,j:["狼","动物","自然界","野生","animal","nature","wild"],k:[12,30],o:2},gloves:{a:"Gloves",b:"1F9E4",d:!0,e:!0,f:!0,h:!0,k:[51,23],o:5,j:["手套"]},"flag-ae":{a:"United Arab Emirates Flag",b:"1F1E6-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[0,33],o:2,j:["阿拉伯联合酋长国国旗"]},upside_down_face:{a:"Upside-Down Face",b:"1F643",d:!0,e:!0,f:!0,h:!0,j:["倒置的脸","脸","翻转","憨","微笑","face","flipped","silly","smile"],k:[31,45],o:2},green_apple:{a:"Green Apple",b:"1F34F",d:!0,e:!0,f:!0,h:!0,j:["青苹果","水果","自然界","fruit","nature"],k:[6,39],o:2},passport_control:{a:"Passport Control",b:"1F6C2",d:!0,e:!0,f:!0,h:!0,j:["护照查验符号","习惯","蓝色方块","custom","blue-square"],k:[36,24],o:2},volcano:{a:"Volcano",b:"1F30B",d:!0,e:!0,f:!0,h:!0,j:["火山","相片","自然界","灾难","photo","nature","disaster"],k:[5,30],o:2},tanabata_tree:{a:"Tanabata Tree",b:"1F38B",d:!0,e:!0,f:!0,h:!0,j:["七夕树","植物","自然界","分支","夏天","plant","nature","branch","summer"],k:[7,47],o:2},customs:{a:"Customs",b:"1F6C3",d:!0,e:!0,f:!0,h:!0,j:["海关符号","护照","边境","蓝色方块","passport","border","blue-square"],k:[36,25],o:2},coat:{a:"Coat",b:"1F9E5",d:!0,e:!0,f:!0,h:!0,k:[51,24],o:5,j:["大衣"]},wink:{a:"Winking Face",b:"1F609",d:!0,e:!0,f:!0,h:!0,j:["眨眼微笑的脸","脸","快乐","调皮","秘密",";)","微笑","眼睛","face","happy","mischievous","secret",";)","smile","eye"],k:[30,44],l:[";)",";-)"],m:";)",o:2},bamboo:{a:"Pine Decoration",b:"1F38D",d:!0,e:!0,f:!0,h:!0,j:["松木装饰","植物","自然界","蔬菜","熊猫","pine_decoration","plant","nature","vegetable","panda","pine_decoration"],k:[7,49],o:2},"flag-af":{a:"Afghanistan Flag",b:"1F1E6-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[0,34],o:2,j:["阿富汗国旗"]},fox_face:{a:"Fox Face",b:"1F98A",d:!0,e:!0,f:!0,h:!0,j:["狐狸","动物","自然界","脸","animal","nature","face"],k:[42,28],o:4},pear:{a:"Pear",b:"1F350",d:!0,e:!0,f:!0,h:!0,j:["梨","水果","自然界","食物","fruit","nature","food"],k:[6,40],o:2},mount_fuji:{a:"Mount Fuji",b:"1F5FB",d:!0,e:!0,f:!0,h:!0,j:["富士山","相片","山","自然界","日语","photo","mountain","nature","japanese"],k:[30,30],o:2},the_horns:{skin_variations:{"1F3FB":{unified:"1F918-1F3FB",non_qualified:null,image:"1f918-1f3fb.png",sheet_x:37,sheet_y:32,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F918-1F3FC",non_qualified:null,image:"1f918-1f3fc.png",sheet_x:37,sheet_y:33,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F918-1F3FD",non_qualified:null,image:"1f918-1f3fd.png",sheet_x:37,sheet_y:34,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F918-1F3FE",non_qualified:null,image:"1f918-1f3fe.png",sheet_x:37,sheet_y:35,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F918-1F3FF",non_qualified:null,image:"1f918-1f3ff.png",sheet_x:37,sheet_y:36,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Sign of the Horns",b:"1F918",d:!0,e:!0,f:!0,h:!0,k:[37,31],n:["sign_of_the_horns"],o:2,j:["摇滚手势"]},call_me_hand:{skin_variations:{"1F3FB":{unified:"1F919-1F3FB",non_qualified:null,image:"1f919-1f3fb.png",sheet_x:37,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F919-1F3FC",non_qualified:null,image:"1f919-1f3fc.png",sheet_x:37,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F919-1F3FD",non_qualified:null,image:"1f919-1f3fd.png",sheet_x:37,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F919-1F3FE",non_qualified:null,image:"1f919-1f3fe.png",sheet_x:37,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F919-1F3FF",non_qualified:null,image:"1f919-1f3ff.png",sheet_x:37,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Call Me Hand",b:"1F919",d:!0,e:!0,f:!0,h:!0,j:["打电话手势","手","手势","hands","gesture"],k:[37,37],o:4},"flag-ag":{a:"Antigua & Barbuda Flag",b:"1F1E6-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[0,35],o:2,j:["安提瓜和巴布达国旗"]},raccoon:{a:"Raccoon",b:"1F99D",d:!0,e:!0,f:!0,h:!0,k:[42,47],o:11,j:["狸"]},dolls:{a:"Japanese Dolls",b:"1F38E",d:!0,e:!0,f:!0,h:!0,j:["日本娃娃","日语","玩具","和服","japanese","toy","kimono"],k:[7,50],o:2},blush:{a:"Smiling Face with Smiling Eyes",b:"1F60A",d:!0,e:!0,f:!0,h:!0,j:["笑眯眯的脸","脸","微笑","快乐","刷新","粉碎","尴尬","害羞","喜悦","face","smile","happy","flushed","crush","embarrassed","shy","joy"],k:[30,45],m:":)",o:2},peach:{a:"Peach",b:"1F351",d:!0,e:!0,f:!0,h:!0,j:["桃子","水果","自然界","食物","fruit","nature","food"],k:[6,41],o:2},baggage_claim:{a:"Baggage Claim",b:"1F6C4",d:!0,e:!0,f:!0,h:!0,j:["行李认领符号","蓝色方块","飞机场","运输","blue-square","airport","transport"],k:[36,26],o:2},socks:{a:"Socks",b:"1F9E6",d:!0,e:!0,f:!0,h:!0,k:[51,25],o:5,j:["袜子"]},camping:{a:"Camping",b:"1F3D5-FE0F",c:"1F3D5",d:!0,e:!0,f:!0,h:!0,j:["露营","相片","户外","帐篷","photo","outdoors","tent"],k:[10,40],o:2},dress:{a:"Dress",b:"1F457",d:!0,e:!0,f:!0,h:!0,j:["连衣裙","衣服","时尚","购物","clothes","fashion","shopping"],k:[14,11],o:2},beach_with_umbrella:{a:"Beach with Umbrella",b:"1F3D6-FE0F",c:"1F3D6",d:!0,e:!0,f:!0,h:!0,k:[10,41],o:2,j:["海滩伞"]},cherries:{a:"Cherries",b:"1F352",d:!0,e:!0,f:!0,h:!0,j:["樱桃","食物","水果","food","fruit"],k:[6,42],o:2},cat:{a:"Cat Face",b:"1F431",d:!0,e:!0,f:!0,h:!0,j:["猫脸","动物","猫叫声","自然界","宠物","小猫","animal","meow","nature","pet","kitten"],k:[12,21],o:2},point_left:{skin_variations:{"1F3FB":{unified:"1F448-1F3FB",non_qualified:null,image:"1f448-1f3fb.png",sheet_x:13,sheet_y:9,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F448-1F3FC",non_qualified:null,image:"1f448-1f3fc.png",sheet_x:13,sheet_y:10,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F448-1F3FD",non_qualified:null,image:"1f448-1f3fd.png",sheet_x:13,sheet_y:11,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F448-1F3FE",non_qualified:null,image:"1f448-1f3fe.png",sheet_x:13,sheet_y:12,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F448-1F3FF",non_qualified:null,image:"1f448-1f3ff.png",sheet_x:13,sheet_y:13,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"White Left Pointing Backhand Index",b:"1F448",d:!0,e:!0,f:!0,h:!0,j:["食指向左","方向","手指","手","左","direction","fingers","hand","left"],k:[13,8],o:2},left_luggage:{a:"Left Luggage",b:"1F6C5",d:!0,e:!0,f:!0,h:!0,j:["寄放行李符号","蓝色方块","旅行","blue-square","travel"],k:[36,27],o:2},"flag-ai":{a:"Anguilla Flag",b:"1F1E6-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[0,36],o:2,j:["安圭拉国旗"]},innocent:{a:"Smiling Face with Halo",b:"1F607",d:!0,e:!0,f:!0,h:!0,j:["头顶光环的笑脸","脸","天使","天堂","光环","face","angel","heaven","halo"],k:[30,42],o:2},flags:{a:"Carp Streamer",b:"1F38F",d:!0,e:!0,f:!0,h:!0,j:["鲤鱼旗","鱼","日语","小野堀","鲤鱼","旗帜","fish","japanese","koinobori","carp","banner"],k:[7,51],o:2},warning:{a:"Warning Sign",b:"26A0-FE0F",c:"26A0",d:!0,e:!0,f:!0,h:!0,j:["警告","惊叹号","维普","警报","错误","问题","问题","exclamation","wip","alert","error","problem","issue"],k:[53,50],o:2},strawberry:{a:"Strawberry",b:"1F353",d:!0,e:!0,f:!0,h:!0,j:["草莓","水果","食物","自然界","fruit","food","nature"],k:[6,43],o:2},point_right:{skin_variations:{"1F3FB":{unified:"1F449-1F3FB",non_qualified:null,image:"1f449-1f3fb.png",sheet_x:13,sheet_y:15,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F449-1F3FC",non_qualified:null,image:"1f449-1f3fc.png",sheet_x:13,sheet_y:16,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F449-1F3FD",non_qualified:null,image:"1f449-1f3fd.png",sheet_x:13,sheet_y:17,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F449-1F3FE",non_qualified:null,image:"1f449-1f3fe.png",sheet_x:13,sheet_y:18,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F449-1F3FF",non_qualified:null,image:"1f449-1f3ff.png",sheet_x:13,sheet_y:19,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"White Right Pointing Backhand Index",b:"1F449",d:!0,e:!0,f:!0,h:!0,j:["食指向右","手指","手","方向","右","fingers","hand","direction","right"],k:[13,14],o:2},desert:{a:"Desert",b:"1F3DC-FE0F",c:"1F3DC",d:!0,e:!0,f:!0,h:!0,j:["沙漠","相片","温暖","有效","photo","warm","saharah"],k:[10,47],o:2},kimono:{a:"Kimono",b:"1F458",d:!0,e:!0,f:!0,h:!0,j:["和服","连衣裙","时尚","女人","女性","日语","dress","fashion","women","female","japanese"],k:[14,12],o:2},"flag-al":{a:"Albania Flag",b:"1F1E6-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[0,37],o:2,j:["阿尔巴尼亚国旗"]},wind_chime:{a:"Wind Chime",b:"1F390",d:!0,e:!0,f:!0,h:!0,j:["风铃","自然界","东西","春天","钟","nature","ding","spring","bell"],k:[7,52],o:2},smiling_face_with_3_hearts:{a:"Smiling Face with Smiling Eyes and Three Hearts",b:"1F970",d:!0,e:!0,f:!0,h:!0,k:[42,6],o:11,j:["被爱的脸"]},cat2:{a:"Cat",b:"1F408",d:!0,e:!0,f:!0,h:!0,j:["猫","动物","猫叫声","宠物","猫","animal","meow","pet","cats"],k:[11,36],o:2},rice_scene:{a:"Moon Viewing Ceremony",b:"1F391",d:!0,e:!0,f:!0,h:!0,j:["赏月仪式","相片","日本","亚洲","月见","photo","japan","asia","tsukimi"],k:[7,53],o:2},heart_eyes:{a:"Smiling Face with Heart-Shaped Eyes",b:"1F60D",d:!0,e:!0,f:!0,h:!0,j:["眼冒爱心的脸","脸","爱","喜欢","感情","情人","迷恋","粉碎","心","face","love","like","affection","valentines","infatuation","crush","heart"],k:[30,48],o:2},sari:{a:"Sari",b:"1F97B",d:!0,e:!0,f:!0,h:!0,k:[42,13],o:12,j:["纱丽"]},"flag-am":{a:"Armenia Flag",b:"1F1E6-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[0,38],o:2,j:["亚美尼亚国旗"]},lion_face:{a:"Lion Face",b:"1F981",d:!0,e:!0,f:!0,h:!0,k:[42,19],o:2,j:["狮子"]},desert_island:{a:"Desert Island",b:"1F3DD-FE0F",c:"1F3DD",d:!0,e:!0,f:!0,h:!0,j:["沙漠荒岛","相片","热带","莫吉托","photo","tropical","mojito"],k:[10,48],o:2},point_up_2:{skin_variations:{"1F3FB":{unified:"1F446-1F3FB",non_qualified:null,image:"1f446-1f3fb.png",sheet_x:12,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F446-1F3FC",non_qualified:null,image:"1f446-1f3fc.png",sheet_x:12,sheet_y:55,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F446-1F3FD",non_qualified:null,image:"1f446-1f3fd.png",sheet_x:12,sheet_y:56,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F446-1F3FE",non_qualified:null,image:"1f446-1f3fe.png",sheet_x:13,sheet_y:0,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F446-1F3FF",non_qualified:null,image:"1f446-1f3ff.png",sheet_x:13,sheet_y:1,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"White Up Pointing Backhand Index",b:"1F446",d:!0,e:!0,f:!0,h:!0,j:["食指向上","手指","手","方向","向上","fingers","hand","direction","up"],k:[12,53],o:2},kiwifruit:{a:"Kiwifruit",b:"1F95D",d:!0,e:!0,f:!0,h:!0,k:[41,44],o:4,j:["猕猴桃"]},children_crossing:{a:"Children Crossing",b:"1F6B8",d:!0,e:!0,f:!0,h:!0,j:["孩童穿越","学校","警告","危险","标志","驾驶","黄色钻石","school","warning","danger","sign","driving","yellow-diamond"],k:[36,9],o:2},national_park:{a:"National Park",b:"1F3DE-FE0F",c:"1F3DE",d:!0,e:!0,f:!0,h:!0,j:["国家公园","相片","环境","自然界","photo","environment","nature"],k:[10,49],o:2},no_entry:{a:"No Entry",b:"26D4",d:!0,e:!0,f:!0,h:!0,j:["禁止入内","限制","安全","隐私","坏","否认","停","圈","limit","security","privacy","bad","denied","stop","circle"],k:[54,8],o:2},"one-piece_swimsuit":{a:"One-Piece Swimsuit",b:"1FA71",d:!0,e:!0,f:!0,h:!0,k:[51,52],o:12,j:["连身泳衣"]},tiger:{a:"Tiger Face",b:"1F42F",d:!0,e:!0,f:!0,h:!0,j:["老虎脸","动物","猫","危险","野生","自然界","吼","animal","cat","danger","wild","nature","roar"],k:[12,19],o:2},red_envelope:{a:"Red Gift Envelope",b:"1F9E7",d:!0,e:!0,f:!0,h:!0,k:[51,26],o:11,j:["红包"]},"star-struck":{a:"Grinning Face with Star Eyes",b:"1F929",d:!0,e:!0,f:!0,h:!0,k:[38,43],n:["grinning_face_with_star_eyes"],o:5,j:["明星来袭"]},middle_finger:{skin_variations:{"1F3FB":{unified:"1F595-1F3FB",non_qualified:null,image:"1f595-1f3fb.png",sheet_x:29,sheet_y:55,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F595-1F3FC",non_qualified:null,image:"1f595-1f3fc.png",sheet_x:29,sheet_y:56,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F595-1F3FD",non_qualified:null,image:"1f595-1f3fd.png",sheet_x:30,sheet_y:0,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F595-1F3FE",non_qualified:null,image:"1f595-1f3fe.png",sheet_x:30,sheet_y:1,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F595-1F3FF",non_qualified:null,image:"1f595-1f3ff.png",sheet_x:30,sheet_y:2,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Reversed Hand with Middle Finger Extended",b:"1F595",d:!0,e:!0,f:!0,h:!0,k:[29,54],n:["reversed_hand_with_middle_finger_extended"],o:2,j:["比中指"]},"flag-ao":{a:"Angola Flag",b:"1F1E6-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[0,39],o:2,j:["安哥拉国旗"]},tomato:{a:"Tomato",b:"1F345",d:!0,e:!0,f:!0,h:!0,j:["番茄","水果","蔬菜","自然界","食物","fruit","vegetable","nature","food"],k:[6,29],o:2},coconut:{a:"Coconut",b:"1F965",d:!0,e:!0,f:!0,h:!0,k:[41,52],o:5,j:["椰子"]},ribbon:{a:"Ribbon",b:"1F380",d:!0,e:!0,f:!0,h:!0,j:["丝带","装饰","粉红色","女孩","领结","decoration","pink","girl","bowtie"],k:[7,31],o:2},no_entry_sign:{a:"No Entry Sign",b:"1F6AB",d:!0,e:!0,f:!0,h:!0,j:["禁止符号","禁止","停","限制","否认","禁止","圈","forbid","stop","limit","denied","disallow","circle"],k:[35,2],o:2},point_down:{skin_variations:{"1F3FB":{unified:"1F447-1F3FB",non_qualified:null,image:"1f447-1f3fb.png",sheet_x:13,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F447-1F3FC",non_qualified:null,image:"1f447-1f3fc.png",sheet_x:13,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F447-1F3FD",non_qualified:null,image:"1f447-1f3fd.png",sheet_x:13,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F447-1F3FE",non_qualified:null,image:"1f447-1f3fe.png",sheet_x:13,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F447-1F3FF",non_qualified:null,image:"1f447-1f3ff.png",sheet_x:13,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"White Down Pointing Backhand Index",b:"1F447",d:!0,e:!0,f:!0,h:!0,j:["食指向下","手指","手","方向","下","fingers","hand","direction","down"],k:[13,2],o:2},"flag-aq":{a:"Antarctica Flag",b:"1F1E6-1F1F6",d:!0,e:!0,f:!0,h:!0,k:[0,40],o:2,j:["南极洲旗"]},briefs:{a:"Briefs",b:"1FA72",d:!0,e:!0,f:!0,h:!0,k:[51,53],o:12,j:["三角泳裤"]},kissing_heart:{a:"Face Throwing a Kiss",b:"1F618",d:!0,e:!0,f:!0,h:!0,j:["飞吻的脸","脸","爱","喜欢","感情","情人","迷恋","吻","face","love","like","affection","valentines","infatuation","kiss"],k:[31,2],l:[":*",":-*"],o:2},tiger2:{a:"Tiger",b:"1F405",d:!0,e:!0,f:!0,h:!0,j:["虎","动物","自然界","吼","animal","nature","roar"],k:[11,33],o:2},stadium:{a:"Stadium",b:"1F3DF-FE0F",c:"1F3DF",d:!0,e:!0,f:!0,h:!0,j:["体育场","相片","地方","体育","音乐会","场地","photo","place","sports","concert","venue"],k:[10,50],o:2},leopard:{a:"Leopard",b:"1F406",d:!0,e:!0,f:!0,h:!0,j:["豹","动物","自然界","animal","nature"],k:[11,34],o:2},no_bicycles:{a:"No Bicycles",b:"1F6B3",d:!0,e:!0,f:!0,h:!0,j:["自行车禁行","骑 单车","禁止","圈","cyclist","prohibited","circle"],k:[35,10],o:2},kissing:{a:"Kissing Face",b:"1F617",d:!0,e:!0,f:!0,h:!0,j:["接吻的脸","爱","喜欢","脸","3","情人","迷恋","吻","love","like","face","3","valentines","infatuation","kiss"],k:[31,1],o:2},"flag-ar":{a:"Argentina Flag",b:"1F1E6-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[0,41],o:2,j:["阿根廷国旗"]},avocado:{a:"Avocado",b:"1F951",d:!0,e:!0,f:!0,h:!0,j:["牛油果","水果","食物","fruit","food"],k:[41,32],o:4},point_up:{skin_variations:{"1F3FB":{unified:"261D-1F3FB",non_qualified:null,image:"261d-1f3fb.png",sheet_x:53,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"261D-1F3FC",non_qualified:null,image:"261d-1f3fc.png",sheet_x:53,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"261D-1F3FD",non_qualified:null,image:"261d-1f3fd.png",sheet_x:53,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"261D-1F3FE",non_qualified:null,image:"261d-1f3fe.png",sheet_x:53,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"261D-1F3FF",non_qualified:null,image:"261d-1f3ff.png",sheet_x:53,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"White Up Pointing Index",b:"261D-FE0F",c:"261D",d:!0,e:!0,f:!0,h:!0,j:["食指向上","手","手指","方向","向上","hand","fingers","direction","up"],k:[53,2],o:2},gift:{a:"Wrapped Present",b:"1F381",d:!0,e:!0,f:!0,h:!0,j:["包装的礼物","目前","生日","圣诞节","圣诞","present","birthday","christmas","xmas"],k:[7,32],o:2},classical_building:{a:"Classical Building",b:"1F3DB-FE0F",c:"1F3DB",d:!0,e:!0,f:!0,h:!0,j:["古典建筑","艺术","文化","历史","art","culture","history"],k:[10,46],o:2},shorts:{a:"Shorts",b:"1FA73",d:!0,e:!0,f:!0,h:!0,k:[51,54],o:12,j:["短裤"]},"+1":{skin_variations:{"1F3FB":{unified:"1F44D-1F3FB",non_qualified:null,image:"1f44d-1f3fb.png",sheet_x:13,sheet_y:39,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F44D-1F3FC",non_qualified:null,image:"1f44d-1f3fc.png",sheet_x:13,sheet_y:40,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F44D-1F3FD",non_qualified:null,image:"1f44d-1f3fd.png",sheet_x:13,sheet_y:41,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F44D-1F3FE",non_qualified:null,image:"1f44d-1f3fe.png",sheet_x:13,sheet_y:42,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F44D-1F3FF",non_qualified:null,image:"1f44d-1f3ff.png",sheet_x:13,sheet_y:43,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Thumbs Up Sign",b:"1F44D",d:!0,e:!0,f:!0,h:!0,j:["比赞","竖起大拇指","是的","棒","好","同意","接受","凉","手","喜欢","thumbsup","yes","awesome","good","agree","accept","cool","hand","like"],k:[13,38],n:["thumbsup"],o:2},horse:{a:"Horse Face",b:"1F434",d:!0,e:!0,f:!0,h:!0,j:["马面","动物","棕色","自然界","animal","brown","nature"],k:[12,24],o:2},bikini:{a:"Bikini",b:"1F459",d:!0,e:!0,f:!0,h:!0,j:["比基尼泳装","游泳","女性","女人","女孩","时尚","海滩","夏天","swimming","female","woman","girl","fashion","beach","summer"],k:[14,13],o:2},no_smoking:{a:"No Smoking Symbol",b:"1F6AD",d:!0,e:!0,f:!0,h:!0,j:["禁止抽烟","香烟","蓝色方块","气味","烟","cigarette","blue-square","smell","smoke"],k:[35,4],o:2},eggplant:{a:"Aubergine",b:"1F346",d:!0,e:!0,f:!0,h:!0,j:["茄子","蔬菜","自然界","食物","茄子","vegetable","nature","food","aubergine"],k:[6,30],o:2},"flag-as":{a:"American Samoa Flag",b:"1F1E6-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[0,42],o:2,j:["美属萨摩亚旗"]},reminder_ribbon:{a:"Reminder Ribbon",b:"1F397-FE0F",c:"1F397",d:!0,e:!0,f:!0,h:!0,j:["丝带","体育","原因","支持","意识","sports","cause","support","awareness"],k:[8,0],o:2},building_construction:{a:"Building Construction",b:"1F3D7-FE0F",c:"1F3D7",d:!0,e:!0,f:!0,h:!0,j:["建筑施工","维普","加工","进展","wip","working","progress"],k:[10,42],o:2},relaxed:{a:"White Smiling Face",b:"263A-FE0F",c:"263A",d:!0,e:!0,f:!0,h:!0,j:["微笑的脸","脸","脸红","按摩","幸福","face","blush","massage","happiness"],k:[53,17],o:2},kissing_closed_eyes:{a:"Kissing Face with Closed Eyes",b:"1F61A",d:!0,e:!0,f:!0,h:!0,j:["闭着眼睛接吻的脸","脸","爱","喜欢","感情","情人","迷恋","吻","face","love","like","affection","valentines","infatuation","kiss"],k:[31,4],o:2},"-1":{skin_variations:{"1F3FB":{unified:"1F44E-1F3FB",non_qualified:null,image:"1f44e-1f3fb.png",sheet_x:13,sheet_y:45,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F44E-1F3FC",non_qualified:null,image:"1f44e-1f3fc.png",sheet_x:13,sheet_y:46,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F44E-1F3FD",non_qualified:null,image:"1f44e-1f3fd.png",sheet_x:13,sheet_y:47,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F44E-1F3FE",non_qualified:null,image:"1f44e-1f3fe.png",sheet_x:13,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F44E-1F3FF",non_qualified:null,image:"1f44e-1f3ff.png",sheet_x:13,sheet_y:49,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Thumbs Down Sign",b:"1F44E",d:!0,e:!0,f:!0,h:!0,j:["倒赞","拇指下","不","讨厌","手","thumbsdown","no","dislike","hand"],k:[13,44],n:["thumbsdown"],o:2},admission_tickets:{a:"Admission Tickets",b:"1F39F-FE0F",c:"1F39F",d:!0,e:!0,f:!0,h:!0,k:[8,5],o:2,j:["门票"]},"flag-at":{a:"Austria Flag",b:"1F1E6-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[0,43],o:2,j:["奥地利国旗"]},womans_clothes:{a:"Womans Clothes",b:"1F45A",d:!0,e:!0,f:!0,h:!0,j:["衬衫","时尚","shopping_bags","女性","fashion","shopping_bags","female"],k:[14,14],o:2},do_not_litter:{a:"Do Not Litter Symbol",b:"1F6AF",d:!0,e:!0,f:!0,h:!0,j:["不乱扔垃圾","垃圾","是","垃圾","圈","trash","bin","garbage","circle"],k:[35,6],o:2},potato:{a:"Potato",b:"1F954",d:!0,e:!0,f:!0,h:!0,j:["土豆","食物","块茎","可素食","淀粉","food","tuber","vegatable","starch"],k:[41,35],o:4},racehorse:{a:"Horse",b:"1F40E",d:!0,e:!0,f:!0,h:!0,j:["马","动物","赌博","运气","animal","gamble","luck"],k:[11,42],o:2},bricks:{a:"Brick",b:"1F9F1",d:!0,e:!0,f:!0,h:!0,k:[51,36],o:11,j:["砖"]},fist:{skin_variations:{"1F3FB":{unified:"270A-1F3FB",non_qualified:null,image:"270a-1f3fb.png",sheet_x:54,sheet_y:44,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"270A-1F3FC",non_qualified:null,image:"270a-1f3fc.png",sheet_x:54,sheet_y:45,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"270A-1F3FD",non_qualified:null,image:"270a-1f3fd.png",sheet_x:54,sheet_y:46,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"270A-1F3FE",non_qualified:null,image:"270a-1f3fe.png",sheet_x:54,sheet_y:47,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"270A-1F3FF",non_qualified:null,image:"270a-1f3ff.png",sheet_x:54,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Raised Fist",b:"270A",d:!0,e:!0,f:!0,h:!0,j:["举拳","手指","手","把握","fingers","hand","grasp"],k:[54,43],o:2},house_buildings:{a:"House Buildings",b:"1F3D8-FE0F",c:"1F3D8",d:!0,e:!0,f:!0,h:!0,k:[10,43],o:2,j:["房屋群"]},carrot:{a:"Carrot",b:"1F955",d:!0,e:!0,f:!0,h:!0,j:["胡萝卜","蔬菜","食物","橙","vegetable","food","orange"],k:[41,36],o:4},ticket:{a:"Ticket",b:"1F3AB",d:!0,e:!0,f:!0,h:!0,j:["票","事件","音乐会","通过","event","concert","pass"],k:[8,17],o:2},"flag-au":{a:"Australia Flag",b:"1F1E6-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[0,44],o:2,j:["澳大利亚国旗"]},"non-potable_water":{a:"Non-Potable Water Symbol",b:"1F6B1",d:!0,e:!0,f:!0,h:!0,j:["非饮用水","喝","龙头","水龙头","圈","drink","faucet","tap","circle"],k:[35,8],o:2},purse:{a:"Purse",b:"1F45B",d:!0,e:!0,f:!0,h:!0,j:["钱包","时尚","辅料","钱","销售","购物","fashion","accessories","money","sales","shopping"],k:[14,15],o:2},unicorn_face:{a:"Unicorn Face",b:"1F984",d:!0,e:!0,f:!0,h:!0,k:[42,22],o:2,j:["独角兽"]},kissing_smiling_eyes:{a:"Kissing Face with Smiling Eyes",b:"1F619",d:!0,e:!0,f:!0,h:!0,j:["含笑亲吻表情","脸","感情","情人","迷恋","吻","face","affection","valentines","infatuation","kiss"],k:[31,3],o:2},facepunch:{skin_variations:{"1F3FB":{unified:"1F44A-1F3FB",non_qualified:null,image:"1f44a-1f3fb.png",sheet_x:13,sheet_y:21,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F44A-1F3FC",non_qualified:null,image:"1f44a-1f3fc.png",sheet_x:13,sheet_y:22,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F44A-1F3FD",non_qualified:null,image:"1f44a-1f3fd.png",sheet_x:13,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F44A-1F3FE",non_qualified:null,image:"1f44a-1f3fe.png",sheet_x:13,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F44A-1F3FF",non_qualified:null,image:"1f44a-1f3ff.png",sheet_x:13,sheet_y:25,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Fisted Hand Sign",b:"1F44A",d:!0,e:!0,f:!0,h:!0,j:["伸出直拳","生气","暴力","拳头","打","攻击","手","angry","violence","fist","hit","attack","hand"],k:[13,20],n:["punch"],o:2},medal:{a:"Medal",b:"1F396-FE0F",c:"1F396",d:!0,e:!0,f:!0,h:!0,k:[7,56],o:2,j:["军功徽章"]},zebra_face:{a:"Zebra Face",b:"1F993",d:!0,e:!0,f:!0,h:!0,k:[42,37],o:5,j:["斑马"]},handbag:{a:"Handbag",b:"1F45C",d:!0,e:!0,f:!0,h:!0,j:["手提包","时尚","附属品","辅料","购物","fashion","accessory","accessories","shopping"],k:[14,16],o:2},derelict_house_building:{a:"Derelict House Building",b:"1F3DA-FE0F",c:"1F3DA",d:!0,e:!0,f:!0,h:!0,k:[10,45],o:2,j:["废弃屋"]},yum:{a:"Face Savouring Delicious Food",b:"1F60B",d:!0,e:!0,f:!0,h:!0,j:["美味表情","快乐","喜悦","舌","微笑","脸","憨","美味","名字","美味","品尝","happy","joy","tongue","smile","face","silly","yummy","nom","delicious","savouring"],k:[30,46],o:2},corn:{a:"Ear of Maize",b:"1F33D",d:!0,e:!0,f:!0,h:!0,j:["玉米穗","食物","蔬菜","植物","food","vegetable","plant"],k:[6,21],o:2},"flag-aw":{a:"Aruba Flag",b:"1F1E6-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[0,45],o:2,j:["阿鲁巴国旗"]},no_pedestrians:{a:"No Pedestrians",b:"1F6B7",d:!0,e:!0,f:!0,h:!0,j:["行人禁止通行","规则","路口","走","圈","rules","crossing","walking","circle"],k:[36,8],o:2},house:{a:"House Building",b:"1F3E0",d:!0,e:!0,f:!0,h:!0,j:["房屋","建筑","家","building","home"],k:[10,51],o:2},hot_pepper:{a:"Hot Pepper",b:"1F336-FE0F",c:"1F336",d:!0,e:!0,f:!0,h:!0,j:["辣椒","食物","辣","辣椒","智利","food","spicy","chilli","chili"],k:[6,14],o:2},"flag-ax":{a:"Åland Islands Flag",b:"1F1E6-1F1FD",d:!0,e:!0,f:!0,h:!0,k:[0,46],o:2,j:["奥兰群岛旗"]},trophy:{a:"Trophy",b:"1F3C6",d:!0,e:!0,f:!0,h:!0,j:["奖杯","赢","奖","比赛","地方","英尺宽","仪式","win","award","contest","place","ftw","ceremony"],k:[9,26],o:2},deer:{a:"Deer",b:"1F98C",d:!0,e:!0,f:!0,h:!0,j:["鹿","动物","自然界","角","鹿肉","animal","nature","horns","venison"],k:[42,30],o:4},"left-facing_fist":{skin_variations:{"1F3FB":{unified:"1F91B-1F3FB",non_qualified:null,image:"1f91b-1f3fb.png",sheet_x:37,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F91B-1F3FC",non_qualified:null,image:"1f91b-1f3fc.png",sheet_x:37,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F91B-1F3FD",non_qualified:null,image:"1f91b-1f3fd.png",sheet_x:37,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F91B-1F3FE",non_qualified:null,image:"1f91b-1f3fe.png",sheet_x:37,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F91B-1F3FF",non_qualified:null,image:"1f91b-1f3ff.png",sheet_x:37,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Left-Facing Fist",b:"1F91B",d:!0,e:!0,f:!0,h:!0,k:[37,49],o:4,j:["伸出左拳"]},stuck_out_tongue:{a:"Face with Stuck-out Tongue",b:"1F61B",d:!0,e:!0,f:!0,h:!0,j:["吐舌","脸","恶作剧","幼稚","好玩","调皮","微笑","舌","face","prank","childish","playful","mischievous","smile","tongue"],k:[31,5],l:[":p",":-p",":P",":-P",":b",":-b"],m:":p",o:2},pouch:{a:"Pouch",b:"1F45D",d:!0,e:!0,f:!0,h:!0,j:["手拿包","袋","辅料","购物","bag","accessories","shopping"],k:[14,17],o:2},no_mobile_phones:{a:"No Mobile Phones",b:"1F4F5",d:!0,e:!0,f:!0,h:!0,j:["手机禁止","苹果手机","静音","圈","iphone","mute","circle"],k:[27,18],o:2},stuck_out_tongue_winking_eye:{a:"Face with Stuck-out Tongue and Winking Eye",b:"1F61C",d:!0,e:!0,f:!0,h:!0,j:["眨眼吐舌","脸","恶作剧","幼稚","好玩","调皮","微笑","眨眼","舌","face","prank","childish","playful","mischievous","smile","wink","tongue"],k:[31,6],l:[";p",";-p",";b",";-b",";P",";-P"],m:";p",o:2},sports_medal:{a:"Sports Medal",b:"1F3C5",d:!0,e:!0,f:!0,h:!0,k:[9,25],o:2,j:["体育奖章"]},cucumber:{a:"Cucumber",b:"1F952",d:!0,e:!0,f:!0,h:!0,j:["黄瓜","水果","食物","泡菜","fruit","food","pickle"],k:[41,33],o:4},cow:{a:"Cow Face",b:"1F42E",d:!0,e:!0,f:!0,h:!0,j:["奶牛脸","牛肉","牛","动物","自然界","哞","牛奶","beef","ox","animal","nature","moo","milk"],k:[12,18],o:2},underage:{a:"No One Under Eighteen Symbol",b:"1F51E",d:!0,e:!0,f:!0,h:!0,j:["未满十八","18","喝","酒馆","晚上","次要","圈","18","drink","pub","night","minor","circle"],k:[28,1],o:2},"flag-az":{a:"Azerbaijan Flag",b:"1F1E6-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[0,47],o:2,j:["阿塞拜疆国旗"]},shopping_bags:{a:"Shopping Bags",b:"1F6CD-FE0F",c:"1F6CD",d:!0,e:!0,f:!0,h:!0,k:[36,35],o:2,j:["购物袋"]},"right-facing_fist":{skin_variations:{"1F3FB":{unified:"1F91C-1F3FB",non_qualified:null,image:"1f91c-1f3fb.png",sheet_x:37,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F91C-1F3FC",non_qualified:null,image:"1f91c-1f3fc.png",sheet_x:38,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F91C-1F3FD",non_qualified:null,image:"1f91c-1f3fd.png",sheet_x:38,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F91C-1F3FE",non_qualified:null,image:"1f91c-1f3fe.png",sheet_x:38,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F91C-1F3FF",non_qualified:null,image:"1f91c-1f3ff.png",sheet_x:38,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Right-Facing Fist",b:"1F91C",d:!0,e:!0,f:!0,h:!0,k:[37,55],o:4,j:["伸出右拳"]},house_with_garden:{a:"House with Garden",b:"1F3E1",d:!0,e:!0,f:!0,h:!0,j:["带花园的房子","家","植物","自然界","home","plant","nature"],k:[10,52],o:2},clap:{skin_variations:{"1F3FB":{unified:"1F44F-1F3FB",non_qualified:null,image:"1f44f-1f3fb.png",sheet_x:13,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F44F-1F3FC",non_qualified:null,image:"1f44f-1f3fc.png",sheet_x:13,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F44F-1F3FD",non_qualified:null,image:"1f44f-1f3fd.png",sheet_x:13,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F44F-1F3FE",non_qualified:null,image:"1f44f-1f3fe.png",sheet_x:13,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F44F-1F3FF",non_qualified:null,image:"1f44f-1f3ff.png",sheet_x:13,sheet_y:55,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Clapping Hands Sign",b:"1F44F",d:!0,e:!0,f:!0,h:!0,j:["热烈拍手","手","赞美","掌声","恭喜","耶","hands","praise","applause","congrats","yay"],k:[13,50],o:2},leafy_green:{a:"Leafy Green",b:"1F96C",d:!0,e:!0,f:!0,h:!0,k:[42,2],o:11,j:["绿叶菜"]},office:{a:"Office Building",b:"1F3E2",d:!0,e:!0,f:!0,h:!0,j:["办公楼","建筑","局","工作","building","bureau","work"],k:[10,53],o:2},"flag-ba":{a:"Bosnia & Herzegovina Flag",b:"1F1E7-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[0,48],o:2,j:["波斯尼亚和黑塞哥维那国旗"]},zany_face:{a:"Grinning Face with One Large and One Small Eye",b:"1F92A",d:!0,e:!0,f:!0,h:!0,k:[38,44],n:["grinning_face_with_one_large_and_one_small_eye"],o:5,j:["滑稽的脸"]},first_place_medal:{a:"First Place Medal",b:"1F947",d:!0,e:!0,f:!0,h:!0,k:[41,22],o:4,j:["金牌"]},ox:{a:"Ox",b:"1F402",d:!0,e:!0,f:!0,h:!0,j:["牛","动物","牛","牛肉","animal","cow","beef"],k:[11,30],o:2},school_satchel:{a:"School Satchel",b:"1F392",d:!0,e:!0,f:!0,h:!0,j:["背包","学生","教育","袋","背包","student","education","bag","backpack"],k:[7,54],o:2},radioactive_sign:{a:"Radioactive Sign",b:"2622-FE0F",c:"2622",d:!0,e:!0,f:!0,h:!0,k:[53,9],o:2,j:["放射性的符号"]},second_place_medal:{a:"Second Place Medal",b:"1F948",d:!0,e:!0,f:!0,h:!0,k:[41,23],o:4,j:["银牌"]},stuck_out_tongue_closed_eyes:{a:"Face with Stuck-out Tongue and Tightly-Closed Eyes",b:"1F61D",d:!0,e:!0,f:!0,h:!0,j:["眯眼吐舌头","脸","恶作剧","好玩","调皮","微笑","舌","face","prank","playful","mischievous","smile","tongue"],k:[31,7],o:2},broccoli:{a:"Broccoli",b:"1F966",d:!0,e:!0,f:!0,h:!0,k:[41,53],o:5,j:["西兰花"]},biohazard_sign:{a:"Biohazard Sign",b:"2623-FE0F",c:"2623",d:!0,e:!0,f:!0,h:!0,k:[53,10],o:2,j:["生物危害符号"]},mans_shoe:{a:"Mans Shoe",b:"1F45E",d:!0,e:!0,f:!0,h:!0,j:["男鞋","时尚","雄","fashion","male"],k:[14,18],n:["shoe"],o:2},raised_hands:{skin_variations:{"1F3FB":{unified:"1F64C-1F3FB",non_qualified:null,image:"1f64c-1f3fb.png",sheet_x:33,sheet_y:9,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64C-1F3FC",non_qualified:null,image:"1f64c-1f3fc.png",sheet_x:33,sheet_y:10,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64C-1F3FD",non_qualified:null,image:"1f64c-1f3fd.png",sheet_x:33,sheet_y:11,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64C-1F3FE",non_qualified:null,image:"1f64c-1f3fe.png",sheet_x:33,sheet_y:12,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64C-1F3FF",non_qualified:null,image:"1f64c-1f3ff.png",sheet_x:33,sheet_y:13,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Person Raising Both Hands in Celebration",b:"1F64C",d:!0,e:!0,f:!0,h:!0,j:["举起双手","手势","万岁","是的","庆祝","手","gesture","hooray","yea","celebration","hands"],k:[33,8],o:2},post_office:{a:"Japanese Post Office",b:"1F3E3",d:!0,e:!0,f:!0,h:!0,j:["日本邮局","建筑","信封","通信","building","envelope","communication"],k:[10,54],o:2},"flag-bb":{a:"Barbados Flag",b:"1F1E7-1F1E7",d:!0,e:!0,f:!0,h:!0,k:[0,49],o:2,j:["巴巴多斯国旗"]},water_buffalo:{a:"Water Buffalo",b:"1F403",d:!0,e:!0,f:!0,h:!0,j:["水牛","动物","自然界","牛","牛","animal","nature","ox","cow"],k:[11,31],o:2},third_place_medal:{a:"Third Place Medal",b:"1F949",d:!0,e:!0,f:!0,h:!0,k:[41,24],o:4,j:["铜牌"]},european_post_office:{a:"European Post Office",b:"1F3E4",d:!0,e:!0,f:!0,h:!0,j:["邮政局","建筑","电子邮件","building","email"],k:[10,55],o:2},athletic_shoe:{a:"Athletic Shoe",b:"1F45F",d:!0,e:!0,f:!0,h:!0,j:["跑鞋","鞋","体育","球鞋","shoes","sports","sneakers"],k:[14,19],o:2},arrow_up:{a:"Upwards Black Arrow",b:"2B06-FE0F",c:"2B06",d:!0,e:!0,f:!0,h:!0,j:["向上箭头","蓝色方块","继续","返回页首","方向","blue-square","continue","top","direction"],k:[55,38],o:2},cow2:{a:"Cow",b:"1F404",d:!0,e:!0,f:!0,h:!0,j:["奶牛","牛肉","牛","动物","自然界","哞","牛奶","beef","ox","animal","nature","moo","milk"],k:[11,32],o:2},open_hands:{skin_variations:{"1F3FB":{unified:"1F450-1F3FB",non_qualified:null,image:"1f450-1f3fb.png",sheet_x:14,sheet_y:0,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F450-1F3FC",non_qualified:null,image:"1f450-1f3fc.png",sheet_x:14,sheet_y:1,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F450-1F3FD",non_qualified:null,image:"1f450-1f3fd.png",sheet_x:14,sheet_y:2,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F450-1F3FE",non_qualified:null,image:"1f450-1f3fe.png",sheet_x:14,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F450-1F3FF",non_qualified:null,image:"1f450-1f3ff.png",sheet_x:14,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Open Hands Sign",b:"1F450",d:!0,e:!0,f:!0,h:!0,j:["双手展开","手指","蝴蝶","手","打开","fingers","butterfly","hands","open"],k:[13,56],o:2},garlic:{a:"Garlic",b:"1F9C4",d:!0,e:!0,f:!0,h:!0,k:[44,12],o:12,j:["大蒜"]},money_mouth_face:{a:"Money-Mouth Face",b:"1F911",d:!0,e:!0,f:!0,h:!0,j:["吐钱脸","脸","富","美元","钱","face","rich","dollar","money"],k:[37,24],o:2},"flag-bd":{a:"Bangladesh Flag",b:"1F1E7-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[0,50],o:2,j:["孟加拉国国旗"]},soccer:{a:"Soccer Ball",b:"26BD",d:!0,e:!0,f:!0,h:!0,j:["足球","体育","足球","sports","football"],k:[53,56],o:2},hugging_face:{a:"Hugging Face",b:"1F917",d:!0,e:!0,f:!0,h:!0,k:[37,30],o:2,j:["拥抱脸"]},onion:{a:"Onion",b:"1F9C5",d:!0,e:!0,f:!0,h:!0,k:[44,13],o:12,j:["洋葱"]},arrow_upper_right:{a:"North East Arrow",b:"2197-FE0F",c:"2197",d:!0,e:!0,f:!0,h:!0,j:["右上方的箭头","蓝色方块","点","方向","对角","东北","blue-square","point","direction","diagonal","northeast"],k:[52,17],o:2},palms_up_together:{skin_variations:{"1F3FB":{unified:"1F932-1F3FB",non_qualified:null,image:"1f932-1f3fb.png",sheet_x:39,sheet_y:6,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F932-1F3FC",non_qualified:null,image:"1f932-1f3fc.png",sheet_x:39,sheet_y:7,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F932-1F3FD",non_qualified:null,image:"1f932-1f3fd.png",sheet_x:39,sheet_y:8,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F932-1F3FE",non_qualified:null,image:"1f932-1f3fe.png",sheet_x:39,sheet_y:9,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F932-1F3FF",non_qualified:null,image:"1f932-1f3ff.png",sheet_x:39,sheet_y:10,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Palms Up Together",b:"1F932",d:!0,e:!0,f:!0,h:!0,k:[39,5],o:5,j:["双手掌心向上"]},pig:{a:"Pig Face",b:"1F437",d:!0,e:!0,f:!0,h:!0,j:["猪脸","动物","猪的叫声","自然界","animal","oink","nature"],k:[12,27],o:2},hospital:{a:"Hospital",b:"1F3E5",d:!0,e:!0,f:!0,h:!0,j:["医院","建筑","健康","手术","医生","building","health","surgery","doctor"],k:[10,56],o:2},hiking_boot:{a:"Hiking Boot",b:"1F97E",d:!0,e:!0,f:!0,h:!0,k:[42,16],o:11,j:["徒步靴"]},"flag-be":{a:"Belgium Flag",b:"1F1E7-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[0,51],o:2,j:["比利时国旗"]},"flag-bf":{a:"Burkina Faso Flag",b:"1F1E7-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[0,52],o:2,j:["布基纳法索国旗"]},mushroom:{a:"Mushroom",b:"1F344",d:!0,e:!0,f:!0,h:!0,j:["蘑菇","植物","蔬菜","plant","vegetable"],k:[6,28],o:2},pig2:{a:"Pig",b:"1F416",d:!0,e:!0,f:!0,h:!0,j:["猪","动物","自然界","animal","nature"],k:[11,51],o:2},baseball:{a:"Baseball",b:"26BE",d:!0,e:!0,f:!0,h:!0,j:["棒球","体育","有种","sports","balls"],k:[54,0],o:2},face_with_hand_over_mouth:{a:"Smiling Face with Smiling Eyes and Hand Covering Mouth",b:"1F92D",d:!0,e:!0,f:!0,h:!0,k:[38,47],n:["smiling_face_with_smiling_eyes_and_hand_covering_mouth"],o:5,j:["捂嘴"]},handshake:{a:"Handshake",b:"1F91D",d:!0,e:!0,f:!0,h:!0,j:["握手","协议","摇","agreement","shake"],k:[38,4],o:4},womans_flat_shoe:{a:"Flat Shoe",b:"1F97F",d:!0,e:!0,f:!0,h:!0,k:[42,17],o:11,j:["平底鞋"]},bank:{a:"Bank",b:"1F3E6",d:!0,e:!0,f:!0,h:!0,j:["银行","建筑","钱","销售","现金","商","企业","building","money","sales","cash","business","enterprise"],k:[11,0],o:2},arrow_right:{a:"Black Rightwards Arrow",b:"27A1-FE0F",c:"27A1",d:!0,e:!0,f:!0,h:!0,j:["右箭头","蓝色方块","下一个","blue-square","next"],k:[55,32],o:2},peanuts:{a:"Peanuts",b:"1F95C",d:!0,e:!0,f:!0,h:!0,j:["花生","食物","坚果","food","nut"],k:[41,43],o:4},shushing_face:{a:"Face with Finger Covering Closed Lips",b:"1F92B",d:!0,e:!0,f:!0,h:!0,k:[38,45],n:["face_with_finger_covering_closed_lips"],o:5,j:["嘘脸"]},pray:{skin_variations:{"1F3FB":{unified:"1F64F-1F3FB",non_qualified:null,image:"1f64f-1f3fb.png",sheet_x:33,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64F-1F3FC",non_qualified:null,image:"1f64f-1f3fc.png",sheet_x:33,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64F-1F3FD",non_qualified:null,image:"1f64f-1f3fd.png",sheet_x:33,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64F-1F3FE",non_qualified:null,image:"1f64f-1f3fe.png",sheet_x:33,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64F-1F3FF",non_qualified:null,image:"1f64f-1f3ff.png",sheet_x:33,sheet_y:55,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Person with Folded Hands",b:"1F64F",d:!0,e:!0,f:!0,h:!0,j:["双手合十","请","希望","希望","纳马斯特","高五","please","hope","wish","namaste","highfive"],k:[33,50],o:2},softball:{a:"Softball",b:"1F94E",d:!0,e:!0,f:!0,h:!0,k:[41,29],o:11,j:["垒球"]},high_heel:{a:"High-Heeled Shoe",b:"1F460",d:!0,e:!0,f:!0,h:!0,j:["高跟鞋","时尚","鞋","女性","泵","细高跟鞋","fashion","shoes","female","pumps","stiletto"],k:[14,20],o:2},"flag-bg":{a:"Bulgaria Flag",b:"1F1E7-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[0,53],o:2,j:["保加利亚国旗"]},arrow_lower_right:{a:"South East Arrow",b:"2198-FE0F",c:"2198",d:!0,e:!0,f:!0,h:!0,j:["右下箭头","蓝色方块","方向","对角","东南","blue-square","direction","diagonal","southeast"],k:[52,18],o:2},hotel:{a:"Hotel",b:"1F3E8",d:!0,e:!0,f:!0,h:!0,j:["旅馆","建筑","住宿","签入","building","accomodation","checkin"],k:[11,2],o:2},boar:{a:"Boar",b:"1F417",d:!0,e:!0,f:!0,h:!0,j:["公猪","动物","自然界","animal","nature"],k:[11,52],o:2},sandal:{a:"Womans Sandal",b:"1F461",d:!0,e:!0,f:!0,h:!0,j:["女人的凉鞋","鞋","时尚","人字拖","shoes","fashion","flip flops"],k:[14,21],o:2},"flag-bh":{a:"Bahrain Flag",b:"1F1E7-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[0,54],o:2,j:["巴林国旗"]},arrow_down:{a:"Downwards Black Arrow",b:"2B07-FE0F",c:"2B07",d:!0,e:!0,f:!0,h:!0,j:["向下箭头","蓝色方块","方向","底","blue-square","direction","bottom"],k:[55,39],o:2},thinking_face:{a:"Thinking Face",b:"1F914",d:!0,e:!0,f:!0,h:!0,k:[37,27],o:2,j:["思考的脸"]},writing_hand:{skin_variations:{"1F3FB":{unified:"270D-1F3FB",non_qualified:null,image:"270d-1f3fb.png",sheet_x:55,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"270D-1F3FC",non_qualified:null,image:"270d-1f3fc.png",sheet_x:55,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"270D-1F3FD",non_qualified:null,image:"270d-1f3fd.png",sheet_x:55,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"270D-1F3FE",non_qualified:null,image:"270d-1f3fe.png",sheet_x:55,sheet_y:8,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"270D-1F3FF",non_qualified:null,image:"270d-1f3ff.png",sheet_x:55,sheet_y:9,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Writing Hand",b:"270D-FE0F",c:"270D",d:!0,e:!0,f:!0,h:!0,j:["用笔手写","lower_left_ballpoint_pen","文具","写","组成","lower_left_ballpoint_pen","stationery","write","compose"],k:[55,4],o:2},chestnut:{a:"Chestnut",b:"1F330",d:!0,e:!0,f:!0,h:!0,j:["板栗","食物","松鼠","food","squirrel"],k:[6,8],o:2},basketball:{a:"Basketball and Hoop",b:"1F3C0",d:!0,e:!0,f:!0,h:!0,j:["篮球","体育","有种","断续器","sports","balls","NBA"],k:[8,38],o:2},pig_nose:{a:"Pig Nose",b:"1F43D",d:!0,e:!0,f:!0,h:!0,j:["猪鼻子","动物","猪的叫声","animal","oink"],k:[12,33],o:2},love_hotel:{a:"Love Hotel",b:"1F3E9",d:!0,e:!0,f:!0,h:!0,j:["爱情酒店","喜欢","感情","约会","like","affection","dating"],k:[11,3],o:2},nail_care:{skin_variations:{"1F3FB":{unified:"1F485-1F3FB",non_qualified:null,image:"1f485-1f3fb.png",sheet_x:24,sheet_y:34,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F485-1F3FC",non_qualified:null,image:"1f485-1f3fc.png",sheet_x:24,sheet_y:35,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F485-1F3FD",non_qualified:null,image:"1f485-1f3fd.png",sheet_x:24,sheet_y:36,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F485-1F3FE",non_qualified:null,image:"1f485-1f3fe.png",sheet_x:24,sheet_y:37,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F485-1F3FF",non_qualified:null,image:"1f485-1f3ff.png",sheet_x:24,sheet_y:38,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Nail Polish",b:"1F485",d:!0,e:!0,f:!0,h:!0,j:["指甲美容","美","修指甲","手指","时尚","指甲","beauty","manicure","finger","fashion","nail"],k:[24,33],o:2},volleyball:{a:"Volleyball",b:"1F3D0",d:!0,e:!0,f:!0,h:!0,j:["排球","体育","有种","sports","balls"],k:[10,35],o:2},"flag-bi":{a:"Burundi Flag",b:"1F1E7-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[0,55],o:2,j:["布隆迪国旗"]},arrow_lower_left:{a:"South West Arrow",b:"2199-FE0F",c:"2199",d:!0,e:!0,f:!0,h:!0,j:["左下箭头","蓝色方块","方向","对角","西南","blue-square","direction","diagonal","southwest"],k:[52,19],o:2},ram:{a:"Ram",b:"1F40F",d:!0,e:!0,f:!0,h:!0,j:["公羊","动物","羊","自然界","animal","sheep","nature"],k:[11,43],o:2},ballet_shoes:{a:"Ballet Shoes",b:"1FA70",d:!0,e:!0,f:!0,h:!0,k:[51,51],o:12,j:["芭蕾舞鞋"]},zipper_mouth_face:{a:"Zipper-Mouth Face",b:"1F910",d:!0,e:!0,f:!0,h:!0,j:["拉链口的脸","脸","密封的","拉链","秘密","face","sealed","zipper","secret"],k:[37,23],o:2},bread:{a:"Bread",b:"1F35E",d:!0,e:!0,f:!0,h:!0,j:["面包","食物","小麦","早餐","吐司","food","wheat","breakfast","toast"],k:[6,54],o:2},convenience_store:{a:"Convenience Store",b:"1F3EA",d:!0,e:!0,f:!0,h:!0,j:["便利店","建筑","购物","杂货","building","shopping","groceries"],k:[11,4],o:2},boot:{a:"Womans Boots",b:"1F462",d:!0,e:!0,f:!0,h:!0,j:["女靴","鞋","时尚","shoes","fashion"],k:[14,22],o:2},sheep:{a:"Sheep",b:"1F411",d:!0,e:!0,f:!0,h:!0,j:["母羊","动物","自然界","羊毛","船舶","animal","nature","wool","shipit"],k:[11,45],o:2},face_with_raised_eyebrow:{a:"Face with One Eyebrow Raised",b:"1F928",d:!0,e:!0,f:!0,h:!0,k:[38,42],n:["face_with_one_eyebrow_raised"],o:5,j:["扬起眉毛的脸"]},"flag-bj":{a:"Benin Flag",b:"1F1E7-1F1EF",d:!0,e:!0,f:!0,h:!0,k:[0,56],o:2,j:["贝宁国旗"]},arrow_left:{a:"Leftwards Black Arrow",b:"2B05-FE0F",c:"2B05",d:!0,e:!0,f:!0,h:!0,j:["左箭头","蓝色方块","以前","返回","blue-square","previous","back"],k:[55,37],o:2},selfie:{skin_variations:{"1F3FB":{unified:"1F933-1F3FB",non_qualified:null,image:"1f933-1f3fb.png",sheet_x:39,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F933-1F3FC",non_qualified:null,image:"1f933-1f3fc.png",sheet_x:39,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F933-1F3FD",non_qualified:null,image:"1f933-1f3fd.png",sheet_x:39,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F933-1F3FE",non_qualified:null,image:"1f933-1f3fe.png",sheet_x:39,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F933-1F3FF",non_qualified:null,image:"1f933-1f3ff.png",sheet_x:39,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Selfie",b:"1F933",d:!0,e:!0,f:!0,h:!0,j:["人拿着手机自拍","照相机","电话","camera","phone"],k:[39,11],o:4},croissant:{a:"Croissant",b:"1F950",d:!0,e:!0,f:!0,h:!0,j:["羊角面包","食物","面包","法语","food","bread","french"],k:[41,31],o:4},school:{a:"School",b:"1F3EB",d:!0,e:!0,f:!0,h:!0,j:["学校","建筑","学生","教育","学习","教","building","student","education","learn","teach"],k:[11,5],o:2},football:{a:"American Football",b:"1F3C8",d:!0,e:!0,f:!0,h:!0,j:["美式足球","体育","有种","美国国家橄榄球联盟","sports","balls","NFL"],k:[9,33],o:2},goat:{a:"Goat",b:"1F410",d:!0,e:!0,f:!0,h:!0,j:["山羊","动物","自然界","animal","nature"],k:[11,44],o:2},department_store:{a:"Department Store",b:"1F3EC",d:!0,e:!0,f:!0,h:!0,j:["百货商店","建筑","购物","商场","building","shopping","mall"],k:[11,6],o:2},"flag-bl":{a:"St. Barthélemy Flag",b:"1F1E7-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[1,0],o:2,j:["圣巴泰勒米旗"]},crown:{a:"Crown",b:"1F451",d:!0,e:!0,f:!0,h:!0,j:["王冠","王","在","领导","王权","主","king","kod","leader","royalty","lord"],k:[14,5],o:2},arrow_upper_left:{a:"North West Arrow",b:"2196-FE0F",c:"2196",d:!0,e:!0,f:!0,h:!0,j:["左上箭头","蓝色方块","点","方向","对角","西北","blue-square","point","direction","diagonal","northwest"],k:[52,16],o:2},neutral_face:{a:"Neutral Face",b:"1F610",d:!0,e:!0,f:!0,h:!0,j:["中性表情","冷漠","喵",":|","中性","indifference","meh",":|","neutral"],k:[30,51],l:[":|",":-|"],o:2},rugby_football:{a:"Rugby Football",b:"1F3C9",d:!0,e:!0,f:!0,h:!0,j:["橄榄球","体育","团队","sports","team"],k:[9,34],o:2},muscle:{skin_variations:{"1F3FB":{unified:"1F4AA-1F3FB",non_qualified:null,image:"1f4aa-1f3fb.png",sheet_x:25,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F4AA-1F3FC",non_qualified:null,image:"1f4aa-1f3fc.png",sheet_x:25,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F4AA-1F3FD",non_qualified:null,image:"1f4aa-1f3fd.png",sheet_x:25,sheet_y:55,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F4AA-1F3FE",non_qualified:null,image:"1f4aa-1f3fe.png",sheet_x:25,sheet_y:56,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F4AA-1F3FF",non_qualified:null,image:"1f4aa-1f3ff.png",sheet_x:26,sheet_y:0,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Flexed Biceps",b:"1F4AA",d:!0,e:!0,f:!0,h:!0,j:["二头肌","手臂","屈","手","夏天","强","二头肌","arm","flex","hand","summer","strong","biceps"],k:[25,52],o:2},baguette_bread:{a:"Baguette Bread",b:"1F956",d:!0,e:!0,f:!0,h:!0,j:["法式长棍面包","食物","面包","法语","food","bread","french"],k:[41,37],o:4},expressionless:{a:"Expressionless Face",b:"1F611",d:!0,e:!0,f:!0,h:!0,j:["面无表情的脸","脸","冷漠","-_-","喵","面 无 表情","face","indifferent","-_-","meh","deadpan"],k:[30,52],o:2},womans_hat:{a:"Womans Hat",b:"1F452",d:!0,e:!0,f:!0,h:!0,j:["女帽","时尚","辅料","女性","女士","春天","fashion","accessories","female","lady","spring"],k:[14,6],o:2},pretzel:{a:"Pretzel",b:"1F968",d:!0,e:!0,f:!0,h:!0,k:[41,55],o:5,j:["椒盐脆饼"]},mechanical_arm:{a:"Mechanical Arm",b:"1F9BE",d:!0,e:!0,f:!0,h:!0,k:[44,6],o:12,j:["机械手臂"]},arrow_up_down:{a:"Up Down Arrow",b:"2195-FE0F",c:"2195",d:!0,e:!0,f:!0,h:!0,j:["上下箭头","蓝色方块","方向","道路","垂直","blue-square","direction","way","vertical"],k:[52,15],o:2},dromedary_camel:{a:"Dromedary Camel",b:"1F42A",d:!0,e:!0,f:!0,h:!0,j:["骆驼","动物","热","沙漠","驼峰","animal","hot","desert","hump"],k:[12,14],o:2},tennis:{a:"Tennis Racquet and Ball",b:"1F3BE",d:!0,e:!0,f:!0,h:!0,j:["网球","体育","有种","绿","sports","balls","green"],k:[8,36],o:2},"flag-bm":{a:"Bermuda Flag",b:"1F1E7-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[1,1],o:2,j:["百慕大旗"]},factory:{a:"Factory",b:"1F3ED",d:!0,e:!0,f:!0,h:!0,j:["工厂","建筑","工业","污染","烟","building","industry","pollution","smoke"],k:[11,7],o:2},japanese_castle:{a:"Japanese Castle",b:"1F3EF",d:!0,e:!0,f:!0,h:!0,j:["日本城堡","相片","建筑","photo","building"],k:[11,9],o:2},no_mouth:{a:"Face Without Mouth",b:"1F636",d:!0,e:!0,f:!0,h:!0,j:["没嘴的脸","脸","你好凯蒂","face","hellokitty"],k:[31,32],o:2},mechanical_leg:{a:"Mechanical Leg",b:"1F9BF",d:!0,e:!0,f:!0,h:!0,k:[44,7],o:12,j:["机械腿"]},bagel:{a:"Bagel",b:"1F96F",d:!0,e:!0,f:!0,h:!0,k:[42,5],o:11,j:["贝果"]},camel:{a:"Bactrian Camel",b:"1F42B",d:!0,e:!0,f:!0,h:!0,j:["两个驼峰的骆驼","动物","自然界","热","沙漠","驼峰","animal","nature","hot","desert","hump"],k:[12,15],o:2},tophat:{a:"Top Hat",b:"1F3A9",d:!0,e:!0,f:!0,h:!0,j:["高帽","魔法","绅士","优雅","马戏团","magic","gentleman","classy","circus"],k:[8,15],o:2},left_right_arrow:{a:"Left Right Arrow",b:"2194-FE0F",c:"2194",d:!0,e:!0,f:!0,h:!0,j:["左右箭头","形状","方向","水平","侧身","shape","direction","horizontal","sideways"],k:[52,14],o:2},"flag-bn":{a:"Brunei Flag",b:"1F1E7-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[1,2],o:2,j:["文莱国旗"]},flying_disc:{a:"Flying Disc",b:"1F94F",d:!0,e:!0,f:!0,h:!0,k:[41,30],o:11,j:["飞盘"]},smirk:{a:"Smirking Face",b:"1F60F",d:!0,e:!0,f:!0,h:!0,j:["诡异笑的脸","脸","微笑","意味 着","恶作剧","洋洋得意","讽刺","face","smile","mean","prank","smug","sarcasm"],k:[30,50],o:2},mortar_board:{a:"Graduation Cap",b:"1F393",d:!0,e:!0,f:!0,h:!0,j:["毕业帽","学校","大学","度","大学","毕业","头","有","法律","学习","教育","school","college","degree","university","graduation","cap","hat","legal","learn","education"],k:[7,55],o:2},european_castle:{a:"European Castle",b:"1F3F0",d:!0,e:!0,f:!0,h:!0,j:["城堡","建筑","王权","历史","building","royalty","history"],k:[11,10],o:2},leg:{skin_variations:{"1F3FB":{unified:"1F9B5-1F3FB",non_qualified:null,image:"1f9b5-1f3fb.png",sheet_x:43,sheet_y:6,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B5-1F3FC",non_qualified:null,image:"1f9b5-1f3fc.png",sheet_x:43,sheet_y:7,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B5-1F3FD",non_qualified:null,image:"1f9b5-1f3fd.png",sheet_x:43,sheet_y:8,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B5-1F3FE",non_qualified:null,image:"1f9b5-1f3fe.png",sheet_x:43,sheet_y:9,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B5-1F3FF",non_qualified:null,image:"1f9b5-1f3ff.png",sheet_x:43,sheet_y:10,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Leg",b:"1F9B5",d:!0,e:!0,f:!0,h:!0,k:[43,5],o:11,j:["腿"]},pancakes:{a:"Pancakes",b:"1F95E",d:!0,e:!0,f:!0,h:!0,j:["煎饼","食物","早餐","烙饼","烤 饼","food","breakfast","flapjacks","hotcakes"],k:[41,45],o:4},leftwards_arrow_with_hook:{a:"Leftwards Arrow with Hook",b:"21A9-FE0F",c:"21A9",d:!0,e:!0,f:!0,h:!0,j:["右箭头向左弯曲","返回","返回","蓝色方块","撤消","进入","back","return","blue-square","undo","enter"],k:[52,20],o:2},"flag-bo":{a:"Bolivia Flag",b:"1F1E7-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[1,3],o:2,j:["玻利维亚国旗"]},bowling:{a:"Bowling",b:"1F3B3",d:!0,e:!0,f:!0,h:!0,j:["保龄球","体育","乐趣","玩","sports","fun","play"],k:[8,25],o:2},llama:{a:"Llama",b:"1F999",d:!0,e:!0,f:!0,h:!0,k:[42,43],o:11,j:["羊驼"]},arrow_right_hook:{a:"Rightwards Arrow with Hook",b:"21AA-FE0F",c:"21AA",d:!0,e:!0,f:!0,h:!0,j:["左箭头向右弯曲","蓝色方块","返回","旋转","方向","blue-square","return","rotate","direction"],k:[52,21],o:2},wedding:{a:"Wedding",b:"1F492",d:!0,e:!0,f:!0,h:!0,j:["婚礼","爱","喜欢","感情","夫妇","婚","新娘","新郎","love","like","affection","couple","marriage","bride","groom"],k:[25,28],o:2},"flag-bq":{a:"Caribbean Netherlands Flag",b:"1F1E7-1F1F6",d:!0,e:!0,f:!0,h:!0,k:[1,4],o:2,j:["荷属加勒比旗"]},foot:{skin_variations:{"1F3FB":{unified:"1F9B6-1F3FB",non_qualified:null,image:"1f9b6-1f3fb.png",sheet_x:43,sheet_y:12,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B6-1F3FC",non_qualified:null,image:"1f9b6-1f3fc.png",sheet_x:43,sheet_y:13,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B6-1F3FD",non_qualified:null,image:"1f9b6-1f3fd.png",sheet_x:43,sheet_y:14,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B6-1F3FE",non_qualified:null,image:"1f9b6-1f3fe.png",sheet_x:43,sheet_y:15,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B6-1F3FF",non_qualified:null,image:"1f9b6-1f3ff.png",sheet_x:43,sheet_y:16,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Foot",b:"1F9B6",d:!0,e:!0,f:!0,h:!0,k:[43,11],o:11,j:["脚丫"]},giraffe_face:{a:"Giraffe Face",b:"1F992",d:!0,e:!0,f:!0,h:!0,k:[42,36],o:5,j:["长颈鹿"]},unamused:{a:"Unamused Face",b:"1F612",d:!0,e:!0,f:!0,h:!0,j:["一脸不快的脸","冷漠","无聊","直面","严重","讽刺","indifference","bored","straight face","serious","sarcasm"],k:[30,53],m:":(",o:2},billed_cap:{a:"Billed Cap",b:"1F9E2",d:!0,e:!0,f:!0,h:!0,k:[51,21],o:5,j:["棒球帽"]},waffle:{a:"Waffle",b:"1F9C7",d:!0,e:!0,f:!0,h:!0,k:[44,15],o:12,j:["松饼"]},cricket_bat_and_ball:{a:"Cricket Bat and Ball",b:"1F3CF",d:!0,e:!0,f:!0,h:!0,k:[10,34],o:2,j:["板球"]},helmet_with_white_cross:{a:"Helmet with White Cross",b:"26D1-FE0F",c:"26D1",d:!0,e:!0,f:!0,h:!0,k:[54,6],o:2,j:["救援头盔"]},ear:{skin_variations:{"1F3FB":{unified:"1F442-1F3FB",non_qualified:null,image:"1f442-1f3fb.png",sheet_x:12,sheet_y:40,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F442-1F3FC",non_qualified:null,image:"1f442-1f3fc.png",sheet_x:12,sheet_y:41,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F442-1F3FD",non_qualified:null,image:"1f442-1f3fd.png",sheet_x:12,sheet_y:42,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F442-1F3FE",non_qualified:null,image:"1f442-1f3fe.png",sheet_x:12,sheet_y:43,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F442-1F3FF",non_qualified:null,image:"1f442-1f3ff.png",sheet_x:12,sheet_y:44,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Ear",b:"1F442",d:!0,e:!0,f:!0,h:!0,j:["耳朵","脸","听见","声音","听","face","hear","sound","listen"],k:[12,39],o:2},elephant:{a:"Elephant",b:"1F418",d:!0,e:!0,f:!0,h:!0,j:["象","动物","自然界","鼻子","千","马戏团","animal","nature","nose","th","circus"],k:[11,53],o:2},cheese_wedge:{a:"Cheese Wedge",b:"1F9C0",d:!0,e:!0,f:!0,h:!0,k:[44,8],o:2,j:["奶酪楔"]},tokyo_tower:{a:"Tokyo Tower",b:"1F5FC",d:!0,e:!0,f:!0,h:!0,j:["东京铁塔","相片","日语","photo","japanese"],k:[30,31],o:2},arrow_heading_up:{a:"Arrow Pointing Rightwards Then Curving Upwards",b:"2934-FE0F",c:"2934",d:!0,e:!0,f:!0,h:!0,j:["右箭头向上弯曲","蓝色方块","方向","返回页首","blue-square","direction","top"],k:[55,35],o:2},field_hockey_stick_and_ball:{a:"Field Hockey Stick and Ball",b:"1F3D1",d:!0,e:!0,f:!0,h:!0,k:[10,36],o:2,j:["曲棍球"]},"flag-br":{a:"Brazil Flag",b:"1F1E7-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[1,5],o:2,j:["巴西国旗"]},face_with_rolling_eyes:{a:"Face with Rolling Eyes",b:"1F644",d:!0,e:!0,f:!0,h:!0,k:[31,46],o:2,j:["翻白眼的脸"]},ear_with_hearing_aid:{skin_variations:{"1F3FB":{unified:"1F9BB-1F3FB",non_qualified:null,image:"1f9bb-1f3fb.png",sheet_x:43,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9BB-1F3FC",non_qualified:null,image:"1f9bb-1f3fc.png",sheet_x:44,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9BB-1F3FD",non_qualified:null,image:"1f9bb-1f3fd.png",sheet_x:44,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9BB-1F3FE",non_qualified:null,image:"1f9bb-1f3fe.png",sheet_x:44,sheet_y:2,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9BB-1F3FF",non_qualified:null,image:"1f9bb-1f3ff.png",sheet_x:44,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Ear with Hearing Aid",b:"1F9BB",d:!0,e:!0,f:!0,h:!0,k:[43,55],o:12,j:["佩戴助听器的耳朵"]},arrow_heading_down:{a:"Arrow Pointing Rightwards Then Curving Downwards",b:"2935-FE0F",c:"2935",d:!0,e:!0,f:!0,h:!0,j:["右箭头向下弯曲","蓝色方块","方向","底","blue-square","direction","bottom"],k:[55,36],o:2},ice_hockey_stick_and_puck:{a:"Ice Hockey Stick and Puck",b:"1F3D2",d:!0,e:!0,f:!0,h:!0,k:[10,37],o:2,j:["冰球"]},meat_on_bone:{a:"Meat on Bone",b:"1F356",d:!0,e:!0,f:!0,h:!0,j:["肉骨头","好","食物","鸡 腿","good","food","drumstick"],k:[6,46],o:2},prayer_beads:{a:"Prayer Beads",b:"1F4FF",d:!0,e:!0,f:!0,h:!0,j:["念珠","迪克尔","宗教","dhikr","religious"],k:[27,27],o:2},statue_of_liberty:{a:"Statue of Liberty",b:"1F5FD",d:!0,e:!0,f:!0,h:!0,j:["自由女神像","美国人","纽约","american","newyork"],k:[30,32],o:2},grimacing:{a:"Grimacing Face",b:"1F62C",d:!0,e:!0,f:!0,h:!0,j:["狰狞的脸","脸","鬼脸","牙齿","face","grimace","teeth"],k:[31,22],o:2},"flag-bs":{a:"Bahamas Flag",b:"1F1E7-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[1,6],o:2,j:["巴哈马国旗"]},rhinoceros:{a:"Rhinoceros",b:"1F98F",d:!0,e:!0,f:!0,h:!0,j:["犀牛","动物","自然界","角","animal","nature","horn"],k:[42,33],o:4},lacrosse:{a:"Lacrosse Stick and Ball",b:"1F94D",d:!0,e:!0,f:!0,h:!0,k:[41,28],o:11,j:["长曲棍球"]},poultry_leg:{a:"Poultry Leg",b:"1F357",d:!0,e:!0,f:!0,h:!0,j:["鸡腿","食物","肉","鸡 腿","鸟","鸡","土耳其","food","meat","drumstick","bird","chicken","turkey"],k:[6,47],o:2},hippopotamus:{a:"Hippopotamus",b:"1F99B",d:!0,e:!0,f:!0,h:!0,k:[42,45],o:11,j:["河马"]},nose:{skin_variations:{"1F3FB":{unified:"1F443-1F3FB",non_qualified:null,image:"1f443-1f3fb.png",sheet_x:12,sheet_y:46,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F443-1F3FC",non_qualified:null,image:"1f443-1f3fc.png",sheet_x:12,sheet_y:47,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F443-1F3FD",non_qualified:null,image:"1f443-1f3fd.png",sheet_x:12,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F443-1F3FE",non_qualified:null,image:"1f443-1f3fe.png",sheet_x:12,sheet_y:49,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F443-1F3FF",non_qualified:null,image:"1f443-1f3ff.png",sheet_x:12,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Nose",b:"1F443",d:!0,e:!0,f:!0,h:!0,j:["鼻子","气味","闻","smell","sniff"],k:[12,45],o:2},arrows_clockwise:{a:"Clockwise Downwards and Upwards Open Circle Arrows",b:"1F503",d:!0,e:!0,f:!0,h:!0,j:["顺时针垂直箭头","同步","周期","圆","重复","sync","cycle","round","repeat"],k:[27,31],o:2},"flag-bt":{a:"Bhutan Flag",b:"1F1E7-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[1,7],o:2,j:["不丹国旗"]},church:{a:"Church",b:"26EA",d:!0,e:!0,f:!0,h:!0,j:["基督教会","建筑","宗教","基督","building","religion","christ"],k:[54,10],o:2},lipstick:{a:"Lipstick",b:"1F484",d:!0,e:!0,f:!0,h:!0,j:["口红","女性","女孩","时尚","女人","female","girl","fashion","woman"],k:[24,32],o:2},lying_face:{a:"Lying Face",b:"1F925",d:!0,e:!0,f:!0,h:!0,j:["说谎的脸","脸","躺","皮诺奇","face","lie","pinocchio"],k:[38,22],o:4},arrows_counterclockwise:{a:"Anticlockwise Downwards and Upwards Open Circle Arrows",b:"1F504",d:!0,e:!0,f:!0,h:!0,j:["逆时针箭头按钮","蓝色方块","同步","周期","blue-square","sync","cycle"],k:[27,32],o:2},"flag-bv":{a:"Bouvet Island Flag",b:"1F1E7-1F1FB",d:!0,e:!0,f:!0,h:!0,k:[1,8],o:2,j:["布维岛旗"]},cut_of_meat:{a:"Cut of Meat",b:"1F969",d:!0,e:!0,f:!0,h:!0,k:[41,56],o:5,j:["肉块"]},mosque:{a:"Mosque",b:"1F54C",d:!0,e:!0,f:!0,h:!0,j:["清真寺","伊斯兰","崇拜","尖塔","islam","worship","minaret"],k:[28,36],o:2},ring:{a:"Ring",b:"1F48D",d:!0,e:!0,f:!0,h:!0,j:["戒指","婚礼","提供","婚","情人","钻石","时尚","珠宝","宝石","承诺","wedding","propose","marriage","valentines","diamond","fashion","jewelry","gem","engagement"],k:[25,23],o:2},brain:{a:"Brain",b:"1F9E0",d:!0,e:!0,f:!0,h:!0,k:[51,19],o:5,j:["脑"]},table_tennis_paddle_and_ball:{a:"Table Tennis Paddle and Ball",b:"1F3D3",d:!0,e:!0,f:!0,h:!0,k:[10,38],o:2,j:["乒乓"]},relieved:{a:"Relieved Face",b:"1F60C",d:!0,e:!0,f:!0,h:!0,j:["如释重负的脸","脸","放松","唷","按摩","幸福","face","relaxed","phew","massage","happiness"],k:[30,47],o:2},mouse:{a:"Mouse Face",b:"1F42D",d:!0,e:!0,f:!0,h:!0,j:["鼠脸","动物","自然界","cheese_wedge","啮齿动物","animal","nature","cheese_wedge","rodent"],k:[12,17],o:2},hindu_temple:{a:"Hindu Temple",b:"1F6D5",d:!0,e:!0,f:!0,h:!0,k:[36,41],o:12,j:["印度教"]},back:{a:"Back with Leftwards Arrow Above",b:"1F519",d:!0,e:!0,f:!0,h:!0,j:["返回箭头","箭","的话","返回","arrow","words","return"],k:[27,53],o:2},gem:{a:"Gem Stone",b:"1F48E",d:!0,e:!0,f:!0,h:!0,j:["宝石","蓝","红宝石","钻石","珠宝","blue","ruby","diamond","jewelry"],k:[25,24],o:2},pensive:{a:"Pensive Face",b:"1F614",d:!0,e:!0,f:!0,h:!0,j:["沉思的脸","脸","伤心","沮丧","沮丧","face","sad","depressed","upset"],k:[30,55],o:2},"flag-bw":{a:"Botswana Flag",b:"1F1E7-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[1,9],o:2,j:["博茨瓦纳国旗"]},mouse2:{a:"Mouse",b:"1F401",d:!0,e:!0,f:!0,h:!0,j:["老鼠","动物","自然界","啮齿动物","animal","nature","rodent"],k:[11,29],o:2},bacon:{a:"Bacon",b:"1F953",d:!0,e:!0,f:!0,h:!0,j:["培根","食物","早餐","猪肉","猪","肉","food","breakfast","pork","pig","meat"],k:[41,34],o:4},tooth:{a:"Tooth",b:"1F9B7",d:!0,e:!0,f:!0,h:!0,k:[43,17],o:11,j:["牙齿"]},badminton_racquet_and_shuttlecock:{a:"Badminton Racquet and Shuttlecock",b:"1F3F8",d:!0,e:!0,f:!0,h:!0,k:[11,20],o:2,j:["羽毛球"]},rat:{a:"Rat",b:"1F400",d:!0,e:!0,f:!0,h:!0,j:["鼠","动物","鼠","啮齿动物","animal","mouse","rodent"],k:[11,28],o:2},synagogue:{a:"Synagogue",b:"1F54D",d:!0,e:!0,f:!0,h:!0,j:["犹太教堂","犹太教","崇拜","寺庙","犹太的","judaism","worship","temple","jewish"],k:[28,37],o:2},end:{a:"End with Leftwards Arrow Above",b:"1F51A",d:!0,e:!0,f:!0,h:!0,j:["结束箭头","的话","箭","words","arrow"],k:[27,54],o:2},bone:{a:"Bone",b:"1F9B4",d:!0,e:!0,f:!0,h:!0,k:[43,4],o:11,j:["骨头"]},boxing_glove:{a:"Boxing Glove",b:"1F94A",d:!0,e:!0,f:!0,h:!0,j:["拳击手套","体育","战斗","sports","fighting"],k:[41,25],o:4},mute:{a:"Speaker with Cancellation Stroke",b:"1F507",d:!0,e:!0,f:!0,h:!0,j:["静音音箱","声音","卷","沉默","安静","sound","volume","silence","quiet"],k:[27,35],o:2},hamburger:{a:"Hamburger",b:"1F354",d:!0,e:!0,f:!0,h:!0,j:["汉堡包","肉","快餐","牛肉","芝 士 汉堡","麦当劳","汉堡王","meat","fast food","beef","cheeseburger","mcdonalds","burger king"],k:[6,44],o:2},"flag-by":{a:"Belarus Flag",b:"1F1E7-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[1,10],o:2,j:["白俄罗斯国旗"]},sleepy:{a:"Sleepy Face",b:"1F62A",d:!0,e:!0,f:!0,h:!0,j:["困的脸","脸","累","休息","太阳","face","tired","rest","nap"],k:[31,20],o:2},on:{a:"On with Exclamation Mark with Left Right Arrow Above",b:"1F51B",d:!0,e:!0,f:!0,h:!0,j:["开启箭头","箭","的话","arrow","words"],k:[27,55],o:2},martial_arts_uniform:{a:"Martial Arts Uniform",b:"1F94B",d:!0,e:!0,f:!0,h:!0,j:["武术制服","柔道","空手道","跆拳道","judo","karate","taekwondo"],k:[41,26],o:4},speaker:{a:"Speaker",b:"1F508",d:!0,e:!0,f:!0,h:!0,j:["扬声器音量低","声音","卷","沉默","广播","sound","volume","silence","broadcast"],k:[27,36],o:2},drooling_face:{a:"Drooling Face",b:"1F924",d:!0,e:!0,f:!0,h:!0,j:["流口水的脸","脸","face"],k:[38,21],o:4},eyes:{a:"Eyes",b:"1F440",d:!0,e:!0,f:!0,h:!0,j:["一双眼睛","看","看","茎","偷看","看","look","watch","stalk","peek","see"],k:[12,36],o:2},"flag-bz":{a:"Belize Flag",b:"1F1E7-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[1,11],o:2,j:["伯利兹国旗"]},hamster:{a:"Hamster Face",b:"1F439",d:!0,e:!0,f:!0,h:!0,j:["仓鼠","动物","自然界","animal","nature"],k:[12,29],o:2},shinto_shrine:{a:"Shinto Shrine",b:"26E9-FE0F",c:"26E9",d:!0,e:!0,f:!0,h:!0,j:["神社","寺庙","日本","京都","temple","japan","kyoto"],k:[54,9],o:2},fries:{a:"French Fries",b:"1F35F",d:!0,e:!0,f:!0,h:!0,j:["炸薯条","芯片","小吃","快餐","chips","snack","fast food"],k:[6,55],o:2},goal_net:{a:"Goal Net",b:"1F945",d:!0,e:!0,f:!0,h:!0,j:["球网","体育","sports"],k:[41,21],o:4},kaaba:{a:"Kaaba",b:"1F54B",d:!0,e:!0,f:!0,h:!0,j:["天房","麦加","清真寺","伊斯兰","mecca","mosque","islam"],k:[28,35],o:2},soon:{a:"Soon with Rightwards Arrow Above",b:"1F51C",d:!0,e:!0,f:!0,h:!0,j:["很快的箭头","箭","的话","arrow","words"],k:[27,56],o:2},"flag-ca":{a:"Canada Flag",b:"1F1E8-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[1,12],o:2,j:["加拿大国旗"]},rabbit:{a:"Rabbit Face",b:"1F430",d:!0,e:!0,f:!0,h:!0,j:["兔子脸","动物","自然界","宠物","春天","魔法","兔子","animal","nature","pet","spring","magic","bunny"],k:[12,20],o:2},eye:{a:"Eye",b:"1F441-FE0F",c:"1F441",d:!0,e:!0,f:!0,h:!0,j:["眼睛","脸","看","看","看","留","face","look","see","watch","stare"],k:[12,38],o:2},sleeping:{a:"Sleeping Face",b:"1F634",d:!0,e:!0,f:!0,h:!0,j:["熟睡的脸","脸","累","困","晚上","兹兹","face","tired","sleepy","night","zzz"],k:[31,30],o:2},pizza:{a:"Slice of Pizza",b:"1F355",d:!0,e:!0,f:!0,h:!0,j:["比萨","食物","党","food","party"],k:[6,45],o:2},sound:{a:"Speaker with One Sound Wave",b:"1F509",d:!0,e:!0,f:!0,h:!0,j:["扬声器音量中等","卷","议长","广播","volume","speaker","broadcast"],k:[27,37],o:2},rabbit2:{a:"Rabbit",b:"1F407",d:!0,e:!0,f:!0,h:!0,j:["兔子","动物","自然界","宠物","魔法","春天","animal","nature","pet","magic","spring"],k:[11,35],o:2},fountain:{a:"Fountain",b:"26F2",d:!0,e:!0,f:!0,h:!0,j:["喷泉","相片","夏天","水","新鲜","photo","summer","water","fresh"],k:[54,13],o:2},golf:{a:"Flag in Hole",b:"26F3",d:!0,e:!0,f:!0,h:!0,j:["在孔中的旗帜","体育","商","旗","洞","夏天","sports","business","flag","hole","summer"],k:[54,14],o:2},top:{a:"Top with Upwards Arrow Above",b:"1F51D",d:!0,e:!0,f:!0,h:!0,j:["向上箭头","的话","蓝色方块","words","blue-square"],k:[28,0],o:2},mask:{a:"Face with Medical Mask",b:"1F637",d:!0,e:!0,f:!0,h:!0,j:["戴口罩的脸","脸","生病","病","疾病","face","sick","ill","disease"],k:[31,33],o:2},"flag-cc":{a:"Cocos (keeling) Islands Flag",b:"1F1E8-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[1,13],o:2,j:["科科斯国旗"]},hotdog:{a:"Hot Dog",b:"1F32D",d:!0,e:!0,f:!0,h:!0,j:["热狗","食物","法兰克福","food","frankfurter"],k:[6,5],o:2},loud_sound:{a:"Speaker with Three Sound Waves",b:"1F50A",d:!0,e:!0,f:!0,h:!0,j:["扬声器音量高","卷","噪声","吵","议长","广播","volume","noise","noisy","speaker","broadcast"],k:[27,38],o:2},tongue:{a:"Tongue",b:"1F445",d:!0,e:!0,f:!0,h:!0,j:["舌头","口","好玩","mouth","playful"],k:[12,52],o:2},place_of_worship:{a:"Place of Worship",b:"1F6D0",d:!0,e:!0,f:!0,h:!0,j:["敬拜的场所","宗教","教堂","寺庙","祈祷","religion","church","temple","prayer"],k:[36,38],o:2},ice_skate:{a:"Ice Skate",b:"26F8-FE0F",c:"26F8",d:!0,e:!0,f:!0,h:!0,j:["滑冰","体育","sports"],k:[54,18],o:2},sandwich:{a:"Sandwich",b:"1F96A",d:!0,e:!0,f:!0,h:!0,k:[42,0],o:5,j:["三明治"]},chipmunk:{a:"Chipmunk",b:"1F43F-FE0F",c:"1F43F",d:!0,e:!0,f:!0,h:!0,j:["花栗鼠","动物","自然界","啮齿动物","松鼠","animal","nature","rodent","squirrel"],k:[12,35],o:2},loudspeaker:{a:"Public Address Loudspeaker",b:"1F4E2",d:!0,e:!0,f:!0,h:!0,j:["扬声器","卷","声音","volume","sound"],k:[26,56],o:2},lips:{a:"Mouth",b:"1F444",d:!0,e:!0,f:!0,h:!0,j:["嘴巴","口","吻","mouth","kiss"],k:[12,51],o:2},"flag-cd":{a:"Congo - Kinshasa Flag",b:"1F1E8-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[1,14],o:2,j:["刚果 - 金沙萨国旗"]},tent:{a:"Tent",b:"26FA",d:!0,e:!0,f:!0,h:!0,j:["帐篷","相片","露营","户外","photo","camping","outdoors"],k:[54,37],o:2},face_with_thermometer:{a:"Face with Thermometer",b:"1F912",d:!0,e:!0,f:!0,h:!0,j:["嘴里含着温度计的脸","生病","温度","温度计","冷","发烧","sick","temperature","thermometer","cold","fever"],k:[37,25],o:2},taco:{a:"Taco",b:"1F32E",d:!0,e:!0,f:!0,h:!0,j:["玉米卷","食物","墨西哥人","food","mexican"],k:[6,6],o:2},foggy:{a:"Foggy",b:"1F301",d:!0,e:!0,f:!0,h:!0,j:["有雾","相片","山","photo","mountain"],k:[5,20],o:2},"flag-cf":{a:"Central African Republic Flag",b:"1F1E8-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[1,15],o:2,j:["中非共和国国旗"]},baby:{skin_variations:{"1F3FB":{unified:"1F476-1F3FB",non_qualified:null,image:"1f476-1f3fb.png",sheet_x:23,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F476-1F3FC",non_qualified:null,image:"1f476-1f3fc.png",sheet_x:23,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F476-1F3FD",non_qualified:null,image:"1f476-1f3fd.png",sheet_x:23,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F476-1F3FE",non_qualified:null,image:"1f476-1f3fe.png",sheet_x:23,sheet_y:8,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F476-1F3FF",non_qualified:null,image:"1f476-1f3ff.png",sheet_x:23,sheet_y:9,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Baby",b:"1F476",d:!0,e:!0,f:!0,h:!0,j:["婴儿","孩子","男孩","女孩","幼儿","child","boy","girl","toddler"],k:[23,4],o:2},atom_symbol:{a:"Atom Symbol",b:"269B-FE0F",c:"269B",d:!0,e:!0,f:!0,h:!0,j:["原子符号","科学","物理","化学","science","physics","chemistry"],k:[53,48],o:2},fishing_pole_and_fish:{a:"Fishing Pole and Fish",b:"1F3A3",d:!0,e:!0,f:!0,h:!0,j:["鱼竿","食物","爱好","夏天","food","hobby","summer"],k:[8,9],o:2},hedgehog:{a:"Hedgehog",b:"1F994",d:!0,e:!0,f:!0,h:!0,k:[42,38],o:5,j:["刺猬"]},face_with_head_bandage:{a:"Face with Head-Bandage",b:"1F915",d:!0,e:!0,f:!0,h:!0,j:["带有绷带的脸","受伤","笨拙","绷带","伤害","injured","clumsy","bandage","hurt"],k:[37,28],o:2},mega:{a:"Cheering Megaphone",b:"1F4E3",d:!0,e:!0,f:!0,h:!0,j:["扩音器","声音","议长","卷","sound","speaker","volume"],k:[27,0],o:2},nauseated_face:{a:"Nauseated Face",b:"1F922",d:!0,e:!0,f:!0,h:!0,j:["恶心的脸。","脸","呕吐","总","绿","生病","吐","病","face","vomit","gross","green","sick","throw up","ill"],k:[38,19],o:4},child:{skin_variations:{"1F3FB":{unified:"1F9D2-1F3FB",non_qualified:null,image:"1f9d2-1f3fb.png",sheet_x:48,sheet_y:17,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D2-1F3FC",non_qualified:null,image:"1f9d2-1f3fc.png",sheet_x:48,sheet_y:18,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D2-1F3FD",non_qualified:null,image:"1f9d2-1f3fd.png",sheet_x:48,sheet_y:19,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D2-1F3FE",non_qualified:null,image:"1f9d2-1f3fe.png",sheet_x:48,sheet_y:20,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D2-1F3FF",non_qualified:null,image:"1f9d2-1f3ff.png",sheet_x:48,sheet_y:21,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Child",b:"1F9D2",d:!0,e:!0,f:!0,h:!0,k:[48,16],o:5,j:["儿童"]},"flag-cg":{a:"Congo - Brazzaville Flag",b:"1F1E8-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[1,16],o:2,j:["刚果 - 布拉柴维尔国旗"]},bat:{a:"Bat",b:"1F987",d:!0,e:!0,f:!0,h:!0,j:["蝙蝠","动物","自然界","盲","吸血鬼","animal","nature","blind","vampire"],k:[42,25],o:4},diving_mask:{a:"Diving Mask",b:"1F93F",d:!0,e:!0,f:!0,h:!0,k:[41,15],o:12,j:["潜水面具"]},burrito:{a:"Burrito",b:"1F32F",d:!0,e:!0,f:!0,h:!0,j:["卷饼","食物","墨西哥人","food","mexican"],k:[6,7],o:2},postal_horn:{a:"Postal Horn",b:"1F4EF",d:!0,e:!0,f:!0,h:!0,j:["号角","仪器","音乐","instrument","music"],k:[27,12],o:2},night_with_stars:{a:"Night with Stars",b:"1F303",d:!0,e:!0,f:!0,h:!0,j:["夜晚的星星","傍晚","城市","市中心","evening","city","downtown"],k:[5,22],o:2},om_symbol:{a:"Om Symbol",b:"1F549-FE0F",c:"1F549",d:!0,e:!0,f:!0,h:!0,k:[28,33],o:2,j:["唵符号"]},star_of_david:{a:"Star of David",b:"2721-FE0F",c:"2721",d:!0,e:!0,f:!0,h:!0,j:["六芒星","犹太教","judaism"],k:[55,15],o:2},boy:{skin_variations:{"1F3FB":{unified:"1F466-1F3FB",non_qualified:null,image:"1f466-1f3fb.png",sheet_x:14,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F466-1F3FC",non_qualified:null,image:"1f466-1f3fc.png",sheet_x:14,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F466-1F3FD",non_qualified:null,image:"1f466-1f3fd.png",sheet_x:14,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F466-1F3FE",non_qualified:null,image:"1f466-1f3fe.png",sheet_x:14,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F466-1F3FF",non_qualified:null,image:"1f466-1f3ff.png",sheet_x:14,sheet_y:31,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Boy",b:"1F466",d:!0,e:!0,f:!0,h:!0,j:["男孩","一","雄","家伙","青少年","man","male","guy","teenager"],k:[14,26],o:2},bell:{a:"Bell",b:"1F514",d:!0,e:!0,f:!0,h:!0,j:["铃","声音","通知","圣诞节","圣诞","磬","sound","notification","christmas","xmas","chime"],k:[27,48],o:2},"flag-ch":{a:"Switzerland Flag",b:"1F1E8-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[1,17],o:2,j:["瑞士国旗"]},running_shirt_with_sash:{a:"Running Shirt with Sash",b:"1F3BD",d:!0,e:!0,f:!0,h:!0,j:["跑步T恤","玩","选美","play","pageant"],k:[8,35],o:2},stuffed_flatbread:{a:"Stuffed Flatbread",b:"1F959",d:!0,e:!0,f:!0,h:!0,j:["口袋饼","食物","扁面包","塞","陀螺","food","flatbread","stuffed","gyro"],k:[41,40],o:4},bear:{a:"Bear Face",b:"1F43B",d:!0,e:!0,f:!0,h:!0,j:["熊","动物","自然界","野生","animal","nature","wild"],k:[12,31],o:2},cityscape:{a:"Cityscape",b:"1F3D9-FE0F",c:"1F3D9",d:!0,e:!0,f:!0,h:!0,j:["城市景观","相片","夜生活","都市的","photo","night life","urban"],k:[10,44],o:2},face_vomiting:{a:"Face with Open Mouth Vomiting",b:"1F92E",d:!0,e:!0,f:!0,h:!0,k:[38,48],n:["face_with_open_mouth_vomiting"],o:5,j:["呕吐的脸"]},wheel_of_dharma:{a:"Wheel of Dharma",b:"2638-FE0F",c:"2638",d:!0,e:!0,f:!0,h:!0,j:["法轮符号","印度教","佛教","梵语","梵语","hinduism","buddhism","sikhism","jainism"],k:[53,15],o:2},ski:{a:"Ski and Ski Boot",b:"1F3BF",d:!0,e:!0,f:!0,h:!0,j:["滑雪","体育","冬","冷","雪","sports","winter","cold","snow"],k:[8,37],o:2},girl:{skin_variations:{"1F3FB":{unified:"1F467-1F3FB",non_qualified:null,image:"1f467-1f3fb.png",sheet_x:14,sheet_y:33,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F467-1F3FC",non_qualified:null,image:"1f467-1f3fc.png",sheet_x:14,sheet_y:34,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F467-1F3FD",non_qualified:null,image:"1f467-1f3fd.png",sheet_x:14,sheet_y:35,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F467-1F3FE",non_qualified:null,image:"1f467-1f3fe.png",sheet_x:14,sheet_y:36,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F467-1F3FF",non_qualified:null,image:"1f467-1f3ff.png",sheet_x:14,sheet_y:37,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Girl",b:"1F467",d:!0,e:!0,f:!0,h:!0,j:["女孩","女性","女人","青少年","female","woman","teenager"],k:[14,32],o:2},falafel:{a:"Falafel",b:"1F9C6",d:!0,e:!0,f:!0,h:!0,k:[44,14],o:12,j:["炸豆丸子"]},sneezing_face:{a:"Sneezing Face",b:"1F927",d:!0,e:!0,f:!0,h:!0,j:["打喷嚏的脸","脸","保佑你","打喷嚏","生病","过敏","face","gesundheit","sneeze","sick","allergy"],k:[38,41],o:4},no_bell:{a:"Bell with Cancellation Stroke",b:"1F515",d:!0,e:!0,f:!0,h:!0,j:["带有斜线的铃","声音","卷","静音","安静","沉默","sound","volume","mute","quiet","silent"],k:[27,49],o:2},koala:{a:"Koala",b:"1F428",d:!0,e:!0,f:!0,h:!0,j:["考拉","动物","自然界","animal","nature"],k:[12,12],o:2},sunrise_over_mountains:{a:"Sunrise over Mountains",b:"1F304",d:!0,e:!0,f:!0,h:!0,j:["山顶日出","视图","假期","相片","view","vacation","photo"],k:[5,23],o:2},"flag-ci":{a:"Côte D’ivoire Flag",b:"1F1E8-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[1,18],o:2,j:["科特迪瓦旗"]},sunrise:{a:"Sunrise",b:"1F305",d:!0,e:!0,f:!0,h:!0,j:["日出","上午","视图","假期","相片","morning","view","vacation","photo"],k:[5,24],o:2},yin_yang:{a:"Yin Yang",b:"262F-FE0F",c:"262F",d:!0,e:!0,f:!0,h:!0,j:["阴阳符号","平衡","balance"],k:[53,14],o:2},adult:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB",non_qualified:null,image:"1f9d1-1f3fb.png",sheet_x:48,sheet_y:11,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D1-1F3FC",non_qualified:null,image:"1f9d1-1f3fc.png",sheet_x:48,sheet_y:12,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D1-1F3FD",non_qualified:null,image:"1f9d1-1f3fd.png",sheet_x:48,sheet_y:13,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D1-1F3FE",non_qualified:null,image:"1f9d1-1f3fe.png",sheet_x:48,sheet_y:14,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D1-1F3FF",non_qualified:null,image:"1f9d1-1f3ff.png",sheet_x:48,sheet_y:15,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Adult",b:"1F9D1",d:!0,e:!0,f:!0,h:!0,k:[48,10],o:5,j:["人"]},hot_face:{a:"Overheated Face",b:"1F975",d:!0,e:!0,f:!0,h:!0,k:[42,10],o:11,j:["热脸"]},musical_score:{a:"Musical Score",b:"1F3BC",d:!0,e:!0,f:!0,h:!0,j:["乐谱","高音","钥匙","组成","treble","clef","compose"],k:[8,34],o:2},sled:{a:"Sled",b:"1F6F7",d:!0,e:!0,f:!0,h:!0,k:[36,56],o:5,j:["雪橇"]},egg:{a:"Egg",b:"1F95A",d:!0,e:!0,f:!0,h:!0,j:["蛋","食物","鸡","早餐","food","chicken","breakfast"],k:[41,41],o:4},panda_face:{a:"Panda Face",b:"1F43C",d:!0,e:!0,f:!0,h:!0,j:["熊猫","动物","自然界","熊猫","animal","nature","panda"],k:[12,32],o:2},"flag-ck":{a:"Cook Islands Flag",b:"1F1E8-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[1,19],o:2,j:["库克群岛旗"]},"flag-cl":{a:"Chile Flag",b:"1F1E8-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[1,20],o:2,j:["智利国旗"]},person_with_blond_hair:{skin_variations:{"1F3FB":{unified:"1F471-1F3FB",non_qualified:null,image:"1f471-1f3fb.png",sheet_x:22,sheet_y:20,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F471-1F3FC",non_qualified:null,image:"1f471-1f3fc.png",sheet_x:22,sheet_y:21,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F471-1F3FD",non_qualified:null,image:"1f471-1f3fd.png",sheet_x:22,sheet_y:22,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F471-1F3FE",non_qualified:null,image:"1f471-1f3fe.png",sheet_x:22,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F471-1F3FF",non_qualified:null,image:"1f471-1f3ff.png",sheet_x:22,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F471-200D-2642-FE0F",a:"Person with Blond Hair",b:"1F471",d:!0,e:!0,f:!0,h:!1,k:[22,19],o:2,j:["金色头发的人"]},sloth:{a:"Sloth",b:"1F9A5",d:!0,e:!0,f:!0,h:!0,k:[42,53],o:12,j:["树獭"]},latin_cross:{a:"Latin Cross",b:"271D-FE0F",c:"271D",d:!0,e:!0,f:!0,h:!0,j:["拉丁十字架","基督教","christianity"],k:[55,14],o:2},curling_stone:{a:"Curling Stone",b:"1F94C",d:!0,e:!0,f:!0,h:!0,k:[41,27],o:5,j:["冰壶"]},cold_face:{a:"Freezing Face",b:"1F976",d:!0,e:!0,f:!0,h:!0,k:[42,11],o:11,j:["冰冻的脸"]},fried_egg:{a:"Cooking",b:"1F373",d:!0,e:!0,f:!0,h:!0,j:["烹饪","食物","早餐","厨房","蛋","food","breakfast","kitchen","egg"],k:[7,18],n:["cooking"],o:2},city_sunset:{a:"Cityscape at Dusk",b:"1F306",d:!0,e:!0,f:!0,h:!0,j:["黄昏市容","相片","傍晚","天空","建筑物","photo","evening","sky","buildings"],k:[5,25],o:2},musical_note:{a:"Musical Note",b:"1F3B5",d:!0,e:!0,f:!0,h:!0,j:["音符","得分","语气","声音","score","tone","sound"],k:[8,27],o:2},"flag-cm":{a:"Cameroon Flag",b:"1F1E8-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[1,21],o:2,j:["喀麦隆国旗"]},notes:{a:"Multiple Musical Notes",b:"1F3B6",d:!0,e:!0,f:!0,h:!0,j:["音符","音乐","得分","music","score"],k:[8,28],o:2},woozy_face:{a:"Face with Uneven Eyes and Wavy Mouth",b:"1F974",d:!0,e:!0,f:!0,h:!0,k:[42,9],o:11,j:["头昏眼花的脸"]},dart:{a:"Direct Hit",b:"1F3AF",d:!0,e:!0,f:!0,h:!0,j:["命中红心","游戏","玩","酒吧","game","play","bar"],k:[8,21],o:2},orthodox_cross:{a:"Orthodox Cross",b:"2626-FE0F",c:"2626",d:!0,e:!0,f:!0,h:!0,j:["东正教十字架","suppedaneum","宗教","suppedaneum","religion"],k:[53,11],o:2},shallow_pan_of_food:{a:"Shallow Pan of Food",b:"1F958",d:!0,e:!0,f:!0,h:!0,j:["浅盘食物","食物","烹饪","平底锅","海鲜饭","food","cooking","casserole","paella"],k:[41,39],o:4},otter:{a:"Otter",b:"1F9A6",d:!0,e:!0,f:!0,h:!0,k:[42,54],o:12,j:["獭"]},man:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB",non_qualified:null,image:"1f468-1f3fb.png",sheet_x:17,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC",non_qualified:null,image:"1f468-1f3fc.png",sheet_x:17,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD",non_qualified:null,image:"1f468-1f3fd.png",sheet_x:17,sheet_y:25,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE",non_qualified:null,image:"1f468-1f3fe.png",sheet_x:17,sheet_y:26,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF",non_qualified:null,image:"1f468-1f3ff.png",sheet_x:17,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Man",b:"1F468",d:!0,e:!0,f:!0,h:!0,j:["男人","胡子","爸爸","爸爸","家伙","优雅","先生","胡子","mustache","father","dad","guy","classy","sir","moustache"],k:[17,22],o:2},city_sunrise:{a:"Sunset over Buildings",b:"1F307",d:!0,e:!0,f:!0,h:!0,j:["日落","相片","早上好","黎明","photo","good morning","dawn"],k:[5,26],o:2},bearded_person:{skin_variations:{"1F3FB":{unified:"1F9D4-1F3FB",non_qualified:null,image:"1f9d4-1f3fb.png",sheet_x:48,sheet_y:29,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D4-1F3FC",non_qualified:null,image:"1f9d4-1f3fc.png",sheet_x:48,sheet_y:30,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D4-1F3FD",non_qualified:null,image:"1f9d4-1f3fd.png",sheet_x:48,sheet_y:31,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D4-1F3FE",non_qualified:null,image:"1f9d4-1f3fe.png",sheet_x:48,sheet_y:32,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D4-1F3FF",non_qualified:null,image:"1f9d4-1f3ff.png",sheet_x:48,sheet_y:33,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Bearded Person",b:"1F9D4",d:!0,e:!0,f:!0,h:!0,k:[48,28],o:5,j:["大胡子男人"]},skunk:{a:"Skunk",b:"1F9A8",d:!0,e:!0,f:!0,h:!0,k:[42,56],o:12,j:["臭鼬"]},stew:{a:"Pot of Food",b:"1F372",d:!0,e:!0,f:!0,h:!0,j:["锅装食品","食物","肉","汤","food","meat","soup"],k:[7,17],o:2},cn:{a:"China Flag",b:"1F1E8-1F1F3",d:!0,e:!0,f:!0,h:!0,j:["中国国旗","中国","中文","中华人民共和国","旗","国家","国家","旗帜","china","chinese","prc","flag","country","nation","banner"],k:[1,22],n:["flag-cn"],o:2},studio_microphone:{a:"Studio Microphone",b:"1F399-FE0F",c:"1F399",d:!0,e:!0,f:!0,h:!0,j:["录音室话筒","唱","录音","艺术家","脱口秀","sing","recording","artist","talkshow"],k:[8,1],o:2},star_and_crescent:{a:"Star and Crescent",b:"262A-FE0F",c:"262A",d:!0,e:!0,f:!0,h:!0,j:["星和月牙","伊斯兰","islam"],k:[53,12],o:2},"yo-yo":{a:"Yo-Yo",b:"1FA80",d:!0,e:!0,f:!0,h:!0,k:[52,1],o:12,j:["悠悠球"]},bridge_at_night:{a:"Bridge at Night",b:"1F309",d:!0,e:!0,f:!0,h:!0,j:["夜间大桥","相片","旧金山","photo","sanfrancisco"],k:[5,28],o:2},dizzy_face:{a:"Dizzy Face",b:"1F635",d:!0,e:!0,f:!0,h:!0,j:["晕眩的脸","花","无意识","异种","头晕","spent","unconscious","xox","dizzy"],k:[31,31],o:2},red_haired_man:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9B0",non_qualified:null,image:"1f468-1f3fb-200d-1f9b0.png",sheet_x:16,sheet_y:24,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9B0",non_qualified:null,image:"1f468-1f3fc-200d-1f9b0.png",sheet_x:16,sheet_y:25,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9B0",non_qualified:null,image:"1f468-1f3fd-200d-1f9b0.png",sheet_x:16,sheet_y:26,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9B0",non_qualified:null,image:"1f468-1f3fe-200d-1f9b0.png",sheet_x:16,sheet_y:27,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9B0",non_qualified:null,image:"1f468-1f3ff-200d-1f9b0.png",sheet_x:16,sheet_y:28,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Red Haired Man",b:"1F468-200D-1F9B0",d:!0,e:!0,f:!0,h:!0,k:[16,23],o:11,j:["红发男人"]},kite:{a:"Kite",b:"1FA81",d:!0,e:!0,f:!0,h:!0,k:[52,2],o:12,j:["风筝"]},bowl_with_spoon:{a:"Bowl with Spoon",b:"1F963",d:!0,e:!0,f:!0,h:!0,k:[41,50],o:5,j:["碗与勺"]},"flag-co":{a:"Colombia Flag",b:"1F1E8-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[1,23],o:2,j:["哥伦比亚国旗"]},peace_symbol:{a:"Peace Symbol",b:"262E-FE0F",c:"262E",d:!0,e:!0,f:!0,h:!0,j:["和平符号","嬉皮","hippie"],k:[53,13],o:2},kangaroo:{a:"Kangaroo",b:"1F998",d:!0,e:!0,f:!0,h:!0,k:[42,42],o:11,j:["袋鼠"]},hotsprings:{a:"Hot Springs",b:"2668-FE0F",c:"2668",d:!0,e:!0,f:!0,h:!0,j:["温泉","浴","温暖","放松","bath","warm","relax"],k:[53,37],o:2},exploding_head:{a:"Shocked Face with Exploding Head",b:"1F92F",d:!0,e:!0,f:!0,h:!0,k:[38,49],n:["shocked_face_with_exploding_head"],o:5,j:["脑洞大开"]},level_slider:{a:"Level Slider",b:"1F39A-FE0F",c:"1F39A",d:!0,e:!0,f:!0,h:!0,j:["调整桿","规模","scale"],k:[8,2],o:2},badger:{a:"Badger",b:"1F9A1",d:!0,e:!0,f:!0,h:!0,k:[42,51],o:11,j:["獾"]},"8ball":{a:"Billiards",b:"1F3B1",d:!0,e:!0,f:!0,h:!0,j:["8号球（台球）","池","爱好","游戏","运气","魔法","pool","hobby","game","luck","magic"],k:[8,23],o:2},curly_haired_man:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9B1",non_qualified:null,image:"1f468-1f3fb-200d-1f9b1.png",sheet_x:16,sheet_y:30,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9B1",non_qualified:null,image:"1f468-1f3fc-200d-1f9b1.png",sheet_x:16,sheet_y:31,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9B1",non_qualified:null,image:"1f468-1f3fd-200d-1f9b1.png",sheet_x:16,sheet_y:32,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9B1",non_qualified:null,image:"1f468-1f3fe-200d-1f9b1.png",sheet_x:16,sheet_y:33,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9B1",non_qualified:null,image:"1f468-1f3ff-200d-1f9b1.png",sheet_x:16,sheet_y:34,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Curly Haired Man",b:"1F468-200D-1F9B1",d:!0,e:!0,f:!0,h:!0,k:[16,29],o:11,j:["卷发男人"]},"flag-cp":{a:"Clipperton Island Flag",b:"1F1E8-1F1F5",d:!0,e:!0,f:!0,h:!0,k:[1,24],o:2,j:["克利珀顿岛旗"]},carousel_horse:{a:"Carousel Horse",b:"1F3A0",d:!0,e:!0,f:!0,h:!0,j:["转盘马","相片","狂欢节","photo","carnival"],k:[8,6],o:2},face_with_cowboy_hat:{a:"Face with Cowboy Hat",b:"1F920",d:!0,e:!0,f:!0,h:!0,k:[38,17],o:4,j:["牛仔帽的脸"]},menorah_with_nine_branches:{a:"Menorah with Nine Branches",b:"1F54E",d:!0,e:!0,f:!0,h:!0,k:[28,38],o:2,j:["灯台"]},green_salad:{a:"Green Salad",b:"1F957",d:!0,e:!0,f:!0,h:!0,j:["绿色沙拉","食物","健康","生菜","food","healthy","lettuce"],k:[41,38],o:4},control_knobs:{a:"Control Knobs",b:"1F39B-FE0F",c:"1F39B",d:!0,e:!0,f:!0,h:!0,j:["控制旋钮","拨号","dial"],k:[8,3],o:2},popcorn:{a:"Popcorn",b:"1F37F",d:!0,e:!0,f:!0,h:!0,j:["爆米花","食物","电影院","电影","小吃","food","movie theater","films","snack"],k:[7,30],o:2},six_pointed_star:{a:"Six Pointed Star with Middle Dot",b:"1F52F",d:!0,e:!0,f:!0,h:!0,j:["虚线六芒星","紫色方块","宗教","犹太的","六线形","purple-square","religion","jewish","hexagram"],k:[28,18],o:2},feet:{a:"Paw Prints",b:"1F43E",d:!0,e:!0,f:!0,h:!0,k:[12,34],n:["paw_prints"],o:2,j:["掌印"]},ferris_wheel:{a:"Ferris Wheel",b:"1F3A1",d:!0,e:!0,f:!0,h:!0,j:["摩天轮","相片","狂欢节","伦敦眼","photo","carnival","londoneye"],k:[8,7],o:2},microphone:{a:"Microphone",b:"1F3A4",d:!0,e:!0,f:!0,h:!0,j:["麦克风","声音","音乐","和","唱","脱口秀","sound","music","PA","sing","talkshow"],k:[8,10],o:2},crystal_ball:{a:"Crystal Ball",b:"1F52E",d:!0,e:!0,f:!0,h:!0,j:["水晶球","磁盘","党","魔法","马戏团","fortune_teller","disco","party","magic","circus","fortune_teller"],k:[28,17],o:2},partying_face:{a:"Face with Party Horn and Party Hat",b:"1F973",d:!0,e:!0,f:!0,h:!0,k:[42,8],o:11,j:["派对","猫脸"]},"flag-cr":{a:"Costa Rica Flag",b:"1F1E8-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[1,25],o:2,j:["哥斯达黎加国旗"]},white_haired_man:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9B3",non_qualified:null,image:"1f468-1f3fb-200d-1f9b3.png",sheet_x:16,sheet_y:42,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9B3",non_qualified:null,image:"1f468-1f3fc-200d-1f9b3.png",sheet_x:16,sheet_y:43,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9B3",non_qualified:null,image:"1f468-1f3fd-200d-1f9b3.png",sheet_x:16,sheet_y:44,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9B3",non_qualified:null,image:"1f468-1f3fe-200d-1f9b3.png",sheet_x:16,sheet_y:45,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9B3",non_qualified:null,image:"1f468-1f3ff-200d-1f9b3.png",sheet_x:16,sheet_y:46,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"White Haired Man",b:"1F468-200D-1F9B3",d:!0,e:!0,f:!0,h:!0,k:[16,41],o:11,j:["白发男人"]},headphones:{a:"Headphone",b:"1F3A7",d:!0,e:!0,f:!0,h:!0,j:["耳机","音乐","得分","产品","music","score","gadgets"],k:[8,13],o:2},bald_man:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9B2",non_qualified:null,image:"1f468-1f3fb-200d-1f9b2.png",sheet_x:16,sheet_y:36,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9B2",non_qualified:null,image:"1f468-1f3fc-200d-1f9b2.png",sheet_x:16,sheet_y:37,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9B2",non_qualified:null,image:"1f468-1f3fd-200d-1f9b2.png",sheet_x:16,sheet_y:38,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9B2",non_qualified:null,image:"1f468-1f3fe-200d-1f9b2.png",sheet_x:16,sheet_y:39,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9B2",non_qualified:null,image:"1f468-1f3ff-200d-1f9b2.png",sheet_x:16,sheet_y:40,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Bald Man",b:"1F468-200D-1F9B2",d:!0,e:!0,f:!0,h:!0,k:[16,35],o:11,j:["光头男人"]},sunglasses:{a:"Smiling Face with Sunglasses",b:"1F60E",d:!0,e:!0,f:!0,h:!0,j:["带太阳镜的笑脸","脸","凉","微笑","夏天","海滩","太阳 眼镜","face","cool","smile","summer","beach","sunglass"],k:[30,49],l:["8)"],o:2},butter:{a:"Butter",b:"1F9C8",d:!0,e:!0,f:!0,h:!0,k:[44,16],o:12,j:["牛油"]},roller_coaster:{a:"Roller Coaster",b:"1F3A2",d:!0,e:!0,f:!0,h:!0,j:["过山车","狂欢节","操场","相片","乐趣","carnival","playground","photo","fun"],k:[8,8],o:2},turkey:{a:"Turkey",b:"1F983",d:!0,e:!0,f:!0,h:!0,j:["火鸡","动物","鸟","animal","bird"],k:[42,21],o:2},nazar_amulet:{a:"Nazar Amulet",b:"1F9FF",d:!0,e:!0,f:!0,h:!0,k:[51,50],o:11,j:["纳扎尔护身符"]},"flag-cu":{a:"Cuba Flag",b:"1F1E8-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[1,26],o:2,j:["古巴国旗"]},aries:{a:"Aries",b:"2648",d:!0,e:!0,f:!0,h:!0,j:["白羊座","标志","紫色方块","黄道带","占星学","sign","purple-square","zodiac","astrology"],k:[53,20],o:2},"flag-cv":{a:"Cape Verde Flag",b:"1F1E8-1F1FB",d:!0,e:!0,f:!0,h:!0,k:[1,27],o:2,j:["佛得角国旗"]},barber:{a:"Barber Pole",b:"1F488",d:!0,e:!0,f:!0,h:!0,j:["理发店招牌","毛","客厅","风格","hair","salon","style"],k:[25,18],o:2},taurus:{a:"Taurus",b:"2649",d:!0,e:!0,f:!0,h:!0,j:["金牛座","紫色方块","标志","黄道带","占星学","purple-square","sign","zodiac","astrology"],k:[53,21],o:2},salt:{a:"Salt Shaker",b:"1F9C2",d:!0,e:!0,f:!0,h:!0,k:[44,10],o:11,j:["盐"]},woman:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB",non_qualified:null,image:"1f469-1f3fb.png",sheet_x:20,sheet_y:10,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC",non_qualified:null,image:"1f469-1f3fc.png",sheet_x:20,sheet_y:11,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD",non_qualified:null,image:"1f469-1f3fd.png",sheet_x:20,sheet_y:12,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE",non_qualified:null,image:"1f469-1f3fe.png",sheet_x:20,sheet_y:13,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF",non_qualified:null,image:"1f469-1f3ff.png",sheet_x:20,sheet_y:14,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Woman",b:"1F469",d:!0,e:!0,f:!0,h:!0,j:["女人","女性","女孩","女士","female","girls","lady"],k:[20,9],o:2},video_game:{a:"Video Game",b:"1F3AE",d:!0,e:!0,f:!0,h:!0,j:["电玩游戏","玩","安慰","断续器","控制器","play","console","PS4","controller"],k:[8,20],o:2},chicken:{a:"Chicken",b:"1F414",d:!0,e:!0,f:!0,h:!0,j:["鸡","动物","咯咯","自然界","鸟","animal","cluck","nature","bird"],k:[11,48],o:2},radio:{a:"Radio",b:"1F4FB",d:!0,e:!0,f:!0,h:!0,j:["收音机","通信","音乐","播客","程序","communication","music","podcast","program"],k:[27,24],o:2},nerd_face:{a:"Nerd Face",b:"1F913",d:!0,e:!0,f:!0,h:!0,j:["书呆子的脸","脸","宅","怪胎","笨蛋","face","nerdy","geek","dork"],k:[37,26],o:2},red_haired_woman:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9B0",non_qualified:null,image:"1f469-1f3fb-200d-1f9b0.png",sheet_x:19,sheet_y:9,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9B0",non_qualified:null,image:"1f469-1f3fc-200d-1f9b0.png",sheet_x:19,sheet_y:10,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9B0",non_qualified:null,image:"1f469-1f3fd-200d-1f9b0.png",sheet_x:19,sheet_y:11,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9B0",non_qualified:null,image:"1f469-1f3fe-200d-1f9b0.png",sheet_x:19,sheet_y:12,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9B0",non_qualified:null,image:"1f469-1f3ff-200d-1f9b0.png",sheet_x:19,sheet_y:13,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Red Haired Woman",b:"1F469-200D-1F9B0",d:!0,e:!0,f:!0,h:!0,k:[19,8],o:11,j:["红发女人"]},circus_tent:{a:"Circus Tent",b:"1F3AA",d:!0,e:!0,f:!0,h:!0,j:["马戏团的帐篷","节日","狂欢节","党","festival","carnival","party"],k:[8,16],o:2},face_with_monocle:{a:"Face with Monocle",b:"1F9D0",d:!0,e:!0,f:!0,h:!0,k:[45,16],o:5,j:["带有单片眼镜的脸"]},canned_food:{a:"Canned Food",b:"1F96B",d:!0,e:!0,f:!0,h:!0,k:[42,1],o:5,j:["罐头食品"]},"flag-cw":{a:"Curaçao Flag",b:"1F1E8-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[1,28],o:2,j:["库拉索国旗"]},gemini:{a:"Gemini",b:"264A",d:!0,e:!0,f:!0,h:!0,j:["双子座","标志","黄道带","紫色方块","占星学","sign","zodiac","purple-square","astrology"],k:[53,22],o:2},saxophone:{a:"Saxophone",b:"1F3B7",d:!0,e:!0,f:!0,h:!0,j:["萨克斯管","音乐","仪器","爵士乐","蓝调","music","instrument","jazz","blues"],k:[8,29],o:2},rooster:{a:"Rooster",b:"1F413",d:!0,e:!0,f:!0,h:!0,j:["公鸡","动物","自然界","鸡","animal","nature","chicken"],k:[11,47],o:2},joystick:{a:"Joystick",b:"1F579-FE0F",c:"1F579",d:!0,e:!0,f:!0,h:!0,j:["游戏杆","游戏","玩","game","play"],k:[29,36],o:2},guitar:{a:"Guitar",b:"1F3B8",d:!0,e:!0,f:!0,h:!0,j:["吉他","音乐","仪器","music","instrument"],k:[8,30],o:2},slot_machine:{a:"Slot Machine",b:"1F3B0",d:!0,e:!0,f:!0,h:!0,j:["老虎机","但","赌博","维加斯","水果机","运气","赌场","bet","gamble","vegas","fruit machine","luck","casino"],k:[8,22],o:2},bento:{a:"Bento Box",b:"1F371",d:!0,e:!0,f:!0,h:!0,j:["便当盒","食物","日语","箱","food","japanese","box"],k:[7,16],o:2},steam_locomotive:{a:"Steam Locomotive",b:"1F682",d:!0,e:!0,f:!0,h:!0,j:["火车头","运输","车辆","火车","transportation","vehicle","train"],k:[34,1],o:2},confused:{a:"Confused Face",b:"1F615",d:!0,e:!0,f:!0,h:!0,j:["困惑的脸","脸","冷漠","哼","奇怪","嗯嗯",":/","face","indifference","huh","weird","hmmm",":/"],k:[30,56],l:[":\\",":-\\",":/",":-/"],o:2},"flag-cx":{a:"ChristmasIslandFlag",b:"1F1E8-1F1FD",d:!0,e:!0,f:!0,h:!0,k:[1,29],o:2,j:["圣诞岛旗"]},hatching_chick:{a:"HatchingChick",b:"1F423",d:!0,e:!0,f:!0,h:!0,j:["孵化小鸡","动物","鸡","蛋","出生","婴儿","鸟","animal","chicken","egg","born","baby","bird"],k:[12,7],o:2},cancer:{a:"Cancer",b:"264B",d:!0,e:!0,f:!0,h:!0,j:["巨蟹座","标志","黄道带","紫色方块","占星学","sign","zodiac","purple-square","astrology"],k:[53,23],o:2},red_haired_person:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9B0",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9b0.png",sheet_x:47,sheet_y:14,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9B0",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9b0.png",sheet_x:47,sheet_y:15,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9B0",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9b0.png",sheet_x:47,sheet_y:16,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9B0",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9b0.png",sheet_x:47,sheet_y:17,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9B0",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9b0.png",sheet_x:47,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"RedHairedPerson",b:"1F9D1-200D-1F9B0",d:!0,e:!1,f:!1,h:!1,k:[47,13],o:12,j:["红发"]},"flag-cy":{a:"CyprusFlag",b:"1F1E8-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[1,30],o:2,j:["塞浦路斯国旗"]},worried:{a:"WorriedFace",b:"1F61F",d:!0,e:!0,f:!0,h:!0,j:["忧心忡忡的脸","脸","关注","紧张",":(","face","concern","nervous",":("],k:[31,9],o:2},railway_car:{a:"RailwayCar",b:"1F683",d:!0,e:!0,f:!0,h:!0,j:["铁路车","运输","车辆","transportation","vehicle"],k:[34,2],o:2},leo:{a:"Leo",b:"264C",d:!0,e:!0,f:!0,h:!0,j:["狮子座","标志","紫色方块","黄道带","占星学","sign","purple-square","zodiac","astrology"],k:[53,24],o:2},curly_haired_woman:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9B1",non_qualified:null,image:"1f469-1f3fb-200d-1f9b1.png",sheet_x:19,sheet_y:15,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9B1",non_qualified:null,image:"1f469-1f3fc-200d-1f9b1.png",sheet_x:19,sheet_y:16,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9B1",non_qualified:null,image:"1f469-1f3fd-200d-1f9b1.png",sheet_x:19,sheet_y:17,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9B1",non_qualified:null,image:"1f469-1f3fe-200d-1f9b1.png",sheet_x:19,sheet_y:18,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9B1",non_qualified:null,image:"1f469-1f3ff-200d-1f9b1.png",sheet_x:19,sheet_y:19,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"CurlyHairedWoman",b:"1F469-200D-1F9B1",d:!0,e:!0,f:!0,h:!0,k:[19,14],o:11,j:["卷发女人"]},baby_chick:{a:"BabyChick",b:"1F424",d:!0,e:!0,f:!0,h:!0,j:["小鸡","动物","鸡","鸟","animal","chicken","bird"],k:[12,8],o:2},musical_keyboard:{a:"MusicalKeyboard",b:"1F3B9",d:!0,e:!0,f:!0,h:!0,j:["音乐键盘","计划","仪器","组成","piano","instrument","compose"],k:[8,31],o:2},game_die:{a:"GameDie",b:"1F3B2",d:!0,e:!0,f:!0,h:!0,j:["骰子","说","随机","桌面","玩","运气","dice","random","tabletop","play","luck"],k:[8,24],o:2},rice_cracker:{a:"RiceCracker",b:"1F358",d:!0,e:!0,f:!0,h:!0,j:["米果","食物","日语","food","japanese"],k:[6,48],o:2},virgo:{a:"Virgo",b:"264D",d:!0,e:!0,f:!0,h:!0,j:["处女座","标志","黄道带","紫色方块","占星学","sign","zodiac","purple-square","astrology"],k:[53,25],o:2},"flag-cz":{a:"CzechiaFlag",b:"1F1E8-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[1,31],o:2,j:["捷克国旗"]},curly_haired_person:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9B1",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9b1.png",sheet_x:47,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9B1",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9b1.png",sheet_x:47,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9B1",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9b1.png",sheet_x:47,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9B1",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9b1.png",sheet_x:47,sheet_y:23,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9B1",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9b1.png",sheet_x:47,sheet_y:24,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"CurlyHairedPerson",b:"1F9D1-200D-1F9B1",d:!0,e:!1,f:!1,h:!1,k:[47,19],o:12,j:["卷发"]},rice_ball:{a:"RiceBall",b:"1F359",d:!0,e:!0,f:!0,h:!0,j:["饭团","食物","日语","food","japanese"],k:[6,49],o:2},hatched_chick:{a:"Front-FacingBabyChick",b:"1F425",d:!0,e:!0,f:!0,h:!0,j:["面向前的小鸡","动物","鸡","婴儿","鸟","animal","chicken","baby","bird"],k:[12,9],o:2},jigsaw:{a:"JigsawPuzzlePiece",b:"1F9E9",d:!0,e:!0,f:!0,h:!0,k:[51,28],o:11,j:["一块拼图"]},trumpet:{a:"Trumpet",b:"1F3BA",d:!0,e:!0,f:!0,h:!0,j:["喇叭","音乐","黄铜","music","brass"],k:[8,32],o:2},slightly_frowning_face:{a:"SlightlyFrowningFace",b:"1F641",d:!0,e:!0,f:!0,h:!0,j:["微微皱眉的脸","脸","皱 着 眉头","失望","伤心","沮丧","face","frowning","disappointed","sad","upset"],k:[31,43],o:2},bullettrain_side:{a:"High-SpeedTrain",b:"1F684",d:!0,e:!0,f:!0,h:!0,j:["高速火车","运输","车辆","transportation","vehicle"],k:[34,3],o:2},libra:{a:"Libra",b:"264E",d:!0,e:!0,f:!0,h:!0,j:["天秤座","标志","紫色方块","黄道带","占星学","sign","purple-square","zodiac","astrology"],k:[53,26],o:2},de:{a:"GermanyFlag",b:"1F1E9-1F1EA",d:!0,e:!0,f:!0,h:!0,j:["德国国旗","德语","国家","旗","国家","旗帜","german","nation","flag","country","banner"],k:[1,32],n:["flag-de"],o:2},rice:{a:"CookedRice",b:"1F35A",d:!0,e:!0,f:!0,h:!0,j:["熟米饭","食物","中国","亚裔","food","china","asian"],k:[6,50],o:2},violin:{a:"Violin",b:"1F3BB",d:!0,e:!0,f:!0,h:!0,j:["小提琴","音乐","仪器","管弦乐队","交响曲","music","instrument","orchestra","symphony"],k:[8,33],o:2},white_haired_woman:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9B3",non_qualified:null,image:"1f469-1f3fb-200d-1f9b3.png",sheet_x:19,sheet_y:27,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9B3",non_qualified:null,image:"1f469-1f3fc-200d-1f9b3.png",sheet_x:19,sheet_y:28,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9B3",non_qualified:null,image:"1f469-1f3fd-200d-1f9b3.png",sheet_x:19,sheet_y:29,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9B3",non_qualified:null,image:"1f469-1f3fe-200d-1f9b3.png",sheet_x:19,sheet_y:30,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9B3",non_qualified:null,image:"1f469-1f3ff-200d-1f9b3.png",sheet_x:19,sheet_y:31,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WhiteHairedWoman",b:"1F469-200D-1F9B3",d:!0,e:!0,f:!0,h:!0,k:[19,26],o:11,j:["白头发女人"]},bird:{a:"Bird",b:"1F426",d:!0,e:!0,f:!0,h:!0,j:["鸟","动物","自然界","飞","鸣叫","春天","animal","nature","fly","tweet","spring"],k:[12,10],o:2},white_frowning_face:{a:"WhiteFrowningFace",b:"2639-FE0F",c:"2639",d:!0,e:!0,f:!0,h:!0,k:[53,16],o:2,j:["皱眉表情"]},bullettrain_front:{a:"High-SpeedTrainwithBulletNose",b:"1F685",d:!0,e:!0,f:!0,h:!0,j:["子弹头列车","运输","车辆","速度","几乎","公共","旅行","transportation","vehicle","speed","fast","public","travel"],k:[34,4],o:2},teddy_bear:{a:"TeddyBear",b:"1F9F8",d:!0,e:!0,f:!0,h:!0,k:[51,43],o:11,j:["泰迪熊"]},white_haired_person:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9B3",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9b3.png",sheet_x:47,sheet_y:32,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9B3",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9b3.png",sheet_x:47,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9B3",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9b3.png",sheet_x:47,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9B3",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9b3.png",sheet_x:47,sheet_y:35,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9B3",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9b3.png",sheet_x:47,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"WhiteHairedPerson",b:"1F9D1-200D-1F9B3",d:!0,e:!1,f:!1,h:!1,k:[47,31],o:12,j:["白发"]},spades:{a:"BlackSpadeSuit",b:"2660-FE0F",c:"2660",d:!0,e:!0,f:!0,h:!0,j:["黑桃","扑克","卡","适合","魔法","poker","cards","suits","magic"],k:[53,33],o:2},banjo:{a:"Banjo",b:"1FA95",d:!0,e:!0,f:!0,h:!0,k:[52,9],o:12,j:["班卓琴"]},train2:{a:"Train",b:"1F686",d:!0,e:!0,f:!0,h:!0,j:["火车","运输","车辆","transportation","vehicle"],k:[34,5],o:2},scorpius:{a:"Scorpius",b:"264F",d:!0,e:!0,f:!0,h:!0,j:["天蝎座","标志","黄道带","紫色方块","占星学","天蝎座","sign","zodiac","purple-square","astrology","scorpio"],k:[53,27],o:2},curry:{a:"CurryandRice",b:"1F35B",d:!0,e:!0,f:!0,h:!0,j:["咖喱饭","食物","辣","热","印度","food","spicy","hot","indian"],k:[6,51],o:2},open_mouth:{a:"FacewithOpenMouth",b:"1F62E",d:!0,e:!0,f:!0,h:!0,j:["张着嘴的脸","脸","惊喜","印象","哇","哇","：O","face","surprise","impressed","wow","whoa",":O"],k:[31,24],l:[":o",":-o",":O",":-O"],o:2},"flag-dg":{a:"DiegoGarciaFlag",b:"1F1E9-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[1,33],o:2,j:["迪戈加西亚旗"]},penguin:{a:"Penguin",b:"1F427",d:!0,e:!0,f:!0,h:!0,j:["企鹅","动物","自然界","animal","nature"],k:[12,11],o:2},hearts:{a:"BlackHeartSuit",b:"2665-FE0F",c:"2665",d:!0,e:!0,f:!0,h:!0,j:["红心","扑克","卡","魔法","适合","poker","cards","magic","suits"],k:[53,35],o:2},ramen:{a:"SteamingBowl",b:"1F35C",d:!0,e:!0,f:!0,h:!0,j:["热气腾腾的拉面","食物","日语","面条","筷子","food","japanese","noodle","chopsticks"],k:[6,52],o:2},sagittarius:{a:"Sagittarius",b:"2650",d:!0,e:!0,f:!0,h:!0,j:["射手座","标志","黄道带","紫色方块","占星学","sign","zodiac","purple-square","astrology"],k:[53,28],o:2},bald_woman:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9B2",non_qualified:null,image:"1f469-1f3fb-200d-1f9b2.png",sheet_x:19,sheet_y:21,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9B2",non_qualified:null,image:"1f469-1f3fc-200d-1f9b2.png",sheet_x:19,sheet_y:22,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9B2",non_qualified:null,image:"1f469-1f3fd-200d-1f9b2.png",sheet_x:19,sheet_y:23,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9B2",non_qualified:null,image:"1f469-1f3fe-200d-1f9b2.png",sheet_x:19,sheet_y:24,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9B2",non_qualified:null,image:"1f469-1f3ff-200d-1f9b2.png",sheet_x:19,sheet_y:25,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"BaldWoman",b:"1F469-200D-1F9B2",d:!0,e:!0,f:!0,h:!0,k:[19,20],o:11,j:["光头女人"]},dove_of_peace:{a:"DoveofPeace",b:"1F54A-FE0F",c:"1F54A",d:!0,e:!0,f:!0,h:!0,k:[28,34],o:2,j:["鸽子"]},hushed:{a:"HushedFace",b:"1F62F",d:!0,e:!0,f:!0,h:!0,j:["噤声的脸","脸","追求","嘘","face","woo","shh"],k:[31,25],o:2},metro:{a:"Metro",b:"1F687",d:!0,e:!0,f:!0,h:!0,j:["地铁","运输","蓝色方块","捷运","地下","管","transportation","blue-square","mrt","underground","tube"],k:[34,6],o:2},"flag-dj":{a:"DjiboutiFlag",b:"1F1E9-1F1EF",d:!0,e:!0,f:!0,h:!0,k:[1,34],o:2,j:["吉布提国旗"]},drum_with_drumsticks:{a:"DrumwithDrumsticks",b:"1F941",d:!0,e:!0,f:!0,h:!0,k:[41,17],o:4,j:["鼓"]},spaghetti:{a:"Spaghetti",b:"1F35D",d:!0,e:!0,f:!0,h:!0,j:["意大利面","食物","意大利语","面条","food","italian","noodle"],k:[6,53],o:2},eagle:{a:"Eagle",b:"1F985",d:!0,e:!0,f:!0,h:!0,j:["鹰","动物","自然界","鸟","animal","nature","bird"],k:[42,23],o:4},astonished:{a:"AstonishedFace",b:"1F632",d:!0,e:!0,f:!0,h:!0,j:["惊讶的脸","脸","异种","惊讶","中毒","face","xox","surprised","poisoned"],k:[31,28],o:2},capricorn:{a:"Capricorn",b:"2651",d:!0,e:!0,f:!0,h:!0,j:["摩羯座","标志","黄道带","紫色方块","占星学","sign","zodiac","purple-square","astrology"],k:[53,29],o:2},light_rail:{a:"LightRail",b:"1F688",d:!0,e:!0,f:!0,h:!0,j:["轻轨列车","运输","车辆","transportation","vehicle"],k:[34,7],o:2},"flag-dk":{a:"DenmarkFlag",b:"1F1E9-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[1,35],o:2,j:["丹麦国旗"]},iphone:{a:"MobilePhone",b:"1F4F1",d:!0,e:!0,f:!0,h:!0,j:["手机","科技","苹果","产品","拨号","technology","apple","gadgets","dial"],k:[27,14],o:2},bald_person:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9B2",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9b2.png",sheet_x:47,sheet_y:26,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9B2",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9b2.png",sheet_x:47,sheet_y:27,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9B2",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9b2.png",sheet_x:47,sheet_y:28,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9B2",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9b2.png",sheet_x:47,sheet_y:29,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9B2",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9b2.png",sheet_x:47,sheet_y:30,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"BaldPerson",b:"1F9D1-200D-1F9B2",d:!0,e:!1,f:!1,h:!1,k:[47,25],o:12,j:["秃顶男子","光头男子","光头男子"]},diamonds:{a:"BlackDiamondSuit",b:"2666-FE0F",c:"2666",d:!0,e:!0,f:!0,h:!0,j:["钻石","扑克","卡","魔法","适合","poker","cards","magic","suits"],k:[53,36],o:2},clubs:{a:"BlackClubSuit",b:"2663-FE0F",c:"2663",d:!0,e:!0,f:!0,h:!0,j:["梅花","扑克","卡","魔法","适合","poker","cards","magic","suits"],k:[53,34],o:2},aquarius:{a:"Aquarius",b:"2652",d:!0,e:!0,f:!0,h:!0,j:["水瓶座","标志","紫色方块","黄道带","占星学","sign","purple-square","zodiac","astrology"],k:[53,30],o:2},sweet_potato:{a:"RoastedSweetPotato",b:"1F360",d:!0,e:!0,f:!0,h:!0,j:["红薯","食物","自然界","food","nature"],k:[6,56],o:2},"flag-dm":{a:"DominicaFlag",b:"1F1E9-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[1,36],o:2,j:["多米尼加国旗"]},duck:{a:"Duck",b:"1F986",d:!0,e:!0,f:!0,h:!0,j:["鸭","动物","自然界","鸟","马拉德","animal","nature","bird","mallard"],k:[42,24],o:4},calling:{a:"MobilePhonewithRightwardsArrowatLeft",b:"1F4F2",d:!0,e:!0,f:!0,h:!0,j:["带箭头的手机","苹果手机","传入","iphone","incoming"],k:[27,15],o:2},station:{a:"Station",b:"1F689",d:!0,e:!0,f:!0,h:!0,j:["站","运输","车辆","公共","transportation","vehicle","public"],k:[34,8],o:2},"blond-haired-woman":{skin_variations:{"1F3FB":{unified:"1F471-1F3FB-200D-2640-FE0F",non_qualified:"1F471-1F3FB-200D-2640",image:"1f471-1f3fb-200d-2640-fe0f.png",sheet_x:22,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F471-1F3FC-200D-2640-FE0F",non_qualified:"1F471-1F3FC-200D-2640",image:"1f471-1f3fc-200d-2640-fe0f.png",sheet_x:22,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F471-1F3FD-200D-2640-FE0F",non_qualified:"1F471-1F3FD-200D-2640",image:"1f471-1f3fd-200d-2640-fe0f.png",sheet_x:22,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F471-1F3FE-200D-2640-FE0F",non_qualified:"1F471-1F3FE-200D-2640",image:"1f471-1f3fe-200d-2640-fe0f.png",sheet_x:22,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F471-1F3FF-200D-2640-FE0F",non_qualified:"1F471-1F3FF-200D-2640",image:"1f471-1f3ff-200d-2640-fe0f.png",sheet_x:22,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"BlondHairedWoman",b:"1F471-200D-2640-FE0F",c:"1F471-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[22,7],o:4,j:["金发女人"]},flushed:{a:"FlushedFace",b:"1F633",d:!0,e:!0,f:!0,h:!0,j:["红扑扑的脸","脸","脸红","害羞","受宠若惊","face","blush","shy","flattered"],k:[31,29],o:2},pisces:{a:"Pisces",b:"2653",d:!0,e:!0,f:!0,h:!0,j:["双鱼座","紫色方块","标志","黄道带","占星学","purple-square","sign","zodiac","astrology"],k:[53,31],o:2},chess_pawn:{a:"ChessPawn",b:"265F-FE0F",c:"265F",d:!0,e:!0,f:!0,h:!0,k:[53,32],o:11,j:["西洋棋"]},"blond-haired-man":{skin_variations:{"1F3FB":{unified:"1F471-1F3FB-200D-2642-FE0F",non_qualified:"1F471-1F3FB-200D-2642",image:"1f471-1f3fb-200d-2642-fe0f.png",sheet_x:22,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F471-1F3FC-200D-2642-FE0F",non_qualified:"1F471-1F3FC-200D-2642",image:"1f471-1f3fc-200d-2642-fe0f.png",sheet_x:22,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F471-1F3FD-200D-2642-FE0F",non_qualified:"1F471-1F3FD-200D-2642",image:"1f471-1f3fd-200d-2642-fe0f.png",sheet_x:22,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F471-1F3FE-200D-2642-FE0F",non_qualified:"1F471-1F3FE-200D-2642",image:"1f471-1f3fe-200d-2642-fe0f.png",sheet_x:22,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F471-1F3FF-200D-2642-FE0F",non_qualified:"1F471-1F3FF-200D-2642",image:"1f471-1f3ff-200d-2642-fe0f.png",sheet_x:22,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F471",a:"BlondHairedMan",b:"1F471-200D-2642-FE0F",c:"1F471-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[22,13],o:4,j:["金发男人"]},phone:{a:"BlackTelephone",b:"260E-FE0F",c:"260E",d:!0,e:!0,f:!0,h:!0,j:["电话","科技","通信","拨号","电话","technology","communication","dial","telephone"],k:[52,54],n:["telephone"],o:2},oden:{a:"Oden",b:"1F362",d:!0,e:!0,f:!0,h:!0,j:["关东煮","食物","日语","food","japanese"],k:[7,1],o:2},"flag-do":{a:"DominicanRepublicFlag",b:"1F1E9-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[1,37],o:2,j:["多米尼加共和国国旗"]},tram:{a:"Tram",b:"1F68A",d:!0,e:!0,f:!0,h:!0,j:["电车","运输","车辆","transportation","vehicle"],k:[34,9],o:2},swan:{a:"Swan",b:"1F9A2",d:!0,e:!0,f:!0,h:!0,k:[42,52],o:11,j:["天鹅"]},pleading_face:{a:"FacewithPleadingEyes",b:"1F97A",d:!0,e:!0,f:!0,h:!0,k:[42,12],o:11,j:["苦苦哀求的脸"]},"flag-dz":{a:"AlgeriaFlag",b:"1F1E9-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[1,38],o:2,j:["阿尔及利亚国旗"]},monorail:{a:"Monorail",b:"1F69D",d:!0,e:!0,f:!0,h:!0,j:["单轨电车","运输","车辆","transportation","vehicle"],k:[34,28],o:2},owl:{a:"Owl",b:"1F989",d:!0,e:!0,f:!0,h:!0,j:["猫头鹰","动物","自然界","鸟","叫声","animal","nature","bird","hoot"],k:[42,27],o:4},sushi:{a:"Sushi",b:"1F363",d:!0,e:!0,f:!0,h:!0,j:["寿司","食物","鱼","日语","米","food","fish","japanese","rice"],k:[7,2],o:2},telephone_receiver:{a:"TelephoneReceiver",b:"1F4DE",d:!0,e:!0,f:!0,h:!0,j:["电话受话器","科技","通信","拨号","technology","communication","dial"],k:[26,52],o:2},black_joker:{a:"PlayingCardBlackJoker",b:"1F0CF",d:!0,e:!0,f:!0,h:!0,j:["鬼牌","扑克","卡","游戏","玩","魔法","poker","cards","game","play","magic"],k:[0,15],o:2},ophiuchus:{a:"Ophiuchus",b:"26CE",d:!0,e:!0,f:!0,h:!0,j:["蛇夫座","标志","紫色方块","星座","占星学","sign","purple-square","constellation","astrology"],k:[54,4],o:2},frowning:{a:"FrowningFacewithOpenMouth",b:"1F626",d:!0,e:!0,f:!0,h:!0,j:["皱眉张嘴的脸","脸","唉","什么","face","aw","what"],k:[31,16],o:2},older_adult:{skin_variations:{"1F3FB":{unified:"1F9D3-1F3FB",non_qualified:null,image:"1f9d3-1f3fb.png",sheet_x:48,sheet_y:23,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D3-1F3FC",non_qualified:null,image:"1f9d3-1f3fc.png",sheet_x:48,sheet_y:24,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D3-1F3FD",non_qualified:null,image:"1f9d3-1f3fd.png",sheet_x:48,sheet_y:25,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D3-1F3FE",non_qualified:null,image:"1f9d3-1f3fe.png",sheet_x:48,sheet_y:26,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D3-1F3FF",non_qualified:null,image:"1f9d3-1f3ff.png",sheet_x:48,sheet_y:27,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"OlderAdult",b:"1F9D3",d:!0,e:!0,f:!0,h:!0,k:[48,22],o:5,j:["老年人"]},"flag-ea":{a:"Ceuta&MelillaFlag",b:"1F1EA-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[1,39],o:2,j:["休达和梅利利亚国旗"]},flamingo:{a:"Flamingo",b:"1F9A9",d:!0,e:!0,f:!0,h:!0,k:[43,0],o:12,j:["红鹳"]},pager:{a:"Pager",b:"1F4DF",d:!0,e:!0,f:!0,h:!0,j:["呼叫器","英国广播公司","老派","90年代","bbcall","oldschool","90s"],k:[26,53],o:2},mountain_railway:{a:"MountainRailway",b:"1F69E",d:!0,e:!0,f:!0,h:!0,j:["山区铁路","运输","车辆","transportation","vehicle"],k:[34,29],o:2},mahjong:{a:"MahjongTileRedDragon",b:"1F004",d:!0,e:!0,f:!0,h:!0,j:["红中（麻将）","游戏","玩","中文","汉字","game","play","chinese","kanji"],k:[0,14],o:2},older_man:{skin_variations:{"1F3FB":{unified:"1F474-1F3FB",non_qualified:null,image:"1f474-1f3fb.png",sheet_x:22,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F474-1F3FC",non_qualified:null,image:"1f474-1f3fc.png",sheet_x:22,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F474-1F3FD",non_qualified:null,image:"1f474-1f3fd.png",sheet_x:22,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F474-1F3FE",non_qualified:null,image:"1f474-1f3fe.png",sheet_x:22,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F474-1F3FF",non_qualified:null,image:"1f474-1f3ff.png",sheet_x:22,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"OlderMan",b:"1F474",d:!0,e:!0,f:!0,h:!0,j:["老爷爷","人","雄","男人","老","长老","前辈","human","male","men","old","elder","senior"],k:[22,49],o:2},twisted_rightwards_arrows:{a:"TwistedRightwardsArrows",b:"1F500",d:!0,e:!0,f:!0,h:!0,j:["随机曲目按钮","蓝色方块","洗牌","音乐","随机","blue-square","shuffle","music","random"],k:[27,28],o:2},fried_shrimp:{a:"FriedShrimp",b:"1F364",d:!0,e:!0,f:!0,h:!0,j:["炸虾","食物","动物","前菜","夏天","food","animal","appetizer","summer"],k:[7,3],o:2},anguished:{a:"AnguishedFace",b:"1F627",d:!0,e:!0,f:!0,h:!0,j:["震惊的脸","脸","震惊","紧张","face","stunned","nervous"],k:[31,17],l:["D:"],o:2},repeat:{a:"ClockwiseRightwardsandLeftwardsOpenCircleArrows",b:"1F501",d:!0,e:!0,f:!0,h:!0,j:["循环播放按钮","圈","记录","loop","record"],k:[27,29],o:2},fish_cake:{a:"FishCakewithSwirlDesign",b:"1F365",d:!0,e:!0,f:!0,h:!0,j:["鱼板","食物","日本","海","海滩","名嗣","粉红色","旋流","鱼糕","鱼糜","估计","food","japan","sea","beach","narutomaki","pink","swirl","kamaboko","surimi","ramen"],k:[7,4],o:2},fax:{a:"FaxMachine",b:"1F4E0",d:!0,e:!0,f:!0,h:!0,j:["传真机","通信","科技","communication","technology"],k:[26,54],o:2},older_woman:{skin_variations:{"1F3FB":{unified:"1F475-1F3FB",non_qualified:null,image:"1f475-1f3fb.png",sheet_x:22,sheet_y:56,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F475-1F3FC",non_qualified:null,image:"1f475-1f3fc.png",sheet_x:23,sheet_y:0,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F475-1F3FD",non_qualified:null,image:"1f475-1f3fd.png",sheet_x:23,sheet_y:1,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F475-1F3FE",non_qualified:null,image:"1f475-1f3fe.png",sheet_x:23,sheet_y:2,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F475-1F3FF",non_qualified:null,image:"1f475-1f3ff.png",sheet_x:23,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"OlderWoman",b:"1F475",d:!0,e:!0,f:!0,h:!0,j:["老婆婆","人","女性","女人","女士","老","长老","前辈","human","female","women","lady","old","elder","senior"],k:[22,55],o:2},"flag-ec":{a:"EcuadorFlag",b:"1F1EA-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[1,40],o:2,j:["厄瓜多尔国旗"]},peacock:{a:"Peacock",b:"1F99A",d:!0,e:!0,f:!0,h:!0,k:[42,44],o:11,j:["孔雀"]},fearful:{a:"FearfulFace",b:"1F628",d:!0,e:!0,f:!0,h:!0,j:["充满恐惧的脸","脸","害怕","害怕","紧张","哎呀","哼","face","scared","terrified","nervous","oops","huh"],k:[31,18],o:2},train:{a:"TramCar",b:"1F68B",d:!0,e:!0,f:!0,h:!0,j:["电车","运输","车辆","运输","公共","旅行","transportation","vehicle","carriage","public","travel"],k:[34,10],o:2},flower_playing_cards:{a:"FlowerPlayingCards",b:"1F3B4",d:!0,e:!0,f:!0,h:!0,j:["花扑克牌","游戏","日落","红","game","sunset","red"],k:[8,26],o:2},repeat_one:{a:"ClockwiseRightwardsandLeftwardsOpenCircleArrowswithCircledOneOverlay",b:"1F502",d:!0,e:!0,f:!0,h:!0,j:["单曲循环按钮","蓝色方块","圈","blue-square","loop"],k:[27,30],o:2},moon_cake:{a:"MoonCake",b:"1F96E",d:!0,e:!0,f:!0,h:!0,k:[42,4],o:11,j:["月饼"]},performing_arts:{a:"PerformingArts",b:"1F3AD",d:!0,e:!0,f:!0,h:!0,j:["表演艺术","演技","剧院","戏剧","acting","theater","drama"],k:[8,19],o:2},cold_sweat:{a:"FacewithOpenMouthandColdSweat",b:"1F630",d:!0,e:!0,f:!0,h:!0,j:["冒冷汗且焦虑的脸","脸","紧张","汗","face","nervous","sweat"],k:[31,26],o:2},person_frowning:{skin_variations:{"1F3FB":{unified:"1F64D-1F3FB",non_qualified:null,image:"1f64d-1f3fb.png",sheet_x:33,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F64D-1F3FC",non_qualified:null,image:"1f64d-1f3fc.png",sheet_x:33,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F64D-1F3FD",non_qualified:null,image:"1f64d-1f3fd.png",sheet_x:33,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F64D-1F3FE",non_qualified:null,image:"1f64d-1f3fe.png",sheet_x:33,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F64D-1F3FF",non_qualified:null,image:"1f64d-1f3ff.png",sheet_x:33,sheet_y:31,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F64D-200D-2640-FE0F",a:"PersonFrowning",b:"1F64D",d:!0,e:!0,f:!0,h:!1,k:[33,26],o:2,j:["皱眉的人"]},"flag-ee":{a:"EstoniaFlag",b:"1F1EA-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[1,41],o:2,j:["爱沙尼亚国旗"]},battery:{a:"Battery",b:"1F50B",d:!0,e:!0,f:!0,h:!0,j:["电池","权力","能源","维持","power","energy","sustain"],k:[27,39],o:2},parrot:{a:"Parrot",b:"1F99C",d:!0,e:!0,f:!0,h:!0,k:[42,46],o:11,j:["鹦鹉"]},bus:{a:"Bus",b:"1F68C",d:!0,e:!0,f:!0,h:!0,j:["总线","汽车","车辆","运输","car","vehicle","transportation"],k:[34,11],o:2},"flag-eg":{a:"EgyptFlag",b:"1F1EA-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[1,42],o:2,j:["埃及国旗"]},arrow_forward:{a:"BlackRight-PointingTriangle",b:"25B6-FE0F",c:"25B6",d:!0,e:!0,f:!0,h:!0,j:["播放按钮","蓝色方块","右","方向","玩","blue-square","right","direction","play"],k:[52,43],o:2},"man-frowning":{skin_variations:{"1F3FB":{unified:"1F64D-1F3FB-200D-2642-FE0F",non_qualified:"1F64D-1F3FB-200D-2642",image:"1f64d-1f3fb-200d-2642-fe0f.png",sheet_x:33,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64D-1F3FC-200D-2642-FE0F",non_qualified:"1F64D-1F3FC-200D-2642",image:"1f64d-1f3fc-200d-2642-fe0f.png",sheet_x:33,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64D-1F3FD-200D-2642-FE0F",non_qualified:"1F64D-1F3FD-200D-2642",image:"1f64d-1f3fd-200d-2642-fe0f.png",sheet_x:33,sheet_y:23,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64D-1F3FE-200D-2642-FE0F",non_qualified:"1F64D-1F3FE-200D-2642",image:"1f64d-1f3fe-200d-2642-fe0f.png",sheet_x:33,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64D-1F3FF-200D-2642-FE0F",non_qualified:"1F64D-1F3FF-200D-2642",image:"1f64d-1f3ff-200d-2642-fe0f.png",sheet_x:33,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManFrowning",b:"1F64D-200D-2642-FE0F",c:"1F64D-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[33,20],o:4,j:["男人皱着眉头"]},disappointed_relieved:{a:"DisappointedbutRelievedFace",b:"1F625",d:!0,e:!0,f:!0,h:!0,j:["伤心但释然的脸","脸","唷","汗","紧张","face","phew","sweat","nervous"],k:[31,15],o:2},electric_plug:{a:"ElectricPlug",b:"1F50C",d:!0,e:!0,f:!0,h:!0,j:["电插头","充电器","权力","charger","power"],k:[27,40],o:2},frame_with_picture:{a:"FramewithPicture",b:"1F5BC-FE0F",c:"1F5BC",d:!0,e:!0,f:!0,h:!0,k:[30,14],o:2,j:["裱框图片"]},oncoming_bus:{a:"OncomingBus",b:"1F68D",d:!0,e:!0,f:!0,h:!0,j:["迎面驶来的公交","车辆","运输","vehicle","transportation"],k:[34,12],o:2},dango:{a:"Dango",b:"1F361",d:!0,e:!0,f:!0,h:!0,j:["团子","食物","甜点","甜","日语","烤肉","肉","food","dessert","sweet","japanese","barbecue","meat"],k:[7,0],o:2},frog:{a:"FrogFace",b:"1F438",d:!0,e:!0,f:!0,h:!0,j:["青蛙","动物","自然界","发牢骚","蟾蜍","animal","nature","croak","toad"],k:[12,28],o:2},computer:{a:"PersonalComputer",b:"1F4BB",d:!0,e:!0,f:!0,h:!0,j:["笔记本电脑","科技","笔记本","屏幕","显示","监控","technology","laptop","screen","display","monitor"],k:[26,17],o:2},art:{a:"ArtistPalette",b:"1F3A8",d:!0,e:!0,f:!0,h:!0,j:["调色板","设计","漆","画","颜色","design","paint","draw","colors"],k:[8,14],o:2},"flag-eh":{a:"WesternSaharaFlag",b:"1F1EA-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[1,43],o:2,j:["西撒哈拉国旗"]},fast_forward:{a:"BlackRight-PointingDoubleTriangle",b:"23E9",d:!0,e:!0,f:!0,h:!0,j:["快进按钮","蓝色方块","玩","速度","继续","blue-square","play","speed","continue"],k:[52,26],o:2},cry:{a:"CryingFace",b:"1F622",d:!0,e:!0,f:!0,h:!0,j:["哭脸","脸","眼泪","伤心","沮丧","沮丧",":'(","face","tears","sad","depressed","upset",":'("],k:[31,12],l:[":'("],m:":'(",o:2},"woman-frowning":{skin_variations:{"1F3FB":{unified:"1F64D-1F3FB-200D-2640-FE0F",non_qualified:"1F64D-1F3FB-200D-2640",image:"1f64d-1f3fb-200d-2640-fe0f.png",sheet_x:33,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64D-1F3FC-200D-2640-FE0F",non_qualified:"1F64D-1F3FC-200D-2640",image:"1f64d-1f3fc-200d-2640-fe0f.png",sheet_x:33,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64D-1F3FD-200D-2640-FE0F",non_qualified:"1F64D-1F3FD-200D-2640",image:"1f64d-1f3fd-200d-2640-fe0f.png",sheet_x:33,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64D-1F3FE-200D-2640-FE0F",non_qualified:"1F64D-1F3FE-200D-2640",image:"1f64d-1f3fe-200d-2640-fe0f.png",sheet_x:33,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64D-1F3FF-200D-2640-FE0F",non_qualified:"1F64D-1F3FF-200D-2640",image:"1f64d-1f3ff-200d-2640-fe0f.png",sheet_x:33,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F64D",a:"Woman Frowning",b:"1F64D-200D-2640-FE0F",c:"1F64D-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[33,14],o:4,j:["女人皱眉"]},trolleybus:{a:"Trolleybus",b:"1F68E",d:!0,e:!0,f:!0,h:!0,j:["电车","巴特","运输","车辆","bart","transportation","vehicle"],k:[34,13],o:2},crocodile:{a:"Crocodile",b:"1F40A",d:!0,e:!0,f:!0,h:!0,j:["鳄鱼","动物","自然界","爬行动物","蜥蜴","鳄鱼","animal","nature","reptile","lizard","alligator"],k:[11,38],o:2},dumpling:{a:"Dumpling",b:"1F95F",d:!0,e:!0,f:!0,h:!0,k:[41,46],o:5,j:["饺子"]},black_right_pointing_double_triangle_with_vertical_bar:{a:"Black Right Pointing Double Triangle with Vertical Bar",b:"23ED-FE0F",c:"23ED",d:!0,e:!0,f:!0,h:!0,k:[52,30],o:2,j:["下一曲目按钮"]},desktop_computer:{a:"Desktop Computer",b:"1F5A5-FE0F",c:"1F5A5",d:!0,e:!0,f:!0,h:!0,j:["台式电脑","科技","计算机科学","屏幕","technology","computing","screen"],k:[30,10],o:2},person_with_pouting_face:{skin_variations:{"1F3FB":{unified:"1F64E-1F3FB",non_qualified:null,image:"1f64e-1f3fb.png",sheet_x:33,sheet_y:45,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F64E-1F3FC",non_qualified:null,image:"1f64e-1f3fc.png",sheet_x:33,sheet_y:46,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F64E-1F3FD",non_qualified:null,image:"1f64e-1f3fd.png",sheet_x:33,sheet_y:47,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F64E-1F3FE",non_qualified:null,image:"1f64e-1f3fe.png",sheet_x:33,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F64E-1F3FF",non_qualified:null,image:"1f64e-1f3ff.png",sheet_x:33,sheet_y:49,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F64E-200D-2640-FE0F",a:"Person with Pouting Face",b:"1F64E",d:!0,e:!0,f:!0,h:!1,k:[33,44],o:2,j:["人噘嘴"]},turtle:{a:"Turtle",b:"1F422",d:!0,e:!0,f:!0,h:!0,j:["乌龟","动物","慢","自然界","龟","animal","slow","nature","tortoise"],k:[12,6],o:2},sob:{a:"Loudly Crying Face",b:"1F62D",d:!0,e:!0,f:!0,h:!0,j:["带有两行眼泪的哭脸","脸","哭","眼泪","伤心","沮丧","沮丧","face","cry","tears","sad","upset","depressed"],k:[31,23],m:":'(",o:2},"flag-er":{a:"EritreaFlag",b:"1F1EA-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[1,44],o:2,j:["厄立特里亚国旗"]},thread:{a:"SpoolofThread",b:"1F9F5",d:!0,e:!0,f:!0,h:!0,k:[51,40],o:11,j:["线"]},minibus:{a:"Minibus",b:"1F690",d:!0,e:!0,f:!0,h:!0,j:["小巴","车辆","汽车","运输","vehicle","car","transportation"],k:[34,15],o:2},fortune_cookie:{a:"FortuneCookie",b:"1F960",d:!0,e:!0,f:!0,h:!0,k:[41,47],o:5,j:["幸运饼干"]},yarn:{a:"BallofYarn",b:"1F9F6",d:!0,e:!0,f:!0,h:!0,k:[51,41],o:11,j:["毛线"]},takeout_box:{a:"TakeoutBox",b:"1F961",d:!0,e:!0,f:!0,h:!0,k:[41,48],o:5,j:["外卖盒"]},"man-pouting":{skin_variations:{"1F3FB":{unified:"1F64E-1F3FB-200D-2642-FE0F",non_qualified:"1F64E-1F3FB-200D-2642",image:"1f64e-1f3fb-200d-2642-fe0f.png",sheet_x:33,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64E-1F3FC-200D-2642-FE0F",non_qualified:"1F64E-1F3FC-200D-2642",image:"1f64e-1f3fc-200d-2642-fe0f.png",sheet_x:33,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64E-1F3FD-200D-2642-FE0F",non_qualified:"1F64E-1F3FD-200D-2642",image:"1f64e-1f3fd-200d-2642-fe0f.png",sheet_x:33,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64E-1F3FE-200D-2642-FE0F",non_qualified:"1F64E-1F3FE-200D-2642",image:"1f64e-1f3fe-200d-2642-fe0f.png",sheet_x:33,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64E-1F3FF-200D-2642-FE0F",non_qualified:"1F64E-1F3FF-200D-2642",image:"1f64e-1f3ff-200d-2642-fe0f.png",sheet_x:33,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManPouting",b:"1F64E-200D-2642-FE0F",c:"1F64E-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[33,38],o:4,j:["男人撅嘴"]},printer:{a:"Printer",b:"1F5A8-FE0F",c:"1F5A8",d:!0,e:!0,f:!0,h:!0,j:["打印机","纸","墨","paper","ink"],k:[30,11],o:2},scream:{a:"FaceScreaminginFear",b:"1F631",d:!0,e:!0,f:!0,h:!0,j:["面对恐惧的尖叫","脸","噍","害怕","嗯","face","munch","scared","omg"],k:[31,27],o:2},es:{a:"SpainFlag",b:"1F1EA-1F1F8",d:!0,e:!0,f:!0,h:!0,j:["西班牙国旗","西班牙","旗","国家","国家","旗帜","spain","flag","nation","country","banner"],k:[1,45],n:["flag-es"],o:2},ambulance:{a:"Ambulance",b:"1F691",d:!0,e:!0,f:!0,h:!0,j:["救护车","健康","911","医院","health","911","hospital"],k:[34,16],o:2},black_right_pointing_triangle_with_double_vertical_bar:{a:"BlackRightPointingTrianglewithDoubleVerticalBar",b:"23EF-FE0F",c:"23EF",d:!0,e:!0,f:!0,h:!0,k:[52,32],o:2,j:["播放或暂停按钮"]},lizard:{a:"Lizard",b:"1F98E",d:!0,e:!0,f:!0,h:!0,j:["蜥蜴","动物","自然界","爬行动物","animal","nature","reptile"],k:[42,32],o:4},"flag-et":{a:"EthiopiaFlag",b:"1F1EA-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[1,46],o:2,j:["埃塞俄比亚国旗"]},keyboard:{a:"Keyboard",b:"2328-FE0F",c:"2328",d:!0,e:!0,f:!0,h:!0,j:["键盘","科技","计算机","类型","输入","发短信","technology","computer","type","input","text"],k:[52,24],o:2},crab:{a:"Crab",b:"1F980",d:!0,e:!0,f:!0,h:!0,j:["螃蟹","动物","甲壳动物","animal","crustacean"],k:[42,18],o:2},confounded:{a:"ConfoundedFace",b:"1F616",d:!0,e:!0,f:!0,h:!0,j:["该死的脸","脸","困惑","生病","不适","哎呀","：S","face","confused","sick","unwell","oops",":S"],k:[31,0],o:2},snake:{a:"Snake",b:"1F40D",d:!0,e:!0,f:!0,h:!0,j:["蛇","动物","邪","自然界","嘶嘶声","蟒","animal","evil","nature","hiss","python"],k:[11,41],o:2},"woman-pouting":{skin_variations:{"1F3FB":{unified:"1F64E-1F3FB-200D-2640-FE0F",non_qualified:"1F64E-1F3FB-200D-2640",image:"1f64e-1f3fb-200d-2640-fe0f.png",sheet_x:33,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64E-1F3FC-200D-2640-FE0F",non_qualified:"1F64E-1F3FC-200D-2640",image:"1f64e-1f3fc-200d-2640-fe0f.png",sheet_x:33,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64E-1F3FD-200D-2640-FE0F",non_qualified:"1F64E-1F3FD-200D-2640",image:"1f64e-1f3fd-200d-2640-fe0f.png",sheet_x:33,sheet_y:35,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64E-1F3FE-200D-2640-FE0F",non_qualified:"1F64E-1F3FE-200D-2640",image:"1f64e-1f3fe-200d-2640-fe0f.png",sheet_x:33,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64E-1F3FF-200D-2640-FE0F",non_qualified:"1F64E-1F3FF-200D-2640",image:"1f64e-1f3ff-200d-2640-fe0f.png",sheet_x:33,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F64E",a:"WomanPouting",b:"1F64E-200D-2640-FE0F",c:"1F64E-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[33,32],o:4,j:["女人噘嘴"]},arrow_backward:{a:"BlackLeft-PointingTriangle",b:"25C0-FE0F",c:"25C0",d:!0,e:!0,f:!0,h:!0,j:["倒退按钮","蓝色方块","左","方向","blue-square","left","direction"],k:[52,44],o:2},fire_engine:{a:"FireEngine",b:"1F692",d:!0,e:!0,f:!0,h:!0,j:["消防车","运输","汽车","车辆","transportation","cars","vehicle"],k:[34,17],o:2},rewind:{a:"BlackLeft-PointingDoubleTriangle",b:"23EA",d:!0,e:!0,f:!0,h:!0,j:["快退按钮","玩","蓝色方块","play","blue-square"],k:[52,27],o:2},three_button_mouse:{a:"ThreeButtonMouse",b:"1F5B1-FE0F",c:"1F5B1",d:!0,e:!0,f:!0,h:!0,k:[30,12],o:2,j:["电脑鼠标"]},no_good:{skin_variations:{"1F3FB":{unified:"1F645-1F3FB",non_qualified:null,image:"1f645-1f3fb.png",sheet_x:32,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F645-1F3FC",non_qualified:null,image:"1f645-1f3fc.png",sheet_x:32,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F645-1F3FD",non_qualified:null,image:"1f645-1f3fd.png",sheet_x:32,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F645-1F3FE",non_qualified:null,image:"1f645-1f3fe.png",sheet_x:32,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F645-1F3FF",non_qualified:null,image:"1f645-1f3ff.png",sheet_x:32,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F645-200D-2640-FE0F",a:"FacewithNoGoodGesture",b:"1F645",d:!0,e:!0,f:!0,h:!1,k:[32,2],o:2,j:["反对手势的人"]},police_car:{a:"PoliceCar",b:"1F693",d:!0,e:!0,f:!0,h:!0,j:["警车","车辆","汽车","运输","法律","法律","执法","vehicle","cars","transportation","law","legal","enforcement"],k:[34,18],o:2},dragon_face:{a:"DragonFace",b:"1F432",d:!0,e:!0,f:!0,h:!0,j:["龙面","动物","神话","自然界","中文","绿","animal","myth","nature","chinese","green"],k:[12,22],o:2},persevere:{a:"PerseveringFace",b:"1F623",d:!0,e:!0,f:!0,h:!0,j:["无可奈何的脸","脸","生病","不","沮丧","哎呀","face","sick","no","upset","oops"],k:[31,13],o:2},lobster:{a:"Lobster",b:"1F99E",d:!0,e:!0,f:!0,h:!0,k:[42,48],o:11,j:["龙虾"]},"flag-eu":{a:"EuropeanUnionFlag",b:"1F1EA-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[1,47],o:2,j:["欧盟旗"]},disappointed:{a:"DisappointedFace",b:"1F61E",d:!0,e:!0,f:!0,h:!0,j:["失望的脸","脸","伤心","沮丧","沮丧",":(","face","sad","upset","depressed",":("],k:[31,8],l:["):",":(",":-("],m:":(",o:2},shrimp:{a:"Shrimp",b:"1F990",d:!0,e:!0,f:!0,h:!0,j:["虾","动物","海洋","自然界","海鲜","animal","ocean","nature","seafood"],k:[42,34],o:4},dragon:{a:"Dragon",b:"1F409",d:!0,e:!0,f:!0,h:!0,j:["龙","动物","神话","自然界","中文","绿","animal","myth","nature","chinese","green"],k:[11,37],o:2},"man-gesturing-no":{skin_variations:{"1F3FB":{unified:"1F645-1F3FB-200D-2642-FE0F",non_qualified:"1F645-1F3FB-200D-2642",image:"1f645-1f3fb-200d-2642-fe0f.png",sheet_x:31,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F645-1F3FC-200D-2642-FE0F",non_qualified:"1F645-1F3FC-200D-2642",image:"1f645-1f3fc-200d-2642-fe0f.png",sheet_x:31,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F645-1F3FD-200D-2642-FE0F",non_qualified:"1F645-1F3FD-200D-2642",image:"1f645-1f3fd-200d-2642-fe0f.png",sheet_x:31,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F645-1F3FE-200D-2642-FE0F",non_qualified:"1F645-1F3FE-200D-2642",image:"1f645-1f3fe-200d-2642-fe0f.png",sheet_x:32,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F645-1F3FF-200D-2642-FE0F",non_qualified:"1F645-1F3FF-200D-2642",image:"1f645-1f3ff-200d-2642-fe0f.png",sheet_x:32,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManGesturingNo",b:"1F645-200D-2642-FE0F",c:"1F645-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[31,53],o:4,j:["男人反对手势"]},"flag-fi":{a:"FinlandFlag",b:"1F1EB-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[1,48],o:2,j:["芬兰国旗"]},trackball:{a:"Trackball",b:"1F5B2-FE0F",c:"1F5B2",d:!0,e:!0,f:!0,h:!0,j:["轨迹球","科技","触控板","technology","trackpad"],k:[30,13],o:2},black_left_pointing_double_triangle_with_vertical_bar:{a:"BlackLeftPointingDoubleTrianglewithVerticalBar",b:"23EE-FE0F",c:"23EE",d:!0,e:!0,f:!0,h:!0,k:[52,31],o:2,j:["最后一首曲目按钮"]},oncoming_police_car:{a:"OncomingPoliceCar",b:"1F694",d:!0,e:!0,f:!0,h:!0,j:["迎面而来的警车","车辆","法律","法律","执法","911","vehicle","law","legal","enforcement","911"],k:[34,19],o:2},minidisc:{a:"Minidisc",b:"1F4BD",d:!0,e:!0,f:!0,h:!0,j:["电脑光盘","科技","记录","数据","磁盘","90年代","technology","record","data","disk","90s"],k:[26,19],o:2},sweat:{a:"FacewithColdSweat",b:"1F613",d:!0,e:!0,f:!0,h:!0,j:["垂头丧气的汗颜","脸","热","伤心","累","锻炼","face","hot","sad","tired","exercise"],k:[30,54],o:2},squid:{a:"Squid",b:"1F991",d:!0,e:!0,f:!0,h:!0,j:["乌贼","动物","自然界","海洋","海","animal","nature","ocean","sea"],k:[42,35],o:4},sauropod:{a:"Sauropod",b:"1F995",d:!0,e:!0,f:!0,h:!0,k:[42,39],o:5,j:["蜥脚类恐龙"]},arrow_up_small:{a:"Up-PointingSmallRedTriangle",b:"1F53C",d:!0,e:!0,f:!0,h:!0,j:["向上按钮","蓝色方块","三角形","方向","点","向前","返回页首","blue-square","triangle","direction","point","forward","top"],k:[28,31],o:2},"flag-fj":{a:"FijiFlag",b:"1F1EB-1F1EF",d:!0,e:!0,f:!0,h:!0,k:[1,49],o:2,j:["斐济国旗"]},"woman-gesturing-no":{skin_variations:{"1F3FB":{unified:"1F645-1F3FB-200D-2640-FE0F",non_qualified:"1F645-1F3FB-200D-2640",image:"1f645-1f3fb-200d-2640-fe0f.png",sheet_x:31,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F645-1F3FC-200D-2640-FE0F",non_qualified:"1F645-1F3FC-200D-2640",image:"1f645-1f3fc-200d-2640-fe0f.png",sheet_x:31,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F645-1F3FD-200D-2640-FE0F",non_qualified:"1F645-1F3FD-200D-2640",image:"1f645-1f3fd-200d-2640-fe0f.png",sheet_x:31,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F645-1F3FE-200D-2640-FE0F",non_qualified:"1F645-1F3FE-200D-2640",image:"1f645-1f3fe-200d-2640-fe0f.png",sheet_x:31,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F645-1F3FF-200D-2640-FE0F",non_qualified:"1F645-1F3FF-200D-2640",image:"1f645-1f3ff-200d-2640-fe0f.png",sheet_x:31,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F645",a:"WomanGesturingNo",b:"1F645-200D-2640-FE0F",c:"1F645-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[31,47],o:4,j:["女人反对手势"]},taxi:{a:"Taxi",b:"1F695",d:!0,e:!0,f:!0,h:!0,j:["出租车","优步","车辆","汽车","运输","uber","vehicle","cars","transportation"],k:[34,20],o:2},"flag-fk":{a:"FalklandIslandsFlag",b:"1F1EB-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[1,50],o:2,j:["福克兰群岛旗"]},floppy_disk:{a:"FloppyDisk",b:"1F4BE",d:!0,e:!0,f:!0,h:!0,j:["软磁盘","老派","科技","救","90年代","80年代","oldschool","technology","save","90s","80s"],k:[26,20],o:2},"t-rex":{a:"T-Rex",b:"1F996",d:!0,e:!0,f:!0,h:!0,k:[42,40],o:5,j:["霸王龙"]},oyster:{a:"Oyster",b:"1F9AA",d:!0,e:!0,f:!0,h:!0,k:[43,1],o:12,j:["牡蛎"]},arrow_double_up:{a:"BlackUp-PointingDoubleTriangle",b:"23EB",d:!0,e:!0,f:!0,h:!0,j:["快速向上按钮","蓝色方块","方向","返回页首","blue-square","direction","top"],k:[52,28],o:2},oncoming_taxi:{a:"OncomingTaxi",b:"1F696",d:!0,e:!0,f:!0,h:!0,j:["迎面而来的出租车","车辆","汽车","优步","vehicle","cars","uber"],k:[34,21],o:2},ok_woman:{skin_variations:{"1F3FB":{unified:"1F646-1F3FB",non_qualified:null,image:"1f646-1f3fb.png",sheet_x:32,sheet_y:21,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F646-1F3FC",non_qualified:null,image:"1f646-1f3fc.png",sheet_x:32,sheet_y:22,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F646-1F3FD",non_qualified:null,image:"1f646-1f3fd.png",sheet_x:32,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F646-1F3FE",non_qualified:null,image:"1f646-1f3fe.png",sheet_x:32,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F646-1F3FF",non_qualified:null,image:"1f646-1f3ff.png",sheet_x:32,sheet_y:25,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F646-200D-2640-FE0F",a:"FacewithOkGesture",b:"1F646",d:!0,e:!0,f:!0,h:!1,j:["人的同意手势","女人","女孩","女性","粉红色","人","女人","women","girl","female","pink","human","woman"],k:[32,20],o:2},weary:{a:"WearyFace",b:"1F629",d:!0,e:!0,f:!0,h:!0,j:["疲惫的脸","脸","累","困","伤心","沮丧","沮丧","face","tired","sleepy","sad","frustrated","upset"],k:[31,19],o:2},"man-gesturing-ok":{skin_variations:{"1F3FB":{unified:"1F646-1F3FB-200D-2642-FE0F",non_qualified:"1F646-1F3FB-200D-2642",image:"1f646-1f3fb-200d-2642-fe0f.png",sheet_x:32,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F646-1F3FC-200D-2642-FE0F",non_qualified:"1F646-1F3FC-200D-2642",image:"1f646-1f3fc-200d-2642-fe0f.png",sheet_x:32,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F646-1F3FD-200D-2642-FE0F",non_qualified:"1F646-1F3FD-200D-2642",image:"1f646-1f3fd-200d-2642-fe0f.png",sheet_x:32,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F646-1F3FE-200D-2642-FE0F",non_qualified:"1F646-1F3FE-200D-2642",image:"1f646-1f3fe-200d-2642-fe0f.png",sheet_x:32,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F646-1F3FF-200D-2642-FE0F",non_qualified:"1F646-1F3FF-200D-2642",image:"1f646-1f3ff-200d-2642-fe0f.png",sheet_x:32,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManGesturingOk",b:"1F646-200D-2642-FE0F",c:"1F646-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[32,14],o:4,j:["男人同意手势"]},arrow_down_small:{a:"Down-PointingSmallRedTriangle",b:"1F53D",d:!0,e:!0,f:!0,h:!0,j:["向下按钮","蓝色方块","方向","底","blue-square","direction","bottom"],k:[28,32],o:2},tired_face:{a:"TiredFace",b:"1F62B",d:!0,e:!0,f:!0,h:!0,j:["疲惫的脸","生病","怨言","沮丧","沮丧","sick","whine","upset","frustrated"],k:[31,21],o:2},car:{a:"Automobile",b:"1F697",d:!0,e:!0,f:!0,h:!0,k:[34,22],n:["red_car"],o:2,j:["汽车"]},icecream:{a:"SoftIceCream",b:"1F366",d:!0,e:!0,f:!0,h:!0,j:["霜淇淋","食物","热","甜点","夏天","food","hot","dessert","summer"],k:[7,5],o:2},cd:{a:"OpticalDisc",b:"1F4BF",d:!0,e:!0,f:!0,h:!0,j:["光盘","科技","影碟","磁盘","碟片","90年代","technology","dvd","disk","disc","90s"],k:[26,21],o:2},whale:{a:"SpoutingWhale",b:"1F433",d:!0,e:!0,f:!0,h:!0,j:["喷水的鲸鱼","动物","自然界","海","海洋","animal","nature","sea","ocean"],k:[12,23],o:2},"flag-fm":{a:"MicronesiaFlag",b:"1F1EB-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[1,51],o:2,j:["密克罗尼西亚国旗"]},oncoming_automobile:{a:"OncomingAutomobile",b:"1F698",d:!0,e:!0,f:!0,h:!0,j:["迎面而来的汽车","汽车","车辆","运输","car","vehicle","transportation"],k:[34,23],o:2},arrow_double_down:{a:"BlackDown-PointingDoubleTriangle",b:"23EC",d:!0,e:!0,f:!0,h:!0,j:["快速向下按钮","蓝色方块","方向","底","blue-square","direction","bottom"],k:[52,29],o:2},"woman-gesturing-ok":{skin_variations:{"1F3FB":{unified:"1F646-1F3FB-200D-2640-FE0F",non_qualified:"1F646-1F3FB-200D-2640",image:"1f646-1f3fb-200d-2640-fe0f.png",sheet_x:32,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F646-1F3FC-200D-2640-FE0F",non_qualified:"1F646-1F3FC-200D-2640",image:"1f646-1f3fc-200d-2640-fe0f.png",sheet_x:32,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F646-1F3FD-200D-2640-FE0F",non_qualified:"1F646-1F3FD-200D-2640",image:"1f646-1f3fd-200d-2640-fe0f.png",sheet_x:32,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F646-1F3FE-200D-2640-FE0F",non_qualified:"1F646-1F3FE-200D-2640",image:"1f646-1f3fe-200d-2640-fe0f.png",sheet_x:32,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F646-1F3FF-200D-2640-FE0F",non_qualified:"1F646-1F3FF-200D-2640",image:"1f646-1f3ff-200d-2640-fe0f.png",sheet_x:32,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F646",a:"WomanGesturingOk",b:"1F646-200D-2640-FE0F",c:"1F646-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[32,8],o:4,j:["女人同意手势"]},yawning_face:{a:"YawningFace",b:"1F971",d:!0,e:!0,f:!0,h:!0,k:[42,7],o:12,j:["打哈欠脸"]},dvd:{a:"Dvd",b:"1F4C0",d:!0,e:!0,f:!0,h:!0,j:["DVD","光盘","磁盘","碟片","cd","disk","disc"],k:[26,22],o:2},whale2:{a:"Whale",b:"1F40B",d:!0,e:!0,f:!0,h:!0,j:["鲸","动物","自然界","海","海洋","animal","nature","sea","ocean"],k:[11,39],o:2},"flag-fo":{a:"FaroeIslandsFlag",b:"1F1EB-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[1,52],o:2,j:["法罗群岛旗"]},shaved_ice:{a:"ShavedIce",b:"1F367",d:!0,e:!0,f:!0,h:!0,j:["刨冰","热","甜点","夏天","hot","dessert","summer"],k:[7,6],o:2},double_vertical_bar:{a:"DoubleVerticalBar",b:"23F8-FE0F",c:"23F8",d:!0,e:!0,f:!0,h:!0,k:[52,37],o:2,j:["暂停按钮"]},information_desk_person:{skin_variations:{"1F3FB":{unified:"1F481-1F3FB",non_qualified:null,image:"1f481-1f3fb.png",sheet_x:24,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F481-1F3FC",non_qualified:null,image:"1f481-1f3fc.png",sheet_x:24,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F481-1F3FD",non_qualified:null,image:"1f481-1f3fd.png",sheet_x:24,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F481-1F3FE",non_qualified:null,image:"1f481-1f3fe.png",sheet_x:24,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F481-1F3FF",non_qualified:null,image:"1f481-1f3ff.png",sheet_x:24,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F481-200D-2640-FE0F",a:"InformationDeskPerson",b:"1F481",d:!0,e:!0,f:!0,h:!1,k:[24,2],o:2,j:["指引信息的人"]},dolphin:{a:"Dolphin",b:"1F42C",d:!0,e:!0,f:!0,h:!0,j:["海豚","动物","自然界","鱼","海","海洋","鳍 状 肢","直到","海滩","animal","nature","fish","sea","ocean","flipper","fins","beach"],k:[12,16],n:["flipper"],o:2},blue_car:{a:"RecreationalVehicle",b:"1F699",d:!0,e:!0,f:!0,h:!0,j:["运动型多功能车","运输","车辆","transportation","vehicle"],k:[34,24],o:2},ice_cream:{a:"IceCream",b:"1F368",d:!0,e:!0,f:!0,h:!0,j:["冰块","食物","热","甜点","food","hot","dessert"],k:[7,7],o:2},fr:{a:"FranceFlag",b:"1F1EB-1F1F7",d:!0,e:!0,f:!0,h:!0,j:["法国国旗","旗帜","旗","国家","法国","法语","国家","banner","flag","nation","france","french","country"],k:[1,53],n:["flag-fr"],o:2},triumph:{a:"FacewithLookofTriumph",b:"1F624",d:!0,e:!0,f:!0,h:!0,j:["生气的脸","脸","气","唷","骄傲","自豪","face","gas","phew","proud","pride"],k:[31,14],o:2},abacus:{a:"Abacus",b:"1F9EE",d:!0,e:!0,f:!0,h:!0,k:[51,33],o:11,j:["算盘"]},"man-tipping-hand":{skin_variations:{"1F3FB":{unified:"1F481-1F3FB-200D-2642-FE0F",non_qualified:"1F481-1F3FB-200D-2642",image:"1f481-1f3fb-200d-2642-fe0f.png",sheet_x:23,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F481-1F3FC-200D-2642-FE0F",non_qualified:"1F481-1F3FC-200D-2642",image:"1f481-1f3fc-200d-2642-fe0f.png",sheet_x:23,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F481-1F3FD-200D-2642-FE0F",non_qualified:"1F481-1F3FD-200D-2642",image:"1f481-1f3fd-200d-2642-fe0f.png",sheet_x:23,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F481-1F3FE-200D-2642-FE0F",non_qualified:"1F481-1F3FE-200D-2642",image:"1f481-1f3fe-200d-2642-fe0f.png",sheet_x:24,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F481-1F3FF-200D-2642-FE0F",non_qualified:"1F481-1F3FF-200D-2642",image:"1f481-1f3ff-200d-2642-fe0f.png",sheet_x:24,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManTippingHand",b:"1F481-200D-2642-FE0F",c:"1F481-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[23,53],o:4,j:["男人指引信息"]},doughnut:{a:"Doughnut",b:"1F369",d:!0,e:!0,f:!0,h:!0,j:["巧克力甜甜圈","食物","甜点","小吃","甜","甜甜圈","food","dessert","snack","sweet","donut"],k:[7,8],o:2},fish:{a:"Fish",b:"1F41F",d:!0,e:!0,f:!0,h:!0,j:["鱼","动物","食物","自然界","animal","food","nature"],k:[12,3],o:2},truck:{a:"DeliveryTruck",b:"1F69A",d:!0,e:!0,f:!0,h:!0,j:["送货卡车","汽车","运输","cars","transportation"],k:[34,25],o:2},movie_camera:{a:"MovieCamera",b:"1F3A5",d:!0,e:!0,f:!0,h:!0,j:["电影摄影机","影片","记录","film","record"],k:[8,11],o:2},"flag-ga":{a:"GabonFlag",b:"1F1EC-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[1,54],o:2,j:["加蓬国旗"]},rage:{a:"PoutingFace",b:"1F621",d:!0,e:!0,f:!0,h:!0,j:["噘嘴的脸","生气","狂","恨","鄙视","angry","mad","hate","despise"],k:[31,11],o:2},black_square_for_stop:{a:"BlackSquareforStop",b:"23F9-FE0F",c:"23F9",d:!0,e:!0,f:!0,h:!0,k:[52,38],o:2,j:["停止按钮"]},articulated_lorry:{a:"ArticulatedLorry",b:"1F69B",d:!0,e:!0,f:!0,h:!0,j:["铰接式卡车","车辆","汽车","运输","表达","vehicle","cars","transportation","express"],k:[34,26],o:2},angry:{a:"AngryFace",b:"1F620",d:!0,e:!0,f:!0,h:!0,j:["愤怒的脸","狂","脸","恼火","沮丧","mad","face","annoyed","frustrated"],k:[31,10],l:[">:(",">:-("],o:2},cookie:{a:"Cookie",b:"1F36A",d:!0,e:!0,f:!0,h:!0,j:["曲奇饼","食物","小吃","奥利奥","巧克力","甜","甜点","food","snack","oreo","chocolate","sweet","dessert"],k:[7,9],o:2},gb:{a:"UnitedKingdomFlag",b:"1F1EC-1F1E7",d:!0,e:!0,f:!0,h:!0,k:[1,55],n:["uk","flag-gb"],o:2,j:["英国国旗"]},tropical_fish:{a:"TropicalFish",b:"1F420",d:!0,e:!0,f:!0,h:!0,j:["热带鱼","动物","游泳","海洋","海滩","尼 莫","animal","swim","ocean","beach","nemo"],k:[12,4],o:2},"woman-tipping-hand":{skin_variations:{"1F3FB":{unified:"1F481-1F3FB-200D-2640-FE0F",non_qualified:"1F481-1F3FB-200D-2640",image:"1f481-1f3fb-200d-2640-fe0f.png",sheet_x:23,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F481-1F3FC-200D-2640-FE0F",non_qualified:"1F481-1F3FC-200D-2640",image:"1f481-1f3fc-200d-2640-fe0f.png",sheet_x:23,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F481-1F3FD-200D-2640-FE0F",non_qualified:"1F481-1F3FD-200D-2640",image:"1f481-1f3fd-200d-2640-fe0f.png",sheet_x:23,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F481-1F3FE-200D-2640-FE0F",non_qualified:"1F481-1F3FE-200D-2640",image:"1f481-1f3fe-200d-2640-fe0f.png",sheet_x:23,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F481-1F3FF-200D-2640-FE0F",non_qualified:"1F481-1F3FF-200D-2640",image:"1f481-1f3ff-200d-2640-fe0f.png",sheet_x:23,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F481",a:"WomanTippingHand",b:"1F481-200D-2640-FE0F",c:"1F481-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[23,47],o:4,j:["女人指引信息"]},black_circle_for_record:{a:"BlackCircleforRecord",b:"23FA-FE0F",c:"23FA",d:!0,e:!0,f:!0,h:!0,k:[52,39],o:2,j:["录音按钮"]},film_frames:{a:"FilmFrames",b:"1F39E-FE0F",c:"1F39E",d:!0,e:!0,f:!0,h:!0,k:[8,4],o:2,j:["电影帧"]},film_projector:{a:"FilmProjector",b:"1F4FD-FE0F",c:"1F4FD",d:!0,e:!0,f:!0,h:!0,j:["电影放映机","视频","磁带","记录","电影","video","tape","record","movie"],k:[27,26],o:2},"flag-gd":{a:"GrenadaFlag",b:"1F1EC-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[1,56],o:2,j:["格林纳达国旗"]},blowfish:{a:"Blowfish",b:"1F421",d:!0,e:!0,f:!0,h:!0,j:["河豚","动物","自然界","食物","海","海洋","animal","nature","food","sea","ocean"],k:[12,5],o:2},face_with_symbols_on_mouth:{a:"SeriousFacewithSymbolsCoveringMouth",b:"1F92C",d:!0,e:!0,f:!0,h:!0,k:[38,46],n:["serious_face_with_symbols_covering_mouth"],o:5,j:["口出恶言的脸"]},birthday:{a:"BirthdayCake",b:"1F382",d:!0,e:!0,f:!0,h:!0,j:["生日蛋糕","食物","甜点","蛋糕","food","dessert","cake"],k:[7,33],o:2},eject:{a:"Eject",b:"23CF-FE0F",c:"23CF",d:!0,e:!0,f:!0,h:!0,k:[52,25],o:2,j:["弹出按钮"]},raising_hand:{skin_variations:{"1F3FB":{unified:"1F64B-1F3FB",non_qualified:null,image:"1f64b-1f3fb.png",sheet_x:33,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F64B-1F3FC",non_qualified:null,image:"1f64b-1f3fc.png",sheet_x:33,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F64B-1F3FD",non_qualified:null,image:"1f64b-1f3fd.png",sheet_x:33,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F64B-1F3FE",non_qualified:null,image:"1f64b-1f3fe.png",sheet_x:33,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F64B-1F3FF",non_qualified:null,image:"1f64b-1f3ff.png",sheet_x:33,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F64B-200D-2640-FE0F",a:"HappyPersonRaisingOneHand",b:"1F64B",d:!0,e:!0,f:!0,h:!1,k:[33,2],o:2,j:["举手的人"]},tractor:{a:"Tractor",b:"1F69C",d:!0,e:!0,f:!0,h:!0,j:["拖拉机","车辆","汽车","农业","农业","vehicle","car","farming","agriculture"],k:[34,27],o:2},"flag-ge":{a:"GeorgiaFlag",b:"1F1EC-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[2,0],o:2,j:["格鲁吉亚国旗"]},smiling_imp:{a:"SmilingFacewithHorns",b:"1F608",d:!0,e:!0,f:!0,h:!0,j:["长角的笑脸","魔鬼","角","devil","horns"],k:[30,43],o:2},racing_car:{a:"RacingCar",b:"1F3CE-FE0F",c:"1F3CE",d:!0,e:!0,f:!0,h:!0,j:["赛车","体育","比赛","几乎","公式","f1","sports","race","fast","formula","f1"],k:[10,33],o:2},cinema:{a:"Cinema",b:"1F3A6",d:!0,e:!0,f:!0,h:!0,j:["电影院","蓝色方块","记录","影片","电影","窗帘","阶段","剧院","blue-square","record","film","movie","curtain","stage","theater"],k:[8,12],o:2},clapper:{a:"ClapperBoard",b:"1F3AC",d:!0,e:!0,f:!0,h:!0,j:["场记板","电影","影片","记录","movie","film","record"],k:[8,18],o:2},shark:{a:"Shark",b:"1F988",d:!0,e:!0,f:!0,h:!0,j:["鲨鱼","动物","自然界","鱼","海","海洋","下巴","直到","海滩","animal","nature","fish","sea","ocean","jaws","fins","beach"],k:[42,26],o:4},cake:{a:"Shortcake",b:"1F370",d:!0,e:!0,f:!0,h:!0,j:["酥","食物","甜点","food","dessert"],k:[7,15],o:2},"man-raising-hand":{skin_variations:{"1F3FB":{unified:"1F64B-1F3FB-200D-2642-FE0F",non_qualified:"1F64B-1F3FB-200D-2642",image:"1f64b-1f3fb-200d-2642-fe0f.png",sheet_x:32,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64B-1F3FC-200D-2642-FE0F",non_qualified:"1F64B-1F3FC-200D-2642",image:"1f64b-1f3fc-200d-2642-fe0f.png",sheet_x:32,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64B-1F3FD-200D-2642-FE0F",non_qualified:"1F64B-1F3FD-200D-2642",image:"1f64b-1f3fd-200d-2642-fe0f.png",sheet_x:32,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64B-1F3FE-200D-2642-FE0F",non_qualified:"1F64B-1F3FE-200D-2642",image:"1f64b-1f3fe-200d-2642-fe0f.png",sheet_x:33,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64B-1F3FF-200D-2642-FE0F",non_qualified:"1F64B-1F3FF-200D-2642",image:"1f64b-1f3ff-200d-2642-fe0f.png",sheet_x:33,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManRaisingHand",b:"1F64B-200D-2642-FE0F",c:"1F64B-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[32,53],o:4,j:["男人举手"]},octopus:{a:"Octopus",b:"1F419",d:!0,e:!0,f:!0,h:!0,j:["章鱼","动物","生物","海洋","海","自然界","海滩","animal","creature","ocean","sea","nature","beach"],k:[11,54],o:2},"woman-raising-hand":{skin_variations:{"1F3FB":{unified:"1F64B-1F3FB-200D-2640-FE0F",non_qualified:"1F64B-1F3FB-200D-2640",image:"1f64b-1f3fb-200d-2640-fe0f.png",sheet_x:32,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64B-1F3FC-200D-2640-FE0F",non_qualified:"1F64B-1F3FC-200D-2640",image:"1f64b-1f3fc-200d-2640-fe0f.png",sheet_x:32,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64B-1F3FD-200D-2640-FE0F",non_qualified:"1F64B-1F3FD-200D-2640",image:"1f64b-1f3fd-200d-2640-fe0f.png",sheet_x:32,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64B-1F3FE-200D-2640-FE0F",non_qualified:"1F64B-1F3FE-200D-2640",image:"1f64b-1f3fe-200d-2640-fe0f.png",sheet_x:32,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64B-1F3FF-200D-2640-FE0F",non_qualified:"1F64B-1F3FF-200D-2640",image:"1f64b-1f3ff-200d-2640-fe0f.png",sheet_x:32,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F64B",a:"WomanRaisingHand",b:"1F64B-200D-2640-FE0F",c:"1F64B-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[32,47],o:4,j:["女人举手"]},"flag-gf":{a:"FrenchGuianaFlag",b:"1F1EC-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[2,1],o:2,j:["法属圭亚那旗"]},tv:{a:"Television",b:"1F4FA",d:!0,e:!0,f:!0,h:!0,j:["电视","科技","程序","老派","显示","电视","technology","program","oldschool","show","television"],k:[27,23],o:2},imp:{a:"Imp",b:"1F47F",d:!0,e:!0,f:!0,h:!0,j:["长角的愤怒脸","魔鬼","生气","角","devil","angry","horns"],k:[23,45],o:2},cupcake:{a:"Cupcake",b:"1F9C1",d:!0,e:!0,f:!0,h:!0,k:[44,9],o:11,j:["杯子蛋糕"]},racing_motorcycle:{a:"RacingMotorcycle",b:"1F3CD-FE0F",c:"1F3CD",d:!0,e:!0,f:!0,h:!0,k:[10,32],o:2,j:["摩托车"]},low_brightness:{a:"LowBrightnessSymbol",b:"1F505",d:!0,e:!0,f:!0,h:!0,j:["昏暗的按钮","太阳","下午","温暖","夏天","sun","afternoon","warm","summer"],k:[27,33],o:2},shell:{a:"SpiralShell",b:"1F41A",d:!0,e:!0,f:!0,h:!0,j:["螺","自然界","海","海滩","nature","sea","beach"],k:[11,55],o:2},"flag-gg":{a:"GuernseyFlag",b:"1F1EC-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[2,2],o:2,j:["格恩西岛旗"]},high_brightness:{a:"HighBrightnessSymbol",b:"1F506",d:!0,e:!0,f:!0,h:!0,j:["明亮的按钮","太阳","光","sun","light"],k:[27,34],o:2},deaf_person:{skin_variations:{"1F3FB":{unified:"1F9CF-1F3FB",non_qualified:null,image:"1f9cf-1f3fb.png",sheet_x:45,sheet_y:11,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CF-1F3FC",non_qualified:null,image:"1f9cf-1f3fc.png",sheet_x:45,sheet_y:12,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CF-1F3FD",non_qualified:null,image:"1f9cf-1f3fd.png",sheet_x:45,sheet_y:13,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CF-1F3FE",non_qualified:null,image:"1f9cf-1f3fe.png",sheet_x:45,sheet_y:14,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CF-1F3FF",non_qualified:null,image:"1f9cf-1f3ff.png",sheet_x:45,sheet_y:15,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"DeafPerson",b:"1F9CF",d:!0,e:!0,f:!0,h:!0,k:[45,10],o:12,j:["聋人"]},skull:{a:"Skull",b:"1F480",d:!0,e:!0,f:!0,h:!0,j:["骷髅头骨","死","骨架","恐怖","死亡","dead","skeleton","creepy","death"],k:[23,46],o:2},motor_scooter:{a:"MotorScooter",b:"1F6F5",d:!0,e:!0,f:!0,h:!0,j:["小型摩托车","车辆","黄蜂","萨沙","vehicle","vespa","sasha"],k:[36,54],o:4},camera:{a:"Camera",b:"1F4F7",d:!0,e:!0,f:!0,h:!0,j:["相机","产品","摄影","gadgets","photography"],k:[27,20],o:2},pie:{a:"Pie",b:"1F967",d:!0,e:!0,f:!0,h:!0,k:[41,54],o:5,j:["派"]},"flag-gh":{a:"GhanaFlag",b:"1F1EC-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[2,3],o:2,j:["加纳国旗"]},deaf_man:{skin_variations:{"1F3FB":{unified:"1F9CF-1F3FB-200D-2642-FE0F",non_qualified:"1F9CF-1F3FB-200D-2642",image:"1f9cf-1f3fb-200d-2642-fe0f.png",sheet_x:45,sheet_y:5,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CF-1F3FC-200D-2642-FE0F",non_qualified:"1F9CF-1F3FC-200D-2642",image:"1f9cf-1f3fc-200d-2642-fe0f.png",sheet_x:45,sheet_y:6,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CF-1F3FD-200D-2642-FE0F",non_qualified:"1F9CF-1F3FD-200D-2642",image:"1f9cf-1f3fd-200d-2642-fe0f.png",sheet_x:45,sheet_y:7,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CF-1F3FE-200D-2642-FE0F",non_qualified:"1F9CF-1F3FE-200D-2642",image:"1f9cf-1f3fe-200d-2642-fe0f.png",sheet_x:45,sheet_y:8,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CF-1F3FF-200D-2642-FE0F",non_qualified:"1F9CF-1F3FF-200D-2642",image:"1f9cf-1f3ff-200d-2642-fe0f.png",sheet_x:45,sheet_y:9,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"DeafMan",b:"1F9CF-200D-2642-FE0F",c:"1F9CF-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[45,4],o:12,j:["男性聋人"]},skull_and_crossbones:{a:"SkullandCrossbones",b:"2620-FE0F",c:"2620",d:!0,e:!0,f:!0,h:!0,j:["骷髅头","毒","危险","致命","可怕","死亡","海盗","邪","poison","danger","deadly","scary","death","pirate","evil"],k:[53,8],o:2},camera_with_flash:{a:"CamerawithFlash",b:"1F4F8",d:!0,e:!0,f:!0,h:!0,k:[27,21],o:2,j:["带闪光灯的相机"]},signal_strength:{a:"AntennawithBars",b:"1F4F6",d:!0,e:!0,f:!0,h:!0,j:["信号条","蓝色方块","接待","电话","互联网","连接","无线网络","蓝牙","酒吧","blue-square","reception","phone","internet","connection","wifi","bluetooth","bars"],k:[27,19],o:2},chocolate_bar:{a:"ChocolateBar",b:"1F36B",d:!0,e:!0,f:!0,h:!0,j:["巧克力棒","食物","小吃","甜点","甜","food","snack","dessert","sweet"],k:[7,10],o:2},manual_wheelchair:{a:"ManualWheelchair",b:"1F9BD",d:!0,e:!0,f:!0,h:!0,k:[44,5],o:12,j:["手动轮椅"]},snail:{a:"Snail",b:"1F40C",d:!0,e:!0,f:!0,h:!0,j:["蜗牛","慢","动物","壳","slow","animal","shell"],k:[11,40],o:2},motorized_wheelchair:{a:"MotorizedWheelchair",b:"1F9BC",d:!0,e:!0,f:!0,h:!0,k:[44,4],o:12,j:["电动轮椅"]},"flag-gi":{a:"GibraltarFlag",b:"1F1EC-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[2,4],o:2,j:["直布罗陀旗"]},hankey:{a:"PileofPoo",b:"1F4A9",d:!0,e:!0,f:!0,h:!0,k:[25,51],n:["poop","shit"],o:2,j:["一坨便便"]},vibration_mode:{a:"VibrationMode",b:"1F4F3",d:!0,e:!0,f:!0,h:!0,j:["振动模式","橙色方块","电话","orange-square","phone"],k:[27,16],o:2},deaf_woman:{skin_variations:{"1F3FB":{unified:"1F9CF-1F3FB-200D-2640-FE0F",non_qualified:"1F9CF-1F3FB-200D-2640",image:"1f9cf-1f3fb-200d-2640-fe0f.png",sheet_x:44,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CF-1F3FC-200D-2640-FE0F",non_qualified:"1F9CF-1F3FC-200D-2640",image:"1f9cf-1f3fc-200d-2640-fe0f.png",sheet_x:45,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CF-1F3FD-200D-2640-FE0F",non_qualified:"1F9CF-1F3FD-200D-2640",image:"1f9cf-1f3fd-200d-2640-fe0f.png",sheet_x:45,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CF-1F3FE-200D-2640-FE0F",non_qualified:"1F9CF-1F3FE-200D-2640",image:"1f9cf-1f3fe-200d-2640-fe0f.png",sheet_x:45,sheet_y:2,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CF-1F3FF-200D-2640-FE0F",non_qualified:"1F9CF-1F3FF-200D-2640",image:"1f9cf-1f3ff-200d-2640-fe0f.png",sheet_x:45,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"DeafWoman",b:"1F9CF-200D-2640-FE0F",c:"1F9CF-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[44,55],o:12,j:["女性聋人"]},butterfly:{a:"Butterfly",b:"1F98B",d:!0,e:!0,f:!0,h:!0,j:["蝴蝶","动物","昆虫","自然界","毛虫","animal","insect","nature","caterpillar"],k:[42,29],o:4},video_camera:{a:"VideoCamera",b:"1F4F9",d:!0,e:!0,f:!0,h:!0,j:["摄录机","影片","记录","film","record"],k:[27,22],o:2},candy:{a:"Candy",b:"1F36C",d:!0,e:!0,f:!0,h:!0,j:["糖果","小吃","甜点","甜","棒棒糖","snack","dessert","sweet","lolly"],k:[7,11],o:2},auto_rickshaw:{a:"AutoRickshaw",b:"1F6FA",d:!0,e:!0,f:!0,h:!0,k:[37,2],o:12,j:["自动人力车"]},bow:{skin_variations:{"1F3FB":{unified:"1F647-1F3FB",non_qualified:null,image:"1f647-1f3fb.png",sheet_x:32,sheet_y:39,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F647-1F3FC",non_qualified:null,image:"1f647-1f3fc.png",sheet_x:32,sheet_y:40,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F647-1F3FD",non_qualified:null,image:"1f647-1f3fd.png",sheet_x:32,sheet_y:41,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F647-1F3FE",non_qualified:null,image:"1f647-1f3fe.png",sheet_x:32,sheet_y:42,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F647-1F3FF",non_qualified:null,image:"1f647-1f3ff.png",sheet_x:32,sheet_y:43,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F647-200D-2642-FE0F",a:"PersonBowingDeeply",b:"1F647",d:!0,e:!0,f:!0,h:!1,k:[32,38],o:2,j:["鞠躬的人"]},mobile_phone_off:{a:"MobilePhoneoff",b:"1F4F4",d:!0,e:!0,f:!0,h:!0,j:["手机关机","静音","橙色方块","沉默","安静","mute","orange-square","silence","quiet"],k:[27,17],o:2},clown_face:{a:"ClownFace",b:"1F921",d:!0,e:!0,f:!0,h:!0,j:["小丑","脸","face"],k:[38,18],o:4},lollipop:{a:"Lollipop",b:"1F36D",d:!0,e:!0,f:!0,h:!0,j:["棒糖","食物","小吃","糖果","甜","food","snack","candy","sweet"],k:[7,12],o:2},"flag-gl":{a:"GreenlandFlag",b:"1F1EC-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[2,5],o:2,j:["格陵兰旗"]},vhs:{a:"Videocassette",b:"1F4FC",d:!0,e:!0,f:!0,h:!0,j:["录像带","记录","视频","老派","90年代","80年代","record","video","oldschool","90s","80s"],k:[27,25],o:2},bug:{a:"Bug",b:"1F41B",d:!0,e:!0,f:!0,h:!0,j:["虫虫","动物","昆虫","自然界","蠕虫","animal","insect","nature","worm"],k:[11,56],o:2},bike:{a:"Bicycle",b:"1F6B2",d:!0,e:!0,f:!0,h:!0,j:["自行车","体育","自行车","锻炼","时髦","sports","bicycle","exercise","hipster"],k:[35,9],o:2},"man-bowing":{skin_variations:{"1F3FB":{unified:"1F647-1F3FB-200D-2642-FE0F",non_qualified:"1F647-1F3FB-200D-2642",image:"1f647-1f3fb-200d-2642-fe0f.png",sheet_x:32,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F647-1F3FC-200D-2642-FE0F",non_qualified:"1F647-1F3FC-200D-2642",image:"1f647-1f3fc-200d-2642-fe0f.png",sheet_x:32,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F647-1F3FD-200D-2642-FE0F",non_qualified:"1F647-1F3FD-200D-2642",image:"1f647-1f3fd-200d-2642-fe0f.png",sheet_x:32,sheet_y:35,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F647-1F3FE-200D-2642-FE0F",non_qualified:"1F647-1F3FE-200D-2642",image:"1f647-1f3fe-200d-2642-fe0f.png",sheet_x:32,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F647-1F3FF-200D-2642-FE0F",non_qualified:"1F647-1F3FF-200D-2642",image:"1f647-1f3ff-200d-2642-fe0f.png",sheet_x:32,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F647",a:"ManBowing",b:"1F647-200D-2642-FE0F",c:"1F647-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[32,32],o:4,j:["男人鞠躬"]},female_sign:{a:"FemaleSign",b:"2640-FE0F",c:"2640",d:!1,e:!0,f:!0,h:!0,k:[53,18],o:4,j:["女性标志"]},japanese_ogre:{a:"JapaneseOgre",b:"1F479",d:!0,e:!0,f:!0,h:!0,j:["怪物","怪物","红","面具","万圣节","可怕","恐怖","魔鬼","恶魔","日语","怪物","monster","red","mask","halloween","scary","creepy","devil","demon","japanese","ogre"],k:[23,34],o:2},custard:{a:"Custard",b:"1F36E",d:!0,e:!0,f:!0,h:!0,j:["卡仕达","甜点","食物","dessert","food"],k:[7,13],o:2},ant:{a:"Ant",b:"1F41C",d:!0,e:!0,f:!0,h:!0,j:["蚂蚁","动物","昆虫","自然界","错误","animal","insect","nature","bug"],k:[12,0],o:2},mag:{a:"Left-PointingMagnifyingGlass",b:"1F50D",d:!0,e:!0,f:!0,h:!0,j:["放大镜（向左倾斜）","搜索","缩放","找到","侦探","search","zoom","find","detective"],k:[27,41],o:2},"flag-gm":{a:"GambiaFlag",b:"1F1EC-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[2,6],o:2,j:["冈比亚国旗"]},honey_pot:{a:"HoneyPot",b:"1F36F",d:!0,e:!0,f:!0,h:!0,j:["蜜罐","蜜蜂","甜","厨房","bees","sweet","kitchen"],k:[7,14],o:2},"woman-bowing":{skin_variations:{"1F3FB":{unified:"1F647-1F3FB-200D-2640-FE0F",non_qualified:"1F647-1F3FB-200D-2640",image:"1f647-1f3fb-200d-2640-fe0f.png",sheet_x:32,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F647-1F3FC-200D-2640-FE0F",non_qualified:"1F647-1F3FC-200D-2640",image:"1f647-1f3fc-200d-2640-fe0f.png",sheet_x:32,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F647-1F3FD-200D-2640-FE0F",non_qualified:"1F647-1F3FD-200D-2640",image:"1f647-1f3fd-200d-2640-fe0f.png",sheet_x:32,sheet_y:29,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F647-1F3FE-200D-2640-FE0F",non_qualified:"1F647-1F3FE-200D-2640",image:"1f647-1f3fe-200d-2640-fe0f.png",sheet_x:32,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F647-1F3FF-200D-2640-FE0F",non_qualified:"1F647-1F3FF-200D-2640",image:"1f647-1f3ff-200d-2640-fe0f.png",sheet_x:32,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanBowing",b:"1F647-200D-2640-FE0F",c:"1F647-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[32,26],o:4,j:["女人鞠躬"]},male_sign:{a:"MaleSign",b:"2642-FE0F",c:"2642",d:!1,e:!0,f:!0,h:!0,k:[53,19],o:4,j:["男性标志"]},mag_right:{a:"Right-PointingMagnifyingGlass",b:"1F50E",d:!0,e:!0,f:!0,h:!0,j:["放大镜（向右倾斜）","搜索","缩放","找到","侦探","search","zoom","find","detective"],k:[27,42],o:2},japanese_goblin:{a:"JapaneseGoblin",b:"1F47A",d:!0,e:!0,f:!0,h:!0,j:["小妖怪","红","邪","面具","怪物","可怕","恐怖","日语","妖精","red","evil","mask","monster","scary","creepy","japanese","goblin"],k:[23,35],o:2},scooter:{a:"Scooter",b:"1F6F4",d:!0,e:!0,f:!0,h:!0,k:[36,53],o:4,j:["滑板车"]},bee:{a:"Honeybee",b:"1F41D",d:!0,e:!0,f:!0,h:!0,k:[12,1],n:["honeybee"],o:2,j:["蜜蜂"]},"flag-gn":{a:"GuineaFlag",b:"1F1EC-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[2,7],o:2,j:["几内亚国旗"]},candle:{a:"Candle",b:"1F56F-FE0F",c:"1F56F",d:!0,e:!0,f:!0,h:!0,j:["蜡烛","火灾","蜡","fire","wax"],k:[29,6],o:2},skateboard:{a:"Skateboard",b:"1F6F9",d:!0,e:!0,f:!0,h:!0,k:[37,1],o:11,j:["滑板"]},medical_symbol:{a:"MedicalSymbol",b:"2695-FE0F",c:"2695",d:!1,e:!0,f:!0,h:!0,k:[53,44],n:["staff_of_aesculapius"],o:4,j:["医疗符号"]},ghost:{a:"Ghost",b:"1F47B",d:!0,e:!0,f:!0,h:!0,j:["鬼","万圣节","怪异","可怕","halloween","spooky","scary"],k:[23,36],o:2},beetle:{a:"LadyBeetle",b:"1F41E",d:!0,e:!0,f:!0,h:!0,j:["瓢虫","动物","昆虫","自然界","瓢虫","animal","insect","nature","ladybug"],k:[12,2],o:2},face_palm:{skin_variations:{"1F3FB":{unified:"1F926-1F3FB",non_qualified:null,image:"1f926-1f3fb.png",sheet_x:38,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F926-1F3FC",non_qualified:null,image:"1f926-1f3fc.png",sheet_x:38,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F926-1F3FD",non_qualified:null,image:"1f926-1f3fd.png",sheet_x:38,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F926-1F3FE",non_qualified:null,image:"1f926-1f3fe.png",sheet_x:38,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F926-1F3FF",non_qualified:null,image:"1f926-1f3ff.png",sheet_x:38,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},a:"FacePalm",b:"1F926",d:!0,e:!0,f:!0,h:!1,k:[38,35],o:4,j:["人掩面"]},"flag-gp":{a:"GuadeloupeFlag",b:"1F1EC-1F1F5",d:!0,e:!0,f:!0,h:!0,k:[2,8],o:2,j:["瓜德罗普岛旗"]},baby_bottle:{a:"BabyBottle",b:"1F37C",d:!0,e:!0,f:!0,h:!0,j:["婴儿奶瓶","食物","容器","牛奶","food","container","milk"],k:[7,27],o:2},infinity:{a:"Infinity",b:"267E-FE0F",c:"267E",d:!0,e:!0,f:!0,h:!0,k:[53,39],o:11,j:["无限"]},glass_of_milk:{a:"GlassofMilk",b:"1F95B",d:!0,e:!0,f:!0,h:!0,k:[41,42],o:4,j:["牛奶杯"]},"man-facepalming":{skin_variations:{"1F3FB":{unified:"1F926-1F3FB-200D-2642-FE0F",non_qualified:"1F926-1F3FB-200D-2642",image:"1f926-1f3fb-200d-2642-fe0f.png",sheet_x:38,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F926-1F3FC-200D-2642-FE0F",non_qualified:"1F926-1F3FC-200D-2642",image:"1f926-1f3fc-200d-2642-fe0f.png",sheet_x:38,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F926-1F3FD-200D-2642-FE0F",non_qualified:"1F926-1F3FD-200D-2642",image:"1f926-1f3fd-200d-2642-fe0f.png",sheet_x:38,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F926-1F3FE-200D-2642-FE0F",non_qualified:"1F926-1F3FE-200D-2642",image:"1f926-1f3fe-200d-2642-fe0f.png",sheet_x:38,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F926-1F3FF-200D-2642-FE0F",non_qualified:"1F926-1F3FF-200D-2642",image:"1f926-1f3ff-200d-2642-fe0f.png",sheet_x:38,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManFacepalming",b:"1F926-200D-2642-FE0F",c:"1F926-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[38,29],o:4,j:["男人掩面"]},cricket:{a:"Cricket",b:"1F997",d:!0,e:!0,f:!0,h:!0,j:["蟋蟀","体育","sports"],k:[42,41],o:5},busstop:{a:"BusStop",b:"1F68F",d:!0,e:!0,f:!0,h:!0,j:["公交车站","运输","等","transportation","wait"],k:[34,14],o:2},"flag-gq":{a:"EquatorialGuineaFlag",b:"1F1EC-1F1F6",d:!0,e:!0,f:!0,h:!0,k:[2,9],o:2,j:["赤道几内亚国旗"]},alien:{a:"ExtraterrestrialAlien",b:"1F47D",d:!0,e:!0,f:!0,h:!0,j:["外星人","不明飞行物","保罗","奇怪","outer_space","UFO","paul","weird","outer_space"],k:[23,43],o:2},bulb:{a:"ElectricLightBulb",b:"1F4A1",d:!0,e:!0,f:!0,h:!0,j:["灯泡","光","电力","想法","light","electricity","idea"],k:[25,43],o:2},"woman-facepalming":{skin_variations:{"1F3FB":{unified:"1F926-1F3FB-200D-2640-FE0F",non_qualified:"1F926-1F3FB-200D-2640",image:"1f926-1f3fb-200d-2640-fe0f.png",sheet_x:38,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F926-1F3FC-200D-2640-FE0F",non_qualified:"1F926-1F3FC-200D-2640",image:"1f926-1f3fc-200d-2640-fe0f.png",sheet_x:38,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F926-1F3FD-200D-2640-FE0F",non_qualified:"1F926-1F3FD-200D-2640",image:"1f926-1f3fd-200d-2640-fe0f.png",sheet_x:38,sheet_y:26,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F926-1F3FE-200D-2640-FE0F",non_qualified:"1F926-1F3FE-200D-2640",image:"1f926-1f3fe-200d-2640-fe0f.png",sheet_x:38,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F926-1F3FF-200D-2640-FE0F",non_qualified:"1F926-1F3FF-200D-2640",image:"1f926-1f3ff-200d-2640-fe0f.png",sheet_x:38,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanFacepalming",b:"1F926-200D-2640-FE0F",c:"1F926-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[38,23],o:4,j:["女人掩面"]},spider:{a:"Spider",b:"1F577-FE0F",c:"1F577",d:!0,e:!0,f:!0,h:!0,j:["蜘蛛","动物","蜘蛛类","animal","arachnid"],k:[29,34],o:2},space_invader:{a:"AlienMonster",b:"1F47E",d:!0,e:!0,f:!0,h:!0,j:["外星怪物","游戏","拱廊","玩","game","arcade","play"],k:[23,44],o:2},motorway:{a:"Motorway",b:"1F6E3-FE0F",c:"1F6E3",d:!0,e:!0,f:!0,h:!0,j:["公路","路","库比蒂诺","州际的","公路","road","cupertino","interstate","highway"],k:[36,45],o:2},"flag-gr":{a:"GreeceFlag",b:"1F1EC-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[2,10],o:2,j:["希腊国旗"]},recycle:{a:"BlackUniversalRecyclingSymbol",b:"267B-FE0F",c:"267B",d:!0,e:!0,f:!0,h:!0,j:["回收标志","箭","环境","垃圾","垃圾","arrow","environment","garbage","trash"],k:[53,38],o:2},coffee:{a:"HotBeverage",b:"2615",d:!0,e:!0,f:!0,h:!0,j:["热饮料","饮料","咖啡因","牛奶","表达","beverage","caffeine","latte","espresso"],k:[53,0],o:2},flashlight:{a:"ElectricTorch",b:"1F526",d:!0,e:!0,f:!0,h:!0,j:["手电筒","黑暗","露营","景象","晚上","dark","camping","sight","night"],k:[28,9],o:2},spider_web:{a:"SpiderWeb",b:"1F578-FE0F",c:"1F578",d:!0,e:!0,f:!0,h:!0,j:["蜘蛛网","动物","昆虫","蜘蛛类","丝绸","animal","insect","arachnid","silk"],k:[29,35],o:2},izakaya_lantern:{a:"IzakayaLantern",b:"1F3EE",d:!0,e:!0,f:!0,h:!0,j:["红灯笼","光","纸","万圣节","怪异","light","paper","halloween","spooky"],k:[11,8],n:["lantern"],o:2},"flag-gs":{a:"SouthGeorgia&SouthSandwichIslandsFlag",b:"1F1EC-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[2,11],o:2,j:["南乔治亚岛与南三明治群岛旗"]},shrug:{skin_variations:{"1F3FB":{unified:"1F937-1F3FB",non_qualified:null,image:"1f937-1f3fb.png",sheet_x:39,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F937-1F3FC",non_qualified:null,image:"1f937-1f3fc.png",sheet_x:39,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F937-1F3FD",non_qualified:null,image:"1f937-1f3fd.png",sheet_x:39,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F937-1F3FE",non_qualified:null,image:"1f937-1f3fe.png",sheet_x:39,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F937-1F3FF",non_qualified:null,image:"1f937-1f3ff.png",sheet_x:39,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},a:"Shrug",b:"1F937",d:!0,e:!0,f:!0,h:!1,k:[39,47],o:4,j:["双手一摊的人"]},fleur_de_lis:{a:"FleurDeLis",b:"269C-FE0F",c:"269C",d:!0,e:!0,f:!0,h:!0,j:["鸢尾花","装饰","侦察员","decorative","scout"],k:[53,49],o:2},robot_face:{a:"RobotFace",b:"1F916",d:!0,e:!0,f:!0,h:!0,k:[37,29],o:2,j:["机器人"]},railway_track:{a:"RailwayTrack",b:"1F6E4-FE0F",c:"1F6E4",d:!0,e:!0,f:!0,h:!0,j:["铁路轨道","火车","运输","train","transportation"],k:[36,46],o:2},tea:{a:"TeacupWithoutHandle",b:"1F375",d:!0,e:!0,f:!0,h:!0,j:["不带提手的茶杯","喝","碗","早餐","绿","英国的","drink","bowl","breakfast","green","british"],k:[7,20],o:2},"flag-gt":{a:"GuatemalaFlag",b:"1F1EC-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[2,12],o:2,j:["危地马拉国旗"]},oil_drum:{a:"OilDrum",b:"1F6E2-FE0F",c:"1F6E2",d:!0,e:!0,f:!0,h:!0,j:["油桶","桶装","barrell"],k:[36,44],o:2},diya_lamp:{a:"DiyaLamp",b:"1FA94",d:!0,e:!0,f:!0,h:!0,k:[52,8],o:12,j:["油灯"]},sake:{a:"SakeBottleandCup",b:"1F376",d:!0,e:!0,f:!0,h:!0,j:["清酒","酒","喝","醉","饮料","日语","酒精","豪饮","wine","drink","drunk","beverage","japanese","alcohol","booze"],k:[7,21],o:2},trident:{a:"TridentEmblem",b:"1F531",d:!0,e:!0,f:!0,h:!0,j:["三叉戟","武器","矛","weapon","spear"],k:[28,20],o:2},"man-shrugging":{skin_variations:{"1F3FB":{unified:"1F937-1F3FB-200D-2642-FE0F",non_qualified:"1F937-1F3FB-200D-2642",image:"1f937-1f3fb-200d-2642-fe0f.png",sheet_x:39,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F937-1F3FC-200D-2642-FE0F",non_qualified:"1F937-1F3FC-200D-2642",image:"1f937-1f3fc-200d-2642-fe0f.png",sheet_x:39,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F937-1F3FD-200D-2642-FE0F",non_qualified:"1F937-1F3FD-200D-2642",image:"1f937-1f3fd-200d-2642-fe0f.png",sheet_x:39,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F937-1F3FE-200D-2642-FE0F",non_qualified:"1F937-1F3FE-200D-2642",image:"1f937-1f3fe-200d-2642-fe0f.png",sheet_x:39,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F937-1F3FF-200D-2642-FE0F",non_qualified:"1F937-1F3FF-200D-2642",image:"1f937-1f3ff-200d-2642-fe0f.png",sheet_x:39,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManShrugging",b:"1F937-200D-2642-FE0F",c:"1F937-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[39,41],o:4,j:["双手一摊的男人"]},smiley_cat:{a:"SmilingCatFacewithOpenMouth",b:"1F63A",d:!0,e:!0,f:!0,h:!0,j:["笑嘻嘻的猫","动物","猫","快乐","微笑","animal","cats","happy","smile"],k:[31,36],o:2},scorpion:{a:"Scorpion",b:"1F982",d:!0,e:!0,f:!0,h:!0,j:["蝎","动物","蜘蛛类","animal","arachnid"],k:[42,20],o:2},"woman-shrugging":{skin_variations:{"1F3FB":{unified:"1F937-1F3FB-200D-2640-FE0F",non_qualified:"1F937-1F3FB-200D-2640",image:"1f937-1f3fb-200d-2640-fe0f.png",sheet_x:39,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F937-1F3FC-200D-2640-FE0F",non_qualified:"1F937-1F3FC-200D-2640",image:"1f937-1f3fc-200d-2640-fe0f.png",sheet_x:39,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F937-1F3FD-200D-2640-FE0F",non_qualified:"1F937-1F3FD-200D-2640",image:"1f937-1f3fd-200d-2640-fe0f.png",sheet_x:39,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F937-1F3FE-200D-2640-FE0F",non_qualified:"1F937-1F3FE-200D-2640",image:"1f937-1f3fe-200d-2640-fe0f.png",sheet_x:39,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F937-1F3FF-200D-2640-FE0F",non_qualified:"1F937-1F3FF-200D-2640",image:"1f937-1f3ff-200d-2640-fe0f.png",sheet_x:39,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanShrugging",b:"1F937-200D-2640-FE0F",c:"1F937-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[39,35],o:4,j:["双手一摊的女人"]},notebook_with_decorative_cover:{a:"NotebookwithDecorativeCover",b:"1F4D4",d:!0,e:!0,f:!0,h:!0,j:["有装饰的笔记本","课堂","笔记","记录","纸","研究","classroom","notes","record","paper","study"],k:[26,42],o:2},fuelpump:{a:"FuelPump",b:"26FD",d:!0,e:!0,f:!0,h:!0,j:["加油泵","加油站","石油","gasstation","petroleum"],k:[54,38],o:2},name_badge:{a:"NameBadge",b:"1F4DB",d:!0,e:!0,f:!0,h:!0,j:["名牌徽章","火灾","禁止","fire","forbid"],k:[26,49],o:2},mosquito:{a:"Mosquito",b:"1F99F",d:!0,e:!0,f:!0,h:!0,k:[42,49],o:11,j:["蚊子"]},"flag-gu":{a:"GuamFlag",b:"1F1EC-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[2,13],o:2,j:["关岛旗"]},smile_cat:{a:"GrinningCatFacewithSmilingEyes",b:"1F638",d:!0,e:!0,f:!0,h:!0,j:["眉开眼笑的猫","动物","猫","微笑","animal","cats","smile"],k:[31,34],o:2},champagne:{a:"BottlewithPoppingCork",b:"1F37E",d:!0,e:!0,f:!0,h:!0,j:["开启的香槟","喝","酒","瓶","庆祝","drink","wine","bottle","celebration"],k:[7,29],o:2},joy_cat:{a:"CatFacewithTearsofJoy",b:"1F639",d:!0,e:!0,f:!0,h:!0,j:["笑Cry的猫","动物","猫","哈哈","快乐","眼泪","animal","cats","haha","happy","tears"],k:[31,35],o:2},closed_book:{a:"ClosedBook",b:"1F4D5",d:!0,e:!0,f:!0,h:!0,j:["闭卷","读","图书馆","知识","教科书","学习","read","library","knowledge","textbook","learn"],k:[26,43],o:2},health_worker:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-2695-FE0F",non_qualified:"1F9D1-1F3FB-200D-2695",image:"1f9d1-1f3fb-200d-2695-fe0f.png",sheet_x:47,sheet_y:50,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-2695-FE0F",non_qualified:"1F9D1-1F3FC-200D-2695",image:"1f9d1-1f3fc-200d-2695-fe0f.png",sheet_x:47,sheet_y:51,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-2695-FE0F",non_qualified:"1F9D1-1F3FD-200D-2695",image:"1f9d1-1f3fd-200d-2695-fe0f.png",sheet_x:47,sheet_y:52,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-2695-FE0F",non_qualified:"1F9D1-1F3FE-200D-2695",image:"1f9d1-1f3fe-200d-2695-fe0f.png",sheet_x:47,sheet_y:53,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-2695-FE0F",non_qualified:"1F9D1-1F3FF-200D-2695",image:"1f9d1-1f3ff-200d-2695-fe0f.png",sheet_x:47,sheet_y:54,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"HealthWorker",b:"1F9D1-200D-2695-FE0F",c:"1F9D1-200D-2695",d:!0,e:!1,f:!1,h:!1,k:[47,49],o:12,j:["卫生工作者"]},rotating_light:{a:"PoliceCarsRevolvingLight",b:"1F6A8",d:!0,e:!0,f:!0,h:!0,j:["警车灯","警察","救护车","911","紧急","警报","错误","已 pinged","法律","法律","police","ambulance","911","emergency","alert","error","pinged","law","legal"],k:[34,56],o:2},microbe:{a:"Microbe",b:"1F9A0",d:!0,e:!0,f:!0,h:!0,k:[42,50],o:11,j:["微生物"]},"flag-gw":{a:"Guinea-BissauFlag",b:"1F1EC-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[2,14],o:2,j:["几内亚比绍国旗"]},wine_glass:{a:"WineGlass",b:"1F377",d:!0,e:!0,f:!0,h:!0,j:["红酒杯","喝","饮料","醉","酒精","豪饮","drink","beverage","drunk","alcohol","booze"],k:[7,22],o:2},beginner:{a:"JapaneseSymbolforBeginner",b:"1F530",d:!0,e:!0,f:!0,h:!0,j:["初学者符号","徽章","盾","badge","shield"],k:[28,19],o:2},bouquet:{a:"Bouquet",b:"1F490",d:!0,e:!0,f:!0,h:!0,j:["花束","花","自然界","春天","flowers","nature","spring"],k:[25,26],o:2},heart_eyes_cat:{a:"SmilingCatFacewithHeart-ShapedEyes",b:"1F63B",d:!0,e:!0,f:!0,h:!0,j:["眼冒爱心的猫","动物","爱","喜欢","感情","猫","情人","心","animal","love","like","affection","cats","valentines","heart"],k:[31,37],o:2},"male-doctor":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-2695-FE0F",non_qualified:"1F468-1F3FB-200D-2695",image:"1f468-1f3fb-200d-2695-fe0f.png",sheet_x:17,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-2695-FE0F",non_qualified:"1F468-1F3FC-200D-2695",image:"1f468-1f3fc-200d-2695-fe0f.png",sheet_x:17,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-2695-FE0F",non_qualified:"1F468-1F3FD-200D-2695",image:"1f468-1f3fd-200d-2695-fe0f.png",sheet_x:17,sheet_y:5,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-2695-FE0F",non_qualified:"1F468-1F3FE-200D-2695",image:"1f468-1f3fe-200d-2695-fe0f.png",sheet_x:17,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-2695-FE0F",non_qualified:"1F468-1F3FF-200D-2695",image:"1f468-1f3ff-200d-2695-fe0f.png",sheet_x:17,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleDoctor",b:"1F468-200D-2695-FE0F",c:"1F468-200D-2695",d:!0,e:!0,f:!0,h:!0,k:[17,2],o:4,j:["男性卫生工作者"]},book:{a:"OpenBook",b:"1F4D6",d:!0,e:!0,f:!0,h:!0,k:[26,44],n:["open_book"],o:2,j:["打开书"]},traffic_light:{a:"HorizontalTrafficLight",b:"1F6A5",d:!0,e:!0,f:!0,h:!0,j:["水平红绿灯","运输","信号","transportation","signal"],k:[34,53],o:2},cocktail:{a:"CocktailGlass",b:"1F378",d:!0,e:!0,f:!0,h:!0,j:["鸡尾酒玻璃杯","喝","醉","酒精","饮料","豪饮","莫吉托","drink","drunk","alcohol","beverage","booze","mojito"],k:[7,23],o:2},o:{a:"HeavyLargeCircle",b:"2B55",d:!0,e:!0,f:!0,h:!0,j:["空心红圈","圈","圆","circle","round"],k:[55,43],o:2},"flag-gy":{a:"GuyanaFlag",b:"1F1EC-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[2,15],o:2,j:["圭亚那国旗"]},"female-doctor":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-2695-FE0F",non_qualified:"1F469-1F3FB-200D-2695",image:"1f469-1f3fb-200d-2695-fe0f.png",sheet_x:19,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-2695-FE0F",non_qualified:"1F469-1F3FC-200D-2695",image:"1f469-1f3fc-200d-2695-fe0f.png",sheet_x:19,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-2695-FE0F",non_qualified:"1F469-1F3FD-200D-2695",image:"1f469-1f3fd-200d-2695-fe0f.png",sheet_x:19,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-2695-FE0F",non_qualified:"1F469-1F3FE-200D-2695",image:"1f469-1f3fe-200d-2695-fe0f.png",sheet_x:19,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-2695-FE0F",non_qualified:"1F469-1F3FF-200D-2695",image:"1f469-1f3ff-200d-2695-fe0f.png",sheet_x:19,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleDoctor",b:"1F469-200D-2695-FE0F",c:"1F469-200D-2695",d:!0,e:!0,f:!0,h:!0,k:[19,44],o:4,j:["女性卫生工作者"]},smirk_cat:{a:"CatFacewithWrySmile",b:"1F63C",d:!0,e:!0,f:!0,h:!0,j:["得意的猫","动物","猫","傻笑","animal","cats","smirk"],k:[31,38],o:2},green_book:{a:"GreenBook",b:"1F4D7",d:!0,e:!0,f:!0,h:!0,j:["绿皮书","读","图书馆","知识","研究","read","library","knowledge","study"],k:[26,45],o:2},cherry_blossom:{a:"CherryBlossom",b:"1F338",d:!0,e:!0,f:!0,h:!0,j:["樱花","自然界","植物","春天","花","nature","plant","spring","flower"],k:[6,16],o:2},"flag-hk":{a:"HongKongSarChinaFlag",b:"1F1ED-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[2,16],o:2,j:["香港特别行政区旗"]},vertical_traffic_light:{a:"VerticalTrafficLight",b:"1F6A6",d:!0,e:!0,f:!0,h:!0,j:["垂直红绿灯","运输","驾驶","transportation","driving"],k:[34,54],o:2},white_check_mark:{a:"WhiteHeavyCheckMark",b:"2705",d:!0,e:!0,f:!0,h:!0,j:["选取标记按钮","绿色方块","还行","同意","投票","选举","答","蜱","green-square","ok","agree","vote","election","answer","tick"],k:[54,40],o:2},tropical_drink:{a:"TropicalDrink",b:"1F379",d:!0,e:!0,f:!0,h:!0,j:["热带饮料","饮料","鸡尾酒","夏天","海滩","酒精","豪饮","莫吉托","beverage","cocktail","summer","beach","alcohol","booze","mojito"],k:[7,24],o:2},kissing_cat:{a:"KissingCatFacewithClosedEyes",b:"1F63D",d:!0,e:!0,f:!0,h:!0,j:["接吻的猫","动物","猫","吻","animal","cats","kiss"],k:[31,39],o:2},"flag-hm":{a:"Heard&McdonaldIslandsFlag",b:"1F1ED-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[2,17],o:2,j:["赫德与麦克唐纳群岛旗"]},octagonal_sign:{a:"OctagonalSign",b:"1F6D1",d:!0,e:!0,f:!0,h:!0,k:[36,39],o:4,j:["停止标志"]},white_flower:{a:"WhiteFlower",b:"1F4AE",d:!0,e:!0,f:!0,h:!0,j:["白色的花","日语","春天","japanese","spring"],k:[26,4],o:2},ballot_box_with_check:{a:"BallotBoxwithCheck",b:"2611-FE0F",c:"2611",d:!0,e:!0,f:!0,h:!0,j:["选取框与勾选标记","还行","同意","确认","黑色方块","投票","选举","是的","蜱","ok","agree","confirm","black-square","vote","election","yes","tick"],k:[52,55],o:2},student:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F393",non_qualified:null,image:"1f9d1-1f3fb-200d-1f393.png",sheet_x:45,sheet_y:30,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F393",non_qualified:null,image:"1f9d1-1f3fc-200d-1f393.png",sheet_x:45,sheet_y:31,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F393",non_qualified:null,image:"1f9d1-1f3fd-200d-1f393.png",sheet_x:45,sheet_y:32,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F393",non_qualified:null,image:"1f9d1-1f3fe-200d-1f393.png",sheet_x:45,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F393",non_qualified:null,image:"1f9d1-1f3ff-200d-1f393.png",sheet_x:45,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Student",b:"1F9D1-200D-1F393",d:!0,e:!1,f:!1,h:!1,k:[45,29],o:12,j:["学生"]},blue_book:{a:"BlueBook",b:"1F4D8",d:!0,e:!0,f:!0,h:!0,j:["蓝皮书","读","图书馆","知识","学习","研究","read","library","knowledge","learn","study"],k:[26,46],o:2},beer:{a:"BeerMug",b:"1F37A",d:!0,e:!0,f:!0,h:!0,j:["啤酒杯","放松","饮料","喝","醉","党","酒馆","夏天","酒精","豪饮","relax","beverage","drink","drunk","party","pub","summer","alcohol","booze"],k:[7,25],o:2},construction:{a:"ConstructionSign",b:"1F6A7",d:!0,e:!0,f:!0,h:!0,j:["施工路障","维普","进展","谨慎","警告","wip","progress","caution","warning"],k:[34,55],o:2},rosette:{a:"Rosette",b:"1F3F5-FE0F",c:"1F3F5",d:!0,e:!0,f:!0,h:!0,j:["光荣花","花","装饰","军事","flower","decoration","military"],k:[11,18],o:2},heavy_check_mark:{a:"HeavyCheckMark",b:"2714-FE0F",c:"2714",d:!0,e:!0,f:!0,h:!0,j:["勾选标记","还行","耐克","答","是的","蜱","ok","nike","answer","yes","tick"],k:[55,12],o:2},scream_cat:{a:"WearyCatFace",b:"1F640",d:!0,e:!0,f:!0,h:!0,j:["疲惫的猫","动物","猫","噍","害怕","尖叫","animal","cats","munch","scared","scream"],k:[31,42],o:2},orange_book:{a:"OrangeBook",b:"1F4D9",d:!0,e:!0,f:!0,h:!0,j:["橙色书","读","图书馆","知识","教科书","研究","read","library","knowledge","textbook","study"],k:[26,47],o:2},beers:{a:"ClinkingBeerMugs",b:"1F37B",d:!0,e:!0,f:!0,h:!0,j:["碰撞啤酒杯","放松","饮料","喝","醉","党","酒馆","夏天","酒精","豪饮","relax","beverage","drink","drunk","party","pub","summer","alcohol","booze"],k:[7,26],o:2},"male-student":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F393",non_qualified:null,image:"1f468-1f3fb-200d-1f393.png",sheet_x:14,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F393",non_qualified:null,image:"1f468-1f3fc-200d-1f393.png",sheet_x:14,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F393",non_qualified:null,image:"1f468-1f3fd-200d-1f393.png",sheet_x:14,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F393",non_qualified:null,image:"1f468-1f3fe-200d-1f393.png",sheet_x:14,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F393",non_qualified:null,image:"1f468-1f3ff-200d-1f393.png",sheet_x:14,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleStudent",b:"1F468-200D-1F393",d:!0,e:!0,f:!0,h:!0,k:[14,50],o:4,j:["男学生"]},"flag-hn":{a:"HondurasFlag",b:"1F1ED-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[2,18],o:2,j:["洪都拉斯国旗"]},crying_cat_face:{a:"CryingCatFace",b:"1F63F",d:!0,e:!0,f:!0,h:!0,j:["哭泣的猫","动物","眼泪","哭","伤心","猫","沮丧","哭","animal","tears","weep","sad","cats","upset","cry"],k:[31,41],o:2},anchor:{a:"Anchor",b:"2693",d:!0,e:!0,f:!0,h:!0,j:["锚","船","渡轮","海","船","ship","ferry","sea","boat"],k:[53,42],o:2},"flag-hr":{a:"CroatiaFlag",b:"1F1ED-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[2,19],o:2,j:["克罗地亚国旗"]},heavy_multiplication_x:{a:"HeavyMultiplicationX",b:"2716-FE0F",c:"2716",d:!0,e:!0,f:!0,h:!0,j:["乘号","数学","计算","math","calculation"],k:[55,13],o:2},"female-student":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F393",non_qualified:null,image:"1f469-1f3fb-200d-1f393.png",sheet_x:17,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F393",non_qualified:null,image:"1f469-1f3fc-200d-1f393.png",sheet_x:17,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F393",non_qualified:null,image:"1f469-1f3fd-200d-1f393.png",sheet_x:17,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F393",non_qualified:null,image:"1f469-1f3fe-200d-1f393.png",sheet_x:17,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F393",non_qualified:null,image:"1f469-1f3ff-200d-1f393.png",sheet_x:17,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleStudent",b:"1F469-200D-1F393",d:!0,e:!0,f:!0,h:!0,k:[17,40],o:4,j:["女学生"]},rose:{a:"Rose",b:"1F339",d:!0,e:!0,f:!0,h:!0,j:["玫瑰","花","情人","爱","春天","flowers","valentines","love","spring"],k:[6,17],o:2},books:{a:"Books",b:"1F4DA",d:!0,e:!0,f:!0,h:!0,j:["图书","文献","图书馆","研究","literature","library","study"],k:[26,48],o:2},clinking_glasses:{a:"ClinkingGlasses",b:"1F942",d:!0,e:!0,f:!0,h:!0,j:["碰撞玻璃杯","饮料","喝","党","酒精","庆祝","干杯","beverage","drink","party","alcohol","celebrate","cheers"],k:[41,18],o:4},teacher:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F3EB",non_qualified:null,image:"1f9d1-1f3fb-200d-1f3eb.png",sheet_x:45,sheet_y:48,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F3EB",non_qualified:null,image:"1f9d1-1f3fc-200d-1f3eb.png",sheet_x:45,sheet_y:49,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F3EB",non_qualified:null,image:"1f9d1-1f3fd-200d-1f3eb.png",sheet_x:45,sheet_y:50,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F3EB",non_qualified:null,image:"1f9d1-1f3fe-200d-1f3eb.png",sheet_x:45,sheet_y:51,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F3EB",non_qualified:null,image:"1f9d1-1f3ff-200d-1f3eb.png",sheet_x:45,sheet_y:52,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Teacher",b:"1F9D1-200D-1F3EB",d:!0,e:!1,f:!1,h:!1,k:[45,47],o:12,j:["老师"]},x:{a:"CrossMark",b:"274C",d:!0,e:!0,f:!0,h:!0,j:["十字标记","不","删除","删除","取消","no","delete","remove","cancel"],k:[55,21],o:2},pouting_cat:{a:"PoutingCatFace",b:"1F63E",d:!0,e:!0,f:!0,h:!0,j:["撅嘴猫","动物","猫","animal","cats"],k:[31,40],o:2},wilted_flower:{a:"WiltedFlower",b:"1F940",d:!0,e:!0,f:!0,h:!0,j:["枯萎的花","植物","自然界","花","plant","nature","flower"],k:[41,16],o:4},boat:{a:"Sailboat",b:"26F5",d:!0,e:!0,f:!0,h:!0,k:[54,16],n:["sailboat"],o:2,j:["帆船"]},"flag-ht":{a:"HaitiFlag",b:"1F1ED-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[2,20],o:2,j:["海地国旗"]},tumbler_glass:{a:"TumblerGlass",b:"1F943",d:!0,e:!0,f:!0,h:!0,j:["玻璃杯","喝","饮料","醉","酒精","酒","豪饮","波 旁","威士忌","威士忌酒","玻璃","拍摄","drink","beverage","drunk","alcohol","liquor","booze","bourbon","scotch","whisky","glass","shot"],k:[41,19],o:4},notebook:{a:"Notebook",b:"1F4D3",d:!0,e:!0,f:!0,h:!0,j:["笔记本","文具","记录","笔记","纸","研究","stationery","record","notes","paper","study"],k:[26,41],o:2},"male-teacher":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F3EB",non_qualified:null,image:"1f468-1f3fb-200d-1f3eb.png",sheet_x:15,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F3EB",non_qualified:null,image:"1f468-1f3fc-200d-1f3eb.png",sheet_x:15,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F3EB",non_qualified:null,image:"1f468-1f3fd-200d-1f3eb.png",sheet_x:15,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F3EB",non_qualified:null,image:"1f468-1f3fe-200d-1f3eb.png",sheet_x:15,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F3EB",non_qualified:null,image:"1f468-1f3ff-200d-1f3eb.png",sheet_x:15,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleTeacher",b:"1F468-200D-1F3EB",d:!0,e:!0,f:!0,h:!0,k:[15,11],o:4,j:["男老师"]},ledger:{a:"Ledger",b:"1F4D2",d:!0,e:!0,f:!0,h:!0,j:["账本","笔记","纸","notes","paper"],k:[26,40],o:2},"flag-hu":{a:"HungaryFlag",b:"1F1ED-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[2,21],o:2,j:["匈牙利国旗"]},cup_with_straw:{a:"CupwithStraw",b:"1F964",d:!0,e:!0,f:!0,h:!0,k:[41,51],o:5,j:["吸管杯"]},hibiscus:{a:"Hibiscus",b:"1F33A",d:!0,e:!0,f:!0,h:!0,j:["木槿","植物","蔬菜","花","海滩","plant","vegetable","flowers","beach"],k:[6,18],o:2},see_no_evil:{a:"See-No-EvilMonkey",b:"1F648",d:!0,e:!0,f:!0,h:!0,j:["遮眼的猴子","猴子","动物","自然界","哈哈","monkey","animal","nature","haha"],k:[32,44],o:2},canoe:{a:"Canoe",b:"1F6F6",d:!0,e:!0,f:!0,h:!0,j:["独木舟","船","桨","水","船","boat","paddle","water","ship"],k:[36,55],o:4},negative_squared_cross_mark:{a:"NegativeSquaredCrossMark",b:"274E",d:!0,e:!0,f:!0,h:!0,j:["十字标记按钮","x","绿色方块","不","否认","x","green-square","no","deny"],k:[55,22],o:2},"flag-ic":{a:"CanaryIslandsFlag",b:"1F1EE-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[2,22],o:2,j:["加那利群岛旗"]},beverage_box:{a:"BeverageBox",b:"1F9C3",d:!0,e:!0,f:!0,h:!0,k:[44,11],o:12,j:["饮料盒"]},speedboat:{a:"Speedboat",b:"1F6A4",d:!0,e:!0,f:!0,h:!0,j:["快艇","船","运输","车辆","夏天","ship","transportation","vehicle","summer"],k:[34,52],o:2},heavy_plus_sign:{a:"HeavyPlusSign",b:"2795",d:!0,e:!0,f:!0,h:!0,j:["加号","数学","计算","加法","更多","增加","math","calculation","addition","more","increase"],k:[55,29],o:2},sunflower:{a:"Sunflower",b:"1F33B",d:!0,e:!0,f:!0,h:!0,j:["向日葵","自然界","植物","秋天","nature","plant","fall"],k:[6,19],o:2},page_with_curl:{a:"PagewithCurl",b:"1F4C3",d:!0,e:!0,f:!0,h:!0,j:["卷曲的页面","文件","办公室","纸","documents","office","paper"],k:[26,25],o:2},"female-teacher":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F3EB",non_qualified:null,image:"1f469-1f3fb-200d-1f3eb.png",sheet_x:18,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F3EB",non_qualified:null,image:"1f469-1f3fc-200d-1f3eb.png",sheet_x:18,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F3EB",non_qualified:null,image:"1f469-1f3fd-200d-1f3eb.png",sheet_x:18,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F3EB",non_qualified:null,image:"1f469-1f3fe-200d-1f3eb.png",sheet_x:18,sheet_y:5,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F3EB",non_qualified:null,image:"1f469-1f3ff-200d-1f3eb.png",sheet_x:18,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleTeacher",b:"1F469-200D-1F3EB",d:!0,e:!0,f:!0,h:!0,k:[18,1],o:4,j:["女教师"]},hear_no_evil:{a:"Hear-No-EvilMonkey",b:"1F649",d:!0,e:!0,f:!0,h:!0,j:["捂耳的猴子","动物","猴子","自然界","animal","monkey","nature"],k:[32,45],o:2},mate_drink:{a:"MateDrink",b:"1F9C9",d:!0,e:!0,f:!0,h:!0,k:[44,17],o:12,j:["玛岱"]},passenger_ship:{a:"PassengerShip",b:"1F6F3-FE0F",c:"1F6F3",d:!0,e:!0,f:!0,h:!0,j:["客船","游艇","巡航","渡轮","yacht","cruise","ferry"],k:[36,52],o:2},judge:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-2696-FE0F",non_qualified:"1F9D1-1F3FB-200D-2696",image:"1f9d1-1f3fb-200d-2696-fe0f.png",sheet_x:47,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-2696-FE0F",non_qualified:"1F9D1-1F3FC-200D-2696",image:"1f9d1-1f3fc-200d-2696-fe0f.png",sheet_x:48,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-2696-FE0F",non_qualified:"1F9D1-1F3FD-200D-2696",image:"1f9d1-1f3fd-200d-2696-fe0f.png",sheet_x:48,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-2696-FE0F",non_qualified:"1F9D1-1F3FE-200D-2696",image:"1f9d1-1f3fe-200d-2696-fe0f.png",sheet_x:48,sheet_y:2,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-2696-FE0F",non_qualified:"1F9D1-1F3FF-200D-2696",image:"1f9d1-1f3ff-200d-2696-fe0f.png",sheet_x:48,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Judge",b:"1F9D1-200D-2696-FE0F",c:"1F9D1-200D-2696",d:!0,e:!1,f:!1,h:!1,k:[47,55],o:12,j:["法官"]},scroll:{a:"Scroll",b:"1F4DC",d:!0,e:!0,f:!0,h:!0,j:["卷轴","文件","古代","历史","纸","documents","ancient","history","paper"],k:[26,50],o:2},blossom:{a:"Blossom",b:"1F33C",d:!0,e:!0,f:!0,h:!0,j:["开花","自然界","花","黄色","nature","flowers","yellow"],k:[6,20],o:2},"flag-id":{a:"IndonesiaFlag",b:"1F1EE-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[2,23],o:2,j:["印尼国旗"]},speak_no_evil:{a:"Speak-No-EvilMonkey",b:"1F64A",d:!0,e:!0,f:!0,h:!0,j:["捂嘴的猴子","猴子","动物","自然界","嗯","monkey","animal","nature","omg"],k:[32,46],o:2},heavy_minus_sign:{a:"HeavyMinusSign",b:"2796",d:!0,e:!0,f:!0,h:!0,j:["减号","数学","计算","减去","少","math","calculation","subtract","less"],k:[55,30],o:2},"flag-ie":{a:"IrelandFlag",b:"1F1EE-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[2,24],o:2,j:["爱尔兰国旗"]},ice_cube:{a:"IceCube",b:"1F9CA",d:!0,e:!0,f:!0,h:!0,k:[44,18],o:12,j:["冰块"]},page_facing_up:{a:"PageFacingUp",b:"1F4C4",d:!0,e:!0,f:!0,h:!0,j:["页面朝上","文件","办公室","纸","信息","documents","office","paper","information"],k:[26,26],o:2},"male-judge":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-2696-FE0F",non_qualified:"1F468-1F3FB-200D-2696",image:"1f468-1f3fb-200d-2696-fe0f.png",sheet_x:17,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-2696-FE0F",non_qualified:"1F468-1F3FC-200D-2696",image:"1f468-1f3fc-200d-2696-fe0f.png",sheet_x:17,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-2696-FE0F",non_qualified:"1F468-1F3FD-200D-2696",image:"1f468-1f3fd-200d-2696-fe0f.png",sheet_x:17,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-2696-FE0F",non_qualified:"1F468-1F3FE-200D-2696",image:"1f468-1f3fe-200d-2696-fe0f.png",sheet_x:17,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-2696-FE0F",non_qualified:"1F468-1F3FF-200D-2696",image:"1f468-1f3ff-200d-2696-fe0f.png",sheet_x:17,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleJudge",b:"1F468-200D-2696-FE0F",c:"1F468-200D-2696",d:!0,e:!0,f:!0,h:!0,k:[17,8],o:4,j:["男法官"]},tulip:{a:"Tulip",b:"1F337",d:!0,e:!0,f:!0,h:!0,j:["郁金香","花","植物","自然界","夏天","春天","flowers","plant","nature","summer","spring"],k:[6,15],o:2},ferry:{a:"Ferry",b:"26F4-FE0F",c:"26F4",d:!0,e:!0,f:!0,h:!0,j:["渡船","船","船","游艇","boat","ship","yacht"],k:[54,15],o:2},kiss:{a:"KissMark",b:"1F48B",d:!0,e:!0,f:!0,h:!0,j:["吻痕","脸","嘴唇","爱","喜欢","感情","情人","face","lips","love","like","affection","valentines"],k:[25,21],o:2},heavy_division_sign:{a:"HeavyDivisionSign",b:"2797",d:!0,e:!0,f:!0,h:!0,j:["除号","分","数学","计算","divide","math","calculation"],k:[55,31],o:2},newspaper:{a:"Newspaper",b:"1F4F0",d:!0,e:!0,f:!0,h:!0,j:["报纸","压","标题","press","headline"],k:[27,13],o:2},"female-judge":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-2696-FE0F",non_qualified:"1F469-1F3FB-200D-2696",image:"1f469-1f3fb-200d-2696-fe0f.png",sheet_x:19,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-2696-FE0F",non_qualified:"1F469-1F3FC-200D-2696",image:"1f469-1f3fc-200d-2696-fe0f.png",sheet_x:19,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-2696-FE0F",non_qualified:"1F469-1F3FD-200D-2696",image:"1f469-1f3fd-200d-2696-fe0f.png",sheet_x:19,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-2696-FE0F",non_qualified:"1F469-1F3FE-200D-2696",image:"1f469-1f3fe-200d-2696-fe0f.png",sheet_x:19,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-2696-FE0F",non_qualified:"1F469-1F3FF-200D-2696",image:"1f469-1f3ff-200d-2696-fe0f.png",sheet_x:19,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleJudge",b:"1F469-200D-2696-FE0F",c:"1F469-200D-2696",d:!0,e:!0,f:!0,h:!0,k:[19,50],o:4,j:["女法官"]},seedling:{a:"Seedling",b:"1F331",d:!0,e:!0,f:!0,h:!0,j:["幼苗","植物","自然界","草","草坪","春天","plant","nature","grass","lawn","spring"],k:[6,9],o:2},love_letter:{a:"LoveLetter",b:"1F48C",d:!0,e:!0,f:!0,h:!0,j:["爱情信","电子邮件","喜欢","感情","信封","情人","email","like","affection","envelope","valentines"],k:[25,22],o:2},chopsticks:{a:"Chopsticks",b:"1F962",d:!0,e:!0,f:!0,h:!0,k:[41,49],o:5,j:["筷子"]},motor_boat:{a:"MotorBoat",b:"1F6E5-FE0F",c:"1F6E5",d:!0,e:!0,f:!0,h:!0,j:["摩托艇","船","ship"],k:[36,47],o:2},"flag-il":{a:"IsraelFlag",b:"1F1EE-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[2,25],o:2,j:["以色列国旗"]},curly_loop:{a:"CurlyLoop",b:"27B0",d:!0,e:!0,f:!0,h:!0,j:["卷曲环","乱 涂","画","形状","波浪线","scribble","draw","shape","squiggle"],k:[55,33],o:2},"flag-im":{a:"IsleofManFlag",b:"1F1EE-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[2,26],o:2,j:["马恩岛旗"]},evergreen_tree:{a:"EvergreenTree",b:"1F332",d:!0,e:!0,f:!0,h:!0,j:["常青树","植物","自然界","plant","nature"],k:[6,10],o:2},cupid:{a:"HeartwithArrow",b:"1F498",d:!0,e:!0,f:!0,h:!0,j:["穿心箭","爱","喜欢","心","感情","情人","love","like","heart","affection","valentines"],k:[25,34],o:2},loop:{a:"DoubleCurlyLoop",b:"27BF",d:!0,e:!0,f:!0,h:!0,j:["双循环","磁带","暗盒","tape","cassette"],k:[55,34],o:2},ship:{a:"Ship",b:"1F6A2",d:!0,e:!0,f:!0,h:!0,j:["船","运输","钛","部署","transportation","titanic","deploy"],k:[34,33],o:2},farmer:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F33E",non_qualified:null,image:"1f9d1-1f3fb-200d-1f33e.png",sheet_x:45,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F33E",non_qualified:null,image:"1f9d1-1f3fc-200d-1f33e.png",sheet_x:45,sheet_y:19,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F33E",non_qualified:null,image:"1f9d1-1f3fd-200d-1f33e.png",sheet_x:45,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F33E",non_qualified:null,image:"1f9d1-1f3fe-200d-1f33e.png",sheet_x:45,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F33E",non_qualified:null,image:"1f9d1-1f3ff-200d-1f33e.png",sheet_x:45,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Farmer",b:"1F9D1-200D-1F33E",d:!0,e:!1,f:!1,h:!1,k:[45,17],o:12,j:["农民"]},rolled_up_newspaper:{a:"RolledUpNewspaper",b:"1F5DE-FE0F",c:"1F5DE",d:!0,e:!0,f:!0,h:!0,k:[30,23],o:2,j:["卷起的报纸"]},knife_fork_plate:{a:"KnifeForkPlate",b:"1F37D-FE0F",c:"1F37D",d:!0,e:!0,f:!0,h:!0,k:[7,28],o:2,j:["刀叉与盘子"]},fork_and_knife:{a:"ForkandKnife",b:"1F374",d:!0,e:!0,f:!0,h:!0,j:["刀叉","餐具","厨房","cutlery","kitchen"],k:[7,19],o:2},"male-farmer":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F33E",non_qualified:null,image:"1f468-1f3fb-200d-1f33e.png",sheet_x:14,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F33E",non_qualified:null,image:"1f468-1f3fc-200d-1f33e.png",sheet_x:14,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F33E",non_qualified:null,image:"1f468-1f3fd-200d-1f33e.png",sheet_x:14,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F33E",non_qualified:null,image:"1f468-1f3fe-200d-1f33e.png",sheet_x:14,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F33E",non_qualified:null,image:"1f468-1f3ff-200d-1f33e.png",sheet_x:14,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleFarmer",b:"1F468-200D-1F33E",d:!0,e:!0,f:!0,h:!0,k:[14,38],o:4,j:["男性农民"]},bookmark_tabs:{a:"BookmarkTabs",b:"1F4D1",d:!0,e:!0,f:!0,h:!0,j:["书签标签","喜欢","救","次序","整洁","favorite","save","order","tidy"],k:[26,39],o:2},part_alternation_mark:{a:"PartAlternationMark",b:"303D-FE0F",c:"303D",d:!0,e:!0,f:!0,h:!0,j:["部分交替标志","图","介绍","统计","商","经济学","坏","graph","presentation","stats","business","economics","bad"],k:[55,45],o:2},"flag-in":{a:"IndiaFlag",b:"1F1EE-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[2,27],o:2,j:["印度国旗"]},gift_heart:{a:"HeartwithRibbon",b:"1F49D",d:!0,e:!0,f:!0,h:!0,j:["心脏丝带","爱","情人","love","valentines"],k:[25,39],o:2},airplane:{a:"Airplane",b:"2708-FE0F",c:"2708",d:!0,e:!0,f:!0,h:!0,j:["飞机","车辆","运输","飞行","飞","vehicle","transportation","flight","fly"],k:[54,41],o:2},deciduous_tree:{a:"DeciduousTree",b:"1F333",d:!0,e:!0,f:!0,h:!0,j:["落叶乔木","植物","自然界","plant","nature"],k:[6,11],o:2},spoon:{a:"Spoon",b:"1F944",d:!0,e:!0,f:!0,h:!0,j:["勺","餐具","厨房","餐具","cutlery","kitchen","tableware"],k:[41,20],o:4},"flag-io":{a:"BritishIndianOceanTerritoryFlag",b:"1F1EE-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[2,28],o:2,j:["英属印度洋领地旗"]},palm_tree:{a:"PalmTree",b:"1F334",d:!0,e:!0,f:!0,h:!0,j:["榈","植物","蔬菜","自然界","夏天","海滩","莫吉托","热带","plant","vegetable","nature","summer","beach","mojito","tropical"],k:[6,12],o:2},sparkling_heart:{a:"SparklingHeart",b:"1F496",d:!0,e:!0,f:!0,h:!0,j:["波光粼粼的心脏","爱","喜欢","感情","情人","love","like","affection","valentines"],k:[25,32],o:2},"female-farmer":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F33E",non_qualified:null,image:"1f469-1f3fb-200d-1f33e.png",sheet_x:17,sheet_y:29,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F33E",non_qualified:null,image:"1f469-1f3fc-200d-1f33e.png",sheet_x:17,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F33E",non_qualified:null,image:"1f469-1f3fd-200d-1f33e.png",sheet_x:17,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F33E",non_qualified:null,image:"1f469-1f3fe-200d-1f33e.png",sheet_x:17,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F33E",non_qualified:null,image:"1f469-1f3ff-200d-1f33e.png",sheet_x:17,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleFarmer",b:"1F469-200D-1F33E",d:!0,e:!0,f:!0,h:!0,k:[17,28],o:4,j:["女农民"]},eight_spoked_asterisk:{a:"EightSpokedAsterisk",b:"2733-FE0F",c:"2733",d:!0,e:!0,f:!0,h:!0,j:["八辐条星号","星","火花","绿色方块","star","sparkle","green-square"],k:[55,17],o:2},small_airplane:{a:"SmallAirplane",b:"1F6E9-FE0F",c:"1F6E9",d:!0,e:!0,f:!0,h:!0,j:["小型飞机","飞行","运输","飞","车辆","flight","transportation","fly","vehicle"],k:[36,48],o:2},bookmark:{a:"Bookmark",b:"1F516",d:!0,e:!0,f:!0,h:!0,j:["书签","喜欢","标签","救","favorite","label","save"],k:[27,50],o:2},cook:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F373",non_qualified:null,image:"1f9d1-1f3fb-200d-1f373.png",sheet_x:45,sheet_y:24,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F373",non_qualified:null,image:"1f9d1-1f3fc-200d-1f373.png",sheet_x:45,sheet_y:25,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F373",non_qualified:null,image:"1f9d1-1f3fd-200d-1f373.png",sheet_x:45,sheet_y:26,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F373",non_qualified:null,image:"1f9d1-1f3fe-200d-1f373.png",sheet_x:45,sheet_y:27,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F373",non_qualified:null,image:"1f9d1-1f3ff-200d-1f373.png",sheet_x:45,sheet_y:28,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Cook",b:"1F9D1-200D-1F373",d:!0,e:!1,f:!1,h:!1,k:[45,23],o:12,j:["厨师"]},eight_pointed_black_star:{a:"EightPointedBlackStar",b:"2734-FE0F",c:"2734",d:!0,e:!0,f:!0,h:!0,j:["八角星","橙色方块","形状","多边形","orange-square","shape","polygon"],k:[55,18],o:2},heartpulse:{a:"GrowingHeart",b:"1F497",d:!0,e:!0,f:!0,h:!0,j:["不断增长的心脏","喜欢","爱","感情","情人","粉红色","like","love","affection","valentines","pink"],k:[25,33],o:2},label:{a:"Label",b:"1F3F7-FE0F",c:"1F3F7",d:!0,e:!0,f:!0,h:!0,j:["标签","销售","日","sale","tag"],k:[11,19],o:2},"flag-iq":{a:"IraqFlag",b:"1F1EE-1F1F6",d:!0,e:!0,f:!0,h:!0,k:[2,29],o:2,j:["伊拉克国旗"]},hocho:{a:"Hocho",b:"1F52A",d:!0,e:!0,f:!0,h:!0,j:["菜刀","刀","叶片","餐具","厨房","武器","knife","blade","cutlery","kitchen","weapon"],k:[28,13],n:["knife"],o:2},cactus:{a:"Cactus",b:"1F335",d:!0,e:!0,f:!0,h:!0,j:["仙人掌","蔬菜","植物","自然界","vegetable","plant","nature"],k:[6,13],o:2},airplane_departure:{a:"AirplaneDeparture",b:"1F6EB",d:!0,e:!0,f:!0,h:!0,k:[36,49],o:2,j:["飞机起飞"]},airplane_arriving:{a:"AirplaneArriving",b:"1F6EC",d:!0,e:!0,f:!0,h:!0,k:[36,50],o:2,j:["飞机到达"]},ear_of_rice:{a:"EarofRice",b:"1F33E",d:!0,e:!0,f:!0,h:!0,j:["水稻","自然界","植物","nature","plant"],k:[6,22],o:2},"flag-ir":{a:"IranFlag",b:"1F1EE-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[2,30],o:2,j:["伊朗国旗"]},moneybag:{a:"MoneyBag",b:"1F4B0",d:!0,e:!0,f:!0,h:!0,j:["钱袋","美元","付款","硬币","销售","dollar","payment","coins","sale"],k:[26,6],o:2},"male-cook":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F373",non_qualified:null,image:"1f468-1f3fb-200d-1f373.png",sheet_x:14,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F373",non_qualified:null,image:"1f468-1f3fc-200d-1f373.png",sheet_x:14,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F373",non_qualified:null,image:"1f468-1f3fd-200d-1f373.png",sheet_x:14,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F373",non_qualified:null,image:"1f468-1f3fe-200d-1f373.png",sheet_x:14,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F373",non_qualified:null,image:"1f468-1f3ff-200d-1f373.png",sheet_x:14,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleCook",b:"1F468-200D-1F373",d:!0,e:!0,f:!0,h:!0,k:[14,44],o:4,j:["男厨师"]},heartbeat:{a:"BeatingHeart",b:"1F493",d:!0,e:!0,f:!0,h:!0,j:["跳动的心","爱","喜欢","感情","情人","粉红色","心","love","like","affection","valentines","pink","heart"],k:[25,29],o:2},sparkle:{a:"Sparkle",b:"2747-FE0F",c:"2747",d:!0,e:!0,f:!0,h:!0,j:["火花","星星","绿色方块","棒","好","烟火","stars","green-square","awesome","good","fireworks"],k:[55,20],o:2},amphora:{a:"Amphora",b:"1F3FA",d:!0,e:!0,f:!0,h:!0,j:["安芙兰","花瓶","罐","vase","jar"],k:[11,22],o:2},yen:{a:"BanknotewithYenSign",b:"1F4B4",d:!0,e:!0,f:!0,h:!0,j:["日元纸币","钱","销售","日语","美元","货币","money","sales","japanese","dollar","currency"],k:[26,10],o:2},revolving_hearts:{a:"RevolvingHearts",b:"1F49E",d:!0,e:!0,f:!0,h:!0,j:["旋转的心","爱","喜欢","感情","情人","love","like","affection","valentines"],k:[25,40],o:2},bangbang:{a:"DoubleExclamationMark",b:"203C-FE0F",c:"203C",d:!0,e:!0,f:!0,h:!0,j:["双感叹号","惊叹号","惊喜","exclamation","surprise"],k:[52,10],o:2},parachute:{a:"Parachute",b:"1FA82",d:!0,e:!0,f:!0,h:!0,k:[52,3],o:12,j:["降落伞"]},herb:{a:"Herb",b:"1F33F",d:!0,e:!0,f:!0,h:!0,j:["草本植物","蔬菜","植物","药","杂草","草","草坪","vegetable","plant","medicine","weed","grass","lawn"],k:[6,23],o:2},"flag-is":{a:"IcelandFlag",b:"1F1EE-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[2,31],o:2,j:["冰岛旗"]},"female-cook":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F373",non_qualified:null,image:"1f469-1f3fb-200d-1f373.png",sheet_x:17,sheet_y:35,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F373",non_qualified:null,image:"1f469-1f3fc-200d-1f373.png",sheet_x:17,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F373",non_qualified:null,image:"1f469-1f3fd-200d-1f373.png",sheet_x:17,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F373",non_qualified:null,image:"1f469-1f3fe-200d-1f373.png",sheet_x:17,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F373",non_qualified:null,image:"1f469-1f3ff-200d-1f373.png",sheet_x:17,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleCook",b:"1F469-200D-1F373",d:!0,e:!0,f:!0,h:!0,k:[17,34],o:4,j:["女厨师"]},mechanic:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F527",non_qualified:null,image:"1f9d1-1f3fb-200d-1f527.png",sheet_x:46,sheet_y:15,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F527",non_qualified:null,image:"1f9d1-1f3fc-200d-1f527.png",sheet_x:46,sheet_y:16,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F527",non_qualified:null,image:"1f9d1-1f3fd-200d-1f527.png",sheet_x:46,sheet_y:17,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F527",non_qualified:null,image:"1f9d1-1f3fe-200d-1f527.png",sheet_x:46,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F527",non_qualified:null,image:"1f9d1-1f3ff-200d-1f527.png",sheet_x:46,sheet_y:19,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Mechanic",b:"1F9D1-200D-1F527",d:!0,e:!1,f:!1,h:!1,k:[46,14],o:12,j:["技工"]},interrobang:{a:"ExclamationQuestionMark",b:"2049-FE0F",c:"2049",d:!0,e:!0,f:!0,h:!0,j:["感叹号问号","什么","标点","惊喜","wat","punctuation","surprise"],k:[52,11],o:2},seat:{a:"Seat",b:"1F4BA",d:!0,e:!0,f:!0,h:!0,j:["座位","坐","飞机","运输","总线","飞行","飞","sit","airplane","transport","bus","flight","fly"],k:[26,16],o:2},dollar:{a:"BanknotewithDollarSign",b:"1F4B5",d:!0,e:!0,f:!0,h:!0,j:["美元纸币","钱","销售","法案","货币","money","sales","bill","currency"],k:[26,11],o:2},two_hearts:{a:"TwoHearts",b:"1F495",d:!0,e:!0,f:!0,h:!0,j:["两颗心","爱","喜欢","感情","情人","心","love","like","affection","valentines","heart"],k:[25,31],o:2},it:{a:"ItalyFlag",b:"1F1EE-1F1F9",d:!0,e:!0,f:!0,h:!0,j:["意大利国旗","意大利","旗","国家","国家","旗帜","italy","flag","nation","country","banner"],k:[2,32],n:["flag-it"],o:2},shamrock:{a:"Shamrock",b:"2618-FE0F",c:"2618",d:!0,e:!0,f:!0,h:!0,j:["酢浆草","蔬菜","植物","自然界","爱尔兰语","三叶草","vegetable","plant","nature","irish","clover"],k:[53,1],o:2},four_leaf_clover:{a:"FourLeafClover",b:"1F340",d:!0,e:!0,f:!0,h:!0,j:["四叶草","蔬菜","植物","自然界","幸运","爱尔兰语","vegetable","plant","nature","lucky","irish"],k:[6,24],o:2},euro:{a:"BanknotewithEuroSign",b:"1F4B6",d:!0,e:!0,f:!0,h:!0,j:["欧元纸币","钱","销售","美元","货币","money","sales","dollar","currency"],k:[26,12],o:2},question:{a:"BlackQuestionMarkOrnament",b:"2753",d:!0,e:!0,f:!0,h:!0,j:["问号","怀疑","困惑","doubt","confused"],k:[55,23],o:2},helicopter:{a:"Helicopter",b:"1F681",d:!0,e:!0,f:!0,h:!0,j:["直升机","运输","车辆","飞","transportation","vehicle","fly"],k:[34,0],o:2},heart_decoration:{a:"HeartDecoration",b:"1F49F",d:!0,e:!0,f:!0,h:!0,j:["心脏装饰","紫色方块","爱","喜欢","purple-square","love","like"],k:[25,41],o:2},"flag-je":{a:"JerseyFlag",b:"1F1EF-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[2,33],o:2,j:["泽西岛旗"]},"male-mechanic":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F527",non_qualified:null,image:"1f468-1f3fb-200d-1f527.png",sheet_x:15,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F527",non_qualified:null,image:"1f468-1f3fc-200d-1f527.png",sheet_x:15,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F527",non_qualified:null,image:"1f468-1f3fd-200d-1f527.png",sheet_x:15,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F527",non_qualified:null,image:"1f468-1f3fe-200d-1f527.png",sheet_x:15,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F527",non_qualified:null,image:"1f468-1f3ff-200d-1f527.png",sheet_x:15,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleMechanic",b:"1F468-200D-1F527",d:!0,e:!0,f:!0,h:!0,k:[15,50],o:4,j:["男技工"]},suspension_railway:{a:"SuspensionRailway",b:"1F69F",d:!0,e:!0,f:!0,h:!0,j:["悬挂铁路","车辆","运输","vehicle","transportation"],k:[34,30],o:2},heavy_heart_exclamation_mark_ornament:{a:"HeavyHeartExclamationMarkOrnament",b:"2763-FE0F",c:"2763",d:!0,e:!0,f:!0,h:!0,k:[55,27],o:2,j:["心脏感叹号"]},"female-mechanic":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F527",non_qualified:null,image:"1f469-1f3fb-200d-1f527.png",sheet_x:18,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F527",non_qualified:null,image:"1f469-1f3fc-200d-1f527.png",sheet_x:18,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F527",non_qualified:null,image:"1f469-1f3fd-200d-1f527.png",sheet_x:18,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F527",non_qualified:null,image:"1f469-1f3fe-200d-1f527.png",sheet_x:18,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F527",non_qualified:null,image:"1f469-1f3ff-200d-1f527.png",sheet_x:18,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleMechanic",b:"1F469-200D-1F527",d:!0,e:!0,f:!0,h:!0,k:[18,35],o:4,j:["女技工"]},"flag-jm":{a:"JamaicaFlag",b:"1F1EF-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[2,34],o:2,j:["牙买加国旗"]},grey_question:{a:"WhiteQuestionMarkOrnament",b:"2754",d:!0,e:!0,f:!0,h:!0,j:["白色问号","怀疑","灰色","哼","困惑","doubts","gray","huh","confused"],k:[55,24],o:2},maple_leaf:{a:"MapleLeaf",b:"1F341",d:!0,e:!0,f:!0,h:!0,j:["枫叶","自然界","植物","蔬菜","喜欢","秋天","nature","plant","vegetable","ca","fall"],k:[6,25],o:2},pound:{a:"BanknotewithPoundSign",b:"1F4B7",d:!0,e:!0,f:!0,h:!0,j:["英镑纸币","英国的","英镑","钱","销售","条例 草案","英国","英国","货币","british","sterling","money","sales","bills","uk","england","currency"],k:[26,13],o:2},money_with_wings:{a:"MoneywithWings",b:"1F4B8",d:!0,e:!0,f:!0,h:!0,j:["带翅膀的钱","美元","条例 草案","付款","销售","dollar","bills","payment","sale"],k:[26,14],o:2},"flag-jo":{a:"JordanFlag",b:"1F1EF-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[2,35],o:2,j:["约旦国旗"]},fallen_leaf:{a:"FallenLeaf",b:"1F342",d:!0,e:!0,f:!0,h:!0,j:["落叶","自然界","植物","蔬菜","叶","nature","plant","vegetable","leaves"],k:[6,26],o:2},factory_worker:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F3ED",non_qualified:null,image:"1f9d1-1f3fb-200d-1f3ed.png",sheet_x:45,sheet_y:54,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F3ED",non_qualified:null,image:"1f9d1-1f3fc-200d-1f3ed.png",sheet_x:45,sheet_y:55,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F3ED",non_qualified:null,image:"1f9d1-1f3fd-200d-1f3ed.png",sheet_x:45,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F3ED",non_qualified:null,image:"1f9d1-1f3fe-200d-1f3ed.png",sheet_x:46,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F3ED",non_qualified:null,image:"1f9d1-1f3ff-200d-1f3ed.png",sheet_x:46,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"FactoryWorker",b:"1F9D1-200D-1F3ED",d:!0,e:!1,f:!1,h:!1,k:[45,53],o:12,j:["工人"]},broken_heart:{a:"BrokenHeart",b:"1F494",d:!0,e:!0,f:!0,h:!0,j:["破碎的心脏","伤心","不好意思","破","心","心碎","sad","sorry","break","heart","heartbreak"],k:[25,30],l:["</3"],m:"</3",o:2},grey_exclamation:{a:"WhiteExclamationMarkOrnament",b:"2755",d:!0,e:!0,f:!0,h:!0,j:["白色的感叹号","惊喜","标点","灰色","哇","警告","surprise","punctuation","gray","wow","warning"],k:[55,25],o:2},mountain_cableway:{a:"MountainCableway",b:"1F6A0",d:!0,e:!0,f:!0,h:!0,j:["山缆车","运输","车辆","滑雪","transportation","vehicle","ski"],k:[34,31],o:2},exclamation:{a:"HeavyExclamationMarkSymbol",b:"2757",d:!0,e:!0,f:!0,h:!0,j:["感叹号","heavy_exclamation_mark","危险","惊喜","标点","哇","警告","heavy_exclamation_mark","danger","surprise","punctuation","wow","warning"],k:[55,26],n:["heavy_exclamation_mark"],o:2},leaves:{a:"LeafFlutteringinWind",b:"1F343",d:!0,e:!0,f:!0,h:!0,j:["叶子落下","自然界","植物","树","蔬菜","草","草坪","春天","nature","plant","tree","vegetable","grass","lawn","spring"],k:[6,27],o:2},heart:{a:"HeavyBlackHeart",b:"2764-FE0F",c:"2764",d:!0,e:!0,f:!0,h:!0,j:["红心","爱","喜欢","情人","love","like","valentines"],k:[55,28],l:["<3"],m:"<3",o:2},jp:{a:"JapanFlag",b:"1F1EF-1F1F5",d:!0,e:!0,f:!0,h:!0,j:["日本国旗","日语","国家","旗","国家","旗帜","japanese","nation","flag","country","banner"],k:[2,36],n:["flag-jp"],o:2},"male-factory-worker":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F3ED",non_qualified:null,image:"1f468-1f3fb-200d-1f3ed.png",sheet_x:15,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F3ED",non_qualified:null,image:"1f468-1f3fc-200d-1f3ed.png",sheet_x:15,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F3ED",non_qualified:null,image:"1f468-1f3fd-200d-1f3ed.png",sheet_x:15,sheet_y:20,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F3ED",non_qualified:null,image:"1f468-1f3fe-200d-1f3ed.png",sheet_x:15,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F3ED",non_qualified:null,image:"1f468-1f3ff-200d-1f3ed.png",sheet_x:15,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleFactoryWorker",b:"1F468-200D-1F3ED",d:!0,e:!0,f:!0,h:!0,k:[15,17],o:4,j:["男工厂工人"]},credit_card:{a:"CreditCard",b:"1F4B3",d:!0,e:!0,f:!0,h:!0,j:["信用卡","钱","销售","美元","法案","付款","购物","money","sales","dollar","bill","payment","shopping"],k:[26,9],o:2},aerial_tramway:{a:"AerialTramway",b:"1F6A1",d:!0,e:!0,f:!0,h:!0,j:["空中缆车","运输","车辆","滑雪","transportation","vehicle","ski"],k:[34,32],o:2},"female-factory-worker":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F3ED",non_qualified:null,image:"1f469-1f3fb-200d-1f3ed.png",sheet_x:18,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F3ED",non_qualified:null,image:"1f469-1f3fc-200d-1f3ed.png",sheet_x:18,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F3ED",non_qualified:null,image:"1f469-1f3fd-200d-1f3ed.png",sheet_x:18,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F3ED",non_qualified:null,image:"1f469-1f3fe-200d-1f3ed.png",sheet_x:18,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F3ED",non_qualified:null,image:"1f469-1f3ff-200d-1f3ed.png",sheet_x:18,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleFactoryWorker",b:"1F469-200D-1F3ED",d:!0,e:!0,f:!0,h:!0,k:[18,7],o:4,j:["女工厂工人"]},receipt:{a:"Receipt",b:"1F9FE",d:!0,e:!0,f:!0,h:!0,k:[51,49],o:11,j:["收据"]},wavy_dash:{a:"WavyDash",b:"3030-FE0F",c:"3030",d:!0,e:!0,f:!0,h:!0,j:["波浪符号","画","线","胡子","胡子","波浪线","乱 涂","draw","line","moustache","mustache","squiggle","scribble"],k:[55,44],o:2},"flag-ke":{a:"KenyaFlag",b:"1F1F0-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[2,37],o:2,j:["肯尼亚国旗"]},satellite:{a:"Satellite",b:"1F6F0-FE0F",c:"1F6F0",d:!0,e:!0,f:!0,h:!0,j:["卫星","通信","前途","收音机","空间","communication","future","radio","space"],k:[36,51],o:2},orange_heart:{a:"OrangeHeart",b:"1F9E1",d:!0,e:!0,f:!0,h:!0,k:[51,20],o:5,j:["橙色心脏"]},yellow_heart:{a:"YellowHeart",b:"1F49B",d:!0,e:!0,f:!0,h:!0,j:["黄心脏","爱","喜欢","感情","情人","love","like","affection","valentines"],k:[25,37],m:"<3",o:2},copyright:{a:"CopyrightSign",b:"00A9-FE0F",c:"00A9",d:!0,e:!0,f:!0,h:!1,j:["版权","断续器","许可证","圈","法律","法律","ip","license","circle","law","legal"],k:[0,12],o:2},rocket:{a:"Rocket",b:"1F680",d:!0,e:!0,f:!0,h:!0,j:["火箭","发射","船","员工模式","美国宇航局","外太空","outer_space","飞","launch","ship","staffmode","NASA","outerspace","outer_space","fly"],k:[33,56],o:2},chart:{a:"ChartwithUpwardsTrendandYenSign",b:"1F4B9",d:!0,e:!0,f:!0,h:!0,j:["人民币上涨","绿色方块","图","介绍","统计","green-square","graph","presentation","stats"],k:[26,15],o:2},"flag-kg":{a:"KyrgyzstanFlag",b:"1F1F0-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[2,38],o:2,j:["吉尔吉斯斯坦国旗"]},office_worker:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F4BC",non_qualified:null,image:"1f9d1-1f3fb-200d-1f4bc.png",sheet_x:46,sheet_y:9,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F4BC",non_qualified:null,image:"1f9d1-1f3fc-200d-1f4bc.png",sheet_x:46,sheet_y:10,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F4BC",non_qualified:null,image:"1f9d1-1f3fd-200d-1f4bc.png",sheet_x:46,sheet_y:11,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F4BC",non_qualified:null,image:"1f9d1-1f3fe-200d-1f4bc.png",sheet_x:46,sheet_y:12,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F4BC",non_qualified:null,image:"1f9d1-1f3ff-200d-1f4bc.png",sheet_x:46,sheet_y:13,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"OfficeWorker",b:"1F9D1-200D-1F4BC",d:!0,e:!1,f:!1,h:!1,k:[46,8],o:12,j:["白领"]},currency_exchange:{a:"CurrencyExchange",b:"1F4B1",d:!0,e:!0,f:!0,h:!0,j:["货币交换","钱","销售","美元","旅行","money","sales","dollar","travel"],k:[26,7],o:2},registered:{a:"RegisteredSign",b:"00AE-FE0F",c:"00AE",d:!0,e:!0,f:!0,h:!1,j:["注册商标","字母","圈","alphabet","circle"],k:[0,13],o:2},green_heart:{a:"GreenHeart",b:"1F49A",d:!0,e:!0,f:!0,h:!0,j:["绿色心脏","爱","喜欢","感情","情人","love","like","affection","valentines"],k:[25,36],m:"<3",o:2},flying_saucer:{a:"FlyingSaucer",b:"1F6F8",d:!0,e:!0,f:!0,h:!0,k:[37,0],o:5,j:["飞碟"]},"flag-kh":{a:"CambodiaFlag",b:"1F1F0-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[2,39],o:2,j:["柬埔寨国旗"]},"male-office-worker":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F4BC",non_qualified:null,image:"1f468-1f3fb-200d-1f4bc.png",sheet_x:15,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F4BC",non_qualified:null,image:"1f468-1f3fc-200d-1f4bc.png",sheet_x:15,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F4BC",non_qualified:null,image:"1f468-1f3fd-200d-1f4bc.png",sheet_x:15,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F4BC",non_qualified:null,image:"1f468-1f3fe-200d-1f4bc.png",sheet_x:15,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F4BC",non_qualified:null,image:"1f468-1f3ff-200d-1f4bc.png",sheet_x:15,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleOfficeWorker",b:"1F468-200D-1F4BC",d:!0,e:!0,f:!0,h:!0,k:[15,44],o:4,j:["男性上班族"]},tm:{a:"TradeMarkSign",b:"2122-FE0F",c:"2122",d:!0,e:!0,f:!0,h:!0,j:["商标","商标","品牌","法律","法律","trademark","brand","law","legal"],k:[52,12],o:2},bellhop_bell:{a:"BellhopBell",b:"1F6CE-FE0F",c:"1F6CE",d:!0,e:!0,f:!0,h:!0,j:["服务铃","服务","service"],k:[36,36],o:2},blue_heart:{a:"BlueHeart",b:"1F499",d:!0,e:!0,f:!0,h:!0,j:["蓝色心脏","爱","喜欢","感情","情人","love","like","affection","valentines"],k:[25,35],m:"<3",o:2},"flag-ki":{a:"KiribatiFlag",b:"1F1F0-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[2,40],o:2,j:["基里巴斯国旗"]},heavy_dollar_sign:{a:"HeavyDollarSign",b:"1F4B2",d:!0,e:!0,f:!0,h:!0,j:["美元符号","钱","销售","付款","货币","麚","money","sales","payment","currency","buck"],k:[26,8],o:2},"female-office-worker":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F4BC",non_qualified:null,image:"1f469-1f3fb-200d-1f4bc.png",sheet_x:18,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F4BC",non_qualified:null,image:"1f469-1f3fc-200d-1f4bc.png",sheet_x:18,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F4BC",non_qualified:null,image:"1f469-1f3fd-200d-1f4bc.png",sheet_x:18,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F4BC",non_qualified:null,image:"1f469-1f3fe-200d-1f4bc.png",sheet_x:18,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F4BC",non_qualified:null,image:"1f469-1f3ff-200d-1f4bc.png",sheet_x:18,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleOfficeWorker",b:"1F469-200D-1F4BC",d:!0,e:!0,f:!0,h:!0,k:[18,29],o:4,j:["女性上班族"]},purple_heart:{a:"PurpleHeart",b:"1F49C",d:!0,e:!0,f:!0,h:!0,j:["紫色的心脏","爱","喜欢","感情","情人","love","like","affection","valentines"],k:[25,38],m:"<3",o:2},scientist:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F52C",non_qualified:null,image:"1f9d1-1f3fb-200d-1f52c.png",sheet_x:46,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F52C",non_qualified:null,image:"1f9d1-1f3fc-200d-1f52c.png",sheet_x:46,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F52C",non_qualified:null,image:"1f9d1-1f3fd-200d-1f52c.png",sheet_x:46,sheet_y:23,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F52C",non_qualified:null,image:"1f9d1-1f3fe-200d-1f52c.png",sheet_x:46,sheet_y:24,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F52C",non_qualified:null,image:"1f9d1-1f3ff-200d-1f52c.png",sheet_x:46,sheet_y:25,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Scientist",b:"1F9D1-200D-1F52C",d:!0,e:!1,f:!1,h:!1,k:[46,20],o:12,j:["科学家"]},luggage:{a:"Luggage",b:"1F9F3",d:!0,e:!0,f:!0,h:!0,k:[51,38],o:11,j:["行李"]},hash:{a:"HashKey",b:"0023-FE0F-20E3",c:"0023-20E3",d:!0,e:!0,f:!0,h:!1,j:["井字号按钮","象征","蓝色方块","唽","symbol","blue-square","twitter"],k:[0,0],o:0},"flag-km":{a:"ComorosFlag",b:"1F1F0-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[2,41],o:2,j:["科摩罗国旗"]},email:{a:"Envelope",b:"2709-FE0F",c:"2709",d:!0,e:!0,f:!0,h:!0,j:["信封","信","邮政","收件箱","通信","letter","postal","inbox","communication"],k:[54,42],n:["envelope"],o:2},"e-mail":{a:"E-MailSymbol",b:"1F4E7",d:!0,e:!0,f:!0,h:!0,j:["电子邮件","通信","收件箱","communication","inbox"],k:[27,4],o:2},keycap_star:{a:"KeycapStar",b:"002A-FE0F-20E3",c:"002A-20E3",d:!0,e:!0,f:!0,h:!1,k:[0,1],o:0,j:["米字号按钮"]},"flag-kn":{a:"St.Kitts&NevisFlag",b:"1F1F0-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[2,42],o:2,j:["圣基茨和尼维斯国旗"]},hourglass:{a:"Hourglass",b:"231B",d:!0,e:!0,f:!0,h:!0,j:["完成的沙漏","时间","时钟","老派","限制","考试","测验","测试","time","clock","oldschool","limit","exam","quiz","test"],k:[52,23],o:2},brown_heart:{a:"BrownHeart",b:"1F90E",d:!0,e:!0,f:!0,h:!0,k:[37,16],o:12,j:["棕色心脏"]},"male-scientist":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F52C",non_qualified:null,image:"1f468-1f3fb-200d-1f52c.png",sheet_x:16,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F52C",non_qualified:null,image:"1f468-1f3fc-200d-1f52c.png",sheet_x:16,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F52C",non_qualified:null,image:"1f468-1f3fd-200d-1f52c.png",sheet_x:16,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F52C",non_qualified:null,image:"1f468-1f3fe-200d-1f52c.png",sheet_x:16,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F52C",non_qualified:null,image:"1f468-1f3ff-200d-1f52c.png",sheet_x:16,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleScientist",b:"1F468-200D-1F52C",d:!0,e:!0,f:!0,h:!0,k:[15,56],o:4,j:["男科学家"]},hourglass_flowing_sand:{a:"HourglasswithFlowingSand",b:"23F3",d:!0,e:!0,f:!0,h:!0,j:["未完成的沙漏","老派","时间","倒计时","oldschool","time","countdown"],k:[52,36],o:2},black_heart:{a:"BlackHeart",b:"1F5A4",d:!0,e:!0,f:!0,h:!0,j:["黑色心脏","邪","evil"],k:[30,9],o:4},zero:{a:"Keycap0",b:"0030-FE0F-20E3",c:"0030-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮0","0","数字","蓝色方块","零","0","numbers","blue-square","null"],k:[0,2],o:0},incoming_envelope:{a:"IncomingEnvelope",b:"1F4E8",d:!0,e:!0,f:!0,h:!0,j:["来信","电子邮件","收件箱","email","inbox"],k:[27,5],o:2},"flag-kp":{a:"NorthKoreaFlag",b:"1F1F0-1F1F5",d:!0,e:!0,f:!0,h:!0,k:[2,43],o:2,j:["朝鲜国旗"]},"female-scientist":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F52C",non_qualified:null,image:"1f469-1f3fb-200d-1f52c.png",sheet_x:18,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F52C",non_qualified:null,image:"1f469-1f3fc-200d-1f52c.png",sheet_x:18,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F52C",non_qualified:null,image:"1f469-1f3fd-200d-1f52c.png",sheet_x:18,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F52C",non_qualified:null,image:"1f469-1f3fe-200d-1f52c.png",sheet_x:18,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F52C",non_qualified:null,image:"1f469-1f3ff-200d-1f52c.png",sheet_x:18,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleScientist",b:"1F469-200D-1F52C",d:!0,e:!0,f:!0,h:!0,k:[18,41],o:4,j:["女科学家"]},watch:{a:"Watch",b:"231A",d:!0,e:!0,f:!0,h:!0,j:["表","时间","辅料","time","accessories"],k:[52,22],o:2},white_heart:{a:"WhiteHeart",b:"1F90D",d:!0,e:!0,f:!0,h:!0,k:[37,15],o:12,j:["白心脏"]},one:{a:"Keycap1",b:"0031-FE0F-20E3",c:"0031-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮1","蓝色方块","数字","1","blue-square","numbers","1"],k:[0,3],o:0},kr:{a:"SouthKoreaFlag",b:"1F1F0-1F1F7",d:!0,e:!0,f:!0,h:!0,j:["韩国国旗","南","韩国","国家","旗","国家","旗帜","south","korea","nation","flag","country","banner"],k:[2,44],n:["flag-kr"],o:2},envelope_with_arrow:{a:"EnvelopewithDownwardsArrowAbove",b:"1F4E9",d:!0,e:!0,f:!0,h:!0,j:["信封与箭头","电子邮件","通信","email","communication"],k:[27,6],o:2},technologist:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F4BB",non_qualified:null,image:"1f9d1-1f3fb-200d-1f4bb.png",sheet_x:46,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F4BB",non_qualified:null,image:"1f9d1-1f3fc-200d-1f4bb.png",sheet_x:46,sheet_y:4,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F4BB",non_qualified:null,image:"1f9d1-1f3fd-200d-1f4bb.png",sheet_x:46,sheet_y:5,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F4BB",non_qualified:null,image:"1f9d1-1f3fe-200d-1f4bb.png",sheet_x:46,sheet_y:6,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F4BB",non_qualified:null,image:"1f9d1-1f3ff-200d-1f4bb.png",sheet_x:46,sheet_y:7,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Technologist",b:"1F9D1-200D-1F4BB",d:!0,e:!1,f:!1,h:!1,k:[46,2],o:12,j:["程序员"]},outbox_tray:{a:"OutboxTray",b:"1F4E4",d:!0,e:!0,f:!0,h:!0,j:["发件箱托盘","收件箱","电子邮件","inbox","email"],k:[27,1],o:2},"male-technologist":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F4BB",non_qualified:null,image:"1f468-1f3fb-200d-1f4bb.png",sheet_x:15,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F4BB",non_qualified:null,image:"1f468-1f3fc-200d-1f4bb.png",sheet_x:15,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F4BB",non_qualified:null,image:"1f468-1f3fd-200d-1f4bb.png",sheet_x:15,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F4BB",non_qualified:null,image:"1f468-1f3fe-200d-1f4bb.png",sheet_x:15,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F4BB",non_qualified:null,image:"1f468-1f3ff-200d-1f4bb.png",sheet_x:15,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleTechnologist",b:"1F468-200D-1F4BB",d:!0,e:!0,f:!0,h:!0,k:[15,38],o:4,j:["男工程师"]},alarm_clock:{a:"AlarmClock",b:"23F0",d:!0,e:!0,f:!0,h:!0,j:["闹钟","时间","唤醒","time","wake"],k:[52,33],o:2},"flag-kw":{a:"KuwaitFlag",b:"1F1F0-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[2,45],o:2,j:["科威特国旗"]},two:{a:"Keycap2",b:"0032-FE0F-20E3",c:"0032-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮2","数字","2","主要","蓝色方块","numbers","2","prime","blue-square"],k:[0,4],o:0},anger:{a:"AngerSymbol",b:"1F4A2",d:!0,e:!0,f:!0,h:!0,j:["愤怒符号","生气","狂","angry","mad"],k:[25,44],o:2},inbox_tray:{a:"InboxTray",b:"1F4E5",d:!0,e:!0,f:!0,h:!0,j:["收件箱托盘","电子邮件","文件","email","documents"],k:[27,2],o:2},three:{a:"Keycap3",b:"0033-FE0F-20E3",c:"0033-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮3","3","数字","主要","蓝色方块","3","numbers","prime","blue-square"],k:[0,5],o:0},"flag-ky":{a:"CaymanIslandsFlag",b:"1F1F0-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[2,46],o:2,j:["开曼群岛旗"]},stopwatch:{a:"Stopwatch",b:"23F1-FE0F",c:"23F1",d:!0,e:!0,f:!0,h:!0,j:["码表","时间","限期","time","deadline"],k:[52,34],o:2},"female-technologist":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F4BB",non_qualified:null,image:"1f469-1f3fb-200d-1f4bb.png",sheet_x:18,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F4BB",non_qualified:null,image:"1f469-1f3fc-200d-1f4bb.png",sheet_x:18,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F4BB",non_qualified:null,image:"1f469-1f3fd-200d-1f4bb.png",sheet_x:18,sheet_y:26,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F4BB",non_qualified:null,image:"1f469-1f3fe-200d-1f4bb.png",sheet_x:18,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F4BB",non_qualified:null,image:"1f469-1f3ff-200d-1f4bb.png",sheet_x:18,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleTechnologist",b:"1F469-200D-1F4BB",d:!0,e:!0,f:!0,h:!0,k:[18,23],o:4,j:["女工程师"]},boom:{a:"CollisionSymbol",b:"1F4A5",d:!0,e:!0,f:!0,h:!0,j:["碰撞","炸弹","爆炸","爆炸","碰撞","吹","bomb","explode","explosion","collision","blown"],k:[25,47],n:["collision"],o:2},"flag-kz":{a:"KazakhstanFlag",b:"1F1F0-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[2,47],o:2,j:["哈萨克斯坦国旗"]},four:{a:"Keycap4",b:"0034-FE0F-20E3",c:"0034-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮4","4","数字","蓝色方块","4","numbers","blue-square"],k:[0,6],o:0},timer_clock:{a:"TimerClock",b:"23F2-FE0F",c:"23F2",d:!0,e:!0,f:!0,h:!0,j:["定时器","报警","alarm"],k:[52,35],o:2},singer:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F3A4",non_qualified:null,image:"1f9d1-1f3fb-200d-1f3a4.png",sheet_x:45,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F3A4",non_qualified:null,image:"1f9d1-1f3fc-200d-1f3a4.png",sheet_x:45,sheet_y:37,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F3A4",non_qualified:null,image:"1f9d1-1f3fd-200d-1f3a4.png",sheet_x:45,sheet_y:38,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F3A4",non_qualified:null,image:"1f9d1-1f3fe-200d-1f3a4.png",sheet_x:45,sheet_y:39,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F3A4",non_qualified:null,image:"1f9d1-1f3ff-200d-1f3a4.png",sheet_x:45,sheet_y:40,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Singer",b:"1F9D1-200D-1F3A4",d:!0,e:!1,f:!1,h:!1,k:[45,35],o:12,j:["歌手"]},package:{a:"Package",b:"1F4E6",d:!0,e:!0,f:!0,h:!0,j:["包裹","邮件","礼物","纸板","箱","移动","mail","gift","cardboard","box","moving"],k:[27,3],o:2},mailbox:{a:"ClosedMailboxwithRaisedFlag",b:"1F4EB",d:!0,e:!0,f:!0,h:!0,j:["邮箱关闭（具有向上的标志）","电子邮件","收件箱","通信","email","inbox","communication"],k:[27,8],o:2},"flag-la":{a:"LaosFlag",b:"1F1F1-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[2,48],o:2,j:["老挝国旗"]},dizzy:{a:"DizzySymbol",b:"1F4AB",d:!0,e:!0,f:!0,h:!0,j:["晕眩","星","火花","射","魔法","star","sparkle","shoot","magic"],k:[26,1],o:2},five:{a:"Keycap5",b:"0035-FE0F-20E3",c:"0035-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮5","5","数字","蓝色方块","主要","5","numbers","blue-square","prime"],k:[0,7],o:0},"male-singer":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F3A4",non_qualified:null,image:"1f468-1f3fb-200d-1f3a4.png",sheet_x:15,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F3A4",non_qualified:null,image:"1f468-1f3fc-200d-1f3a4.png",sheet_x:15,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F3A4",non_qualified:null,image:"1f468-1f3fd-200d-1f3a4.png",sheet_x:15,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F3A4",non_qualified:null,image:"1f468-1f3fe-200d-1f3a4.png",sheet_x:15,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F3A4",non_qualified:null,image:"1f468-1f3ff-200d-1f3a4.png",sheet_x:15,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleSinger",b:"1F468-200D-1F3A4",d:!0,e:!0,f:!0,h:!0,k:[14,56],o:4,j:["男歌手"]},mantelpiece_clock:{a:"MantelpieceClock",b:"1F570-FE0F",c:"1F570",d:!0,e:!0,f:!0,h:!0,j:["壁炉钟","时间","time"],k:[29,7],o:2},"female-singer":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F3A4",non_qualified:null,image:"1f469-1f3fb-200d-1f3a4.png",sheet_x:17,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F3A4",non_qualified:null,image:"1f469-1f3fc-200d-1f3a4.png",sheet_x:17,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F3A4",non_qualified:null,image:"1f469-1f3fd-200d-1f3a4.png",sheet_x:17,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F3A4",non_qualified:null,image:"1f469-1f3fe-200d-1f3a4.png",sheet_x:17,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F3A4",non_qualified:null,image:"1f469-1f3ff-200d-1f3a4.png",sheet_x:17,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleSinger",b:"1F469-200D-1F3A4",d:!0,e:!0,f:!0,h:!0,k:[17,46],o:4,j:["女歌手"]},"flag-lb":{a:"LebanonFlag",b:"1F1F1-1F1E7",d:!0,e:!0,f:!0,h:!0,k:[2,49],o:2,j:["黎巴嫩国旗"]},six:{a:"Keycap6",b:"0036-FE0F-20E3",c:"0036-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮6","6","数字","蓝色方块","6","numbers","blue-square"],k:[0,8],o:0},mailbox_closed:{a:"ClosedMailboxwithLoweredFlag",b:"1F4EA",d:!0,e:!0,f:!0,h:!0,j:["邮箱关闭（具有向下的标志）","电子邮件","通信","收件箱","email","communication","inbox"],k:[27,7],o:2},sweat_drops:{a:"SplashingSweatSymbol",b:"1F4A6",d:!0,e:!0,f:!0,h:!0,j:["汗水滴","水","滴","哎呀","water","drip","oops"],k:[25,48],o:2},clock12:{a:"ClockFaceTwelveOclock",b:"1F55B",d:!0,e:!0,f:!0,h:!0,j:["十二点钟","时间","中午","午夜","中午","晚","早","附表","time","noon","midnight","midday","late","early","schedule"],k:[28,50],o:2},seven:{a:"Keycap7",b:"0037-FE0F-20E3",c:"0037-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮7","7","数字","蓝色方块","主要","7","numbers","blue-square","prime"],k:[0,9],o:0},mailbox_with_mail:{a:"OpenMailboxwithRaisedFlag",b:"1F4EC",d:!0,e:!0,f:!0,h:!0,j:["邮箱开启（具有向上的标志）","电子邮件","收件箱","通信","email","inbox","communication"],k:[27,9],o:2},clock1230:{a:"ClockFaceTwelve-Thirty",b:"1F567",d:!0,e:!0,f:!0,h:!0,j:["十二点半","时间","晚","早","附表","time","late","early","schedule"],k:[29,5],o:2},dash:{a:"DashSymbol",b:"1F4A8",d:!0,e:!0,f:!0,h:!0,j:["冲刺","风","空气","几乎","嘘","速度","烟","吹","wind","air","fast","shoo","fart","smoke","puff"],k:[25,50],o:2},artist:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F3A8",non_qualified:null,image:"1f9d1-1f3fb-200d-1f3a8.png",sheet_x:45,sheet_y:42,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F3A8",non_qualified:null,image:"1f9d1-1f3fc-200d-1f3a8.png",sheet_x:45,sheet_y:43,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F3A8",non_qualified:null,image:"1f9d1-1f3fd-200d-1f3a8.png",sheet_x:45,sheet_y:44,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F3A8",non_qualified:null,image:"1f9d1-1f3fe-200d-1f3a8.png",sheet_x:45,sheet_y:45,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F3A8",non_qualified:null,image:"1f9d1-1f3ff-200d-1f3a8.png",sheet_x:45,sheet_y:46,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Artist",b:"1F9D1-200D-1F3A8",d:!0,e:!1,f:!1,h:!1,k:[45,41],o:12,j:["艺术家"]},"flag-lc":{a:"St.LuciaFlag",b:"1F1F1-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[2,50],o:2,j:["圣卢西亚国旗"]},hole:{a:"Hole",b:"1F573-FE0F",c:"1F573",d:!0,e:!0,f:!0,h:!0,j:["洞","糗","embarrassing"],k:[29,8],o:2},"male-artist":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F3A8",non_qualified:null,image:"1f468-1f3fb-200d-1f3a8.png",sheet_x:15,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F3A8",non_qualified:null,image:"1f468-1f3fc-200d-1f3a8.png",sheet_x:15,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F3A8",non_qualified:null,image:"1f468-1f3fd-200d-1f3a8.png",sheet_x:15,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F3A8",non_qualified:null,image:"1f468-1f3fe-200d-1f3a8.png",sheet_x:15,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F3A8",non_qualified:null,image:"1f468-1f3ff-200d-1f3a8.png",sheet_x:15,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleArtist",b:"1F468-200D-1F3A8",d:!0,e:!0,f:!0,h:!0,k:[15,5],o:4,j:["男艺术家"]},clock1:{a:"ClockFaceOneOclock",b:"1F550",d:!0,e:!0,f:!0,h:!0,j:["一点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,39],o:2},eight:{a:"Keycap8",b:"0038-FE0F-20E3",c:"0038-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮8","8","蓝色方块","数字","8","blue-square","numbers"],k:[0,10],o:0},mailbox_with_no_mail:{a:"OpenMailboxwithLoweredFlag",b:"1F4ED",d:!0,e:!0,f:!0,h:!0,j:["邮箱开启（具有向下的标志）","电子邮件","收件箱","email","inbox"],k:[27,10],o:2},"flag-li":{a:"LiechtensteinFlag",b:"1F1F1-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[2,51],o:2,j:["列支敦士登国旗"]},bomb:{a:"Bomb",b:"1F4A3",d:!0,e:!0,f:!0,h:!0,j:["炸弹","繁荣","爆炸","爆炸","恐怖主义","boom","explode","explosion","terrorism"],k:[25,45],o:2},nine:{a:"Keycap9",b:"0039-FE0F-20E3",c:"0039-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮9","蓝色方块","数字","9","blue-square","numbers","9"],k:[0,11],o:0},postbox:{a:"Postbox",b:"1F4EE",d:!0,e:!0,f:!0,h:!0,j:["邮箱","电子邮件","信","信封","email","letter","envelope"],k:[27,11],o:2},"female-artist":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F3A8",non_qualified:null,image:"1f469-1f3fb-200d-1f3a8.png",sheet_x:17,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F3A8",non_qualified:null,image:"1f469-1f3fc-200d-1f3a8.png",sheet_x:17,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F3A8",non_qualified:null,image:"1f469-1f3fd-200d-1f3a8.png",sheet_x:17,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F3A8",non_qualified:null,image:"1f469-1f3fe-200d-1f3a8.png",sheet_x:17,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F3A8",non_qualified:null,image:"1f469-1f3ff-200d-1f3a8.png",sheet_x:18,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleArtist",b:"1F469-200D-1F3A8",d:!0,e:!0,f:!0,h:!0,k:[17,52],o:4,j:["女艺术家"]},clock130:{a:"ClockFaceOne-Thirty",b:"1F55C",d:!0,e:!0,f:!0,h:!0,j:["一点半","时间","晚","早","附表","time","late","early","schedule"],k:[28,51],o:2},"flag-lk":{a:"SriLankaFlag",b:"1F1F1-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[2,52],o:2,j:["斯里兰卡国旗"]},ballot_box_with_ballot:{a:"BallotBoxwithBallot",b:"1F5F3-FE0F",c:"1F5F3",d:!0,e:!0,f:!0,h:!0,k:[30,28],o:2,j:["投票箱与选票"]},pilot:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-2708-FE0F",non_qualified:"1F9D1-1F3FB-200D-2708",image:"1f9d1-1f3fb-200d-2708-fe0f.png",sheet_x:48,sheet_y:5,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-2708-FE0F",non_qualified:"1F9D1-1F3FC-200D-2708",image:"1f9d1-1f3fc-200d-2708-fe0f.png",sheet_x:48,sheet_y:6,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-2708-FE0F",non_qualified:"1F9D1-1F3FD-200D-2708",image:"1f9d1-1f3fd-200d-2708-fe0f.png",sheet_x:48,sheet_y:7,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-2708-FE0F",non_qualified:"1F9D1-1F3FE-200D-2708",image:"1f9d1-1f3fe-200d-2708-fe0f.png",sheet_x:48,sheet_y:8,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-2708-FE0F",non_qualified:"1F9D1-1F3FF-200D-2708",image:"1f9d1-1f3ff-200d-2708-fe0f.png",sheet_x:48,sheet_y:9,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Pilot",b:"1F9D1-200D-2708-FE0F",c:"1F9D1-200D-2708",d:!0,e:!1,f:!1,h:!1,k:[48,4],o:12,j:["飞行员"]},keycap_ten:{a:"KeycapTen",b:"1F51F",d:!0,e:!0,f:!0,h:!0,j:["按钮10","数字","10","蓝色方块","numbers","10","blue-square"],k:[28,2],o:2},clock2:{a:"ClockFaceTwoOclock",b:"1F551",d:!0,e:!0,f:!0,h:!0,j:["两点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,40],o:2},"flag-lr":{a:"LiberiaFlag",b:"1F1F1-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[2,53],o:2,j:["利比里亚国旗"]},speech_balloon:{a:"SpeechBalloon",b:"1F4AC",d:!0,e:!0,f:!0,h:!0,j:["谈话气球","泡沫","的话","消息","说话","聊天","bubble","words","message","talk","chatting"],k:[26,2],o:2},"eye-in-speech-bubble":{a:"EyeinSpeechBubble",b:"1F441-FE0F-200D-1F5E8-FE0F",d:!0,e:!0,f:!1,h:!1,k:[12,37],o:2,j:["带有眼睛的气泡框"]},"flag-ls":{a:"LesothoFlag",b:"1F1F1-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[2,54],o:2,j:["莱索托国旗"]},clock230:{a:"ClockFaceTwo-Thirty",b:"1F55D",d:!0,e:!0,f:!0,h:!0,j:["两点半","时间","晚","早","附表","time","late","early","schedule"],k:[28,52],o:2},"male-pilot":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-2708-FE0F",non_qualified:"1F468-1F3FB-200D-2708",image:"1f468-1f3fb-200d-2708-fe0f.png",sheet_x:17,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-2708-FE0F",non_qualified:"1F468-1F3FC-200D-2708",image:"1f468-1f3fc-200d-2708-fe0f.png",sheet_x:17,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-2708-FE0F",non_qualified:"1F468-1F3FD-200D-2708",image:"1f468-1f3fd-200d-2708-fe0f.png",sheet_x:17,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-2708-FE0F",non_qualified:"1F468-1F3FE-200D-2708",image:"1f468-1f3fe-200d-2708-fe0f.png",sheet_x:17,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-2708-FE0F",non_qualified:"1F468-1F3FF-200D-2708",image:"1f468-1f3ff-200d-2708-fe0f.png",sheet_x:17,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MalePilot",b:"1F468-200D-2708-FE0F",c:"1F468-200D-2708",d:!0,e:!0,f:!0,h:!0,k:[17,14],o:4,j:["男飞行员"]},capital_abcd:{a:"InputSymbolforLatinCapitalLetters",b:"1F520",d:!0,e:!0,f:!0,h:!0,j:["输入大写拉丁字母","字母","的话","蓝色方块","alphabet","words","blue-square"],k:[28,3],o:2},pencil2:{a:"Pencil",b:"270F-FE0F",c:"270F",d:!0,e:!0,f:!0,h:!0,j:["铅笔","文具","写","纸","写作","学校","研究","stationery","write","paper","writing","school","study"],k:[55,10],o:2},"female-pilot":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-2708-FE0F",non_qualified:"1F469-1F3FB-200D-2708",image:"1f469-1f3fb-200d-2708-fe0f.png",sheet_x:20,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-2708-FE0F",non_qualified:"1F469-1F3FC-200D-2708",image:"1f469-1f3fc-200d-2708-fe0f.png",sheet_x:20,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-2708-FE0F",non_qualified:"1F469-1F3FD-200D-2708",image:"1f469-1f3fd-200d-2708-fe0f.png",sheet_x:20,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-2708-FE0F",non_qualified:"1F469-1F3FE-200D-2708",image:"1f469-1f3fe-200d-2708-fe0f.png",sheet_x:20,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-2708-FE0F",non_qualified:"1F469-1F3FF-200D-2708",image:"1f469-1f3ff-200d-2708-fe0f.png",sheet_x:20,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemalePilot",b:"1F469-200D-2708-FE0F",c:"1F469-200D-2708",d:!0,e:!0,f:!0,h:!0,k:[19,56],o:4,j:["女飞行员"]},black_nib:{a:"BlackNib",b:"2712-FE0F",c:"2712",d:!0,e:!0,f:!0,h:!0,j:["黑色的笔尖","笔","文具","写作","写","pen","stationery","writing","write"],k:[55,11],o:2},left_speech_bubble:{a:"LeftSpeechBubble",b:"1F5E8-FE0F",c:"1F5E8",d:!0,e:!0,f:!0,h:!0,j:["左讲话气泡","的话","消息","说话","聊天","words","message","talk","chatting"],k:[30,26],o:2},clock3:{a:"ClockFaceThreeOclock",b:"1F552",d:!0,e:!0,f:!0,h:!0,j:["三点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,41],o:2},abcd:{a:"InputSymbolforLatinSmallLetters",b:"1F521",d:!0,e:!0,f:!0,h:!0,j:["输入小写拉丁字母","蓝色方块","字母","blue-square","alphabet"],k:[28,4],o:2},"flag-lt":{a:"LithuaniaFlag",b:"1F1F1-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[2,55],o:2,j:["立陶宛国旗"]},clock330:{a:"ClockFaceThree-Thirty",b:"1F55E",d:!0,e:!0,f:!0,h:!0,j:["三点半","时间","晚","早","附表","time","late","early","schedule"],k:[28,53],o:2},astronaut:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F680",non_qualified:null,image:"1f9d1-1f3fb-200d-1f680.png",sheet_x:46,sheet_y:27,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F680",non_qualified:null,image:"1f9d1-1f3fc-200d-1f680.png",sheet_x:46,sheet_y:28,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F680",non_qualified:null,image:"1f9d1-1f3fd-200d-1f680.png",sheet_x:46,sheet_y:29,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F680",non_qualified:null,image:"1f9d1-1f3fe-200d-1f680.png",sheet_x:46,sheet_y:30,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F680",non_qualified:null,image:"1f9d1-1f3ff-200d-1f680.png",sheet_x:46,sheet_y:31,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Astronaut",b:"1F9D1-200D-1F680",d:!0,e:!1,f:!1,h:!1,k:[46,26],o:12,j:["宇航员"]},"flag-lu":{a:"LuxembourgFlag",b:"1F1F1-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[2,56],o:2,j:["卢森堡国旗"]},right_anger_bubble:{a:"RightAngerBubble",b:"1F5EF-FE0F",c:"1F5EF",d:!0,e:!0,f:!0,h:!0,j:["右愤怒气泡","标题","演讲","思维","狂","caption","speech","thinking","mad"],k:[30,27],o:2},lower_left_fountain_pen:{a:"LowerLeftFountainPen",b:"1F58B-FE0F",c:"1F58B",d:!0,e:!0,f:!0,h:!0,k:[29,45],o:2,j:["钢笔"]},"male-astronaut":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F680",non_qualified:null,image:"1f468-1f3fb-200d-1f680.png",sheet_x:16,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F680",non_qualified:null,image:"1f468-1f3fc-200d-1f680.png",sheet_x:16,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F680",non_qualified:null,image:"1f468-1f3fd-200d-1f680.png",sheet_x:16,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F680",non_qualified:null,image:"1f468-1f3fe-200d-1f680.png",sheet_x:16,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F680",non_qualified:null,image:"1f468-1f3ff-200d-1f680.png",sheet_x:16,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleAstronaut",b:"1F468-200D-1F680",d:!0,e:!0,f:!0,h:!0,k:[16,5],o:4,j:["男航天员"]},thought_balloon:{a:"ThoughtBalloon",b:"1F4AD",d:!0,e:!0,f:!0,h:!0,j:["思考气泡","泡沫","云","演讲","思维","梦","bubble","cloud","speech","thinking","dream"],k:[26,3],o:2},symbols:{a:"InputSymbolforSymbols",b:"1F523",d:!0,e:!0,f:!0,h:!0,j:["输入符号","蓝色方块","音乐","注意","符号","百分之","符号","字符","blue-square","music","note","ampersand","percent","glyphs","characters"],k:[28,6],o:2},clock4:{a:"ClockFaceFourOclock",b:"1F553",d:!0,e:!0,f:!0,h:!0,j:["四点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,42],o:2},"flag-lv":{a:"LatviaFlag",b:"1F1F1-1F1FB",d:!0,e:!0,f:!0,h:!0,k:[3,0],o:2,j:["拉脱维亚国旗"]},lower_left_ballpoint_pen:{a:"LowerLeftBallpointPen",b:"1F58A-FE0F",c:"1F58A",d:!0,e:!0,f:!0,h:!0,k:[29,44],o:2,j:["笔"]},abc:{a:"InputSymbolforLatinLetters",b:"1F524",d:!0,e:!0,f:!0,h:!0,j:["输入拉丁字母","蓝色方块","字母","blue-square","alphabet"],k:[28,7],o:2},zzz:{a:"SleepingSymbol",b:"1F4A4",d:!0,e:!0,f:!0,h:!0,j:["ZZZ","困","累","梦","sleepy","tired","dream"],k:[25,46],o:2},lower_left_paintbrush:{a:"LowerLeftPaintbrush",b:"1F58C-FE0F",c:"1F58C",d:!0,e:!0,f:!0,h:!0,k:[29,46],o:2,j:["画笔"]},"female-astronaut":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F680",non_qualified:null,image:"1f469-1f3fb-200d-1f680.png",sheet_x:18,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F680",non_qualified:null,image:"1f469-1f3fc-200d-1f680.png",sheet_x:18,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F680",non_qualified:null,image:"1f469-1f3fd-200d-1f680.png",sheet_x:18,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F680",non_qualified:null,image:"1f469-1f3fe-200d-1f680.png",sheet_x:18,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F680",non_qualified:null,image:"1f469-1f3ff-200d-1f680.png",sheet_x:18,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleAstronaut",b:"1F469-200D-1F680",d:!0,e:!0,f:!0,h:!0,k:[18,47],o:4,j:["女航天员"]},"flag-ly":{a:"LibyaFlag",b:"1F1F1-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[3,1],o:2,j:["利比亚国旗"]},clock430:{a:"ClockFaceFour-Thirty",b:"1F55F",d:!0,e:!0,f:!0,h:!0,j:["四点半","时间","晚","早","附表","time","late","early","schedule"],k:[28,54],o:2},"flag-ma":{a:"MoroccoFlag",b:"1F1F2-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[3,2],o:2,j:["摩洛哥国旗"]},a:{a:"NegativeSquaredLatinCapitalLettera",b:"1F170-FE0F",c:"1F170",d:!0,e:!0,f:!0,h:!0,j:["A符号符号","红方块","字母","信","red-square","alphabet","letter"],k:[0,16],o:2},clock5:{a:"ClockFaceFiveOclock",b:"1F554",d:!0,e:!0,f:!0,h:!0,j:["五点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,43],o:2},lower_left_crayon:{a:"LowerLeftCrayon",b:"1F58D-FE0F",c:"1F58D",d:!0,e:!0,f:!0,h:!0,k:[29,47],o:2,j:["蜡笔"]},firefighter:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F692",non_qualified:null,image:"1f9d1-1f3fb-200d-1f692.png",sheet_x:46,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F692",non_qualified:null,image:"1f9d1-1f3fc-200d-1f692.png",sheet_x:46,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F692",non_qualified:null,image:"1f9d1-1f3fd-200d-1f692.png",sheet_x:46,sheet_y:35,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F692",non_qualified:null,image:"1f9d1-1f3fe-200d-1f692.png",sheet_x:46,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F692",non_qualified:null,image:"1f9d1-1f3ff-200d-1f692.png",sheet_x:46,sheet_y:37,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Firefighter",b:"1F9D1-200D-1F692",d:!0,e:!1,f:!1,h:!1,k:[46,32],o:12,j:["消防员"]},"male-firefighter":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F692",non_qualified:null,image:"1f468-1f3fb-200d-1f692.png",sheet_x:16,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F692",non_qualified:null,image:"1f468-1f3fc-200d-1f692.png",sheet_x:16,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F692",non_qualified:null,image:"1f468-1f3fd-200d-1f692.png",sheet_x:16,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F692",non_qualified:null,image:"1f468-1f3fe-200d-1f692.png",sheet_x:16,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F692",non_qualified:null,image:"1f468-1f3ff-200d-1f692.png",sheet_x:16,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleFirefighter",b:"1F468-200D-1F692",d:!0,e:!0,f:!0,h:!0,k:[16,11],o:4,j:["男性消防员"]},memo:{a:"Memo",b:"1F4DD",d:!0,e:!0,f:!0,h:!0,j:["备忘录","写","文件","文具","铅笔","纸","写作","法律","考试","测验","测试","研究","组成","write","documents","stationery","pencil","paper","writing","legal","exam","quiz","test","study","compose"],k:[26,51],n:["pencil"],o:2},ab:{a:"NegativeSquaredAb",b:"1F18E",d:!0,e:!0,f:!0,h:!0,j:["AB符号符号","红方块","字母","red-square","alphabet"],k:[0,20],o:2},"flag-mc":{a:"MonacoFlag",b:"1F1F2-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[3,3],o:2,j:["摩纳哥国旗"]},clock530:{a:"ClockFaceFive-Thirty",b:"1F560",d:!0,e:!0,f:!0,h:!0,j:["五点半","时间","晚","早","附表","time","late","early","schedule"],k:[28,55],o:2},briefcase:{a:"Briefcase",b:"1F4BC",d:!0,e:!0,f:!0,h:!0,j:["公文包","商","文件","工作","法律","法律","工作","生涯","business","documents","work","law","legal","job","career"],k:[26,18],o:2},"female-firefighter":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F692",non_qualified:null,image:"1f469-1f3fb-200d-1f692.png",sheet_x:18,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F692",non_qualified:null,image:"1f469-1f3fc-200d-1f692.png",sheet_x:18,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F692",non_qualified:null,image:"1f469-1f3fd-200d-1f692.png",sheet_x:18,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F692",non_qualified:null,image:"1f469-1f3fe-200d-1f692.png",sheet_x:19,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F692",non_qualified:null,image:"1f469-1f3ff-200d-1f692.png",sheet_x:19,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleFirefighter",b:"1F469-200D-1F692",d:!0,e:!0,f:!0,h:!0,k:[18,53],o:4,j:["女消防员"]},clock6:{a:"ClockFaceSixOclock",b:"1F555",d:!0,e:!0,f:!0,h:!0,j:["六点钟","时间","晚","早","附表","黎明","黄昏","time","late","early","schedule","dawn","dusk"],k:[28,44],o:2},b:{a:"NegativeSquaredLatinCapitalLetterB",b:"1F171-FE0F",c:"1F171",d:!0,e:!0,f:!0,h:!0,j:["B符号","红方块","字母","信","red-square","alphabet","letter"],k:[0,17],o:2},"flag-md":{a:"MoldovaFlag",b:"1F1F2-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[3,4],o:2,j:["摩尔多瓦国旗"]},clock630:{a:"ClockFaceSix-Thirty",b:"1F561",d:!0,e:!0,f:!0,h:!0,j:["六点半","时间","晚","早","附表","time","late","early","schedule"],k:[28,56],o:2},cl:{a:"SquaredCl",b:"1F191",d:!0,e:!0,f:!0,h:!0,j:["CL符号","字母","的话","红方块","alphabet","words","red-square"],k:[0,21],o:2},"flag-me":{a:"MontenegroFlag",b:"1F1F2-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[3,5],o:2,j:["黑山国旗"]},file_folder:{a:"FileFolder",b:"1F4C1",d:!0,e:!0,f:!0,h:!0,j:["文件夹","文件","商","办公室","documents","business","office"],k:[26,23],o:2},cop:{skin_variations:{"1F3FB":{unified:"1F46E-1F3FB",non_qualified:null,image:"1f46e-1f3fb.png",sheet_x:21,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F46E-1F3FC",non_qualified:null,image:"1f46e-1f3fc.png",sheet_x:21,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F46E-1F3FD",non_qualified:null,image:"1f46e-1f3fd.png",sheet_x:21,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F46E-1F3FE",non_qualified:null,image:"1f46e-1f3fe.png",sheet_x:21,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F46E-1F3FF",non_qualified:null,image:"1f46e-1f3ff.png",sheet_x:21,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F46E-200D-2642-FE0F",a:"PoliceOfficer",b:"1F46E",d:!0,e:!0,f:!0,h:!1,k:[21,49],o:2,j:["警官"]},"male-police-officer":{skin_variations:{"1F3FB":{unified:"1F46E-1F3FB-200D-2642-FE0F",non_qualified:"1F46E-1F3FB-200D-2642",image:"1f46e-1f3fb-200d-2642-fe0f.png",sheet_x:21,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F46E-1F3FC-200D-2642-FE0F",non_qualified:"1F46E-1F3FC-200D-2642",image:"1f46e-1f3fc-200d-2642-fe0f.png",sheet_x:21,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F46E-1F3FD-200D-2642-FE0F",non_qualified:"1F46E-1F3FD-200D-2642",image:"1f46e-1f3fd-200d-2642-fe0f.png",sheet_x:21,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F46E-1F3FE-200D-2642-FE0F",non_qualified:"1F46E-1F3FE-200D-2642",image:"1f46e-1f3fe-200d-2642-fe0f.png",sheet_x:21,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F46E-1F3FF-200D-2642-FE0F",non_qualified:"1F46E-1F3FF-200D-2642",image:"1f46e-1f3ff-200d-2642-fe0f.png",sheet_x:21,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F46E",a:"MalePoliceOfficer",b:"1F46E-200D-2642-FE0F",c:"1F46E-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[21,43],o:4,j:["男警官"]},cool:{a:"SquaredCool",b:"1F192",d:!0,e:!0,f:!0,h:!0,j:["COOL符号","的话","蓝色方块","words","blue-square"],k:[0,22],o:2},clock7:{a:"ClockFaceSevenOclock",b:"1F556",d:!0,e:!0,f:!0,h:!0,j:["七点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,45],o:2},"flag-mf":{a:"St.MartinFlag",b:"1F1F2-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[3,6],o:2,j:["圣马丁国旗"]},open_file_folder:{a:"OpenFileFolder",b:"1F4C2",d:!0,e:!0,f:!0,h:!0,j:["开启的文件夹","文件","负荷","documents","load"],k:[26,24],o:2},card_index_dividers:{a:"CardIndexDividers",b:"1F5C2-FE0F",c:"1F5C2",d:!0,e:!0,f:!0,h:!0,j:["索引分隔卡","组织","商","文具","organizing","business","stationery"],k:[30,15],o:2},"flag-mg":{a:"MadagascarFlag",b:"1F1F2-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[3,7],o:2,j:["马达加斯加国旗"]},free:{a:"SquaredFree",b:"1F193",d:!0,e:!0,f:!0,h:!0,j:["免费符号","蓝色方块","的话","blue-square","words"],k:[0,23],o:2},"female-police-officer":{skin_variations:{"1F3FB":{unified:"1F46E-1F3FB-200D-2640-FE0F",non_qualified:"1F46E-1F3FB-200D-2640",image:"1f46e-1f3fb-200d-2640-fe0f.png",sheet_x:21,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F46E-1F3FC-200D-2640-FE0F",non_qualified:"1F46E-1F3FC-200D-2640",image:"1f46e-1f3fc-200d-2640-fe0f.png",sheet_x:21,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F46E-1F3FD-200D-2640-FE0F",non_qualified:"1F46E-1F3FD-200D-2640",image:"1f46e-1f3fd-200d-2640-fe0f.png",sheet_x:21,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F46E-1F3FE-200D-2640-FE0F",non_qualified:"1F46E-1F3FE-200D-2640",image:"1f46e-1f3fe-200d-2640-fe0f.png",sheet_x:21,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F46E-1F3FF-200D-2640-FE0F",non_qualified:"1F46E-1F3FF-200D-2640",image:"1f46e-1f3ff-200d-2640-fe0f.png",sheet_x:21,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemalePoliceOfficer",b:"1F46E-200D-2640-FE0F",c:"1F46E-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[21,37],o:4,j:["女警官"]},clock730:{a:"ClockFaceSeven-Thirty",b:"1F562",d:!0,e:!0,f:!0,h:!0,j:["七点半","时间","晚","早","附表","time","late","early","schedule"],k:[29,0],o:2},date:{a:"Calendar",b:"1F4C5",d:!0,e:!0,f:!0,h:!0,j:["日历","日历","附表","calendar","schedule"],k:[26,27],o:2},clock8:{a:"ClockFaceEightOclock",b:"1F557",d:!0,e:!0,f:!0,h:!0,j:["八点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,46],o:2},information_source:{a:"InformationSource",b:"2139-FE0F",c:"2139",d:!0,e:!0,f:!0,h:!0,j:["信息标识","蓝色方块","字母","信","blue-square","alphabet","letter"],k:[52,13],o:2},sleuth_or_spy:{skin_variations:{"1F3FB":{unified:"1F575-1F3FB",non_qualified:null,image:"1f575-1f3fb.png",sheet_x:29,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F575-1F3FC",non_qualified:null,image:"1f575-1f3fc.png",sheet_x:29,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F575-1F3FD",non_qualified:null,image:"1f575-1f3fd.png",sheet_x:29,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F575-1F3FE",non_qualified:null,image:"1f575-1f3fe.png",sheet_x:29,sheet_y:31,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F575-1F3FF",non_qualified:null,image:"1f575-1f3ff.png",sheet_x:29,sheet_y:32,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F575-FE0F-200D-2642-FE0F",a:"SleuthorSpy",b:"1F575-FE0F",c:"1F575",d:!0,e:!0,f:!0,h:!1,k:[29,27],o:2,j:["侦探"]},"flag-mh":{a:"MarshallIslandsFlag",b:"1F1F2-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[3,8],o:2,j:["马绍尔群岛旗"]},clock830:{a:"ClockFaceEight-Thirty",b:"1F563",d:!0,e:!0,f:!0,h:!0,j:["八点半","时间","晚","早","附表","time","late","early","schedule"],k:[29,1],o:2},calendar:{a:"Tear-offCalendar",b:"1F4C6",d:!0,e:!0,f:!0,h:!0,j:["撕下日历","附表","日期","规划","schedule","date","planning"],k:[26,28],o:2},"male-detective":{skin_variations:{"1F3FB":{unified:"1F575-1F3FB-200D-2642-FE0F",non_qualified:"1F575-1F3FB-200D-2642",image:"1f575-1f3fb-200d-2642-fe0f.png",sheet_x:29,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F575-1F3FC-200D-2642-FE0F",non_qualified:"1F575-1F3FC-200D-2642",image:"1f575-1f3fc-200d-2642-fe0f.png",sheet_x:29,sheet_y:23,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F575-1F3FD-200D-2642-FE0F",non_qualified:"1F575-1F3FD-200D-2642",image:"1f575-1f3fd-200d-2642-fe0f.png",sheet_x:29,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F575-1F3FE-200D-2642-FE0F",non_qualified:"1F575-1F3FE-200D-2642",image:"1f575-1f3fe-200d-2642-fe0f.png",sheet_x:29,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F575-1F3FF-200D-2642-FE0F",non_qualified:"1F575-1F3FF-200D-2642",image:"1f575-1f3ff-200d-2642-fe0f.png",sheet_x:29,sheet_y:26,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F575-FE0F",a:"MaleDetective",b:"1F575-FE0F-200D-2642-FE0F",d:!0,e:!0,f:!0,h:!1,k:[29,21],o:4,j:["男侦探"]},"flag-mk":{a:"NorthMacedoniaFlag",b:"1F1F2-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[3,9],o:2,j:["马其顿国旗"]},id:{a:"SquaredId",b:"1F194",d:!0,e:!0,f:!0,h:!0,j:["ID符号","紫色方块","的话","purple-square","words"],k:[0,24],o:2},spiral_note_pad:{a:"SpiralNotePad",b:"1F5D2-FE0F",c:"1F5D2",d:!0,e:!0,f:!0,h:!0,k:[30,19],o:2,j:["线圈记事本"]},"female-detective":{skin_variations:{"1F3FB":{unified:"1F575-1F3FB-200D-2640-FE0F",non_qualified:"1F575-1F3FB-200D-2640",image:"1f575-1f3fb-200d-2640-fe0f.png",sheet_x:29,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F575-1F3FC-200D-2640-FE0F",non_qualified:"1F575-1F3FC-200D-2640",image:"1f575-1f3fc-200d-2640-fe0f.png",sheet_x:29,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F575-1F3FD-200D-2640-FE0F",non_qualified:"1F575-1F3FD-200D-2640",image:"1f575-1f3fd-200d-2640-fe0f.png",sheet_x:29,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F575-1F3FE-200D-2640-FE0F",non_qualified:"1F575-1F3FE-200D-2640",image:"1f575-1f3fe-200d-2640-fe0f.png",sheet_x:29,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F575-1F3FF-200D-2640-FE0F",non_qualified:"1F575-1F3FF-200D-2640",image:"1f575-1f3ff-200d-2640-fe0f.png",sheet_x:29,sheet_y:20,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleDetective",b:"1F575-FE0F-200D-2640-FE0F",d:!0,e:!0,f:!0,h:!1,k:[29,15],o:4,j:["女侦探"]},clock9:{a:"ClockFaceNineOclock",b:"1F558",d:!0,e:!0,f:!0,h:!0,j:["九点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,47],o:2},"flag-ml":{a:"MaliFlag",b:"1F1F2-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[3,10],o:2,j:["马里国旗"]},m:{a:"CircledLatinCapitalLetterM",b:"24C2-FE0F",c:"24C2",d:!0,e:!0,f:!0,h:!0,j:["地铁车站","字母","蓝圈","信","alphabet","blue-circle","letter"],k:[52,40],o:2},"flag-mm":{a:"Myanmar(burma)Flag",b:"1F1F2-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[3,11],o:2,j:["缅甸国旗"]},clock930:{a:"ClockFaceNine-Thirty",b:"1F564",d:!0,e:!0,f:!0,h:!0,j:["九点半","时间","晚","早","附表","time","late","early","schedule"],k:[29,2],o:2},guardsman:{skin_variations:{"1F3FB":{unified:"1F482-1F3FB",non_qualified:null,image:"1f482-1f3fb.png",sheet_x:24,sheet_y:21,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F482-1F3FC",non_qualified:null,image:"1f482-1f3fc.png",sheet_x:24,sheet_y:22,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F482-1F3FD",non_qualified:null,image:"1f482-1f3fd.png",sheet_x:24,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F482-1F3FE",non_qualified:null,image:"1f482-1f3fe.png",sheet_x:24,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F482-1F3FF",non_qualified:null,image:"1f482-1f3ff.png",sheet_x:24,sheet_y:25,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F482-200D-2642-FE0F",a:"Guardsman",b:"1F482",d:!0,e:!0,f:!0,h:!1,j:["警卫","英国","千兆克","英国的","雄","家伙","皇家","uk","gb","british","male","guy","royal"],k:[24,20],o:2},new:{a:"SquaredNew",b:"1F195",d:!0,e:!0,f:!0,h:!0,j:["全新符号","蓝色方块","的话","开始","blue-square","words","start"],k:[0,25],o:2},spiral_calendar_pad:{a:"SpiralCalendarPad",b:"1F5D3-FE0F",c:"1F5D3",d:!0,e:!0,f:!0,h:!0,k:[30,20],o:2,j:["线圈月历"]},ng:{a:"SquaredNg",b:"1F196",d:!0,e:!0,f:!0,h:!0,j:["NG符号","蓝色方块","的话","形状","图标","blue-square","words","shape","icon"],k:[0,26],o:2},card_index:{a:"CardIndex",b:"1F4C7",d:!0,e:!0,f:!0,h:!0,j:["卡片索引","商","文具","business","stationery"],k:[26,29],o:2},clock10:{a:"ClockFaceTenOclock",b:"1F559",d:!0,e:!0,f:!0,h:!0,j:["十点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,48],o:2},"flag-mn":{a:"MongoliaFlag",b:"1F1F2-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[3,12],o:2,j:["蒙古国旗"]},"male-guard":{skin_variations:{"1F3FB":{unified:"1F482-1F3FB-200D-2642-FE0F",non_qualified:"1F482-1F3FB-200D-2642",image:"1f482-1f3fb-200d-2642-fe0f.png",sheet_x:24,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F482-1F3FC-200D-2642-FE0F",non_qualified:"1F482-1F3FC-200D-2642",image:"1f482-1f3fc-200d-2642-fe0f.png",sheet_x:24,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F482-1F3FD-200D-2642-FE0F",non_qualified:"1F482-1F3FD-200D-2642",image:"1f482-1f3fd-200d-2642-fe0f.png",sheet_x:24,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F482-1F3FE-200D-2642-FE0F",non_qualified:"1F482-1F3FE-200D-2642",image:"1f482-1f3fe-200d-2642-fe0f.png",sheet_x:24,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F482-1F3FF-200D-2642-FE0F",non_qualified:"1F482-1F3FF-200D-2642",image:"1f482-1f3ff-200d-2642-fe0f.png",sheet_x:24,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F482",a:"MaleGuard",b:"1F482-200D-2642-FE0F",c:"1F482-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[24,14],o:4,j:["男警卫"]},"flag-mo":{a:"MacaoSarChinaFlag",b:"1F1F2-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[3,13],o:2,j:["澳门特别行政区旗"]},clock1030:{a:"ClockFaceTen-Thirty",b:"1F565",d:!0,e:!0,f:!0,h:!0,j:["十点半","时间","晚","早","附表","time","late","early","schedule"],k:[29,3],o:2},chart_with_upwards_trend:{a:"ChartwithUpwardsTrend",b:"1F4C8",d:!0,e:!0,f:!0,h:!0,j:["图表向上","图","介绍","统计","恢复","商","经济学","钱","销售","好","成功","graph","presentation","stats","recovery","business","economics","money","sales","good","success"],k:[26,30],o:2},o2:{a:"NegativeSquaredLatinCapitalLetterO",b:"1F17E-FE0F",c:"1F17E",d:!0,e:!0,f:!0,h:!0,j:["O符号","字母","红方块","信","alphabet","red-square","letter"],k:[0,18],o:2},"female-guard":{skin_variations:{"1F3FB":{unified:"1F482-1F3FB-200D-2640-FE0F",non_qualified:"1F482-1F3FB-200D-2640",image:"1f482-1f3fb-200d-2640-fe0f.png",sheet_x:24,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F482-1F3FC-200D-2640-FE0F",non_qualified:"1F482-1F3FC-200D-2640",image:"1f482-1f3fc-200d-2640-fe0f.png",sheet_x:24,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F482-1F3FD-200D-2640-FE0F",non_qualified:"1F482-1F3FD-200D-2640",image:"1f482-1f3fd-200d-2640-fe0f.png",sheet_x:24,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F482-1F3FE-200D-2640-FE0F",non_qualified:"1F482-1F3FE-200D-2640",image:"1f482-1f3fe-200d-2640-fe0f.png",sheet_x:24,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F482-1F3FF-200D-2640-FE0F",non_qualified:"1F482-1F3FF-200D-2640",image:"1f482-1f3ff-200d-2640-fe0f.png",sheet_x:24,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleGuard",b:"1F482-200D-2640-FE0F",c:"1F482-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[24,8],o:4,j:["女警卫"]},chart_with_downwards_trend:{a:"ChartwithDownwardsTrend",b:"1F4C9",d:!0,e:!0,f:!0,h:!0,j:["图表向下","图","介绍","统计","衰退","商","经济学","钱","销售","坏","失败","graph","presentation","stats","recession","business","economics","money","sales","bad","failure"],k:[26,31],o:2},"flag-mp":{a:"NorthernMarianaIslandsFlag",b:"1F1F2-1F1F5",d:!0,e:!0,f:!0,h:!0,k:[3,14],o:2,j:["北马里亚纳群岛旗"]},ok:{a:"SquaredOk",b:"1F197",d:!0,e:!0,f:!0,h:!0,j:["OK符号","好","同意","是的","蓝色方块","good","agree","yes","blue-square"],k:[0,27],o:2},clock11:{a:"ClockFaceElevenOclock",b:"1F55A",d:!0,e:!0,f:!0,h:!0,j:["十一点点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,49],o:2},construction_worker:{skin_variations:{"1F3FB":{unified:"1F477-1F3FB",non_qualified:null,image:"1f477-1f3fb.png",sheet_x:23,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F477-1F3FC",non_qualified:null,image:"1f477-1f3fc.png",sheet_x:23,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F477-1F3FD",non_qualified:null,image:"1f477-1f3fd.png",sheet_x:23,sheet_y:25,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F477-1F3FE",non_qualified:null,image:"1f477-1f3fe.png",sheet_x:23,sheet_y:26,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F477-1F3FF",non_qualified:null,image:"1f477-1f3ff.png",sheet_x:23,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F477-200D-2642-FE0F",a:"ConstructionWorker",b:"1F477",d:!0,e:!0,f:!0,h:!1,k:[23,22],o:2,j:["建筑工人"]},"male-construction-worker":{skin_variations:{"1F3FB":{unified:"1F477-1F3FB-200D-2642-FE0F",non_qualified:"1F477-1F3FB-200D-2642",image:"1f477-1f3fb-200d-2642-fe0f.png",sheet_x:23,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F477-1F3FC-200D-2642-FE0F",non_qualified:"1F477-1F3FC-200D-2642",image:"1f477-1f3fc-200d-2642-fe0f.png",sheet_x:23,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F477-1F3FD-200D-2642-FE0F",non_qualified:"1F477-1F3FD-200D-2642",image:"1f477-1f3fd-200d-2642-fe0f.png",sheet_x:23,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F477-1F3FE-200D-2642-FE0F",non_qualified:"1F477-1F3FE-200D-2642",image:"1f477-1f3fe-200d-2642-fe0f.png",sheet_x:23,sheet_y:20,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F477-1F3FF-200D-2642-FE0F",non_qualified:"1F477-1F3FF-200D-2642",image:"1f477-1f3ff-200d-2642-fe0f.png",sheet_x:23,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F477",a:"MaleConstructionWorker",b:"1F477-200D-2642-FE0F",c:"1F477-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[23,16],o:4,j:["男性建筑工人"]},clock1130:{a:"ClockFaceEleven-Thirty",b:"1F566",d:!0,e:!0,f:!0,h:!0,j:["十一点半","时间","晚","早","附表","time","late","early","schedule"],k:[29,4],o:2},"flag-mq":{a:"MartiniqueFlag",b:"1F1F2-1F1F6",d:!0,e:!0,f:!0,h:!0,k:[3,15],o:2,j:["马提尼克国旗"]},bar_chart:{a:"BarChart",b:"1F4CA",d:!0,e:!0,f:!0,h:!0,j:["直方图","图","介绍","统计","graph","presentation","stats"],k:[26,32],o:2},parking:{a:"NegativeSquaredLatinCapitalLetterP",b:"1F17F-FE0F",c:"1F17F",d:!0,e:!0,f:!0,h:!0,j:["P符号","汽车","蓝色方块","字母","信","cars","blue-square","alphabet","letter"],k:[0,19],o:2},new_moon:{a:"NewMoonSymbol",b:"1F311",d:!0,e:!0,f:!0,h:!0,j:["新月","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,36],o:2},"female-construction-worker":{skin_variations:{"1F3FB":{unified:"1F477-1F3FB-200D-2640-FE0F",non_qualified:"1F477-1F3FB-200D-2640",image:"1f477-1f3fb-200d-2640-fe0f.png",sheet_x:23,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F477-1F3FC-200D-2640-FE0F",non_qualified:"1F477-1F3FC-200D-2640",image:"1f477-1f3fc-200d-2640-fe0f.png",sheet_x:23,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F477-1F3FD-200D-2640-FE0F",non_qualified:"1F477-1F3FD-200D-2640",image:"1f477-1f3fd-200d-2640-fe0f.png",sheet_x:23,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F477-1F3FE-200D-2640-FE0F",non_qualified:"1F477-1F3FE-200D-2640",image:"1f477-1f3fe-200d-2640-fe0f.png",sheet_x:23,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F477-1F3FF-200D-2640-FE0F",non_qualified:"1F477-1F3FF-200D-2640",image:"1f477-1f3ff-200d-2640-fe0f.png",sheet_x:23,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleConstructionWorker",b:"1F477-200D-2640-FE0F",c:"1F477-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[23,10],o:4,j:["女建筑工人"]},sos:{a:"SquaredSos",b:"1F198",d:!0,e:!0,f:!0,h:!0,j:["求救符号","帮助","红方块","的话","紧急","911","help","red-square","words","emergency","911"],k:[0,28],o:2},clipboard:{a:"Clipboard",b:"1F4CB",d:!0,e:!0,f:!0,h:!0,j:["剪贴板","文具","文件","stationery","documents"],k:[26,33],o:2},"flag-mr":{a:"MauritaniaFlag",b:"1F1F2-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[3,16],o:2,j:["毛里塔尼亚国旗"]},prince:{skin_variations:{"1F3FB":{unified:"1F934-1F3FB",non_qualified:null,image:"1f934-1f3fb.png",sheet_x:39,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F934-1F3FC",non_qualified:null,image:"1f934-1f3fc.png",sheet_x:39,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F934-1F3FD",non_qualified:null,image:"1f934-1f3fd.png",sheet_x:39,sheet_y:20,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F934-1F3FE",non_qualified:null,image:"1f934-1f3fe.png",sheet_x:39,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F934-1F3FF",non_qualified:null,image:"1f934-1f3ff.png",sheet_x:39,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Prince",b:"1F934",d:!0,e:!0,f:!0,h:!0,j:["王子","男孩","一","雄","冠","皇家","王","boy","man","male","crown","royal","king"],k:[39,17],o:4},waxing_crescent_moon:{a:"WaxingCrescentMoonSymbol",b:"1F312",d:!0,e:!0,f:!0,h:!0,j:["娥眉月","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,37],o:2},"flag-ms":{a:"MontserratFlag",b:"1F1F2-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[3,17],o:2,j:["蒙特塞拉特国旗"]},pushpin:{a:"Pushpin",b:"1F4CC",d:!0,e:!0,f:!0,h:!0,j:["图钉","文具","马克","这里","stationery","mark","here"],k:[26,34],o:2},up:{a:"SquaredUpwithExclamationMark",b:"1F199",d:!0,e:!0,f:!0,h:!0,j:["向上符号","蓝色方块","以上","高","blue-square","above","high"],k:[0,29],o:2},"flag-mt":{a:"MaltaFlag",b:"1F1F2-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[3,18],o:2,j:["马耳他国旗"]},princess:{skin_variations:{"1F3FB":{unified:"1F478-1F3FB",non_qualified:null,image:"1f478-1f3fb.png",sheet_x:23,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F478-1F3FC",non_qualified:null,image:"1f478-1f3fc.png",sheet_x:23,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F478-1F3FD",non_qualified:null,image:"1f478-1f3fd.png",sheet_x:23,sheet_y:31,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F478-1F3FE",non_qualified:null,image:"1f478-1f3fe.png",sheet_x:23,sheet_y:32,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F478-1F3FF",non_qualified:null,image:"1f478-1f3ff.png",sheet_x:23,sheet_y:33,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Princess",b:"1F478",d:!0,e:!0,f:!0,h:!0,j:["公主","女孩","女人","女性","金发","冠","皇家","女王","girl","woman","female","blond","crown","royal","queen"],k:[23,28],o:2},round_pushpin:{a:"RoundPushpin",b:"1F4CD",d:!0,e:!0,f:!0,h:!0,j:["圆图钉","文具","位置","地图","这里","stationery","location","map","here"],k:[26,35],o:2},first_quarter_moon:{a:"FirstQuarterMoonSymbol",b:"1F313",d:!0,e:!0,f:!0,h:!0,j:["上弦月","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,38],o:2},vs:{a:"SquaredVs",b:"1F19A",d:!0,e:!0,f:!0,h:!0,j:["对战符号","的话","橙色方块","words","orange-square"],k:[0,30],o:2},"flag-mu":{a:"MauritiusFlag",b:"1F1F2-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[3,19],o:2,j:["毛里求斯国旗"]},koko:{a:"SquaredKatakanaKoko",b:"1F201",d:!0,e:!0,f:!0,h:!0,j:["这里符号","蓝色方块","这里","片假名","日语","目的地","blue-square","here","katakana","japanese","destination"],k:[5,4],o:2},man_with_turban:{skin_variations:{"1F3FB":{unified:"1F473-1F3FB",non_qualified:null,image:"1f473-1f3fb.png",sheet_x:22,sheet_y:44,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F473-1F3FC",non_qualified:null,image:"1f473-1f3fc.png",sheet_x:22,sheet_y:45,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F473-1F3FD",non_qualified:null,image:"1f473-1f3fd.png",sheet_x:22,sheet_y:46,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F473-1F3FE",non_qualified:null,image:"1f473-1f3fe.png",sheet_x:22,sheet_y:47,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F473-1F3FF",non_qualified:null,image:"1f473-1f3ff.png",sheet_x:22,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F473-200D-2642-FE0F",a:"ManwithTurban",b:"1F473",d:!0,e:!0,f:!0,h:!1,j:["戴着头巾的人","雄","印度","印度教","阿拉伯人","male","indian","hinduism","arabs"],k:[22,43],o:2},moon:{a:"WaxingGibbousMoonSymbol",b:"1F314",d:!0,e:!0,f:!0,h:!0,k:[5,39],n:["waxing_gibbous_moon"],o:2,j:["残月月亮"]},paperclip:{a:"Paperclip",b:"1F4CE",d:!0,e:!0,f:!0,h:!0,j:["回形针","文件","文具","documents","stationery"],k:[26,36],o:2},linked_paperclips:{a:"LinkedPaperclips",b:"1F587-FE0F",c:"1F587",d:!0,e:!0,f:!0,h:!0,k:[29,43],o:2,j:["交叠的回形针"]},"man-wearing-turban":{skin_variations:{"1F3FB":{unified:"1F473-1F3FB-200D-2642-FE0F",non_qualified:"1F473-1F3FB-200D-2642",image:"1f473-1f3fb-200d-2642-fe0f.png",sheet_x:22,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F473-1F3FC-200D-2642-FE0F",non_qualified:"1F473-1F3FC-200D-2642",image:"1f473-1f3fc-200d-2642-fe0f.png",sheet_x:22,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F473-1F3FD-200D-2642-FE0F",non_qualified:"1F473-1F3FD-200D-2642",image:"1f473-1f3fd-200d-2642-fe0f.png",sheet_x:22,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F473-1F3FE-200D-2642-FE0F",non_qualified:"1F473-1F3FE-200D-2642",image:"1f473-1f3fe-200d-2642-fe0f.png",sheet_x:22,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F473-1F3FF-200D-2642-FE0F",non_qualified:"1F473-1F3FF-200D-2642",image:"1f473-1f3ff-200d-2642-fe0f.png",sheet_x:22,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F473",a:"ManWearingTurban",b:"1F473-200D-2642-FE0F",c:"1F473-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[22,37],o:4,j:["戴着男性头巾的男性"]},sa:{a:"SquaredKatakanaSa",b:"1F202-FE0F",c:"1F202",d:!0,e:!0,f:!0,h:!0,j:["服务费符号","日语","蓝色方块","片假名","japanese","blue-square","katakana"],k:[5,5],o:2},full_moon:{a:"FullMoonSymbol",b:"1F315",d:!0,e:!0,f:!0,h:!0,j:["满月","自然界","黄色","黄昏","行星","空间","晚上","傍晚","睡","nature","yellow","twilight","planet","space","night","evening","sleep"],k:[5,40],o:2},"flag-mv":{a:"MaldivesFlag",b:"1F1F2-1F1FB",d:!0,e:!0,f:!0,h:!0,k:[3,20],o:2,j:["马尔代夫国旗"]},"flag-mw":{a:"MalawiFlag",b:"1F1F2-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[3,21],o:2,j:["马拉维国旗"]},waning_gibbous_moon:{a:"WaningGibbousMoonSymbol",b:"1F316",d:!0,e:!0,f:!0,h:!0,j:["残月月亮","自然界","黄昏","行星","空间","晚上","傍晚","睡","waxing_gibbous_moon","nature","twilight","planet","space","night","evening","sleep","waxing_gibbous_moon"],k:[5,41],o:2},"woman-wearing-turban":{skin_variations:{"1F3FB":{unified:"1F473-1F3FB-200D-2640-FE0F",non_qualified:"1F473-1F3FB-200D-2640",image:"1f473-1f3fb-200d-2640-fe0f.png",sheet_x:22,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F473-1F3FC-200D-2640-FE0F",non_qualified:"1F473-1F3FC-200D-2640",image:"1f473-1f3fc-200d-2640-fe0f.png",sheet_x:22,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F473-1F3FD-200D-2640-FE0F",non_qualified:"1F473-1F3FD-200D-2640",image:"1f473-1f3fd-200d-2640-fe0f.png",sheet_x:22,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F473-1F3FE-200D-2640-FE0F",non_qualified:"1F473-1F3FE-200D-2640",image:"1f473-1f3fe-200d-2640-fe0f.png",sheet_x:22,sheet_y:35,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F473-1F3FF-200D-2640-FE0F",non_qualified:"1F473-1F3FF-200D-2640",image:"1f473-1f3ff-200d-2640-fe0f.png",sheet_x:22,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanWearingTurban",b:"1F473-200D-2640-FE0F",c:"1F473-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[22,31],o:4,j:["戴着女性头巾的女性"]},u6708:{a:"SquaredCjkUnifiedIdeograph-6708",b:"1F237-FE0F",c:"1F237",d:!0,e:!0,f:!0,h:!0,j:["每月金额符号","中文","月","月亮","日语","橙色方块","汉字","chinese","month","moon","japanese","orange-square","kanji"],k:[5,13],o:2},straight_ruler:{a:"StraightRuler",b:"1F4CF",d:!0,e:!0,f:!0,h:!0,j:["直尺","文具","算","长度","数学","学校","绘图","建筑师","素描","stationery","calculate","length","math","school","drawing","architect","sketch"],k:[26,37],o:2},u6709:{a:"SquaredCjkUnifiedIdeograph-6709",b:"1F236",d:!0,e:!0,f:!0,h:!0,j:["付费符号","橙色方块","中文","有","汉字","orange-square","chinese","have","kanji"],k:[5,12],o:2},triangular_ruler:{a:"TriangularRuler",b:"1F4D0",d:!0,e:!0,f:!0,h:!0,j:["三角尺","文具","数学","建筑师","素描","stationery","math","architect","sketch"],k:[26,38],o:2},man_with_gua_pi_mao:{skin_variations:{"1F3FB":{unified:"1F472-1F3FB",non_qualified:null,image:"1f472-1f3fb.png",sheet_x:22,sheet_y:26,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F472-1F3FC",non_qualified:null,image:"1f472-1f3fc.png",sheet_x:22,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F472-1F3FD",non_qualified:null,image:"1f472-1f3fd.png",sheet_x:22,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F472-1F3FE",non_qualified:null,image:"1f472-1f3fe.png",sheet_x:22,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F472-1F3FF",non_qualified:null,image:"1f472-1f3ff.png",sheet_x:22,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManwithGuaPiMao",b:"1F472",d:!0,e:!0,f:!0,h:!0,j:["男人戴中式帽子","雄","男孩","中文","male","boy","chinese"],k:[22,25],o:2},"flag-mx":{a:"MexicoFlag",b:"1F1F2-1F1FD",d:!0,e:!0,f:!0,h:!0,k:[3,22],o:2,j:["墨西哥国旗"]},last_quarter_moon:{a:"LastQuarterMoonSymbol",b:"1F317",d:!0,e:!0,f:!0,h:!0,j:["下弦月","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,42],o:2},person_with_headscarf:{skin_variations:{"1F3FB":{unified:"1F9D5-1F3FB",non_qualified:null,image:"1f9d5-1f3fb.png",sheet_x:48,sheet_y:35,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D5-1F3FC",non_qualified:null,image:"1f9d5-1f3fc.png",sheet_x:48,sheet_y:36,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D5-1F3FD",non_qualified:null,image:"1f9d5-1f3fd.png",sheet_x:48,sheet_y:37,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D5-1F3FE",non_qualified:null,image:"1f9d5-1f3fe.png",sheet_x:48,sheet_y:38,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D5-1F3FF",non_qualified:null,image:"1f9d5-1f3ff.png",sheet_x:48,sheet_y:39,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"PersonwithHeadscarf",b:"1F9D5",d:!0,e:!0,f:!0,h:!0,k:[48,34],o:5,j:["女人戴着头巾"]},waning_crescent_moon:{a:"WaningCrescentMoonSymbol",b:"1F318",d:!0,e:!0,f:!0,h:!0,j:["残月","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,43],o:2},u6307:{a:"SquaredCjkUnifiedIdeograph-6307",b:"1F22F",d:!0,e:!0,f:!0,h:!0,j:["指定符号","中文","点","绿色方块","汉字","chinese","point","green-square","kanji"],k:[5,7],o:2},scissors:{a:"BlackScissors",b:"2702-FE0F",c:"2702",d:!0,e:!0,f:!0,h:!0,j:["剪刀","文具","切","stationery","cut"],k:[54,39],o:2},"flag-my":{a:"MalaysiaFlag",b:"1F1F2-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[3,23],o:2,j:["马来西亚国旗"]},ideograph_advantage:{a:"CircledIdeographAdvantage",b:"1F250",d:!0,e:!0,f:!0,h:!0,j:["获得的符号","中文","汉字","获得","获取","圈","chinese","kanji","obtain","get","circle"],k:[5,17],o:2},man_in_tuxedo:{skin_variations:{"1F3FB":{unified:"1F935-1F3FB",non_qualified:null,image:"1f935-1f3fb.png",sheet_x:39,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F935-1F3FC",non_qualified:null,image:"1f935-1f3fc.png",sheet_x:39,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F935-1F3FD",non_qualified:null,image:"1f935-1f3fd.png",sheet_x:39,sheet_y:26,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F935-1F3FE",non_qualified:null,image:"1f935-1f3fe.png",sheet_x:39,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F935-1F3FF",non_qualified:null,image:"1f935-1f3ff.png",sheet_x:39,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManinTuxedo",b:"1F935",d:!0,e:!0,f:!0,h:!0,j:["穿着燕尾服的男人","夫妇","婚","婚礼","新郎","couple","marriage","wedding","groom"],k:[39,23],o:4},"flag-mz":{a:"MozambiqueFlag",b:"1F1F2-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[3,24],o:2,j:["莫桑比克国旗"]},card_file_box:{a:"CardFileBox",b:"1F5C3-FE0F",c:"1F5C3",d:!0,e:!0,f:!0,h:!0,j:["卡档案盒","商","文具","business","stationery"],k:[30,16],o:2},crescent_moon:{a:"CrescentMoon",b:"1F319",d:!0,e:!0,f:!0,h:!0,j:["弯月","晚上","睡","天空","傍晚","魔法","night","sleep","sky","evening","magic"],k:[5,44],o:2},"flag-na":{a:"NamibiaFlag",b:"1F1F3-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[3,25],o:2,j:["纳米比亚国旗"]},bride_with_veil:{skin_variations:{"1F3FB":{unified:"1F470-1F3FB",non_qualified:null,image:"1f470-1f3fb.png",sheet_x:22,sheet_y:2,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F470-1F3FC",non_qualified:null,image:"1f470-1f3fc.png",sheet_x:22,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F470-1F3FD",non_qualified:null,image:"1f470-1f3fd.png",sheet_x:22,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F470-1F3FE",non_qualified:null,image:"1f470-1f3fe.png",sheet_x:22,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F470-1F3FF",non_qualified:null,image:"1f470-1f3ff.png",sheet_x:22,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"BridewithVeil",b:"1F470",d:!0,e:!0,f:!0,h:!0,j:["戴着面纱的新娘","夫妇","婚","婚礼","女人","新娘","couple","marriage","wedding","woman","bride"],k:[22,1],o:2},new_moon_with_face:{a:"NewMoonwithFace",b:"1F31A",d:!0,e:!0,f:!0,h:!0,j:["新月脸","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,45],o:2},file_cabinet:{a:"FileCabinet",b:"1F5C4-FE0F",c:"1F5C4",d:!0,e:!0,f:!0,h:!0,j:["文件柜","归档","组织","filing","organizing"],k:[30,17],o:2},u5272:{a:"SquaredCjkUnifiedIdeograph-5272",b:"1F239",d:!0,e:!0,f:!0,h:!0,j:["特价符号","切","分","中文","汉字","粉红色方块","cut","divide","chinese","kanji","pink-square"],k:[5,15],o:2},wastebasket:{a:"Wastebasket",b:"1F5D1-FE0F",c:"1F5D1",d:!0,e:!0,f:!0,h:!0,j:["废纸篓","是","垃圾","垃圾","垃圾","折腾","bin","trash","rubbish","garbage","toss"],k:[30,18],o:2},pregnant_woman:{skin_variations:{"1F3FB":{unified:"1F930-1F3FB",non_qualified:null,image:"1f930-1f3fb.png",sheet_x:38,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F930-1F3FC",non_qualified:null,image:"1f930-1f3fc.png",sheet_x:38,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F930-1F3FD",non_qualified:null,image:"1f930-1f3fd.png",sheet_x:38,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F930-1F3FE",non_qualified:null,image:"1f930-1f3fe.png",sheet_x:38,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F930-1F3FF",non_qualified:null,image:"1f930-1f3ff.png",sheet_x:38,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"PregnantWoman",b:"1F930",d:!0,e:!0,f:!0,h:!0,j:["孕妇","婴儿","baby"],k:[38,50],o:4},first_quarter_moon_with_face:{a:"FirstQuarterMoonwithFace",b:"1F31B",d:!0,e:!0,f:!0,h:!0,j:["上弦月脸","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,46],o:2},"flag-nc":{a:"NewCaledoniaFlag",b:"1F1F3-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[3,26],o:2,j:["新喀里多尼亚国旗"]},u7121:{a:"SquaredCjkUnifiedIdeograph-7121",b:"1F21A",d:!0,e:!0,f:!0,h:!0,j:["免费符号","无","中文","汉字","日语","橙色方块","nothing","chinese","kanji","japanese","orange-square"],k:[5,6],o:2},lock:{a:"Lock",b:"1F512",d:!0,e:!0,f:!0,h:!0,j:["锁住的锁","安全","密码","挂锁","security","password","padlock"],k:[27,46],o:2},"flag-ne":{a:"NigerFlag",b:"1F1F3-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[3,27],o:2,j:["尼日尔国旗"]},last_quarter_moon_with_face:{a:"LastQuarterMoonwithFace",b:"1F31C",d:!0,e:!0,f:!0,h:!0,j:["下弦月脸","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,47],o:2},"breast-feeding":{skin_variations:{"1F3FB":{unified:"1F931-1F3FB",non_qualified:null,image:"1f931-1f3fb.png",sheet_x:39,sheet_y:0,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F931-1F3FC",non_qualified:null,image:"1f931-1f3fc.png",sheet_x:39,sheet_y:1,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F931-1F3FD",non_qualified:null,image:"1f931-1f3fd.png",sheet_x:39,sheet_y:2,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F931-1F3FE",non_qualified:null,image:"1f931-1f3fe.png",sheet_x:39,sheet_y:3,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F931-1F3FF",non_qualified:null,image:"1f931-1f3ff.png",sheet_x:39,sheet_y:4,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Breast-Feeding",b:"1F931",d:!0,e:!0,f:!0,h:!0,k:[38,56],o:5,j:["女人喂养母乳"]},u7981:{a:"SquaredCjkUnifiedIdeograph-7981",b:"1F232",d:!0,e:!0,f:!0,h:!0,j:["禁止符号","汉字","日语","中文","禁止","限制","限制","红方块","kanji","japanese","chinese","forbidden","limit","restricted","red-square"],k:[5,8],o:2},accept:{a:"CircledIdeographAccept",b:"1F251",d:!0,e:!0,f:!0,h:!0,j:["同意符号","还行","好","中文","汉字","同意","是的","橙色圆圈","ok","good","chinese","kanji","agree","yes","orange-circle"],k:[5,18],o:2},angel:{skin_variations:{"1F3FB":{unified:"1F47C-1F3FB",non_qualified:null,image:"1f47c-1f3fb.png",sheet_x:23,sheet_y:38,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F47C-1F3FC",non_qualified:null,image:"1f47c-1f3fc.png",sheet_x:23,sheet_y:39,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F47C-1F3FD",non_qualified:null,image:"1f47c-1f3fd.png",sheet_x:23,sheet_y:40,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F47C-1F3FE",non_qualified:null,image:"1f47c-1f3fe.png",sheet_x:23,sheet_y:41,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F47C-1F3FF",non_qualified:null,image:"1f47c-1f3ff.png",sheet_x:23,sheet_y:42,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"BabyAngel",b:"1F47C",d:!0,e:!0,f:!0,h:!0,j:["天使宝贝","天堂","翅膀","光环","heaven","wings","halo"],k:[23,37],o:2},unlock:{a:"OpenLock",b:"1F513",d:!0,e:!0,f:!0,h:!0,j:["松开的锁","隐私","安全","privacy","security"],k:[27,47],o:2},"flag-nf":{a:"NorfolkIslandFlag",b:"1F1F3-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[3,28],o:2,j:["诺福克岛旗"]},thermometer:{a:"Thermometer",b:"1F321-FE0F",c:"1F321",d:!0,e:!0,f:!0,h:!0,j:["温度计","天气","温度","热","冷","weather","temperature","hot","cold"],k:[5,52],o:2},"flag-ng":{a:"NigeriaFlag",b:"1F1F3-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[3,29],o:2,j:["尼日利亚国旗"]},u7533:{a:"SquaredCjkUnifiedIdeograph-7533",b:"1F238",d:!0,e:!0,f:!0,h:!0,j:["申请符号","中文","日语","汉字","橙色方块","chinese","japanese","kanji","orange-square"],k:[5,14],o:2},sunny:{a:"BlackSunwithRays",b:"2600-FE0F",c:"2600",d:!0,e:!0,f:!0,h:!0,j:["太阳","天气","自然界","亮度","夏天","海滩","春天","weather","nature","brightness","summer","beach","spring"],k:[52,49],o:2},lock_with_ink_pen:{a:"LockwithInkPen",b:"1F50F",d:!0,e:!0,f:!0,h:!0,j:["笔与锁","安全","秘密","security","secret"],k:[27,43],o:2},santa:{skin_variations:{"1F3FB":{unified:"1F385-1F3FB",non_qualified:null,image:"1f385-1f3fb.png",sheet_x:7,sheet_y:37,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F385-1F3FC",non_qualified:null,image:"1f385-1f3fc.png",sheet_x:7,sheet_y:38,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F385-1F3FD",non_qualified:null,image:"1f385-1f3fd.png",sheet_x:7,sheet_y:39,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F385-1F3FE",non_qualified:null,image:"1f385-1f3fe.png",sheet_x:7,sheet_y:40,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F385-1F3FF",non_qualified:null,image:"1f385-1f3ff.png",sheet_x:7,sheet_y:41,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FatherChristmas",b:"1F385",d:!0,e:!0,f:!0,h:!0,j:["圣诞老人","节日","一","雄","圣诞","父亲基督","festival","man","male","xmas","fatherchristmas"],k:[7,36],o:2},closed_lock_with_key:{a:"ClosedLockwithKey",b:"1F510",d:!0,e:!0,f:!0,h:!0,j:["钥匙与锁","安全","隐私","security","privacy"],k:[27,44],o:2},u5408:{a:"SquaredCjkUnifiedIdeograph-5408",b:"1F234",d:!0,e:!0,f:!0,h:!0,j:["合格符号","日语","中文","加入","汉字","红方块","japanese","chinese","join","kanji","red-square"],k:[5,10],o:2},"flag-ni":{a:"NicaraguaFlag",b:"1F1F3-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[3,30],o:2,j:["尼加拉瓜国旗"]},mrs_claus:{skin_variations:{"1F3FB":{unified:"1F936-1F3FB",non_qualified:null,image:"1f936-1f3fb.png",sheet_x:39,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F936-1F3FC",non_qualified:null,image:"1f936-1f3fc.png",sheet_x:39,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F936-1F3FD",non_qualified:null,image:"1f936-1f3fd.png",sheet_x:39,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F936-1F3FE",non_qualified:null,image:"1f936-1f3fe.png",sheet_x:39,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F936-1F3FF",non_qualified:null,image:"1f936-1f3ff.png",sheet_x:39,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MotherChristmas",b:"1F936",d:!0,e:!0,f:!0,h:!0,j:["圣诞老婆婆","女人","女性","圣诞","母亲基督","woman","female","xmas","motherchristmas"],k:[39,29],n:["mother_christmas"],o:4},full_moon_with_face:{a:"FullMoonwithFace",b:"1F31D",d:!0,e:!0,f:!0,h:!0,j:["满月脸","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,48],o:2},key:{a:"Key",b:"1F511",d:!0,e:!0,f:!0,h:!0,j:["钥匙","锁","通过","密码","lock","door","password"],k:[27,45],o:2},superhero:{skin_variations:{"1F3FB":{unified:"1F9B8-1F3FB",non_qualified:null,image:"1f9b8-1f3fb.png",sheet_x:43,sheet_y:31,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B8-1F3FC",non_qualified:null,image:"1f9b8-1f3fc.png",sheet_x:43,sheet_y:32,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B8-1F3FD",non_qualified:null,image:"1f9b8-1f3fd.png",sheet_x:43,sheet_y:33,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B8-1F3FE",non_qualified:null,image:"1f9b8-1f3fe.png",sheet_x:43,sheet_y:34,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B8-1F3FF",non_qualified:null,image:"1f9b8-1f3ff.png",sheet_x:43,sheet_y:35,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Superhero",b:"1F9B8",d:!0,e:!0,f:!0,h:!0,k:[43,30],o:11,j:["超级英雄"]},"flag-nl":{a:"NetherlandsFlag",b:"1F1F3-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[3,31],o:2,j:["荷兰国旗"]},u7a7a:{a:"SquaredCjkUnifiedIdeograph-7a7a",b:"1F233",d:!0,e:!0,f:!0,h:!0,j:["空缺符号","汉字","日语","中文","空","天空","蓝色方块","kanji","japanese","chinese","empty","sky","blue-square"],k:[5,9],o:2},sun_with_face:{a:"SunwithFace",b:"1F31E",d:!0,e:!0,f:!0,h:!0,j:["太阳脸","自然界","上午","天空","nature","morning","sky"],k:[5,49],o:2},male_superhero:{skin_variations:{"1F3FB":{unified:"1F9B8-1F3FB-200D-2642-FE0F",non_qualified:"1F9B8-1F3FB-200D-2642",image:"1f9b8-1f3fb-200d-2642-fe0f.png",sheet_x:43,sheet_y:25,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B8-1F3FC-200D-2642-FE0F",non_qualified:"1F9B8-1F3FC-200D-2642",image:"1f9b8-1f3fc-200d-2642-fe0f.png",sheet_x:43,sheet_y:26,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B8-1F3FD-200D-2642-FE0F",non_qualified:"1F9B8-1F3FD-200D-2642",image:"1f9b8-1f3fd-200d-2642-fe0f.png",sheet_x:43,sheet_y:27,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B8-1F3FE-200D-2642-FE0F",non_qualified:"1F9B8-1F3FE-200D-2642",image:"1f9b8-1f3fe-200d-2642-fe0f.png",sheet_x:43,sheet_y:28,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B8-1F3FF-200D-2642-FE0F",non_qualified:"1F9B8-1F3FF-200D-2642",image:"1f9b8-1f3ff-200d-2642-fe0f.png",sheet_x:43,sheet_y:29,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleSuperhero",b:"1F9B8-200D-2642-FE0F",c:"1F9B8-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[43,24],o:11,j:["男性超级英雄"]},ringed_planet:{a:"RingedPlanet",b:"1FA90",d:!0,e:!0,f:!0,h:!0,k:[52,4],o:12,j:["环斑星球"]},old_key:{a:"OldKey",b:"1F5DD-FE0F",c:"1F5DD",d:!0,e:!0,f:!0,h:!0,j:["旧钥匙","锁","通过","密码","lock","door","password"],k:[30,22],o:2},congratulations:{a:"CircledIdeographCongratulation",b:"3297-FE0F",c:"3297",d:!0,e:!0,f:!0,h:!0,j:["祝福符号","中文","汉字","日语","红圈","chinese","kanji","japanese","red-circle"],k:[55,46],o:2},"flag-no":{a:"NorwayFlag",b:"1F1F3-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[3,32],o:2,j:["挪威国旗"]},star:{a:"WhiteMediumStar",b:"2B50",d:!0,e:!0,f:!0,h:!0,j:["星","晚上","黄色","night","yellow"],k:[55,42],o:2},secret:{a:"CircledIdeographSecret",b:"3299-FE0F",c:"3299",d:!0,e:!0,f:!0,h:!0,j:["秘密符号","隐私","中文","嘘","汉字","红圈","privacy","chinese","sshh","kanji","red-circle"],k:[55,47],o:2},"flag-np":{a:"NepalFlag",b:"1F1F3-1F1F5",d:!0,e:!0,f:!0,h:!0,k:[3,33],o:2,j:["尼泊尔国旗"]},female_superhero:{skin_variations:{"1F3FB":{unified:"1F9B8-1F3FB-200D-2640-FE0F",non_qualified:"1F9B8-1F3FB-200D-2640",image:"1f9b8-1f3fb-200d-2640-fe0f.png",sheet_x:43,sheet_y:19,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B8-1F3FC-200D-2640-FE0F",non_qualified:"1F9B8-1F3FC-200D-2640",image:"1f9b8-1f3fc-200d-2640-fe0f.png",sheet_x:43,sheet_y:20,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B8-1F3FD-200D-2640-FE0F",non_qualified:"1F9B8-1F3FD-200D-2640",image:"1f9b8-1f3fd-200d-2640-fe0f.png",sheet_x:43,sheet_y:21,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B8-1F3FE-200D-2640-FE0F",non_qualified:"1F9B8-1F3FE-200D-2640",image:"1f9b8-1f3fe-200d-2640-fe0f.png",sheet_x:43,sheet_y:22,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B8-1F3FF-200D-2640-FE0F",non_qualified:"1F9B8-1F3FF-200D-2640",image:"1f9b8-1f3ff-200d-2640-fe0f.png",sheet_x:43,sheet_y:23,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleSuperhero",b:"1F9B8-200D-2640-FE0F",c:"1F9B8-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[43,18],o:11,j:["女超级英雄"]},hammer:{a:"Hammer",b:"1F528",d:!0,e:!0,f:!0,h:!0,j:["锤子","工具","建","创造","tools","build","create"],k:[28,11],o:2},star2:{a:"GlowingStar",b:"1F31F",d:!0,e:!0,f:!0,h:!0,j:["发光的星星","晚上","火花","棒","好","魔法","night","sparkle","awesome","good","magic"],k:[5,50],o:2},"flag-nr":{a:"NauruFlag",b:"1F1F3-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[3,34],o:2,j:["瑙鲁国旗"]},axe:{a:"Axe",b:"1FA93",d:!0,e:!0,f:!0,h:!0,k:[52,7],o:12,j:["斧头"]},u55b6:{a:"SquaredCjkUnifiedIdeograph-55b6",b:"1F23A",d:!0,e:!0,f:!0,h:!0,j:["营业中符号","日语","营业时间","橙色方块","japanese","openinghours","orange-square"],k:[5,16],o:2},supervillain:{skin_variations:{"1F3FB":{unified:"1F9B9-1F3FB",non_qualified:null,image:"1f9b9-1f3fb.png",sheet_x:43,sheet_y:49,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B9-1F3FC",non_qualified:null,image:"1f9b9-1f3fc.png",sheet_x:43,sheet_y:50,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B9-1F3FD",non_qualified:null,image:"1f9b9-1f3fd.png",sheet_x:43,sheet_y:51,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B9-1F3FE",non_qualified:null,image:"1f9b9-1f3fe.png",sheet_x:43,sheet_y:52,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B9-1F3FF",non_qualified:null,image:"1f9b9-1f3ff.png",sheet_x:43,sheet_y:53,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Supervillain",b:"1F9B9",d:!0,e:!0,f:!0,h:!0,k:[43,48],o:11,j:["大反派"]},stars:{a:"ShootingStar",b:"1F320",d:!0,e:!0,f:!0,h:!0,j:["流星","晚上","相片","night","photo"],k:[5,51],o:2},u6e80:{a:"SquaredCjkUnifiedIdeograph-6e80",b:"1F235",d:!0,e:!0,f:!0,h:!0,j:["客满符号","满","中文","日语","红方块","汉字","full","chinese","japanese","red-square","kanji"],k:[5,11],o:2},"flag-nu":{a:"NiueFlag",b:"1F1F3-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[3,35],o:2,j:["纽埃国旗"]},pick:{a:"Pick",b:"26CF-FE0F",c:"26CF",d:!0,e:!0,f:!0,h:!0,j:["鎬","工具","你","tools","dig"],k:[54,5],o:2},male_supervillain:{skin_variations:{"1F3FB":{unified:"1F9B9-1F3FB-200D-2642-FE0F",non_qualified:"1F9B9-1F3FB-200D-2642",image:"1f9b9-1f3fb-200d-2642-fe0f.png",sheet_x:43,sheet_y:43,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B9-1F3FC-200D-2642-FE0F",non_qualified:"1F9B9-1F3FC-200D-2642",image:"1f9b9-1f3fc-200d-2642-fe0f.png",sheet_x:43,sheet_y:44,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B9-1F3FD-200D-2642-FE0F",non_qualified:"1F9B9-1F3FD-200D-2642",image:"1f9b9-1f3fd-200d-2642-fe0f.png",sheet_x:43,sheet_y:45,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B9-1F3FE-200D-2642-FE0F",non_qualified:"1F9B9-1F3FE-200D-2642",image:"1f9b9-1f3fe-200d-2642-fe0f.png",sheet_x:43,sheet_y:46,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B9-1F3FF-200D-2642-FE0F",non_qualified:"1F9B9-1F3FF-200D-2642",image:"1f9b9-1f3ff-200d-2642-fe0f.png",sheet_x:43,sheet_y:47,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleSupervillain",b:"1F9B9-200D-2642-FE0F",c:"1F9B9-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[43,42],o:11,j:["男性大反派"]},female_supervillain:{skin_variations:{"1F3FB":{unified:"1F9B9-1F3FB-200D-2640-FE0F",non_qualified:"1F9B9-1F3FB-200D-2640",image:"1f9b9-1f3fb-200d-2640-fe0f.png",sheet_x:43,sheet_y:37,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B9-1F3FC-200D-2640-FE0F",non_qualified:"1F9B9-1F3FC-200D-2640",image:"1f9b9-1f3fc-200d-2640-fe0f.png",sheet_x:43,sheet_y:38,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B9-1F3FD-200D-2640-FE0F",non_qualified:"1F9B9-1F3FD-200D-2640",image:"1f9b9-1f3fd-200d-2640-fe0f.png",sheet_x:43,sheet_y:39,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B9-1F3FE-200D-2640-FE0F",non_qualified:"1F9B9-1F3FE-200D-2640",image:"1f9b9-1f3fe-200d-2640-fe0f.png",sheet_x:43,sheet_y:40,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B9-1F3FF-200D-2640-FE0F",non_qualified:"1F9B9-1F3FF-200D-2640",image:"1f9b9-1f3ff-200d-2640-fe0f.png",sheet_x:43,sheet_y:41,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleSupervillain",b:"1F9B9-200D-2640-FE0F",c:"1F9B9-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[43,36],o:11,j:["女性大反派"]},hammer_and_pick:{a:"HammerandPick",b:"2692-FE0F",c:"2692",d:!0,e:!0,f:!0,h:!0,j:["锤子和鎬","工具","建","创造","tools","build","create"],k:[53,41],o:2},milky_way:{a:"MilkyWay",b:"1F30C",d:!0,e:!0,f:!0,h:!0,j:["银河","相片","空间","星星","photo","space","stars"],k:[5,31],o:2},red_circle:{a:"LargeRedCircle",b:"1F534",d:!0,e:!0,f:!0,h:!0,j:["红色圆圈","形状","错误","危险","shape","error","danger"],k:[28,23],o:2},"flag-nz":{a:"NewZealandFlag",b:"1F1F3-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[3,36],o:2,j:["新西兰国旗"]},large_orange_circle:{a:"LargeOrangeCircle",b:"1F7E0",d:!0,e:!0,f:!0,h:!0,k:[37,3],o:12,j:["橙色圆圈"]},hammer_and_wrench:{a:"HammerandWrench",b:"1F6E0-FE0F",c:"1F6E0",d:!0,e:!0,f:!0,h:!0,j:["锤子和扳手","工具","建","创造","tools","build","create"],k:[36,42],o:2},"flag-om":{a:"OmanFlag",b:"1F1F4-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[3,37],o:2,j:["阿曼国旗"]},cloud:{a:"Cloud",b:"2601-FE0F",c:"2601",d:!0,e:!0,f:!0,h:!0,j:["云","天气","天空","weather","sky"],k:[52,50],o:2},mage:{skin_variations:{"1F3FB":{unified:"1F9D9-1F3FB",non_qualified:null,image:"1f9d9-1f3fb.png",sheet_x:49,sheet_y:50,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D9-1F3FB-200D-2640-FE0F"},"1F3FC":{unified:"1F9D9-1F3FC",non_qualified:null,image:"1f9d9-1f3fc.png",sheet_x:49,sheet_y:51,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D9-1F3FC-200D-2640-FE0F"},"1F3FD":{unified:"1F9D9-1F3FD",non_qualified:null,image:"1f9d9-1f3fd.png",sheet_x:49,sheet_y:52,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D9-1F3FD-200D-2640-FE0F"},"1F3FE":{unified:"1F9D9-1F3FE",non_qualified:null,image:"1f9d9-1f3fe.png",sheet_x:49,sheet_y:53,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D9-1F3FE-200D-2640-FE0F"},"1F3FF":{unified:"1F9D9-1F3FF",non_qualified:null,image:"1f9d9-1f3ff.png",sheet_x:49,sheet_y:54,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D9-1F3FF-200D-2640-FE0F"}},obsoleted_by:"1F9D9-200D-2640-FE0F",a:"Mage",b:"1F9D9",d:!0,e:!0,f:!0,h:!0,k:[49,49],o:5,j:["魔法师"]},dagger_knife:{a:"DaggerKnife",b:"1F5E1-FE0F",c:"1F5E1",d:!0,e:!0,f:!0,h:!0,k:[30,24],o:2,j:["匕首"]},partly_sunny:{a:"SunBehindCloud",b:"26C5",d:!0,e:!0,f:!0,h:!0,j:["晴时多云","天气","自然界","多云","上午","秋天","春天","weather","nature","cloudy","morning","fall","spring"],k:[54,2],o:2},large_yellow_circle:{a:"LargeYellowCircle",b:"1F7E1",d:!0,e:!0,f:!0,h:!0,k:[37,4],o:12,j:["黄色圆圈"]},male_mage:{skin_variations:{"1F3FB":{unified:"1F9D9-1F3FB-200D-2642-FE0F",non_qualified:"1F9D9-1F3FB-200D-2642",image:"1f9d9-1f3fb-200d-2642-fe0f.png",sheet_x:49,sheet_y:44,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D9-1F3FC-200D-2642-FE0F",non_qualified:"1F9D9-1F3FC-200D-2642",image:"1f9d9-1f3fc-200d-2642-fe0f.png",sheet_x:49,sheet_y:45,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D9-1F3FD-200D-2642-FE0F",non_qualified:"1F9D9-1F3FD-200D-2642",image:"1f9d9-1f3fd-200d-2642-fe0f.png",sheet_x:49,sheet_y:46,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D9-1F3FE-200D-2642-FE0F",non_qualified:"1F9D9-1F3FE-200D-2642",image:"1f9d9-1f3fe-200d-2642-fe0f.png",sheet_x:49,sheet_y:47,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D9-1F3FF-200D-2642-FE0F",non_qualified:"1F9D9-1F3FF-200D-2642",image:"1f9d9-1f3ff-200d-2642-fe0f.png",sheet_x:49,sheet_y:48,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleMage",b:"1F9D9-200D-2642-FE0F",c:"1F9D9-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[49,43],o:5,j:["人的魔法师"]},"flag-pa":{a:"PanamaFlag",b:"1F1F5-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[3,38],o:2,j:["巴拿马国旗"]},thunder_cloud_and_rain:{a:"ThunderCloudandRain",b:"26C8-FE0F",c:"26C8",d:!0,e:!0,f:!0,h:!0,k:[54,3],o:2,j:["雷雨交加"]},large_green_circle:{a:"LargeGreenCircle",b:"1F7E2",d:!0,e:!0,f:!0,h:!0,k:[37,5],o:12,j:["绿色圆圈"]},female_mage:{skin_variations:{"1F3FB":{unified:"1F9D9-1F3FB-200D-2640-FE0F",non_qualified:"1F9D9-1F3FB-200D-2640",image:"1f9d9-1f3fb-200d-2640-fe0f.png",sheet_x:49,sheet_y:38,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D9-1F3FB"},"1F3FC":{unified:"1F9D9-1F3FC-200D-2640-FE0F",non_qualified:"1F9D9-1F3FC-200D-2640",image:"1f9d9-1f3fc-200d-2640-fe0f.png",sheet_x:49,sheet_y:39,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D9-1F3FC"},"1F3FD":{unified:"1F9D9-1F3FD-200D-2640-FE0F",non_qualified:"1F9D9-1F3FD-200D-2640",image:"1f9d9-1f3fd-200d-2640-fe0f.png",sheet_x:49,sheet_y:40,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D9-1F3FD"},"1F3FE":{unified:"1F9D9-1F3FE-200D-2640-FE0F",non_qualified:"1F9D9-1F3FE-200D-2640",image:"1f9d9-1f3fe-200d-2640-fe0f.png",sheet_x:49,sheet_y:41,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D9-1F3FE"},"1F3FF":{unified:"1F9D9-1F3FF-200D-2640-FE0F",non_qualified:"1F9D9-1F3FF-200D-2640",image:"1f9d9-1f3ff-200d-2640-fe0f.png",sheet_x:49,sheet_y:42,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D9-1F3FF"}},obsoletes:"1F9D9",a:"FemaleMage",b:"1F9D9-200D-2640-FE0F",c:"1F9D9-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[49,37],o:5,j:["女魔法师"]},crossed_swords:{a:"CrossedSwords",b:"2694-FE0F",c:"2694",d:!0,e:!0,f:!0,h:!0,j:["交锋的剑","武器","weapon"],k:[53,43],o:2},"flag-pe":{a:"PeruFlag",b:"1F1F5-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[3,39],o:2,j:["秘鲁国旗"]},gun:{a:"Pistol",b:"1F52B",d:!0,e:!0,f:!0,h:!0,j:["水枪","暴力","武器","手枪","左轮手枪","violence","weapon","pistol","revolver"],k:[28,14],o:2},mostly_sunny:{a:"MostlySunny",b:"1F324-FE0F",c:"1F324",d:!0,e:!0,f:!0,h:!0,k:[5,53],n:["sun_small_cloud"],o:2,j:["晴时多云"]},fairy:{skin_variations:{"1F3FB":{unified:"1F9DA-1F3FB",non_qualified:null,image:"1f9da-1f3fb.png",sheet_x:50,sheet_y:11,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoleted_by:"1F9DA-1F3FB-200D-2640-FE0F"},"1F3FC":{unified:"1F9DA-1F3FC",non_qualified:null,image:"1f9da-1f3fc.png",sheet_x:50,sheet_y:12,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoleted_by:"1F9DA-1F3FC-200D-2640-FE0F"},"1F3FD":{unified:"1F9DA-1F3FD",non_qualified:null,image:"1f9da-1f3fd.png",sheet_x:50,sheet_y:13,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoleted_by:"1F9DA-1F3FD-200D-2640-FE0F"},"1F3FE":{unified:"1F9DA-1F3FE",non_qualified:null,image:"1f9da-1f3fe.png",sheet_x:50,sheet_y:14,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoleted_by:"1F9DA-1F3FE-200D-2640-FE0F"},"1F3FF":{unified:"1F9DA-1F3FF",non_qualified:null,image:"1f9da-1f3ff.png",sheet_x:50,sheet_y:15,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoleted_by:"1F9DA-1F3FF-200D-2640-FE0F"}},obsoleted_by:"1F9DA-200D-2640-FE0F",a:"Fairy",b:"1F9DA",d:!0,e:!0,f:!0,h:!0,k:[50,10],o:5,j:["妖精"]},"flag-pf":{a:"FrenchPolynesiaFlag",b:"1F1F5-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[3,40],o:2,j:["法属波利尼西亚旗"]},large_blue_circle:{a:"LargeBlueCircle",b:"1F535",d:!0,e:!0,f:!0,h:!0,j:["蓝色圆圈","形状","图标","按钮","shape","icon","button"],k:[28,24],o:2},large_purple_circle:{a:"LargePurpleCircle",b:"1F7E3",d:!0,e:!0,f:!0,h:!0,k:[37,6],o:12,j:["紫色圆圈"]},bow_and_arrow:{a:"BowandArrow",b:"1F3F9",d:!0,e:!0,f:!0,h:!0,j:["弓箭","体育","sports"],k:[11,21],o:2},male_fairy:{skin_variations:{"1F3FB":{unified:"1F9DA-1F3FB-200D-2642-FE0F",non_qualified:"1F9DA-1F3FB-200D-2642",image:"1f9da-1f3fb-200d-2642-fe0f.png",sheet_x:50,sheet_y:5,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F9DA-1F3FC-200D-2642-FE0F",non_qualified:"1F9DA-1F3FC-200D-2642",image:"1f9da-1f3fc-200d-2642-fe0f.png",sheet_x:50,sheet_y:6,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F9DA-1F3FD-200D-2642-FE0F",non_qualified:"1F9DA-1F3FD-200D-2642",image:"1f9da-1f3fd-200d-2642-fe0f.png",sheet_x:50,sheet_y:7,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F9DA-1F3FE-200D-2642-FE0F",non_qualified:"1F9DA-1F3FE-200D-2642",image:"1f9da-1f3fe-200d-2642-fe0f.png",sheet_x:50,sheet_y:8,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F9DA-1F3FF-200D-2642-FE0F",non_qualified:"1F9DA-1F3FF-200D-2642",image:"1f9da-1f3ff-200d-2642-fe0f.png",sheet_x:50,sheet_y:9,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},a:"MaleFairy",b:"1F9DA-200D-2642-FE0F",c:"1F9DA-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[50,4],o:5,j:["男妖精"]},barely_sunny:{a:"BarelySunny",b:"1F325-FE0F",c:"1F325",d:!0,e:!0,f:!0,h:!0,k:[5,54],n:["sun_behind_cloud"],o:2,j:["多云时晴"]},"flag-pg":{a:"PapuaNewGuineaFlag",b:"1F1F5-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[3,41],o:2,j:["巴布亚新几内亚国旗"]},shield:{a:"Shield",b:"1F6E1-FE0F",c:"1F6E1",d:!0,e:!0,f:!0,h:!0,j:["盾牌","保护","安全","protection","security"],k:[36,43],o:2},partly_sunny_rain:{a:"PartlySunnyRain",b:"1F326-FE0F",c:"1F326",d:!0,e:!0,f:!0,h:!0,k:[5,55],n:["sun_behind_rain_cloud"],o:2,j:["太阳雨"]},large_brown_circle:{a:"LargeBrownCircle",b:"1F7E4",d:!0,e:!0,f:!0,h:!0,k:[37,7],o:12,j:["棕色圆圈"]},female_fairy:{skin_variations:{"1F3FB":{unified:"1F9DA-1F3FB-200D-2640-FE0F",non_qualified:"1F9DA-1F3FB-200D-2640",image:"1f9da-1f3fb-200d-2640-fe0f.png",sheet_x:49,sheet_y:56,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoletes:"1F9DA-1F3FB"},"1F3FC":{unified:"1F9DA-1F3FC-200D-2640-FE0F",non_qualified:"1F9DA-1F3FC-200D-2640",image:"1f9da-1f3fc-200d-2640-fe0f.png",sheet_x:50,sheet_y:0,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoletes:"1F9DA-1F3FC"},"1F3FD":{unified:"1F9DA-1F3FD-200D-2640-FE0F",non_qualified:"1F9DA-1F3FD-200D-2640",image:"1f9da-1f3fd-200d-2640-fe0f.png",sheet_x:50,sheet_y:1,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoletes:"1F9DA-1F3FD"},"1F3FE":{unified:"1F9DA-1F3FE-200D-2640-FE0F",non_qualified:"1F9DA-1F3FE-200D-2640",image:"1f9da-1f3fe-200d-2640-fe0f.png",sheet_x:50,sheet_y:2,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoletes:"1F9DA-1F3FE"},"1F3FF":{unified:"1F9DA-1F3FF-200D-2640-FE0F",non_qualified:"1F9DA-1F3FF-200D-2640",image:"1f9da-1f3ff-200d-2640-fe0f.png",sheet_x:50,sheet_y:3,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoletes:"1F9DA-1F3FF"}},obsoletes:"1F9DA",a:"FemaleFairy",b:"1F9DA-200D-2640-FE0F",c:"1F9DA-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[49,55],o:5,j:["女妖精"]},"flag-ph":{a:"PhilippinesFlag",b:"1F1F5-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[3,42],o:2,j:["菲律宾国旗"]},"flag-pk":{a:"PakistanFlag",b:"1F1F5-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[3,43],o:2,j:["巴基斯坦国旗"]},black_circle:{a:"MediumBlackCircle",b:"26AB",d:!0,e:!0,f:!0,h:!0,j:["黑圆圈","形状","按钮","圆","shape","button","round"],k:[53,53],o:2},wrench:{a:"Wrench",b:"1F527",d:!0,e:!0,f:!0,h:!0,j:["扳手","工具","迪伊","宜家","修复","保持","tools","diy","ikea","fix","maintainer"],k:[28,10],o:2},vampire:{skin_variations:{"1F3FB":{unified:"1F9DB-1F3FB",non_qualified:null,image:"1f9db-1f3fb.png",sheet_x:50,sheet_y:29,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DB-1F3FB-200D-2640-FE0F"},"1F3FC":{unified:"1F9DB-1F3FC",non_qualified:null,image:"1f9db-1f3fc.png",sheet_x:50,sheet_y:30,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DB-1F3FC-200D-2640-FE0F"},"1F3FD":{unified:"1F9DB-1F3FD",non_qualified:null,image:"1f9db-1f3fd.png",sheet_x:50,sheet_y:31,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DB-1F3FD-200D-2640-FE0F"},"1F3FE":{unified:"1F9DB-1F3FE",non_qualified:null,image:"1f9db-1f3fe.png",sheet_x:50,sheet_y:32,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DB-1F3FE-200D-2640-FE0F"},"1F3FF":{unified:"1F9DB-1F3FF",non_qualified:null,image:"1f9db-1f3ff.png",sheet_x:50,sheet_y:33,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DB-1F3FF-200D-2640-FE0F"}},obsoleted_by:"1F9DB-200D-2640-FE0F",a:"Vampire",b:"1F9DB",d:!0,e:!0,f:!0,h:!0,k:[50,28],o:5,j:["吸血鬼"]},rain_cloud:{a:"RainCloud",b:"1F327-FE0F",c:"1F327",d:!0,e:!0,f:!0,h:!0,k:[5,56],o:2,j:["云伴随雨"]},snow_cloud:{a:"SnowCloud",b:"1F328-FE0F",c:"1F328",d:!0,e:!0,f:!0,h:!0,k:[6,0],o:2,j:["云伴随雪"]},"flag-pl":{a:"PolandFlag",b:"1F1F5-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[3,44],o:2,j:["波兰国旗"]},male_vampire:{skin_variations:{"1F3FB":{unified:"1F9DB-1F3FB-200D-2642-FE0F",non_qualified:"1F9DB-1F3FB-200D-2642",image:"1f9db-1f3fb-200d-2642-fe0f.png",sheet_x:50,sheet_y:23,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9DB-1F3FC-200D-2642-FE0F",non_qualified:"1F9DB-1F3FC-200D-2642",image:"1f9db-1f3fc-200d-2642-fe0f.png",sheet_x:50,sheet_y:24,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9DB-1F3FD-200D-2642-FE0F",non_qualified:"1F9DB-1F3FD-200D-2642",image:"1f9db-1f3fd-200d-2642-fe0f.png",sheet_x:50,sheet_y:25,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9DB-1F3FE-200D-2642-FE0F",non_qualified:"1F9DB-1F3FE-200D-2642",image:"1f9db-1f3fe-200d-2642-fe0f.png",sheet_x:50,sheet_y:26,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9DB-1F3FF-200D-2642-FE0F",non_qualified:"1F9DB-1F3FF-200D-2642",image:"1f9db-1f3ff-200d-2642-fe0f.png",sheet_x:50,sheet_y:27,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleVampire",b:"1F9DB-200D-2642-FE0F",c:"1F9DB-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[50,22],o:5,j:["男吸血鬼"]},nut_and_bolt:{a:"NutandBolt",b:"1F529",d:!0,e:!0,f:!0,h:!0,j:["螺母和螺栓","手机","工具","修复","handy","tools","fix"],k:[28,12],o:2},white_circle:{a:"MediumWhiteCircle",b:"26AA",d:!0,e:!0,f:!0,h:!0,j:["白圆圈","形状","圆","shape","round"],k:[53,52],o:2},female_vampire:{skin_variations:{"1F3FB":{unified:"1F9DB-1F3FB-200D-2640-FE0F",non_qualified:"1F9DB-1F3FB-200D-2640",image:"1f9db-1f3fb-200d-2640-fe0f.png",sheet_x:50,sheet_y:17,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DB-1F3FB"},"1F3FC":{unified:"1F9DB-1F3FC-200D-2640-FE0F",non_qualified:"1F9DB-1F3FC-200D-2640",image:"1f9db-1f3fc-200d-2640-fe0f.png",sheet_x:50,sheet_y:18,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DB-1F3FC"},"1F3FD":{unified:"1F9DB-1F3FD-200D-2640-FE0F",non_qualified:"1F9DB-1F3FD-200D-2640",image:"1f9db-1f3fd-200d-2640-fe0f.png",sheet_x:50,sheet_y:19,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DB-1F3FD"},"1F3FE":{unified:"1F9DB-1F3FE-200D-2640-FE0F",non_qualified:"1F9DB-1F3FE-200D-2640",image:"1f9db-1f3fe-200d-2640-fe0f.png",sheet_x:50,sheet_y:20,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DB-1F3FE"},"1F3FF":{unified:"1F9DB-1F3FF-200D-2640-FE0F",non_qualified:"1F9DB-1F3FF-200D-2640",image:"1f9db-1f3ff-200d-2640-fe0f.png",sheet_x:50,sheet_y:21,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DB-1F3FF"}},obsoletes:"1F9DB",a:"FemaleVampire",b:"1F9DB-200D-2640-FE0F",c:"1F9DB-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[50,16],o:5,j:["女吸血鬼"]},"flag-pm":{a:"St.Pierre&MiquelonFlag",b:"1F1F5-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[3,45],o:2,j:["圣皮埃尔和密克隆国旗"]},large_red_square:{a:"LargeRedSquare",b:"1F7E5",d:!0,e:!0,f:!0,h:!0,k:[37,8],o:12,j:["红色正方形"]},lightning:{a:"Lightning",b:"1F329-FE0F",c:"1F329",d:!0,e:!0,f:!0,h:!0,k:[6,1],n:["lightning_cloud"],o:2,j:["云伴随闪电"]},gear:{a:"Gear",b:"2699-FE0F",c:"2699",d:!0,e:!0,f:!0,h:!0,j:["齿轮","齿轮","cog"],k:[53,47],o:2},merperson:{skin_variations:{"1F3FB":{unified:"1F9DC-1F3FB",non_qualified:null,image:"1f9dc-1f3fb.png",sheet_x:50,sheet_y:47,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DC-1F3FB-200D-2642-FE0F"},"1F3FC":{unified:"1F9DC-1F3FC",non_qualified:null,image:"1f9dc-1f3fc.png",sheet_x:50,sheet_y:48,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DC-1F3FC-200D-2642-FE0F"},"1F3FD":{unified:"1F9DC-1F3FD",non_qualified:null,image:"1f9dc-1f3fd.png",sheet_x:50,sheet_y:49,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DC-1F3FD-200D-2642-FE0F"},"1F3FE":{unified:"1F9DC-1F3FE",non_qualified:null,image:"1f9dc-1f3fe.png",sheet_x:50,sheet_y:50,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DC-1F3FE-200D-2642-FE0F"},"1F3FF":{unified:"1F9DC-1F3FF",non_qualified:null,image:"1f9dc-1f3ff.png",sheet_x:50,sheet_y:51,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DC-1F3FF-200D-2642-FE0F"}},obsoleted_by:"1F9DC-200D-2642-FE0F",a:"Merperson",b:"1F9DC",d:!0,e:!0,f:!0,h:!0,k:[50,46],o:5,j:["人鱼"]},tornado:{a:"Tornado",b:"1F32A-FE0F",c:"1F32A",d:!0,e:!0,f:!0,h:!0,j:["龙卷风","天气","气旋","龙卷风","weather","cyclone","twister"],k:[6,2],n:["tornado_cloud"],o:2},large_orange_square:{a:"LargeOrangeSquare",b:"1F7E7",d:!0,e:!0,f:!0,h:!0,k:[37,10],o:12,j:["橙色正方形"]},"flag-pn":{a:"PitcairnIslandsFlag",b:"1F1F5-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[3,46],o:2,j:["皮特凯恩群岛旗"]},compression:{a:"Compression",b:"1F5DC-FE0F",c:"1F5DC",d:!0,e:!0,f:!0,h:!0,k:[30,21],o:2,j:["夹具"]},merman:{skin_variations:{"1F3FB":{unified:"1F9DC-1F3FB-200D-2642-FE0F",non_qualified:"1F9DC-1F3FB-200D-2642",image:"1f9dc-1f3fb-200d-2642-fe0f.png",sheet_x:50,sheet_y:41,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DC-1F3FB"},"1F3FC":{unified:"1F9DC-1F3FC-200D-2642-FE0F",non_qualified:"1F9DC-1F3FC-200D-2642",image:"1f9dc-1f3fc-200d-2642-fe0f.png",sheet_x:50,sheet_y:42,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DC-1F3FC"},"1F3FD":{unified:"1F9DC-1F3FD-200D-2642-FE0F",non_qualified:"1F9DC-1F3FD-200D-2642",image:"1f9dc-1f3fd-200d-2642-fe0f.png",sheet_x:50,sheet_y:43,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DC-1F3FD"},"1F3FE":{unified:"1F9DC-1F3FE-200D-2642-FE0F",non_qualified:"1F9DC-1F3FE-200D-2642",image:"1f9dc-1f3fe-200d-2642-fe0f.png",sheet_x:50,sheet_y:44,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DC-1F3FE"},"1F3FF":{unified:"1F9DC-1F3FF-200D-2642-FE0F",non_qualified:"1F9DC-1F3FF-200D-2642",image:"1f9dc-1f3ff-200d-2642-fe0f.png",sheet_x:50,sheet_y:45,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DC-1F3FF"}},obsoletes:"1F9DC",a:"Merman",b:"1F9DC-200D-2642-FE0F",c:"1F9DC-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[50,40],o:5,j:["人鱼"]},large_yellow_square:{a:"LargeYellowSquare",b:"1F7E8",d:!0,e:!0,f:!0,h:!0,k:[37,11],o:12,j:["黄色正方形"]},fog:{a:"Fog",b:"1F32B-FE0F",c:"1F32B",d:!0,e:!0,f:!0,h:!0,j:["雾气","天气","weather"],k:[6,3],o:2},scales:{a:"Scales",b:"2696-FE0F",c:"2696",d:!0,e:!0,f:!0,h:!0,k:[53,45],o:2,j:["天平"]},"flag-pr":{a:"PuertoRicoFlag",b:"1F1F5-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[3,47],o:2,j:["波多黎各国旗"]},wind_blowing_face:{a:"WindBlowingFace",b:"1F32C-FE0F",c:"1F32C",d:!0,e:!0,f:!0,h:!0,k:[6,4],o:2,j:["吹气"]},"flag-ps":{a:"PalestinianTerritoriesFlag",b:"1F1F5-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[3,48],o:2,j:["巴勒斯坦领土旗"]},mermaid:{skin_variations:{"1F3FB":{unified:"1F9DC-1F3FB-200D-2640-FE0F",non_qualified:"1F9DC-1F3FB-200D-2640",image:"1f9dc-1f3fb-200d-2640-fe0f.png",sheet_x:50,sheet_y:35,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9DC-1F3FC-200D-2640-FE0F",non_qualified:"1F9DC-1F3FC-200D-2640",image:"1f9dc-1f3fc-200d-2640-fe0f.png",sheet_x:50,sheet_y:36,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9DC-1F3FD-200D-2640-FE0F",non_qualified:"1F9DC-1F3FD-200D-2640",image:"1f9dc-1f3fd-200d-2640-fe0f.png",sheet_x:50,sheet_y:37,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9DC-1F3FE-200D-2640-FE0F",non_qualified:"1F9DC-1F3FE-200D-2640",image:"1f9dc-1f3fe-200d-2640-fe0f.png",sheet_x:50,sheet_y:38,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9DC-1F3FF-200D-2640-FE0F",non_qualified:"1F9DC-1F3FF-200D-2640",image:"1f9dc-1f3ff-200d-2640-fe0f.png",sheet_x:50,sheet_y:39,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Mermaid",b:"1F9DC-200D-2640-FE0F",c:"1F9DC-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[50,34],o:5,j:["美人鱼"]},probing_cane:{a:"ProbingCane",b:"1F9AF",d:!0,e:!0,f:!0,h:!0,k:[43,3],o:12,j:["探测杆"]},large_green_square:{a:"LargeGreenSquare",b:"1F7E9",d:!0,e:!0,f:!0,h:!0,k:[37,12],o:12,j:["绿色正方形"]},"flag-pt":{a:"PortugalFlag",b:"1F1F5-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[3,49],o:2,j:["葡萄牙国旗"]},link:{a:"LinkSymbol",b:"1F517",d:!0,e:!0,f:!0,h:!0,j:["链接","环","网址","rings","url"],k:[27,51],o:2},large_blue_square:{a:"LargeBlueSquare",b:"1F7E6",d:!0,e:!0,f:!0,h:!0,k:[37,9],o:12,j:["蓝色正方形"]},elf:{skin_variations:{"1F3FB":{unified:"1F9DD-1F3FB",non_qualified:null,image:"1f9dd-1f3fb.png",sheet_x:51,sheet_y:8,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DD-1F3FB-200D-2642-FE0F"},"1F3FC":{unified:"1F9DD-1F3FC",non_qualified:null,image:"1f9dd-1f3fc.png",sheet_x:51,sheet_y:9,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DD-1F3FC-200D-2642-FE0F"},"1F3FD":{unified:"1F9DD-1F3FD",non_qualified:null,image:"1f9dd-1f3fd.png",sheet_x:51,sheet_y:10,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DD-1F3FD-200D-2642-FE0F"},"1F3FE":{unified:"1F9DD-1F3FE",non_qualified:null,image:"1f9dd-1f3fe.png",sheet_x:51,sheet_y:11,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DD-1F3FE-200D-2642-FE0F"},"1F3FF":{unified:"1F9DD-1F3FF",non_qualified:null,image:"1f9dd-1f3ff.png",sheet_x:51,sheet_y:12,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DD-1F3FF-200D-2642-FE0F"}},obsoleted_by:"1F9DD-200D-2642-FE0F",a:"Elf",b:"1F9DD",d:!0,e:!0,f:!0,h:!0,k:[51,7],o:5,j:["小精灵"]},cyclone:{a:"Cyclone",b:"1F300",d:!0,e:!0,f:!0,h:!0,j:["气旋","天气","旋流","蓝","云","旋涡","螺旋","漩涡","纺","龙卷风","飓风","台风","weather","swirl","blue","cloud","vortex","spiral","whirlpool","spin","tornado","hurricane","typhoon"],k:[5,19],o:2},rainbow:{a:"Rainbow",b:"1F308",d:!0,e:!0,f:!0,h:!0,j:["彩虹","自然界","快乐","unicorn_face","相片","天空","春天","nature","happy","unicorn_face","photo","sky","spring"],k:[5,27],o:2},male_elf:{skin_variations:{"1F3FB":{unified:"1F9DD-1F3FB-200D-2642-FE0F",non_qualified:"1F9DD-1F3FB-200D-2642",image:"1f9dd-1f3fb-200d-2642-fe0f.png",sheet_x:51,sheet_y:2,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DD-1F3FB"},"1F3FC":{unified:"1F9DD-1F3FC-200D-2642-FE0F",non_qualified:"1F9DD-1F3FC-200D-2642",image:"1f9dd-1f3fc-200d-2642-fe0f.png",sheet_x:51,sheet_y:3,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DD-1F3FC"},"1F3FD":{unified:"1F9DD-1F3FD-200D-2642-FE0F",non_qualified:"1F9DD-1F3FD-200D-2642",image:"1f9dd-1f3fd-200d-2642-fe0f.png",sheet_x:51,sheet_y:4,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DD-1F3FD"},"1F3FE":{unified:"1F9DD-1F3FE-200D-2642-FE0F",non_qualified:"1F9DD-1F3FE-200D-2642",image:"1f9dd-1f3fe-200d-2642-fe0f.png",sheet_x:51,sheet_y:5,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DD-1F3FE"},"1F3FF":{unified:"1F9DD-1F3FF-200D-2642-FE0F",non_qualified:"1F9DD-1F3FF-200D-2642",image:"1f9dd-1f3ff-200d-2642-fe0f.png",sheet_x:51,sheet_y:6,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DD-1F3FF"}},obsoletes:"1F9DD",a:"MaleElf",b:"1F9DD-200D-2642-FE0F",c:"1F9DD-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[51,1],o:5,j:["男精灵"]},"flag-pw":{a:"PalauFlag",b:"1F1F5-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[3,50],o:2,j:["帕劳国旗"]},chains:{a:"Chains",b:"26D3-FE0F",c:"26D3",d:!0,e:!0,f:!0,h:!0,j:["链","锁","逮捕","lock","arrest"],k:[54,7],o:2},large_purple_square:{a:"LargePurpleSquare",b:"1F7EA",d:!0,e:!0,f:!0,h:!0,k:[37,13],o:12,j:["紫色正方形"]},female_elf:{skin_variations:{"1F3FB":{unified:"1F9DD-1F3FB-200D-2640-FE0F",non_qualified:"1F9DD-1F3FB-200D-2640",image:"1f9dd-1f3fb-200d-2640-fe0f.png",sheet_x:50,sheet_y:53,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9DD-1F3FC-200D-2640-FE0F",non_qualified:"1F9DD-1F3FC-200D-2640",image:"1f9dd-1f3fc-200d-2640-fe0f.png",sheet_x:50,sheet_y:54,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9DD-1F3FD-200D-2640-FE0F",non_qualified:"1F9DD-1F3FD-200D-2640",image:"1f9dd-1f3fd-200d-2640-fe0f.png",sheet_x:50,sheet_y:55,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9DD-1F3FE-200D-2640-FE0F",non_qualified:"1F9DD-1F3FE-200D-2640",image:"1f9dd-1f3fe-200d-2640-fe0f.png",sheet_x:50,sheet_y:56,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9DD-1F3FF-200D-2640-FE0F",non_qualified:"1F9DD-1F3FF-200D-2640",image:"1f9dd-1f3ff-200d-2640-fe0f.png",sheet_x:51,sheet_y:0,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleElf",b:"1F9DD-200D-2640-FE0F",c:"1F9DD-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[50,52],o:5,j:["女精灵"]},"flag-py":{a:"ParaguayFlag",b:"1F1F5-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[3,51],o:2,j:["巴拉圭国旗"]},closed_umbrella:{a:"ClosedUmbrella",b:"1F302",d:!0,e:!0,f:!0,h:!0,j:["关闭的伞","天气","雨","细雨","weather","rain","drizzle"],k:[5,21],o:2},toolbox:{a:"Toolbox",b:"1F9F0",d:!0,e:!0,f:!0,h:!0,k:[51,35],o:11,j:["工具箱"]},large_brown_square:{a:"LargeBrownSquare",b:"1F7EB",d:!0,e:!0,f:!0,h:!0,k:[37,14],o:12,j:["棕色正方形"]},magnet:{a:"Magnet",b:"1F9F2",d:!0,e:!0,f:!0,h:!0,k:[51,37],o:11,j:["磁铁"]},genie:{obsoleted_by:"1F9DE-200D-2642-FE0F",a:"Genie",b:"1F9DE",d:!0,e:!0,f:!0,h:!0,k:[51,15],o:5,j:["神灯精灵"]},"flag-qa":{a:"QatarFlag",b:"1F1F6-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[3,52],o:2,j:["卡塔尔国旗"]},umbrella:{a:"Umbrella",b:"2602-FE0F",c:"2602",d:!0,e:!0,f:!0,h:!0,j:["雨伞","雨","天气","春天","rainy","weather","spring"],k:[52,51],o:2},black_large_square:{a:"BlackLargeSquare",b:"2B1B",d:!0,e:!0,f:!0,h:!0,j:["黑色大正方形","形状","图标","按钮","shape","icon","button"],k:[55,40],o:2},male_genie:{obsoletes:"1F9DE",a:"MaleGenie",b:"1F9DE-200D-2642-FE0F",c:"1F9DE-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[51,14],o:5,j:["男神灯精灵"]},umbrella_with_rain_drops:{a:"UmbrellawithRainDrops",b:"2614",d:!0,e:!0,f:!0,h:!0,k:[52,56],o:2,j:["雨中的伞"]},"flag-re":{a:"RéunionFlag",b:"1F1F7-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[3,53],o:2,j:["留尼汪国旗"]},white_large_square:{a:"WhiteLargeSquare",b:"2B1C",d:!0,e:!0,f:!0,h:!0,j:["白色的大正方形","形状","图标","石头","按钮","shape","icon","stone","button"],k:[55,41],o:2},alembic:{a:"Alembic",b:"2697-FE0F",c:"2697",d:!0,e:!0,f:!0,h:!0,j:["蒸馏器","蒸馏","科学","实验","化学","distilling","science","experiment","chemistry"],k:[53,46],o:2},black_medium_square:{a:"BlackMediumSquare",b:"25FC-FE0F",c:"25FC",d:!0,e:!0,f:!0,h:!0,j:["中等黑色正方形","形状","按钮","图标","shape","button","icon"],k:[52,46],o:2},test_tube:{a:"TestTube",b:"1F9EA",d:!0,e:!0,f:!0,h:!0,k:[51,29],o:11,j:["试管"]},"flag-ro":{a:"RomaniaFlag",b:"1F1F7-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[3,54],o:2,j:["罗马尼亚国旗"]},female_genie:{a:"FemaleGenie",b:"1F9DE-200D-2640-FE0F",c:"1F9DE-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[51,13],o:5,j:["女神灯精灵"]},umbrella_on_ground:{a:"UmbrellaonGround",b:"26F1-FE0F",c:"26F1",d:!0,e:!0,f:!0,h:!0,k:[54,12],o:2,j:["伞放地面"]},zombie:{obsoleted_by:"1F9DF-200D-2642-FE0F",a:"Zombie",b:"1F9DF",d:!0,e:!0,f:!0,h:!0,k:[51,18],o:5,j:["僵尸"]},zap:{a:"HighVoltageSign",b:"26A1",d:!0,e:!0,f:!0,h:!0,j:["高电压","雷","天气","闪电螺栓","几乎","thunder","weather","lightningbolt","fast"],k:[53,51],o:2},white_medium_square:{a:"WhiteMediumSquare",b:"25FB-FE0F",c:"25FB",d:!0,e:!0,f:!0,h:!0,j:["中等白色正方形","形状","石头","图标","shape","stone","icon"],k:[52,45],o:2},"flag-rs":{a:"SerbiaFlag",b:"1F1F7-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[3,55],o:2,j:["塞尔维亚国旗"]},petri_dish:{a:"PetriDish",b:"1F9EB",d:!0,e:!0,f:!0,h:!0,k:[51,30],o:11,j:["培养皿"]},snowflake:{a:"Snowflake",b:"2744-FE0F",c:"2744",d:!0,e:!0,f:!0,h:!0,j:["雪花","冬","季节","冷","天气","圣诞节","圣诞","winter","season","cold","weather","christmas","xmas"],k:[55,19],o:2},dna:{a:"DnaDoubleHelix",b:"1F9EC",d:!0,e:!0,f:!0,h:!0,k:[51,31],o:11,j:["去氧核糖核酸"]},male_zombie:{obsoletes:"1F9DF",a:"MaleZombie",b:"1F9DF-200D-2642-FE0F",c:"1F9DF-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[51,17],o:5,j:["男僵尸"]},black_medium_small_square:{a:"BlackMediumSmallSquare",b:"25FE",d:!0,e:!0,f:!0,h:!0,j:["黑中小正方形","图标","形状","按钮","icon","shape","button"],k:[52,48],o:2},ru:{a:"RussiaFlag",b:"1F1F7-1F1FA",d:!0,e:!0,f:!0,h:!0,j:["俄罗斯国旗","俄语","联邦","旗","国家","国家","旗帜","russian","federation","flag","nation","country","banner"],k:[3,56],n:["flag-ru"],o:2},female_zombie:{a:"FemaleZombie",b:"1F9DF-200D-2640-FE0F",c:"1F9DF-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[51,16],o:5,j:["女僵尸"]},"flag-rw":{a:"RwandaFlag",b:"1F1F7-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[4,0],o:2,j:["卢旺达国旗"]},snowman:{a:"Snowman",b:"2603-FE0F",c:"2603",d:!0,e:!0,f:!0,h:!0,j:["雪人","冬","季节","冷","天气","圣诞节","圣诞","冷冻","without_snow","winter","season","cold","weather","christmas","xmas","frozen","without_snow"],k:[52,52],o:2},white_medium_small_square:{a:"WhiteMediumSmallSquare",b:"25FD",d:!0,e:!0,f:!0,h:!0,j:["白色中小正方","形状","石头","图标","按钮","shape","stone","icon","button"],k:[52,47],o:2},microscope:{a:"Microscope",b:"1F52C",d:!0,e:!0,f:!0,h:!0,j:["显微镜","实验室","实验","放大","科学","研究","laboratory","experiment","zoomin","science","study"],k:[28,15],o:2},snowman_without_snow:{a:"SnowmanWithoutSnow",b:"26C4",d:!0,e:!0,f:!0,h:!0,k:[54,1],o:2,j:["雪人（没下雪）"]},telescope:{a:"Telescope",b:"1F52D",d:!0,e:!0,f:!0,h:!0,j:["望远镜","星星","空间","缩放","科学","天文学","stars","space","zoom","science","astronomy"],k:[28,16],o:2},massage:{skin_variations:{"1F3FB":{unified:"1F486-1F3FB",non_qualified:null,image:"1f486-1f3fb.png",sheet_x:24,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F486-1F3FC",non_qualified:null,image:"1f486-1f3fc.png",sheet_x:24,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F486-1F3FD",non_qualified:null,image:"1f486-1f3fd.png",sheet_x:24,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F486-1F3FE",non_qualified:null,image:"1f486-1f3fe.png",sheet_x:24,sheet_y:55,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F486-1F3FF",non_qualified:null,image:"1f486-1f3ff.png",sheet_x:24,sheet_y:56,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F486-200D-2640-FE0F",a:"FaceMassage",b:"1F486",d:!0,e:!0,f:!0,h:!1,k:[24,51],o:2,j:["按摩中的人"]},black_small_square:{a:"BlackSmallSquare",b:"25AA-FE0F",c:"25AA",d:!0,e:!0,f:!0,h:!0,j:["黑色小正方形","形状","图标","shape","icon"],k:[52,41],o:2},"flag-sa":{a:"SaudiArabiaFlag",b:"1F1F8-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[4,1],o:2,j:["沙特阿拉伯国旗"]},"man-getting-massage":{skin_variations:{"1F3FB":{unified:"1F486-1F3FB-200D-2642-FE0F",non_qualified:"1F486-1F3FB-200D-2642",image:"1f486-1f3fb-200d-2642-fe0f.png",sheet_x:24,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F486-1F3FC-200D-2642-FE0F",non_qualified:"1F486-1F3FC-200D-2642",image:"1f486-1f3fc-200d-2642-fe0f.png",sheet_x:24,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F486-1F3FD-200D-2642-FE0F",non_qualified:"1F486-1F3FD-200D-2642",image:"1f486-1f3fd-200d-2642-fe0f.png",sheet_x:24,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F486-1F3FE-200D-2642-FE0F",non_qualified:"1F486-1F3FE-200D-2642",image:"1f486-1f3fe-200d-2642-fe0f.png",sheet_x:24,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F486-1F3FF-200D-2642-FE0F",non_qualified:"1F486-1F3FF-200D-2642",image:"1f486-1f3ff-200d-2642-fe0f.png",sheet_x:24,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManGettingMassage",b:"1F486-200D-2642-FE0F",c:"1F486-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[24,45],o:4,j:["按摩中的男子"]},comet:{a:"Comet",b:"2604-FE0F",c:"2604",d:!0,e:!0,f:!0,h:!0,j:["彗星","空间","space"],k:[52,53],o:2},white_small_square:{a:"WhiteSmallSquare",b:"25AB-FE0F",c:"25AB",d:!0,e:!0,f:!0,h:!0,j:["白色的小正方形","形状","图标","shape","icon"],k:[52,42],o:2},"flag-sb":{a:"SolomonIslandsFlag",b:"1F1F8-1F1E7",d:!0,e:!0,f:!0,h:!0,k:[4,2],o:2,j:["所罗门群岛旗"]},satellite_antenna:{a:"SatelliteAntenna",b:"1F4E1",d:!0,e:!0,f:!0,h:!0,k:[26,55],o:2,j:["卫星天线"]},large_orange_diamond:{a:"LargeOrangeDiamond",b:"1F536",d:!0,e:!0,f:!0,h:!0,j:["大橙色钻石","形状","宝石","宝石","shape","jewel","gem"],k:[28,25],o:2},"woman-getting-massage":{skin_variations:{"1F3FB":{unified:"1F486-1F3FB-200D-2640-FE0F",non_qualified:"1F486-1F3FB-200D-2640",image:"1f486-1f3fb-200d-2640-fe0f.png",sheet_x:24,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F486-1F3FC-200D-2640-FE0F",non_qualified:"1F486-1F3FC-200D-2640",image:"1f486-1f3fc-200d-2640-fe0f.png",sheet_x:24,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F486-1F3FD-200D-2640-FE0F",non_qualified:"1F486-1F3FD-200D-2640",image:"1f486-1f3fd-200d-2640-fe0f.png",sheet_x:24,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F486-1F3FE-200D-2640-FE0F",non_qualified:"1F486-1F3FE-200D-2640",image:"1f486-1f3fe-200d-2640-fe0f.png",sheet_x:24,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F486-1F3FF-200D-2640-FE0F",non_qualified:"1F486-1F3FF-200D-2640",image:"1f486-1f3ff-200d-2640-fe0f.png",sheet_x:24,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F486",a:"WomanGettingMassage",b:"1F486-200D-2640-FE0F",c:"1F486-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[24,39],o:4,j:["按摩中的女子"]},fire:{a:"Fire",b:"1F525",d:!0,e:!0,f:!0,h:!0,j:["火","热","煮","火焰","hot","cook","flame"],k:[28,8],o:2},syringe:{a:"Syringe",b:"1F489",d:!0,e:!0,f:!0,h:!0,j:["注射器","健康","医院","药物","血","药","针","医生","护士","health","hospital","drugs","blood","medicine","needle","doctor","nurse"],k:[25,19],o:2},"flag-sc":{a:"SeychellesFlag",b:"1F1F8-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[4,3],o:2,j:["塞舌尔国旗"]},large_blue_diamond:{a:"LargeBlueDiamond",b:"1F537",d:!0,e:!0,f:!0,h:!0,j:["大蓝钻石","形状","宝石","宝石","shape","jewel","gem"],k:[28,26],o:2},"flag-sd":{a:"SudanFlag",b:"1F1F8-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[4,4],o:2,j:["苏丹国旗"]},droplet:{a:"Droplet",b:"1F4A7",d:!0,e:!0,f:!0,h:!0,j:["水滴","水","滴","龙头","春天","water","drip","faucet","spring"],k:[25,49],o:2},drop_of_blood:{a:"DropofBlood",b:"1FA78",d:!0,e:!0,f:!0,h:!0,k:[51,55],o:12,j:["血滴"]},haircut:{skin_variations:{"1F3FB":{unified:"1F487-1F3FB",non_qualified:null,image:"1f487-1f3fb.png",sheet_x:25,sheet_y:13,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F487-1F3FC",non_qualified:null,image:"1f487-1f3fc.png",sheet_x:25,sheet_y:14,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F487-1F3FD",non_qualified:null,image:"1f487-1f3fd.png",sheet_x:25,sheet_y:15,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F487-1F3FE",non_qualified:null,image:"1f487-1f3fe.png",sheet_x:25,sheet_y:16,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F487-1F3FF",non_qualified:null,image:"1f487-1f3ff.png",sheet_x:25,sheet_y:17,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F487-200D-2640-FE0F",a:"Haircut",b:"1F487",d:!0,e:!0,f:!0,h:!1,k:[25,12],o:2,j:["理发中的人"]},ocean:{a:"WaterWave",b:"1F30A",d:!0,e:!0,f:!0,h:!0,j:["波浪","海","水","浪","自然界","海啸","灾难","sea","water","wave","nature","tsunami","disaster"],k:[5,29],o:2},"flag-se":{a:"SwedenFlag",b:"1F1F8-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[4,5],o:2,j:["瑞典国旗"]},"man-getting-haircut":{skin_variations:{"1F3FB":{unified:"1F487-1F3FB-200D-2642-FE0F",non_qualified:"1F487-1F3FB-200D-2642",image:"1f487-1f3fb-200d-2642-fe0f.png",sheet_x:25,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F487-1F3FC-200D-2642-FE0F",non_qualified:"1F487-1F3FC-200D-2642",image:"1f487-1f3fc-200d-2642-fe0f.png",sheet_x:25,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F487-1F3FD-200D-2642-FE0F",non_qualified:"1F487-1F3FD-200D-2642",image:"1f487-1f3fd-200d-2642-fe0f.png",sheet_x:25,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F487-1F3FE-200D-2642-FE0F",non_qualified:"1F487-1F3FE-200D-2642",image:"1f487-1f3fe-200d-2642-fe0f.png",sheet_x:25,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F487-1F3FF-200D-2642-FE0F",non_qualified:"1F487-1F3FF-200D-2642",image:"1f487-1f3ff-200d-2642-fe0f.png",sheet_x:25,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManGettingHaircut",b:"1F487-200D-2642-FE0F",c:"1F487-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[25,6],o:4,j:["理发中的男子"]},small_orange_diamond:{a:"SmallOrangeDiamond",b:"1F538",d:!0,e:!0,f:!0,h:!0,j:["小橙钻石","形状","宝石","宝石","shape","jewel","gem"],k:[28,27],o:2},pill:{a:"Pill",b:"1F48A",d:!0,e:!0,f:!0,h:!0,j:["药丸","健康","药","医生","药房","药","health","medicine","doctor","pharmacy","drug"],k:[25,20],o:2},"woman-getting-haircut":{skin_variations:{"1F3FB":{unified:"1F487-1F3FB-200D-2640-FE0F",non_qualified:"1F487-1F3FB-200D-2640",image:"1f487-1f3fb-200d-2640-fe0f.png",sheet_x:25,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F487-1F3FC-200D-2640-FE0F",non_qualified:"1F487-1F3FC-200D-2640",image:"1f487-1f3fc-200d-2640-fe0f.png",sheet_x:25,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F487-1F3FD-200D-2640-FE0F",non_qualified:"1F487-1F3FD-200D-2640",image:"1f487-1f3fd-200d-2640-fe0f.png",sheet_x:25,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F487-1F3FE-200D-2640-FE0F",non_qualified:"1F487-1F3FE-200D-2640",image:"1f487-1f3fe-200d-2640-fe0f.png",sheet_x:25,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F487-1F3FF-200D-2640-FE0F",non_qualified:"1F487-1F3FF-200D-2640",image:"1f487-1f3ff-200d-2640-fe0f.png",sheet_x:25,sheet_y:5,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F487",a:"WomanGettingHaircut",b:"1F487-200D-2640-FE0F",c:"1F487-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[25,0],o:4,j:["理发中的女子"]},small_blue_diamond:{a:"SmallBlueDiamond",b:"1F539",d:!0,e:!0,f:!0,h:!0,j:["小蓝钻石","形状","宝石","宝石","shape","jewel","gem"],k:[28,28],o:2},"flag-sg":{a:"SingaporeFlag",b:"1F1F8-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[4,6],o:2,j:["新加坡国旗"]},adhesive_bandage:{a:"AdhesiveBandage",b:"1FA79",d:!0,e:!0,f:!0,h:!0,k:[51,56],o:12,j:["创可贴"]},walking:{skin_variations:{"1F3FB":{unified:"1F6B6-1F3FB",non_qualified:null,image:"1f6b6-1f3fb.png",sheet_x:36,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F6B6-1F3FC",non_qualified:null,image:"1f6b6-1f3fc.png",sheet_x:36,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F6B6-1F3FD",non_qualified:null,image:"1f6b6-1f3fd.png",sheet_x:36,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F6B6-1F3FE",non_qualified:null,image:"1f6b6-1f3fe.png",sheet_x:36,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F6B6-1F3FF",non_qualified:null,image:"1f6b6-1f3ff.png",sheet_x:36,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F6B6-200D-2642-FE0F",a:"Pedestrian",b:"1F6B6",d:!0,e:!0,f:!0,h:!1,k:[36,2],o:2,j:["步行的人"]},small_red_triangle:{a:"Up-PointingRedTriangle",b:"1F53A",d:!0,e:!0,f:!0,h:!0,j:["红色三角形朝上","形状","方向","向上","返回页首","shape","direction","up","top"],k:[28,29],o:2},"flag-sh":{a:"St.HelenaFlag",b:"1F1F8-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[4,7],o:2,j:["圣赫勒拿国旗"]},stethoscope:{a:"Stethoscope",b:"1FA7A",d:!0,e:!0,f:!0,h:!0,k:[52,0],o:12,j:["听筒"]},"man-walking":{skin_variations:{"1F3FB":{unified:"1F6B6-1F3FB-200D-2642-FE0F",non_qualified:"1F6B6-1F3FB-200D-2642",image:"1f6b6-1f3fb-200d-2642-fe0f.png",sheet_x:35,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6B6-1F3FC-200D-2642-FE0F",non_qualified:"1F6B6-1F3FC-200D-2642",image:"1f6b6-1f3fc-200d-2642-fe0f.png",sheet_x:35,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6B6-1F3FD-200D-2642-FE0F",non_qualified:"1F6B6-1F3FD-200D-2642",image:"1f6b6-1f3fd-200d-2642-fe0f.png",sheet_x:35,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6B6-1F3FE-200D-2642-FE0F",non_qualified:"1F6B6-1F3FE-200D-2642",image:"1f6b6-1f3fe-200d-2642-fe0f.png",sheet_x:36,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6B6-1F3FF-200D-2642-FE0F",non_qualified:"1F6B6-1F3FF-200D-2642",image:"1f6b6-1f3ff-200d-2642-fe0f.png",sheet_x:36,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F6B6",a:"ManWalking",b:"1F6B6-200D-2642-FE0F",c:"1F6B6-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[35,53],o:4,j:["步行的男子"]},"flag-si":{a:"SloveniaFlag",b:"1F1F8-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[4,8],o:2,j:["斯洛文尼亚国旗"]},door:{a:"Door",b:"1F6AA",d:!0,e:!0,f:!0,h:!0,j:["门","房子","进入","退出","house","entry","exit"],k:[35,1],o:2},small_red_triangle_down:{a:"Down-PointingRedTriangle",b:"1F53B",d:!0,e:!0,f:!0,h:!0,j:["红色三角形朝下","形状","方向","底","shape","direction","bottom"],k:[28,30],o:2},"flag-sj":{a:"Svalbard&JanMayenFlag",b:"1F1F8-1F1EF",d:!0,e:!0,f:!0,h:!0,k:[4,9],o:2,j:["斯瓦尔巴和扬马延旗"]},diamond_shape_with_a_dot_inside:{a:"DiamondShapewithaDotInside",b:"1F4A0",d:!0,e:!0,f:!0,h:!0,j:["带有点的钻石","宝石","蓝","宝石","晶体","看中","jewel","blue","gem","crystal","fancy"],k:[25,42],o:2},"woman-walking":{skin_variations:{"1F3FB":{unified:"1F6B6-1F3FB-200D-2640-FE0F",non_qualified:"1F6B6-1F3FB-200D-2640",image:"1f6b6-1f3fb-200d-2640-fe0f.png",sheet_x:35,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6B6-1F3FC-200D-2640-FE0F",non_qualified:"1F6B6-1F3FC-200D-2640",image:"1f6b6-1f3fc-200d-2640-fe0f.png",sheet_x:35,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6B6-1F3FD-200D-2640-FE0F",non_qualified:"1F6B6-1F3FD-200D-2640",image:"1f6b6-1f3fd-200d-2640-fe0f.png",sheet_x:35,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6B6-1F3FE-200D-2640-FE0F",non_qualified:"1F6B6-1F3FE-200D-2640",image:"1f6b6-1f3fe-200d-2640-fe0f.png",sheet_x:35,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6B6-1F3FF-200D-2640-FE0F",non_qualified:"1F6B6-1F3FF-200D-2640",image:"1f6b6-1f3ff-200d-2640-fe0f.png",sheet_x:35,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanWalking",b:"1F6B6-200D-2640-FE0F",c:"1F6B6-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[35,47],o:4,j:["步行的女子"]},bed:{a:"Bed",b:"1F6CF-FE0F",c:"1F6CF",d:!0,e:!0,f:!0,h:!0,j:["床","睡","休息","sleep","rest"],k:[36,37],o:2},radio_button:{a:"RadioButton",b:"1F518",d:!0,e:!0,f:!0,h:!0,j:["单选按钮","输入","老","音乐","圈","input","old","music","circle"],k:[27,52],o:2},"flag-sk":{a:"SlovakiaFlag",b:"1F1F8-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[4,10],o:2,j:["斯洛伐克国旗"]},standing_person:{skin_variations:{"1F3FB":{unified:"1F9CD-1F3FB",non_qualified:null,image:"1f9cd-1f3fb.png",sheet_x:44,sheet_y:32,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CD-1F3FC",non_qualified:null,image:"1f9cd-1f3fc.png",sheet_x:44,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CD-1F3FD",non_qualified:null,image:"1f9cd-1f3fd.png",sheet_x:44,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CD-1F3FE",non_qualified:null,image:"1f9cd-1f3fe.png",sheet_x:44,sheet_y:35,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CD-1F3FF",non_qualified:null,image:"1f9cd-1f3ff.png",sheet_x:44,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"StandingPerson",b:"1F9CD",d:!0,e:!0,f:!0,h:!0,k:[44,31],o:12,j:["站立的人"]},couch_and_lamp:{a:"CouchandLamp",b:"1F6CB-FE0F",c:"1F6CB",d:!0,e:!0,f:!0,h:!0,j:["沙发和灯","读","寒意","read","chill"],k:[36,28],o:2},man_standing:{skin_variations:{"1F3FB":{unified:"1F9CD-1F3FB-200D-2642-FE0F",non_qualified:"1F9CD-1F3FB-200D-2642",image:"1f9cd-1f3fb-200d-2642-fe0f.png",sheet_x:44,sheet_y:26,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CD-1F3FC-200D-2642-FE0F",non_qualified:"1F9CD-1F3FC-200D-2642",image:"1f9cd-1f3fc-200d-2642-fe0f.png",sheet_x:44,sheet_y:27,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CD-1F3FD-200D-2642-FE0F",non_qualified:"1F9CD-1F3FD-200D-2642",image:"1f9cd-1f3fd-200d-2642-fe0f.png",sheet_x:44,sheet_y:28,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CD-1F3FE-200D-2642-FE0F",non_qualified:"1F9CD-1F3FE-200D-2642",image:"1f9cd-1f3fe-200d-2642-fe0f.png",sheet_x:44,sheet_y:29,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CD-1F3FF-200D-2642-FE0F",non_qualified:"1F9CD-1F3FF-200D-2642",image:"1f9cd-1f3ff-200d-2642-fe0f.png",sheet_x:44,sheet_y:30,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManStanding",b:"1F9CD-200D-2642-FE0F",c:"1F9CD-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[44,25],o:12,j:["站立的男子"]},white_square_button:{a:"WhiteSquareButton",b:"1F533",d:!0,e:!0,f:!0,h:!0,j:["白色方形按钮","形状","输入","shape","input"],k:[28,22],o:2},"flag-sl":{a:"SierraLeoneFlag",b:"1F1F8-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[4,11],o:2,j:["塞拉利昂国旗"]},chair:{a:"Chair",b:"1FA91",d:!0,e:!0,f:!0,h:!0,k:[52,5],o:12,j:["椅子"]},toilet:{a:"Toilet",b:"1F6BD",d:!0,e:!0,f:!0,h:!0,j:["马桶","厕所","厕所","盥洗室","浴室","便盆","restroom","wc","washroom","bathroom","potty"],k:[36,14],o:2},black_square_button:{a:"BlackSquareButton",b:"1F532",d:!0,e:!0,f:!0,h:!0,j:["黑色方形按钮","形状","输入","框架","shape","input","frame"],k:[28,21],o:2},"flag-sm":{a:"SanMarinoFlag",b:"1F1F8-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[4,12],o:2,j:["圣马力诺国旗"]},woman_standing:{skin_variations:{"1F3FB":{unified:"1F9CD-1F3FB-200D-2640-FE0F",non_qualified:"1F9CD-1F3FB-200D-2640",image:"1f9cd-1f3fb-200d-2640-fe0f.png",sheet_x:44,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CD-1F3FC-200D-2640-FE0F",non_qualified:"1F9CD-1F3FC-200D-2640",image:"1f9cd-1f3fc-200d-2640-fe0f.png",sheet_x:44,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CD-1F3FD-200D-2640-FE0F",non_qualified:"1F9CD-1F3FD-200D-2640",image:"1f9cd-1f3fd-200d-2640-fe0f.png",sheet_x:44,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CD-1F3FE-200D-2640-FE0F",non_qualified:"1F9CD-1F3FE-200D-2640",image:"1f9cd-1f3fe-200d-2640-fe0f.png",sheet_x:44,sheet_y:23,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CD-1F3FF-200D-2640-FE0F",non_qualified:"1F9CD-1F3FF-200D-2640",image:"1f9cd-1f3ff-200d-2640-fe0f.png",sheet_x:44,sheet_y:24,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanStanding",b:"1F9CD-200D-2640-FE0F",c:"1F9CD-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[44,19],o:12,j:["站立的女子"]},kneeling_person:{skin_variations:{"1F3FB":{unified:"1F9CE-1F3FB",non_qualified:null,image:"1f9ce-1f3fb.png",sheet_x:44,sheet_y:50,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CE-1F3FC",non_qualified:null,image:"1f9ce-1f3fc.png",sheet_x:44,sheet_y:51,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CE-1F3FD",non_qualified:null,image:"1f9ce-1f3fd.png",sheet_x:44,sheet_y:52,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CE-1F3FE",non_qualified:null,image:"1f9ce-1f3fe.png",sheet_x:44,sheet_y:53,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CE-1F3FF",non_qualified:null,image:"1f9ce-1f3ff.png",sheet_x:44,sheet_y:54,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"KneelingPerson",b:"1F9CE",d:!0,e:!0,f:!0,h:!0,k:[44,49],o:12,j:["跪下的人"]},shower:{a:"Shower",b:"1F6BF",d:!0,e:!0,f:!0,h:!0,j:["淋浴","干净","水","浴室","clean","water","bathroom"],k:[36,16],o:2},"flag-sn":{a:"SenegalFlag",b:"1F1F8-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[4,13],o:2,j:["塞内加尔国旗"]},bathtub:{a:"Bathtub",b:"1F6C1",d:!0,e:!0,f:!0,h:!0,j:["浴缸","干净","淋浴","浴室","clean","shower","bathroom"],k:[36,23],o:2},"flag-so":{a:"SomaliaFlag",b:"1F1F8-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[4,14],o:2,j:["索马里亚国旗"]},man_kneeling:{skin_variations:{"1F3FB":{unified:"1F9CE-1F3FB-200D-2642-FE0F",non_qualified:"1F9CE-1F3FB-200D-2642",image:"1f9ce-1f3fb-200d-2642-fe0f.png",sheet_x:44,sheet_y:44,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CE-1F3FC-200D-2642-FE0F",non_qualified:"1F9CE-1F3FC-200D-2642",image:"1f9ce-1f3fc-200d-2642-fe0f.png",sheet_x:44,sheet_y:45,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CE-1F3FD-200D-2642-FE0F",non_qualified:"1F9CE-1F3FD-200D-2642",image:"1f9ce-1f3fd-200d-2642-fe0f.png",sheet_x:44,sheet_y:46,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CE-1F3FE-200D-2642-FE0F",non_qualified:"1F9CE-1F3FE-200D-2642",image:"1f9ce-1f3fe-200d-2642-fe0f.png",sheet_x:44,sheet_y:47,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CE-1F3FF-200D-2642-FE0F",non_qualified:"1F9CE-1F3FF-200D-2642",image:"1f9ce-1f3ff-200d-2642-fe0f.png",sheet_x:44,sheet_y:48,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManKneeling",b:"1F9CE-200D-2642-FE0F",c:"1F9CE-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[44,43],o:12,j:["跪下的男子"]},"flag-sr":{a:"SurinameFlag",b:"1F1F8-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[4,15],o:2,j:["苏里南国旗"]},woman_kneeling:{skin_variations:{"1F3FB":{unified:"1F9CE-1F3FB-200D-2640-FE0F",non_qualified:"1F9CE-1F3FB-200D-2640",image:"1f9ce-1f3fb-200d-2640-fe0f.png",sheet_x:44,sheet_y:38,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CE-1F3FC-200D-2640-FE0F",non_qualified:"1F9CE-1F3FC-200D-2640",image:"1f9ce-1f3fc-200d-2640-fe0f.png",sheet_x:44,sheet_y:39,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CE-1F3FD-200D-2640-FE0F",non_qualified:"1F9CE-1F3FD-200D-2640",image:"1f9ce-1f3fd-200d-2640-fe0f.png",sheet_x:44,sheet_y:40,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CE-1F3FE-200D-2640-FE0F",non_qualified:"1F9CE-1F3FE-200D-2640",image:"1f9ce-1f3fe-200d-2640-fe0f.png",sheet_x:44,sheet_y:41,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CE-1F3FF-200D-2640-FE0F",non_qualified:"1F9CE-1F3FF-200D-2640",image:"1f9ce-1f3ff-200d-2640-fe0f.png",sheet_x:44,sheet_y:42,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanKneeling",b:"1F9CE-200D-2640-FE0F",c:"1F9CE-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[44,37],o:12,j:["跪下的女子"]},razor:{a:"Razor",b:"1FA92",d:!0,e:!0,f:!0,h:!0,k:[52,6],o:12,j:["剃刀"]},person_with_probing_cane:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9AF",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9af.png",sheet_x:47,sheet_y:8,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9AF",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9af.png",sheet_x:47,sheet_y:9,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9AF",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9af.png",sheet_x:47,sheet_y:10,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9AF",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9af.png",sheet_x:47,sheet_y:11,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9AF",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9af.png",sheet_x:47,sheet_y:12,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"PersonwithProbingCane",b:"1F9D1-200D-1F9AF",d:!0,e:!1,f:!1,h:!1,k:[47,7],o:12,j:["拄盲杖的人"]},"flag-ss":{a:"SouthSudanFlag",b:"1F1F8-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[4,16],o:2,j:["南苏丹国旗"]},lotion_bottle:{a:"LotionBottle",b:"1F9F4",d:!0,e:!0,f:!0,h:!0,k:[51,39],o:11,j:["乳液"]},"flag-st":{a:"SãoTomé&PríncipeFlag",b:"1F1F8-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[4,17],o:2,j:["圣多美和普林西比国旗"]},safety_pin:{a:"SafetyPin",b:"1F9F7",d:!0,e:!0,f:!0,h:!0,k:[51,42],o:11,j:["安全别针"]},man_with_probing_cane:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9AF",non_qualified:null,image:"1f468-1f3fb-200d-1f9af.png",sheet_x:16,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9AF",non_qualified:null,image:"1f468-1f3fc-200d-1f9af.png",sheet_x:16,sheet_y:19,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9AF",non_qualified:null,image:"1f468-1f3fd-200d-1f9af.png",sheet_x:16,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9AF",non_qualified:null,image:"1f468-1f3fe-200d-1f9af.png",sheet_x:16,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9AF",non_qualified:null,image:"1f468-1f3ff-200d-1f9af.png",sheet_x:16,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManwithProbingCane",b:"1F468-200D-1F9AF",d:!0,e:!0,f:!0,h:!0,k:[16,17],o:12,j:["男人拿着导盲杆"]},broom:{a:"Broom",b:"1F9F9",d:!0,e:!0,f:!0,h:!0,k:[51,44],o:11,j:["扫帚"]},woman_with_probing_cane:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9AF",non_qualified:null,image:"1f469-1f3fb-200d-1f9af.png",sheet_x:19,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9AF",non_qualified:null,image:"1f469-1f3fc-200d-1f9af.png",sheet_x:19,sheet_y:4,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9AF",non_qualified:null,image:"1f469-1f3fd-200d-1f9af.png",sheet_x:19,sheet_y:5,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9AF",non_qualified:null,image:"1f469-1f3fe-200d-1f9af.png",sheet_x:19,sheet_y:6,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9AF",non_qualified:null,image:"1f469-1f3ff-200d-1f9af.png",sheet_x:19,sheet_y:7,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanwithProbingCane",b:"1F469-200D-1F9AF",d:!0,e:!0,f:!0,h:!0,k:[19,2],o:12,j:["女人拿着导盲杆"]},"flag-sv":{a:"ElSalvadorFlag",b:"1F1F8-1F1FB",d:!0,e:!0,f:!0,h:!0,k:[4,18],o:2,j:["萨尔瓦多国旗"]},"flag-sx":{a:"SintMaartenFlag",b:"1F1F8-1F1FD",d:!0,e:!0,f:!0,h:!0,k:[4,19],o:2,j:["圣马丁岛旗"]},basket:{a:"Basket",b:"1F9FA",d:!0,e:!0,f:!0,h:!0,k:[51,45],o:11,j:["篮子"]},person_in_motorized_wheelchair:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9BC",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9bc.png",sheet_x:47,sheet_y:38,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9BC",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9bc.png",sheet_x:47,sheet_y:39,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9BC",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9bc.png",sheet_x:47,sheet_y:40,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9BC",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9bc.png",sheet_x:47,sheet_y:41,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9BC",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9bc.png",sheet_x:47,sheet_y:42,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"PersoninMotorizedWheelchair",b:"1F9D1-200D-1F9BC",d:!0,e:!1,f:!1,h:!1,k:[47,37],o:12,j:["坐电动轮椅的人"]},man_in_motorized_wheelchair:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9BC",non_qualified:null,image:"1f468-1f3fb-200d-1f9bc.png",sheet_x:16,sheet_y:48,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9BC",non_qualified:null,image:"1f468-1f3fc-200d-1f9bc.png",sheet_x:16,sheet_y:49,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9BC",non_qualified:null,image:"1f468-1f3fd-200d-1f9bc.png",sheet_x:16,sheet_y:50,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9BC",non_qualified:null,image:"1f468-1f3fe-200d-1f9bc.png",sheet_x:16,sheet_y:51,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9BC",non_qualified:null,image:"1f468-1f3ff-200d-1f9bc.png",sheet_x:16,sheet_y:52,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManinMotorizedWheelchair",b:"1F468-200D-1F9BC",d:!0,e:!0,f:!0,h:!0,k:[16,47],o:12,j:["男人乘坐电动轮椅"]},"flag-sy":{a:"SyriaFlag",b:"1F1F8-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[4,20],o:2,j:["叙利亚国旗"]},roll_of_paper:{a:"RollofPaper",b:"1F9FB",d:!0,e:!0,f:!0,h:!0,k:[51,46],o:11,j:["卷纸"]},woman_in_motorized_wheelchair:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9BC",non_qualified:null,image:"1f469-1f3fb-200d-1f9bc.png",sheet_x:19,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9BC",non_qualified:null,image:"1f469-1f3fc-200d-1f9bc.png",sheet_x:19,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9BC",non_qualified:null,image:"1f469-1f3fd-200d-1f9bc.png",sheet_x:19,sheet_y:35,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9BC",non_qualified:null,image:"1f469-1f3fe-200d-1f9bc.png",sheet_x:19,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9BC",non_qualified:null,image:"1f469-1f3ff-200d-1f9bc.png",sheet_x:19,sheet_y:37,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomaninMotorizedWheelchair",b:"1F469-200D-1F9BC",d:!0,e:!0,f:!0,h:!0,k:[19,32],o:12,j:["女人乘坐电动轮椅"]},"flag-sz":{a:"EswatiniFlag",b:"1F1F8-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[4,21],o:2,j:["史瓦帝尼国旗"]},soap:{a:"BarofSoap",b:"1F9FC",d:!0,e:!0,f:!0,h:!0,k:[51,47],o:11,j:["肥皂"]},"flag-ta":{a:"TristanDaCunhaFlag",b:"1F1F9-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[4,22],o:2,j:["特里斯坦-达库尼亚群岛旗"]},sponge:{a:"Sponge",b:"1F9FD",d:!0,e:!0,f:!0,h:!0,k:[51,48],o:11,j:["海绵"]},person_in_manual_wheelchair:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9BD",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9bd.png",sheet_x:47,sheet_y:44,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9BD",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9bd.png",sheet_x:47,sheet_y:45,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9BD",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9bd.png",sheet_x:47,sheet_y:46,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9BD",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9bd.png",sheet_x:47,sheet_y:47,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9BD",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9bd.png",sheet_x:47,sheet_y:48,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"PersoninManualWheelchair",b:"1F9D1-200D-1F9BD",d:!0,e:!1,f:!1,h:!1,k:[47,43],o:12,j:["坐手动轮椅的人"]},fire_extinguisher:{a:"FireExtinguisher",b:"1F9EF",d:!0,e:!0,f:!0,h:!0,k:[51,34],o:11,j:["灭火器"]},man_in_manual_wheelchair:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9BD",non_qualified:null,image:"1f468-1f3fb-200d-1f9bd.png",sheet_x:16,sheet_y:54,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9BD",non_qualified:null,image:"1f468-1f3fc-200d-1f9bd.png",sheet_x:16,sheet_y:55,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9BD",non_qualified:null,image:"1f468-1f3fd-200d-1f9bd.png",sheet_x:16,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9BD",non_qualified:null,image:"1f468-1f3fe-200d-1f9bd.png",sheet_x:17,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9BD",non_qualified:null,image:"1f468-1f3ff-200d-1f9bd.png",sheet_x:17,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManinManualWheelchair",b:"1F468-200D-1F9BD",d:!0,e:!0,f:!0,h:!0,k:[16,53],o:12,j:["男人推行轮椅"]},"flag-tc":{a:"Turks&CaicosIslandsFlag",b:"1F1F9-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[4,23],o:2,j:["特克斯和凯科斯群岛旗"]},woman_in_manual_wheelchair:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9BD",non_qualified:null,image:"1f469-1f3fb-200d-1f9bd.png",sheet_x:19,sheet_y:39,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9BD",non_qualified:null,image:"1f469-1f3fc-200d-1f9bd.png",sheet_x:19,sheet_y:40,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9BD",non_qualified:null,image:"1f469-1f3fd-200d-1f9bd.png",sheet_x:19,sheet_y:41,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9BD",non_qualified:null,image:"1f469-1f3fe-200d-1f9bd.png",sheet_x:19,sheet_y:42,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9BD",non_qualified:null,image:"1f469-1f3ff-200d-1f9bd.png",sheet_x:19,sheet_y:43,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomaninManualWheelchair",b:"1F469-200D-1F9BD",d:!0,e:!0,f:!0,h:!0,k:[19,38],o:12,j:["女人推行轮椅"]},"flag-td":{a:"ChadFlag",b:"1F1F9-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[4,24],o:2,j:["乍得国旗"]},shopping_trolley:{a:"ShoppingTrolley",b:"1F6D2",d:!0,e:!0,f:!0,h:!0,k:[36,40],o:4,j:["购物车"]},runner:{skin_variations:{"1F3FB":{unified:"1F3C3-1F3FB",non_qualified:null,image:"1f3c3-1f3fb.png",sheet_x:9,sheet_y:2,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F3C3-1F3FC",non_qualified:null,image:"1f3c3-1f3fc.png",sheet_x:9,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F3C3-1F3FD",non_qualified:null,image:"1f3c3-1f3fd.png",sheet_x:9,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F3C3-1F3FE",non_qualified:null,image:"1f3c3-1f3fe.png",sheet_x:9,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F3C3-1F3FF",non_qualified:null,image:"1f3c3-1f3ff.png",sheet_x:9,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F3C3-200D-2642-FE0F",a:"Runner",b:"1F3C3",d:!0,e:!0,f:!0,h:!1,k:[9,1],n:["running"],o:2,j:["奔跑的男人"]},"flag-tf":{a:"FrenchSouthernTerritoriesFlag",b:"1F1F9-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[4,25],o:2,j:["法属南部和南极领地旗"]},smoking:{a:"SmokingSymbol",b:"1F6AC",d:!0,e:!0,f:!0,h:!0,j:["香烟","杀死","烟草","香烟","关节","烟","kills","tobacco","cigarette","joint","smoke"],k:[35,3],o:2},coffin:{a:"Coffin",b:"26B0-FE0F",c:"26B0",d:!0,e:!0,f:!0,h:!0,j:["棺材","吸血鬼","死","这","死亡","把","墓地","墓地","棺材","葬礼","箱","vampire","dead","die","death","rip","graveyard","cemetery","casket","funeral","box"],k:[53,54],o:2},"man-running":{skin_variations:{"1F3FB":{unified:"1F3C3-1F3FB-200D-2642-FE0F",non_qualified:"1F3C3-1F3FB-200D-2642",image:"1f3c3-1f3fb-200d-2642-fe0f.png",sheet_x:8,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3C3-1F3FC-200D-2642-FE0F",non_qualified:"1F3C3-1F3FC-200D-2642",image:"1f3c3-1f3fc-200d-2642-fe0f.png",sheet_x:8,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3C3-1F3FD-200D-2642-FE0F",non_qualified:"1F3C3-1F3FD-200D-2642",image:"1f3c3-1f3fd-200d-2642-fe0f.png",sheet_x:8,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3C3-1F3FE-200D-2642-FE0F",non_qualified:"1F3C3-1F3FE-200D-2642",image:"1f3c3-1f3fe-200d-2642-fe0f.png",sheet_x:8,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3C3-1F3FF-200D-2642-FE0F",non_qualified:"1F3C3-1F3FF-200D-2642",image:"1f3c3-1f3ff-200d-2642-fe0f.png",sheet_x:9,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F3C3",a:"ManRunning",b:"1F3C3-200D-2642-FE0F",c:"1F3C3-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[8,52],o:4,j:["奔跑的男人"]},"flag-tg":{a:"TogoFlag",b:"1F1F9-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[4,26],o:2,j:["多哥国旗"]},"woman-running":{skin_variations:{"1F3FB":{unified:"1F3C3-1F3FB-200D-2640-FE0F",non_qualified:"1F3C3-1F3FB-200D-2640",image:"1f3c3-1f3fb-200d-2640-fe0f.png",sheet_x:8,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3C3-1F3FC-200D-2640-FE0F",non_qualified:"1F3C3-1F3FC-200D-2640",image:"1f3c3-1f3fc-200d-2640-fe0f.png",sheet_x:8,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3C3-1F3FD-200D-2640-FE0F",non_qualified:"1F3C3-1F3FD-200D-2640",image:"1f3c3-1f3fd-200d-2640-fe0f.png",sheet_x:8,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3C3-1F3FE-200D-2640-FE0F",non_qualified:"1F3C3-1F3FE-200D-2640",image:"1f3c3-1f3fe-200d-2640-fe0f.png",sheet_x:8,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3C3-1F3FF-200D-2640-FE0F",non_qualified:"1F3C3-1F3FF-200D-2640",image:"1f3c3-1f3ff-200d-2640-fe0f.png",sheet_x:8,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanRunning",b:"1F3C3-200D-2640-FE0F",c:"1F3C3-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[8,46],o:4,j:["女人跑步"]},funeral_urn:{a:"FuneralUrn",b:"26B1-FE0F",c:"26B1",d:!0,e:!0,f:!0,h:!0,j:["骨灰盒","死","这","死亡","把","灰烬","dead","die","death","rip","ashes"],k:[53,55],o:2},"flag-th":{a:"ThailandFlag",b:"1F1F9-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[4,27],o:2,j:["泰国国旗"]},moyai:{a:"Moyai",b:"1F5FF",d:!0,e:!0,f:!0,h:!0,j:["摩艾石像","岩石","伊斯特岛","摩艾","rock","easterisland","moai"],k:[30,34],o:2},"flag-tj":{a:"TajikistanFlag",b:"1F1F9-1F1EF",d:!0,e:!0,f:!0,h:!0,k:[4,28],o:2,j:["塔吉克斯坦国旗"]},dancer:{skin_variations:{"1F3FB":{unified:"1F483-1F3FB",non_qualified:null,image:"1f483-1f3fb.png",sheet_x:24,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F483-1F3FC",non_qualified:null,image:"1f483-1f3fc.png",sheet_x:24,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F483-1F3FD",non_qualified:null,image:"1f483-1f3fd.png",sheet_x:24,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F483-1F3FE",non_qualified:null,image:"1f483-1f3fe.png",sheet_x:24,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F483-1F3FF",non_qualified:null,image:"1f483-1f3ff.png",sheet_x:24,sheet_y:31,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Dancer",b:"1F483",d:!0,e:!0,f:!0,h:!0,j:["女子跳舞","女性","女孩","女人","乐趣","female","girl","woman","fun"],k:[24,26],o:2},"flag-tk":{a:"TokelauFlag",b:"1F1F9-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[4,29],o:2,j:["托克劳国旗"]},man_dancing:{skin_variations:{"1F3FB":{unified:"1F57A-1F3FB",non_qualified:null,image:"1f57a-1f3fb.png",sheet_x:29,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F57A-1F3FC",non_qualified:null,image:"1f57a-1f3fc.png",sheet_x:29,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F57A-1F3FD",non_qualified:null,image:"1f57a-1f3fd.png",sheet_x:29,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F57A-1F3FE",non_qualified:null,image:"1f57a-1f3fe.png",sheet_x:29,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F57A-1F3FF",non_qualified:null,image:"1f57a-1f3ff.png",sheet_x:29,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManDancing",b:"1F57A",d:!0,e:!0,f:!0,h:!0,j:["男人跳舞","雄","男孩","乐趣","舞蹈家","male","boy","fun","dancer"],k:[29,37],o:4},"flag-tl":{a:"Timor-LesteFlag",b:"1F1F9-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[4,30],o:2,j:["东帝汶国旗"]},man_in_business_suit_levitating:{skin_variations:{"1F3FB":{unified:"1F574-1F3FB",non_qualified:null,image:"1f574-1f3fb.png",sheet_x:29,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F574-1F3FC",non_qualified:null,image:"1f574-1f3fc.png",sheet_x:29,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F574-1F3FD",non_qualified:null,image:"1f574-1f3fd.png",sheet_x:29,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F574-1F3FE",non_qualified:null,image:"1f574-1f3fe.png",sheet_x:29,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F574-1F3FF",non_qualified:null,image:"1f574-1f3ff.png",sheet_x:29,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManinBusinessSuitLevitating",b:"1F574-FE0F",c:"1F574",d:!0,e:!0,f:!0,h:!0,k:[29,9],o:2,j:["穿西装的人漂浮"]},"flag-tm":{a:"TurkmenistanFlag",b:"1F1F9-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[4,31],o:2,j:["土库曼斯坦国旗"]},dancers:{obsoleted_by:"1F46F-200D-2640-FE0F",a:"WomanwithBunnyEars",b:"1F46F",d:!0,e:!0,f:!0,h:!0,k:[22,0],o:2,j:["兔子人"]},"man-with-bunny-ears-partying":{a:"ManwithBunnyEarsPartying",b:"1F46F-200D-2642-FE0F",c:"1F46F-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[21,56],o:4,j:["兔男郎"]},"flag-tn":{a:"TunisiaFlag",b:"1F1F9-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[4,32],o:2,j:["突尼西亚国旗"]},"flag-to":{a:"TongaFlag",b:"1F1F9-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[4,33],o:2,j:["汤加国旗"]},"woman-with-bunny-ears-partying":{obsoletes:"1F46F",a:"WomanwithBunnyEarsPartying",b:"1F46F-200D-2640-FE0F",c:"1F46F-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[21,55],o:4,j:["兔女郎"]},"flag-tr":{a:"TurkeyFlag",b:"1F1F9-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[4,34],o:2,j:["土耳其国旗"]},person_in_steamy_room:{skin_variations:{"1F3FB":{unified:"1F9D6-1F3FB",non_qualified:null,image:"1f9d6-1f3fb.png",sheet_x:48,sheet_y:53,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D6-1F3FB-200D-2642-FE0F"},"1F3FC":{unified:"1F9D6-1F3FC",non_qualified:null,image:"1f9d6-1f3fc.png",sheet_x:48,sheet_y:54,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D6-1F3FC-200D-2642-FE0F"},"1F3FD":{unified:"1F9D6-1F3FD",non_qualified:null,image:"1f9d6-1f3fd.png",sheet_x:48,sheet_y:55,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D6-1F3FD-200D-2642-FE0F"},"1F3FE":{unified:"1F9D6-1F3FE",non_qualified:null,image:"1f9d6-1f3fe.png",sheet_x:48,sheet_y:56,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D6-1F3FE-200D-2642-FE0F"},"1F3FF":{unified:"1F9D6-1F3FF",non_qualified:null,image:"1f9d6-1f3ff.png",sheet_x:49,sheet_y:0,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D6-1F3FF-200D-2642-FE0F"}},obsoleted_by:"1F9D6-200D-2642-FE0F",a:"PersoninSteamyRoom",b:"1F9D6",d:!0,e:!0,f:!0,h:!0,k:[48,52],o:5,j:["蒸汽房内的人"]},man_in_steamy_room:{skin_variations:{"1F3FB":{unified:"1F9D6-1F3FB-200D-2642-FE0F",non_qualified:"1F9D6-1F3FB-200D-2642",image:"1f9d6-1f3fb-200d-2642-fe0f.png",sheet_x:48,sheet_y:47,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D6-1F3FB"},"1F3FC":{unified:"1F9D6-1F3FC-200D-2642-FE0F",non_qualified:"1F9D6-1F3FC-200D-2642",image:"1f9d6-1f3fc-200d-2642-fe0f.png",sheet_x:48,sheet_y:48,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D6-1F3FC"},"1F3FD":{unified:"1F9D6-1F3FD-200D-2642-FE0F",non_qualified:"1F9D6-1F3FD-200D-2642",image:"1f9d6-1f3fd-200d-2642-fe0f.png",sheet_x:48,sheet_y:49,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D6-1F3FD"},"1F3FE":{unified:"1F9D6-1F3FE-200D-2642-FE0F",non_qualified:"1F9D6-1F3FE-200D-2642",image:"1f9d6-1f3fe-200d-2642-fe0f.png",sheet_x:48,sheet_y:50,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D6-1F3FE"},"1F3FF":{unified:"1F9D6-1F3FF-200D-2642-FE0F",non_qualified:"1F9D6-1F3FF-200D-2642",image:"1f9d6-1f3ff-200d-2642-fe0f.png",sheet_x:48,sheet_y:51,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D6-1F3FF"}},obsoletes:"1F9D6",a:"ManinSteamyRoom",b:"1F9D6-200D-2642-FE0F",c:"1F9D6-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[48,46],o:5,j:["蒸汽房内的男人"]},"flag-tt":{a:"Trinidad&TobagoFlag",b:"1F1F9-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[4,35],o:2,j:["特立尼达和多巴哥国旗"]},woman_in_steamy_room:{skin_variations:{"1F3FB":{unified:"1F9D6-1F3FB-200D-2640-FE0F",non_qualified:"1F9D6-1F3FB-200D-2640",image:"1f9d6-1f3fb-200d-2640-fe0f.png",sheet_x:48,sheet_y:41,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D6-1F3FC-200D-2640-FE0F",non_qualified:"1F9D6-1F3FC-200D-2640",image:"1f9d6-1f3fc-200d-2640-fe0f.png",sheet_x:48,sheet_y:42,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D6-1F3FD-200D-2640-FE0F",non_qualified:"1F9D6-1F3FD-200D-2640",image:"1f9d6-1f3fd-200d-2640-fe0f.png",sheet_x:48,sheet_y:43,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D6-1F3FE-200D-2640-FE0F",non_qualified:"1F9D6-1F3FE-200D-2640",image:"1f9d6-1f3fe-200d-2640-fe0f.png",sheet_x:48,sheet_y:44,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D6-1F3FF-200D-2640-FE0F",non_qualified:"1F9D6-1F3FF-200D-2640",image:"1f9d6-1f3ff-200d-2640-fe0f.png",sheet_x:48,sheet_y:45,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomaninSteamyRoom",b:"1F9D6-200D-2640-FE0F",c:"1F9D6-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[48,40],o:5,j:["蒸汽房内的女人"]},"flag-tv":{a:"TuvaluFlag",b:"1F1F9-1F1FB",d:!0,e:!0,f:!0,h:!0,k:[4,36],o:2,j:["图瓦卢国旗"]},person_climbing:{skin_variations:{"1F3FB":{unified:"1F9D7-1F3FB",non_qualified:null,image:"1f9d7-1f3fb.png",sheet_x:49,sheet_y:14,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D7-1F3FB-200D-2640-FE0F"},"1F3FC":{unified:"1F9D7-1F3FC",non_qualified:null,image:"1f9d7-1f3fc.png",sheet_x:49,sheet_y:15,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D7-1F3FC-200D-2640-FE0F"},"1F3FD":{unified:"1F9D7-1F3FD",non_qualified:null,image:"1f9d7-1f3fd.png",sheet_x:49,sheet_y:16,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D7-1F3FD-200D-2640-FE0F"},"1F3FE":{unified:"1F9D7-1F3FE",non_qualified:null,image:"1f9d7-1f3fe.png",sheet_x:49,sheet_y:17,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D7-1F3FE-200D-2640-FE0F"},"1F3FF":{unified:"1F9D7-1F3FF",non_qualified:null,image:"1f9d7-1f3ff.png",sheet_x:49,sheet_y:18,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D7-1F3FF-200D-2640-FE0F"}},obsoleted_by:"1F9D7-200D-2640-FE0F",a:"PersonClimbing",b:"1F9D7",d:!0,e:!0,f:!0,h:!0,k:[49,13],o:5,j:["攀岩的人"]},man_climbing:{skin_variations:{"1F3FB":{unified:"1F9D7-1F3FB-200D-2642-FE0F",non_qualified:"1F9D7-1F3FB-200D-2642",image:"1f9d7-1f3fb-200d-2642-fe0f.png",sheet_x:49,sheet_y:8,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D7-1F3FC-200D-2642-FE0F",non_qualified:"1F9D7-1F3FC-200D-2642",image:"1f9d7-1f3fc-200d-2642-fe0f.png",sheet_x:49,sheet_y:9,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D7-1F3FD-200D-2642-FE0F",non_qualified:"1F9D7-1F3FD-200D-2642",image:"1f9d7-1f3fd-200d-2642-fe0f.png",sheet_x:49,sheet_y:10,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D7-1F3FE-200D-2642-FE0F",non_qualified:"1F9D7-1F3FE-200D-2642",image:"1f9d7-1f3fe-200d-2642-fe0f.png",sheet_x:49,sheet_y:11,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D7-1F3FF-200D-2642-FE0F",non_qualified:"1F9D7-1F3FF-200D-2642",image:"1f9d7-1f3ff-200d-2642-fe0f.png",sheet_x:49,sheet_y:12,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManClimbing",b:"1F9D7-200D-2642-FE0F",c:"1F9D7-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[49,7],o:5,j:["男子攀岩"]},"flag-tz":{a:"TanzaniaFlag",b:"1F1F9-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[4,38],o:2,j:["坦桑尼亚国旗"]},"flag-ua":{a:"UkraineFlag",b:"1F1FA-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[4,39],o:2,j:["乌克兰国旗"]},woman_climbing:{skin_variations:{"1F3FB":{unified:"1F9D7-1F3FB-200D-2640-FE0F",non_qualified:"1F9D7-1F3FB-200D-2640",image:"1f9d7-1f3fb-200d-2640-fe0f.png",sheet_x:49,sheet_y:2,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D7-1F3FB"},"1F3FC":{unified:"1F9D7-1F3FC-200D-2640-FE0F",non_qualified:"1F9D7-1F3FC-200D-2640",image:"1f9d7-1f3fc-200d-2640-fe0f.png",sheet_x:49,sheet_y:3,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D7-1F3FC"},"1F3FD":{unified:"1F9D7-1F3FD-200D-2640-FE0F",non_qualified:"1F9D7-1F3FD-200D-2640",image:"1f9d7-1f3fd-200d-2640-fe0f.png",sheet_x:49,sheet_y:4,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D7-1F3FD"},"1F3FE":{unified:"1F9D7-1F3FE-200D-2640-FE0F",non_qualified:"1F9D7-1F3FE-200D-2640",image:"1f9d7-1f3fe-200d-2640-fe0f.png",sheet_x:49,sheet_y:5,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D7-1F3FE"},"1F3FF":{unified:"1F9D7-1F3FF-200D-2640-FE0F",non_qualified:"1F9D7-1F3FF-200D-2640",image:"1f9d7-1f3ff-200d-2640-fe0f.png",sheet_x:49,sheet_y:6,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D7-1F3FF"}},obsoletes:"1F9D7",a:"WomanClimbing",b:"1F9D7-200D-2640-FE0F",c:"1F9D7-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[49,1],o:5,j:["女子攀岩"]},"flag-ug":{a:"UgandaFlag",b:"1F1FA-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[4,40],o:2,j:["乌干达国旗"]},fencer:{a:"Fencer",b:"1F93A",d:!0,e:!0,f:!0,h:!0,k:[40,32],o:4,j:["西洋剑"]},"flag-um":{a:"U.s.OutlyingIslandsFlag",b:"1F1FA-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[4,41],o:2,j:["美国离岛旗子"]},horse_racing:{skin_variations:{"1F3FB":{unified:"1F3C7-1F3FB",non_qualified:null,image:"1f3c7-1f3fb.png",sheet_x:9,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3C7-1F3FC",non_qualified:null,image:"1f3c7-1f3fc.png",sheet_x:9,sheet_y:29,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3C7-1F3FD",non_qualified:null,image:"1f3c7-1f3fd.png",sheet_x:9,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3C7-1F3FE",non_qualified:null,image:"1f3c7-1f3fe.png",sheet_x:9,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3C7-1F3FF",non_qualified:null,image:"1f3c7-1f3ff.png",sheet_x:9,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"HorseRacing",b:"1F3C7",d:!0,e:!0,f:!0,h:!0,j:["赛马","动物","博彩","竞争","赌博","运气","animal","betting","competition","gambling","luck"],k:[9,27],o:2},skier:{a:"Skier",b:"26F7-FE0F",c:"26F7",d:!0,e:!0,f:!0,h:!0,j:["滑雪的人","体育","冬","雪","sports","winter","snow"],k:[54,17],o:2},"flag-un":{a:"UnitedNationsFlag",b:"1F1FA-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[4,42],o:4,j:["联合国旗"]},us:{a:"UnitedStatesFlag",b:"1F1FA-1F1F8",d:!0,e:!0,f:!0,h:!0,j:["美国国旗","联合","国家","美洲","旗","国家","国家","旗帜","united","states","america","flag","nation","country","banner"],k:[4,43],n:["flag-us"],o:2},snowboarder:{skin_variations:{"1F3FB":{unified:"1F3C2-1F3FB",non_qualified:null,image:"1f3c2-1f3fb.png",sheet_x:8,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3C2-1F3FC",non_qualified:null,image:"1f3c2-1f3fc.png",sheet_x:8,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3C2-1F3FD",non_qualified:null,image:"1f3c2-1f3fd.png",sheet_x:8,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3C2-1F3FE",non_qualified:null,image:"1f3c2-1f3fe.png",sheet_x:8,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3C2-1F3FF",non_qualified:null,image:"1f3c2-1f3ff.png",sheet_x:8,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Snowboarder",b:"1F3C2",d:!0,e:!0,f:!0,h:!0,j:["滑雪的人","体育","冬","sports","winter"],k:[8,40],o:2},golfer:{skin_variations:{"1F3FB":{unified:"1F3CC-1F3FB",non_qualified:null,image:"1f3cc-1f3fb.png",sheet_x:10,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F3CC-1F3FC",non_qualified:null,image:"1f3cc-1f3fc.png",sheet_x:10,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F3CC-1F3FD",non_qualified:null,image:"1f3cc-1f3fd.png",sheet_x:10,sheet_y:29,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F3CC-1F3FE",non_qualified:null,image:"1f3cc-1f3fe.png",sheet_x:10,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F3CC-1F3FF",non_qualified:null,image:"1f3cc-1f3ff.png",sheet_x:10,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F3CC-FE0F-200D-2642-FE0F",a:"Golfer",b:"1F3CC-FE0F",c:"1F3CC",d:!0,e:!0,f:!0,h:!1,k:[10,26],o:2,j:["打高尔夫球的人"]},"flag-uy":{a:"UruguayFlag",b:"1F1FA-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[4,44],o:2,j:["乌拉圭国旗"]},"flag-uz":{a:"UzbekistanFlag",b:"1F1FA-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[4,45],o:2,j:["乌兹别克斯坦"]},"man-golfing":{skin_variations:{"1F3FB":{unified:"1F3CC-1F3FB-200D-2642-FE0F",non_qualified:"1F3CC-1F3FB-200D-2642",image:"1f3cc-1f3fb-200d-2642-fe0f.png",sheet_x:10,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3CC-1F3FC-200D-2642-FE0F",non_qualified:"1F3CC-1F3FC-200D-2642",image:"1f3cc-1f3fc-200d-2642-fe0f.png",sheet_x:10,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3CC-1F3FD-200D-2642-FE0F",non_qualified:"1F3CC-1F3FD-200D-2642",image:"1f3cc-1f3fd-200d-2642-fe0f.png",sheet_x:10,sheet_y:23,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3CC-1F3FE-200D-2642-FE0F",non_qualified:"1F3CC-1F3FE-200D-2642",image:"1f3cc-1f3fe-200d-2642-fe0f.png",sheet_x:10,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3CC-1F3FF-200D-2642-FE0F",non_qualified:"1F3CC-1F3FF-200D-2642",image:"1f3cc-1f3ff-200d-2642-fe0f.png",sheet_x:10,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F3CC-FE0F",a:"ManGolfing",b:"1F3CC-FE0F-200D-2642-FE0F",d:!0,e:!0,f:!0,h:!1,k:[10,20],o:4,j:["男子高尔夫"]},"flag-va":{a:"VaticanCityFlag",b:"1F1FB-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[4,46],o:2,j:["梵蒂冈"]},"woman-golfing":{skin_variations:{"1F3FB":{unified:"1F3CC-1F3FB-200D-2640-FE0F",non_qualified:"1F3CC-1F3FB-200D-2640",image:"1f3cc-1f3fb-200d-2640-fe0f.png",sheet_x:10,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3CC-1F3FC-200D-2640-FE0F",non_qualified:"1F3CC-1F3FC-200D-2640",image:"1f3cc-1f3fc-200d-2640-fe0f.png",sheet_x:10,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3CC-1F3FD-200D-2640-FE0F",non_qualified:"1F3CC-1F3FD-200D-2640",image:"1f3cc-1f3fd-200d-2640-fe0f.png",sheet_x:10,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3CC-1F3FE-200D-2640-FE0F",non_qualified:"1F3CC-1F3FE-200D-2640",image:"1f3cc-1f3fe-200d-2640-fe0f.png",sheet_x:10,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3CC-1F3FF-200D-2640-FE0F",non_qualified:"1F3CC-1F3FF-200D-2640",image:"1f3cc-1f3ff-200d-2640-fe0f.png",sheet_x:10,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanGolfing",b:"1F3CC-FE0F-200D-2640-FE0F",d:!0,e:!0,f:!0,h:!1,k:[10,14],o:4,j:["女子高尔夫"]},"flag-vc":{a:"St.Vincent&GrenadinesFlag",b:"1F1FB-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[4,47],o:2,j:["圣文森特和格林纳丁斯"]},surfer:{skin_variations:{"1F3FB":{unified:"1F3C4-1F3FB",non_qualified:null,image:"1f3c4-1f3fb.png",sheet_x:9,sheet_y:20,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F3C4-1F3FC",non_qualified:null,image:"1f3c4-1f3fc.png",sheet_x:9,sheet_y:21,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F3C4-1F3FD",non_qualified:null,image:"1f3c4-1f3fd.png",sheet_x:9,sheet_y:22,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F3C4-1F3FE",non_qualified:null,image:"1f3c4-1f3fe.png",sheet_x:9,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F3C4-1F3FF",non_qualified:null,image:"1f3c4-1f3ff.png",sheet_x:9,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F3C4-200D-2642-FE0F",a:"Surfer",b:"1F3C4",d:!0,e:!0,f:!0,h:!1,k:[9,19],o:2,j:["冲浪男"]},"man-surfing":{skin_variations:{"1F3FB":{unified:"1F3C4-1F3FB-200D-2642-FE0F",non_qualified:"1F3C4-1F3FB-200D-2642",image:"1f3c4-1f3fb-200d-2642-fe0f.png",sheet_x:9,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3C4-1F3FC-200D-2642-FE0F",non_qualified:"1F3C4-1F3FC-200D-2642",image:"1f3c4-1f3fc-200d-2642-fe0f.png",sheet_x:9,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3C4-1F3FD-200D-2642-FE0F",non_qualified:"1F3C4-1F3FD-200D-2642",image:"1f3c4-1f3fd-200d-2642-fe0f.png",sheet_x:9,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3C4-1F3FE-200D-2642-FE0F",non_qualified:"1F3C4-1F3FE-200D-2642",image:"1f3c4-1f3fe-200d-2642-fe0f.png",sheet_x:9,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3C4-1F3FF-200D-2642-FE0F",non_qualified:"1F3C4-1F3FF-200D-2642",image:"1f3c4-1f3ff-200d-2642-fe0f.png",sheet_x:9,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F3C4",a:"ManSurfing",b:"1F3C4-200D-2642-FE0F",c:"1F3C4-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[9,13],o:4,j:["男子冲浪"]},"flag-ve":{a:"VenezuelaFlag",b:"1F1FB-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[4,48],o:2,j:["委内瑞拉"]},"flag-vg":{a:"BritishVirginIslandsFlag",b:"1F1FB-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[4,49],o:2,j:["英属维尔京群岛"]},"woman-surfing":{skin_variations:{"1F3FB":{unified:"1F3C4-1F3FB-200D-2640-FE0F",non_qualified:"1F3C4-1F3FB-200D-2640",image:"1f3c4-1f3fb-200d-2640-fe0f.png",sheet_x:9,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3C4-1F3FC-200D-2640-FE0F",non_qualified:"1F3C4-1F3FC-200D-2640",image:"1f3c4-1f3fc-200d-2640-fe0f.png",sheet_x:9,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3C4-1F3FD-200D-2640-FE0F",non_qualified:"1F3C4-1F3FD-200D-2640",image:"1f3c4-1f3fd-200d-2640-fe0f.png",sheet_x:9,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3C4-1F3FE-200D-2640-FE0F",non_qualified:"1F3C4-1F3FE-200D-2640",image:"1f3c4-1f3fe-200d-2640-fe0f.png",sheet_x:9,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3C4-1F3FF-200D-2640-FE0F",non_qualified:"1F3C4-1F3FF-200D-2640",image:"1f3c4-1f3ff-200d-2640-fe0f.png",sheet_x:9,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanSurfing",b:"1F3C4-200D-2640-FE0F",c:"1F3C4-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[9,7],o:4,j:["女子冲浪"]},rowboat:{skin_variations:{"1F3FB":{unified:"1F6A3-1F3FB",non_qualified:null,image:"1f6a3-1f3fb.png",sheet_x:34,sheet_y:47,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F6A3-1F3FC",non_qualified:null,image:"1f6a3-1f3fc.png",sheet_x:34,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F6A3-1F3FD",non_qualified:null,image:"1f6a3-1f3fd.png",sheet_x:34,sheet_y:49,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F6A3-1F3FE",non_qualified:null,image:"1f6a3-1f3fe.png",sheet_x:34,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F6A3-1F3FF",non_qualified:null,image:"1f6a3-1f3ff.png",sheet_x:34,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F6A3-200D-2642-FE0F",a:"Rowboat",b:"1F6A3",d:!0,e:!0,f:!0,h:!1,k:[34,46],o:2,j:["划船的人"]},"flag-vi":{a:"U.s.VirginIslandsFlag",b:"1F1FB-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[4,50],o:2,j:["美属维尔京群岛"]},"man-rowing-boat":{skin_variations:{"1F3FB":{unified:"1F6A3-1F3FB-200D-2642-FE0F",non_qualified:"1F6A3-1F3FB-200D-2642",image:"1f6a3-1f3fb-200d-2642-fe0f.png",sheet_x:34,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6A3-1F3FC-200D-2642-FE0F",non_qualified:"1F6A3-1F3FC-200D-2642",image:"1f6a3-1f3fc-200d-2642-fe0f.png",sheet_x:34,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6A3-1F3FD-200D-2642-FE0F",non_qualified:"1F6A3-1F3FD-200D-2642",image:"1f6a3-1f3fd-200d-2642-fe0f.png",sheet_x:34,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6A3-1F3FE-200D-2642-FE0F",non_qualified:"1F6A3-1F3FE-200D-2642",image:"1f6a3-1f3fe-200d-2642-fe0f.png",sheet_x:34,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6A3-1F3FF-200D-2642-FE0F",non_qualified:"1F6A3-1F3FF-200D-2642",image:"1f6a3-1f3ff-200d-2642-fe0f.png",sheet_x:34,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F6A3",a:"ManRowingBoat",b:"1F6A3-200D-2642-FE0F",c:"1F6A3-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[34,40],o:4,j:["男子划船"]},"flag-vn":{a:"VietnamFlag",b:"1F1FB-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[4,51],o:2,j:["越南"]},"flag-vu":{a:"VanuatuFlag",b:"1F1FB-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[4,52],o:2,j:["瓦努阿图"]},"woman-rowing-boat":{skin_variations:{"1F3FB":{unified:"1F6A3-1F3FB-200D-2640-FE0F",non_qualified:"1F6A3-1F3FB-200D-2640",image:"1f6a3-1f3fb-200d-2640-fe0f.png",sheet_x:34,sheet_y:35,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6A3-1F3FC-200D-2640-FE0F",non_qualified:"1F6A3-1F3FC-200D-2640",image:"1f6a3-1f3fc-200d-2640-fe0f.png",sheet_x:34,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6A3-1F3FD-200D-2640-FE0F",non_qualified:"1F6A3-1F3FD-200D-2640",image:"1f6a3-1f3fd-200d-2640-fe0f.png",sheet_x:34,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6A3-1F3FE-200D-2640-FE0F",non_qualified:"1F6A3-1F3FE-200D-2640",image:"1f6a3-1f3fe-200d-2640-fe0f.png",sheet_x:34,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6A3-1F3FF-200D-2640-FE0F",non_qualified:"1F6A3-1F3FF-200D-2640",image:"1f6a3-1f3ff-200d-2640-fe0f.png",sheet_x:34,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanRowingBoat",b:"1F6A3-200D-2640-FE0F",c:"1F6A3-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[34,34],o:4,j:["女子划船"]},swimmer:{skin_variations:{"1F3FB":{unified:"1F3CA-1F3FB",non_qualified:null,image:"1f3ca-1f3fb.png",sheet_x:9,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F3CA-1F3FC",non_qualified:null,image:"1f3ca-1f3fc.png",sheet_x:9,sheet_y:49,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F3CA-1F3FD",non_qualified:null,image:"1f3ca-1f3fd.png",sheet_x:9,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F3CA-1F3FE",non_qualified:null,image:"1f3ca-1f3fe.png",sheet_x:9,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F3CA-1F3FF",non_qualified:null,image:"1f3ca-1f3ff.png",sheet_x:9,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F3CA-200D-2642-FE0F",a:"Swimmer",b:"1F3CA",d:!0,e:!0,f:!0,h:!1,k:[9,47],o:2,j:["游泳的人"]},"flag-wf":{a:"Wallis&FutunaFlag",b:"1F1FC-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[4,53],o:2,j:["瓦利斯和富图纳"]},"man-swimming":{skin_variations:{"1F3FB":{unified:"1F3CA-1F3FB-200D-2642-FE0F",non_qualified:"1F3CA-1F3FB-200D-2642",image:"1f3ca-1f3fb-200d-2642-fe0f.png",sheet_x:9,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3CA-1F3FC-200D-2642-FE0F",non_qualified:"1F3CA-1F3FC-200D-2642",image:"1f3ca-1f3fc-200d-2642-fe0f.png",sheet_x:9,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3CA-1F3FD-200D-2642-FE0F",non_qualified:"1F3CA-1F3FD-200D-2642",image:"1f3ca-1f3fd-200d-2642-fe0f.png",sheet_x:9,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3CA-1F3FE-200D-2642-FE0F",non_qualified:"1F3CA-1F3FE-200D-2642",image:"1f3ca-1f3fe-200d-2642-fe0f.png",sheet_x:9,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3CA-1F3FF-200D-2642-FE0F",non_qualified:"1F3CA-1F3FF-200D-2642",image:"1f3ca-1f3ff-200d-2642-fe0f.png",sheet_x:9,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F3CA",a:"ManSwimming",b:"1F3CA-200D-2642-FE0F",c:"1F3CA-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[9,41],o:4,j:["男子游泳"]},"flag-ws":{a:"SamoaFlag",b:"1F1FC-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[4,54],o:2,j:["萨摩亚"]},"woman-swimming":{skin_variations:{"1F3FB":{unified:"1F3CA-1F3FB-200D-2640-FE0F",non_qualified:"1F3CA-1F3FB-200D-2640",image:"1f3ca-1f3fb-200d-2640-fe0f.png",sheet_x:9,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3CA-1F3FC-200D-2640-FE0F",non_qualified:"1F3CA-1F3FC-200D-2640",image:"1f3ca-1f3fc-200d-2640-fe0f.png",sheet_x:9,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3CA-1F3FD-200D-2640-FE0F",non_qualified:"1F3CA-1F3FD-200D-2640",image:"1f3ca-1f3fd-200d-2640-fe0f.png",sheet_x:9,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3CA-1F3FE-200D-2640-FE0F",non_qualified:"1F3CA-1F3FE-200D-2640",image:"1f3ca-1f3fe-200d-2640-fe0f.png",sheet_x:9,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3CA-1F3FF-200D-2640-FE0F",non_qualified:"1F3CA-1F3FF-200D-2640",image:"1f3ca-1f3ff-200d-2640-fe0f.png",sheet_x:9,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanSwimming",b:"1F3CA-200D-2640-FE0F",c:"1F3CA-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[9,35],o:4,j:["女子游泳"]},"flag-xk":{a:"KosovoFlag",b:"1F1FD-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[4,55],o:2,j:["科索沃"]},person_with_ball:{skin_variations:{"1F3FB":{unified:"26F9-1F3FB",non_qualified:null,image:"26f9-1f3fb.png",sheet_x:54,sheet_y:32,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"26F9-1F3FC",non_qualified:null,image:"26f9-1f3fc.png",sheet_x:54,sheet_y:33,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"26F9-1F3FD",non_qualified:null,image:"26f9-1f3fd.png",sheet_x:54,sheet_y:34,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"26F9-1F3FE",non_qualified:null,image:"26f9-1f3fe.png",sheet_x:54,sheet_y:35,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"26F9-1F3FF",non_qualified:null,image:"26f9-1f3ff.png",sheet_x:54,sheet_y:36,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"26F9-FE0F-200D-2642-FE0F",a:"PersonwithBall",b:"26F9-FE0F",c:"26F9",d:!0,e:!0,f:!0,h:!1,k:[54,31],o:2,j:["运球的人"]},"flag-ye":{a:"YemenFlag",b:"1F1FE-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[4,56],o:2,j:["也门"]},"man-bouncing-ball":{skin_variations:{"1F3FB":{unified:"26F9-1F3FB-200D-2642-FE0F",non_qualified:"26F9-1F3FB-200D-2642",image:"26f9-1f3fb-200d-2642-fe0f.png",sheet_x:54,sheet_y:26,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"26F9-1F3FC-200D-2642-FE0F",non_qualified:"26F9-1F3FC-200D-2642",image:"26f9-1f3fc-200d-2642-fe0f.png",sheet_x:54,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"26F9-1F3FD-200D-2642-FE0F",non_qualified:"26F9-1F3FD-200D-2642",image:"26f9-1f3fd-200d-2642-fe0f.png",sheet_x:54,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"26F9-1F3FE-200D-2642-FE0F",non_qualified:"26F9-1F3FE-200D-2642",image:"26f9-1f3fe-200d-2642-fe0f.png",sheet_x:54,sheet_y:29,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"26F9-1F3FF-200D-2642-FE0F",non_qualified:"26F9-1F3FF-200D-2642",image:"26f9-1f3ff-200d-2642-fe0f.png",sheet_x:54,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"26F9-FE0F",a:"ManBouncingBall",b:"26F9-FE0F-200D-2642-FE0F",d:!0,e:!0,f:!0,h:!1,k:[54,25],o:4,j:["男子运球"]},"flag-yt":{a:"MayotteFlag",b:"1F1FE-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[5,0],o:2,j:["马约特"]},"woman-bouncing-ball":{skin_variations:{"1F3FB":{unified:"26F9-1F3FB-200D-2640-FE0F",non_qualified:"26F9-1F3FB-200D-2640",image:"26f9-1f3fb-200d-2640-fe0f.png",sheet_x:54,sheet_y:20,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"26F9-1F3FC-200D-2640-FE0F",non_qualified:"26F9-1F3FC-200D-2640",image:"26f9-1f3fc-200d-2640-fe0f.png",sheet_x:54,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"26F9-1F3FD-200D-2640-FE0F",non_qualified:"26F9-1F3FD-200D-2640",image:"26f9-1f3fd-200d-2640-fe0f.png",sheet_x:54,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"26F9-1F3FE-200D-2640-FE0F",non_qualified:"26F9-1F3FE-200D-2640",image:"26f9-1f3fe-200d-2640-fe0f.png",sheet_x:54,sheet_y:23,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"26F9-1F3FF-200D-2640-FE0F",non_qualified:"26F9-1F3FF-200D-2640",image:"26f9-1f3ff-200d-2640-fe0f.png",sheet_x:54,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanBouncingBall",b:"26F9-FE0F-200D-2640-FE0F",d:!0,e:!0,f:!0,h:!1,k:[54,19],o:4,j:["女子运球"]},"flag-za":{a:"SouthAfricaFlag",b:"1F1FF-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[5,1],o:2,j:["南非"]},"flag-zm":{a:"ZambiaFlag",b:"1F1FF-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[5,2],o:2,j:["赞比亚"]},weight_lifter:{skin_variations:{"1F3FB":{unified:"1F3CB-1F3FB",non_qualified:null,image:"1f3cb-1f3fb.png",sheet_x:10,sheet_y:9,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F3CB-1F3FC",non_qualified:null,image:"1f3cb-1f3fc.png",sheet_x:10,sheet_y:10,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F3CB-1F3FD",non_qualified:null,image:"1f3cb-1f3fd.png",sheet_x:10,sheet_y:11,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F3CB-1F3FE",non_qualified:null,image:"1f3cb-1f3fe.png",sheet_x:10,sheet_y:12,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F3CB-1F3FF",non_qualified:null,image:"1f3cb-1f3ff.png",sheet_x:10,sheet_y:13,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F3CB-FE0F-200D-2642-FE0F",a:"WeightLifter",b:"1F3CB-FE0F",c:"1F3CB",d:!0,e:!0,f:!0,h:!1,k:[10,8],o:2,j:["举重的人"]},"man-lifting-weights":{skin_variations:{"1F3FB":{unified:"1F3CB-1F3FB-200D-2642-FE0F",non_qualified:"1F3CB-1F3FB-200D-2642",image:"1f3cb-1f3fb-200d-2642-fe0f.png",sheet_x:10,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3CB-1F3FC-200D-2642-FE0F",non_qualified:"1F3CB-1F3FC-200D-2642",image:"1f3cb-1f3fc-200d-2642-fe0f.png",sheet_x:10,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3CB-1F3FD-200D-2642-FE0F",non_qualified:"1F3CB-1F3FD-200D-2642",image:"1f3cb-1f3fd-200d-2642-fe0f.png",sheet_x:10,sheet_y:5,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3CB-1F3FE-200D-2642-FE0F",non_qualified:"1F3CB-1F3FE-200D-2642",image:"1f3cb-1f3fe-200d-2642-fe0f.png",sheet_x:10,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3CB-1F3FF-200D-2642-FE0F",non_qualified:"1F3CB-1F3FF-200D-2642",image:"1f3cb-1f3ff-200d-2642-fe0f.png",sheet_x:10,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F3CB-FE0F",a:"ManLiftingWeights",b:"1F3CB-FE0F-200D-2642-FE0F",d:!0,e:!0,f:!0,h:!1,k:[10,2],o:4,j:["男子举重"]},"flag-zw":{a:"ZimbabweFlag",b:"1F1FF-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[5,3],o:2,j:["津巴布韦"]},"woman-lifting-weights":{skin_variations:{"1F3FB":{unified:"1F3CB-1F3FB-200D-2640-FE0F",non_qualified:"1F3CB-1F3FB-200D-2640",image:"1f3cb-1f3fb-200d-2640-fe0f.png",sheet_x:9,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3CB-1F3FC-200D-2640-FE0F",non_qualified:"1F3CB-1F3FC-200D-2640",image:"1f3cb-1f3fc-200d-2640-fe0f.png",sheet_x:9,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3CB-1F3FD-200D-2640-FE0F",non_qualified:"1F3CB-1F3FD-200D-2640",image:"1f3cb-1f3fd-200d-2640-fe0f.png",sheet_x:9,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3CB-1F3FE-200D-2640-FE0F",non_qualified:"1F3CB-1F3FE-200D-2640",image:"1f3cb-1f3fe-200d-2640-fe0f.png",sheet_x:10,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3CB-1F3FF-200D-2640-FE0F",non_qualified:"1F3CB-1F3FF-200D-2640",image:"1f3cb-1f3ff-200d-2640-fe0f.png",sheet_x:10,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanLiftingWeights",b:"1F3CB-FE0F-200D-2640-FE0F",d:!0,e:!0,f:!0,h:!1,k:[9,53],o:4,j:["女子举重"]},"flag-england":{a:"EnglandFlag",b:"1F3F4-E0067-E0062-E0065-E006E-E0067-E007F",d:!0,e:!0,f:!0,h:!0,k:[11,14],o:5,j:["英格兰"]},bicyclist:{skin_variations:{"1F3FB":{unified:"1F6B4-1F3FB",non_qualified:null,image:"1f6b4-1f3fb.png",sheet_x:35,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F6B4-1F3FC",non_qualified:null,image:"1f6b4-1f3fc.png",sheet_x:35,sheet_y:25,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F6B4-1F3FD",non_qualified:null,image:"1f6b4-1f3fd.png",sheet_x:35,sheet_y:26,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F6B4-1F3FE",non_qualified:null,image:"1f6b4-1f3fe.png",sheet_x:35,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F6B4-1F3FF",non_qualified:null,image:"1f6b4-1f3ff.png",sheet_x:35,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F6B4-200D-2642-FE0F",a:"Bicyclist",b:"1F6B4",d:!0,e:!0,f:!0,h:!1,k:[35,23],o:2,j:["骑自行车的人"]},"flag-scotland":{a:"ScotlandFlag",b:"1F3F4-E0067-E0062-E0073-E0063-E0074-E007F",d:!0,e:!0,f:!0,h:!0,k:[11,15],o:5,j:["苏格兰"]},"flag-wales":{a:"WalesFlag",b:"1F3F4-E0067-E0062-E0077-E006C-E0073-E007F",d:!0,e:!0,f:!0,h:!0,k:[11,16],o:5,j:["Flag:Wales"]},"man-biking":{skin_variations:{"1F3FB":{unified:"1F6B4-1F3FB-200D-2642-FE0F",non_qualified:"1F6B4-1F3FB-200D-2642",image:"1f6b4-1f3fb-200d-2642-fe0f.png",sheet_x:35,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6B4-1F3FC-200D-2642-FE0F",non_qualified:"1F6B4-1F3FC-200D-2642",image:"1f6b4-1f3fc-200d-2642-fe0f.png",sheet_x:35,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6B4-1F3FD-200D-2642-FE0F",non_qualified:"1F6B4-1F3FD-200D-2642",image:"1f6b4-1f3fd-200d-2642-fe0f.png",sheet_x:35,sheet_y:20,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6B4-1F3FE-200D-2642-FE0F",non_qualified:"1F6B4-1F3FE-200D-2642",image:"1f6b4-1f3fe-200d-2642-fe0f.png",sheet_x:35,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6B4-1F3FF-200D-2642-FE0F",non_qualified:"1F6B4-1F3FF-200D-2642",image:"1f6b4-1f3ff-200d-2642-fe0f.png",sheet_x:35,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F6B4",a:"ManBiking",b:"1F6B4-200D-2642-FE0F",c:"1F6B4-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[35,17],o:4,j:["骑自行车的男子"]},"woman-biking":{skin_variations:{"1F3FB":{unified:"1F6B4-1F3FB-200D-2640-FE0F",non_qualified:"1F6B4-1F3FB-200D-2640",image:"1f6b4-1f3fb-200d-2640-fe0f.png",sheet_x:35,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6B4-1F3FC-200D-2640-FE0F",non_qualified:"1F6B4-1F3FC-200D-2640",image:"1f6b4-1f3fc-200d-2640-fe0f.png",sheet_x:35,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6B4-1F3FD-200D-2640-FE0F",non_qualified:"1F6B4-1F3FD-200D-2640",image:"1f6b4-1f3fd-200d-2640-fe0f.png",sheet_x:35,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6B4-1F3FE-200D-2640-FE0F",non_qualified:"1F6B4-1F3FE-200D-2640",image:"1f6b4-1f3fe-200d-2640-fe0f.png",sheet_x:35,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6B4-1F3FF-200D-2640-FE0F",non_qualified:"1F6B4-1F3FF-200D-2640",image:"1f6b4-1f3ff-200d-2640-fe0f.png",sheet_x:35,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanBiking",b:"1F6B4-200D-2640-FE0F",c:"1F6B4-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[35,11],o:4,j:["女子骑行自行车"]},mountain_bicyclist:{skin_variations:{"1F3FB":{unified:"1F6B5-1F3FB",non_qualified:null,image:"1f6b5-1f3fb.png",sheet_x:35,sheet_y:42,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F6B5-1F3FC",non_qualified:null,image:"1f6b5-1f3fc.png",sheet_x:35,sheet_y:43,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F6B5-1F3FD",non_qualified:null,image:"1f6b5-1f3fd.png",sheet_x:35,sheet_y:44,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F6B5-1F3FE",non_qualified:null,image:"1f6b5-1f3fe.png",sheet_x:35,sheet_y:45,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F6B5-1F3FF",non_qualified:null,image:"1f6b5-1f3ff.png",sheet_x:35,sheet_y:46,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F6B5-200D-2642-FE0F",a:"MountainBicyclist",b:"1F6B5",d:!0,e:!0,f:!0,h:!1,k:[35,41],o:2,j:["骑行山地自行车的人"]},"man-mountain-biking":{skin_variations:{"1F3FB":{unified:"1F6B5-1F3FB-200D-2642-FE0F",non_qualified:"1F6B5-1F3FB-200D-2642",image:"1f6b5-1f3fb-200d-2642-fe0f.png",sheet_x:35,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6B5-1F3FC-200D-2642-FE0F",non_qualified:"1F6B5-1F3FC-200D-2642",image:"1f6b5-1f3fc-200d-2642-fe0f.png",sheet_x:35,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6B5-1F3FD-200D-2642-FE0F",non_qualified:"1F6B5-1F3FD-200D-2642",image:"1f6b5-1f3fd-200d-2642-fe0f.png",sheet_x:35,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6B5-1F3FE-200D-2642-FE0F",non_qualified:"1F6B5-1F3FE-200D-2642",image:"1f6b5-1f3fe-200d-2642-fe0f.png",sheet_x:35,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6B5-1F3FF-200D-2642-FE0F",non_qualified:"1F6B5-1F3FF-200D-2642",image:"1f6b5-1f3ff-200d-2642-fe0f.png",sheet_x:35,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F6B5",a:"ManMountainBiking",b:"1F6B5-200D-2642-FE0F",c:"1F6B5-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[35,35],o:4,j:["男子骑行山地自行车"]},"woman-mountain-biking":{skin_variations:{"1F3FB":{unified:"1F6B5-1F3FB-200D-2640-FE0F",non_qualified:"1F6B5-1F3FB-200D-2640",image:"1f6b5-1f3fb-200d-2640-fe0f.png",sheet_x:35,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6B5-1F3FC-200D-2640-FE0F",non_qualified:"1F6B5-1F3FC-200D-2640",image:"1f6b5-1f3fc-200d-2640-fe0f.png",sheet_x:35,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6B5-1F3FD-200D-2640-FE0F",non_qualified:"1F6B5-1F3FD-200D-2640",image:"1f6b5-1f3fd-200d-2640-fe0f.png",sheet_x:35,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6B5-1F3FE-200D-2640-FE0F",non_qualified:"1F6B5-1F3FE-200D-2640",image:"1f6b5-1f3fe-200d-2640-fe0f.png",sheet_x:35,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6B5-1F3FF-200D-2640-FE0F",non_qualified:"1F6B5-1F3FF-200D-2640",image:"1f6b5-1f3ff-200d-2640-fe0f.png",sheet_x:35,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanMountainBiking",b:"1F6B5-200D-2640-FE0F",c:"1F6B5-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[35,29],o:4,j:["女子骑行山地自行车"]},person_doing_cartwheel:{skin_variations:{"1F3FB":{unified:"1F938-1F3FB",non_qualified:null,image:"1f938-1f3fb.png",sheet_x:40,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F938-1F3FC",non_qualified:null,image:"1f938-1f3fc.png",sheet_x:40,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F938-1F3FD",non_qualified:null,image:"1f938-1f3fd.png",sheet_x:40,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F938-1F3FE",non_qualified:null,image:"1f938-1f3fe.png",sheet_x:40,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F938-1F3FF",non_qualified:null,image:"1f938-1f3ff.png",sheet_x:40,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},a:"PersonDoingCartwheel",b:"1F938",d:!0,e:!0,f:!0,h:!1,k:[40,8],o:4,j:["跳大车轮的人"]},"man-cartwheeling":{skin_variations:{"1F3FB":{unified:"1F938-1F3FB-200D-2642-FE0F",non_qualified:"1F938-1F3FB-200D-2642",image:"1f938-1f3fb-200d-2642-fe0f.png",sheet_x:40,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F938-1F3FC-200D-2642-FE0F",non_qualified:"1F938-1F3FC-200D-2642",image:"1f938-1f3fc-200d-2642-fe0f.png",sheet_x:40,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F938-1F3FD-200D-2642-FE0F",non_qualified:"1F938-1F3FD-200D-2642",image:"1f938-1f3fd-200d-2642-fe0f.png",sheet_x:40,sheet_y:5,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F938-1F3FE-200D-2642-FE0F",non_qualified:"1F938-1F3FE-200D-2642",image:"1f938-1f3fe-200d-2642-fe0f.png",sheet_x:40,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F938-1F3FF-200D-2642-FE0F",non_qualified:"1F938-1F3FF-200D-2642",image:"1f938-1f3ff-200d-2642-fe0f.png",sheet_x:40,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManCartwheeling",b:"1F938-200D-2642-FE0F",c:"1F938-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[40,2],o:4,j:["男跳大车轮的男人"]},"woman-cartwheeling":{skin_variations:{"1F3FB":{unified:"1F938-1F3FB-200D-2640-FE0F",non_qualified:"1F938-1F3FB-200D-2640",image:"1f938-1f3fb-200d-2640-fe0f.png",sheet_x:39,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F938-1F3FC-200D-2640-FE0F",non_qualified:"1F938-1F3FC-200D-2640",image:"1f938-1f3fc-200d-2640-fe0f.png",sheet_x:39,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F938-1F3FD-200D-2640-FE0F",non_qualified:"1F938-1F3FD-200D-2640",image:"1f938-1f3fd-200d-2640-fe0f.png",sheet_x:39,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F938-1F3FE-200D-2640-FE0F",non_qualified:"1F938-1F3FE-200D-2640",image:"1f938-1f3fe-200d-2640-fe0f.png",sheet_x:40,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F938-1F3FF-200D-2640-FE0F",non_qualified:"1F938-1F3FF-200D-2640",image:"1f938-1f3ff-200d-2640-fe0f.png",sheet_x:40,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanCartwheeling",b:"1F938-200D-2640-FE0F",c:"1F938-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[39,53],o:4,j:["跳大车轮的女人"]},wrestlers:{a:"Wrestlers",b:"1F93C",d:!0,e:!0,f:!0,h:!0,k:[40,35],o:4,j:["人们摔跤"]},"man-wrestling":{a:"ManWrestling",b:"1F93C-200D-2642-FE0F",c:"1F93C-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[40,34],o:4,j:["男子摔跤"]},"woman-wrestling":{a:"WomanWrestling",b:"1F93C-200D-2640-FE0F",c:"1F93C-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[40,33],o:4,j:["女子摔跤"]},water_polo:{skin_variations:{"1F3FB":{unified:"1F93D-1F3FB",non_qualified:null,image:"1f93d-1f3fb.png",sheet_x:40,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F93D-1F3FC",non_qualified:null,image:"1f93d-1f3fc.png",sheet_x:40,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F93D-1F3FD",non_qualified:null,image:"1f93d-1f3fd.png",sheet_x:40,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F93D-1F3FE",non_qualified:null,image:"1f93d-1f3fe.png",sheet_x:40,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F93D-1F3FF",non_qualified:null,image:"1f93d-1f3ff.png",sheet_x:40,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},a:"WaterPolo",b:"1F93D",d:!0,e:!0,f:!0,h:!1,k:[40,48],o:4,j:["打水球的人"]},"man-playing-water-polo":{skin_variations:{"1F3FB":{unified:"1F93D-1F3FB-200D-2642-FE0F",non_qualified:"1F93D-1F3FB-200D-2642",image:"1f93d-1f3fb-200d-2642-fe0f.png",sheet_x:40,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F93D-1F3FC-200D-2642-FE0F",non_qualified:"1F93D-1F3FC-200D-2642",image:"1f93d-1f3fc-200d-2642-fe0f.png",sheet_x:40,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F93D-1F3FD-200D-2642-FE0F",non_qualified:"1F93D-1F3FD-200D-2642",image:"1f93d-1f3fd-200d-2642-fe0f.png",sheet_x:40,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F93D-1F3FE-200D-2642-FE0F",non_qualified:"1F93D-1F3FE-200D-2642",image:"1f93d-1f3fe-200d-2642-fe0f.png",sheet_x:40,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F93D-1F3FF-200D-2642-FE0F",non_qualified:"1F93D-1F3FF-200D-2642",image:"1f93d-1f3ff-200d-2642-fe0f.png",sheet_x:40,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManPlayingWaterPolo",b:"1F93D-200D-2642-FE0F",c:"1F93D-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[40,42],o:4,j:["打水球的男子"]},"woman-playing-water-polo":{skin_variations:{"1F3FB":{unified:"1F93D-1F3FB-200D-2640-FE0F",non_qualified:"1F93D-1F3FB-200D-2640",image:"1f93d-1f3fb-200d-2640-fe0f.png",sheet_x:40,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F93D-1F3FC-200D-2640-FE0F",non_qualified:"1F93D-1F3FC-200D-2640",image:"1f93d-1f3fc-200d-2640-fe0f.png",sheet_x:40,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F93D-1F3FD-200D-2640-FE0F",non_qualified:"1F93D-1F3FD-200D-2640",image:"1f93d-1f3fd-200d-2640-fe0f.png",sheet_x:40,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F93D-1F3FE-200D-2640-FE0F",non_qualified:"1F93D-1F3FE-200D-2640",image:"1f93d-1f3fe-200d-2640-fe0f.png",sheet_x:40,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F93D-1F3FF-200D-2640-FE0F",non_qualified:"1F93D-1F3FF-200D-2640",image:"1f93d-1f3ff-200d-2640-fe0f.png",sheet_x:40,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanPlayingWaterPolo",b:"1F93D-200D-2640-FE0F",c:"1F93D-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[40,36],o:4,j:["打水球的女子"]},handball:{skin_variations:{"1F3FB":{unified:"1F93E-1F3FB",non_qualified:null,image:"1f93e-1f3fb.png",sheet_x:41,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F93E-1F3FC",non_qualified:null,image:"1f93e-1f3fc.png",sheet_x:41,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F93E-1F3FD",non_qualified:null,image:"1f93e-1f3fd.png",sheet_x:41,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F93E-1F3FE",non_qualified:null,image:"1f93e-1f3fe.png",sheet_x:41,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F93E-1F3FF",non_qualified:null,image:"1f93e-1f3ff.png",sheet_x:41,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},a:"Handball",b:"1F93E",d:!0,e:!0,f:!0,h:!1,k:[41,9],o:4,j:["打手球的人"]},"man-playing-handball":{skin_variations:{"1F3FB":{unified:"1F93E-1F3FB-200D-2642-FE0F",non_qualified:"1F93E-1F3FB-200D-2642",image:"1f93e-1f3fb-200d-2642-fe0f.png",sheet_x:41,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F93E-1F3FC-200D-2642-FE0F",non_qualified:"1F93E-1F3FC-200D-2642",image:"1f93e-1f3fc-200d-2642-fe0f.png",sheet_x:41,sheet_y:5,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F93E-1F3FD-200D-2642-FE0F",non_qualified:"1F93E-1F3FD-200D-2642",image:"1f93e-1f3fd-200d-2642-fe0f.png",sheet_x:41,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F93E-1F3FE-200D-2642-FE0F",non_qualified:"1F93E-1F3FE-200D-2642",image:"1f93e-1f3fe-200d-2642-fe0f.png",sheet_x:41,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F93E-1F3FF-200D-2642-FE0F",non_qualified:"1F93E-1F3FF-200D-2642",image:"1f93e-1f3ff-200d-2642-fe0f.png",sheet_x:41,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManPlayingHandball",b:"1F93E-200D-2642-FE0F",c:"1F93E-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[41,3],o:4,j:["打手球的男子"]},"woman-playing-handball":{skin_variations:{"1F3FB":{unified:"1F93E-1F3FB-200D-2640-FE0F",non_qualified:"1F93E-1F3FB-200D-2640",image:"1f93e-1f3fb-200d-2640-fe0f.png",sheet_x:40,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F93E-1F3FC-200D-2640-FE0F",non_qualified:"1F93E-1F3FC-200D-2640",image:"1f93e-1f3fc-200d-2640-fe0f.png",sheet_x:40,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F93E-1F3FD-200D-2640-FE0F",non_qualified:"1F93E-1F3FD-200D-2640",image:"1f93e-1f3fd-200d-2640-fe0f.png",sheet_x:41,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F93E-1F3FE-200D-2640-FE0F",non_qualified:"1F93E-1F3FE-200D-2640",image:"1f93e-1f3fe-200d-2640-fe0f.png",sheet_x:41,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F93E-1F3FF-200D-2640-FE0F",non_qualified:"1F93E-1F3FF-200D-2640",image:"1f93e-1f3ff-200d-2640-fe0f.png",sheet_x:41,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanPlayingHandball",b:"1F93E-200D-2640-FE0F",c:"1F93E-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[40,54],o:4,j:["打手球的女子"]},juggling:{skin_variations:{"1F3FB":{unified:"1F939-1F3FB",non_qualified:null,image:"1f939-1f3fb.png",sheet_x:40,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F939-1F3FC",non_qualified:null,image:"1f939-1f3fc.png",sheet_x:40,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F939-1F3FD",non_qualified:null,image:"1f939-1f3fd.png",sheet_x:40,sheet_y:29,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F939-1F3FE",non_qualified:null,image:"1f939-1f3fe.png",sheet_x:40,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F939-1F3FF",non_qualified:null,image:"1f939-1f3ff.png",sheet_x:40,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Juggling",b:"1F939",d:!0,e:!0,f:!0,h:!0,k:[40,26],o:4,j:["玩杂耍的人"]},"man-juggling":{skin_variations:{"1F3FB":{unified:"1F939-1F3FB-200D-2642-FE0F",non_qualified:"1F939-1F3FB-200D-2642",image:"1f939-1f3fb-200d-2642-fe0f.png",sheet_x:40,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F939-1F3FC-200D-2642-FE0F",non_qualified:"1F939-1F3FC-200D-2642",image:"1f939-1f3fc-200d-2642-fe0f.png",sheet_x:40,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F939-1F3FD-200D-2642-FE0F",non_qualified:"1F939-1F3FD-200D-2642",image:"1f939-1f3fd-200d-2642-fe0f.png",sheet_x:40,sheet_y:23,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F939-1F3FE-200D-2642-FE0F",non_qualified:"1F939-1F3FE-200D-2642",image:"1f939-1f3fe-200d-2642-fe0f.png",sheet_x:40,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F939-1F3FF-200D-2642-FE0F",non_qualified:"1F939-1F3FF-200D-2642",image:"1f939-1f3ff-200d-2642-fe0f.png",sheet_x:40,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManJuggling",b:"1F939-200D-2642-FE0F",c:"1F939-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[40,20],o:4,j:["男子玩杂耍"]},"woman-juggling":{skin_variations:{"1F3FB":{unified:"1F939-1F3FB-200D-2640-FE0F",non_qualified:"1F939-1F3FB-200D-2640",image:"1f939-1f3fb-200d-2640-fe0f.png",sheet_x:40,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F939-1F3FC-200D-2640-FE0F",non_qualified:"1F939-1F3FC-200D-2640",image:"1f939-1f3fc-200d-2640-fe0f.png",sheet_x:40,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F939-1F3FD-200D-2640-FE0F",non_qualified:"1F939-1F3FD-200D-2640",image:"1f939-1f3fd-200d-2640-fe0f.png",sheet_x:40,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F939-1F3FE-200D-2640-FE0F",non_qualified:"1F939-1F3FE-200D-2640",image:"1f939-1f3fe-200d-2640-fe0f.png",sheet_x:40,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F939-1F3FF-200D-2640-FE0F",non_qualified:"1F939-1F3FF-200D-2640",image:"1f939-1f3ff-200d-2640-fe0f.png",sheet_x:40,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanJuggling",b:"1F939-200D-2640-FE0F",c:"1F939-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[40,14],o:4,j:["女人玩杂耍"]},person_in_lotus_position:{skin_variations:{"1F3FB":{unified:"1F9D8-1F3FB",non_qualified:null,image:"1f9d8-1f3fb.png",sheet_x:49,sheet_y:32,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D8-1F3FB-200D-2640-FE0F"},"1F3FC":{unified:"1F9D8-1F3FC",non_qualified:null,image:"1f9d8-1f3fc.png",sheet_x:49,sheet_y:33,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D8-1F3FC-200D-2640-FE0F"},"1F3FD":{unified:"1F9D8-1F3FD",non_qualified:null,image:"1f9d8-1f3fd.png",sheet_x:49,sheet_y:34,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D8-1F3FD-200D-2640-FE0F"},"1F3FE":{unified:"1F9D8-1F3FE",non_qualified:null,image:"1f9d8-1f3fe.png",sheet_x:49,sheet_y:35,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D8-1F3FE-200D-2640-FE0F"},"1F3FF":{unified:"1F9D8-1F3FF",non_qualified:null,image:"1f9d8-1f3ff.png",sheet_x:49,sheet_y:36,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D8-1F3FF-200D-2640-FE0F"}},obsoleted_by:"1F9D8-200D-2640-FE0F",a:"PersoninLotusPosition",b:"1F9D8",d:!0,e:!0,f:!0,h:!0,k:[49,31],o:5,j:["的人盘腿坐"]},man_in_lotus_position:{skin_variations:{"1F3FB":{unified:"1F9D8-1F3FB-200D-2642-FE0F",non_qualified:"1F9D8-1F3FB-200D-2642",image:"1f9d8-1f3fb-200d-2642-fe0f.png",sheet_x:49,sheet_y:26,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D8-1F3FC-200D-2642-FE0F",non_qualified:"1F9D8-1F3FC-200D-2642",image:"1f9d8-1f3fc-200d-2642-fe0f.png",sheet_x:49,sheet_y:27,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D8-1F3FD-200D-2642-FE0F",non_qualified:"1F9D8-1F3FD-200D-2642",image:"1f9d8-1f3fd-200d-2642-fe0f.png",sheet_x:49,sheet_y:28,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D8-1F3FE-200D-2642-FE0F",non_qualified:"1F9D8-1F3FE-200D-2642",image:"1f9d8-1f3fe-200d-2642-fe0f.png",sheet_x:49,sheet_y:29,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D8-1F3FF-200D-2642-FE0F",non_qualified:"1F9D8-1F3FF-200D-2642",image:"1f9d8-1f3ff-200d-2642-fe0f.png",sheet_x:49,sheet_y:30,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManinLotusPosition",b:"1F9D8-200D-2642-FE0F",c:"1F9D8-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[49,25],o:5,j:["男人盘腿坐"]},woman_in_lotus_position:{skin_variations:{"1F3FB":{unified:"1F9D8-1F3FB-200D-2640-FE0F",non_qualified:"1F9D8-1F3FB-200D-2640",image:"1f9d8-1f3fb-200d-2640-fe0f.png",sheet_x:49,sheet_y:20,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D8-1F3FB"},"1F3FC":{unified:"1F9D8-1F3FC-200D-2640-FE0F",non_qualified:"1F9D8-1F3FC-200D-2640",image:"1f9d8-1f3fc-200d-2640-fe0f.png",sheet_x:49,sheet_y:21,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D8-1F3FC"},"1F3FD":{unified:"1F9D8-1F3FD-200D-2640-FE0F",non_qualified:"1F9D8-1F3FD-200D-2640",image:"1f9d8-1f3fd-200d-2640-fe0f.png",sheet_x:49,sheet_y:22,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D8-1F3FD"},"1F3FE":{unified:"1F9D8-1F3FE-200D-2640-FE0F",non_qualified:"1F9D8-1F3FE-200D-2640",image:"1f9d8-1f3fe-200d-2640-fe0f.png",sheet_x:49,sheet_y:23,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D8-1F3FE"},"1F3FF":{unified:"1F9D8-1F3FF-200D-2640-FE0F",non_qualified:"1F9D8-1F3FF-200D-2640",image:"1f9d8-1f3ff-200d-2640-fe0f.png",sheet_x:49,sheet_y:24,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D8-1F3FF"}},obsoletes:"1F9D8",a:"WomaninLotusPosition",b:"1F9D8-200D-2640-FE0F",c:"1F9D8-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[49,19],o:5,j:["女子盘腿坐"]},bath:{skin_variations:{"1F3FB":{unified:"1F6C0-1F3FB",non_qualified:null,image:"1f6c0-1f3fb.png",sheet_x:36,sheet_y:18,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6C0-1F3FC",non_qualified:null,image:"1f6c0-1f3fc.png",sheet_x:36,sheet_y:19,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6C0-1F3FD",non_qualified:null,image:"1f6c0-1f3fd.png",sheet_x:36,sheet_y:20,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6C0-1F3FE",non_qualified:null,image:"1f6c0-1f3fe.png",sheet_x:36,sheet_y:21,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6C0-1F3FF",non_qualified:null,image:"1f6c0-1f3ff.png",sheet_x:36,sheet_y:22,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Bath",b:"1F6C0",d:!0,e:!0,f:!0,h:!0,j:["人泡澡","干净","淋浴","浴室","clean","shower","bathroom"],k:[36,17],o:2},sleeping_accommodation:{skin_variations:{"1F3FB":{unified:"1F6CC-1F3FB",non_qualified:null,image:"1f6cc-1f3fb.png",sheet_x:36,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6CC-1F3FC",non_qualified:null,image:"1f6cc-1f3fc.png",sheet_x:36,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6CC-1F3FD",non_qualified:null,image:"1f6cc-1f3fd.png",sheet_x:36,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6CC-1F3FE",non_qualified:null,image:"1f6cc-1f3fe.png",sheet_x:36,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6CC-1F3FF",non_qualified:null,image:"1f6cc-1f3ff.png",sheet_x:36,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"SleepingAccommodation",b:"1F6CC",d:!0,e:!0,f:!0,h:!0,k:[36,29],o:2,j:["人在床上"]},people_holding_hands:{skin_variations:{"1F3FB-1F3FB":{unified:"1F9D1-1F3FB-200D-1F91D-200D-1F9D1-1F3FB",non_qualified:null,image:"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fb.png",sheet_x:46,sheet_y:39,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FC":{unified:"1F9D1-1F3FB-200D-1F91D-200D-1F9D1-1F3FC",non_qualified:null,image:"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fc.png",sheet_x:46,sheet_y:40,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FD":{unified:"1F9D1-1F3FB-200D-1F91D-200D-1F9D1-1F3FD",non_qualified:null,image:"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fd.png",sheet_x:46,sheet_y:41,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FE":{unified:"1F9D1-1F3FB-200D-1F91D-200D-1F9D1-1F3FE",non_qualified:null,image:"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fe.png",sheet_x:46,sheet_y:42,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FF":{unified:"1F9D1-1F3FB-200D-1F91D-200D-1F9D1-1F3FF",non_qualified:null,image:"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3ff.png",sheet_x:46,sheet_y:43,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FB":{unified:"1F9D1-1F3FC-200D-1F91D-200D-1F9D1-1F3FB",non_qualified:null,image:"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fb.png",sheet_x:46,sheet_y:44,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FC":{unified:"1F9D1-1F3FC-200D-1F91D-200D-1F9D1-1F3FC",non_qualified:null,image:"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fc.png",sheet_x:46,sheet_y:45,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FD":{unified:"1F9D1-1F3FC-200D-1F91D-200D-1F9D1-1F3FD",non_qualified:null,image:"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fd.png",sheet_x:46,sheet_y:46,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FE":{unified:"1F9D1-1F3FC-200D-1F91D-200D-1F9D1-1F3FE",non_qualified:null,image:"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fe.png",sheet_x:46,sheet_y:47,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FF":{unified:"1F9D1-1F3FC-200D-1F91D-200D-1F9D1-1F3FF",non_qualified:null,image:"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3ff.png",sheet_x:46,sheet_y:48,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FD-1F3FB":{unified:"1F9D1-1F3FD-200D-1F91D-200D-1F9D1-1F3FB",non_qualified:null,image:"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fb.png",sheet_x:46,sheet_y:49,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FC":{unified:"1F9D1-1F3FD-200D-1F91D-200D-1F9D1-1F3FC",non_qualified:null,image:"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fc.png",sheet_x:46,sheet_y:50,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FD":{unified:"1F9D1-1F3FD-200D-1F91D-200D-1F9D1-1F3FD",non_qualified:null,image:"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fd.png",sheet_x:46,sheet_y:51,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FE":{unified:"1F9D1-1F3FD-200D-1F91D-200D-1F9D1-1F3FE",non_qualified:null,image:"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fe.png",sheet_x:46,sheet_y:52,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FD-1F3FF":{unified:"1F9D1-1F3FD-200D-1F91D-200D-1F9D1-1F3FF",non_qualified:null,image:"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3ff.png",sheet_x:46,sheet_y:53,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FE-1F3FB":{unified:"1F9D1-1F3FE-200D-1F91D-200D-1F9D1-1F3FB",non_qualified:null,image:"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fb.png",sheet_x:46,sheet_y:54,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FC":{unified:"1F9D1-1F3FE-200D-1F91D-200D-1F9D1-1F3FC",non_qualified:null,image:"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fc.png",sheet_x:46,sheet_y:55,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FD":{unified:"1F9D1-1F3FE-200D-1F91D-200D-1F9D1-1F3FD",non_qualified:null,image:"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fd.png",sheet_x:46,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FE":{unified:"1F9D1-1F3FE-200D-1F91D-200D-1F9D1-1F3FE",non_qualified:null,image:"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fe.png",sheet_x:47,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FF":{unified:"1F9D1-1F3FE-200D-1F91D-200D-1F9D1-1F3FF",non_qualified:null,image:"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3ff.png",sheet_x:47,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FF-1F3FB":{unified:"1F9D1-1F3FF-200D-1F91D-200D-1F9D1-1F3FB",non_qualified:null,image:"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fb.png",sheet_x:47,sheet_y:2,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FC":{unified:"1F9D1-1F3FF-200D-1F91D-200D-1F9D1-1F3FC",non_qualified:null,image:"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fc.png",sheet_x:47,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FD":{unified:"1F9D1-1F3FF-200D-1F91D-200D-1F9D1-1F3FD",non_qualified:null,image:"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fd.png",sheet_x:47,sheet_y:4,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FE":{unified:"1F9D1-1F3FF-200D-1F91D-200D-1F9D1-1F3FE",non_qualified:null,image:"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fe.png",sheet_x:47,sheet_y:5,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FF":{unified:"1F9D1-1F3FF-200D-1F91D-200D-1F9D1-1F3FF",non_qualified:null,image:"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3ff.png",sheet_x:47,sheet_y:6,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"PeopleHoldingHands",b:"1F9D1-200D-1F91D-200D-1F9D1",d:!0,e:!0,f:!0,h:!0,k:[46,38],o:12,j:["人们牵手"]},two_women_holding_hands:{skin_variations:{"1F3FB":{unified:"1F46D-1F3FB",non_qualified:null,image:"1f46d-1f3fb.png",sheet_x:21,sheet_y:12,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F46D-1F3FC",non_qualified:null,image:"1f46d-1f3fc.png",sheet_x:21,sheet_y:13,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F46D-1F3FD",non_qualified:null,image:"1f46d-1f3fd.png",sheet_x:21,sheet_y:14,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F46D-1F3FE",non_qualified:null,image:"1f46d-1f3fe.png",sheet_x:21,sheet_y:15,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F46D-1F3FF",non_qualified:null,image:"1f46d-1f3ff.png",sheet_x:21,sheet_y:16,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FC":{unified:"1F469-1F3FB-200D-1F91D-200D-1F469-1F3FC",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f469-1f3fc.png",sheet_x:21,sheet_y:17,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FD":{unified:"1F469-1F3FB-200D-1F91D-200D-1F469-1F3FD",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f469-1f3fd.png",sheet_x:21,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FE":{unified:"1F469-1F3FB-200D-1F91D-200D-1F469-1F3FE",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f469-1f3fe.png",sheet_x:21,sheet_y:19,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FF":{unified:"1F469-1F3FB-200D-1F91D-200D-1F469-1F3FF",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f469-1f3ff.png",sheet_x:21,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FB":{unified:"1F469-1F3FC-200D-1F91D-200D-1F469-1F3FB",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f469-1f3fb.png",sheet_x:21,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FD":{unified:"1F469-1F3FC-200D-1F91D-200D-1F469-1F3FD",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f469-1f3fd.png",sheet_x:21,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FE":{unified:"1F469-1F3FC-200D-1F91D-200D-1F469-1F3FE",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f469-1f3fe.png",sheet_x:21,sheet_y:23,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FF":{unified:"1F469-1F3FC-200D-1F91D-200D-1F469-1F3FF",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f469-1f3ff.png",sheet_x:21,sheet_y:24,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FD-1F3FB":{unified:"1F469-1F3FD-200D-1F91D-200D-1F469-1F3FB",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f469-1f3fb.png",sheet_x:21,sheet_y:25,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FC":{unified:"1F469-1F3FD-200D-1F91D-200D-1F469-1F3FC",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f469-1f3fc.png",sheet_x:21,sheet_y:26,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FE":{unified:"1F469-1F3FD-200D-1F91D-200D-1F469-1F3FE",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f469-1f3fe.png",sheet_x:21,sheet_y:27,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FD-1F3FF":{unified:"1F469-1F3FD-200D-1F91D-200D-1F469-1F3FF",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f469-1f3ff.png",sheet_x:21,sheet_y:28,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FE-1F3FB":{unified:"1F469-1F3FE-200D-1F91D-200D-1F469-1F3FB",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f469-1f3fb.png",sheet_x:21,sheet_y:29,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FC":{unified:"1F469-1F3FE-200D-1F91D-200D-1F469-1F3FC",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f469-1f3fc.png",sheet_x:21,sheet_y:30,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FD":{unified:"1F469-1F3FE-200D-1F91D-200D-1F469-1F3FD",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f469-1f3fd.png",sheet_x:21,sheet_y:31,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FF":{unified:"1F469-1F3FE-200D-1F91D-200D-1F469-1F3FF",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f469-1f3ff.png",sheet_x:21,sheet_y:32,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FF-1F3FB":{unified:"1F469-1F3FF-200D-1F91D-200D-1F469-1F3FB",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f469-1f3fb.png",sheet_x:21,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FC":{unified:"1F469-1F3FF-200D-1F91D-200D-1F469-1F3FC",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f469-1f3fc.png",sheet_x:21,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FD":{unified:"1F469-1F3FF-200D-1F91D-200D-1F469-1F3FD",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f469-1f3fd.png",sheet_x:21,sheet_y:35,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FE":{unified:"1F469-1F3FF-200D-1F91D-200D-1F469-1F3FE",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f469-1f3fe.png",sheet_x:21,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"TwoWomenHoldingHands",b:"1F46D",d:!0,e:!0,f:!0,h:!0,j:["女士牵手","双","友谊","夫妇","爱","喜欢","女性","人","人","pair","friendship","couple","love","like","female","people","human"],k:[21,11],n:["women_holding_hands"],o:2},couple:{skin_variations:{"1F3FB":{unified:"1F46B-1F3FB",non_qualified:null,image:"1f46b-1f3fb.png",sheet_x:20,sheet_y:17,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F46B-1F3FC",non_qualified:null,image:"1f46b-1f3fc.png",sheet_x:20,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F46B-1F3FD",non_qualified:null,image:"1f46b-1f3fd.png",sheet_x:20,sheet_y:19,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F46B-1F3FE",non_qualified:null,image:"1f46b-1f3fe.png",sheet_x:20,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F46B-1F3FF",non_qualified:null,image:"1f46b-1f3ff.png",sheet_x:20,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FC":{unified:"1F469-1F3FB-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:20,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FD":{unified:"1F469-1F3FB-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:20,sheet_y:23,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FE":{unified:"1F469-1F3FB-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:20,sheet_y:24,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FF":{unified:"1F469-1F3FB-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:20,sheet_y:25,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FB":{unified:"1F469-1F3FC-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:20,sheet_y:26,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FD":{unified:"1F469-1F3FC-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:20,sheet_y:27,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FE":{unified:"1F469-1F3FC-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:20,sheet_y:28,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FF":{unified:"1F469-1F3FC-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:20,sheet_y:29,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FB":{unified:"1F469-1F3FD-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:20,sheet_y:30,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FC":{unified:"1F469-1F3FD-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:20,sheet_y:31,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FE":{unified:"1F469-1F3FD-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:20,sheet_y:32,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FF":{unified:"1F469-1F3FD-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:20,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FB":{unified:"1F469-1F3FE-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:20,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FC":{unified:"1F469-1F3FE-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:20,sheet_y:35,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FD":{unified:"1F469-1F3FE-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:20,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FF":{unified:"1F469-1F3FE-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:20,sheet_y:37,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FB":{unified:"1F469-1F3FF-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:20,sheet_y:38,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FC":{unified:"1F469-1F3FF-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:20,sheet_y:39,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FD":{unified:"1F469-1F3FF-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:20,sheet_y:40,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FE":{unified:"1F469-1F3FF-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:20,sheet_y:41,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManandWomanHoldingHands",b:"1F46B",d:!0,e:!0,f:!0,h:!0,j:["女人和男人牵手","双","人","人","爱","日期","约会","喜欢","感情","情人","婚","pair","people","human","love","date","dating","like","affection","valentines","marriage"],k:[20,16],n:["man_and_woman_holding_hands","woman_and_man_holding_hands"],o:2},two_men_holding_hands:{skin_variations:{"1F3FB":{unified:"1F46C-1F3FB",non_qualified:null,image:"1f46c-1f3fb.png",sheet_x:20,sheet_y:43,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F46C-1F3FC",non_qualified:null,image:"1f46c-1f3fc.png",sheet_x:20,sheet_y:44,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F46C-1F3FD",non_qualified:null,image:"1f46c-1f3fd.png",sheet_x:20,sheet_y:45,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F46C-1F3FE",non_qualified:null,image:"1f46c-1f3fe.png",sheet_x:20,sheet_y:46,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F46C-1F3FF",non_qualified:null,image:"1f46c-1f3ff.png",sheet_x:20,sheet_y:47,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FC":{unified:"1F468-1F3FB-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f468-1f3fb-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:20,sheet_y:48,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FD":{unified:"1F468-1F3FB-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f468-1f3fb-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:20,sheet_y:49,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FE":{unified:"1F468-1F3FB-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f468-1f3fb-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:20,sheet_y:50,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FF":{unified:"1F468-1F3FB-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f468-1f3fb-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:20,sheet_y:51,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FB":{unified:"1F468-1F3FC-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f468-1f3fc-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:20,sheet_y:52,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FD":{unified:"1F468-1F3FC-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f468-1f3fc-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:20,sheet_y:53,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FE":{unified:"1F468-1F3FC-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f468-1f3fc-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:20,sheet_y:54,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FF":{unified:"1F468-1F3FC-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f468-1f3fc-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:20,sheet_y:55,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FD-1F3FB":{unified:"1F468-1F3FD-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f468-1f3fd-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:20,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FC":{unified:"1F468-1F3FD-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f468-1f3fd-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:21,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FE":{unified:"1F468-1F3FD-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f468-1f3fd-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:21,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FD-1F3FF":{unified:"1F468-1F3FD-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f468-1f3fd-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:21,sheet_y:2,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FE-1F3FB":{unified:"1F468-1F3FE-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f468-1f3fe-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:21,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FC":{unified:"1F468-1F3FE-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f468-1f3fe-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:21,sheet_y:4,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FD":{unified:"1F468-1F3FE-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f468-1f3fe-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:21,sheet_y:5,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FF":{unified:"1F468-1F3FE-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f468-1f3fe-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:21,sheet_y:6,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FF-1F3FB":{unified:"1F468-1F3FF-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f468-1f3ff-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:21,sheet_y:7,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FC":{unified:"1F468-1F3FF-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f468-1f3ff-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:21,sheet_y:8,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FD":{unified:"1F468-1F3FF-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f468-1f3ff-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:21,sheet_y:9,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FE":{unified:"1F468-1F3FF-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f468-1f3ff-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:21,sheet_y:10,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"TwoMenHoldingHands",b:"1F46C",d:!0,e:!0,f:!0,h:!0,j:["男士牵手","双","夫妇","爱","喜欢","溴","友谊","人","人","pair","couple","love","like","bromance","friendship","people","human"],k:[20,42],n:["men_holding_hands"],o:2},couplekiss:{obsoleted_by:"1F469-200D-2764-FE0F-200D-1F48B-200D-1F468",a:"Kiss",b:"1F48F",d:!0,e:!0,f:!0,h:!0,k:[25,25],o:2,j:["亲吻"]},"woman-kiss-man":{obsoletes:"1F48F",a:"WomanKissMan",b:"1F469-200D-2764-FE0F-200D-1F48B-200D-1F468",c:"1F469-200D-2764-200D-1F48B-200D-1F468",d:!0,e:!0,f:!0,h:!0,k:[20,7],o:2,j:["男人和女人接吻"]},"man-kiss-man":{a:"ManKissMan",b:"1F468-200D-2764-FE0F-200D-1F48B-200D-1F468",c:"1F468-200D-2764-200D-1F48B-200D-1F468",d:!0,e:!0,f:!0,h:!0,k:[17,21],o:2,j:["男人与男人亲吻"]},"woman-kiss-woman":{a:"WomanKissWoman",b:"1F469-200D-2764-FE0F-200D-1F48B-200D-1F469",c:"1F469-200D-2764-200D-1F48B-200D-1F469",d:!0,e:!0,f:!0,h:!0,k:[20,8],o:2,j:["女人和女人亲吻"]},couple_with_heart:{obsoleted_by:"1F469-200D-2764-FE0F-200D-1F468",a:"CouplewithHeart",b:"1F491",d:!0,e:!0,f:!0,h:!0,k:[25,27],o:2,j:["情侣"]},"woman-heart-man":{obsoletes:"1F491",a:"WomanHeartMan",b:"1F469-200D-2764-FE0F-200D-1F468",c:"1F469-200D-2764-200D-1F468",d:!0,e:!0,f:!0,h:!0,k:[20,5],o:2,j:["异性情侣"]},"man-heart-man":{a:"ManHeartMan",b:"1F468-200D-2764-FE0F-200D-1F468",c:"1F468-200D-2764-200D-1F468",d:!0,e:!0,f:!0,h:!0,k:[17,20],o:2,j:["男性情侣"]},"woman-heart-woman":{a:"WomanHeartWoman",b:"1F469-200D-2764-FE0F-200D-1F469",c:"1F469-200D-2764-200D-1F469",d:!0,e:!0,f:!0,h:!0,k:[20,6],o:2,j:["女性情侣"]},family:{obsoleted_by:"1F468-200D-1F469-200D-1F466",a:"Family",b:"1F46A",d:!0,e:!0,f:!0,h:!0,k:[20,15],n:["man-woman-boy"],o:2,j:["家庭"]},"man-woman-boy":{obsoletes:"1F46A",a:"ManWomanBoy",b:"1F468-200D-1F469-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,33],n:["family"],o:2,j:["一位男士一位女士带一个男孩的家庭"]},"man-woman-girl":{a:"ManWomanGirl",b:"1F468-200D-1F469-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[15,35],o:2,j:["一位男士一位女士带一个女孩的家庭"]},"man-woman-girl-boy":{a:"ManWomanGirlBoy",b:"1F468-200D-1F469-200D-1F467-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,36],o:2,j:["一位男士一位女士带一个男孩一个女孩的家庭"]},"man-woman-boy-boy":{a:"ManWomanBoyBoy",b:"1F468-200D-1F469-200D-1F466-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,34],o:2,j:["一位男士一位女士带两个男孩的家庭"]},"man-woman-girl-girl":{a:"ManWomanGirlGirl",b:"1F468-200D-1F469-200D-1F467-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[15,37],o:2,j:["一位男士一位女士带两个女孩的家庭"]},"man-man-boy":{a:"ManManBoy",b:"1F468-200D-1F468-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,28],o:2,j:["两位男士带一个男孩的家庭"]},"man-man-girl":{a:"ManManGirl",b:"1F468-200D-1F468-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[15,30],o:2,j:["两位男士带一个女孩的家庭"]},"man-man-girl-boy":{a:"ManManGirlBoy",b:"1F468-200D-1F468-200D-1F467-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,31],o:2,j:["两位男士带一个男孩一个女孩的家庭"]},"man-man-boy-boy":{a:"ManManBoyBoy",b:"1F468-200D-1F468-200D-1F466-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,29],o:2,j:["两位男士带两个男孩的家庭"]},"man-man-girl-girl":{a:"ManManGirlGirl",b:"1F468-200D-1F468-200D-1F467-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[15,32],o:2,j:["两位男士带两个女孩的家庭"]},"woman-woman-boy":{a:"WomanWomanBoy",b:"1F469-200D-1F469-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[18,18],o:2,j:["两位妇女带一个男孩的家庭"]},"woman-woman-girl":{a:"WomanWomanGirl",b:"1F469-200D-1F469-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[18,20],o:2,j:["两位妇女带一个女孩的家庭"]},"woman-woman-girl-boy":{a:"WomanWomanGirlBoy",b:"1F469-200D-1F469-200D-1F467-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[18,21],o:2,j:["两位妇女带一个男孩一个女孩的家庭"]},"woman-woman-boy-boy":{a:"WomanWomanBoyBoy",b:"1F469-200D-1F469-200D-1F466-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[18,19],o:2,j:["两位妇女带两个男孩的家庭"]},"woman-woman-girl-girl":{a:"WomanWomanGirlGirl",b:"1F469-200D-1F469-200D-1F467-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[18,22],o:2,j:["两位妇女带两个女孩的家庭"]},"man-boy":{a:"ManBoy",b:"1F468-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,24],o:4,j:["男士带一个男孩的家庭"]},"man-boy-boy":{a:"ManBoyBoy",b:"1F468-200D-1F466-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,23],o:4,j:["男士带两个男孩的家庭"]},"man-girl":{a:"ManGirl",b:"1F468-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[15,27],o:4,j:["男士带女孩的家庭"]},"man-girl-boy":{a:"ManGirlBoy",b:"1F468-200D-1F467-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,25],o:4,j:["男士带一个男孩一个女孩的家庭"]},"man-girl-girl":{a:"ManGirlGirl",b:"1F468-200D-1F467-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[15,26],o:4,j:["男士带两个女孩的家庭"]},"woman-boy":{a:"WomanBoy",b:"1F469-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[18,14],o:4,j:["妇女带一个男孩的家庭"]},"woman-boy-boy":{a:"WomanBoyBoy",b:"1F469-200D-1F466-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[18,13],o:4,j:["妇女带两个男孩的家庭"]},"woman-girl":{a:"WomanGirl",b:"1F469-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[18,17],o:4,j:["妇女带女孩的家庭"]},"woman-girl-boy":{a:"WomanGirlBoy",b:"1F469-200D-1F467-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[18,15],o:4,j:["妇女带一个男孩一个女孩的家庭"]},"woman-girl-girl":{a:"WomanGirlGirl",b:"1F469-200D-1F467-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[18,16],o:4,j:["妇女带两个女孩的家庭"]},speaking_head_in_silhouette:{a:"SpeakingHeadinSilhouette",b:"1F5E3-FE0F",c:"1F5E3",d:!0,e:!0,f:!0,h:!0,k:[30,25],o:2,j:["说话者"]},bust_in_silhouette:{a:"BustinSilhouette",b:"1F464",d:!0,e:!0,f:!0,h:!0,j:["半身剪影","用户","人","人","user","person","human"],k:[14,24],o:2},busts_in_silhouette:{a:"BustsinSilhouette",b:"1F465",d:!0,e:!0,f:!0,h:!0,j:["半身剪影（两人）","用户","人","人","群","团队","user","person","human","group","team"],k:[14,25],o:2},footprints:{a:"Footprints",b:"1F463",d:!0,e:!0,f:!0,h:!0,j:["足迹","脚","跟踪","走","海滩","feet","tracking","walking","beach"],k:[14,23],o:2}},Cse={raised_hand:"hand",satisfied:"laughing",tshirt:"shirt",hand_with_index_and_middle_fingers_crossed:"crossed_fingers",sign_of_the_horns:"the_horns",grinning_face_with_star_eyes:"star-struck",reversed_hand_with_middle_finger_extended:"middle_finger",thumbsup:"+1",thumbsdown:"-1",punch:"facepunch",grinning_face_with_one_large_and_one_small_eye:"zany_face",shoe:"mans_shoe",smiling_face_with_smiling_eyes_and_hand_covering_mouth:"face_with_hand_over_mouth",face_with_finger_covering_closed_lips:"shushing_face",face_with_one_eyebrow_raised:"face_with_raised_eyebrow",face_with_open_mouth_vomiting:"face_vomiting",cooking:"fried_egg","flag-cn":"cn",shocked_face_with_exploding_head:"exploding_head",paw_prints:"feet","flag-de":"de",telephone:"phone","flag-es":"es",red_car:"car",flipper:"dolphin","flag-fr":"fr",uk:"gb","flag-gb":"gb",serious_face_with_symbols_covering_mouth:"face_with_symbols_on_mouth",poop:"hankey",shit:"hankey",honeybee:"bee",staff_of_aesculapius:"medical_symbol",lantern:"izakaya_lantern",open_book:"book",sailboat:"boat",knife:"hocho","flag-it":"it",heavy_exclamation_mark:"exclamation","flag-jp":"jp",envelope:"email","flag-kr":"kr",collision:"boom",pencil:"memo",waxing_gibbous_moon:"moon",mother_christmas:"mrs_claus",sun_small_cloud:"mostly_sunny",sun_behind_cloud:"barely_sunny",sun_behind_rain_cloud:"partly_sunny_rain",lightning_cloud:"lightning",tornado_cloud:"tornado","flag-ru":"ru",running:"runner","flag-us":"us",women_holding_hands:"two_women_holding_hands",man_and_woman_holding_hands:"couple",woman_and_man_holding_hands:"couple",men_holding_hands:"two_men_holding_hands","man-woman-boy":"family",family:"man-woman-boy"},rp={compressed:Fse,categories:wse,emojis:Ese,aliases:Cse},kse=!1,Tse=[{id:"xuexibangong",name:"学习办公",emojis:["newspaper-folding","notebook-one","notebook","repair","ruler","code","analysis","chart-graph","stopwatch-start","arithmetic-one","arithmetic","screenshot","pie","pie-two","pie-three","pie-four","pie-five","pie-six","pie-seven","stopwatch","mind-mapping","average","bubble-chart","curve-adjustment","trend-two","schedule","flask","triangle-ruler","chart-scatter","color-card","time","experiment-one","experiment","cuvette","test-tube","vial","book","book-one","data-sheet","data-screen","chart-pie-one","speed-one","chart-histogram-one","chart-histogram-two","chart-histogram","viencharts","thermometer","folder-one","add-text-two","text-recognition","display","picture-album","block","degree-hat","voice-input","compass","chart-proportion","chart-line-area","chart-line","histogram","bullet-map","components","maximum","min","chart-stock","kagi-map","table-lamp","pencil 1"]},{id:"shumashebei",name:"数码设备",emojis:["laptop","laptop-computer","bolt-one","plug","charging-treasure","hair-dryer-one","sd-card","printer","battery-storage","sim","tv-one","digital-watches","headset-two","mac-finder","server","toolkit","cd","rocket-one","robot-one","timer","new-computer","surveillance-cameras-two","surveillance-cameras","keyboard-one","receiver","toilet","thunderbolt","iphone","poker","switch-nintendo","devices","camera-one","radio","hand-painted-plate","mouse-one","usb-one","projector-two","webcam","drone-one","drone","washing-machine-one","camera-two","cpu","speaker","seal","hard-disk","gamepad","round-socket","electronic-door-lock","camera-three","dvi","ipad","sd","usb-type-c","usb-memory-stick","disk-one","camera"]},{id:"IT",name:"IT",emojis:["shield-add","helpcenter","protect","protection","table-file","bug","file-question","code-one","file-code","folder-code","translate","share-one","share-sys","connection-box","broadcast","date-comes-back","activity-source","loading-one","file-hash","file-tips","bluetooth","connection-point","connect","link-three","link","browser","file-staff","hourglass","setting-two","setting-config","video-one","inbox","folder-focus","home","tree-list","data","database-success","database-code","database-point","database-time","data-switching","data-display","cast-screen","picture","network-tree","web-page","file-text","doc-search-two","file-excel","file-gif","file-jpg","file-pdf","file-word","file-cabinet","folder-download","file-search-two","wifi","system","picture-album","view-list","agreement","signal","file-music","audio-file","mail"]},{id:"jihefuhao",name:"几何符号",emojis:["misaligned-semicircle","symmetry","multi-triangular","geometric-flowers","stereo-perspective","two-triangles-two","two-ellipses","hexagon-strip","six-points","cross-ring-two","cube-three","three-hexagons","three-triangles","triangle-round-rectangle","triangular-pyramid","three-slashes","symbol-double-x","four-leaves","rectangular-circular-separation","rectangular-circular-connection","endless","asterisk","two-triangles","whirlwind","circles-seven","six-circular-connection","round-distortion","smart-optimization","cones","coordinate-system","percentage","help","caution","bitcoin","success","division","error","share-two","symbol","close","plus","plus-cross","minus","forbid","ce-marking","trademark","add-one","check-one","check","info","star","correct","attention","figma-component","vip"]},{id:"shenghuo",name:"生活",emojis:["airpods","single-bed","hanger","door-handle","alarm-clock","sofa-two","sofa","double-bed","hanger-two","tub","hair-brush","english-mustache","cosmetic-brush","barber-clippers","face-powder","makeups","beauty-instrument","comb","shaver-one","facial-cleanser","nail-polish-one","paint 1","prescription","injection","brain","weight","cardioelectric","medicine-bottle-one","medical-box","nutrition","exchange-four","workbench","shopping","stock-market","funds","finance","gift","financing-one","wallet-one","wallet-two","financing-two","flash-payment","commodity","water-rate-two","water-rate","water-level","consume","bank-card","bachelor-cap-one","high-heeled-shoes","briefcase","basketball-clothes","necktie","slippers-one","slippers","perfume","theme","diamond-ring","diamonds","t-shirt","teeth","eyes","glasses","spanner 1"]},{id:"biaoqing",name:"表情",emojis:["distraught-face","confused-face","frowning-face-whit-open-mouth","emotion-unhappy","grimacing-face","worried-face","upside-down-face","pouting-face","surprised-face-with-open-mouth","surprised-face-with-open-big-mouth","sly-face-whit-smile","weary-face","emotion-happy","grinning-face","slightly-frowning-face-whit-open-mouth","angry-face","disappointed-face","slightly-smiling-face","expressionless-face","face-without-mouth","smiling-face","grinning-face-with-squinting-eyes","anguished-face","winking-face","winking-face-with-open-eyes","astonished-face","grinning-face-with-tightly-closed-eyes-open-mouth","loudly-crying-face-whit-open-mouth","grinning-face-with-open-mouth","neutral-face"]},{id:"tiyu",name:"体育",emojis:["baseball-bat","whistling","play-volleyball","balance-one","dumbbel-line","chess-one","torch","muscle","dumbbell","baokemeng","weightlifting","basketball","court","basketball-stand","skating","volleyball","treadmill-two","treadmill","treadmill-one","riding","target-two","boxing","rope-skipping","helmet","tennis","badminton","sport","sporting","football","soccer","soccer-one","baby-feet","baby-taste","party-balloon","steoller","heart-ballon","rocking-horse","sleep 1"]},{id:"lvxingdidian",name:"旅行地点",emojis:["eiffel-tower","pagoda","tower-of-pisa","museum-one","castle","city-gate","city-one","city","gate","light-house","dubai","elevator","pearl-of-the-orient","windmill-one","factory-building","palace","monument-one","monument-two","building-four","building-one","building-three","church-one","church-two","hotel","arc-de-triomphe","fence-one","circus","maya","ferris-wheel","brdige-three","bridge-one","bridge-two","home-two","death-star","tower","booth","future-build-one","signal-tower-one","chimney","dome","fence-two","chinese-pavilion","clock-tower","mark","set-off","ship","sailboat-one","road-sign","steering-wheel","airplane","high-speed-rail","bus-one","cruise","aviation","sailing","passport-one","landing","cable-car","journey","tour-bus","tickets-one","mounted","flag","take-off-one","gps","hot-air-balloon","pennant","mountain","world","railway","parking","luggage","vacation","coconut-tree","camp","local","guide-board","subway","transporter"]},{id:"yingyinyouxi",name:"影音游戏",emojis:["play","record","fm","movie","headset","arrow-keys","piano","record-disc","trophy","film","skull","voice","puzzle","poker","monitor","acoustic","handle-square","handle-triangle","handle-up","handle-down","handle-right","handle-round","handle-left","handle-a","handle-b","handle-c","handle-x","handle-y","handle-z","performance","music-one","music","music-rhythm","music-cd","movie-board","ghost","game","game-ps","game-handle","entertainment"]},{id:"dongwuzhiwu",name:"动物植物",emojis:["bat","elephant","pigeon","dog","dolphin","hippo","monkey","butterfly","whale","deer","cat","owl","bee","bird","cattle","frog","dog-zodiac","monkey-zodiac","tiger-zodiac","chicken-zodiac","dragon-zodiac","horse-zodiac","cattle-zodiac","snake-zodiac","mouse-zodiac","rabbit-zodiac","sheep-zodiac","pig-zodiac","koala-bear","rabbit","bear","panda","duck","eagle","fish-one","pig","pinwheel","windmill-two","fruiter","outdoor","blossom","fire-two","bloom","christmas-tree","tree","tree-one","sapling","leaves","christmas-tree-one","cactus","leaves-two","seedling"]},{id:"shiwuyinliao",name:"食物饮料",emojis:["lollipop","icecream-three","icecream-two","pineapple","fork-spoon","tea","shovel-one","orange","chef-hat-one","garlic","shrimp","cake-three","cake","oven","tomato","goblet","bone","juice","hamburger","carrot","chafing-dish-one","hot-pot-one","hot-pot","chicken","chicken-leg","liqueur","measuring-cup","eggplant","nut","egg","bottle-one","chopsticks-fork","chili","pear","rice","bread-one","bread","bowl","noodles","cheese","pumpkin","lemon","orange-one","milk-one","milk","avocado-one","crab","cooking","beer","beer-mug","apple-one","bottle-two","vegetables","barbecue","birthday-cake","candy","peach","doughnut","shovel","pot","spoon","peas","bowl-one","watermelon","banana","icecream-one","drink","cherry","chafing-dish","french-fries"]},{id:"pinpai",name:"品牌",emojis:["android","tiktok","messages","new-lark","google","health","facebook-one","facebook","browser-chrome","browser-safari","friends-circle","apple","ulikecam","facetime","taobao","twitter","weibo","windows","wechat","app-store","youtube","alipay","dribble","bytedance","adobe-illustrate","adobe-indesign","adobe-lightroom","adobe-photoshop","behance","figma","foursquare","github","github-one","gitlab","html-five","instagram-one","instagram","paypal","sketch","telegram","tumblr"]}],vse={"newspaper-folding":{name:"newspaper-folding",keywords:["报纸折叠","newspaper-folding"]},"notebook-one":{name:"notebook-one",keywords:["笔记本","notebook-one"]},notebook:{name:"notebook",keywords:["笔记本","notebook"]},repair:{name:"repair",keywords:["编辑","repair"]},ruler:{name:"ruler",keywords:["尺子","ruler"]},code:{name:"code",keywords:["代码","code"]},analysis:{name:"analysis",keywords:["分析","analysis"]},"chart-graph":{name:"chart-graph",keywords:["关系图","chart-graph"]},"stopwatch-start":{name:"stopwatch-start",keywords:["计时器","stopwatch-start"]},"arithmetic-one":{name:"arithmetic-one",keywords:["计算","arithmetic-one"]},arithmetic:{name:"arithmetic",keywords:["计算","arithmetic"]},screenshot:{name:"screenshot",keywords:["截屏","screenshot"]},pie:{name:"pie",keywords:["进度","pie"]},"pie-two":{name:"pie-two",keywords:["进度2","pie-two"]},"pie-three":{name:"pie-three",keywords:["进度3","pie-three"]},"pie-four":{name:"pie-four",keywords:["进度4","pie-four"]},"pie-five":{name:"pie-five",keywords:["进度5","pie-five"]},"pie-six":{name:"pie-six",keywords:["进度6","pie-six"]},"pie-seven":{name:"pie-seven",keywords:["进度7","pie-seven"]},stopwatch:{name:"stopwatch",keywords:["秒表","stopwatch"]},"mind-mapping":{name:"mind-mapping",keywords:["脑图","mind-mapping"]},average:{name:"average",keywords:["平均值","average"]},"bubble-chart":{name:"bubble-chart",keywords:["气泡图","bubble-chart"]},"curve-adjustment":{name:"curve-adjustment",keywords:["曲线调整","curve-adjustment"]},"trend-two":{name:"trend-two",keywords:["趋势","trend-two"]},schedule:{name:"schedule",keywords:["日程表","schedule"]},flask:{name:"flask",keywords:["三角杯","flask"]},"triangle-ruler":{name:"triangle-ruler",keywords:["三角尺","triangle-ruler"]},"chart-scatter":{name:"chart-scatter",keywords:["散点图","chart-scatter"]},"color-card":{name:"color-card",keywords:["色卡","color-card"]},time:{name:"time",keywords:["时间","time"]},"experiment-one":{name:"experiment-one",keywords:["实验","experiment-one"]},experiment:{name:"experiment",keywords:["实验","experiment"]},cuvette:{name:"cuvette",keywords:["试管","cuvette"]},"test-tube":{name:"test-tube",keywords:["试管","test-tube"]},vial:{name:"vial",keywords:["试管","vial"]},book:{name:"book",keywords:["书籍","book"]},"book-one":{name:"book-one",keywords:["书籍1","book-one"]},"data-sheet":{name:"data-sheet",keywords:["数据表","data-sheet"]},"data-screen":{name:"data-screen",keywords:["数据看板","data-screen"]},"chart-pie-one":{name:"chart-pie-one",keywords:["数据图","chart-pie-one"]},"speed-one":{name:"speed-one",keywords:["速度","speed-one"]},"chart-histogram-one":{name:"chart-histogram-one",keywords:["条形图","chart-histogram-one"]},"chart-histogram-two":{name:"chart-histogram-two",keywords:["条形图","chart-histogram-two"]},"chart-histogram":{name:"chart-histogram",keywords:["条形图","chart-histogram"]},viencharts:{name:"viencharts",keywords:["维恩图","viencharts"]},thermometer:{name:"thermometer",keywords:["温度计","thermometer"]},"folder-one":{name:"folder-one",keywords:["文件夹1","folder-one"]},"add-text-two":{name:"add-text-two",keywords:["文字","add-text-two"]},"text-recognition":{name:"text-recognition",keywords:["文字识别","text-recognition"]},display:{name:"display",keywords:["显示屏","display"]},"picture-album":{name:"picture-album",keywords:["相册","picture-album"]},block:{name:"block",keywords:["行内公式","block"]},"degree-hat":{name:"degree-hat",keywords:["学位帽","degree-hat"]},"voice-input":{name:"voice-input",keywords:["语音文字","voice-input"]},compass:{name:"compass",keywords:["圆规","compass"]},"chart-proportion":{name:"chart-proportion",keywords:["占比图","chart-proportion"]},"chart-line-area":{name:"chart-line-area",keywords:["折线面积图","chart-line-area"]},"chart-line":{name:"chart-line",keywords:["折线图","chart-line"]},histogram:{name:"histogram",keywords:["直方图","histogram"]},"bullet-map":{name:"bullet-map",keywords:["子弹图","bullet-map"]},components:{name:"components",keywords:["组件","components"]},maximum:{name:"maximum",keywords:["最大值","maximum"]},min:{name:"min",keywords:["最小值","min"]},"chart-stock":{name:"chart-stock",keywords:["K线图","chart-stock"]},"kagi-map":{name:"kagi-map",keywords:["kagi图","kagi-map"]},"table-lamp":{name:"table-lamp",keywords:["台灯","table-lamp"]},"pencil 1":{name:"pencil 1",keywords:["铅笔","pencil 1"]},laptop:{name:"laptop",keywords:["笔记本","laptop"]},"laptop-computer":{name:"laptop-computer",keywords:["笔记本电脑","laptop-computer"]},"bolt-one":{name:"bolt-one",keywords:["插头","bolt-one"]},plug:{name:"plug",keywords:["插头","plug"]},"charging-treasure":{name:"charging-treasure",keywords:["充电宝","charging-treasure"]},"hair-dryer-one":{name:"hair-dryer-one",keywords:["吹风机","hair-dryer-one"]},"sd-card":{name:"sd-card",keywords:["存储卡","sd-card"]},printer:{name:"printer",keywords:["打印机","printer"]},"battery-storage":{name:"battery-storage",keywords:["电池充电","battery-storage"]},sim:{name:"sim",keywords:["电话卡","sim"]},"tv-one":{name:"tv-one",keywords:["电视","tv-one"]},"digital-watches":{name:"digital-watches",keywords:["电子表","digital-watches"]},"headset-two":{name:"headset-two",keywords:["耳机","headset-two"]},"mac-finder":{name:"mac-finder",keywords:["访达","mac-finder"]},server:{name:"server",keywords:["服务器","server"]},toolkit:{name:"toolkit",keywords:["工具箱","toolkit"]},cd:{name:"cd",keywords:["光盘","cd"]},"rocket-one":{name:"rocket-one",keywords:["火箭","rocket-one"]},"robot-one":{name:"robot-one",keywords:["机器人1","robot-one"]},timer:{name:"timer",keywords:["计时器","timer"]},"new-computer":{name:"new-computer",keywords:["计算机","new-computer"]},"surveillance-cameras-two":{name:"surveillance-cameras-two",keywords:["监控摄像头","surveillance-cameras-two"]},"surveillance-cameras":{name:"surveillance-cameras",keywords:["监控摄像头","surveillance-cameras"]},"keyboard-one":{name:"keyboard-one",keywords:["键盘","keyboard-one"]},receiver:{name:"receiver",keywords:["接收器","receiver"]},toilet:{name:"toilet",keywords:["马桶","toilet"]},thunderbolt:{name:"thunderbolt",keywords:["霹雳接口","thunderbolt"]},iphone:{name:"iphone",keywords:["苹果手机","iphone"]},poker:{name:"poker",keywords:["扑克","poker"]},"switch-nintendo":{name:"switch-nintendo",keywords:["任天堂游戏","switch-nintendo"]},devices:{name:"devices",keywords:["设备","devices"]},"camera-one":{name:"camera-one",keywords:["摄像头","camera-one"]},radio:{name:"radio",keywords:["收音机","radio"]},"hand-painted-plate":{name:"hand-painted-plate",keywords:["手绘板","hand-painted-plate"]},"mouse-one":{name:"mouse-one",keywords:["鼠标","mouse-one"]},"usb-one":{name:"usb-one",keywords:["数据接口","usb-one"]},"projector-two":{name:"projector-two",keywords:["投影仪","projector-two"]},webcam:{name:"webcam",keywords:["网络摄像头","webcam"]},"drone-one":{name:"drone-one",keywords:["无人机","drone-one"]},drone:{name:"drone",keywords:["无人机","drone"]},"washing-machine-one":{name:"washing-machine-one",keywords:["洗衣机1","washing-machine-one"]},"camera-two":{name:"camera-two",keywords:["相机","camera-two"]},cpu:{name:"cpu",keywords:["芯片","cpu"]},speaker:{name:"speaker",keywords:["音响","speaker"]},seal:{name:"seal",keywords:["印章","seal"]},"hard-disk":{name:"hard-disk",keywords:["硬盘","hard-disk"]},gamepad:{name:"gamepad",keywords:["游戏机","gamepad"]},"round-socket":{name:"round-socket",keywords:["圆形插座","round-socket"]},"electronic-door-lock":{name:"electronic-door-lock",keywords:["智能门锁","electronic-door-lock"]},"camera-three":{name:"camera-three",keywords:["智能摄像头","camera-three"]},dvi:{name:"dvi",keywords:["DVI","dvi"]},ipad:{name:"ipad",keywords:["Ipad","ipad"]},sd:{name:"sd",keywords:["SD卡","sd"]},"usb-type-c":{name:"usb-type-c",keywords:["TypeC","usb-type-c"]},"usb-memory-stick":{name:"usb-memory-stick",keywords:["U盘","usb-memory-stick"]},"disk-one":{name:"disk-one",keywords:["U盘1","disk-one"]},camera:{name:"camera",keywords:["相机","camera"]},"shield-add":{name:"shield-add",keywords:["安全增加","shield-add"]},helpcenter:{name:"helpcenter",keywords:["帮助中心","helpcenter"]},protect:{name:"protect",keywords:["保护","protect"]},protection:{name:"protection",keywords:["保护","protection"]},"table-file":{name:"table-file",keywords:["表格","table-file"]},bug:{name:"bug",keywords:["程序问题","bug"]},"file-question":{name:"file-question",keywords:["存疑文件","file-question"]},"code-one":{name:"code-one",keywords:["代码1","code-one"]},"file-code":{name:"file-code",keywords:["代码文件","file-code"]},"folder-code":{name:"folder-code",keywords:["代码文件夹","folder-code"]},translate:{name:"translate",keywords:["翻译","translate"]},"share-one":{name:"share-one",keywords:["分享","share-one"]},"share-sys":{name:"share-sys",keywords:["分享","share-sys"]},"connection-box":{name:"connection-box",keywords:["分组","connection-box"]},broadcast:{name:"broadcast",keywords:["广播","broadcast"]},"date-comes-back":{name:"date-comes-back",keywords:["回传数据","date-comes-back"]},"activity-source":{name:"activity-source",keywords:["活动源","activity-source"]},"loading-one":{name:"loading-one",keywords:["加载","loading-one"]},"file-hash":{name:"file-hash",keywords:["井号文件","file-hash"]},"file-tips":{name:"file-tips",keywords:["警示文件","file-tips"]},bluetooth:{name:"bluetooth",keywords:["蓝牙","bluetooth"]},"connection-point":{name:"connection-point",keywords:["连接点","connection-point"]},connect:{name:"connect",keywords:["链接","connect"]},"link-three":{name:"link-three",keywords:["链接","link-three"]},link:{name:"link",keywords:["链接","link"]},browser:{name:"browser",keywords:["浏览器","browser"]},"file-staff":{name:"file-staff",keywords:["人事文件","file-staff"]},hourglass:{name:"hourglass",keywords:["沙漏","hourglass"]},"setting-two":{name:"setting-two",keywords:["设置","setting-two"]},"setting-config":{name:"setting-config",keywords:["设置配置","setting-config"]},"video-one":{name:"video-one",keywords:["视频","video-one"]},inbox:{name:"inbox",keywords:["收件箱","inbox"]},"folder-focus":{name:"folder-focus",keywords:["收藏文件夹","folder-focus"]},home:{name:"home",keywords:["首页","home"]},"tree-list":{name:"tree-list",keywords:["树结构","tree-list"]},data:{name:"data",keywords:["数据库","data"]},"database-success":{name:"database-success",keywords:["数据库成功","database-success"]},"database-code":{name:"database-code",keywords:["数据库代码","database-code"]},"database-point":{name:"database-point",keywords:["数据库节点","database-point"]},"database-time":{name:"database-time",keywords:["数据库时间","database-time"]},"data-switching":{name:"data-switching",keywords:["数据切换","data-switching"]},"data-display":{name:"data-display",keywords:["数据显示","data-display"]},"cast-screen":{name:"cast-screen",keywords:["投射屏幕","cast-screen"]},picture:{name:"picture",keywords:["图片","picture"]},"network-tree":{name:"network-tree",keywords:["网络节点","network-tree"]},"web-page":{name:"web-page",keywords:["网页","web-page"]},"file-text":{name:"file-text",keywords:["文本文件","file-text"]},"doc-search-two":{name:"doc-search-two",keywords:["文档搜索","doc-search-two"]},"file-excel":{name:"file-excel",keywords:["文件-excel","file-excel"]},"file-gif":{name:"file-gif",keywords:["文件-gif","file-gif"]},"file-jpg":{name:"file-jpg",keywords:["文件-jpg","file-jpg"]},"file-pdf":{name:"file-pdf",keywords:["文件-pdf","file-pdf"]},"file-word":{name:"file-word",keywords:["文件-word","file-word"]},"file-cabinet":{name:"file-cabinet",keywords:["文件柜","file-cabinet"]},"folder-download":{name:"folder-download",keywords:["文件夹-下载","folder-download"]},"file-search-two":{name:"file-search-two",keywords:["文件搜索","file-search-two"]},wifi:{name:"wifi",keywords:["无线网络","wifi"]},system:{name:"system",keywords:["系统","system"]},"view-list":{name:"view-list",keywords:["详情列表","view-list"]},agreement:{name:"agreement",keywords:["协议","agreement"]},signal:{name:"signal",keywords:["信号","signal"]},"file-music":{name:"file-music",keywords:["音乐文件","file-music"]},"audio-file":{name:"audio-file",keywords:["音频文件","audio-file"]},mail:{name:"mail",keywords:["邮件","mail"]},"misaligned-semicircle":{name:"misaligned-semicircle",keywords:["半圆","misaligned-semicircle"]},symmetry:{name:"symmetry",keywords:["对称","symmetry"]},"multi-triangular":{name:"multi-triangular",keywords:["多三角","multi-triangular"]},"geometric-flowers":{name:"geometric-flowers",keywords:["几何花","geometric-flowers"]},"stereo-perspective":{name:"stereo-perspective",keywords:["立体透视","stereo-perspective"]},"two-triangles-two":{name:"two-triangles-two",keywords:["两个三角","two-triangles-two"]},"two-ellipses":{name:"two-ellipses",keywords:["两个椭圆","two-ellipses"]},"hexagon-strip":{name:"hexagon-strip",keywords:["六边条","hexagon-strip"]},"six-points":{name:"six-points",keywords:["六个点","six-points"]},"cross-ring-two":{name:"cross-ring-two",keywords:["魔比斯环","cross-ring-two"]},"cube-three":{name:"cube-three",keywords:["魔方","cube-three"]},"three-hexagons":{name:"three-hexagons",keywords:["三个菱形","three-hexagons"]},"three-triangles":{name:"three-triangles",keywords:["三个三角","three-triangles"]},"triangle-round-rectangle":{name:"triangle-round-rectangle",keywords:["三角圆矩形","triangle-round-rectangle"]},"triangular-pyramid":{name:"triangular-pyramid",keywords:["三棱锥","triangular-pyramid"]},"three-slashes":{name:"three-slashes",keywords:["三斜杠","three-slashes"]},"symbol-double-x":{name:"symbol-double-x",keywords:["双X符号","symbol-double-x"]},"four-leaves":{name:"four-leaves",keywords:["四片叶子","four-leaves"]},"rectangular-circular-separation":{name:"rectangular-circular-separation",keywords:["图形分割","rectangular-circular-separation"]},"rectangular-circular-connection":{name:"rectangular-circular-connection",keywords:["图形连接","rectangular-circular-connection"]},endless:{name:"endless",keywords:["无穷尽","endless"]},asterisk:{name:"asterisk",keywords:["星号","asterisk"]},"two-triangles":{name:"two-triangles",keywords:["星星","two-triangles"]},whirlwind:{name:"whirlwind",keywords:["旋风","whirlwind"]},"circles-seven":{name:"circles-seven",keywords:["圆圈","circles-seven"]},"six-circular-connection":{name:"six-circular-connection",keywords:["圆形连接","six-circular-connection"]},"round-distortion":{name:"round-distortion",keywords:["圆形扭曲","round-distortion"]},"smart-optimization":{name:"smart-optimization",keywords:["智能优化","smart-optimization"]},cones:{name:"cones",keywords:["坐标系","cones"]},"coordinate-system":{name:"coordinate-system",keywords:["坐标系统","coordinate-system"]},percentage:{name:"percentage",keywords:["百分号","percentage"]},help:{name:"help",keywords:["帮助","help"]},caution:{name:"caution",keywords:["报错","caution"]},bitcoin:{name:"bitcoin",keywords:["比特币","bitcoin"]},success:{name:"success",keywords:["成功","success"]},division:{name:"division",keywords:["除号","division"]},error:{name:"error",keywords:["错误","error"]},"share-two":{name:"share-two",keywords:["分享2","share-two"]},symbol:{name:"symbol",keywords:["符号","symbol"]},close:{name:"close",keywords:["关闭","close"]},plus:{name:"plus",keywords:["加","plus"]},"plus-cross":{name:"plus-cross",keywords:["加号","plus-cross"]},minus:{name:"minus",keywords:["减","minus"]},forbid:{name:"forbid",keywords:["禁止","forbid"]},"ce-marking":{name:"ce-marking",keywords:["欧洲市场","ce-marking"]},trademark:{name:"trademark",keywords:["商标符号","trademark"]},"add-one":{name:"add-one",keywords:["添加","add-one"]},"check-one":{name:"check-one",keywords:["校验","check-one"]},check:{name:"check",keywords:["校验","check"]},info:{name:"info",keywords:["信息","info"]},star:{name:"star",keywords:["星星","star"]},correct:{name:"correct",keywords:["正确的","correct"]},attention:{name:"attention",keywords:["注意","attention"]},"figma-component":{name:"figma-component",keywords:["组件","figma-component"]},vip:{name:"vip",keywords:["VIP","vip"]},airpods:{name:"airpods",keywords:["AirPods","airpods"]},"single-bed":{name:"single-bed",keywords:["单人床","single-bed"]},hanger:{name:"hanger",keywords:["晾衣架","hanger"]},"door-handle":{name:"door-handle",keywords:["门把手","door-handle"]},"alarm-clock":{name:"alarm-clock",keywords:["闹钟","alarm-clock"]},"sofa-two":{name:"sofa-two",keywords:["沙发","sofa-two"]},sofa:{name:"sofa",keywords:["沙发","sofa"]},"double-bed":{name:"double-bed",keywords:["双人床","double-bed"]},"hanger-two":{name:"hanger-two",keywords:["衣架","hanger-two"]},tub:{name:"tub",keywords:["浴缸","tub"]},"hair-brush":{name:"hair-brush",keywords:["发梳","hair-brush"]},"english-mustache":{name:"english-mustache",keywords:["胡子","english-mustache"]},"cosmetic-brush":{name:"cosmetic-brush",keywords:["化妆刷","cosmetic-brush"]},"barber-clippers":{name:"barber-clippers",keywords:["理发剪","barber-clippers"]},"face-powder":{name:"face-powder",keywords:["脸粉","face-powder"]},makeups:{name:"makeups",keywords:["美容","makeups"]},"beauty-instrument":{name:"beauty-instrument",keywords:["美容仪","beauty-instrument"]},comb:{name:"comb",keywords:["梳子","comb"]},"shaver-one":{name:"shaver-one",keywords:["剃须刀","shaver-one"]},"facial-cleanser":{name:"facial-cleanser",keywords:["洗面奶","facial-cleanser"]},"nail-polish-one":{name:"nail-polish-one",keywords:["指甲油1","nail-polish-one"]},"paint 1":{name:"paint 1",keywords:["化妆刷","paint 1"]},prescription:{name:"prescription",keywords:["处方","prescription"]},injection:{name:"injection",keywords:["打针","injection"]},brain:{name:"brain",keywords:["大脑","brain"]},weight:{name:"weight",keywords:["体重","weight"]},cardioelectric:{name:"cardioelectric",keywords:["心电","cardioelectric"]},"medicine-bottle-one":{name:"medicine-bottle-one",keywords:["药瓶","medicine-bottle-one"]},"medical-box":{name:"medical-box",keywords:["医疗箱","medical-box"]},nutrition:{name:"nutrition",keywords:["营养","nutrition"]},"exchange-four":{name:"exchange-four",keywords:["兑换4","exchange-four"]},workbench:{name:"workbench",keywords:["工作台","workbench"]},shopping:{name:"shopping",keywords:["购物车","shopping"]},"stock-market":{name:"stock-market",keywords:["股市","stock-market"]},funds:{name:"funds",keywords:["基金","funds"]},finance:{name:"finance",keywords:["金融","finance"]},gift:{name:"gift",keywords:["礼物","gift"]},"financing-one":{name:"financing-one",keywords:["理财","financing-one"]},"wallet-one":{name:"wallet-one",keywords:["钱包","wallet-one"]},"wallet-two":{name:"wallet-two",keywords:["钱包","wallet-two"]},"financing-two":{name:"financing-two",keywords:["融资2","financing-two"]},"flash-payment":{name:"flash-payment",keywords:["闪付","flash-payment"]},commodity:{name:"commodity",keywords:["商品","commodity"]},"water-rate-two":{name:"water-rate-two",keywords:["水电费","water-rate-two"]},"water-rate":{name:"water-rate",keywords:["水费","water-rate"]},"water-level":{name:"water-level",keywords:["水位线","water-level"]},consume:{name:"consume",keywords:["消费","consume"]},"bank-card":{name:"bank-card",keywords:["银行卡","bank-card"]},"bachelor-cap-one":{name:"bachelor-cap-one",keywords:["博士帽1","bachelor-cap-one"]},"high-heeled-shoes":{name:"high-heeled-shoes",keywords:["高跟鞋","high-heeled-shoes"]},briefcase:{name:"briefcase",keywords:["公文包","briefcase"]},"basketball-clothes":{name:"basketball-clothes",keywords:["篮球服","basketball-clothes"]},necktie:{name:"necktie",keywords:["领带","necktie"]},"slippers-one":{name:"slippers-one",keywords:["拖鞋","slippers-one"]},slippers:{name:"slippers",keywords:["拖鞋","slippers"]},perfume:{name:"perfume",keywords:["香水","perfume"]},theme:{name:"theme",keywords:["主题","theme"]},"diamond-ring":{name:"diamond-ring",keywords:["钻戒","diamond-ring"]},diamonds:{name:"diamonds",keywords:["钻石","diamonds"]},"t-shirt":{name:"t-shirt",keywords:["T恤","t-shirt"]},teeth:{name:"teeth",keywords:["牙齿","teeth"]},eyes:{name:"eyes",keywords:["眼睛","eyes"]},glasses:{name:"glasses",keywords:["眼镜","glasses"]},"spanner 1":{name:"spanner 1",keywords:["扳手","spanner 1"]},"distraught-face":{name:"distraught-face",keywords:["闭眼生气","distraught-face"]},"confused-face":{name:"confused-face",keywords:["别嘴","confused-face"]},"frowning-face-whit-open-mouth":{name:"frowning-face-whit-open-mouth",keywords:["别嘴生气","frowning-face-whit-open-mouth"]},"emotion-unhappy":{name:"emotion-unhappy",keywords:["不开心","emotion-unhappy"]},"grimacing-face":{name:"grimacing-face",keywords:["呲牙张嘴","grimacing-face"]},"worried-face":{name:"worried-face",keywords:["担心","worried-face"]},"upside-down-face":{name:"upside-down-face",keywords:["翻转笑脸","upside-down-face"]},"pouting-face":{name:"pouting-face",keywords:["愤怒","pouting-face"]},"surprised-face-with-open-mouth":{name:"surprised-face-with-open-mouth",keywords:["惊讶","surprised-face-with-open-mouth"]},"surprised-face-with-open-big-mouth":{name:"surprised-face-with-open-big-mouth",keywords:["惊讶张嘴","surprised-face-with-open-big-mouth"]},"sly-face-whit-smile":{name:"sly-face-whit-smile",keywords:["囧笑","sly-face-whit-smile"]},"weary-face":{name:"weary-face",keywords:["沮丧","weary-face"]},"emotion-happy":{name:"emotion-happy",keywords:["开心","emotion-happy"]},"grinning-face":{name:"grinning-face",keywords:["开心","grinning-face"]},"slightly-frowning-face-whit-open-mouth":{name:"slightly-frowning-face-whit-open-mouth",keywords:["轻微沮丧","slightly-frowning-face-whit-open-mouth"]},"angry-face":{name:"angry-face",keywords:["生气","angry-face"]},"disappointed-face":{name:"disappointed-face",keywords:["失落","disappointed-face"]},"slightly-smiling-face":{name:"slightly-smiling-face",keywords:["微笑","slightly-smiling-face"]},"expressionless-face":{name:"expressionless-face",keywords:["无语脸","expressionless-face"]},"face-without-mouth":{name:"face-without-mouth",keywords:["无嘴脸","face-without-mouth"]},"smiling-face":{name:"smiling-face",keywords:["笑脸","smiling-face"]},"grinning-face-with-squinting-eyes":{name:"grinning-face-with-squinting-eyes",keywords:["笑眯眼","grinning-face-with-squinting-eyes"]},"anguished-face":{name:"anguished-face",keywords:["圆嘴","anguished-face"]},"winking-face":{name:"winking-face",keywords:["眨眼睛","winking-face"]},"winking-face-with-open-eyes":{name:"winking-face-with-open-eyes",keywords:["眨一个眼睛","winking-face-with-open-eyes"]},"astonished-face":{name:"astonished-face",keywords:["张大嘴","astonished-face"]},"grinning-face-with-tightly-closed-eyes-open-mouth":{name:"grinning-face-with-tightly-closed-eyes-open-mouth",keywords:["张嘴闭眼笑","grinning-face-with-tightly-closed-eyes-open-mouth"]},"loudly-crying-face-whit-open-mouth":{name:"loudly-crying-face-whit-open-mouth",keywords:["张嘴哭","loudly-crying-face-whit-open-mouth"]},"grinning-face-with-open-mouth":{name:"grinning-face-with-open-mouth",keywords:["张嘴笑","grinning-face-with-open-mouth"]},"neutral-face":{name:"neutral-face",keywords:["正常标签","neutral-face"]},"baseball-bat":{name:"baseball-bat",keywords:["棒球棍","baseball-bat"]},whistling:{name:"whistling",keywords:["吹哨","whistling"]},"play-volleyball":{name:"play-volleyball",keywords:["打排球","play-volleyball"]},"balance-one":{name:"balance-one",keywords:["电子秤","balance-one"]},"dumbbel-line":{name:"dumbbel-line",keywords:["杠铃","dumbbel-line"]},"chess-one":{name:"chess-one",keywords:["国际象棋","chess-one"]},torch:{name:"torch",keywords:["火炬","torch"]},muscle:{name:"muscle",keywords:["肌肉","muscle"]},dumbbell:{name:"dumbbell",keywords:["健身","dumbbell"]},baokemeng:{name:"baokemeng",keywords:["精灵球","baokemeng"]},weightlifting:{name:"weightlifting",keywords:["举重","weightlifting"]},basketball:{name:"basketball",keywords:["篮球","basketball"]},court:{name:"court",keywords:["篮球场","court"]},"basketball-stand":{name:"basketball-stand",keywords:["篮球架","basketball-stand"]},skating:{name:"skating",keywords:["溜冰鞋","skating"]},volleyball:{name:"volleyball",keywords:["排球","volleyball"]},"treadmill-two":{name:"treadmill-two",keywords:["跑步机","treadmill-two"]},treadmill:{name:"treadmill",keywords:["跑步机","treadmill"]},"treadmill-one":{name:"treadmill-one",keywords:["跑步机1","treadmill-one"]},riding:{name:"riding",keywords:["骑自行车","riding"]},"target-two":{name:"target-two",keywords:["枪靶","target-two"]},boxing:{name:"boxing",keywords:["拳击","boxing"]},"rope-skipping":{name:"rope-skipping",keywords:["跳绳","rope-skipping"]},helmet:{name:"helmet",keywords:["头盔","helmet"]},tennis:{name:"tennis",keywords:["网球","tennis"]},badminton:{name:"badminton",keywords:["羽毛球","badminton"]},sport:{name:"sport",keywords:["运动","sport"]},sporting:{name:"sporting",keywords:["运动","sporting"]},football:{name:"football",keywords:["足球","football"]},soccer:{name:"soccer",keywords:["足球","soccer"]},"soccer-one":{name:"soccer-one",keywords:["足球1","soccer-one"]},"baby-feet":{name:"baby-feet",keywords:["脚掌","baby-feet"]},"baby-taste":{name:"baby-taste",keywords:["品尝","baby-taste"]},"party-balloon":{name:"party-balloon",keywords:["气球","party-balloon"]},steoller:{name:"steoller",keywords:["童车","steoller"]},"heart-ballon":{name:"heart-ballon",keywords:["心形气球","heart-ballon"]},"rocking-horse":{name:"rocking-horse",keywords:["摇马","rocking-horse"]},"sleep 1":{name:"sleep 1",keywords:["睡眠","sleep 1"]},"eiffel-tower":{name:"eiffel-tower",keywords:["埃菲尔铁塔","eiffel-tower"]},pagoda:{name:"pagoda",keywords:["宝塔","pagoda"]},"tower-of-pisa":{name:"tower-of-pisa",keywords:["比萨斜塔","tower-of-pisa"]},"museum-one":{name:"museum-one",keywords:["博物馆","museum-one"]},castle:{name:"castle",keywords:["城堡","castle"]},"city-gate":{name:"city-gate",keywords:["城门","city-gate"]},"city-one":{name:"city-one",keywords:["城市","city-one"]},city:{name:"city",keywords:["城市","city"]},gate:{name:"gate",keywords:["大门","gate"]},"light-house":{name:"light-house",keywords:["灯塔","light-house"]},dubai:{name:"dubai",keywords:["迪拜大厦","dubai"]},elevator:{name:"elevator",keywords:["电梯","elevator"]},"pearl-of-the-orient":{name:"pearl-of-the-orient",keywords:["东方明珠","pearl-of-the-orient"]},"windmill-one":{name:"windmill-one",keywords:["风车","windmill-one"]},"factory-building":{name:"factory-building",keywords:["工厂","factory-building"]},palace:{name:"palace",keywords:["宫殿","palace"]},"monument-one":{name:"monument-one",keywords:["纪念碑","monument-one"]},"monument-two":{name:"monument-two",keywords:["纪念碑","monument-two"]},"building-four":{name:"building-four",keywords:["建筑","building-four"]},"building-one":{name:"building-one",keywords:["建筑","building-one"]},"building-three":{name:"building-three",keywords:["建筑","building-three"]},"church-one":{name:"church-one",keywords:["教堂","church-one"]},"church-two":{name:"church-two",keywords:["教堂","church-two"]},hotel:{name:"hotel",keywords:["酒店","hotel"]},"arc-de-triomphe":{name:"arc-de-triomphe",keywords:["凯旋门","arc-de-triomphe"]},"fence-one":{name:"fence-one",keywords:["栏栅","fence-one"]},circus:{name:"circus",keywords:["马戏团","circus"]},maya:{name:"maya",keywords:["玛雅","maya"]},"ferris-wheel":{name:"ferris-wheel",keywords:["摩天轮","ferris-wheel"]},"brdige-three":{name:"brdige-three",keywords:["桥","brdige-three"]},"bridge-one":{name:"bridge-one",keywords:["桥","bridge-one"]},"bridge-two":{name:"bridge-two",keywords:["桥","bridge-two"]},"home-two":{name:"home-two",keywords:["首页","home-two"]},"death-star":{name:"death-star",keywords:["死亡之星","death-star"]},tower:{name:"tower",keywords:["塔楼","tower"]},booth:{name:"booth",keywords:["摊位","booth"]},"future-build-one":{name:"future-build-one",keywords:["未来大厦","future-build-one"]},"signal-tower-one":{name:"signal-tower-one",keywords:["信号塔","signal-tower-one"]},chimney:{name:"chimney",keywords:["烟筒","chimney"]},dome:{name:"dome",keywords:["圆顶","dome"]},"fence-two":{name:"fence-two",keywords:["栅栏","fence-two"]},"chinese-pavilion":{name:"chinese-pavilion",keywords:["中国楼阁","chinese-pavilion"]},"clock-tower":{name:"clock-tower",keywords:["钟楼","clock-tower"]},mark:{name:"mark",keywords:["标记","mark"]},"set-off":{name:"set-off",keywords:["出发","set-off"]},ship:{name:"ship",keywords:["船","ship"]},"sailboat-one":{name:"sailboat-one",keywords:["帆船1","sailboat-one"]},"road-sign":{name:"road-sign",keywords:["方向标识","road-sign"]},"steering-wheel":{name:"steering-wheel",keywords:["方向盘","steering-wheel"]},airplane:{name:"airplane",keywords:["飞机","airplane"]},"high-speed-rail":{name:"high-speed-rail",keywords:["高铁","high-speed-rail"]},"bus-one":{name:"bus-one",keywords:["公交","bus-one"]},cruise:{name:"cruise",keywords:["航海","cruise"]},aviation:{name:"aviation",keywords:["航空","aviation"]},sailing:{name:"sailing",keywords:["航行","sailing"]},"passport-one":{name:"passport-one",keywords:["护照","passport-one"]},landing:{name:"landing",keywords:["降落","landing"]},"cable-car":{name:"cable-car",keywords:["缆车","cable-car"]},journey:{name:"journey",keywords:["旅行","journey"]},"tour-bus":{name:"tour-bus",keywords:["旅游巴士","tour-bus"]},"tickets-one":{name:"tickets-one",keywords:["门票","tickets-one"]},mounted:{name:"mounted",keywords:["摩托","mounted"]},flag:{name:"flag",keywords:["旗子","flag"]},"take-off-one":{name:"take-off-one",keywords:["起飞","take-off-one"]},gps:{name:"gps",keywords:["汽车导航","gps"]},"hot-air-balloon":{name:"hot-air-balloon",keywords:["热气球","hot-air-balloon"]},pennant:{name:"pennant",keywords:["三角旗","pennant"]},mountain:{name:"mountain",keywords:["山","mountain"]},world:{name:"world",keywords:["世界","world"]},railway:{name:"railway",keywords:["铁路","railway"]},parking:{name:"parking",keywords:["停车场","parking"]},luggage:{name:"luggage",keywords:["行李箱","luggage"]},vacation:{name:"vacation",keywords:["椰树","vacation"]},"coconut-tree":{name:"coconut-tree",keywords:["椰子树","coconut-tree"]},camp:{name:"camp",keywords:["野营","camp"]},local:{name:"local",keywords:["已定位","local"]},"guide-board":{name:"guide-board",keywords:["指示牌","guide-board"]},subway:{name:"subway",keywords:["地铁","subway"]},transporter:{name:"transporter",keywords:["送货车","transporter"]},play:{name:"play",keywords:["播放","play"]},record:{name:"record",keywords:["唱片集","record"]},fm:{name:"fm",keywords:["电台","fm"]},movie:{name:"movie",keywords:["电影","movie"]},headset:{name:"headset",keywords:["耳机","headset"]},"arrow-keys":{name:"arrow-keys",keywords:["方向键","arrow-keys"]},piano:{name:"piano",keywords:["钢琴","piano"]},"record-disc":{name:"record-disc",keywords:["光盘","record-disc"]},trophy:{name:"trophy",keywords:["奖杯","trophy"]},film:{name:"film",keywords:["胶片","film"]},skull:{name:"skull",keywords:["骷髅","skull"]},voice:{name:"voice",keywords:["录音","voice"]},puzzle:{name:"puzzle",keywords:["拼图","puzzle"]},monitor:{name:"monitor",keywords:["摄像","monitor"]},acoustic:{name:"acoustic",keywords:["声波","acoustic"]},"handle-square":{name:"handle-square",keywords:["手柄方形","handle-square"]},"handle-triangle":{name:"handle-triangle",keywords:["手柄三角形","handle-triangle"]},"handle-up":{name:"handle-up",keywords:["手柄上","handle-up"]},"handle-down":{name:"handle-down",keywords:["手柄下","handle-down"]},"handle-right":{name:"handle-right",keywords:["手柄右","handle-right"]},"handle-round":{name:"handle-round",keywords:["手柄圆圈","handle-round"]},"handle-left":{name:"handle-left",keywords:["手柄左","handle-left"]},"handle-a":{name:"handle-a",keywords:["手柄A","handle-a"]},"handle-b":{name:"handle-b",keywords:["手柄B","handle-b"]},"handle-c":{name:"handle-c",keywords:["手柄C","handle-c"]},"handle-x":{name:"handle-x",keywords:["手柄X","handle-x"]},"handle-y":{name:"handle-y",keywords:["手柄Y","handle-y"]},"handle-z":{name:"handle-z",keywords:["手柄Z","handle-z"]},performance:{name:"performance",keywords:["演出","performance"]},"music-one":{name:"music-one",keywords:["音乐","music-one"]},music:{name:"music",keywords:["音乐","music"]},"music-rhythm":{name:"music-rhythm",keywords:["音乐律动","music-rhythm"]},"music-cd":{name:"music-cd",keywords:["音乐cd","music-cd"]},"movie-board":{name:"movie-board",keywords:["影视板","movie-board"]},ghost:{name:"ghost",keywords:["幽灵","ghost"]},game:{name:"game",keywords:["游戏","game"]},"game-ps":{name:"game-ps",keywords:["游戏机","game-ps"]},"game-handle":{name:"game-handle",keywords:["游戏手柄","game-handle"]},entertainment:{name:"entertainment",keywords:["娱乐","entertainment"]},bat:{name:"bat",keywords:["蝙蝠","bat"]},elephant:{name:"elephant",keywords:["大象","elephant"]},pigeon:{name:"pigeon",keywords:["鸽子","pigeon"]},dog:{name:"dog",keywords:["狗","dog"]},dolphin:{name:"dolphin",keywords:["海豚","dolphin"]},hippo:{name:"hippo",keywords:["河马","hippo"]},monkey:{name:"monkey",keywords:["猴","monkey"]},butterfly:{name:"butterfly",keywords:["蝴蝶","butterfly"]},whale:{name:"whale",keywords:["鲸鱼","whale"]},deer:{name:"deer",keywords:["鹿","deer"]},cat:{name:"cat",keywords:["猫","cat"]},owl:{name:"owl",keywords:["猫头鹰","owl"]},bee:{name:"bee",keywords:["蜜蜂","bee"]},bird:{name:"bird",keywords:["鸟","bird"]},cattle:{name:"cattle",keywords:["牛","cattle"]},frog:{name:"frog",keywords:["青蛙","frog"]},"dog-zodiac":{name:"dog-zodiac",keywords:["生肖狗","dog-zodiac"]},"monkey-zodiac":{name:"monkey-zodiac",keywords:["生肖猴","monkey-zodiac"]},"tiger-zodiac":{name:"tiger-zodiac",keywords:["生肖虎","tiger-zodiac"]},"chicken-zodiac":{name:"chicken-zodiac",keywords:["生肖鸡","chicken-zodiac"]},"dragon-zodiac":{name:"dragon-zodiac",keywords:["生肖龙","dragon-zodiac"]},"horse-zodiac":{name:"horse-zodiac",keywords:["生肖马","horse-zodiac"]},"cattle-zodiac":{name:"cattle-zodiac",keywords:["生肖牛","cattle-zodiac"]},"snake-zodiac":{name:"snake-zodiac",keywords:["生肖蛇","snake-zodiac"]},"mouse-zodiac":{name:"mouse-zodiac",keywords:["生肖鼠","mouse-zodiac"]},"rabbit-zodiac":{name:"rabbit-zodiac",keywords:["生肖兔","rabbit-zodiac"]},"sheep-zodiac":{name:"sheep-zodiac",keywords:["生肖羊","sheep-zodiac"]},"pig-zodiac":{name:"pig-zodiac",keywords:["生肖猪","pig-zodiac"]},"koala-bear":{name:"koala-bear",keywords:["树袋熊","koala-bear"]},rabbit:{name:"rabbit",keywords:["兔子","rabbit"]},bear:{name:"bear",keywords:["熊","bear"]},panda:{name:"panda",keywords:["熊猫","panda"]},duck:{name:"duck",keywords:["鸭子","duck"]},eagle:{name:"eagle",keywords:["鹰","eagle"]},"fish-one":{name:"fish-one",keywords:["鱼","fish-one"]},pig:{name:"pig",keywords:["猪","pig"]},pinwheel:{name:"pinwheel",keywords:["风车","pinwheel"]},"windmill-two":{name:"windmill-two",keywords:["风车","windmill-two"]},fruiter:{name:"fruiter",keywords:["果树","fruiter"]},outdoor:{name:"outdoor",keywords:["户外","outdoor"]},blossom:{name:"blossom",keywords:["花","blossom"]},"fire-two":{name:"fire-two",keywords:["火堆","fire-two"]},bloom:{name:"bloom",keywords:["开花","bloom"]},"christmas-tree":{name:"christmas-tree",keywords:["圣诞树","christmas-tree"]},tree:{name:"tree",keywords:["树","tree"]},"tree-one":{name:"tree-one",keywords:["树1","tree-one"]},sapling:{name:"sapling",keywords:["树苗","sapling"]},leaves:{name:"leaves",keywords:["树叶","leaves"]},"christmas-tree-one":{name:"christmas-tree-one",keywords:["松树","christmas-tree-one"]},cactus:{name:"cactus",keywords:["仙人掌","cactus"]},"leaves-two":{name:"leaves-two",keywords:["叶子","leaves-two"]},seedling:{name:"seedling",keywords:["幼苗","seedling"]},lollipop:{name:"lollipop",keywords:["棒棒糖","lollipop"]},"icecream-three":{name:"icecream-three",keywords:["冰棍","icecream-three"]},"icecream-two":{name:"icecream-two",keywords:["冰激凌","icecream-two"]},pineapple:{name:"pineapple",keywords:["菠萝","pineapple"]},"fork-spoon":{name:"fork-spoon",keywords:["叉子勺子","fork-spoon"]},tea:{name:"tea",keywords:["茶","tea"]},"shovel-one":{name:"shovel-one",keywords:["铲子","shovel-one"]},orange:{name:"orange",keywords:["橙子","orange"]},"chef-hat-one":{name:"chef-hat-one",keywords:["厨师帽子","chef-hat-one"]},garlic:{name:"garlic",keywords:["大蒜","garlic"]},shrimp:{name:"shrimp",keywords:["大虾","shrimp"]},"cake-three":{name:"cake-three",keywords:["蛋糕","cake-three"]},cake:{name:"cake",keywords:["蛋糕","cake"]},oven:{name:"oven",keywords:["电烤箱","oven"]},tomato:{name:"tomato",keywords:["番茄","tomato"]},goblet:{name:"goblet",keywords:["高脚杯","goblet"]},bone:{name:"bone",keywords:["骨头","bone"]},juice:{name:"juice",keywords:["果饮","juice"]},hamburger:{name:"hamburger",keywords:["汉堡","hamburger"]},carrot:{name:"carrot",keywords:["胡萝卜","carrot"]},"chafing-dish-one":{name:"chafing-dish-one",keywords:["火锅","chafing-dish-one"]},"hot-pot-one":{name:"hot-pot-one",keywords:["火锅","hot-pot-one"]},"hot-pot":{name:"hot-pot",keywords:["火锅","hot-pot"]},chicken:{name:"chicken",keywords:["鸡肉","chicken"]},"chicken-leg":{name:"chicken-leg",keywords:["鸡腿","chicken-leg"]},liqueur:{name:"liqueur",keywords:["鸡尾酒","liqueur"]},"measuring-cup":{name:"measuring-cup",keywords:["计量杯","measuring-cup"]},eggplant:{name:"eggplant",keywords:["茄子","eggplant"]},nut:{name:"nut",keywords:["坚果","nut"]},egg:{name:"egg",keywords:["煎鸡蛋","egg"]},"bottle-one":{name:"bottle-one",keywords:["酒瓶","bottle-one"]},"chopsticks-fork":{name:"chopsticks-fork",keywords:["筷子叉子","chopsticks-fork"]},chili:{name:"chili",keywords:["辣椒","chili"]},pear:{name:"pear",keywords:["梨子","pear"]},rice:{name:"rice",keywords:["米饭","rice"]},"bread-one":{name:"bread-one",keywords:["面包","bread-one"]},bread:{name:"bread",keywords:["面包","bread"]},bowl:{name:"bowl",keywords:["面条","bowl"]},noodles:{name:"noodles",keywords:["面条","noodles"]},cheese:{name:"cheese",keywords:["奶酪","cheese"]},pumpkin:{name:"pumpkin",keywords:["南瓜","pumpkin"]},lemon:{name:"lemon",keywords:["柠檬","lemon"]},"orange-one":{name:"orange-one",keywords:["柠檬片","orange-one"]},"milk-one":{name:"milk-one",keywords:["牛奶","milk-one"]},milk:{name:"milk",keywords:["牛奶","milk"]},"avocado-one":{name:"avocado-one",keywords:["牛油果","avocado-one"]},crab:{name:"crab",keywords:["螃蟹","crab"]},cooking:{name:"cooking",keywords:["烹饪","cooking"]},beer:{name:"beer",keywords:["啤酒","beer"]},"beer-mug":{name:"beer-mug",keywords:["啤酒杯","beer-mug"]},"apple-one":{name:"apple-one",keywords:["苹果","apple-one"]},"bottle-two":{name:"bottle-two",keywords:["瓶子","bottle-two"]},vegetables:{name:"vegetables",keywords:["青菜","vegetables"]},barbecue:{name:"barbecue",keywords:["烧烤","barbecue"]},"birthday-cake":{name:"birthday-cake",keywords:["生日蛋糕","birthday-cake"]},candy:{name:"candy",keywords:["糖果","candy"]},peach:{name:"peach",keywords:["桃子","peach"]},doughnut:{name:"doughnut",keywords:["甜甜圈","doughnut"]},shovel:{name:"shovel",keywords:["铁铲","shovel"]},pot:{name:"pot",keywords:["铁锅","pot"]},spoon:{name:"spoon",keywords:["铁勺","spoon"]},peas:{name:"peas",keywords:["豌豆角","peas"]},"bowl-one":{name:"bowl-one",keywords:["碗","bowl-one"]},watermelon:{name:"watermelon",keywords:["西瓜","watermelon"]},banana:{name:"banana",keywords:["香蕉","banana"]},"icecream-one":{name:"icecream-one",keywords:["雪糕","icecream-one"]},drink:{name:"drink",keywords:["饮料","drink"]},cherry:{name:"cherry",keywords:["樱桃","cherry"]},"chafing-dish":{name:"chafing-dish",keywords:["鸳鸯锅","chafing-dish"]},"french-fries":{name:"french-fries",keywords:["炸薯条","french-fries"]},android:{name:"android",keywords:["安卓","android"]},tiktok:{name:"tiktok",keywords:["抖音","tiktok"]},messages:{name:"messages",keywords:["短信","messages"]},"new-lark":{name:"new-lark",keywords:["飞书-新","new-lark"]},google:{name:"google",keywords:["谷歌","google"]},health:{name:"health",keywords:["健康","health"]},"facebook-one":{name:"facebook-one",keywords:["脸书","facebook-one"]},facebook:{name:"facebook",keywords:["脸书","facebook"]},"browser-chrome":{name:"browser-chrome",keywords:["浏览器","browser-chrome"]},"browser-safari":{name:"browser-safari",keywords:["浏览器-safari","browser-safari"]},"friends-circle":{name:"friends-circle",keywords:["朋友圈","friends-circle"]},apple:{name:"apple",keywords:["苹果","apple"]},ulikecam:{name:"ulikecam",keywords:["轻颜相机","ulikecam"]},facetime:{name:"facetime",keywords:["视频电话","facetime"]},taobao:{name:"taobao",keywords:["淘宝","taobao"]},twitter:{name:"twitter",keywords:["推特","twitter"]},weibo:{name:"weibo",keywords:["微博","weibo"]},windows:{name:"windows",keywords:["微软视窗","windows"]},wechat:{name:"wechat",keywords:["微信","wechat"]},"app-store":{name:"app-store",keywords:["应用商店","app-store"]},youtube:{name:"youtube",keywords:["优兔","youtube"]},alipay:{name:"alipay",keywords:["支付宝","alipay"]},dribble:{name:"dribble",keywords:["追波","dribble"]},bytedance:{name:"bytedance",keywords:["字节跳动","bytedance"]},"adobe-illustrate":{name:"adobe-illustrate",keywords:["adobe-illustrate","adobe-illustrate"]},"adobe-indesign":{name:"adobe-indesign",keywords:["adobe-indesign","adobe-indesign"]},"adobe-lightroom":{name:"adobe-lightroom",keywords:["adobe-lightroom","adobe-lightroom"]},"adobe-photoshop":{name:"adobe-photoshop",keywords:["adobe-photoshop","adobe-photoshop"]},behance:{name:"behance",keywords:["behance","behance"]},figma:{name:"figma",keywords:["figma","figma"]},foursquare:{name:"foursquare",keywords:["foursquare","foursquare"]},github:{name:"github",keywords:["github ","github"]},"github-one":{name:"github-one",keywords:["github-one","github-one"]},gitlab:{name:"gitlab",keywords:["gitlab","gitlab"]},"html-five":{name:"html-five",keywords:["html5","html-five"]},"instagram-one":{name:"instagram-one",keywords:["instagram","instagram-one"]},instagram:{name:"instagram",keywords:["instagram","instagram"]},paypal:{name:"paypal",keywords:["paypal","paypal"]},sketch:{name:"sketch",keywords:["sketch","sketch"]},telegram:{name:"telegram",keywords:["Telegram","telegram"]},tumblr:{name:"tumblr",keywords:["tumblr","tumblr"]}},Ise={},z5={compressed:kse,categories:Tse,emojis:vse,aliases:Ise},Nse=String,jse=Nse.fromCodePoint||function(...t){const s=[];let a,o,i=-1;const{length:l}=t;if(!l)return"";let c="";for(;++i<l;){let d=Number(t[i]);if(!isFinite(d)||d<0||d>1114111||Math.floor(d)!==d)throw RangeError("Invalid code point: ".concat(d));d<=65535?s.push(d):(d-=65536,a=(d>>10)+55296,o=d%1024+56320,s.push(a,o)),(i+1===l||s.length>16384)&&(c+=String.fromCharCode.apply(null,s),s.length=0)}return c},eC={name:"a",unified:"b",non_qualified:"c",has_img_apple:"d",has_img_google:"e",has_img_twitter:"f",has_img_facebook:"h",keywords:"j",sheet:"k",emoticons:"l",text:"m",short_names:"n",added_in:"o"},q5=e=>{const t=[],n=(s,a,o)=>{if(s){if(Array.isArray(s)&&o){const i=dd(s[0]).toLowerCase(),l=f0(s[0]).toLowerCase();t.push(l),t.indexOf(i)===-1&&t.push(i),t.indexOf(l)===-1&&t.push(l)}(Array.isArray(s)?s:[s]).forEach(i=>{(a?i.split(/[-|_|\s]+/):[i]).forEach(l=>{l=l.toLowerCase(),t.indexOf(l)===-1&&t.push(l)})})}};return n(e.short_names,!0),n(e.name,!0),n(e.keywords,!1,!0),n(e.emoticons,!1),t.join(",")},I0=e=>{e.compressed=!1;for(const t in e.emojis){const n=e.emojis[t];for(const s in eC)n[s]=n[eC[s]],delete n[eC[s]];n.short_names||(n.short_names=[]),n.short_names.unshift(t),n.sheet_x=n.sheet[0],n.sheet_y=n.sheet[1],delete n.sheet,n.text||(n.text=""),n.added_in||(n.added_in=6),n.added_in=n.added_in.toFixed(1),n.search=q5(n)}},G5=0,W5=1,K5=2,Y5=3,X5=4,Q5=5,Sse=6,Dse=7,Ase=[Q5,Y5,X5,G5,W5,K5],Rse=[Q5,Y5,X5,G5,W5,K5,Sse,Dse],_f={};function zw(e){const t=qw();e&&(_f.categoryIndex=1/0,_f.count=0);const[n,s]=Pse(t,e?Ase:Rse);return _f.categoryIndex===n?_f.count++:(_f.categoryIndex=n,_f.count=1),_f.count>3?zw():s}function Pse(e,t){const n=Math.round(Math.random()*(t.length-1));return[n,Lse(e,n)]}function Lse(e,t){const n=e.categories[t],s=Math.round(Math.random()*(n.emojis.length-1)),a=n.emojis[s],o=e.emojis[a];return Gw(o.unified)}function qw(){return rp.compressed&&I0(rp),rp}const Bse=/^(?:\:([^\:]+)\:)(?:\:skin-tone-(\d)\:)?$/,Ose=["1F3FA","1F3FB","1F3FC","1F3FD","1F3FE","1F3FF"];function Gw(e){if(!e)return null;const t=e.split("-"),n=t.map(s=>"0x".concat(s));return jse.apply(null,n)}function Mse(e){const{name:t,short_names:n,skin_tone:s,skin_variations:a,emoticons:o,unified:i,custom:l,customCategory:c,imageUrl:d,sheet_x:u,sheet_y:f}=e,h=e.id||(n==null?void 0:n[0])||t;let p=":".concat(h,":");return l?{id:h,name:t,short_names:n,colons:p,emoticons:o,custom:l,customCategory:c,imageUrl:d}:(s&&(p+=":skin-tone-".concat(s,":")),{id:h,name:t,short_names:n,colons:p,emoticons:o,unified:i==null?void 0:i.toLowerCase(),skin:s||(a?1:null),native:Gw(i),sheet_x:u,sheet_y:f})}function hu(...e){return Mse(gg(...e))}function gg(e,t,n,s){let a={};if(typeof e=="string"){const o=e.match(Bse);if(o&&(e=o[1],o[2]&&(t=parseInt(o[2],10))),s.aliases.hasOwnProperty(e)&&(e=s.aliases[e]),s.emojis.hasOwnProperty(e))a=s.emojis[e];else return null}else e.id&&(s.aliases.hasOwnProperty(e.id)&&(e.id=s.aliases[e.id]),s.emojis.hasOwnProperty(e.id)&&(a=s.emojis[e.id],t||(t=e.skin)));if(Object.keys(a).length||(a=e,a.custom=!0),a.search||(a.search=q5(a)),a.emoticons||(a.emoticons=[]),a.variations||(a.variations=[]),a.skin_variations&&t>1){a=JSON.parse(JSON.stringify(a));const o=Ose[t-1],i=a.skin_variations[o];if(i&&(!i.variations&&a.variations&&delete a.variations,n&&(i["has_img_".concat(n)]===void 0||i["has_img_".concat(n)])||!n)){a.skin_tone=t;for(const l in i){const c=i[l];a[l]=c}}}return a.variations&&a.variations.length&&(a=JSON.parse(JSON.stringify(a)),a.unified=a.variations.shift()),a}function J5(e,t,n){n.compressed&&I0(n);const s=["🏻","🏼","🏽","🏾","🏿"],a=["1F3FB","1F3FC","1F3FD","1F3FE","1F3FF"];let o,i;const l=e;s.forEach((d,u)=>{e.indexOf(d)>0&&(o=u+2,i=a[u])});let c;for(const d in n.emojis){const u=n.emojis[d];let f=u.unified;u.variations&&u.variations.length&&(f=u.variations.shift()),o&&u.skin_variations&&u.skin_variations[i]&&(f=u.skin_variations[i].unified),Gw(f)===l&&(c=u)}return c?(c.id=c.short_names[0],hu(c,o,t,n)):null}function RD(e){return e.reduce((t,n)=>(t.indexOf(n)===-1&&t.push(n),t),[])}function Use(e,t){const n=RD(e),s=RD(t);return n.filter(a=>s.indexOf(a)>=0)}function rT(e,t){const n={};for(const s in e){const a=e[s];let o=a;t.hasOwnProperty(s)&&(o=t[s]),typeof o=="object"&&(o=rT(a,o)),n[s]=o}return n}function Vse(e){const t=typeof requestIdleCallback=="function"?requestIdleCallback:setTimeout;let n=!1;return function(){n||(n=!0,t(()=>{n=!1,e()}))}}let SI="emoji-mart";const Z5=typeof window<"u"&&"localStorage"in window;let aT,oT;function $se(e){e||(e={}),aT=e.getter,oT=e.setter}function Hse(e){SI=e}function zse(e){for(const t in e){const n=e[t];eO(t,n)}}function eO(e,t){if(oT)oT(e,t);else{if(!Z5)return;try{window.localStorage["".concat(SI,".").concat(e)]=JSON.stringify(t)}catch(n){}}}function qse(e){if(aT)return aT(e);if(Z5)try{const t=window.localStorage["".concat(SI,".").concat(e)];if(t)return JSON.parse(t)}catch(t){}}const mm={update:zse,set:eO,get:qse,setNamespace:Hse,setHandlers:$se};class tO{constructor(t,n){t.compressed&&I0(t),this.data=t||{},this.set=n||null,this.originalPool={},this.index={},this.emojis={},this.emoticons={},this.customEmojisList=[],this.caches=new Map,this.buildIndex()}buildIndex(){for(const t in this.data.emojis){const n=this.data.emojis[t],{short_names:s,emoticons:a,skin_variations:o,name:i}=n;let l="";if(s?l=s[0]:l=i,a&&a.forEach(c=>{this.emoticons[c]||(this.emoticons[c]=l)}),o){this.emojis[l]={};for(let c=1;c<=6;c++)this.emojis[l][c]=hu({id:l,skin:c},c,this.set,this.data)}else this.emojis[l]=hu(l,null,this.set,this.data);this.originalPool[l]=n}}clearCustomEmojis(t){this.customEmojisList.forEach(n=>{const s=n.id||n.short_names[0];delete t[s],delete this.emojis[s]})}addCustomToPool(t,n){this.customEmojisList.length&&this.clearCustomEmojis(n),t.forEach(s=>{const a=s.id||s.short_names[0];a&&!n[a]&&(n[a]=gg(s,null,null,this.data),this.emojis[a]=hu(s,null,null,this.data))}),this.customEmojisList=t,this.index={}}search(t,{emojisToShowFilter:n,maxResults:s,include:a,exclude:o,custom:i=[]}={}){this.customEmojisList!==i&&this.addCustomToPool(i,this.originalPool);const l=t;if(l){const f=this.caches.get(l);if(f)return f}const c=mm.get("skin")||1;s||(s=75),a||(a=[]),o||(o=[]);let d=null,u=this.originalPool;if(t.length){if(t==="-"||t==="-1")return[this.emojis[-1][c]];let f=t.toLowerCase().split(/[\s|,|\-|_]+/),h=[];if(f.length>2&&(f=[f[0],f[1]]),(a.length||o.length)&&(u={},this.data.categories.forEach(p=>{const g=a&&a.length?a.indexOf(p.id)>-1:!0,_=o&&o.length?o.indexOf(p.id)>-1:!1;!g||_||p.emojis.forEach(x=>u[x]=this.data.emojis[x])}),i.length)){const p=a&&a.length?a.indexOf("custom")>-1:!0,g=o&&o.length?o.indexOf("custom")>-1:!1;p&&!g&&this.addCustomToPool(i,u)}h=f.map(p=>{let g=u,_=this.index,x=0;for(let F=0;F<p.length;F++){const b=p[F];if(x++,_[b]||(_[b]={}),_=_[b],!_.results){const w={};_.results=[],_.pool={};for(const E in g){const C=g[E],{search:k}=C,T=p.substr(0,x),v=k.indexOf(T);if(v!==-1){let I=v+1;T===E&&(I=0),this.emojis[E]&&this.emojis[E][c]?_.results.push(this.emojis[E][c]):_.results.push(this.emojis[E]),_.pool[E]=C,w[E]=I}}_.results.sort((E,C)=>{const k=w[E.id],T=w[C.id];return k===T?E.id.localeCompare(C.id):k-T})}g=_.pool}return _.results}).filter(p=>p),h.length>1?d=Use.apply(null,h):h.length?d=h[0]:d=[]}return d&&(n&&(d=d.filter(f=>n(u[f.id]))),d&&d.length>s&&(d=d.slice(0,s))),this.caches.set(l,d),d}}const nO=new tO(rp),Gse=new tO(z5),{emojis:Wse,emoticons:Kse}=nO;function Yse(...e){return nO.search(...e)}function Xse(...e){return Gse.search(...e)}const Mf={search:Yse,customSearch:Xse,emojis:Wse,emoticons:Kse};let xi,DI,sO={};function rO(){DI=!0,xi=mm.get("frequently_v1")}function Qse(e){DI||rO();const{colons:t}=e;xi||(xi=sO),xi[t]||(xi[t]=0),xi[t]+=1,mm.set("last",t),mm.set("frequently_v1",xi)}function Jse(e){if(DI||rO(),!xi)return sO={},[];const t=e*4,n=[];for(const i in xi)xi.hasOwnProperty(i)&&n.push(i);const a=n.sort((i,l)=>xi[i]-xi[l]).reverse().slice(0,t),o=mm.get("last");return o&&a.indexOf(o)===-1&&(a.pop(),a.push(o)),a}const Gf={add:Qse,get:Jse},Rc={skin:1,set:"apple",sheetSize:64,sheetColumns:57,sheetRows:57,native:!0,forceSize:!1,tooltip:!1,useButton:!1,backgroundImageFn:()=>"https://cdn2.flowus.cn/assets/google_emoji.5dd44719.png"},Ub={onClick:()=>{},onSelect:()=>{},onSkinChange:()=>{},emojiSize:24,perLine:9,i18n:{},style:{},title:"Emoji Mart™",emoji:"department_store",color:"#000000",set:Rc.set,theme:"light",skin:null,defaultSkin:Rc.skin,native:Rc.native,sheetSize:Rc.sheetSize,backgroundImageFn:Rc.backgroundImageFn,emojisToShowFilter:null,showPreview:!0,showSkinTones:!0,emojiTooltip:Rc.tooltip,useButton:Rc.useButton,autoFocus:!0,enableFrequentEmojiSort:!1,custom:[],skinEmoji:"",notFound:()=>{},notFoundEmoji:"sleuth_or_spy",icons:{}},qd={data:nt.object.isRequired,onOver:nt.func,onLeave:nt.func,onClick:nt.func,fallback:nt.func,backgroundImageFn:nt.func,native:nt.bool,forceSize:nt.bool,tooltip:nt.bool,useButton:nt.bool,skin:nt.oneOf([1,2,3,4,5,6]),sheetSize:nt.oneOf([16,20,32,64]),sheetColumns:nt.number,sheetRows:nt.number,set:nt.oneOf(["apple","google","twitter","facebook"]),size:nt.oneOfType([nt.string,nt.number]).isRequired,emoji:nt.oneOfType([nt.string,nt.object]).isRequired},aO={onClick:nt.func,onSelect:nt.func,onSkinChange:nt.func,perLine:nt.number,emojiSize:nt.oneOfType([nt.number,nt.string]),i18n:nt.object,style:nt.object,title:nt.string,emoji:nt.string,color:nt.string,set:qd.set,skin:qd.skin,native:nt.bool,backgroundImageFn:qd.backgroundImageFn,sheetSize:qd.sheetSize,emojisToShowFilter:nt.func,showPreview:nt.bool,showSkinTones:nt.bool,emojiTooltip:qd.tooltip,useButton:qd.useButton,theme:nt.oneOf(["auto","light","dark"]),include:nt.arrayOf(nt.string),exclude:nt.arrayOf(nt.string),recent:nt.arrayOf(nt.string),autoFocus:nt.bool,enableFrequentEmojiSort:nt.bool,custom:nt.arrayOf(nt.shape({name:nt.string.isRequired,short_names:nt.arrayOf(nt.string).isRequired,emoticons:nt.arrayOf(nt.string),keywords:nt.arrayOf(nt.string),imageUrl:nt.string,spriteUrl:nt.string,sheet_x:nt.number,sheet_y:nt.number,size:nt.number,sheetColumns:nt.number,sheetRows:nt.number})),skinEmoji:nt.string,notFound:nt.func,notFoundEmoji:nt.string,icons:nt.object,keyword:nt.string,hideSearchInput:nt.bool},Zse="list-item-inactive",tC="list-item",ere="list-item-custom",Um=e=>{const{listenPriority:t,containerRef:n,onSelectedActiveIndex:s,defaultIndex:a=0,customItem:o,type:i="list",spanCount:l,customSelector:c=""}=e,d=e.itemCount||fn.Children.count(e.children),u=y.useRef(0),f=x=>{var F,b;return n.current===null?(console.warn("direction containerRef props不能为null"),null):o?(F=n.current.querySelectorAll("".concat(c," [").concat(ere,'=""]'))[x])!=null?F:null:(b=n.current.querySelector("".concat(c," [").concat(tC,'="').concat(x,'"]')))!=null?b:null},h=(x,F)=>{const b=tre(i,x,F,l,d);if(b===-1)return b;const w=f(b);return w?w.hasAttribute(Zse)?h(b,F):b:(u.current=u.current+1,u.current>200?-1:h(F==="up"||F==="left"?d:-1,F))},[p,g]=R3(d,f,h,t,{scrollContainer:n,onSelectedActiveIndex:s,defaultActiveIndex:a});let _=e.children;if(typeof e.children=="function"?(_=e.children(p,g),o||(_=fn.Children.map(_,(x,F)=>fn.isValidElement(x)?fn.cloneElement(x,{["".concat(tC)]:"".concat(F)}):null))):o||(_=fn.Children.map(e.children,(x,F)=>fn.isValidElement(x)?fn.cloneElement(x,{["".concat(tC)]:"".concat(F)}):null)),i==="grid"&&l===void 0)throw Error('type is "grid", spanCount props must not be undefined');return r.jsx(r.Fragment,{children:_})},tre=(e,t,n,s,a)=>{let o=-1;const i=n==="up";switch(e){case"list":{if(n==="left"||n==="right")return-1;o=i?t-1:t+1,i&&t===0&&(o=a!=null?a:o);break}case"grid":{if(s===void 0||a===void 0)return-1;switch(s>=a&&(i?n="left":n==="down"&&(n="right")),n){case"left":case"right":{o=n==="left"?t-1:t+1;break}case"up":case"down":{o=i?t-s:t+s;break}}break}default:throw Error("what r u doing")}return o},nre={activity:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{d:"M12 0C5.373 0 0 5.372 0 12c0 6.627 5.373 12 12 12 6.628 0 12-5.373 12-12 0-6.628-5.372-12-12-12m9.949 11H17.05c.224-2.527 1.232-4.773 1.968-6.113A9.966 9.966 0 0 1 21.949 11M13 11V2.051a9.945 9.945 0 0 1 4.432 1.564c-.858 1.491-2.156 4.22-2.392 7.385H13zm-2 0H8.961c-.238-3.165-1.536-5.894-2.393-7.385A9.95 9.95 0 0 1 11 2.051V11zm0 2v8.949a9.937 9.937 0 0 1-4.432-1.564c.857-1.492 2.155-4.221 2.393-7.385H11zm4.04 0c.236 3.164 1.534 5.893 2.392 7.385A9.92 9.92 0 0 1 13 21.949V13h2.04zM4.982 4.887C5.718 6.227 6.726 8.473 6.951 11h-4.9a9.977 9.977 0 0 1 2.931-6.113M2.051 13h4.9c-.226 2.527-1.233 4.771-1.969 6.113A9.972 9.972 0 0 1 2.051 13m16.967 6.113c-.735-1.342-1.744-3.586-1.968-6.113h4.899a9.961 9.961 0 0 1-2.931 6.113"})}),custom:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsxs("g",{transform:"translate(2.000000, 1.000000)",children:[r.jsx("rect",{id:"Rectangle",x:"8",y:"0",width:"3",height:"21",rx:"1.5"}),r.jsx("rect",{id:"Rectangle",transform:"translate(9.843, 10.549) rotate(60) translate(-9.843, -10.549) ",x:"8.343",y:"0.049",width:"3",height:"21",rx:"1.5"}),r.jsx("rect",{id:"Rectangle",transform:"translate(9.843, 10.549) rotate(-60) translate(-9.843, -10.549) ",x:"8.343",y:"0.049",width:"3",height:"21",rx:"1.5"})]})}),flags:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{d:"M0 0l6.084 24H8L1.916 0zM21 5h-4l-1-4H4l3 12h3l1 4h13L21 5zM6.563 3h7.875l2 8H8.563l-2-8zm8.832 10l-2.856 1.904L12.063 13h3.332zM19 13l-1.5-6h1.938l2 8H16l3-2z"})}),foods:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{d:"M17 4.978c-1.838 0-2.876.396-3.68.934.513-1.172 1.768-2.934 4.68-2.934a1 1 0 0 0 0-2c-2.921 0-4.629 1.365-5.547 2.512-.064.078-.119.162-.18.244C11.73 1.838 10.798.023 9.207.023 8.579.022 7.85.306 7 .978 5.027 2.54 5.329 3.902 6.492 4.999 3.609 5.222 0 7.352 0 12.969c0 4.582 4.961 11.009 9 11.009 1.975 0 2.371-.486 3-1 .629.514 1.025 1 3 1 4.039 0 9-6.418 9-11 0-5.953-4.055-8-7-8M8.242 2.546c.641-.508.943-.523.965-.523.426.169.975 1.405 1.357 3.055-1.527-.629-2.741-1.352-2.98-1.846.059-.112.241-.356.658-.686M15 21.978c-1.08 0-1.21-.109-1.559-.402l-.176-.146c-.367-.302-.816-.452-1.266-.452s-.898.15-1.266.452l-.176.146c-.347.292-.477.402-1.557.402-2.813 0-7-5.389-7-9.009 0-5.823 4.488-5.991 5-5.991 1.939 0 2.484.471 3.387 1.251l.323.276a1.995 1.995 0 0 0 2.58 0l.323-.276c.902-.78 1.447-1.251 3.387-1.251.512 0 5 .168 5 6 0 3.617-4.187 9-7 9"})}),nature:()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:[r.jsx("path",{d:"M15.5 8a1.5 1.5 0 1 0 .001 3.001A1.5 1.5 0 0 0 15.5 8M8.5 8a1.5 1.5 0 1 0 .001 3.001A1.5 1.5 0 0 0 8.5 8"}),r.jsx("path",{d:"M18.933 0h-.027c-.97 0-2.138.787-3.018 1.497-1.274-.374-2.612-.51-3.887-.51-1.285 0-2.616.133-3.874.517C7.245.79 6.069 0 5.093 0h-.027C3.352 0 .07 2.67.002 7.026c-.039 2.479.276 4.238 1.04 5.013.254.258.882.677 1.295.882.191 3.177.922 5.238 2.536 6.38.897.637 2.187.949 3.2 1.102C8.04 20.6 8 20.795 8 21c0 1.773 2.35 3 4 3 1.648 0 4-1.227 4-3 0-.201-.038-.393-.072-.586 2.573-.385 5.435-1.877 5.925-7.587.396-.22.887-.568 1.104-.788.763-.774 1.079-2.534 1.04-5.013C23.929 2.67 20.646 0 18.933 0M3.223 9.135c-.237.281-.837 1.155-.884 1.238-.15-.41-.368-1.349-.337-3.291.051-3.281 2.478-4.972 3.091-5.031.256.015.731.27 1.265.646-1.11 1.171-2.275 2.915-2.352 5.125-.133.546-.398.858-.783 1.313M12 22c-.901 0-1.954-.693-2-1 0-.654.475-1.236 1-1.602V20a1 1 0 1 0 2 0v-.602c.524.365 1 .947 1 1.602-.046.307-1.099 1-2 1m3-3.48v.02a4.752 4.752 0 0 0-1.262-1.02c1.092-.516 2.239-1.334 2.239-2.217 0-1.842-1.781-2.195-3.977-2.195-2.196 0-3.978.354-3.978 2.195 0 .883 1.148 1.701 2.238 2.217A4.8 4.8 0 0 0 9 18.539v-.025c-1-.076-2.182-.281-2.973-.842-1.301-.92-1.838-3.045-1.853-6.478l.023-.041c.496-.826 1.49-1.45 1.804-3.102 0-2.047 1.357-3.631 2.362-4.522C9.37 3.178 10.555 3 11.948 3c1.447 0 2.685.192 3.733.57 1 .9 2.316 2.465 2.316 4.48.313 1.651 1.307 2.275 1.803 3.102.035.058.068.117.102.178-.059 5.967-1.949 7.01-4.902 7.19m6.628-8.202c-.037-.065-.074-.13-.113-.195a7.587 7.587 0 0 0-.739-.987c-.385-.455-.648-.768-.782-1.313-.076-2.209-1.241-3.954-2.353-5.124.531-.376 1.004-.63 1.261-.647.636.071 3.044 1.764 3.096 5.031.027 1.81-.347 3.218-.37 3.235"})]}),objects:()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:[r.jsx("path",{d:"M12 0a9 9 0 0 0-5 16.482V21s2.035 3 5 3 5-3 5-3v-4.518A9 9 0 0 0 12 0zm0 2c3.86 0 7 3.141 7 7s-3.14 7-7 7-7-3.141-7-7 3.14-7 7-7zM9 17.477c.94.332 1.946.523 3 .523s2.06-.19 3-.523v.834c-.91.436-1.925.689-3 .689a6.924 6.924 0 0 1-3-.69v-.833zm.236 3.07A8.854 8.854 0 0 0 12 21c.965 0 1.888-.167 2.758-.451C14.155 21.173 13.153 22 12 22c-1.102 0-2.117-.789-2.764-1.453z"}),r.jsx("path",{d:"M14.745 12.449h-.004c-.852-.024-1.188-.858-1.577-1.824-.421-1.061-.703-1.561-1.182-1.566h-.009c-.481 0-.783.497-1.235 1.537-.436.982-.801 1.811-1.636 1.791l-.276-.043c-.565-.171-.853-.691-1.284-1.794-.125-.313-.202-.632-.27-.913-.051-.213-.127-.53-.195-.634C7.067 9.004 7.039 9 6.99 9A1 1 0 0 1 7 7h.01c1.662.017 2.015 1.373 2.198 2.134.486-.981 1.304-2.058 2.797-2.075 1.531.018 2.28 1.153 2.731 2.141l.002-.008C14.944 8.424 15.327 7 16.979 7h.032A1 1 0 1 1 17 9h-.011c-.149.076-.256.474-.319.709a6.484 6.484 0 0 1-.311.951c-.429.973-.79 1.789-1.614 1.789"})]}),people:()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:[r.jsx("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"}),r.jsx("path",{d:"M8 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 8 7M16 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 16 7M15.232 15c-.693 1.195-1.87 2-3.349 2-1.477 0-2.655-.805-3.347-2H15m3-2H6a6 6 0 1 0 12 0"})]}),places:()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:[r.jsx("path",{d:"M6.5 12C5.122 12 4 13.121 4 14.5S5.122 17 6.5 17 9 15.879 9 14.5 7.878 12 6.5 12m0 3c-.275 0-.5-.225-.5-.5s.225-.5.5-.5.5.225.5.5-.225.5-.5.5M17.5 12c-1.378 0-2.5 1.121-2.5 2.5s1.122 2.5 2.5 2.5 2.5-1.121 2.5-2.5-1.122-2.5-2.5-2.5m0 3c-.275 0-.5-.225-.5-.5s.225-.5.5-.5.5.225.5.5-.225.5-.5.5"}),r.jsx("path",{d:"M22.482 9.494l-1.039-.346L21.4 9h.6c.552 0 1-.439 1-.992 0-.006-.003-.008-.003-.008H23c0-1-.889-2-1.984-2h-.642l-.731-1.717C19.262 3.012 18.091 2 16.764 2H7.236C5.909 2 4.738 3.012 4.357 4.283L3.626 6h-.642C1.889 6 1 7 1 8h.003S1 8.002 1 8.008C1 8.561 1.448 9 2 9h.6l-.043.148-1.039.346a2.001 2.001 0 0 0-1.359 2.097l.751 7.508a1 1 0 0 0 .994.901H3v1c0 1.103.896 2 2 2h2c1.104 0 2-.897 2-2v-1h6v1c0 1.103.896 2 2 2h2c1.104 0 2-.897 2-2v-1h1.096a.999.999 0 0 0 .994-.901l.751-7.508a2.001 2.001 0 0 0-1.359-2.097M6.273 4.857C6.402 4.43 6.788 4 7.236 4h9.527c.448 0 .834.43.963.857L19.313 9H4.688l1.585-4.143zM7 21H5v-1h2v1zm12 0h-2v-1h2v1zm2.189-3H2.811l-.662-6.607L3 11h18l.852.393L21.189 18z"})]}),recent:()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:[r.jsx("path",{d:"M13 4h-2l-.001 7H9v2h2v2h2v-2h4v-2h-4z"}),r.jsx("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"})]}),symbols:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{d:"M0 0h11v2H0zM4 11h3V6h4V4H0v2h4zM15.5 17c1.381 0 2.5-1.116 2.5-2.493s-1.119-2.493-2.5-2.493S13 13.13 13 14.507 14.119 17 15.5 17m0-2.986c.276 0 .5.222.5.493 0 .272-.224.493-.5.493s-.5-.221-.5-.493.224-.493.5-.493M21.5 19.014c-1.381 0-2.5 1.116-2.5 2.493S20.119 24 21.5 24s2.5-1.116 2.5-2.493-1.119-2.493-2.5-2.493m0 2.986a.497.497 0 0 1-.5-.493c0-.271.224-.493.5-.493s.5.222.5.493a.497.497 0 0 1-.5.493M22 13l-9 9 1.513 1.5 8.99-9.009zM17 11c2.209 0 4-1.119 4-2.5V2s.985-.161 1.498.949C23.01 4.055 23 6 23 6s1-1.119 1-3.135C24-.02 21 0 21 0h-2v6.347A5.853 5.853 0 0 0 17 6c-2.209 0-4 1.119-4 2.5s1.791 2.5 4 2.5M10.297 20.482l-1.475-1.585a47.54 47.54 0 0 1-1.442 1.129c-.307-.288-.989-1.016-2.045-2.183.902-.836 1.479-1.466 1.729-1.892s.376-.871.376-1.336c0-.592-.273-1.178-.818-1.759-.546-.581-1.329-.871-2.349-.871-1.008 0-1.79.293-2.344.879-.556.587-.832 1.181-.832 1.784 0 .813.419 1.748 1.256 2.805-.847.614-1.444 1.208-1.794 1.784a3.465 3.465 0 0 0-.523 1.833c0 .857.308 1.56.924 2.107.616.549 1.423.823 2.42.823 1.173 0 2.444-.379 3.813-1.137L8.235 24h2.819l-2.09-2.383 1.333-1.135zm-6.736-6.389a1.02 1.02 0 0 1 .73-.286c.31 0 .559.085.747.254a.849.849 0 0 1 .283.659c0 .518-.419 1.112-1.257 1.784-.536-.651-.805-1.231-.805-1.742a.901.901 0 0 1 .302-.669M3.74 22c-.427 0-.778-.116-1.057-.349-.279-.232-.418-.487-.418-.766 0-.594.509-1.288 1.527-2.083.968 1.134 1.717 1.946 2.248 2.438-.921.507-1.686.76-2.3.76"})})},Ry={search:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"13",height:"13",viewBox:"0 0 20 20",opacity:"0.5",children:r.jsx("path",{d:"M12.9 14.32a8 8 0 1 1 1.41-1.41l5.35 5.33-1.42 1.42-5.33-5.34zM8 14A6 6 0 1 0 8 2a6 6 0 0 0 0 12z"})}),delete:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"13",height:"13",viewBox:"0 0 20 20",opacity:"0.5",children:r.jsx("path",{d:"M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z"})})},sre=Object.freeze(Object.defineProperty({__proto__:null,categories:nre,search:Ry},Symbol.toStringTag,{value:"Module"})),rre={search:"搜索",recent:"最近",people:"表情",nature:"动物",foods:"食物",activity:"活动",places:"地点",objects:"物件",symbols:"符号",flags:"旗帜",xuexibangong:"学习办公",shumashebei:"数码设备",IT:r.jsx(r.Fragment,{children:" IT"}),jigefuhao:"几何符号",shenghuo:"生活",biaoqing:"表情",tiyu:"体育",lvxingdidian:"旅行地点",yingyinyouxi:"影音游戏",dongwuzhiwu:"动物植物",shiwuyinliao:"食物饮料",pinpai:"品牌"};class AI extends fn.PureComponent{constructor(t){super(t),this.state={selected:"people"},this.handleClick=this.handleClick.bind(this)}handleClick(t){const n=t.currentTarget.getAttribute("data-index"),{categories:s,onAnchorClick:a}=this.props;a(s[n],n)}render(){const{categories:t,i18n:n}=this.props,{selected:s}=this.state;return r.jsx("nav",{className:"flex justify-between h-[45px] bg-white2/90 rounded-b px-4 items-center w-full overflow-x-auto space-x-2","aria-label":n.categorieslabel,children:t.map((a,o)=>{const{id:i,anchor:l}=a,c=i===s;if(l===!1)return null;const d=i.startsWith("custom-")?"custom":i;return r.jsx("div",{"data-index":o,"aria-label":n.categories[d],onClick:this.handleClick,title:n.categories[d],className:"shrink-0 text-t2 cursor-pointer ".concat(c?"":"text-grey4"),children:rre[i]},i)})})}}AI.propTypes={categories:nt.array,onAnchorClick:nt.func,icons:nt.object};AI.defaultProps={categories:[],onAnchorClick:()=>{},icons:{}};const oO=e=>{const{emoji:t,skin:n,set:s,data:a}=e;return gg(t,n,s,a)},PD=e=>{const{sheet_x:t,sheet_y:n}=oO(e),s=100/(e.sheetColumns-1),a=100/(e.sheetRows-1);return"".concat(s*t,"% ").concat(a*n,"%")},RI=e=>{const{emoji:t,skin:n,set:s,data:a}=e;return hu(t,n,s,a)},are=(e,t)=>{if(!t.onClick)return;const{onClick:n}=t,s=RI(t);n(s,e)},ore=(e,t)=>{if(!t.onOver)return;const{onOver:n}=t,s=RI(t);n(s,e)},ire=(e,t)=>{if(!t.onLeave)return;const{onLeave:n}=t,s=RI(t);n(s,e)},lre=e=>!isNaN(e-parseFloat(e)),cre=e=>{const t=document.createElement("div");for(const n in e){let s=e[n];lre(s)&&(s+="px"),t.style[n]=s}return t.getAttribute("style")},Ql=fn.memo(e=>{e.data.compressed&&I0(e.data);for(const _ in Ql.defaultProps)e[_]===void 0&&Ql.defaultProps[_]!==void 0&&(e[_]=Ql.defaultProps[_]);const t=oO(e);if(!t)return e.fallback?e.fallback(t,e):null;const{unified:n,custom:s,short_names:a,imageUrl:o,keywords:i}=t,l=n&&Gw(n),c=[l].concat(a).filter(Boolean).join(", ");let d={},{children:u}=e,f="emoji-mart-emoji",h=null;if(!n&&!s)return e.fallback?e.fallback(t,e):null;e.tooltip&&(h=i[0]),e.className&&(f+=" ".concat(e.className));const p={name:"span",props:{...e.attribute}};if(e.native&&n){f+=" emoji-mart-emoji-native",d={fontSize:e.size},u=l;const _=parseFloat(e.size);e.forceSize&&(d.display="inline-block",d.width="".concat(_+8,"px"),d.height="".concat(_+8,"px"),d.wordBreak="keep-all")}else if(s)f+=" emoji-mart-emoji-custom",d={width:e.size,height:e.size,display:"inline-block"},t.spriteUrl?d={...d,backgroundImage:"url(".concat(t.spriteUrl,")"),backgroundSize:"".concat(100*e.sheetColumns,"% ").concat(100*e.sheetRows,"%"),backgroundPosition:PD(e)}:d={...d,backgroundImage:"url(".concat(o,")"),backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"};else{if(!(t["has_img_".concat(e.set)]===void 0||t["has_img_".concat(e.set)])&&!e.ignoreEmojiSet)return e.fallback?e.fallback(t,e):null;const x=e.useSvg?n.toLowerCase().replaceAll("-","_").replaceAll("_fe0f",""):"";d={margin:e.useSvg?void 0:"4px",width:e.size,height:e.size,backgroundImage:e.useSvg?"url(".concat(Lo,"emoji/google/u").concat(x,".svg)"):"url(".concat(e.backgroundImageFn(e.set,e.sheetSize),")"),backgroundSize:e.useSvg?void 0:"".concat(100*e.sheetColumns,"% ").concat(100*e.sheetRows,"%"),backgroundPosition:e.useSvg?void 0:PD(e),backgroundRepeat:e.useSvg?void 0:"no-repeat"},p.name="img",p.props={src:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="}}if(e.onClick&&e.useButton&&(p.name="button",p.props={type:"button"}),e.html)return d=cre(d),"<".concat(p.name," style='").concat(d,"' aria-label='").concat(c,"' ").concat(h?"title='".concat(h,"'"):""," class='").concat(f,"'>").concat(u||"","</").concat(p.name,">");d={...d,...e.style};const g=r.jsx(p.name,{onClick:_=>are(_,e),onMouseEnter:_=>ore(_,e),onMouseLeave:_=>ire(_,e),"aria-label":c,className:f,"list-item-custom":"",style:d,...p.props,children:u});return h?r.jsx(Fe,{popup:h,popupClass:"px-1.5",className:"inline-block",children:g}):g});Ql.propTypes={...qd,data:nt.object.isRequired};Ql.defaultProps=Rc;let PI=class extends fn.Component{constructor(t){super(t),this.data=t.data,this.lazyLoad=t.lazyLoad,this.setContainerRef=this.setContainerRef.bind(this),this.setLabelRef=this.setLabelRef.bind(this),this.firstRender=this.lazyLoad}componentDidMount(){this.firstRender&&(this.firstRenderTimeout=setTimeout(()=>{this.firstRender=!1,this.forceUpdate()},300)),this.margin=0,this.minMargin=0,this.memoizeSize()}componentWillUnmount(){clearTimeout(this.firstRenderTimeout)}shouldComponentUpdate(t){const{name:n,perLine:s,native:a,hasStickyPosition:o,emojis:i,emojiProps:l,categoryBaseIndex:c,activeIndex:d}=this.props,{skin:u,size:f,set:h,customColorKey:p}=l,{perLine:g,native:_,hasStickyPosition:x,emojis:F,emojiProps:b,categoryBaseIndex:w,activeIndex:E}=t,{skin:C,size:k,set:T,customColorKey:v}=b;let I=!1;n==="Recent"&&s!==g&&(I=!0),n==="Search"&&(I=i!==F),(u!==C||f!==k||a!==_||h!==T||p!==v||o!==x||c!==w)&&(I=!0);const j=this.getEmojis();return j&&d!==E&&(E>=w&&E<j.length+w||d>=w&&d<j.length+w)&&(I=!0),I}memoizeSize(){if(!this.container){this.top=0,this.maxMargin=0;return}const t=this.container.parentElement,{top:n,height:s}=this.container.getBoundingClientRect(),{top:a}=t.getBoundingClientRect(),{height:o}=this.label.getBoundingClientRect();this.top=n-a+t.scrollTop,s===0?this.maxMargin=0:this.maxMargin=s-o}handleScroll(t){let n=t-this.top;if(n=n<this.minMargin?this.minMargin:n,n=n>this.maxMargin?this.maxMargin:n,n!==this.margin)return this.props.hasStickyPosition||(this.label.style.top="".concat(n,"px")),this.margin=n,!0}getEmojis(){const{name:t,recent:n,perLine:s}=this.props;let{emojis:a}=this.props;if(t==="Recent"){const{custom:o}=this.props,i=n||Gf.get(s);if(i.length&&(a=i.map(l=>{const c=o.filter(d=>d.id===l)[0];return c||l}).filter(l=>!!gg(l,null,null,this.data))),a.length===0&&i.length>0)return null}if(a)if(this.firstRender){const o=Gf.get(s).length,i=8*s-o;a.length>i&&(a=a.slice(0,i))}else a=a.slice(0);return a}updateDisplay(t){!this.getEmojis()||!this.container||(this.container.style.display=t)}setContainerRef(t){this.container=t}setLabelRef(t){this.label=t}render(){const{id:t,name:n,hasStickyPosition:s,emojiProps:a,i18n:o,categoryBaseIndex:i,activeIndex:l}=this.props,c=this.getEmojis();let d={},u={},f={};c||(f={display:"none"}),s||(d={height:28},u={position:"absolute"});const h=o.categories[t]||n;return r.jsxs("section",{ref:this.setContainerRef,className:"emoji-mart-category","aria-label":h,style:f,children:[r.jsxs("div",{style:d,"data-name":n,className:"flex items-center px-4 bg-white2 emoji-mart-category-label text-t2 h-9",children:[r.jsx("span",{className:"flex items-center text-grey3 w-full h-full ".concat(c&&c.length===0?"hidden":""),style:u,ref:this.setLabelRef,"aria-hidden":!0,children:h}),c&&!c.length&&r.jsx("div",{className:"flex justify-center text-t2 text-grey4 w-full",children:"无相关 Emoji"})]}),r.jsx("div",{className:"pl-3 emoji-mart-category-list mb-2.5",children:c&&c.map((p,g)=>r.jsx(Ql,{emoji:p,data:this.data,...a,className:i+g===l?"emoji-mart-emoji-active":void 0},p.short_names&&p.short_names.join("_")||p.name+g||p))})]})}};PI.propTypes={emojis:nt.array,hasStickyPosition:nt.bool,name:nt.string.isRequired,native:nt.bool.isRequired,perLine:nt.number.isRequired,emojiProps:nt.object.isRequired,recent:nt.arrayOf(nt.string),notFound:nt.func,notFoundEmoji:nt.string.isRequired,categoryBaseIndex:nt.number,activeIndex:nt.number};PI.defaultProps={emojis:[],hasStickyPosition:!0};class Ww extends fn.PureComponent{constructor(t){super(t),this.state={opened:!1}}handleClick(t){const n=parseInt(t.currentTarget.getAttribute("data-skin"),10),{onChange:s}=this.props;this.state.opened?(this.setState({opened:!1}),n!==this.props.skin&&s(n)):this.setState({opened:!0})}render(){return null}}Ww.propTypes={onChange:nt.func,skin:nt.number.isRequired};Ww.defaultProps={onChange:()=>{}};class LI extends Ww{constructor(t){super(t),this.handleClick=this.handleClick.bind(this)}render(){const{skin:t,emojiProps:n,data:s,skinEmoji:a,i18n:o}=this.props,{opened:i}=this.state,l=[];for(let c=1;c<=6;c++){const d=c===t;l.push(r.jsx("span",{className:"emoji-mart-skin-swatch custom".concat(d?" selected":""),children:r.jsx("span",{onClick:this.handleClick,"data-skin":c,className:"emoji-mart-skin-tone-".concat(c),children:r.jsx(Ql,{emoji:a,data:s,skin:c,backgroundImageFn:n.backgroundImageFn,native:n.native,set:n.set,sheetSize:n.sheetSize,size:23})})},"skin-tone-".concat(c)))}return r.jsxs("div",{className:"emoji-mart-skin-swatches custom".concat(i?" opened":""),children:[r.jsx("div",{className:"emoji-mart-skin-text".concat(i?" opened":""),children:o.skintext}),l]})}}LI.propTypes={onChange:nt.func,skin:nt.number.isRequired,emojiProps:nt.object.isRequired,skinTone:nt.number,skinEmoji:nt.string.isRequired,i18n:nt.object};LI.defaultProps={onChange:()=>{},skinTone:null};class BI extends Ww{constructor(t){super(t),this.handleClick=this.handleClick.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}handleKeyDown(t){(t.keyCode===13||t.keyCode===32)&&(t.preventDefault(),this.handleClick(t))}render(){const{skin:t,i18n:n}=this.props,{opened:s}=this.state,a=[];for(let o=1;o<=6;o++){const i=o===t,l=s||i;a.push(r.jsx("span",{className:"emoji-mart-skin-swatch".concat(i?" selected":""),"aria-label":n.skintones[o],"aria-hidden":!l,...s?{role:"menuitem"}:{},children:r.jsx("span",{onClick:this.handleClick,onKeyDown:this.handleKeyDown,role:"button",...i?{"aria-haspopup":!0,"aria-expanded":!!s}:{},...s?{"aria-pressed":!!i}:{},tabIndex:l?"0":"","aria-label":n.skintones[o],title:n.skintones[o],"data-skin":o,className:"emoji-mart-skin emoji-mart-skin-tone-".concat(o)})},"skin-tone-".concat(o)))}return r.jsx("section",{className:"emoji-mart-skin-swatches".concat(s?" opened":""),"aria-label":n.skintext,children:r.jsx("div",{...s?{role:"menubar"}:{},children:a})})}}BI.propTypes={onChange:nt.func,skin:nt.number.isRequired,i18n:nt.object};BI.defaultProps={onChange:()=>{}};class OI extends fn.PureComponent{constructor(t){super(t),this.data=t.data,this.state={emoji:null}}render(){const{emoji:t}=this.state,{emojiProps:n,skinsProps:s,showSkinTones:a,title:o,emoji:i,i18n:l,showPreview:c}=this.props;if(t&&c){const d=gg(t,null,null,this.data),{emoticons:u=[]}=d,f=[],h=[];return u.forEach(p=>{f.indexOf(p.toLowerCase())>=0||(f.push(p.toLowerCase()),h.push(p))}),r.jsxs("div",{className:"emoji-mart-preview",children:[r.jsx("div",{className:"emoji-mart-preview-emoji","aria-hidden":"true",children:r.jsx(Ql,{key:t.id,emoji:t,data:this.data,...n})}),r.jsxs("div",{className:"emoji-mart-preview-data","aria-hidden":"true",children:[r.jsx("div",{className:"emoji-mart-preview-name",children:t.name}),r.jsx("div",{className:"emoji-mart-preview-shortnames",children:d.short_names.map(p=>r.jsxs("span",{className:"emoji-mart-preview-shortname",children:[":",p,":"]},p))}),r.jsx("div",{className:"emoji-mart-preview-emoticons",children:h.map(p=>r.jsx("span",{className:"emoji-mart-preview-emoticon",children:p},p))})]})]})}return r.jsxs("div",{className:"emoji-mart-preview",children:[r.jsx("div",{className:"emoji-mart-preview-emoji","aria-hidden":"true",children:i&&i.length&&r.jsx(Ql,{emoji:i,data:this.data,...n})}),r.jsx("div",{className:"emoji-mart-preview-data","aria-hidden":"true",children:r.jsx("span",{className:"emoji-mart-title-label",children:o})}),a&&r.jsx("div",{className:"emoji-mart-preview-skins".concat(s.skinEmoji?" custom":""),children:s.skinEmoji?r.jsx(LI,{skin:s.skin,emojiProps:n,data:this.data,skinEmoji:s.skinEmoji,i18n:l,onChange:s.onChange}):r.jsx(BI,{skin:s.skin,i18n:l,onChange:s.onChange})})]})}}OI.propTypes={showSkinTones:nt.bool,title:nt.string.isRequired,emoji:nt.string.isRequired,emojiProps:nt.object.isRequired,skinsProps:nt.object.isRequired};OI.defaultProps={showSkinTones:!0,onChange:()=>{}};let dre=0,MI=class extends fn.PureComponent{constructor(t){super(t),this.state={icon:Ry.search,isSearching:!1,id:++dre},this.data=t.data,this.setRef=this.setRef.bind(this),this.clear=this.clear.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.handleChange=Vse(this.handleChange.bind(this))}componentDidMount(){this.input&&this.input.value&&this.search(this.input.value)}search(t){t===""?this.setState({icon:Ry.search,isSearching:!1}):this.setState({icon:Ry.delete,isSearching:!0});const n=this.props.useCustomIcon?Mf.customSearch:Mf.search;this.props.onSearch(n(t,{emojisToShowFilter:this.props.emojisToShowFilter,maxResults:this.props.maxResults,include:this.props.include,exclude:this.props.exclude,custom:this.props.custom}))}clear(){this.input.value!==""&&(this.input.value="",this.input.focus(),this.search(""))}handleChange(){this.input&&this.search(this.input.value)}handleKeyUp(t){t.keyCode===13&&this.clear()}setRef(t){this.input=t}render(){const{i18n:t,autoFocus:n}=this.props,{id:s}=this.state,a="emoji-mart-search-".concat(s);return r.jsxs("section",{className:"emoji-mart-search","aria-label":t.search,style:{width:"100%"},children:[r.jsx("input",{id:a,ref:this.setRef,type:"search",className:"focus-within-border",onChange:this.handleChange,placeholder:this.props.useCustomIcon?t.searchIcon:t.search,autoFocus:n,autoComplete:"false"}),r.jsx("label",{className:"emoji-mart-sr-only",htmlFor:a,children:t.search})]})}};MI.propTypes={onSearch:nt.func,maxResults:nt.number,emojisToShowFilter:nt.func,autoFocus:nt.bool};MI.defaultProps={onSearch:()=>{},maxResults:75,emojisToShowFilter:null,autoFocus:!1};const LD={search:"搜索 Emoji",searchIcon:"搜索 Icons",clear:"Clear",notfound:"No Emoji Found",skintext:"Choose your default skin tone",categories:{search:"搜索结果",recent:"最近使用",people:"表情与人物",nature:"动物与自然",foods:"食物与饮料",activity:"活动",places:"旅行与地点",objects:"物件",symbols:"符号",flags:"旗帜",custom:"自定义"},categorieslabel:"Emoji 分类",skintones:{1:"Default Skin Tone",2:"Light Skin Tone",3:"Medium-Light Skin Tone",4:"Medium Skin Tone",5:"Medium-Dark Skin Tone",6:"Dark Skin Tone"}},BD=3;class UI extends fn.PureComponent{constructor(t){super(t),this.scrollTop=0,this.CUSTOM=[],this.RECENT_CATEGORY={id:"recent",name:"Recent",emojis:null,anchor:!1},this.SEARCH_CATEGORY={id:"search",name:"Search",emojis:null,anchor:!1},t.data.compressed&&I0(t.data),this.data=t.data,this.i18n=rT(LD,t.i18n),this.icons=rT(sre,t.icons),this.state={renderCategoryCount:BD},this.categories=[];let n=[].concat(this.data.categories);if(this.scrollRef=y.createRef(),t.custom.length>0){const i={};let l=0;t.custom.forEach(c=>{i[c.customCategory]||(i[c.customCategory]={id:c.customCategory?"custom-".concat(c.customCategory):"custom",name:c.customCategory||"Custom",emojis:[],anchor:l===0},l++);const d=i[c.customCategory],u={...c,id:c.short_names[0],custom:!0};d.emojis.push(u),this.CUSTOM.push(u)}),n=n.concat(Object.keys(i).map(c=>i[c]))}t.include!==void 0&&n.sort((i,l)=>t.include.indexOf(i.id)>t.include.indexOf(l.id)?1:-1);for(let i=0;i<n.length;i++){const l=n[i],c=t.include&&t.include.length?t.include.indexOf(l.id)>-1:!0,d=t.exclude&&t.exclude.length?t.exclude.indexOf(l.id)>-1:!1;if(!(!c||d))if(t.emojisToShowFilter){const u=[],{emojis:f}=l;for(let h=0;h<f.length;h++){const p=f[h];t.emojisToShowFilter(this.data.emojis[p]||p)&&u.push(p)}if(u.length){const h={emojis:u,name:l.name,id:l.id};this.categories.push(h)}}else this.categories.push(l)}const s=t.include&&t.include.length?t.include.indexOf(this.RECENT_CATEGORY.id)>-1:!0,a=t.exclude&&t.exclude.length?t.exclude.indexOf(this.RECENT_CATEGORY.id)>-1:!1,o=Gf.get(this.props.perLine).length>0;if(s&&!a&&o&&this.categories.unshift(this.RECENT_CATEGORY),this.categories[0]&&(this.categories[0].first=!0),this.categories.unshift(this.SEARCH_CATEGORY),this.setAnchorsRef=this.setAnchorsRef.bind(this),this.handleAnchorClick=this.handleAnchorClick.bind(this),this.setSearchRef=this.setSearchRef.bind(this),this.handleSearch=this.handleSearch.bind(this),this.setScrollRef=this.setScrollRef.bind(this),this.handleScroll=this.handleScroll.bind(this),this.handleScrollPaint=this.handleScrollPaint.bind(this),this.handleEmojiOver=this.handleEmojiOver.bind(this),this.handleEmojiLeave=this.handleEmojiLeave.bind(this),this.handleEmojiClick=this.handleEmojiClick.bind(this),this.handleEmojiSelect=this.handleEmojiSelect.bind(this),this.setPreviewRef=this.setPreviewRef.bind(this),this.handleSkinChange=this.handleSkinChange.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleDarkMatchMediaChange=this.handleDarkMatchMediaChange.bind(this),this.getAllCategoryBaseIndex=this.getAllCategoryBaseIndex.bind(this),this.emojiProps={native:t.native,skin:t.skin,size:t.emojiSize,set:t.set,sheetSize:t.sheetSize,sheetColumns:t.sheetColumns,sheetRows:t.sheetRows,forceSize:t.native,tooltip:t.emojiTooltip,backgroundImageFn:t.backgroundImageFn,useButton:t.useButton,fallback:t.fallback,customColorKey:t.customColorKey,onOver:this.handleEmojiOver,onLeave:this.handleEmojiLeave,onClick:this.handleEmojiClick(!1)},this.emojiPropsFromRecently={...this.emojiProps,onClick:this.handleEmojiClick(!0)},this.props.keyword){this.lastKeyword=this.props.keyword;const i=this.props.useCustomIcon?Mf.customSearch:Mf.search;this.handleSearch(i(this.props.keyword,{emojisToShowFilter:this.props.emojisToShowFilter,maxResults:this.props.maxResults||75,include:this.props.include,exclude:this.props.exclude,custom:this.CUSTOM}))}}componentDidUpdate(){if(this.lastKeyword!==this.props.keyword)if(this.lastKeyword=this.props.keyword,!this.props.keyword)this.handleSearch(null);else{const t=this.props.useCustomIcon?Mf.customSearch:Mf.search;this.handleSearch(t(this.props.keyword,{emojisToShowFilter:this.props.emojisToShowFilter,maxResults:this.props.maxResults||75,include:this.props.include,exclude:this.props.exclude,custom:this.CUSTOM}))}this.updateCategoriesSize(),this.handleScroll()}componentWillUnmount(){this.SEARCH_CATEGORY.emojis=null,clearTimeout(this.leaveTimeout),this.addRenderCategoryCountTimer&&clearTimeout(this.addRenderCategoryCountTimer),this.darkMatchMedia&&this.darkMatchMedia.offChange(this.handleDarkMatchMediaChange)}testStickyPosition(){const t=document.createElement("div");["","-webkit-","-ms-","-moz-","-o-"].forEach(s=>t.style.position="".concat(s,"sticky")),this.hasStickyPosition=!!t.style.position.length}getPreferredTheme(){return this.props.theme!=="auto"?this.props.theme:this.state.theme?this.state.theme:typeof matchMedia!="function"||(this.darkMatchMedia||(this.darkMatchMedia=new ZL("(prefers-color-scheme: dark)"),this.darkMatchMedia.onChange(this.handleDarkMatchMediaChange)),this.darkMatchMedia.media.match(/^not/))?Ub.theme:this.darkMatchMedia.matches?"dark":"light"}handleDarkMatchMediaChange(){this.setState({theme:this.darkMatchMedia.matches?"dark":"light"})}handleEmojiOver(t){const{preview:n}=this;if(!n)return;const s=this.CUSTOM.filter(a=>a.id===t.id)[0];for(const a in s)s.hasOwnProperty(a)&&(t[a]=s[a]);n.setState({emoji:t}),clearTimeout(this.leaveTimeout)}handleEmojiLeave(){const{preview:t}=this;t&&(this.leaveTimeout=setTimeout(()=>{t.setState({emoji:null})},16))}handleEmojiClick(t){return(n,s)=>{this.props.onClick(n,s),this.handleEmojiSelect(n,s,t)}}handleEmojiSelect(t,n,s){const a=this.props.onSelect(t,n,s);!this.props.recent&&!a&&Gf.add(t);const o=this.categoryRefs["category-1"];if(o){const{maxMargin:i}=o;this.props.enableFrequentEmojiSort&&o.forceUpdate(),requestAnimationFrame(()=>{this.scroll&&(o.memoizeSize(),i!==o.maxMargin&&(this.updateCategoriesSize(),this.handleScrollPaint(),this.SEARCH_CATEGORY.emojis&&o.updateDisplay("none")))})}}handleScroll(){this.waitingForPaint||(this.waitingForPaint=!0,requestAnimationFrame(this.handleScrollPaint))}handleScrollPaint(){if(this.waitingForPaint=!1,!this.scroll)return;let t=null;if(this.SEARCH_CATEGORY.emojis)t=this.SEARCH_CATEGORY;else{const n=this.scroll,s=n==null?void 0:n.scrollTop,a=s>(this.scrollTop||0);let o=0;this.scrollTop=s;for(let i=0,l=this.categories.length;i<l;i++){const c=a?this.categories.length-1-i:i,d=this.categories[c],u=this.categoryRefs["category-".concat(c)];if(u){const f=u.handleScroll(s);(!o||u.top<o)&&u.top>0&&(o=u.top),f&&!t&&(t=d)}}s<o?t=this.categories.filter(i=>i.anchor!==!1)[0]:s+this.clientHeight>=this.scrollHeight&&(t=this.categories[this.categories.length-1])}if(t){const{anchors:n}=this,{id:s}=t;n&&n.state.selected!==s&&n.setState({selected:s})}}handleSearch(t){if(this.SEARCH_CATEGORY.emojis=t,t&&clearTimeout(this.addRenderCategoryCountTimer),!!this.categoryRefs){for(let n=0,s=this.categories.length;n<s;n++){const a=this.categoryRefs["category-".concat(n)];if(a&&a.props.name!=="Search"){const o=t?"none":"inherit";a.updateDisplay(o)}}this.forceUpdate(),this.scroll&&(this.scroll.scrollTop=0),this.handleScroll()}}handleAnchorClick(t,n){const s=this.categoryRefs["category-".concat(n)],{scroll:a}=this;let o=null;o=()=>{if(s){let{top:i}=s;t.first?i=0:i+=1,a.scrollTop=i}},this.SEARCH_CATEGORY.emojis?(this.handleSearch(null),this.search&&this.search.clear(),requestAnimationFrame(o)):o()}handleSkinChange(t){const n={skin:t},{onSkinChange:s}=this.props;this.setState(n),mm.update(n),s(t)}handleKeyDown(t){let n=!1;switch(t.keyCode){case 13:let s=null;this.SEARCH_CATEGORY.emojis&&this.SEARCH_CATEGORY.emojis.length&&(s=hu(this.SEARCH_CATEGORY.emojis[0],this.state.skin,this.props.set,this.props.data))&&(this.handleEmojiSelect(s),n=!0);break}n&&t.preventDefault()}updateCategoriesSize(){for(let t=0,n=this.categories.length;t<n;t++){const s=this.categoryRefs["category-".concat(t)];s&&s.memoizeSize()}if(this.scroll){const t=this.scroll;this.scrollHeight=t.scrollHeight,this.clientHeight=t.clientHeight}}getCategories(){if(this.SEARCH_CATEGORY.emojis)return this.categories.slice(0,this.state.renderCategoryCount);const t=this.state.renderCategoryCount===BD;try{if(this.state.renderCategoryCount<this.categories.length){const n=Math.min(this.state.renderCategoryCount+1,this.categories.length);return this.addRenderCategoryCountTimer=setTimeout(()=>{this.SEARCH_CATEGORY.emojis||this.setState({renderCategoryCount:n})},t?500:200),this.categories.slice(0,this.state.renderCategoryCount)}}catch(n){}return this.categories}setAnchorsRef(t){this.anchors=t}setSearchRef(t){this.search=t}setPreviewRef(t){this.preview=t}setScrollRef(t){this.scroll=t,this.scrollRef.current=t}setCategoryRef(t,n){this.categoryRefs||(this.categoryRefs={}),this.categoryRefs[t]=n,n&&this.SEARCH_CATEGORY.emojis&&n.props.name!=="Search"&&n.updateDisplay("none")}getAllCategoryBaseIndex(t){let n=0;const s={};let a=0;if(this.SEARCH_CATEGORY.emojis)return s[0]=0,[s,this.SEARCH_CATEGORY.emojis.length];for(let o=0;o<t.length;o++){const i=t[o];if(i.name==="Recent"){const{custom:l,recent:c,perLine:d}=this.props,u=c||Gf.get(d);if(u.length){const f=u.map(h=>{const p=l.filter(g=>g.id===h)[0];return p||h}).filter(h=>!!gg(h,null,null,this.data)).length;s[o]=n,n+=f,a+=f}}else i.emojis&&(s[o]=n,n+=i.emojis.length,a+=i.emojis.length)}return[s,a]}render(){const{perLine:t,set:n,sheetSize:s,sheetColumns:a,sheetRows:o,style:i,title:l,emoji:c,color:d,native:u,backgroundImageFn:f,emojisToShowFilter:h,showPreview:p,showSkinTones:g,include:_,exclude:x,recent:F,autoFocus:b,skinEmoji:w,notFound:E,notFoundEmoji:C,customColorKey:k}=this.props,T=this.getPreferredTheme(),v=this.props.skin||this.state.skin||mm.get("skin")||this.props.defaultSkin,I=this.getCategories(),[j,S]=this.getAllCategoryBaseIndex(I),D=this,A=this.props.hideSearchInput&&this.SEARCH_CATEGORY.emojis!==null;return this.emojiProps={...this.emojiProps,customColorKey:k},this.emojiPropsFromRecently={...this.emojiPropsFromRecently,customColorKey:k},r.jsxs("section",{style:{...i},className:"emoji-mart emoji-mart-".concat(T," relative"),"aria-label":l,onKeyDown:this.handleKeyDown,children:[this.props.customHeader,!this.props.hideSearchInput&&r.jsxs("div",{style:{display:"flex",alignItems:"center",marginTop:"15px"},children:[r.jsx(MI,{useCustomIcon:this.props.useCustomIcon,ref:this.setSearchRef,onSearch:this.handleSearch,data:this.data,i18n:this.i18n,emojisToShowFilter:h,include:_,exclude:x,custom:this.CUSTOM,autoFocus:b}),this.props.searchBtn]}),r.jsxs("div",{ref:this.setScrollRef,className:this.props.hideSearchInput?"emoji-mart-scroll-inline overflow-auto":"emoji-mart-scroll overflow-auto",onScroll:this.handleScroll,children:[r.jsx("div",{style:{marginTop:"10px"}}),r.jsx(Um,{type:"grid",customSelector:A?'[aria-label="'.concat(LD.categories.search,'"]'):"",spanCount:t,itemCount:S,customItem:!0,defaultIndex:-1,containerRef:this.scrollRef,children:P=>I.map((L,O)=>r.jsx(PI,{lazyLoad:L.id==="people",ref:this.setCategoryRef.bind(D,"category-".concat(O)),activeIndex:P,id:L.id,name:L.name,emojis:L.emojis,perLine:t,native:u,hasStickyPosition:this.hasStickyPosition,data:this.data,i18n:this.i18n,categoryBaseIndex:j[O],recent:L.id===this.RECENT_CATEGORY.id?F:void 0,custom:L.id===this.RECENT_CATEGORY.id?this.CUSTOM:void 0,emojiProps:O===1?this.emojiPropsFromRecently:this.emojiProps,notFound:E,notFoundEmoji:C,useCustomIcon:this.props.useCustomIcon},L.name))}),!A&&r.jsx("div",{className:"h-[47px]"})]}),!A&&r.jsx("div",{className:"emoji-mart-bar absolute w-full bottom-0 z-10",children:r.jsx(AI,{ref:this.setAnchorsRef,data:this.data,i18n:this.i18n,color:d,categories:this.categories,onAnchorClick:this.handleAnchorClick,icons:this.icons})}),(p||g)&&r.jsx("div",{className:"emoji-mart-bar",children:r.jsx(OI,{ref:this.setPreviewRef,data:this.data,title:l,emoji:c,showSkinTones:g,showPreview:p,emojiProps:{native:u,size:38,skin:v,set:n,sheetSize:s,sheetColumns:a,sheetRows:o,backgroundImageFn:f},skinsProps:{skin:v,onChange:this.handleSkinChange,skinEmoji:w},i18n:this.i18n})})]})}}UI.propTypes={...aO,data:nt.object.isRequired};UI.defaultProps={...Ub};class VI extends fn.PureComponent{render(){return r.jsx(UI,{...this.props,...this.state})}}VI.propTypes=aO;VI.defaultProps={...Ub,data:rp};const Wf=e=>{for(const t in Wf.defaultProps)e[t]===void 0&&Wf.defaultProps[t]!==void 0&&(e[t]=Wf.defaultProps[t]);return r.jsx(Ql,{...e})};Wf.propTypes=qd;Wf.defaultProps={...Rc,data:rp};var Ze=(e=>(e.blue="blue",e.green="green",e.yellow="yellow",e.orange="orange",e.red="red",e.pink="pink",e.purple="purple",e.active_color="active_color",e.brown="brown",e.grey="grey",e.black="black",e.white="white",e.light_yellow="light_yellow",e.light_green="light_green",e.light_blue="light_blue",e.light_purple="light_purple",e.light_red="light_red",e.yellow_green="yellow_green",e.green_blue="green_blue",e.blue_purple="blue_purple",e.purple_red="purple_red",e.red_orange="red_orange",e))(Ze||{});const ure={[m.CardSize.SMALL]:192,[m.CardSize.MEDIUM]:272,[m.CardSize.LARGE]:332},iT=e=>e===m.CollectionCardImageDir.VERTICAL?1.5:.55,ji=(e,t)=>{const n=ure[e];return t===m.CollectionCardImageDir.VERTICAL?n-10:n},fre={[m.CardSize.SMALL]:100,[m.CardSize.MEDIUM]:150,[m.CardSize.LARGE]:180},oo=e=>{const t=(e==null?void 0:e.type)===m.CollectionSchemaType.ID_NUMBER?$I:kp;return e!=null&&e.width?Math.max(HI,e.width):t},kp=180,$I=66,HI=38,iO=1200,Si=37,vr=[{key:Ze.grey,name:"灰色"},{key:Ze.brown,name:"棕色"},{key:Ze.orange,name:"橘色"},{key:Ze.yellow,name:"黄色"},{key:Ze.green,name:"绿色"},{key:Ze.blue,name:"蓝色"},{key:Ze.purple,name:"紫色"},{key:Ze.pink,name:"粉色"},{key:Ze.red,name:"红色"}],un={[m.CollectionSchemaType.TITLE]:"IcTitle",[m.CollectionSchemaType.NUMBER]:"IcChartNumber",[m.CollectionSchemaType.TEXT]:"IcPropertyText",[m.CollectionSchemaType.CHECKBOX]:"IcCheck",[m.CollectionSchemaType.SELECT]:"IcExclusiveChoice",[m.CollectionSchemaType.MULTI_SELECT]:"IcMultipleChoice",[m.CollectionSchemaType.CREATED_AT]:"IcClockPlus",[m.CollectionSchemaType.UPDATED_AT]:"IcClockCheck",[m.CollectionSchemaType.DATE]:"IcCalendar",[m.CollectionSchemaType.PERSON]:"IcMember",[m.CollectionSchemaType.FILE]:"IcPaperclip",[m.CollectionSchemaType.URL]:"IcLink",[m.CollectionSchemaType.EMAIL]:"IcMail",[m.CollectionSchemaType.PHONE]:"IcCall",[m.CollectionSchemaType.CREATED_BY]:"IcUserAdd",[m.CollectionSchemaType.UPDATED_BY]:"IcUserEdit",[m.CollectionSchemaType.FORMULA]:"IcFormula",[m.CollectionSchemaType.RELATION]:"IcAssociation",[m.CollectionSchemaType.ROLLUP]:"IcSearch",[m.CollectionSchemaType.ID_NUMBER]:"IcMenuNum"},zI=[{type:m.CollectionSchemaType.TEXT,title:"文本",icon:un.text},{type:m.CollectionSchemaType.NUMBER,title:"数字",icon:un.number},{type:m.CollectionSchemaType.CHECKBOX,title:"勾选框",icon:un.checkbox},{type:m.CollectionSchemaType.SELECT,title:"单选",icon:un.select},{type:m.CollectionSchemaType.MULTI_SELECT,title:"多选",icon:un.multi_select},{type:m.CollectionSchemaType.DATE,title:"日期",icon:un.date},{type:m.CollectionSchemaType.ID_NUMBER,title:"ID",icon:un.id_number},{type:m.CollectionSchemaType.PERSON,title:"人员",icon:un.person},{type:m.CollectionSchemaType.FILE,title:"文件媒体",icon:un.file},{type:m.CollectionSchemaType.URL,title:"网址链接",icon:un.url},{type:m.CollectionSchemaType.EMAIL,title:"邮箱",icon:un.email},{type:m.CollectionSchemaType.PHONE,title:"电话",icon:un.phone},{type:m.CollectionSchemaType.FORMULA,title:"公式",icon:un.formula},{type:m.CollectionSchemaType.RELATION,title:"关联",icon:un.relation},{type:m.CollectionSchemaType.ROLLUP,title:"汇总",icon:un.rollup},{type:m.CollectionSchemaType.CREATED_AT,title:"创建时间",icon:un.created_at},{type:m.CollectionSchemaType.CREATED_BY,title:"创建人",icon:un.created_by},{type:m.CollectionSchemaType.UPDATED_AT,title:"编辑时间",icon:un.updated_at},{type:m.CollectionSchemaType.UPDATED_BY,title:"编辑人",icon:un.updated_by}],lO=[{type:m.CollectionSchemaType.TEXT,title:"文本",icon:un.text},{type:m.CollectionSchemaType.NUMBER,title:"数字",icon:un.number},{type:m.CollectionSchemaType.CHECKBOX,title:"勾选框",icon:un.checkbox},{type:m.CollectionSchemaType.SELECT,title:"单选",icon:un.select},{type:m.CollectionSchemaType.MULTI_SELECT,title:"多选",icon:un.multi_select},{type:m.CollectionSchemaType.DATE,title:"日期",icon:un.date},{type:m.CollectionSchemaType.PERSON,title:"人员",icon:un.person},{type:m.CollectionSchemaType.FILE,title:"文件媒体",icon:un.file},{type:m.CollectionSchemaType.URL,title:"网址链接",icon:un.url},{type:m.CollectionSchemaType.EMAIL,title:"邮箱",icon:un.email},{type:m.CollectionSchemaType.PHONE,title:"电话",icon:un.phone}],qI=[m.CollectionSchemaType.CREATED_AT,m.CollectionSchemaType.CREATED_BY,m.CollectionSchemaType.UPDATED_AT,m.CollectionSchemaType.UPDATED_BY,m.CollectionSchemaType.RELATION,m.CollectionSchemaType.ROLLUP,m.CollectionSchemaType.FORMULA],hm=[m.CollectionSchemaType.CREATED_AT,m.CollectionSchemaType.UPDATED_AT,m.CollectionSchemaType.CREATED_BY,m.CollectionSchemaType.UPDATED_BY],GI=[m.CollectionSchemaType.FORMULA,m.CollectionSchemaType.ROLLUP],mre=Hv(zI,"type"),hre=Hv(lO,"type"),rc={tableFooter:"table-footer",tableHeader:"table-header",tableSortManager:"table-sort-manager"};var Kf=(e=>(e.left="left",e.right="right",e))(Kf||{});const pre=["left","right"],gre=50,Tp=9999,Dn=200,ac=e=>e>=300,OD=10,_re=typeof navigator<"u"&&/iPhone/i.test(navigator.userAgent),xre=typeof navigator<"u"&&/windows|win32/i.test(navigator.userAgent),Hl=typeof navigator<"u"&&/Mac OS X/.test(navigator.userAgent),cO=typeof navigator<"u"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),Ds=Hl?"⌘":"Ctrl",nC=Hl?"⌥":"Alt",dO=5,Kw=e=>{const{showBg:t=!0}=e,n=y.useRef(qe()),s=y.useRef(null),[a,o,i]=y.useMemo(()=>{const g=localStorage.getItem(t0),_=e.items.slice(0);let x=_.reduce((b,w)=>b+w.items.length,0),F=!1;if(g!=="undefined"&&g!=null&&_[0]&&!e.disabledHasRecently){const b={perLine:_[0].perLine,title:"上次使用",items:[JSON.parse(g)],rightText:"".concat(Ds,"+Shift+H")};_.unshift(b),x+=1,F=!0}return[F,_,x]},[e.items,e.disabledHasRecently]),l=g=>{var x;if(g<0||g>=i)return null;let _=0;for(const F of o)for(let b=0;b<F.items.length;b++){if(g===_)return(x=s.current)==null?void 0:x.querySelector('[data-list-item="'.concat(n.current,"-").concat(F.title,"-").concat(b,'"]'));_++}return null},c=(g,_)=>{var b;const x=(b=e.perLine)!=null?b:dO;let F;return _==="up"||_==="down"?g===0&&_==="down"&&a?F=g+1:g===1&&_==="up"&&a?F=g-1:F=_==="up"?g-x:g+x:F=_==="left"?g-1:g+1,F<0&&(F=i-1),F>=i&&(F=0),F},[d]=R3(i,l,c,dr+1,{scrollContainer:s});let u=-1,f=-1,h=0,p=!1;return o.forEach((g,_)=>{if(!p){u=_;for(let x=0;x<g.items.length;x++){if(d===h){p=!0,f=x;break}h++}}}),r.jsxs("div",{ref:s,"data-no-cancel-selected":!0,className:R(t&&"next-modal","overflow-y-auto pt-1.5 max-h-[80vh] select-none"),onPointerDown:g=>g.preventDefault(),children:[r.jsx(uO.Provider,{value:f,children:o.map((g,_)=>r.jsx("div",{className:"mb-2.5",children:r.jsx(bre,{selected:u===_,id:n.current,...g,perLine:e.perLine,onColorSelect:e.onColorSelect})},_))}),e.footer]})},yre=42.5,bre=e=>{const{title:t,rightText:n,items:s,perLine:a=dO,id:o,selected:i}=e,l=yre*a+8*3,c=Fre();return r.jsxs("div",{style:{width:l},children:[r.jsxs("div",{className:"flex items-center justify-between text-t2 text-grey3 px-3.5 h-9",children:[r.jsx("div",{children:t}),r.jsx("div",{children:n})]}),r.jsx("div",{className:"flex flex-row flex-wrap justify-between px-2",children:s.map((d,u)=>r.jsx(WI,{selected:i&&c===u,"data-list-item":"".concat(o,"-").concat(t,"-").concat(u),...d,onClick:()=>{var f;ts(t0,JSON.stringify(d)),(f=e.onColorSelect)==null||f.call(e,{...d})}},u))})]})},WI=e=>{const{desc:t,isBgColor:n,selected:s,hideIcon:a,icon:o,colorkey:i,bgColor:l,hover:c=!0,disable:d=!1,...u}=e,f=!i&&n,h=y.useMemo(()=>f?r.jsx("span",{className:"w-full h-px bg-black_006 -rotate-45"}):a?null:n?s?r.jsx(V,{name:"IcCheck02",size:"middle",className:"text-white-base"}):null:o||r.jsx(V,{size:"normal",name:"IcText",style:{color:n||!i?void 0:tr(i)},className:R("text-[18px]",!i&&"text-black")}),[i,a,o,n,f,s]);return r.jsx(Fe,{offset:[0,5],popup:t,children:r.jsx("div",{className:R("h-10 w-10 flex items-center justify-center rounded",{"normal-bg":s},{"animate-hover ":c},{"cursor-pointer ":!d}),...u,children:r.jsx("div",{className:R("rounded-full flex items-center justify-center p-1 w-[30px] h-[30px]",n&&"p-0"),style:{background:l||(n?cs(i):void 0),boxShadow:"inset 0 0 0 1px var(--black_006)"},children:h})})})},uO=y.createContext(0),Fre=()=>y.useContext(uO),Vm=({onSelect:e,value:t,bgColorFn:n,selectedIcon:s,colors:a=vr,hideHeader:o,header:i="颜色",className:l})=>r.jsxs(r.Fragment,{children:[o?r.jsx("div",{className:"h-2"}):r.jsx("div",{className:"text-t2 text-grey3 pl-3.5 mt-2",children:i}),r.jsx("div",{className:R("grid gap-[3px] px-2 mt-1 grid-cols-5",l),children:a.map(c=>{const d=t===c.key,u=d?s||r.jsx(V,{size:"normal",name:"IcCheck02",className:R("text-[18px]",Mn({color:ow(c.key)}))}):void 0;return r.jsx(WI,{selected:d,icon:u,hideIcon:!d,isBgColor:!0,bgColor:n?n(c.key):void 0,colorkey:c.key,desc:c.name,onClick:()=>e(c.key)},c.key)})})]});function yc(e){const[t,n]=y.useState(!1),s=y.useRef(),{ref:a}=Xv({root:e==null?void 0:e.root,triggerOnce:!0,initialInView:e==null?void 0:e.initialInView,rootMargin:e==null?void 0:e.rootMargin,onChange:o=>{o&&n(o)}});return[t,o=>{a(o),s.current=o},s]}const wre=e=>{var h,p;const{emojiProps:t,emoji:n}=e,s=(h=e.color)!=null?h:"black",[a,o]=yc(),i=y.useMemo(()=>rm(s),[s]),l=YX(n.name,s);y.useEffect(()=>{QL("".concat(Lo,"emoji/byte-icon-sprite.js"),"script")},[]);const c=()=>{const{emoji:g,data:_}=t;if(_)return hu(g,void 0,void 0,_)},d=g=>{if(!t.onClick)return;const{onClick:_}=t,x=c();x&&(x.imgPath=l,x&&_(x,g))},u=g=>{if(!t.onOver)return;const{onOver:_}=t,x=c();x&&(x.imgPath=l,x&&_(x,g))},f=g=>{if(!t.onLeave)return;const{onLeave:_}=t,x=c();x&&(x.imgPath=l,x&&_(x,g))};return r.jsxs("div",{ref:o,className:"inline-flex items-center justify-center shrink-0 emoji-mart-emoji text-center","list-item-custom":"",style:{width:parseFloat("".concat(t.size))+12,height:parseFloat("".concat(t.size))+12},children:[!a&&r.jsx("div",{style:{width:t.size,height:t.size}}),a&&r.jsx(Fe,{popup:(p=n.keywords)==null?void 0:p[0],children:r.jsx("span",{"aria-label":n.name,onClick:d,onMouseEnter:u,onMouseLeave:f,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",style:{color:i,width:t.size,height:t.size},children:r.jsx("use",{xlinkHref:"#".concat(n.name)})})})})]})},lT=e=>{const t=Hl,n=ie(),[s,a]=y.useState(()=>localStorage.getItem("last-icon-color")||Ze.grey);return r.jsx(VI,{customColorKey:s,data:e.useCustomIcon?z5:void 0,perLine:12,showSkinTones:!1,showPreview:!1,theme:"light",set:t?"apple":"google",native:t,emojiTooltip:!0,onSelect:e.onSelect,fallback:(o,i)=>e.useCustomIcon?r.jsx(wre,{emoji:o,emojiProps:i,color:i.customColorKey}):null,searchBtn:e.useCustomIcon?r.jsx("div",{className:"flex items-center justify-center w-8 h-8 hover:bg-black_003 cursor-pointer shrink-0 mr-2.5 ml-1.5 rounded",onClick:o=>{n.dropdown({popcorn:o.currentTarget,placement:"right",content:({onCloseModal:i})=>{var l;return r.jsx("div",{className:"next-modal w-[250px] px-1 pt-1.5 pb-2.5",children:r.jsx(Vm,{colors:fO,hideHeader:!0,value:(l=localStorage.getItem("last-icon-color"))!=null?l:Ze.black,selectedIcon:r.jsx(V,{name:"IcCheck02",size:"normal",className:"text-[18px] text-white"}),onSelect:c=>{a(c),localStorage.setItem("last-icon-color",c),i()},bgColorFn:rm})})}})},children:r.jsx(Fe,{popup:"选择图标颜色",children:r.jsx("div",{className:"w-7 h-7 rounded-full border border-black/5 ",style:{backgroundColor:rm(s)}})})}):null,...e})},fO=vr.map(e=>({...e,name:""}));fO.unshift({key:Ze.black,name:""});const na=e=>{var p,g;const{iconSize:t,emojiStr:n,defaultIcon:s,disableHover:a,className:o,hasOverlay:i,inline:l,style:c,...d}=e,u=y.useMemo(()=>n?J5(n,Hl?"apple":"google",qw()):null,[n]),f=(_,x)=>_?r.jsx("span",{className:"emoji",style:{fontSize:"1em",lineHeight:"1em"},children:_&&_.length>0?_:x}):x;if(l)return u?r.jsx(Wf,{className:o,attribute:d,ignoreEmojiSet:!0,useSvg:!0,emoji:u,size:"1em",skin:(p=u.skin)!=null?p:1,native:Hl,set:Hl?"apple":"google",style:c}):r.jsx("span",{className:"emoji inline",...d,style:c,children:n});const h=Number.isNaN(t)?void 0:t;return r.jsxs("span",{...d,className:R("emoji-container relative whitespace-nowrap",e.disableHover?"pointer-events-none":"cursor-pointer animate-hover",o),style:{fontSize:h,minWidth:h},children:[u?r.jsx(Wf,{ignoreEmojiSet:!0,useSvg:!0,emoji:u,size:"1em",skin:(g=u.skin)!=null?g:1,native:Hl,set:Hl?"apple":"google"}):f(n,s),i&&r.jsx(V,{size:"normal",className:"absolute right-[-1px] bottom-[0]",name:"MIcBadgePagelink",style:{fontSize:"0.65em",color:"black"}})]})},cT=e=>{const t=Hl?"":"google",n=y.useRef(null);return r.jsx("div",{ref:n,className:"flex p-1 next-modal",style:e.style,children:r.jsx(Um,{listenPriority:dr+1,containerRef:n,itemCount:6,spanCount:6,type:"grid",children:s=>Array.from({length:6}).map((a,o)=>{const i=hu(e.emoji,o+1,t,qw());return r.jsx(na,{className:s===o?"emoji-mart-emoji-active":void 0,onClick:()=>e.onSelect(i),emojiStr:i.native,iconSize:e.emojiSize||24},o)})})})},wo="".concat(Lo,"fe-web-app-images"),Ere={...VL},MD={...Nk,activityDialogDiver:new URL("https://cdn2.flowus.cn/assets/diver-line-1b93be1e.svg",self.location).href,activityDialogDesc:new URL("https://cdn2.flowus.cn/assets/desc-cc979034.svg",self.location).href,activityDialogDescTeam:new URL("https://cdn2.flowus.cn/assets/desc-small-team-da14d8e0.svg",self.location).href,s102SettingHornIcon:new URL("https://cdn2.flowus.cn/assets/s102SettingHornIcon-c7792cce.png",self.location).href},vn={reload:e=>{e?Object.assign(vn,Ere):Object.assign(vn,MD)},...MD},Xo=()=>xt.$isDarkMode,Pa=()=>on(e=>e.$isDarkMode),Cre=()=>{const e=sQ(),t=Pa(),n=i9();y.useEffect(()=>{const s=pt(),a=JB();if(s&&ot.blog){ot.blog==="walles"?Bd.add():ot.blog==="buildin"&&Bd.remove();return}if(!a&&s){e&&!Xo()?Bd.add():Bd.remove();return}Xo()?(a===Ti.light&&Bd.remove(),a===Ti.system&&!e&&Bd.remove()):(a===Ti.dark&&Bd.add(),a===Ti.system&&e&&Bd.add())},[n,e]),y.useEffect(()=>{vn.reload(t)},[t]),y.useEffect(()=>{const s=()=>{const o=document.body.classList.contains("dark");st({$isDarkMode:o})},a=new MutationObserver(o=>{o.forEach(i=>{i.attributeName==="class"&&s()})});return s(),a.observe(document.body,{attributes:!0}),()=>a.disconnect()},[])},kre=()=>{y.useEffect(()=>{const e=t=>{if(Ie("mod+shift+l")(t)){t.preventDefault();const s=Xo()?Ti.light:Ti.dark;ts(nQ,s),st({$theme:s})}};return Ht.addEventListener("keydown",e),()=>{Ht.removeEventListener("keydown",e)}},[])},KI=e=>{const{loader:t,unloader:n,className:s,...a}=e,{imgUrl:o,onError:i,isProxyUrl:l,proxyLoading:c}=uJ(e),d=km(o)&&o!==_p(),u=c?"".concat(s," rounded brightness-50 animate__animated animate__infinite animate__flash animate__slower"):s,f=["ownerBlockId","onError","src"];(l.current||!d)&&f.push("sizes","srcSet");const h={...kn(a,f),className:u,referrerPolicy:d?"strict-origin-when-cross-origin":"no-referrer",crossOrigin:d?"anonymous":void 0,src:c?_p():o,onError:i};return ot.print?r.jsx("img",{"data-image":!0,...h}):t&&l.current&&!c?r.jsx(hb,{"data-image":!0,...h,loader:r.jsx(r.Fragment,{children:t}),unloader:r.jsx(r.Fragment,{children:n==null?void 0:n(e)}),loading:"lazy"}):r.jsx("img",{"data-image":!0,...h,loading:"lazy"})},dT=e=>{const{trigger:t,emojiSize:n,hasOverlay:s,className:a,onClick:o,src:i}=e;return r.jsxs("span",{className:R("items-center justify-center relative inline-flex align-sub flex-shrink-0",{"rounded animate-hover":t},a,s&&"p-0"),style:{fontSize:n},children:[r.jsx(KI,{onClick:o,className:R("object-cover object-center rounded-sm",{"cursor-pointer ":t}),style:{height:"1em",width:"1em"},src:i}),s&&r.jsx(V,{size:"normal",className:"absolute right-[-1px] bottom-[0]",name:"MIcBadgePagelink",style:{fontSize:"0.65em",color:"black"}})]})},Tre=50;function vre(e){return{itemsKeys:e.itemsKeys,items:new Map(e.items)}}class mO{constructor(t,n,s){q(this,"storage");q(this,"saveKey");q(this,"capacity");q(this,"lruInfo");q(this,"listeners");q(this,"isBatch",!1);q(this,"batch",t=>{this.isBatch=!0,t(),this.isBatch=!1;try{this.persistence()}catch(n){console.error(n)}});q(this,"addChangeListener",t=>{this.listeners.push(t)});q(this,"removeChangeListener",t=>{const n=this.listeners.indexOf(t);n!==-1&&UD(this.listeners,n)});q(this,"notifyChangeListener",()=>{this.listeners.forEach(t=>{t()})});this.storage=t,this.saveKey=n,this.capacity=s!=null?s:Tre,this.lruInfo={itemsKeys:[],items:new Map},this.listeners=[],es(0).then(async()=>{const a=await this.storage.getItem("LRU::".concat(this.saveKey));try{if(a){const o=JSON.parse(a),i=vre(o);i.items.size===i.itemsKeys.length&&(this.lruInfo=i),this.tryClearData()}this.clearOldData()}catch(o){}})}clearOldData(){this.storage.removeItem("".concat(this.saveKey,"_count")),this.storage.removeItem("".concat(this.saveKey,"_keys")),this.storage.removeItem("".concat(this.saveKey,"_map"))}put(t,n,s){this.lruInfo.items.set(t,{value:n,expireTime:s});const a=this.lruInfo.itemsKeys.indexOf(t);if(a>=0?VD(this.lruInfo.itemsKeys,a,0):this.lruInfo.itemsKeys.splice(0,0,t),this.tryClearData(),!this.isBatch){try{this.persistence()}catch(o){console.error(o)}this.notifyChangeListener()}}tryClearData(){for(;this.lruInfo.itemsKeys.length>this.capacity;){const t=[],n=Date.now();if(this.lruInfo.items.forEach((s,a)=>{s.expireTime&&s.expireTime<n&&t.push(a)}),t.forEach(s=>{this.delete(s)}),t.length===0){const s=this.lruInfo.itemsKeys.pop();s!==void 0&&this.lruInfo.items.delete(s)}}}clear(){this.lruInfo.itemsKeys=[],this.lruInfo.items.clear(),this.storage.removeItem("LRU::".concat(this.saveKey)),this.notifyChangeListener()}get(t){const n=this.lruInfo.itemsKeys.indexOf(t);if(n===-1)return null;const s=this.lruInfo.items.get(t);if(s&&s.expireTime&&s.expireTime<Date.now()){this.delete(t);return}return VD(this.lruInfo.itemsKeys,n,0),s==null?void 0:s.value}delete(t){const n=this.lruInfo.itemsKeys.indexOf(t);if(n===-1)return!1;UD(this.lruInfo.itemsKeys,n);const s=this.lruInfo.items.delete(t);return this.persistence(),this.notifyChangeListener(),s}log(){console.log(this.lruInfo)}persistence(){const n={items:Array.from(this.lruInfo.items.entries()),itemsKeys:this.lruInfo.itemsKeys};ts("LRU::".concat(this.saveKey),JSON.stringify(n),this.storage)}length(){return this.lruInfo.items.size}getSortItems(){const t=[],n=this.lruInfo.items;return this.lruInfo.itemsKeys.forEach(s=>{var o;const a=(o=n.get(s))==null?void 0:o.value;a!==void 0&&t.push({key:s,value:a})}),t}}const UD=(e,t)=>{e.splice(t,1)},VD=(e,t,n)=>{if(t===n)return;const s=e.splice(t,1);e.splice(n,0,s[0])},Ire="oss_images",Nre=10,jre=1e3*60,hO=jre*60,$D=hO*5;class Sre{constructor(t){q(this,"lruCache");q(this,"fetchers",{});q(this,"request");q(this,"taskParams",{});q(this,"timer");const{request:n}=t;this.lruCache=new mO(Fs,Ire,1e3),this.request=n}async fetchUrl(t,n,s,a,o){const{shareId:i,isShare:l}=o||{};if(!s)return"";const c=this.getCacheKey(t,s,a!=null?a:m3(s));this.tryClearCache(c);const d=this.lruCache.get(c);if(d)return d.url;const u=this.fetchers[c];if(u)return u.promise;this.taskParams[c]={blockId:n,ossName:s,download:a,shareId:i,isPublic:!!l};const f=new Wp;this.fetchers[c]=f;const h=async()=>{const p=Object.entries(this.taskParams),g=p.map(F=>F[0]),_=p.map(F=>F[1]);this.taskParams={};const x=await this.request.infra.createUrls.raw({batch:_});x.code===200?x.data.forEach((F,b)=>{var E,C;const w=g[b];if(w)try{if(!F)return;if(typeof F!="string"){const k=F,T=(k==null?void 0:k.compressedUrl)||k.url;T&&this.lruCache.put(w,{url:T,expireTime:Date.now()+$D})}else F.startsWith("http")&&this.lruCache.put(w,{url:F,expireTime:Date.now()+$D})}finally{F?typeof F!="string"&&((C=this.fetchers[w])==null||C.resolve(F.url)):(E=this.fetchers[w])==null||E.resolve(""),delete this.fetchers[w]}}):this.fetchers={}};return clearTimeout(this.timer),Object.keys(this.taskParams).length>=Nre?h():this.timer=setTimeout(()=>{h()},800),f.promise}putCache(t,n,s){const a=this.getCacheKey("image",t),o=Date.now()+30*60*1e3;this.lruCache.put(a,{url:n,expireTime:o});const i=this.getCacheKey("download",t);this.lruCache.put(i,{url:n,expireTime:o})}async fetchImageUrl(t){return this.fetchUrl("image",t.blockId,t.ossName,t.fileName,t.opt)}async fetchDownloadUrl(t){return this.fetchUrl("download",t.blockId,t.ossName,t.fileName,t.opt)}getCacheKey(t,n,s){return"".concat(t).concat(n).concat(s).replaceAll("/","_").replaceAll(".","_")}tryClearCache(t,n){const s=this.lruCache.get(t);s&&s.expireTime<=Date.now()&&(this.lruCache.delete(t),n==null||n(t)),s&&s.expireTime>Date.now()+hO*6&&(this.lruCache.delete(t),n==null||n(t))}}const Vs=new Sre({request:ve}),bc=(e,t)=>{var w,E;const n=ye(e,["data"],["segments","caption","ossName","localUrl"]),s=(n==null?void 0:n.type)===m.BlockType.PDF_ANNOTATION,a=(w=t==null?void 0:t.ossName)!=null?w:n==null?void 0:n.data.ossName,[o,i]=y.useState(!!a),[l,c]=y.useState(),[d,u]=y.useState(!1),f=a!=null?a:fe(n==null?void 0:n.data.segments),{extName:h}=rn(f),p=(t==null?void 0:t.isImage)||Jt.image.test(h),{shared:g,accessFee:_,password:x}=mt(e),F=!_&&g&&!x,b=y.useRef();return y.useEffect(()=>{c(void 0)},[a]),y.useEffect(()=>{if(l)return;const C=()=>{const k=J.blocks[e];if(!k){i(!1);return}if(k.type===m.BlockType.EXTERNAL_FILE){Ls.unstable_batchedUpdates(()=>{i(!1),k.data.link?c(Z1(k.data.link)):c(void 0)});return}if(s){i(!0);const v=fe(k==null?void 0:k.data.segments)||f;mo(async()=>{var j,S;if(!((j=k.data.pdfAnnotation)!=null&&j.ossName))return;const I=await Vs.fetchDownloadUrl({blockId:e,ossName:(S=k.data.pdfAnnotation)==null?void 0:S.ossName,fileName:v,opt:{isShare:F}});I&&c(I),u(!0),i(!1)},"oss");return}k!=null&&k.data.localUrl||i(!0),(async()=>{if(!a){i(!1);return}try{for(let v=0;v<2;v++){(!ot.print&&(k!=null&&k.data.localUrl)||v===1)&&await Ao(1e3);let I="";if(p)I=await Vs.fetchImageUrl({blockId:k.uuid,ossName:a,opt:{isShare:F}});else{const j=fe(k==null?void 0:k.data.segments)||f;I=await Vs.fetchDownloadUrl({blockId:k.uuid,ossName:a,fileName:j,opt:{isShare:F}})}if(I){Ls.unstable_batchedUpdates(()=>{c(I),u(!0)});break}}}finally{i(!1)}})()};C(),b.current&&clearInterval(b.current),b.current=setInterval(()=>{C()},50*60*1e3)},[s,p,F,f,a,g,l,e]),y.useEffect(()=>()=>{b.current&&clearInterval(b.current)},[]),{imageUrl:l?Jo(l,h):(E=n==null?void 0:n.data.localUrl)!=null?E:"",url:l||(n==null?void 0:n.data.localUrl)||"",loading:o,isOssNameUrl:d}},Dre=async e=>{const t=J.blocks[e];if(!t||!t.data.ossName)return;const n=fe(t==null?void 0:t.data.segments);return await Vs.fetchDownloadUrl({blockId:t.uuid,ossName:t.data.ossName,fileName:n,opt:{isShare:mn(e).shared}})},Are=e=>{const{imageUrl:t,loading:n}=bc(e.blockId,{disableLocalUrl:!0,isImage:!0,ossName:e.ossName}),{extName:s}=rn(e.ossName);let a="";return Im.test(s)&&(a=sm("",Math.floor(256*Math.ceil(window.devicePixelRatio)))),n?r.jsx($s,{className:e.className,size:"middle"}):r.jsx(dT,{...e,src:Jo("".concat(t).concat(a),s)})},pO=e=>{var t,n;e&&e.uuid&&((n=(t=e.data)==null?void 0:t.localUrl)!=null&&n.startsWith("blob"))&&(e.data.localUrl.startsWith("blob")&&URL.revokeObjectURL(e.data.localUrl),_e(e.uuid,{data:{localUrl:void 0}},!0))};let Ul={request:{infra:{},editor:{}},ossCallbackHost:"http://dev.allflow.cn",onError:()=>{}};const Rre=e=>{Ul=e};class gO{constructor(t){q(this,"pendingTask",[]);q(this,"runningTaskSize",0);q(this,"poolSize");this.poolSize=t}enqueueTask(t){const n=qe();return this.pendingTask.push({...t,taskId:n}),this.notifyTaskChange(),n}removeTask(t){const n=this.pendingTask.findIndex(s=>s.taskId===t);if(n!==-1)return this.pendingTask.splice(n,1),!0}notifyTaskChange(){if(this.pendingTask.length===0)return;const t=this.poolSize-this.runningTaskSize;for(let n=0;this.pendingTask.length>0&&n<t;n++){const s=this.pendingTask.shift();if(!s)return;this.runningTaskSize++,s.run().then(s.onSuccess).catch(s.onFailed).finally(()=>{this.runningTaskSize--,this.notifyTaskChange()})}}}var hs=(e=>(e[e.CODE_NOT_FOUND_TASK=1e3]="CODE_NOT_FOUND_TASK",e[e.UPLOAD_FAILED=1001]="UPLOAD_FAILED",e[e.GET_TOKEN_FAILED=1002]="GET_TOKEN_FAILED",e[e.UPLOAD_CANCEL=1003]="UPLOAD_CANCEL",e[e.UPLOAD_MAX_CAPACITY_LIMIT=1004]="UPLOAD_MAX_CAPACITY_LIMIT",e[e.UPLOAD_SINGLE_FILE_CAPACITY_LIMIT=1005]="UPLOAD_SINGLE_FILE_CAPACITY_LIMIT",e))(hs||{});const Pre=3;class Lre{constructor(){q(this,"taskPools",{});q(this,"uploadIdMappingTaskId",new Map);q(this,"uploadRequest",(t,n,s,a)=>new Promise(o=>{s.open("put",n),s.setRequestHeader("Content-type",a.file.type.trim()?a.file.type:"application/octet-stream"),s.upload.onprogress=i=>{var l;i.lengthComputable&&((l=a.onProgress)==null||l.call(a,Math.floor(i.loaded/i.total*100)))},s.onerror=()=>{o({success:!1,errCode:hs.UPLOAD_FAILED,errMsg:"上传失败"})},s.onabort=()=>{o({success:!1,errCode:hs.UPLOAD_FAILED,errMsg:"已取消"})},s.onload=()=>{s.status===200?o({success:!0,ossName:t}):o({success:!1,errCode:hs.UPLOAD_FAILED,errMsg:"上传失败"})},s.send(new Blob([a.file]))}).catch(o=>(console.log(o),{success:!1,errCode:hs.UPLOAD_FAILED,errMsg:"上传失败"})))}getTaskPool(t){let n=this.taskPools[t];return n||(n=new gO(Pre),this.taskPools[t]=n),n}upload(t){const n=this.getTaskPool(t.type),s=qe(),a=new XMLHttpRequest,o=n.enqueueTask({run:async()=>{var l,c,d,u;const i=await Ul.request.infra.getS3FileUploadInfo.raw({spaceId:t.spaceId,type:t.type,mimeType:t.file.type.trim()?t.file.type:"application/octet-stream",fileName:t.file.name,size:t.file.size,recentlyImgType:(l=t.searchType)!=null?l:void 0});if(i.code===200)return(c=t.onCapacitySuccess)==null||c.call(t),this.uploadIdMappingTaskId.delete(s),this.uploadRequest(i.data.s3Key,i.data.uploadUrl,a,t);if(i.code===2103){(d=t.onComplete)==null||d.call(t,{success:!1,errCode:hs.UPLOAD_MAX_CAPACITY_LIMIT,errMsg:i.msg});return}if(i.code===2104){(u=t.onComplete)==null||u.call(t,{success:!1,errCode:hs.UPLOAD_SINGLE_FILE_CAPACITY_LIMIT,errMsg:i.msg});return}if(i!==200)throw Error(i.msg)},onFailed:i=>{var l;console.warn(i),(l=t.onComplete)==null||l.call(t,{success:!1,errCode:hs.UPLOAD_FAILED,errMsg:"上传失败[".concat(i.message,"]")})},onSuccess:i=>{var l;i&&((l=t.onComplete)==null||l.call(t,i))}});return this.uploadIdMappingTaskId.set(s,{taskId:o,params:t,xhr:a}),s}uploadWithoutLogin(t){const n=this.getTaskPool(t.type),s=qe(),a=new XMLHttpRequest,o=n.enqueueTask({run:async()=>{var l,c,d;const i=await Ul.request.infra.getS3UnsignedInfo.raw({spaceId:t.spaceId,viewId:t.viewId,fileName:t.file.name,fileType:t.type,size:t.file.size,mimeType:t.file.type.trim()?t.file.type:"application/octet-stream"});if(i.code===200){if(i.data.currentCapacity+t.file.size>i.data.maxCapacity){(l=t.onComplete)==null||l.call(t,{success:!1,errCode:hs.UPLOAD_MAX_CAPACITY_LIMIT,errMsg:i.msg||"空间容量超限，请联系对方升级空间"});return}if(t.file.size>t.singleFileMaxCapacity){(c=t.onComplete)==null||c.call(t,{success:!1,errCode:hs.UPLOAD_SINGLE_FILE_CAPACITY_LIMIT,errMsg:i.msg||"文件大小超限，请联系对方升级空间"});return}}if(i.code===200)return(d=t.onCapacitySuccess)==null||d.call(t),this.uploadRequest(i.data.s3Key,i.data.uploadUrl,a,t);if(i!==200)throw Error(i.msg)},onFailed:i=>{var l;(l=t.onComplete)==null||l.call(t,{success:!1,errCode:hs.UPLOAD_FAILED,errMsg:"上传失败[".concat(JSON.stringify(i),"]")})},onSuccess:i=>{var l;i&&((l=t.onComplete)==null||l.call(t,i))}});return this.uploadIdMappingTaskId.set(s,{taskId:o,params:t,xhr:a}),s}abort(t){const n=this.uploadIdMappingTaskId.get(t);n==null||n.xhr.abort(),n&&this.getTaskPool(n.params.type).removeTask(n.taskId)&&n.params.onComplete({success:!1,errCode:hs.UPLOAD_CANCEL,errMsg:"已取消"})}}const Bre=[new RegExp("<script.*?>.*?<\\/script>","is"),/javascript:/i,/onload=["'].*?["']/i,/onerror=["'].*?["']/i];function Ore(e){return Bre.some(t=>t.test(e))}async function Mre(e){return new Promise(t=>{try{if(e.size>=1*N_){t({error:!1,msg:"done"});return}const n=new FileReader;n.onload=async()=>{const s=n.result,a=await hW(s);if(a&&a.mime.includes("xml")||/svg|png|jpg|jpeg|webp|xml/.test((s==null?void 0:s.toString())||"")){const o=new TextDecoder().decode(s);Ore(o)&&t({error:!0,msg:"Danger: File ".concat(e.name," contains potential XSS attack scripts.")}),t({error:!1,msg:"File ".concat(e.name," does not contain XSS attack scripts.")})}t({error:!1,msg:"File ".concat(e.name," is not an SVG file and does not contain XSS attack scripts.")})},n.readAsArrayBuffer(e)}catch(n){t({error:!1,msg:"An error occurred while checking the file: ".concat(n==null?void 0:n.message)})}})}function Ure(){return-new Date().getTimezoneOffset()/60===8}const HD="flowus-1316188996",zD=Ure()?"ap-beijing":"accelerate",Vre=3,qD="bucket=${bucket}&object=${object}&etag=${etag}&size=${size}&mimeType=${mimeType}";class $re{constructor(){q(this,"taskPools",{});q(this,"uploadIdMappingTaskId",new Map);q(this,"uploadIdMappingCos",new Map);q(this,"generateSavePath",(t,n)=>{const s="".concat(qe(),"/").concat(n);return"".concat(t).concat(s)})}getTaskPool(t){return this.taskPools[t]||(this.taskPools[t]=new gO(Vre)),this.taskPools[t]}async checkFile(t){var s;const n=await Mre(t.file);return n.error&&((s=t.onComplete)==null||s.call(t,{success:!1,errCode:hs.UPLOAD_FAILED,errMsg:n.msg})),n.error}async originSHA256(t){const n=await t.arrayBuffer(),s=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(s)).map(i=>i.toString(16).padStart(2,"0")).join("")}async streamSHA256(t){const n=t.stream().getReader(),s=I_.algo.SHA256.create();for(;;){const{done:i,value:l}=await n.read();if(i)break;const c=I_.lib.WordArray.create(l);s.update(c)}return s.finalize().toString(I_.enc.Hex)}async calculateSHA256(t){try{return await this.originSHA256(t)}catch(n){return this.streamSHA256(t)}}upload(t){const n=this.getTaskPool(t.type),s=qe(),a=n.enqueueTask({run:async()=>{var u,f,h,p;if(await this.checkFile(t))return;let o=!1;const i=setTimeout(()=>{var g;o=!0,(g=t.onComplete)==null||g.call(t,{success:!1,errCode:hs.GET_TOKEN_FAILED,errMsg:"您的设备网络超时，请刷新后重试"})},5e3),l=["\n","&"];let c=t.file.name;l.forEach(g=>{c=c.replaceAll(g,"")});const d=await Ul.request.infra.getTcFileUploadInfo.raw({fileName:c,spaceId:t.spaceId,type:t.type,size:t.file.size,dataBaseSingleFileMaxSize:t==null?void 0:t.isDatabase});if(clearTimeout(i),!o){if(d.code===200){const g=await this.calculateSHA256(t.file),_=await Ul.request.infra.searchResource({sha256:g,size:t.file.size});if(_.ossName)return{success:!0,ossName:_.ossName};(u=t.onCapacitySuccess)==null||u.call(t);const x=d.data;let F="sha256=".concat(g,"&fileName=").concat(c,"&spaceId=").concat(t.spaceId,"&userId=").concat(t.userId,"&type=").concat(t.type,"&fileSecret=").concat(x.fileSecret);t.searchType&&(F="".concat(F,"&recentlyImgType=").concat(t.searchType)),this.uploadIdMappingTaskId.delete(s);const b=new jx({SecretId:x.token.accessKeyId,SecretKey:x.token.accessKeySecret,SecurityToken:x.token.securityToken});Ul.ossCallbackHost.includes("localhost")&&console.log("ossCallbackHost传错了，请检查环境变量是否配错了");const w={callbackUrl:"".concat(Ul.ossCallbackHost,"/api/upload/v3/callback"),callbackBody:"".concat(F.toString(),"&").concat(qD),callbackBodyType:"application/x-www-form-urlencoded"};try{const E=await b.uploadFile({Bucket:HD,Region:zD,SliceSize:5242880,Key:x.ossName,Body:t.file,Headers:{"x-cos-callback":jx.util.encodeBase64(JSON.stringify(w))},onProgress:C=>{var k;(k=t.onProgress)==null||k.call(t,C.percent*100)},onTaskReady:C=>{this.uploadIdMappingCos.set(s,{cos:b,taskId:C})}});return E.statusCode===200?{success:!0,ossName:x.ossName,url:(f=E==null?void 0:E.CallbackBody)==null?void 0:f.url}:{success:!1,errCode:hs.UPLOAD_FAILED,errMsg:"上传失败[".concat(E.statusCode,"]")}}finally{this.uploadIdMappingCos.delete(s)}}if(d.code===2103){(h=t.onComplete)==null||h.call(t,{success:!1,errCode:hs.UPLOAD_MAX_CAPACITY_LIMIT,errMsg:d.msg});return}if(d.code===2104){(p=t.onComplete)==null||p.call(t,{success:!1,errCode:hs.UPLOAD_SINGLE_FILE_CAPACITY_LIMIT,errMsg:d.msg});return}if(d!==200)throw Error(d.msg)}},onFailed:o=>{var i,l;o.name==="cancel"?(i=t.onComplete)==null||i.call(t,{success:!1,errCode:hs.UPLOAD_CANCEL,errMsg:"上传取消"}):(console.warn(o),(l=t.onComplete)==null||l.call(t,{success:!1,errCode:hs.UPLOAD_FAILED,errMsg:"上传失败[".concat(o.message,"]")}))},onSuccess:o=>{var i;o&&((i=t.onComplete)==null||i.call(t,o))}});return this.uploadIdMappingTaskId.set(s,{taskId:a,params:t}),s}uploadWithoutLogin(t){const n=this.getTaskPool(t.type),s=qe();return n==null||n.enqueueTask({run:async()=>{var c,d,u,f,h;if(await this.checkFile(t))return;const a=await Ul.request.infra.getTcUnsignedInfo.raw({spaceId:t.spaceId,viewId:t.viewId,dataBaseSingleFileMaxSize:!0});if(t.file.size>t.singleFileMaxCapacity){(c=t.onComplete)==null||c.call(t,{success:!1,errCode:hs.UPLOAD_SINGLE_FILE_CAPACITY_LIMIT,errMsg:"单文件大小超出限制"});return}if(a.code!==200){(d=t.onComplete)==null||d.call(t,{success:!1,errCode:hs.UPLOAD_MAX_CAPACITY_LIMIT,errMsg:a.msg});return}if(a.data.currentCapacity+t.file.size>a.data.maxCapacity){(u=t.onComplete)==null||u.call(t,{success:!1,errCode:hs.UPLOAD_MAX_CAPACITY_LIMIT,errMsg:"对方空间容量超限，请联系管理员升级空间"});return}const o=await this.calculateSHA256(t.file),i=await Ul.request.infra.searchResource({sha256:o,size:t.file.size});if(i.ossName)return{success:!0,ossName:i.ossName};const l=t.file.name.replaceAll("\n","");if(a.code===200){(f=t.onCapacitySuccess)==null||f.call(t);const p=this.generateSavePath(a.data.token.prefix,l),g=a.data,_="sha256=".concat(o,"&saveName=").concat(p,"&fileName=").concat(l,"&spaceId=").concat(t.spaceId,"&type=").concat(t.type);this.uploadIdMappingTaskId.delete(s);const x=new jx({SecretId:g.token.accessKeyId,SecretKey:g.token.accessKeySecret,SecurityToken:g.token.securityToken}),F={callbackUrl:"".concat(Ul.ossCallbackHost,"/api/upload/v2/callback"),callbackBody:"".concat(_.toString(),"&").concat(qD)},w=await x.uploadFile({Bucket:HD,Region:zD,Headers:{"x-cos-callback":jx.util.encodeBase64(JSON.stringify(F))},Key:p,Body:t.file,onProgress:E=>{var C;(C=t.onProgress)==null||C.call(t,E.percent*100)},onTaskReady:()=>{}});return w.statusCode===200?{success:!0,ossName:p,url:(h=w==null?void 0:w.CallbackBody)==null?void 0:h.url}:{success:!1,errCode:hs.UPLOAD_FAILED,errMsg:"上传失败[".concat(w.statusCode,"]")}}if(a!==200)throw Error(a.msg)},onFailed:a=>{var o,i;a.name==="cancel"?(o=t.onComplete)==null||o.call(t,{success:!1,errCode:hs.UPLOAD_CANCEL,errMsg:"上传取消"}):(i=t.onComplete)==null||i.call(t,{success:!1,errCode:hs.UPLOAD_FAILED,errMsg:"上传失败[".concat(JSON.stringify(a),"]")})},onSuccess:a=>{var o;a&&((o=t.onComplete)==null||o.call(t,a))}}),s}abort(t){const n=this.uploadIdMappingTaskId.get(t);if(n)this.getTaskPool(n.params.type).removeTask(n.taskId)&&n.params.onComplete({success:!1,errCode:hs.UPLOAD_CANCEL,errMsg:"已取消"});else{const s=this.uploadIdMappingCos.get(t);if(s){this.uploadIdMappingCos.delete(t);const{taskId:a,cos:o}=s;o.cancelTask(a)}}}}const Hre=()=>{var e,t;try{return!1}catch(n){return((t=(e=import.meta)==null?void 0:e.env)==null?void 0:t.VITE_PRODUCT)==="buildin"}},N0=Hre()?new Lre:new $re,zre=(e,t)=>{var o,i;if(!e[0])return null;const n={name:"",files:[],folders:[]};let s="";const a=new Set;for(const l of e){if(!t&&l.name.startsWith(".")||(l.webkitRelativePath&&(l.fullPath=(o=l.webkitRelativePath)!=null?o:""),l.fullPath||(l.fullPath=gs.check?"":(i=l.path)!=null?i:""),l.fullPath===void 0))continue;const c=l.fullPath.indexOf("/"),d=l.fullPath.lastIndexOf("/");if(c>=0?(s=l.fullPath.slice(0,c),a.add(s)):a.add(0),c===d)n.files.push(l);else{const u=l.fullPath.slice(0,d),f=qre(u);f.shift();let h=n;for(const p of f){const g=h.folders.find(_=>_.name===p);if(g)h=g;else{const _={name:p,files:[],folders:[]};h.folders.push(_),h=_}}h.files.push(l)}}return a.size===1&&(n.name=s),n},qre=e=>e.split("/"),YI=new Map,Gre=(e,t)=>{YI.set(e,t)},ZAe=e=>{if(!e)return;const t=YI.get(e);if(t){if(t.expireTime>Date.now())return t.url;Wre(e)}},Wre=e=>{YI.delete(e)},XI=new Map,Kre=(e,t)=>{XI.set(e,t)},Yre=e=>{XI.delete(e)},eRe=e=>{if(e)return XI.get(e)};var Je=(e=>(e.GUIDE_FIRST_TIME_CREATED_SPACE="a648640a-a3d9-4335-86d6-eaa03d79b859",e.GUIDE_FIRST_TIME_CREATED_PAGE="d453314a-36f6-1603-8116-28ca9efdd08d",e.GUIDE_FIRST_TIME_CREATED_COLLECTION="9f888320-ae4c-f2b0-a0dd-028153e0e4b3",e.GUIDE_FIRST_TIME_CREATED_FOLDER="746d9e52-3fa2-7676-91a8-f7e457dd9bfb",e.GUIDE_FIRST_TIME_CREATED_TABLE="946607c0-beac-041f-fd76-45c5ef2591eb",e.GUIDE_FIRST_TIME_UPLOAD="99e2b29e-0429-fe53-0b38-776dd4b6c867",e.GUIDE_FIRST_TIME_UPLOAD_COVER="bd44fb8f-646d-4187-40f1-c8daa9ccb1ad",e.GUIDE_FIRST_TIME_CREATED_COLUMN_LIST="55db4312-3dfd-79fd-0e7c-e7ef4c977648",e.GUIDE_FIRST_TIME_APP_DRAG="b640bd28-e14c-4f50-7e52-b2d3b2c58653",e.GUIDE_FIRST_TIME_COPY_TEMPLATE="193a8c4b-cec3-74de-16b0-2e35556be323",e.GUIDE_FIRST_TIME_SHORTCUT_CREATED="8f8ddded-5d80-0c15-b5b5-9952c3b922a8",e.GUIDE_FIRST_TIME_LINK_PAGE="596f293a-5f5d-0536-9c07-aa7b1e5b970d",e.GUIDE_FIRST_TIME_BOARD_VIEW="2cd872ab-3a29-6d2d-7b42-ed2f1d81d82a",e.GUIDE_FIRST_TIME_TIMELINE_VIEW="4e8e03f5-d2a6-4c12-b05b-321c1a57e72d",e.GUIDE_FIRST_TIME_CALENDAR_VIEW="3bad6862-9134-47e4-8b3a-9dd2dc093274",e.GUIDE_FIRST_TIME_COLLECTION_VIEW="deb678d3-6742-cdfc-1e61-adc1f153600e",e.GUIDE_FIRST_TIME_CREATED_SYNC="d2661165-b02a-f819-bff6-c6619db0e33a",e.GUIDE_FIRST_TIME_CREATED_TEMPLATE="8c148290-db9a-e791-0430-3cd3e776fa8a",e.GUIDE_FIRST_TIME_SHARE="1d767026-0143-98fb-8e54-ed607f91d7a1",e.GUIDE_FIRST_TIME_APP_PIC_SHARE="18d24e67-b984-2b59-4e1b-9ee5d24839e3",e.LIMITED_TIME_COLLECTION_TABLE="7869de9c-2f3b-402c-3568-7ab59edbffca",e.LIMITED_TIME_SHARE_COPY="d6b61f9c-4d11-b62a-fff1-7e742c28c5fd",e.STANDING_IMPORT="6a7a0241-65f5-41f5-b7f2-cafc3cb8409e",e.NEW_USER_START="b7c9dd44-0881-41ec-a759-7094ff22b2c8",e.START_FROM_HERE="cd87ff03-0ee4-4f7a-8e91-45ccb8290202",e.EXPLORE_MORE_FEATURE="38c7a0bb-d4c8-43b7-bbd5-bc83f1f96ec8",e.USE_FLOWUS_EVERYWHERE="2414889b-2926-407a-9f05-04c0b8f9fb67",e.CREATE_PAGE="f799091c-afcf-47ab-a7b6-e2d5bb990dcc",e.CREATE_AND_DRAG_BLOC="0c9f0d66-eee8-472d-a681-84248923ea60",e.WRITE_AND_EDIT="3115bbf6-e96f-41b4-93b0-a859738346ef",e.CREATE_FILE_BLOCK="8f56d945-2a36-42df-8348-9deca0381124",e.CREATE_FOLDER_BLOCK="37a1ee22-aebc-4d2d-9089-ea3ffe2fae09",e.CREATE_BITABLE_BLOCK="f18babc4-a068-41be-a10f-c17a6982a605",e.CREATE_BITABLE_VIEW="be2e0d41-ac83-47a5-9884-197d88d8ec1d",e.CREATE_SYNC_BLOCK="2ed6a364-8c33-4a6d-bd94-385029ee562a",e.COOPERATION_AND_SHARE="3556aa6b-f53a-4ac3-9338-b74cffe8bb2f",e.EXPORT_PAGE="fba1d4b7-e7d6-41a6-89a5-f45ab9af6c90",e.LEARN_WORKSPACE="b06459f2-938b-4042-b992-05a8c2c548e7",e.WRITE_BLOG="6bf4d8f3-7213-4d87-bdd3-5da503caa38b",e.PLAN="ea5b4fcd-2ef9-4e85-a908-a2178910812d",e.WIKI="d76cde1a-735f-4555-a859-9fee6befef23",e.CREATE_SITE="a9958a95-afc6-4c35-9e85-c61b3fde6935",e.LOGIN_IN_MAC_OR_WINDOWS="f1b4c928-e762-469c-9e90-8ffcf723a120",e.LOGIN_IN_ANDROID_OR_IOS="b7c58a5f-b2ab-4379-8171-979e979a50e5",e.LOGIN_IN_FLOWUS="7c01f540-49ce-40bd-bdc4-6f02a5a6ed5f",e.USE_WECHAT_CLIP="be5f2ab7-6ab2-4c41-a7ac-04dbb028e1b1",e.CREATE_NEW_PAGE="97bef546-5ea4-45c1-a0ea-f1b095dfbfea",e.CONVERT_TEXT_BLOCK="67d716a5-4197-4410-903c-8eaeff17518c",e.CREATE_TODO_BLOCK="f65334a1-152e-4f94-bf97-91f0d3774007",e.CREATE_HEADER_BLOCK="a2307b14-b4b0-48eb-b052-35c3c257ba89",e.CREATE_QUOTE_BLOCK="646cd033-46eb-4cba-9078-253528040465",e.CREATE_MARK_BLOCK="17ade11e-3e17-4cce-ba68-255178caeadb",e.CREATE_IMAGE_BLOCK="c8b745a7-f48f-46a9-8e98-e5e1229f303b",e.CREATE_SIMPLE_TABLE="61956fe0-7c03-41c8-be9c-636ebcb46a23",e.CREATE_BITABLE_EXPLORE="3d65d673-c124-4d01-8ca8-20c4d9f0a862",e.CREATE_DATE_MENTION="861dccfa-7154-4b02-b368-b2ca3cc6e72c",e.MOBILE_SORT_BLOCK="2ff9c2aa-cdbe-46a5-998d-b2c3d728be44",e.CREATE_COLUMNS_BLOCK="0968ccb9-e1a2-4a58-a96c-baf1f5b1c523",e.CREATE_FOLDER_AND_UPLOAD="a1de73e3-56ab-4f16-a07a-4733e23dff38",e.COPY_PAGE_FROM_TEMPLATE="7f32f8fb-8b3c-4b02-b58f-6cdad6466200",e.CREATE_WEB_BOOKMARK="09428d57-ef33-4381-80da-a619a4d3c943",e.CREATE_LINK="1640a973-431d-4907-9fef-60e71570c695",e.CREATE_REF_PAGE="711ed60d-f524-4c57-a318-a4860acb5e42",e.CREATE_MIND_MAP="bc9fe5b5-d903-4d17-89b1-ec343fcc0945",e.CREATE_GALLERY_VIEW="4567bedd-c092-4d37-9db2-6d81dd4a82d7",e.CREATE_TIMELINE_VIEW="9c7fbb62-878e-4573-a320-91e5a0388925",e.CREATE_CALENDAR_VIEW="a02a9b57-4745-41e0-b3e7-7f4b214bd194",e.CREATE_FORM_VIEW="4ac0096b-e2d5-47cd-a0b0-d255985fd32b",e.ADD_TO_FAVORITE="e0ee5c10-0fd5-4c86-b2e2-d514b755eae9",e.CREATE_SYNC_BLOCK_NEW="bb67a765-a7f0-442f-9263-377eea2c8082",e.CREATE_TEMPLATE_BUTTON="f1a64622-9365-4700-98e2-84ec192d9210",e.OPEN_SHARE="aa1c3568-5018-41be-be93-d655747e79c9",e.CONVERT_TO_TEMPLATE="7c82410b-8f63-4d0b-a9f0-7be9ed6030bc",e.MOBILE_SHARE_LONG_PAGE_IMAGE="dae39919-242f-44e0-ac97-cff567711c4c",e.INVITE_REGISTER="d8c323b3-b5b7-4ec4-a219-218f6b80fe08",e))(Je||{});const Xre=new Set(["a2307b14-b4b0-48eb-b052-35c3c257ba89","c8b745a7-f48f-46a9-8e98-e5e1229f303b","a1de73e3-56ab-4f16-a07a-4733e23dff38","4567bedd-c092-4d37-9db2-6d81dd4a82d7","bb67a765-a7f0-442f-9263-377eea2c8082","861dccfa-7154-4b02-b368-b2ca3cc6e72c"]),GD=new Set(["a2307b14-b4b0-48eb-b052-35c3c257ba89","c8b745a7-f48f-46a9-8e98-e5e1229f303b","3d65d673-c124-4d01-8ca8-20c4d9f0a862","4567bedd-c092-4d37-9db2-6d81dd4a82d7","9c7fbb62-878e-4573-a320-91e5a0388925","a02a9b57-4745-41e0-b3e7-7f4b214bd194","4ac0096b-e2d5-47cd-a0b0-d255985fd32b","bb67a765-a7f0-442f-9263-377eea2c8082","f1a64622-9365-4700-98e2-84ec192d9210"]),WD={"a2307b14-b4b0-48eb-b052-35c3c257ba89":"标题","c8b745a7-f48f-46a9-8e98-e5e1229f303b":"图片","3d65d673-c124-4d01-8ca8-20c4d9f0a862":"多维表","4567bedd-c092-4d37-9db2-6d81dd4a82d7":"画廊视图","9c7fbb62-878e-4573-a320-91e5a0388925":"时间轴视图","a02a9b57-4745-41e0-b3e7-7f4b214bd194":"日历视图","4ac0096b-e2d5-47cd-a0b0-d255985fd32b":"表单视图","bb67a765-a7f0-442f-9263-377eea2c8082":"同步块","f1a64622-9365-4700-98e2-84ec192d9210":"模板按钮"},ut=(e,t,n=!1,s=!0)=>{var l,c,d,u,f,h,p,g,_,x,F,b,w,E,C,k,T,v,I,j;const a=(l=e.uuid)!=null?l:qe(),o=J.blocks[t.parentId];if(!o&&!t.spaceId)throw new Error("parent not found");Ju(t.spaceId||(o==null?void 0:o.spaceId));const i={uuid:a,spaceId:(d=(c=t.spaceId)!=null?c:o==null?void 0:o.spaceId)!=null?d:"",parentId:(f=(u=o==null?void 0:o.uuid)!=null?u:t.spaceId)!=null?f:"",type:m.BlockType.TEXTAREA,textColor:"",backgroundColor:"",status:m.BlockStatus.NORMAL,version:0,subNodes:[],permissions:[],...e,createdAt:Date.now(),createdBy:yt.uuid,...fu(),data:{...(h=e.data)!=null?h:{},pageFixedWidth:(g=(p=e.data)==null?void 0:p.pageFixedWidth)!=null?g:FI(),directoryMenu:(_=yt.setting)==null?void 0:_.directoryMenu,format:{...(x=e.data)==null?void 0:x.format,pageLayout:(E=(b=(F=e.data)==null?void 0:F.format)==null?void 0:b.pageLayout)!=null?E:(w=Iu())==null?void 0:w.setting.pageLayout,fontFormat:(v=(k=(C=e.data)==null?void 0:C.format)==null?void 0:k.fontFormat)!=null?v:(T=Iu())==null?void 0:T.setting.fontFormat,commentAlignment:(I=Pn().setting)==null?void 0:I.commentAlignment}}};if(!i.spaceId)throw new Error("not spaceId");if(!i.parentId)throw new Error("not parentId");if(re($a({block:i,ignoreOp:n,local:s})),t.inline)return a;if(t.templatePages){const S=(j=J.blocks[t.parentId])==null?void 0:j.templatePages,D=[...S!=null?S:[],a];re(Sn({uuid:t.parentId,patch:{templatePages:D}}))}else t.first||t.before?re(cl({uuid:a,parentId:t.parentId,before:t.before,ignoreOp:n})):re(ws({uuid:a,parentId:t.parentId,after:t.after,ignoreOp:n}));return a},_O=Aa(()=>({})),Qre=Qs(_O),QI=()=>y.useCallback(async e=>{const t=_O.getState();if(t[e])return t[e];const s=(await ve.infra.getSpacesPublicData({spaceIds:[e]})).spaces[e];return s&&Qre(Yn(a=>os(a,{[e]:s}))),s},[]);var ct=(e=>(e.activityList="activityList",e.advancedList="advancedList",e.basicList="basicList",e))(ct||{});const Jre=e=>n0(t=>t.basicList.concat(t.advancedList).concat(t.activityList).find(n=>n.uuid===e)),j0=e=>{const t=S_();return t.basicList.concat(t.advancedList).concat(t.activityList).find(n=>n.uuid===e)},Zre=()=>n0(eae),eae=e=>{const{basicList:t,advancedList:n}=e,s=t.filter(l=>l.status==="completed"),a=n.filter(l=>l.status==="completed"),o=s.length+a.length,i=t.length+n.length;return{basicList:t,advancedList:n,completedTaskLength:o,allTaskLength:i,progress:o/i}},S0=()=>{let e=document.getElementById("ActivityModalAnchor");return e||(e=document.createElement("div"),e.id="ActivityModalAnchor",e.setAttribute("style","position:fixed; bottom:40px; right:20px; z-index:-1; height:50px; width:50px;"),document.body.appendChild(e)),{popcorn:e,reCreate:()=>{try{document.body.appendChild(e)}catch(t){}},remove:()=>{try{document.body.removeChild(e)}catch(t){}}}},{VITE_PRODUCT_AI_NAME:tae,VITE_PRODUCT_NAME:nae,VITE_PRODUCT_ALL_NAME:sae}={VITE_DOCUMENT_TITLE:"FlowUs 息流｜一站式知识创作与发布平台",VITE_OSS_CDN_HOST:"https://cdn2.flowus.cn/",VITE_ENV:"production",VITE_VOLCENGINE_TRACK_ID:"303823",VITE_URL_SPLIT_TEXT:"【FlowUs 息流】",VITE_WECHAT_ACCOUNT:"wx1736ff051cca370b",VITE_NOTION_CLIENT_ID:"f843d557-50d6-4110-b05c-6e60029bd338",VITE_PRODUCT_ALL_NAME:"FlowUs 息流",VITE_TEMPLATE_ID:"6a4efea1-e023-4e99-bb69-d69af5909412",VITE_OSS_UPLOAD_URL:"https://oss.flowus.com.cn",VITE_PREFIX:"https://flowus.cn",VITE_WECHAT_APP_ID:"wx7de87594073bf09f",VITE_GIT_COMMIT:"582aec734b7f0b024b82d1a8b60184f8ae9ec2c7",VITE_IMPORTANT_FEATURE_COLLECTION_ID:"6fcef75c-2637-42e8-86d7-2d59bdef4807",VITE_PRODUCT_AI_NAME:"FlowUs AI",VITE_SUBSCRIBE_ID:"6301204f-7892-47c8-9a6a-d34f5c6a8855",VITE_DESCRIPTION:"使用 Flowus 构建您的知识平台，助您轻松创作与发布",VITE_WPS_KEY:"SX20231127MUOIEW",VITE_BUCKET:"flowus-1316188996",VITE_CDN_HOST:"https://cdn2.flowus.cn/",VITE_AD_COLLECTION_ID:"d103bcd6-5712-4aa4-8c03-385add1f2391",VITE_PRODUCT_NAME:"FlowUs",VITE_SERVICE_CENTER_COLLECTION_ID:"14620f35-b0be-4d28-8a10-f3ae4809af43|e077dd8f-a2d7-46e6-a97e-3167cf8665e0",BASE_URL:"https://cdn2.flowus.cn/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,LEGACY:!1},pm=tae,B_="AI 包月权益",Na=nae,JI=sae;var Mt=(e=>(e.pay="pay",e.group="group",e.package="package",e.file="file",e.pageHistory="page_history",e.extMember="ext_member",e.spaceSetFile="spaceset_file",e.spaceSetBlock="spaceset_block",e.cataFile="cata_file",e.cataBlock="cata_block",e.temp_max="temp_max",e.homepage="homepage",e.order="order",e.members="members",e.bulk_download="bulk_download",e.link_suggest="link_suggest",e.mind_node_limit="mindmap_number",e.anniversary="anniversary",e.importMember="import_member",e.custom_font_layout="font_layout",e.message_board="message_board",e.dashboard_plan="dashboard_plan",e.dashboard_file="dashboard_file",e.dashboard_member="dashboard_member",e.notification_inbox="notification_inbox",e.activity="activity",e.export_watermark="export_watermark",e.capacity_header="capacity_header",e.inbox="inbox",e.new_user_task="new_user_task",e.notification_normal="notification_normal",e.tip="tip",e.page_card="page_card",e.share_seo="share_seo",e.view_epub="epub",e.kol_sales="KOLsales",e.ai="ai",e.wps="wps",e.dashboard_ai="dashboard_ai",e.ai_max="ai_max",e.link_valid="link_valid",e.space_security="space_security",e.guest_max="guest_max",e.dialog_subscribe_ai="dialog_subscribe_ai",e.dialog_space_ai="dialog_space_ai",e.dialog_ai_rights="dialog_ai_rights",e.dialog_capacity_package="dialog_capacity_package",e.dialog_capacity_limit="dialog_capacity_limit",e.dialog_copy_limit="dialog_copy_limit",e.switch_space="switch_space",e.h5="h5",e))(Mt||{}),Kt=(e=>(e[e.account=0]="account",e[e.integral=1]="integral",e[e.space=2]="space",e[e.spaceInfo=3]="spaceInfo",e[e.members=4]="members",e[e.upgrade=5]="upgrade",e[e.line=6]="line",e[e.order=7]="order",e[e.general=8]="general",e[e.notificationsAndSetting=9]="notificationsAndSetting",e[e.sharePage=10]="sharePage",e[e.profit=11]="profit",e))(Kt||{});const rae={$settingState:{open:!1}},ZI=qp(()=>rae);Fd(ZI);const aae=Qs(ZI),eN=(e,t)=>{aae(Yn(n=>{n[e]=t}))},oae=()=>ZI(t=>t.$settingState),iae=()=>m0(Ve.AI_EDITOR),xO=e=>{eN("$settingState",{open:!0,...e})},_o=()=>xO,ya=()=>{const e=_o();return y.useCallback(t=>{e({defaultMenuType:Kt.upgrade,from:t})},[e])},Za=()=>y.useCallback(()=>{eN("$settingState",{open:!1})},[]);var yO=(e=>(e.FINISH_BASIC_TASK="FINISH_BASIC_TASK",e.NOTIFICATION="NOTIFICATION",e))(yO||{});const lae=({type:e,onCloseModal:t})=>{const n=_o(),s=()=>{t(),n({defaultMenuType:Kt.integral,from:Mt.new_user_task})};return r.jsxs("div",{className:"next-modal w-[332px] rounded p-[30px]",children:[r.jsxs("div",{className:"text-t1-medium",children:[e==="FINISH_BASIC_TASK"&&r.jsxs(r.Fragment,{children:["👏 从入门到精通，就差这一步！ 恭喜完成 ",Na," 「基础入门」继续挑战",r.jsx("span",{className:"text-active_color",children:"「进阶任务」"})]}),e==="NOTIFICATION"&&r.jsx(r.Fragment,{children:"🤑 新手特惠！ 1元即可升级专业版会员！ 限时活动，手慢无！"})]}),r.jsxs("div",{className:"flex items-center mt-[30px]",children:[r.jsx(De,{colorType:"black",onClick:t,className:"border-grey5",children:"自我探索"}),r.jsx(De,{colorType:"active",className:"ml-2.5",onClick:s,children:"马上出发"})]})]})},bO=()=>{const e=ie(),t=_o();return y.useCallback(n=>new Promise(s=>{const a=j0(n);e.modal({closeAfterCallBack:()=>{s(0)},content:({onCloseModal:o})=>r.jsxs("div",{className:"next-modal w-[400px] p-[30px] flex flex-col",children:[r.jsx("p",{className:"text-center text-[70px] leading-[70px]",children:"😀"}),r.jsx("p",{className:"text-t1-medium mt-2.5 text-center",children:"恭喜你"}),r.jsxs("p",{className:"text-t2 text-center mt-2.5",children:["成功解锁首个「新手任务」并获得 ⭐+",a==null?void 0:a.score," 积分 ",r.jsx("br",{}),"（积分可累积抵现兑换专业版会员）"]}),r.jsx(De,{colorType:"active",className:"mt-10 flex-1 p-1",onClick:()=>{o(),s(0),t({defaultMenuType:Kt.integral,from:Mt.new_user_task})},children:"解锁更多"})]})})}).catch(s=>{zp(s)}),[e,t])},cae=()=>{const e=ie();return y.useCallback(t=>{const n=S0();e.dropdown({popcorn:n.popcorn,placement:"top-start",offset:[-50,0],closeAfterCallBack:n.remove,content:({onCloseModal:s})=>r.jsx(lae,{type:t,onCloseModal:s})})},[e])},dae=({resolve:e,onCloseModal:t,taskId:n})=>{var u,f;const[s,a]=y.useState(0),o=j0(n),[i,l]=y.useState(0);if(!o)return null;const c=(u=o.resourceList)!=null?u:[],d=()=>{i<c.length-1?l(i+1):a(2)};if(s===0)return r.jsxs("div",{className:"next-modal w-[360px] rounded p-[30px]",children:[r.jsxs("div",{className:"text-t1-medium",children:["是否一起学习如何更好的使用",r.jsx("br",{}),WD[n]," 功能吗？"]}),r.jsxs("div",{className:"flex items-center mt-[30px]",children:[r.jsx(De,{colorType:"black",onClick:()=>{t(),e(0)},className:"border-grey5",children:"自我探索"}),r.jsx(De,{colorType:"active",className:"ml-2.5",onClick:()=>a(1),children:"马上行动"})]})]});if(s===1){const h=(f=o.resourceList)==null?void 0:f[i];return r.jsxs("div",{className:"next-modal w-[320px] rounded p-[30px]",children:[r.jsx("p",{className:"text-t1-medium",children:WD[n]}),r.jsx("p",{className:"text-t2 mt-1",children:h==null?void 0:h.content}),r.jsx("img",{src:h==null?void 0:h.imgUrl,className:"mt-2.5",alt:""}),r.jsxs("div",{className:"flex items-center mt-[30px]",children:[r.jsx(De,{colorType:"black",onClick:()=>l(i-1),disable:i===0,className:"border-grey5",children:"上一步"}),r.jsx(De,{colorType:"active",className:"ml-2.5",onClick:d,children:i===c.length-1?"完成":"下一步"})]})]})}return r.jsxs("div",{className:"next-modal w-[320px] rounded p-[30px]",children:[r.jsx("p",{className:"text-t1-medium",children:"想要了解更多FlowUs使用方法？"}),r.jsx("p",{className:"text-t2 mt-1",children:"前往「帮助中心」get更多实用小妙招"}),r.jsx("img",{src:vn.activityHelp,className:"mt-2.5",alt:""}),r.jsxs("div",{className:"flex items-center mt-[30px]",children:[r.jsx(De,{colorType:"black",onClick:t,className:"border-grey5",children:"稍后了解"}),r.jsx(De,{colorType:"active",className:"ml-2.5",onClick:()=>{t(),window.open(ds.helpCenter)},children:"马上出发"})]})]})},uae=()=>{const e=ie(),t=bO();return y.useCallback((n,s)=>new Promise(a=>{const o=S0();e.dropdown({popcorn:o.popcorn,placement:"top-start",offset:[-50,0],closeAfterCallBack:async()=>{o.remove(),s&&await t(n),a(0)},content:({onCloseModal:i})=>r.jsx(dae,{onCloseModal:i,taskId:n,resolve:a})})}).catch(a=>{zp(a)}),[e,t])};const fae=({taskId:e,resolve:t})=>{const n=j0(e),s=ln(),[a,o]=y.useState(0),[i,l]=y.useState({right:0,bottom:0});return y.useEffect(()=>{a>0?setTimeout(()=>{s("score-modal"),t(0)},600):Ao(1700).then(()=>{var u;const c=document.querySelector(".service-center");if(!c)return;const d=c.getBoundingClientRect();l({right:window.innerWidth-d.left-d.width/2,bottom:window.innerHeight-d.top}),o((u=n==null?void 0:n.score)!=null?u:0)})},[a,n==null?void 0:n.score,s,t]),a>0?r.jsxs("div",{className:"text-t4-medium text-yellow flex items-center translate-x-1/2 absolute",style:{right:"".concat(i.right,"px"),bottom:"".concat(i.bottom,"px")},children:[r.jsx("img",{src:vn.littleMedal,alt:"",className:"w-6"}),"+",a]}):r.jsx("div",{className:"lazyhidden relative h-[300px] w-[300px] overflow-hidden",children:r.jsx("img",{className:"fadein absolute left-1/2 h-[100px] w-[100px] -translate-x-1/2 -translate-y-1/2 ",src:vn.medal})})},mae=()=>{const e=ie();return y.useCallback(t=>new Promise(n=>{e.modal({modalId:"score-modal",closeAfterCallBack:()=>{n(0)},containerClassName:"bg-transparent",className:"shadow-none border-none bg-transparent",content:()=>r.jsx(fae,{taskId:t,resolve:n})})}).catch(n=>{zp(n)}),[e])},KD=new Ai(localStorage,"newUserTaskStorage",50),hae=()=>{const e=ie(),t=_o();return y.useCallback(()=>{const n=S0();e.dropdown({popcorn:n.popcorn,modalId:"openFirstTaskModal",placement:"top-end",offset:[4,10],autoClose:!1,keyboard:!1,closeAfterCallBack:n.remove,content:({onCloseModal:s})=>r.jsxs("div",{className:"p-7 next-modal w-80",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-h3 mb-2.5",children:"成功解锁新任务！"}),r.jsx("div",{className:"text-t1-medium",children:"你已解锁首个新用户专享任务，积分已到手，来看看还有那些任务吧。"})]}),r.jsxs("div",{className:"mt-7 flex items-center",children:[r.jsx(De,{className:"mr-2.5",onClick:()=>s(),children:"稍后了解"}),r.jsx(De,{colorType:"active",onClick:()=>{s(),t({defaultMenuType:Kt.integral,from:Mt.package})},children:"立即查看"})]})]})})},[e,t])},pae=()=>{const e=ie(),t=_o();return y.useCallback(()=>{const n=S0();e.dropdown({popcorn:n.popcorn,modalId:"openStageTaskModal",placement:"top-end",offset:[4,10],closeAfterCallBack:n.remove,content:({onCloseModal:s})=>r.jsxs("div",{className:"p-7 next-modal w-80",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-h3 mb-2.5",children:"完成阶段性任务！"}),r.jsx("div",{className:"text-t1-medium",children:"你已完成阶段性新手任务，再接再厉哦"})]}),r.jsx("div",{className:"mt-7 flex items-center",children:r.jsx(De,{colorType:"active",onClick:()=>{s(),t({defaultMenuType:Kt.integral,from:Mt.package})},children:"查看剩余任务"})})]})})},[e,t])},gae=()=>{const e=ie();return y.useCallback(()=>{const t=S0();e.dropdown({popcorn:t.popcorn,modalId:"openStageTaskModal",placement:"top-end",offset:[4,10],closeAfterCallBack:t.remove,content:()=>r.jsxs("div",{className:"p-7 next-modal w-80",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-h3 mb-2.5",children:"完成所有新手任务！"}),r.jsx("div",{className:"text-t1-medium",children:"恭喜！你已完成所有新手任务！"}),r.jsx("div",{className:"text-t1-medium",children:"后续使用过程中若遇到问题，随时点击我查看帮助哦~"})]}),r.jsx("div",{className:"mt-7 flex items-center"})]})})},[e])},tN=()=>{const e=hae(),t=pae(),n=gae();return y.useCallback(async s=>{var l,c,d,u;const{completeListType:a}=s||{},o=!!S_().basicList.find(f=>f.uuid===Je.CREATE_NEW_PAGE);if(s!=null&&s.openCompleteModal&&!o){const f=S_().basicList.every(p=>p.status==="completed"),h=S_().advancedList.every(p=>p.status==="completed");(f&&h||a===ct.advancedList&&h||a===ct.basicList&&f)&&(s.openCompleteModal=!1)}const i=await ve.infra.getActivityList("all","all",Ot());if(BZ(i),s!=null&&s.openCompleteModal&&!o){const f=((l=i.advancedList)==null?void 0:l.filter(_=>_.status==="completed").length)||0,h=((c=i.basicList)==null?void 0:c.filter(_=>_.status==="completed").length)||0;if(f+h===0)return;if(f+h===1){e();return}const p=f===((d=i.advancedList)==null?void 0:d.length),g=h===((u=i.basicList)==null?void 0:u.length);if((a===ct.advancedList&&p||a===ct.basicList&&g)&&!(p&&g)){t();return}p&&g&&n()}},[n,e,t])},Js=()=>{const e=tN(),t=uae(),n=cae(),s=mae(),a=bO();return y.useCallback(async(o,i,l)=>{var u,f;const c=j0(o);if(!c||["abandoned","completed"].includes(c.status||""))return;if(Xre.has(o)){const h=(u=KD.get(o))!=null?u:{};if(l!=null&&l.step1&&(h.step1=!0),l!=null&&l.step2&&(h.step2=!0),KD.put(o,h),!(h!=null&&h.step1)||!(h!=null&&h.step2))return}if((await ve.infra.completedActivity.raw(o,{completed:(f=l==null?void 0:l.completed)!=null?f:!0,viewed:!0,createdBy:l==null?void 0:l.createdBy})).code===200){await s(o),GD.has(o)&&await t(o,l==null?void 0:l.isFirstTask),l!=null&&l.isFirstTask&&!GD.has(o)&&await a(o),await e({openCompleteModal:!0,completeListType:i});const h=S_();h.basicList.every(p=>p.status==="completed")&&h.basicList.find(p=>p.uuid===o)&&h.advancedList.find(p=>p.status!=="completed")&&n(yO.FINISH_BASIC_TASK)}else e()},[e,t,s,a,n])},nN=()=>y.useCallback(async e=>g1(e),[]),g1=async e=>{try{const{extName:t}=rn(e.name);if(Jt.image.test(t))return await hI(e);if(Jt.video.test(t))return await F5(e)}catch(t){return{}}return{}},gm=e=>{const{getApi:t,defaultValue:n,enable:s=!0}=e,[a,o]=y.useState(!0),[i,l]=y.useState(n),c=y.useCallback(async()=>{o(!0);const d=await t();l(d),o(!1)},[t]);return tc(()=>{s&&c()},[s],{wait:200,leading:!0,trailing:!1}),[i,c,a]},sN=e=>{const t=y.useRef(new Map);return y.useCallback(async(...s)=>{const a=JSON.stringify(s),o=t.current.get(a);if(o)return o.result;const i=await e(...s);return t.current.set(a,{result:i,timestamp:Date.now()}),i},[e])},YD=Symbol.for("all");function vl(e){const t=JF(void 0),n=({children:s,...a})=>{const o=e(a),i=y.useMemo(()=>o,[]),l=y.useMemo(()=>new Map,[]),c=y.useMemo(()=>{const d=(h,p)=>{let g=l.get(h);g||(g=new Set,l.set(h,g)),g.add(p)};return{observe:d,unobserve:h=>l.forEach(p=>p.delete(h)),observeAll:h=>{d(YD,h)},model:i}},[]);return y.useEffect(()=>{const d=new Set(l.get(YD));xae(o).forEach(u=>{var p;const f=Reflect.get(o,u),h=Reflect.get(i,u);Object.is(h,f)||(Reflect.set(i,u,f),(p=l.get(u))==null||p.forEach(g=>d.add(g)))}),d.forEach(u=>u())},[o,i,l]),r.jsx(t.Provider,{value:c,children:s})};return n.Context=t,n.displayName="Model(".concat(e.name,")"),n}function an(e){const t=rL(e.Context);if(!t)throw new Error("useModel 需要在 ".concat(e.displayName," 内使用"));const{model:n,observe:s,unobserve:a}=t,[,o]=y.useReducer(l=>l+1,0),i=y.useRef(!0);return i.current=!0,y.useEffect(()=>{i.current=!1}),y.useEffect(()=>()=>a(o),[]),y.useMemo(()=>new Proxy(n,{get(l,c){return i.current&&s(c,o),Reflect.get(l,c)},set(l,c){return!1}}),[])}function _ae(e,t,n){const s=nL(e.Context,d=>d);if(!s)throw new Error("useModelSelect 需要在 ".concat(e.displayName," 内使用"));const{model:a,observeAll:o,unobserve:i}=s,[l,c]=y.useReducer(d=>{const u=t(a);return n!=null&&n(d,u)?d:u},t(a));return y.useEffect(()=>(o(c),()=>{i(c)}),[]),l}function xae(e){return[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)]}function As(e=0,t=1){const n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(e===0)return"0B";const{value:s,index:a}=yae(e,t);return"".concat(s).concat(n[a])}function yae(e=0,t=1){const n="".concat(e,"-").concat(t);if(G2.has(n))return G2.get(n);if(e===0)return{value:0,index:0};let s=0,a=Math.max(1,e);for(;a>1024;)a=a/1024,s++;const o={value:Number(a.toFixed(t).replace(/\.0+$/,"")),index:s};return G2.set(n,o),o}const Cr=e=>{const{className:t,...n}=e;return r.jsx("span",{className:R("block border-t border-grey6",t),...n})},D0=e=>{const{className:t}=e;return r.jsx("div",{className:R("h-2.5 flex items-center w-full flex-shrink-0",t),children:r.jsx("div",{className:"w-full h-px bg-grey6"})})},io=e=>{switch(e){case 0:return"积分";case 1:return"¥";case 2:return"$";case 3:return"€";default:return"¥"}},rN=e=>{const{bizType:t,...n}=e;me.event(t,{...n})},bae=e=>{if(e)return bu({firstBuyCycle:"first",stuDiscountCash:"education",limitTimeCycle:"limit"},e)},sa=e=>{const{children:t,className:n,height:s,...a}=e;return r.jsx("div",{className:R("flex items-center py-2.5",n),...a,style:{minHeight:s},children:t})},FO=qe(),aN=y.memo(e=>{var d,u;const t=ie(),{className:n,couponList:s=[],selectId:a,onSelectId:o}=e,i=s.find(f=>f.id===a),l=s.length,c=f=>{t.dropdown({modalId:FO,popcorn:f.currentTarget,offset:[0,10],content:()=>r.jsx(wae,{couponList:s,selectId:a,onSelectId:o})})};return r.jsxs("div",{className:R("text-t2",n),children:[r.jsxs("div",{className:"py-2.5 flex items-center flex-shrink-0 text-t1-medium space-x-2",children:[r.jsx(V,{name:"IcTicket",size:"large"}),r.jsx("span",{className:"text-t1-medium",children:"优惠券"}),r.jsx("span",{hidden:l<=1,className:R("text-t4 text-grey3",l&&"text-red"),children:"".concat(l," 张可用")})]}),r.jsx("div",{className:"py-2.5",children:r.jsxs("div",{onClick:c,className:"flex items-center cursor-pointer h-full",children:[i?r.jsxs("div",{className:"line-clamp-1 space-x-1",children:[r.jsx("span",{children:i.name}),r.jsx("span",{className:"bg-red px-1.5 rounded text-white-base",children:(d=i.resources)!=null&&d.prefix?r.jsx("span",{children:i.resources.prefix}):r.jsxs(r.Fragment,{children:[i.headerShowType===0&&r.jsx(r.Fragment,{children:"-¥".concat(i.salePrice)}),i.headerShowType===1&&r.jsx(r.Fragment,{children:"".concat(((u=i.saleDiscountRate)!=null?u:0)*10,"折")}),i.headerShowType===2&&r.jsx(r.Fragment,{children:"赠".concat(i.monthNum,"月")}),i.headerShowType===3&&r.jsx(r.Fragment,{children:"赠".concat(i.dayNum,"天")})]})})]}):r.jsx("span",{className:R(l&&"text-red"),children:l?"".concat(l," 张可用"):"暂无可用"}),r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall",className:"ml-1"})]})})]})}),Fae={integralRecord:"linear-gradient(270deg, rgba(249, 139, 42, 0.5) 0%, rgba(249, 139, 42, 0) 100%)",education:"linear-gradient(270deg, rgba(193, 50, 135, 0.1) 0%, rgba(193, 50, 135, 0) 100%)",limitTime:"linear-gradient(270deg, rgba(0, 92, 175, 0.1) 0%, rgba(0, 92, 175, 0) 100%)",activity:"linear-gradient(270deg, rgba(17, 187, 136, 0.1) 0%, rgba(17, 187, 136, 0) 100%)"},wae=e=>{const{onSelectId:t,couponList:n=[],selectId:s}=e,a=ie(),o=()=>{a.closeModal(FO)},i=r.jsx(V,{name:"IcCheck02",size:"middle",className:R("absolute -top-px -right-px rounded-tr rounded-bl bg-black-base text-white-base",!s&&"top-2.5 right-4 rounded")});return r.jsxs("div",{className:R("py-1.5 w-[360px] text-t2-medium next-modal",{"w-full":js,"next-modal":!js}),children:[r.jsxs(sa,{className:"mx-2 px-2 cursor-pointer relative animate-click animate-hover",onClick:()=>{t(),o()},height:40,children:["不使用优惠券",!s&&i]}),r.jsx(D0,{}),r.jsxs("div",{className:"overflow-y-auto max-h-56 px-4 pt-2.5",children:[r.jsx(Eae,{couponList:n,selectId:s,onSelectId:l=>{t(l),o()}}),!n.length&&r.jsx(sa,{height:40,className:"cursor-not-allowed",children:"暂无可用优惠券"})]})]})},Eae=e=>{const{couponList:t=[],onSelectId:n,selectId:s}=e,a=r.jsx(V,{name:"IcCheck02",size:"middle",className:R("absolute -top-px -right-px rounded-tr rounded-bl bg-black-base text-white-base",!s&&"top-2.5 right-4 rounded")});return r.jsx(r.Fragment,{children:t.map(o=>{var i,l,c,d;return r.jsxs("div",{className:"relative flex items-center py-2.5 px-4 border border-grey6 rounded cursor-pointer mb-2.5 min-h-[100px] animate-click",style:{background:Fae[o.showType]},onClick:()=>n==null?void 0:n(o.id),children:[s===o.id&&a,r.jsx("div",{className:"min-w-[60px] text-center text-h2 whitespace-nowrap",children:(i=o.resources)!=null&&i.prefix?r.jsx("span",{children:(l=o.resources)==null?void 0:l.prefix}):r.jsxs(r.Fragment,{children:[o.headerShowType===0&&r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-t2-medium",children:io(o.priceUnit)}),r.jsx("span",{children:o.salePrice})]}),o.headerShowType===1&&r.jsxs("span",{children:[((c=o.saleDiscountRate)!=null?c:0)*10,"折"]}),o.headerShowType===2&&r.jsxs("span",{children:[o.monthNum,"月"]}),o.headerShowType===3&&r.jsxs("span",{children:[o.dayNum,"天"]})]})}),r.jsxs("div",{className:"ml-5 dark:text-white-base space-y-1",children:[r.jsx("div",{className:"text-t2-medium",children:o.name}),r.jsx("div",{className:"text-t4 text-grey3 dark:text-grey1 whitespace-pre-line",children:(d=o.description)==null?void 0:d.replace("\\n","\n")}),r.jsx("div",{className:"text-t4-medium text-grey3 dark:text-grey1",children:o.subtitle}),r.jsxs("div",{className:"text-t4-medium text-grey3 dark:text-grey1",children:["活动截止",ue(o.expirationDate).format("YYYY年MM月DD日")]})]}),o.showType==="integralRecord"&&r.jsx("img",{src:vn.star,className:"absolute right-0 opacity-30 pointer-events-none"})]},o.id)})})},Cae=e=>{const{children:t,className:n,bgColor:s}=e;return r.jsx("span",{className:R("flex absolute -top-0.5 -left-0.5 justify-center items-center py-0.5 px-1.5 text-white-base rounded-br-md rounded-tl-md text-t5 z-10",!1,n),style:{background:s||"linear-gradient(270.32deg, #FF4E47 0.24%, #FC938F 96.14%)",zoom:.7},children:t})},kae=(e="",t)=>Xr(e).mix(Xr("black"),t).hex(),Tae=e=>{var g,_;const{name:t="",color:n=Do.grey3,icon:s,imgClassName:a,iconSize:o,isDark:i=!1,getImageCdnUrl:l,IconWidget:c}=e,d=hp(t,"")[0],u=(s==null?void 0:s.type)==="upload"&&s.value,f=(s==null?void 0:s.type)==="emoji"&&s.value,h=(s==null?void 0:s.type)==="icon"&&s.value,p=R("h-full w-full rounded object-cover",a);return r.jsxs("span",{className:R("w-6 h-6 text-h4 flex flex-shrink-0 select-none items-center justify-center rounded uppercase leading-none text-black2",e.className),style:{width:o,height:o,...e.style,backgroundColor:f||u||h||!n?"":kae(n,i?.15:0)},onClick:e.onClick,children:[!u&&!h&&(f&&c?y.cloneElement(c,{iconSize:o,emojiStr:(s==null?void 0:s.value)||d,disableHover:!0}):d),u&&r.jsx(hb,{unloader:r.jsx("img",{src:_p(),className:p}),src:(g=s.value)!=null&&g.startsWith("http")?s.value:l((_=s.value)!=null?_:""),className:p}),h&&s&&s.value&&r.jsx(hb,{unloader:r.jsx("img",{src:_p(),className:p}),src:c3(i,s.value),className:p})]})},ar=e=>{const t=Pa();return r.jsx(Tae,{...e,isDark:t,getImageCdnUrl:DZ,IconWidget:r.jsx(na,{})})},_i=ds,Vb=({className:e,link:t,popup:n,size:s="small",placement:a})=>r.jsx(Fe,{placement:a,popup:n,interactive:!0,className:"inline-block",children:r.jsx("a",{href:t,target:"_blank",rel:"noreferrer",onClick:o=>{o.stopPropagation()},children:r.jsx(V,{name:"IcInviteHelp",size:s,className:R("ml-1 text-grey4 animate-click",e)})})}),ul=({iconClassName:e,showBuildin:t,className:n,children:s,link:a,beforeIcon:o,popup:i,linkContainer:l})=>{const c=r.jsx(Vb,{popup:i,link:a,className:R("text-grey4 flex items-center",o?"mr-1":"ml-1",l&&"pointer-events-none",e)}),d=r.jsxs(r.Fragment,{children:[o&&c,s,!o&&c]});return l?r.jsx("div",{className:R("flex items-center animate-click text-ellipsis",n),onClick:()=>{a&&F0(a)},children:d}):r.jsx("div",{className:R("flex items-center text-ellipsis",n),children:d})},$b=({value:e=0})=>{const t=aL({number:e||0}),n=String(e).indexOf(".")+1,s=String(e).length-n;return r.jsx(oL.span,{children:t.number.to(a=>{if(n===0)return a.toFixed(0);if(s>0)return a.toFixed(s)})})},vae=e=>{const{className:t,children:n}=e;return r.jsx("div",{className:R("max-h-[80vh] overflow-y-auto pb-5 transition-opacity",js&&"max-h-[calc(100vh-48px)]",t),children:n})},Iae=({close:e})=>{var a;const t=Ut(),n=_r(t.uuid),s=r.jsxs(r.Fragment,{children:[r.jsx(ar,{name:n,color:t.backgroundColor,icon:{type:"upload",value:t.avatar},className:"mr-2 w-[25px] h-[25px] text-white rounded-full",imgClassName:"rounded-full",style:{fontSize:"14px"}}),r.jsxs("span",{className:"text-grey3 text-t2",children:[n," ",Cm((a=t.phone)!=null?a:t.email)]})]});return r.jsxs("div",{className:"flex items-center pr-5 pl-8 h-12 border-b",children:[s,r.jsx(V,{name:"IcClose",onClick:e,size:"middle",className:"ml-auto animate-click"})]})},Nae=e=>{const{items:t,selectId:n,loading:s,itemRender:a,itemClick:o,itemClassName:i,className:l}=e;return r.jsx(sa,{className:R("px-7 overflow-x-auto transition-all space-x-5",l,s&&"opacity-60"),children:t.map(c=>r.jsx("div",{className:R("flex flex-col items-center justify-center flex-shrink-0 px-4 h-24 border-2 rounded-md cursor-pointer relative",i,n===c.id?"border-black bg-black_006":"border-grey5",c.enable===2&&"opacity-30 cursor-not-allowed"),onClick:()=>{c.enable===2||n===c.id||o(c.id)},children:a(c)},c.id))})},jae=e=>{const{className:t,endTime:n,children:s}=e;return r.jsxs(sa,{height:36,className:R("px-8 text-grey3 text-t3",t),children:["购买后有效期至"," ",n,s]})},Sae=e=>{const{payMethod:t,switchPayMethod:n,disablePayMethod:s,payMethodList:a}=e,o=y.useMemo(()=>a||[{type:Cn.alipay,disable:s==null?void 0:s.includes(Cn.alipay),title:r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{name:"IcAlipayPay",size:"middle",className:"mr-2 text-[#1677FF]"})," 支付宝支付"]})},{type:Cn.wxpay,disable:s==null?void 0:s.includes(Cn.wxpay),title:r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{name:"IcWechatPay",size:"middle",className:"mr-2 text-[#07C160]"})," 微信支付"]})}],[s,a]);return r.jsxs(r.Fragment,{children:[r.jsx(sa,{height:54,className:"text-h3 px-8",children:"支付方式"}),r.jsx("div",{className:"flex justify-center px-6",children:o.map(i=>r.jsx("div",{onClick:()=>!i.disable&&n(i.type),className:R("text-t2-medium flex items-center justify-center mx-2.5 border flex-1 h-10 rounded-md cursor-pointer transition-all",i.type===t?"border-black bg-black_003":"border-grey5",i.disable&&"cursor-not-allowed opacity-30"),children:i.title},i.type))})]})},Dae=e=>{const{price:t,onPay:n,disablePay:s,priceUnit:a,protocols:o=[],priceAfter:i}=e,[l,c]=y.useState(!1),d={link:ds.paidServices,title:"《付费服务条款》"},u=[d,...o].map(h=>h.title).join(""),f=()=>{if(!l){be.warning("请开通前阅读并同意".concat(u));return}n()};return r.jsxs("div",{className:"px-8",children:[r.jsxs("div",{className:"flex justify-between items-center py-2.5 text-grey3 text-t3 select-none border-t",children:[r.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>c(!l),children:[r.jsx(V,{name:l?"IcCircleCheck":"IcCircleCheckbox",size:"middle",className:R("mr-1.5",l?"text-active_color":"text-grey3")}),"开通前阅读并同意",[d,...o].map(h=>r.jsx("a",{href:h.link,onClick:p=>p.stopPropagation(),target:"_blank",children:h.title},h.title))]}),r.jsxs("span",{className:"flex items-center",children:[r.jsx(na,{emojiStr:"⚠️",disableHover:!0,iconSize:12})," 暂不支持退款"]})]}),r.jsxs("div",{className:"flex justify-between items-center h-20 border-t select-none",children:[r.jsxs("div",{className:"text-h3",children:[r.jsx("span",{children:"总价："}),r.jsxs("span",{className:"text-active_color-base",children:[io(a),r.jsx($b,{value:t})]}),i]}),r.jsx(De,{autoFocus:!0,className:"text-t2-medium w-52 h-10",disable:s,colorType:"active",onClick:f,children:"立即支付"})]})]})},Aae=e=>{var a;const{coupon:t,className:n}=e,s=wd();return(a=t==null?void 0:t.resources)!=null&&a.title?r.jsxs("div",{className:n,children:[r.jsx(D0,{className:"mb-2.5"}),r.jsxs("div",{className:"text-t2 p-4 rounded space-y-4",style:{background:"linear-gradient(89.52deg, #F3E4B5 0.34%, #E9C770 99.54%)"},children:[r.jsxs("div",{className:"flex justify-between text-[#8F6C28]",children:[r.jsx("div",{className:"text-h4",children:t.resources.title}),r.jsx(ul,{className:"text-t4",iconClassName:"text-[#8F6C28]",linkContainer:!0,link:t.resources.jumpLink,children:"了解活动详情"})]}),r.jsx("img",{className:"w-full pb-2",src:(s?t.resources.darkBodyRes:t.resources.lightBodyRes)||"",alt:t.resources.title})]})]}):null},Rae=e=>{const{planName:t,priceUnit:n,price:s,className:a,info:o=[],desc:i,payType:l}=e;return r.jsxs("div",{className:a,children:[r.jsx(sa,{height:54,className:"text-t1-medium",children:"订单信息"}),r.jsxs("div",{className:"px-4 py-3 bg-white2 border-t-4 border-active_color",children:[r.jsx("div",{className:"text-t1-medium mb-2.5",children:"".concat(t," 套餐计划")}),r.jsx("div",{className:"text-t2 text-grey3",children:o.map(c=>r.jsx("p",{children:c},c))}),r.jsx("div",{className:"text-t2 text-grey3",hidden:!i,children:i}),r.jsx(D0,{className:"my-1"}),r.jsxs("div",{className:"text-t2-medium",children:["总计 ",io(n),r.jsx($b,{value:s})]}),l!==Cn.stripe&&!1]})]})},Pae={[Cn.sberPayRu]:{title:"SberPay",img:qo.paySber},[Cn.cardRu]:{title:"Visa/Mastercard/Mir",img:qo.payCard},[Cn.sbpRu]:{title:"SBP",img:qo.paySbp},[Cn.stripe]:{title:"Stripe",img:qo.payStripe},[Cn.yoomoneyRu]:{title:"Yoomoney",img:qo.payYoomoney},[Cn.alipay]:{title:"支付宝",img:qo.aliPay},[Cn.wxpay]:{title:"微信支付",img:qo.weChatPay},[Cn.offline]:{title:"线下支付",img:""}},Lae=e=>{const{payList:t=[Cn.stripe,Cn.yoomoneyRu,Cn.sbpRu,Cn.cardRu],active:n,onChange:s,className:a}=e;return r.jsxs("div",{children:[r.jsx(sa,{height:54,className:"text-t1-medium",children:"支付选项"}),r.jsx("div",{className:"space-y-4 text-t2",children:t.map((o,i)=>{const l=Pae[o],c=n===o;return r.jsxs(y.Fragment,{children:[i===1&&!1,r.jsxs("div",{className:R(a,"border-2 border-grey6 flex items-center space-x-2 rounded-md bg-white3 p-2 animate-click overflow-scroll",c&&"border-active_color bg-active_color_10"),onClick:()=>{s(o)},children:[r.jsx(V,{size:"middle",className:c?"text-active_color":"text-grey3",name:c?"IcCircleCheck":"IcCircleCheckbox"}),r.jsx("span",{children:l.title}),l.img&&r.jsx("img",{className:"h-4 !ml-auto",src:l.img,alt:l.title})]})]},o)})})]})},Bae=e=>{const{protocols:t=[]}=e,n={link:ds.paidServices,title:"付费服务条款"};return r.jsxs("div",{className:R("w-full py-2 bg-white2 text-center sticky bottom-0 left-0",js&&"pt-4"),children:[r.jsx(De,{colorType:"active",className:"w-1/2 h-9 mx-auto",type:"submit",onClick:e.onClick,children:"立即升级"}),r.jsxs(sa,{className:R("text-t4 text-grey3 inline-flex space-x-1",{block:js}),children:[r.jsx("div",{children:"点击“立即升级”即表示你同意"}),[n,...t].map(s=>r.jsx("a",{href:s.link,target:"_blank",className:"animate-click underline-offset-4 underline",children:s.title},s.link))]})]})},ha={OrderInfo:Rae,Header:Iae,SelectPlan:Nae,PayBar:Dae,PayMethod:Sae,PlanEndTime:jae,BODY:vae,UnionCouponDesc:Aae,StripePayBar:Bae,SelectPay:Lae};var oN=(e=>(e.renewPeople="renewTeamPeople",e.renewTime="renewTeamTime",e.upgrade="upgradeTeam",e))(oN||{}),iN=(e=>(e.renewPeople="renewProPeople",e.renewTime="renewProTime",e.upgrade="upgradePro",e))(iN||{});const lN=async(e=Ot())=>{await B5(e),await bI(e),await sT(),await zne(e),await p0()},Oae=(e="")=>e.replace(/\u00a0/g," "),Xt=async(e,t)=>{var n;gs.check&&Zp(Ca.CopyText,e),await iL(Oae(e)),(t==null?void 0:t.message)!=="none"&&be.success((n=t==null?void 0:t.message)!=null?n:"复制成功")},tRe=async e=>{if(gs.check){const n=require("fs"),s=require("os"),a="".concat(s.tmpdir(),"/").concat(Date.now(),".png"),o=await e.arrayBuffer();return n.writeFileSync(a,pW.from(o)),Zp(Ca.CopyImage,a)}const t=new ClipboardItem({[e.type]:e});navigator.clipboard.write([t])},wO=()=>{const[e,t]=y.useState([]),n=async()=>{const o=Ot(),i=await ve.infra.getWelfareSpaceCardList(o);t(i)};y.useEffect(()=>{n()},[]);const s=e.filter(o=>o.status===m.ActivationCodeStatusType.UNUSED),a=y.useMemo(()=>{const o=[];return e.filter(i=>i.status!==m.ActivationCodeStatusType.UNUSED).forEach(i=>{const l=ue(i.redeemedAt).startOf("days").valueOf(),c=o.find(d=>d.time===l&&d.channel===i.channel);c?c.data.push(i):o.push({time:l,channel:i.channel,data:[i]})}),o.sort((i,l)=>l.time-i.time),o},[e]);return{welfareCodeData:e,unusedWelfareCodeData:s,groupWelfareCodeData:a,refreshWelfare:n}},Mae={[m.ActivationCodeStatusType.MISMATCH]:"空间不匹配",[m.ActivationCodeStatusType.UNUSED]:"未使用",[m.ActivationCodeStatusType.USED]:"已兑换",[m.ActivationCodeStatusType.EXPIRED]:"已过期",[m.ActivationCodeStatusType.PRESENT]:"已送出",[m.ActivationCodeStatusType.USED_COUNT_LIMIT]:"超出可兑换人数",[m.ActivationCodeStatusType.SINGLE_USER_USED_COUNT_LIMIT]:"超出领取次数"},Uae={[m.ActivationCodeChannelType.SPACE]:"空间福利",[m.ActivationCodeChannelType.SYSTEM]:"系统奖励"},EO=e=>{const{className:t,item:n}=e,s=n.status!==m.ActivationCodeStatusType.UNUSED,a=()=>{Xt(n.code)};return r.jsxs("div",{className:R("text-t4 p-4 border border-grey6 text-grey3 rounded",t,s&&"cursor-not-allowed text-grey4"),style:{background:"linear-gradient(360deg, rgba(24, 160, 251, 0.1) 0%, rgba(24, 160, 251, 0) 100%)"},children:[r.jsx("div",{className:"text-t2-medium",children:n.name}),r.jsxs("div",{className:"my-1 flex items-center",children:[n.code,r.jsx(V,{name:"IcCopy",className:"ml-1 animate-click",onClick:a,size:"middle"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{children:["失效日期：",ue(n.expirationAt).format(Et)]}),r.jsx("span",{children:Mae[n.status]})]})]})},Vae=()=>{const e=ie(),[t,n]=y.useState({input:""}),{unusedWelfareCodeData:s,refreshWelfare:a}=wO();return y.useEffect(()=>{XB()},[]),{close:()=>{e.closeModal(Ve.EXCHANGE_CODE_ID)},onSubmit:async c=>{var f;c.preventDefault();const d="putWelfareCode";if(!t.input||be.exists(d))return;be.loading({key:d,content:"激活中..."});const u=await ve.infra.putWelfareCode.raw(t.input,{spaceId:Ot()});u.code===200&&u.data?(await lN(),await a(),be.success("激活成功")):be.error((f=u.msg)!=null?f:"激活失败"),be.closeMessage(d)},form:t,patchState:c=>{n(Yn(d=>os(d,c)))},unusedWelfareCodeData:s}},$ae=()=>{const{onSubmit:e,form:t,patchState:n}=an(cN);return r.jsx(sa,{className:"py-2.5",children:r.jsxs("form",{className:"contents",onSubmit:e,children:[r.jsx(Ct,{autoFocus:!0,className:"text-t2 h-8 w-full rounded-r-none",placeholder:"请输入激活码",value:t.input,onChange:s=>n({input:s})}),r.jsx(De,{className:"h-8 rounded-l-none",colorType:"active",children:"立即激活"})]})})},Hae=()=>{const{close:e,unusedWelfareCodeData:t}=an(cN),n=qae();return r.jsxs("div",{className:R("w-125 max-h-dialog",js&&"w-full"),children:[r.jsx(ha.Header,{close:e}),r.jsxs(ha.BODY,{className:"px-8 pt-2.5",children:[r.jsx(sa,{height:54,className:"text-h2",children:"兑换空间激活码"}),r.jsx(sa,{height:36,className:"text-grey3 text-t3",children:"相同空间当月可使用 1 张空间激活码"}),r.jsx($ae,{}),r.jsxs(sa,{height:54,className:"text-h2 justify-between",children:[r.jsx("span",{children:"我的激活码"}),r.jsx("span",{className:"text-grey3 text-t2 animate-click underline underline-offset-4",onClick:n,children:"不可用的激活码"})]}),r.jsxs("div",{className:"space-y-3",children:[!t.length&&r.jsx("div",{className:"text-center text-grey3 text-t2",children:"暂无可用激活码"}),t.map(s=>r.jsx(EO,{item:s},s.code))]})]})]})},cN=vl(Vae),dN=()=>{const e=ie();return y.useCallback(()=>{e.modal({className:R(js&&"w-screen h-screen max-h-screen"),modalId:Ve.EXCHANGE_CODE_ID,content:()=>r.jsx(cN,{children:r.jsx(Hae,{})})})},[e])},zae=()=>{const e=ie(),{groupWelfareCodeData:t}=wO(),n=s=>r.jsxs(r.Fragment,{children:[r.jsxs(sa,{height:40,className:"sticky top-0 bg-white2 flex justify-between text-t2",children:[r.jsx("span",{children:ue(s.time).format(Et)}),r.jsx("span",{className:"text-grey3",children:Uae[s.channel]})]}),r.jsx("div",{className:"space-y-3",children:s.data.map(a=>r.jsx(EO,{item:a},a.code))})]});return r.jsxs("div",{className:R("w-[500px]",js&&"w-screen h-screen"),children:[r.jsxs(sa,{height:50,className:"text-h4 border-b px-8 flex items-center justify-between",children:[r.jsx("span",{children:"卡券记录"}),r.jsx(V,{onClick:()=>e.closeModal(Ve.WELFARE_HISTORY),size:"middle",name:"IcClose"})]}),r.jsxs(ha.BODY,{className:"px-8",children:[t.map(s=>n(s)),!t.length&&r.jsx("div",{className:"text-t2 text-center text-grey3 mt-4",children:"暂无卡券记录"})]})]})},qae=()=>{const e=ie();return y.useCallback(()=>{e.modal({modalId:Ve.WELFARE_HISTORY,className:R(js&&"w-screen h-screen max-h-screen"),content:()=>r.jsx(zae,{})})},[e])};var Hb=(e=>(e.tutorial="tutorial",e.upgrade="upgrade",e.space_info="space_info",e.space_setting="space_setting",e.welfare="welfare",e.openUpgradeSpace="openUpgradeSpace",e.maxCapacity="maxCapacity",e.maxFileSize="maxFileSize",e.maxCopyLimit="maxCopyLimit",e.payCapacity="payCapacity",e.maxGuestCount="maxGuestCount",e.subscribeAiLimit="subscribeAiLimit",e))(Hb||{});const nRe=()=>{const e=_d(),t=Gae();y.useEffect(()=>{const n=Wae(e.search);t(n)},[e.search,t])},Gae=()=>{const e=_o(),t=dN(),n=ya(),s=mN();return y.useCallback(a=>{switch(a){case"upgrade":{e({defaultMenuType:Kt.upgrade,from:Mt.file});break}case"space_setting":{e({defaultMenuType:Kt.members,from:Mt.file});break}case"space_info":{e({defaultMenuType:Kt.spaceInfo,from:Mt.file});break}case"welfare":{t();break}case"maxCapacity":case"maxGuestCount":case"subscribeAiLimit":case"payCapacity":case"maxFileSize":case"maxCopyLimit":{s({type:a});break}case"openUpgradeSpace":{n(Mt.switch_space);break}}NQ([dn.openDialog])},[e,n,s,t])},Wae=e=>new URLSearchParams(e).get(dn.openDialog),Kae=e=>{if(e==="year")return"年";if(e==="month")return"月"},uT=(e,t)=>{const{prefix:n}=t||{};if(!e)return"";let s="";return e>=12?s="year":e>=1&&(s="month"),s={year:"年",month:"月"}[s],!s||!n?s:"".concat(n).concat(s)},CO=e=>{var s;const[t,n]=y.useState((s=e.defaultTimeType)!=null?s:"month");return{switchPayType:t,setSwitchPayType:n}},kO=e=>{const{onSwitch:t,payType:n}=e;return r.jsx("div",{className:"p-2 ",children:[{name:"月付",type:"month"},{name:"年付",type:"year"}].map(s=>r.jsx("div",{hidden:n==="all",className:R("w-1/2 text-center inline-block p-2 rounded-sm animate-click",n===s.type&&"text-black text-t2-bold bg-black_006",js&&n===s.type&&"bg-active_color rounded"),onClick:()=>t(s.type),children:s.name},s.type))})},Yae=()=>tm.get("inApp")==="true",TO=y.createContext(void 0),Ks=()=>y.useContext(TO),Fc=()=>{const e=ln();return y.useCallback(()=>{const{$createBlockMenuListId:t}=xt;t&&e(t,{closeAfterCallBack:()=>{st({$createBlockMenuListId:"",$menuListKeywords:"",$slashSelection:{},$textareaPlaceHolder:void 0})}})},[e])},A0=()=>{const e=ln();return y.useCallback(()=>{e(xt.$blockMenuListId),st({$blockMenuListId:""})},[e])},vO=()=>y.useCallback(e=>{st({$createBlockMenuListId:e,$textareaPlaceHolder:{blockId:e,placeHolder:"搜索插入内容",alwaysShow:!1},$focusedInSyncBlockId:""})},[]),Sd=(e,t,n,s)=>{const a=Ks();return Ce(({ui:{selectedBlocks:o},blocks:i})=>IO({blocks:i,groupValue:n,selectedBlocks:o,subGroupValue:s,syncId:a,uuid:e,viewId:t}),[e,t,n,s,a],{obsSelectBlocks:[{blockId:e,viewId:t,syncId:a}],wait:50,ignoreDeep:!0})},IO=e=>{const{selectedBlocks:t,blocks:n,uuid:s,viewId:a,syncId:o,groupValue:i,subGroupValue:l}=e;if(!t.length)return!1;const c=n[s!=null?s:""];if(!c)return!1;const d=n[c.parentId];return(d==null?void 0:d.type)===m.BlockType.COLLECTION_VIEW&&t.find(u=>u.blockId===c.parentId)?!1:!!t.find(u=>{var p;return u.blockId===s&&u.viewId===a&&u.syncId===o?!i||!u.groupValues?!0:Object.keys(u.groupValues).includes(i)?l?(p=u.groupValues[i])==null?void 0:p.includes(l):!0:!1:!1})},Xae=(e,t,n)=>{const s=Ks();return Ce(({ui:{selectedBlocks:a}})=>{if(!a.length)return!1;const o=new Map;return a.forEach(i=>{o.set(i.blockId,i.viewId)}),n.filter(i=>{const l=mn(i);return Xn(l.role,m.PermissionRole.WRITER)}).every(i=>{const l=o.get(i);return l&&l===t})},[e,t,s],{obsSelectBlocks:[{blockId:e,viewId:t,syncId:s}]})},Yw=()=>{const e=J3(),t=vO(),n=A0(),s=Fc();return y.useCallback(()=>{t(""),n(),s(),e(()=>({}))},[e,n,s,t])},Qae=e=>{const t=gW(),n=_W(),[s,a]=y.useState(""),[o,i]=y.useState(!1),l=ie(),c=Yw();return{onSubmit:async u=>{var h;if(u.preventDefault(),!t||!n||o)return;l.loading({modalId:Ve.STRIPE_CHECKOUT,autoClose:!1}),i(!0);const{error:f}=await t.confirmPayment({elements:n,confirmParams:{return_url:location.origin},redirect:"if_required"});c(),f?be.error((h=f.message)!=null?h:"An unexpected error occurred."):e.submit(),i(!1)},email:s,isLoading:o,setEmail:a}},NO=vl(Qae),jO=()=>an(NO),Jae=()=>{const{setEmail:e}=jO();return r.jsxs(r.Fragment,{children:[r.jsx(yW,{id:"link-authentication-element",onChange:t=>e(t.value.email)}),r.jsx(bW,{id:"payment-element",options:{layout:"tabs"}})]})},Zae=e=>{const{clientSecret:t}=e,s={variables:wd()?{colorPrimary:Do.active_color,colorBackground:Do.dark.white2,colorText:Do.dark.white}:void 0};return{options:{clientSecret:t,appearance:s,locale:"en"},clientSecret:t}},SO=vl(Zae),eoe=()=>an(SO),toe=e=>{const{clientSecret:t,submit:n,children:s,className:a}=e;return r.jsx(SO,{clientSecret:t,children:r.jsx(noe,{className:a,submit:n,children:s})})},noe=e=>{const{options:t}=eoe(),[n,s]=y.useState(null);return y.useEffect(()=>{(async()=>{const{loadStripe:a}=await Pe(()=>import("./stripe.esm-27d2b7fe.js"),[]);s(a(xZ))})()},[]),r.jsx(r.Fragment,{children:t.clientSecret&&r.jsx(xW,{options:t,stripe:n,children:r.jsx(NO,{submit:e.submit,children:r.jsxs(soe,{className:"p-5 space-y-5",children:[r.jsx(Jae,{}),r.jsx(De,{colorType:"active",children:"Pay"})]})})},t.clientSecret)})},soe=e=>{const{className:t,children:n}=e,{onSubmit:s}=jO();return r.jsx("form",{id:"payment-form",className:t,onSubmit:s,children:n})},roe=()=>{const e=ie(),t=coe();return y.useCallback(n=>{n.clientSecret&&e.modal({content:s=>r.jsx(toe,{submit:()=>{s.onCloseModal(),t(),Yae()&&setTimeout(()=>{window.close()},5e3)},clientSecret:"".concat(n.clientSecret)})})},[e,t])},aoe=()=>{const e=ie();return y.useCallback(t=>{t.url&&(window.open(t.url),e.warning({title:"已完成支付？",colorType:"active",cancelText:"取消",confirmText:"已支付",confirm(){location.reload()}}))},[e])},DO=()=>{const e=roe(),t=aoe();return y.useCallback(n=>{n.redirectUrl?t({url:n.redirectUrl}):e({clientSecret:n.clientSecret})},[t,e])},AO=Aa(()=>({})),ooe=Qs(AO),ioe=(e,t)=>{ooe(n=>(n[e]||(n[e]={}),n[e]=t,n))},Xw=()=>{const e=Ut();return AO(t=>t[e.uuid]||{},In)},RO=async()=>{const e=xa(),t=await ve.infra.creditBalanceStatistics();ioe(e.uuid,{integralInfo:t})};function XD(e,t){return Math.random()*(t-e)+e}const uN={bothSides:async()=>{const e=()=>{const n=(s,a)=>{U2(Object.assign({y:.7,x:0},a,{zIndex:9999,particleCount:Math.floor(200*s)}))};n(.25,{spread:26,startVelocity:55}),n(.2,{spread:60}),n(.35,{spread:100,decay:.91,scalar:.8}),n(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2}),n(.1,{spread:120,startVelocity:45})};await Ao(500),e(),await Ao(1e3),e(),await Ao(1e3),e()},fireworks:()=>{const t=Date.now()+8e3,n={startVelocity:30,spread:360,ticks:60,zIndex:99999},s=setInterval(()=>{const a=t-Date.now();if(a<=0)return clearInterval(s);const o=50*(a/8e3);U2({...n,particleCount:o,origin:{x:XD(.1,.3),y:Math.random()-.2}}),U2({...n,particleCount:o,origin:{x:XD(.7,.9),y:Math.random()-.2}})},250)}},PO=e=>{const{rePayOrder:t,priceTitle:n,payType:s,changePayType:a,onFinish:o,qaCodeUrlIsImage:i}=e,l=s===Cn.alipay,c=y.useRef(),d=y.useRef(),u=ie(),f=y.useRef(!1),[h,p]=y.useState({loading:!1,qrFailure:!1,qrCodeImageUrl:"",orderId:e.orderId||"",initRefresh:!1}),g=()=>{u.closeModal(Ve.PAY_MODAL)},_=async()=>{x("loading",!0),d.current&&clearTimeout(d.current),c.current&&clearInterval(c.current);const w=await t();if(!w.orderId){be.warning("刷新失败，请重新下单"),g();return}const E=await Z_.toDataURL("".concat(w.qrCodeUrl),{errorCorrectionLevel:"H"});c.current&&(c.current=setInterval(()=>void F("".concat(w.orderId)),3e3)),d.current&&!i&&(d.current=setTimeout(()=>{x("qrFailure",!0),c.current&&clearInterval(c.current),d.current&&clearTimeout(d.current)},10*60*1e3)),p({qrCodeImageUrl:i?"".concat(w.qrCodeUrl):E,orderId:w.orderId,qrFailure:!1,loading:!1,initRefresh:!1})},x=(w,E)=>{p(C=>({...C,[w]:E}))},F=async w=>{if(!f.current){if(f.current=!0,w){const E=await ve.infra.getOrderStatus.raw(w);if(E.code===200)switch(E.data.status){case 20:c.current&&clearInterval(c.current),d.current&&clearTimeout(d.current),be.success("订单支付成功"),g(),await(o==null?void 0:o()),uN.fireworks(),lN();break;case 30:x("qrFailure",!0),be.error("订单失效，请重新下单"),c.current&&clearInterval(c.current),d.current&&clearTimeout(d.current);break}else c.current&&clearInterval(c.current),d.current&&clearTimeout(d.current);x("loading",!1)}else g();f.current=!1}},b=()=>{x("loading",!0),x("initRefresh",!0),F(h.orderId)};return y.useEffect(()=>(c.current=setInterval(()=>{F(e.orderId)},3e3),d.current=setTimeout(()=>{x("qrFailure",!0),c.current&&clearInterval(c.current),d.current&&clearTimeout(d.current)},10*60*1e3),e.qrCodeUrl&&(i?x("qrCodeImageUrl",e.qrCodeUrl):Z_.toDataURL(e.qrCodeUrl,{errorCorrectionLevel:"H"}).then(w=>{x("qrCodeImageUrl",w)})),()=>{d.current&&clearTimeout(d.current)}),[]),r.jsxs("div",{className:"flex flex-col items-center justify-center py-7",children:[r.jsxs("div",{className:"text-h2",children:["支付金额：",r.jsx("span",{className:"text-active_color",children:n})]}),r.jsxs("div",{className:"text-h3 mb-5 flex items-center py-4 font-normal",children:[l?r.jsx(V,{name:"IcAlipayPay",size:"large",className:"mr-2 text-[#1677FF]"}):r.jsx(V,{name:"IcWechatPay",size:"large",className:"mr-2 text-[#07C160]"}),"请用",l?"支付宝":"微信","扫码完成支付"]}),r.jsxs("div",{className:"relative mx-20 mb-5 h-60 w-60",children:[h.qrFailure&&r.jsx("div",{className:"absolute top-0 left-0 flex h-full w-full items-center justify-center bg-black/75",children:r.jsxs("span",{className:"flex cursor-pointer items-center text-white",onClick:_,children:[r.jsx(V,{name:"IcMenuRelink",className:"mr-2 text-white",size:"normal"}),"刷新"]})}),r.jsx("img",{src:h.qrCodeImageUrl,alt:h.orderId,className:"h-full w-full"})]}),r.jsxs("div",{className:"text-t2-medium flex h-10 items-center justify-center text-grey3",children:[h.qrFailure?"二维码失效，请点击刷新":h.loading?"正在核实订单中...":h.initRefresh?"未查到付款记录":"支付后未跳转？",(!h.loading||h.qrFailure)&&r.jsx("div",{className:R("cursor-pointer underline"),onClick:b,children:"点我刷新"})]})]})},loe=e=>{var K;const{isFrom:t=Mt.dashboard_file,upgradeType:n}=e,{integralInfo:s}=Xw(),a=n==="ai",o=_o(),i=Za(),l=xc(),c=Dt(),d=ie(),[u,f]=y.useState(Cn.alipay);DO();const[h,p]=y.useState((K=e.planId)!=null?K:""),[g,_]=y.useState([]),x=LO(),F=sN(ve.infra.getCouponList),[b,w]=y.useState({}),[E,C]=y.useState(""),[k,T]=y.useState([]),[v,I]=y.useState(!0),j=b["".concat(h).concat(E)],S=g.find(W=>W.id===h),D=()=>{d.closeModal(Ve.UPGRADE_SUPPORT)},A=async()=>{var G,ee,te;if(!h)return;const W=await F(h,void 0,c.uuid);T((G=W.list)!=null?G:[]);const Y=ll((ee=W.list)==null?void 0:ee.filter(Q=>{var ne,se;return((ne=Q.integralRecord)!=null?ne:0)<=((se=s==null?void 0:s.currentScore)!=null?se:0)}));if(!Y){z("");return}(te=W.list)!=null&&te.some(Q=>Q.id===E)||z(Y.id)},P=W=>{I(!0),p(W)},L=async()=>{if(h&&c.uuid){const W=await x({spaceId:c.uuid,planId:h,couponId:E,date:0,people:0});h&&w(Y=>({...Y,["".concat(h).concat(E)]:{...W,planId:h}}))}I(!1)};tc(()=>{L()},[h,E],{wait:100});const O=W=>{const Y=g.find(G=>G.id===h);rN({bizType:"".concat(W,"_").concat(a?"ai":"file"),order_channel:u===Cn.alipay?"zhifubao":"weixin",is_from:t,order_amount:j==null?void 0:j.amount,order_capacity:Y==null?void 0:Y.amount,space_type:c.planType})};y.useEffect(()=>{A()},[h]);const $=y.useMemo(()=>j!=null&&j.desiredExpireTime?ue((j==null?void 0:j.desiredExpireTime)||Date.now()).format("YYYY年MM月DD日"):"",[j==null?void 0:j.desiredExpireTime]),M=()=>(a?ve.infra.createAiUsageOrder:ve.infra.createCapacityOrder)({spaceId:c.uuid,planId:h,couponId:E,payType:u}),U=async()=>{be.loading("正在创建订单"),I(!0),O("pay_order");const W=await M();if(I(!1),!W.orderId)return be.error("下单失败，请重试");d.modal({modalId:Ve.PAY_MODAL,content:()=>r.jsx(PO,{rePayOrder:M,onFinish:async()=>{O("order_finish"),D(),i(),a?await P5():await l(),await Ao(500),o({defaultMenuType:Kt.upgrade,from:Mt.pay})},payType:u,priceTitle:"".concat(io(j==null?void 0:j.amountUnit)).concat(W.amount),orderId:"".concat(W.orderId),qrCodeUrl:"".concat(W.qrCodeUrl)})})},z=(W="")=>{C(W)};return y.useEffect(()=>{(a?ve.infra.aiUsagePlanList:ve.infra.capacityPlanList)(c.uuid).then(Y=>{var te;const G=(te=Y.list)!=null?te:[],[ee]=G;ee&&(_(G),(!h||!G.map(Q=>Q.id).includes(h))&&p(ee.id))})},[c.uuid]),{currentPlan:S,getClientSecret:M,couponId:E,selectCoupon:z,onPay:U,close:D,payMethod:u,setPayMethod:f,planId:h,onSelectPlan:P,planList:g,couponList:k,curCalculateQuote:j,loading:v,lastDate:$}},LO=()=>sN(ve.infra.getQuote),BO=()=>vl(loe),OO=ve.infra.getNewPlanList,coe=()=>y.useCallback(async()=>{be.success("订单支付成功"),uN.fireworks(),await Ao(3e3),await lN()},[]),MO=y.memo(e=>{const{value:t,afterText:n,inputClassName:s,onChange:a,...o}=e;return r.jsx(Ct,{focusHiddenPlaceholder:!0,inputType:"number",placeholder:"自定义",showBorder:!1,value:t||"",inputClassName:Qv("h-9 text-center",s),onChange:i=>{const l=Math.max(0,Number(lL("".concat(i))));a==null||a(Number.isNaN(l)?0:l)},addonAfter:r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"h-4 w-px bg-black_006"}),r.jsx("span",{className:"flex h-full min-w-10 px-2 items-center justify-center",children:n})]}),...o})}),Qw=e=>{const{loadingIcon:t,className:n}=e,{handleAttachBottomDebounce:s,loadList:a,loading:o,more:i,placeholder:l,container:c,renderItem:d}=doe(e);return r.jsxs(xd,{initialLoad:!1,useWindow:!1,loadMore:s,getScrollParent:()=>c.current,hasMore:i,className:n,children:[a.map(d),i&&r.jsx("div",{className:"text-center text-grey3 my-4",children:t!=null?t:r.jsx($s,{size:"middle"})}),!a.length&&!i&&!o&&r.jsx("div",{className:"text-center text-grey3 my-4",children:r.jsx("div",{className:"ml-1 text-t2",children:l!=null?l:"暂无内容"})})]})},UO=e=>{const{getApi:t,className:n,dateList:s,titleList:a,modalHeader:o,placeholder:i}=e,l=y.useRef(null),c="repeat(".concat(a.length,", minmax(0, 1fr))");return r.jsxs(r.Fragment,{children:[o&&r.jsxs("div",{className:"py-2.5 px-5 text-t2 border-b flex items-center justify-between",children:[r.jsx("span",{className:"text-t2-medium",children:o.title}),r.jsx("span",{children:r.jsx(V,{className:"animate-hover",name:"IcToastClose",size:"middle",onClick:o.closeModal})})]}),r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid text-t2 gap-2.5 px-5 py-2.5 border-b",style:{gridTemplateColumns:c},children:a.map(d=>r.jsx("div",{className:"pr-5",children:d.title}))}),r.jsx("div",{className:R("max-h-120 overflow-auto p-5",n),children:r.jsx(Qw,{placeholder:i,container:l,className:"space-y-5",getApi:t,renderItem:(d,u)=>r.jsx("div",{className:"grid text-t2 gap-2.5",style:{gridTemplateColumns:c},children:s.map(f=>r.jsx("div",{className:R("pr-5",d.className),children:f.render(d,u)},f.id))})})})]})]})},doe=e=>{const{placeholder:t,container:n,getApi:s,renderItem:a}=e,[o,i]=y.useState([]),[l,c]=y.useState(!0),[d,u]=y.useState(!0),f=y.useRef(0),h=y.useCallback(async(_,x=30)=>{const F=await s({pageIndex:_,pageSize:x});_<=1?i(F.list):i(b=>[...b,...F.list]),u(F.more)},[s]),p=y.useCallback(async()=>{d&&(c(!0),f.current+=1,await h(f.current),c(!1))},[d,h]),g=y.useMemo(()=>qn(p,1e3),[p]);return FW(()=>{p()}),{handleAttachBottomDebounce:g,loadList:o,loading:l,more:d,placeholder:t,container:n,renderItem:a}},VO=(e,t)=>{var s;const n={};return(s=e.permissions)==null||s.forEach(a=>{if(a.type==="user"&&a.userId){const o=t[a.userId];o&&(n[a.userId]=o)}}),n},ba=()=>{const e=Dt();return Ce(t=>VO(e,t.users),[e])},sRe=()=>{const e=Pn();return VO(e,J.users)},_g=()=>y.useCallback((e,t)=>{re(Tw({uuid:e,patch:t}))},[]);var ro=(e=>(e[e.INIT=1]="INIT",e[e.CAN_USE=2]="CAN_USE",e[e.CAN_NOT_USE=3]="CAN_NOT_USE",e[e.LEN_NOT_RIGHT=4]="LEN_NOT_RIGHT",e[e.CHECKING=5]="CHECKING",e))(ro||{});const fT={1:"",2:"",3:"域名不可用，请更换",4:"域名不能超过30字符，至少4个字符",5:""},uoe=e=>{var gt,kt,At,Qt,nn,sn,ms,N,B,X,Z,oe,xe,Be,Le,bt,Ue,He,rt,je,le,Qe,Tt,Pt,cn;const{setClickMaskClose:t}=e,n=ai(),s=Za(),a=ie(),o=Ut(),i=a5(),l=ns(),c=g0(),d=ba(),u=Object.values(d),f=Oe(),h=Dt(),p=Id(),g=h.planType===St.freeTeam,[_,x]=y.useState(h.title),[F,b]=y.useState(h.domain),[w,E]=y.useState(h.domain),[C,k]=y.useState(h.publicHomePage),[T,v]=y.useState((kt=(gt=h==null?void 0:h.setting)==null?void 0:gt.showPublicHomePage)!=null?kt:!0),[I,j]=y.useState(h.icon),[S,D]=y.useState(ro.INIT),A=y.useRef(),[P,L]=y.useState(h.setting===null||typeof h.setting>"u"||!!h.setting.isShowBacklink),[O,$]=y.useState(!((At=p==null?void 0:p.setting)!=null&&At.closeTemplateRecommend)),M=X9(),[U,z]=y.useState(M),[K,W]=y.useState((nn=(Qt=h==null?void 0:h.setting)==null?void 0:Qt.enableAI)!=null?nn:!0),[Y,G]=y.useState((ms=(sn=p==null?void 0:p.setting)==null?void 0:sn.closePostFormNotification)!=null?ms:!1),[ee,te]=y.useState((B=(N=h==null?void 0:h.setting)==null?void 0:N.daySetting)!=null?B:m.DaySetting.MON),Q=h1(h.planType),ne=Q&&((Z=(X=h==null?void 0:h.setting)==null?void 0:X.abandonedPublicShare)!=null?Z:!1),se=Q&&((xe=(oe=h==null?void 0:h.setting)==null?void 0:oe.abandonedGuest)!=null?xe:!1),ce=Q&&((Le=(Be=h==null?void 0:h.setting)==null?void 0:Be.abandonedExport)!=null?Le:!1),ae=Q&&((Ue=(bt=h==null?void 0:h.setting)==null?void 0:bt.openWatermark)!=null?Ue:!1),de=Q&&((rt=(He=h==null?void 0:h.setting)==null?void 0:He.openImageWatermark)!=null?rt:!1);Q&&(le=(je=h==null?void 0:h.setting)==null?void 0:je.imageWatermarkText)!=null;const[ke,Te]=y.useState(Q&&(Tt=(Qe=h==null?void 0:h.setting)==null?void 0:Qe.imageWatermarkText)!=null?Tt:""),he=(cn=(Pt=h==null?void 0:h.setting)==null?void 0:Pt.commentAlignment)!=null?cn:"top",{editor:Ee}=pg(o.uuid),ge=_g(),Se=Lt=>{b(Lt),Lt||E(Lt),A.current&&(clearTimeout(A.current),A.current=void 0),A.current=setTimeout(()=>{if(!Lt){D(ro.INIT);return}if(Lt===h.domain&&S===ro.INIT)return;if(Lt.length<4||Lt.length>30){D(ro.LEN_NOT_RIGHT);return}if(Lt===h.domain){D(ro.CAN_USE);return}const Bn=Lt;D(ro.CHECKING),ve.infra.postSpaceDomainCheck.raw(Ot(),{domain:Lt}).then(Gt=>{setTimeout(()=>{Bn===Lt&&(Gt.code===200&&Gt.data?(D(ro.CAN_USE),E(Lt)):D(ro.CAN_NOT_USE))},500)})},800)};y.useEffect(()=>{t(_===h.title&&yn(I,h.icon))},[h.icon,h.title,I,t,_]);const Re=Ee&&!u.some(Lt=>Lt.spaceRole===m.PermissionRole.EDITOR&&Lt.uuid!==o.uuid),Ae=(Lt=h)=>{f(()=>{c(h.uuid,{...h,...Lt,setting:{...h.setting,...Lt.setting}})})};return{isGuest:n,spaceEditor:Ee,leavingSpace:async()=>{a.warning({title:"确定离开吗？",content:"离开后将不能再访问当前空间",confirmText:"确定离开",confirm:async()=>{await ve.infra.removeSpaceMembers(h.uuid,{userId:o.uuid}),be.success("你已离开该空间"),await p0(!0),Rb()||l.push(Nt.main)}})},handleDeleteSpace:async()=>{await i(),s()},saveSpaceSetting:(Lt=!0,Bn=!0)=>{const Gt=_.trim(),jr=fT[S];if(jr&&Bn){be.error(jr);return}hp(Gt,"").length>=2&&hp(Gt,"").length<=20?(f(()=>{Ae({title:Gt,icon:I,domain:w,publicHomePage:C,setting:{isShowBacklink:P,daySetting:ee,enableAI:K,commentAlignment:he,showPublicHomePage:T,inlinePageIcon:U,abandonedPublicShare:ne,abandonedGuest:se,abandonedExport:ce,openWatermark:ae,openImageWatermark:de,imageWatermarkText:ke}}),p&&ge(p.uuid,{setting:{closeTemplateRecommend:!O,closePostFormNotification:Y}})}),Lt&&s(),Bn&&be.success("保存成功")):Bn&&be.error("空间名称长度应为2-20个字符")},isLastEditorUser:Re,checkDomain:Se,spaceName:_,setSpaceName:x,domain:F,setDomain:b,finalDomain:w,setFinalDomain:E,publicHomePage:C,setPublicHomePage:k,showPublicHomePage:T,setShowPublicHomePage:v,icon:I,setIcon:j,domainStatus:S,setDomainStatus:D,showBackLink:P,setShowBackLink:L,enableRecommend:O,setRecommend:$,inlinePageIcon:U,setInlinePageIcon:z,enableAI:K,setAI:W,disableFormNotification:Y,setDisableFormNotification:G,startDay:ee,setStartDay:te,commentAlignment:he,freeTeam:g,abandonedPublicShare:ne,abandonedGuest:se,abandonedExport:ce,openWatermark:ae,openImageWatermark:de,imageWatermarkText:ke,setImageWatermarkText:Te}},foe=e=>{const{defaultUpgradeAiPanel:t=!1,defaultMenuType:n=Kt.account,from:s=Mt.package}=e,a=xc();Qu();const[o,i]=y.useState(n),[l,c]=y.useState(!0),[d,u]=y.useState(s),[f,h]=y.useState(t),p=x=>{u(x),i(Kt.upgrade),sT()},g=()=>{h(!0),i(Kt.upgrade)};y.useEffect(()=>{sT(),P5(),a(),XB()},[]);const _=uoe({setClickMaskClose:c});return{toUpgradeAi:g,checkoutUpgraded:p,currentSettingMenu:o,setCurrentSettingMenu:i,clickMaskClose:l,setClickMaskClose:c,isFrom:d,setIsFrom:u,upgradeAiPanel:f,setUpgradeAiPanel:h,spaceSettingState:_}},Ws=vl(foe),Jw=()=>an(Ws),moe={container:"px-[60px] flex-1 cursor-default flex flex-col overflow-y-auto pb-10",name:"mb-3.5 text-black",input:"w-full mb-3 h-9 flex-shrink-0"},hoe=e=>{const{confirm:t,cancel:n,confirmText:s,cancelText:a}=e;return r.jsxs("div",{className:"flex self-end py-3 px-[60px] w-full h-14 border-t border-grey7",children:[t&&r.jsx(De,{colorType:"active",...Gs(Hs.settingSave),onClick:t,className:"mr-[20px] text-t2-medium animate-click",children:s!=null?s:"保存"}),n&&r.jsx(De,{...Gs(Hs.settingCancel),onClick:n,className:"text-t2-medium animate-click",children:a!=null?a:"取消"})]})},poe=({title:e,name:t,addonAfter:n})=>r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex-shrink-0 flex items-center mb-1 text-grey3 h-9 text-t2 justify-between",children:[e,n]}),r.jsx(D0,{className:R(t&&"mb-2.5")}),t&&r.jsx("div",{className:"flex items-center h-9 text-black text-t2",children:t})]}),goe=e=>{const{leftChild:t,rightChild:n,children:s,className:a}=e;return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:R("py-2 flex items-center justify-between text-t2 flex-shrink-0",a),children:[r.jsx("div",{children:t}),r.jsx("div",{children:n})]}),s]})},_oe=({content:e,className:t,disabled:n,...s})=>r.jsxs("div",{className:R("flex items-center h-full text-t3",n?"opacity-60 cursor-not-allowed":"animate-click",t),...s,children:[r.jsx("span",{className:"mr-2",children:e}),r.jsx(V,{className:"text-grey3",name:"IcArrowDown01",size:"xxxsmall"})]}),xoe=()=>{const e=ie();return y.useCallback(t=>{const{list:n,active:s,onClick:a,event:o}=t;e.dropdown({popcorn:o.currentTarget,content:i=>r.jsx(ze,{className:"next-modal w-36 py-2.5",items:n.map((l,c)=>{var d;return{type:H.OPERATION,data:{title:l.title,value:l.value,selected:s===l.value,...(d=l.getDate)==null?void 0:d.call(l,c)}}}),onItemClick:async l=>{await a(l.data),i.onCloseModal()}})})},[e])},yoe=e=>{const{title:t,subTitle:n,openUpgradeModal:s,orderType:a}=e,o=ie(),i=y.useRef(null),l=Dt(),c=()=>{o.closeModal(Ve.ORDER_LIST_SUPPORT),s==null||s({isFrom:Mt.dashboard_ai})},d=async u=>{var p;const f=await ve.infra.getOrderList(u.pageIndex,u.pageSize,l.uuid,a);return{list:(p=f.list)!=null?p:[],more:f.more}};return r.jsxs("div",{className:"w-125 py-1",children:[r.jsxs("div",{className:"h-12 flex items-center justify-between px-7",children:[r.jsx("span",{className:"text-h4",children:t}),r.jsx("span",{className:"text-t2 animate-click text-active_color",onClick:()=>c(),children:n})]}),r.jsx(dt.SettingDivider,{}),r.jsxs("div",{className:"px-7 text-t2",children:[r.jsxs("div",{className:"grid grid-cols-6 h-10 items-center",children:[r.jsx("span",{className:"col-span-2",children:"套餐类型"}),r.jsx("span",{className:"col-span-2",children:"使用状态"}),r.jsx("span",{className:"col-span-2",children:"到期时间"})]}),r.jsx(dt.SettingDivider,{}),r.jsx("div",{ref:i,className:"max-h-120 overflow-y-auto",children:r.jsx(Qw,{container:i,getApi:d,placeholder:"无购买记录",renderItem:u=>r.jsxs("div",{className:R("grid grid-cols-6 h-10 items-center",u.status!==20&&"opacity-30"),children:[r.jsx("span",{className:"col-span-2",children:u.description}),r.jsx("span",{className:"col-span-2",children:u.status===20||u.expirationTime&&u.expirationTime<Date.now()?"使用中":"已过期"}),r.jsx("span",{className:"col-span-2",children:ue(u.subscriptionEndDate).format(On)})]},u.id)})})]})]})},boe=({className:e})=>r.jsx(V,{className:R("text-grey3",e),name:"IcArrowDateNext",size:"small"}),dt={commonStyles:moe,FooterBar:hoe,SettingDivider:D0,Header:poe,Item:goe,DropdownButton:_oe,Arrow:boe},Foe=(e,t)=>{console.log("调用dsBridge callNativeAsync params: ",e),wW.call("callNativeAsync",e,n=>{console.log("dsBridge app 回调",n),console.log("JSON.parse(res): ",JSON.parse(n)),t==null||t(JSON.parse(n||"{}"))})},R0=e=>{const t=_d();return y.useCallback((n,s)=>{const o=new URLSearchParams(e!=null?e:t.search).get(n);return o||s},[t.search,e])},woe=e=>{const t=R0(e);return y.useCallback(async()=>{let n=t(dn.callbackPath);if(n){const s="/share/";if(n.startsWith(s)){const a=n.slice(s.length);(await Db(a)).code===200&&(n=n.replace("/share",""))}Er(n);return}Er(Nt.main)},[t])},Eoe=(e,t)=>{const n=woe(),s=y.useRef(),a=y.useRef(!1),o=y.useRef(t);o.current=t,y.useEffect(()=>{if(!e)return;const i=async()=>{const l=await ve.infra.getOrderStatus.raw(e);if(l.code===200)switch(l.data.status){case 20:{be.success("支付成功"),await es(1e3),o.current(),n();break}case 30:{s.current&&clearInterval(s.current);break}}};return s.current=setInterval(()=>{if(!a.current)try{a.current=!0,i()}finally{a.current=!1}},5e3),()=>{clearInterval(s.current)}},[n,e])},Coe=()=>location.href.includes("~~debug~~");var mT=(e=>(e.title="t",e.code="code",e.type="type",e.payAI="pai",e.spaceId="sid",e.subscribePage="sp",e.planId="pid",e.pageId="pageId",e.upgrade="upgrade",e.orderId="orderId",e))(mT||{});const $O=()=>window.wx,koe=e=>{const{path:t}=e;let{search:n=""}=e;n&&!n.startsWith("?")&&(n="?".concat(n)),$O().miniProgram.navigateTo({url:"".concat(t).concat(n)})},Toe=e=>{const t=["type=".concat(e.type)];e.type==="sp"&&t.push("pageId=".concat(e.pageId)),["pai","sid"].includes(e.type)&&(t.push("pid=".concat(e.planId)),t.push("sid=".concat(e.spaceId))),e.code&&t.push("code=".concat(e.code)),e.orderId&&t.push("orderId=".concat(e.orderId)),koe({path:"/pages/pay/index",search:t.join("&")})},voe=async e=>{const t=e==null?void 0:e.imgUrl,n=$O();if(!n)return;const s=await Zt.request.infra.getWechatSign.raw();if(s.code!==200)return;const a=s.data;if(n.config({debug:Coe(),appId:"wx1736ff051cca370b",timestamp:a.timestamp,nonceStr:a.nonceStr,signature:a.signature,jsApiList:["checkJsApi","updateAppMessageShareData","updateTimelineShareData"]}),t){const o={title:document.title,desc:e==null?void 0:e.desc,link:location.href,imgUrl:t};n.ready(()=>{n.updateAppMessageShareData(o),n.updateTimelineShareData(o)})}};qn(voe,3e3,{leading:!1,trailing:!1});const Ioe=()=>{const e=ie();return y.useCallback(async t=>{if(Fb&&!xb()){wQ(JY,{type:mT.upgrade,payType:Cn.wxjsapi,planId:t.planId,spaceId:t.spaceId,couponId:t.couponId,date:t.date?"".concat(t.date):void 0,people:t.people?"".concat(t.people):void 0});return}let n=t.preOrder;if(!n&&t.createOrder&&(n=await(t==null?void 0:t.createOrder())),!!n){if(t.onCreateOrderId(n.orderId),xb()){Toe({type:mT.orderId,orderId:n.orderId}),e.warning({title:"已唤起微信支付",content:"是否已完成支付？",confirmText:"已完成",cancelText:"未完成",confirm:()=>location.reload(),cancel:()=>location.reload()});return}if(n.qrCodeUrl){const s="".concat(n.qrCodeUrl);if(t.selectPayType===Cn.alipay){location.href=s;return}location.href=s}}},[e])},Noe=e=>{me.event("support_clk"),e.modal({content:()=>r.jsxs("div",{className:"p-12 pt-10 flex flex-col items-center",children:[r.jsx("div",{className:"text-h4",children:"请用微信手机端扫码咨询客服"}),r.jsx("img",{className:"mt-6 p-3 bg-white-base",width:"230px",height:"230px",src:"https://work.weixin.qq.com/kf/kefu/qrcode?kfcode=kfcdde5f9fac82bd755"})]})})},HO=e=>{const{price:t,endTime:n,remark:s,changePayType:a,customFooter:o,onCloseModal:i,onFinish:l}=e,c=y.useRef(),d=ie(),u=y.useRef(!1),f=p=>{p?(u.current=!0,ve.infra.getOrderStatus.raw(p).then(async g=>{if(g.code===200)switch(g.data.status){case 20:c.current&&clearInterval(c.current),await p0(),i(),uN.fireworks(),l==null||l(),be.success("订单支付成功");break;case 30:be.error("订单失效，请重新下单"),c.current&&clearInterval(c.current);break;case 10:u.current=!1;break}else c.current&&clearInterval(c.current)})):i()},h=()=>{Xt("转账金额：".concat(t,"\n收款方帐户名：云上绿洲（杭州）科技有限公司\n收款方帐户：110944870510101\n开户行：招商银行股份有限公司北京分行望京融科支行\n转账备注：").concat(s))};return y.useEffect(()=>(c.current=setInterval(()=>{u.current||f(e.orderId)},3e3),()=>{c.current&&clearInterval(c.current)}),[e.orderId]),r.jsxs("div",{className:"w-[550px] px-12 pt-6 pb-10 text-center",children:[r.jsx("div",{className:"text-h2 mb-6",children:"购买团队版"}),r.jsxs("div",{className:"mb-2.5 text-t2-medium",children:["请于",r.jsxs("span",{className:"text-blue",children:[ue(n).format(On),"之前"]}),"完成转账，转账时请备注订单，我们会在确认到账后2个工作日内开通服务。"]}),r.jsxs("div",{className:"text-t4 text-grey3 mb-7",children:["如有任何疑问，请立即联系",r.jsx("span",{className:"border-b border-grey3 cursor-pointer",onClick:()=>{Noe(d)},children:"在线客服"}),"帮你解决。"]}),r.jsxs("div",{className:"border border-black/10 rounded py-4 px-5 mb-2.5 relative",children:[r.jsx("div",{className:"flex items-center h-10",children:r.jsx(De,{onClick:h,children:"复制帐户信息"})}),[{title:"转账金额",content:t},{title:"收款方帐户名",content:"云上绿洲（杭州）科技有限公司"},{title:"收款方帐户",content:"110944870510101"},{title:"开户行",content:"招商银行股份有限公司北京分行望京融科支行"},{title:"转账备注",content:s}].map(p=>r.jsxs("div",{className:"flex items-center justify-between h-10 text-t2 text-grey3",children:[r.jsx("span",{children:p.title}),r.jsx("span",{className:"text-t2-medium text-black",children:p.content})]},p.title)),r.jsx("img",{src:vn.orderRemarks,className:"absolute -bottom-6 right-3 pointer-events-none"})]}),r.jsx("div",{className:"text-red text-t2 text-right pr-20",children:"记得填写备注，否则无法确定到账！"}),r.jsx("div",{className:"flex items-center justify-center my-4",children:o})]})},joe=({onCloseModal:e})=>r.jsxs("div",{className:"flex flex-col items-center py-10 px-20",children:[r.jsx("div",{className:"text-h3 mb-5",children:"恭喜升级成功！"}),r.jsx("div",{className:"text-t1 mb-2.5",children:"添加你的客户经理获取发票和合同"}),r.jsx("img",{src:vn.teamWechatQr,className:"mb-7 w-60 h-60"}),r.jsx(De,{colorType:"active",className:"w-full",onClick:()=>e(),children:"确定"})]}),Soe=()=>{const e=ie();return()=>{e.modal({modalId:"paySuccess",content:({onCloseModal:t})=>r.jsx("div",{children:r.jsx(joe,{onCloseModal:t})})})}};var Uh=(e=>(e[e.people=0]="people",e[e.time=1]="time",e))(Uh||{});const Doe=e=>{var he,Ee;const{isFrom:t,selectPlanType:n}=e,s=n===St.team,a=s?oN:iN;DO();const o=_o(),i=Ur(),{integralInfo:l}=Xw(),c=(he=l==null?void 0:l.currentScore)!=null?he:0,d=Soe(),u=ie(),f=sN(ve.infra.getCouponList),h=Dt(),p=ba(),g=jo(p),_=y.useRef(),x=LO(),F=Zo(n),{spacePlan:b,currentPlan:w}=Qu(),E=Ioe(),[C,k]=y.useState();Eoe(C,async()=>{de("order_finish"),be.success("支付成功"),se(),Foe({event:B9.CLOSE_WINDOW})});const T=s&&((b==null?void 0:b.planType)===St.pro||(b==null?void 0:b.planType)===St.smallTeam),v=n===h.planType,I=v?"续费“".concat(F,"”"):"升级到“".concat(F,"”"),j=i?Math.max((Ee=w==null?void 0:w.members.max)!=null?Ee:0,g.length):g.length,S=Math.max(g.length),[D,A]=y.useState(!0),[P,L]=y.useState([]),[O,$]=y.useState([]),[M,U]=y.useState({customPeople:Math.max(j,LY),selectedPayType:Fb?Cn.wxpay:Cn.alipay,selectedRenewalType:1,addPeople:1,selectedTime:{type:"fixed",value:12},couponId:void 0}),z=O.find(ge=>ge.id===M.couponId),[K,W]=y.useState(),Y=y.useMemo(()=>{if(!(K!=null&&K.desiredExpireTime))return{day:0};const ge=Date.now(),Se=new Date(K.desiredExpireTime),Re=ue(Se).diff(ge,"year"),Ae=ue(ge).add(Re,"year"),Me=ue(Se).diff(Ae,"day");return{year:Re,day:Me,totalDay:ue(Se).diff(ge,"day")}},[K==null?void 0:K.desiredExpireTime]),G=(ge=M)=>{var Ge;ge=Br(ge);const Se=P.find(tt=>{const gt=tt.planType;if(v){if(ge.selectedRenewalType===0)return gt===a.renewPeople;if(ge.selectedRenewalType===1)return gt===a.renewTime&&tt.monthNum===ge.selectedTime.value}return gt===a.upgrade&&tt.monthNum===ge.selectedTime.value});let Re=ge.selectedTime.type==="custom"?ge.customTime:ge.selectedTime.value;Re&&Re%12===0&&(Re=Re/12);let Ae=0,Me=ge.customPeople||j;return v?ge.selectedRenewalType===0?(Ae=ge.addPeople,Me=ge.addPeople+j,Re=0):Ae=j:Ae=ge.customPeople||0,{addPeople:Ae,currentPlan:Se,planId:(Ge=Se==null?void 0:Se.id)!=null?Ge:"",date:Re!=null?Re:0,people:Me}},ee=async(ge=M)=>{const{planId:Se,date:Re,people:Ae}=G(ge);return Se?await x({planId:Se,date:Re,people:Ae,spaceId:h.uuid,couponId:ge.couponId}):void 0},te=async(ge=M)=>{const{planId:Se}=G(ge);if(!Se)return;const Re=setTimeout(()=>{A(!0),clearTimeout(Re)},800),Ae=await ee(ge);clearTimeout(Re),W(Ae),A(!1)},Q=async(ge=M,Se=0)=>{var Ge;const{planId:Re,date:Ae}=G(ge);let Me=ge.couponId;if($([]),Re){const tt=await f(Re,lL("".concat(Ae*12)),h.uuid),gt=cL(tt.list,At=>{var Qt;return((Qt=At.integralRecord)!=null?Qt:0)<=c});if($((Ge=tt.list)!=null?Ge:[]),!gt.find(At=>At.id===ge.couponId)){const At=ll(gt);At?(ne("couponId",At.id),Me=At.id):ne("couponId","")}}te({...ge,couponId:Me})};y.useEffect(()=>{OO(h.uuid,n).then(ge=>{const Se=ge.list||[];Se.find(Ae=>Ae.monthNum===36)&&ne("selectedTime",{type:"fixed",value:36}),L(Se)}),me.event("payorder_show",{is_from:t})},[h.uuid,t,n]),tc(()=>{var ge;P.length!==0&&((ge=ee({...M,couponId:void 0}))==null||ge.then(Se=>{Q(M,Se==null?void 0:Se.amount)}))},[P.length,M.customTime,M.selectedTime,M.selectedRenewalType,M.addPeople,M.customPeople],{wait:500}),tc(()=>{P.length!==0&&te(M)},[M.couponId],{wait:500});const ne=(ge,Se)=>{U(Re=>({...Re,[ge]:Se}))},se=()=>{u.closeModal(Ve.SELECT_UPDATE_PLAN)},ce=ge=>{ve.infra.cancelOrder(ge)},ae=async()=>{const{date:ge,planId:Se,people:Re}=G();let Ae=M.selectedPayType;js&&Ae===Cn.wxpay&&(xb()?Ae=Cn.minipay:Fb?Ae=Cn.wxjsapi:Ae=Cn.wxpayH5);const Me=await ve.infra.createPreOrderV2.raw({payType:Ae,spaceId:h.uuid,couponId:M.couponId,planId:Se,date:ge,people:Re});if(u.closeModal("payLoading"),Me.code===200)return Me.data;throw new Error("下单失败")},de=ge=>{const Se=v?"yes":"no";rN({bizType:ge,order_amount:K==null?void 0:K.amount,order_month:(Y.year||0)*12,order_channel:M.selectedPayType===Cn.offline?"card":M.selectedPayType===Cn.alipay?"zhifubao":"weixin",is_from:t,order_new:Se,order_type:"single",coupon_type:bae(z==null?void 0:z.type),coupon_amount:z==null?void 0:z.salePrice,pay_point:z==null?void 0:z.integralRecord,space_current_type:h.planType,space_target_type:n})},ke=async()=>{const{planId:ge,date:Se,people:Re}=G();await E({createOrder:ae,onCreateOrderId:Ae=>{de("pay_order"),k(Ae)},selectPayType:M.selectedPayType,spaceId:h.uuid,planId:ge,couponId:M.couponId,date:Se,people:Re})};return{sendOrderBizTracker:de,selectPlanSpaceType:n,couponList:O,state:M,patchState:ne,calculateQuote:K,inputCustomPeopleTimer:_,spaceMaxPeople:j,completionTime:Y,loading:D,getOrderParams:G,payOrder:async()=>{var Re;if(M.selectedPayType===Cn.offline&&(Re=(await ve.infra.getOrderList(1,1,h.uuid)).pendingList)!=null&&Re[0]){u.warning({title:r.jsx("div",{className:"mb-3",children:"请先处理未完成订单"}),confirmText:"去查看",confirm:()=>{se(),o({defaultMenuType:Kt.order,from:Mt.order})}});return}if(js){u.closeModal(Ve.PAY_MODAL),await ke();return}u.loading({modalId:"payLoading",title:"正在下单"});const ge=await ae();u.closeModal(Ve.PAY_MODAL);const Se=async()=>{de("order_finish"),se(),await es(1e3),o({defaultMenuType:Kt.upgrade,from:Mt.pay}),d()};de("pay_order"),Cn.offline===M.selectedPayType?u.modal({keyboard:!1,content:({onCloseModal:Ae})=>{var Me;return r.jsx(HO,{onCloseModal:Ae,onFinish:Se,orderId:ge.orderId,price:ge.amount||0,endTime:(Me=ge.expirationTime)!=null?Me:0,remark:ge.remark,changePayType:()=>{Ae(),ce(ge.orderId)}})}}):u.modal({keyboard:!1,modalId:Ve.PAY_MODAL,content:()=>r.jsx(PO,{onFinish:Se,qrCodeUrl:"".concat(ge.qrCodeUrl),orderId:ge.orderId,payType:M.selectedPayType,priceTitle:"".concat(io(K==null?void 0:K.amountUnit)).concat(ge.amount),rePayOrder:ae,changePayType:()=>{ce(ge.orderId)}})})},upgradeTitle:I,close:se,currentCoupon:z,upgradePlanName:F,checkoutOrder:ae,isRenew:v,spaceMinPeople:S,isNeedPayDiff:T,planList:P}},zO=vl(Doe),$m=()=>an(zO),Aoe=()=>{const e=ie(),{currentPlan:t}=Qu(),n=ba(),{handleSubmit:s,register:a}=Jv(),o=Dt();return y.useCallback(()=>{var c;const i=jo(n),l=Math.max((c=t==null?void 0:t.members.max)!=null?c:0,i.length);e.modal({className:"p-5",content:d=>r.jsxs("form",{className:"space-y-1 w-72 text-t2",onSubmit:s(async u=>{if(u.people>l){be.error("调整人数不能超过当前空间最大可用人数");return}if(u.people<i.length){be.error("不能少于当前空间实际人数，请先移除多余成员");return}await ve.infra.changeSpaceVersion({spaceId:o.uuid,toPeopleNum:u.people}),be.success("调整成功"),await es(1e3),location.reload(),d.onCloseModal()}),children:[r.jsx("div",{className:"text-t1-medium mb-4",children:"减少人数"}),r.jsx("div",{children:"当前空间最大可用人数为 ".concat(l," 人")}),r.jsx("div",{children:"实际有 ".concat(i.length," 人")}),r.jsx("div",{children:"请谨慎确认需要缩减到多少人，操作不可撤销"}),r.jsx("div",{className:"py-2.5",children:r.jsx(y3,{inputProps:a("people",{required:!0}),autoFocus:!0,className:"h-8 text-left",maxLength:6,type:"number",placeholder:"请输入目标人数"})}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx(De,{colorType:"active",children:"确认"}),r.jsx(De,{onClick:u=>{u.stopPropagation(),u.preventDefault(),d.onCloseModal()},children:"取消"})]})]})})},[t==null?void 0:t.members.max,o.uuid,s,e,a,n])},Roe=e=>r.jsx(zO,{...e,children:r.jsx(Moe,{})}),Poe=y.memo(()=>{const{isRenew:e,isNeedPayDiff:t}=$m();return t?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"text-t2 text-grey3 space-y-1",children:[r.jsx("div",{children:"正在升级套餐计划，请支付订单完成版本转换"}),r.jsx("div",{children:"订单完成后，您可以选择增加人数或者续费有效期"})]}),r.jsx(hT,{readonly:!0})]}):e?r.jsx(Boe,{}):r.jsxs(r.Fragment,{children:[r.jsx(qO,{}),r.jsx(hT,{})]})}),qO=y.memo(()=>{const{state:e,patchState:t,calculateQuote:n,planList:s}=$m(),a=y.useMemo(()=>r.jsx("div",{className:"grid text-center grid-cols-3 w-full gap-2.5",children:[{title:"3 年",value:36},{title:"每年",value:12},{title:"每月",value:1}].map((o,i)=>{const l=e.selectedTime.value===o.value,c=s.find(u=>u.monthNum===o.value),d=c==null?void 0:c.label;return c?r.jsxs("div",{className:R("flex items-center px-2 py-2.5 justify-center animate-click border border-grey5 rounded relative",l&&"border-black"),onClick:()=>t("selectedTime",{type:"fixed",value:o.value}),children:[o.title,d&&r.jsx(Cae,{children:d})]},i):null})}),[t,s,e.selectedTime.value]);return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 flex h-9 items-center",children:"购买时长"}),r.jsx("div",{className:"text-t2 py-2.5",children:a}),r.jsxs("div",{className:"text-t2 py-2 text-grey3",children:["购买后有效期至",ue(n==null?void 0:n.desiredExpireTime).format("YYYY年MM月DD日")]})]})}),hT=y.memo(e=>{const{readonly:t}=e,{state:n,patchState:s,spaceMinPeople:a,inputCustomPeopleTimer:o,spaceMaxPeople:i}=$m(),l=Ur(),c=Aoe();return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 mt-2.5 flex h-9 items-center",children:"购买人数"}),r.jsx("div",{className:"py-2.5 pr-4 w-full",children:r.jsx(MO,{showBorder:!0,readonly:t,className:R("border-[1.5px] border-grey5",t&&"pointer-events-none opacity-30"),value:n.customPeople,afterText:"人",onChange:d=>{s("customPeople",Math.min(Math.max(d,0),99999)),o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{o.current&&clearTimeout(o.current);const u=Math.max(d,a);u>d&&be.warning("当前空间人数为".concat(a,"人，请先移除多余成员")),s("customPeople",Math.min(u,99999))},1e3)}})}),r.jsxs("div",{className:"text-t2 py-2 text-grey3",children:[r.jsx("span",{children:"购买后上限".concat(n.customPeople,"人，当前上限").concat(i,"人。")}),l&&r.jsx("span",{className:"text-active_color animate-click",onClick:c,children:"减少人数"})]})]})}),Loe=y.memo(()=>{const{state:e,patchState:t,spaceMaxPeople:n}=$m();return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 mt-2.5 flex h-9 items-center",children:"添加人数"}),r.jsx("div",{className:"w-1/2 py-2.5 pr-4",children:r.jsx(MO,{showBorder:!0,className:"border-[1.5px] border-grey5",value:e.addPeople,afterText:"人",onChange:s=>{t("addPeople",Math.min(Math.max(s,1),99999-n))}})}),r.jsx("div",{className:"text-t2 py-2 text-grey3",children:"购买后上限".concat(n+e.addPeople,"人，当前上限").concat(n,"人。")}),r.jsx("div",{className:"text-t2 mt-2.5 flex h-9 items-center",children:"添加人数"})]})}),Boe=y.memo(()=>{const{state:e,patchState:t,completionTime:n,calculateQuote:s}=$m();return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 flex h-9 items-center",children:"购买类型"}),r.jsx("div",{className:"text-t2 grid grid-cols-2 gap-2.5 py-2.5",children:[{type:Uh.people,text:"席位"},{type:Uh.time,text:"时长"}].map(a=>r.jsxs("div",{onClick:()=>t("selectedRenewalType",a.type),className:R("text-t2-medium animate-hover flex p-2 items-center justify-center border-[1.5px] border-grey5",e.selectedRenewalType===a.type&&"border-black"),children:["增加 ",a.text]},a.type))}),r.jsx("div",{className:"text-t2 py-2 text-grey3",children:e.selectedRenewalType===Uh.people?"只增加当前空间的人数，不调整到期时间。":"只增加当前空间的到期时间，不调整人数。"}),e.selectedRenewalType===Uh.people?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 mt-2.5 flex h-9 items-center",children:"购买时长"}),r.jsxs("div",{className:"text-t2 my-2.5 mr-4 flex h-10 w-2/4 items-center justify-center rounded border-[1.5px] border-grey6 text-black/30 space-x-0.5",children:[!!n.year&&r.jsxs(r.Fragment,{children:[r.jsx($b,{value:n.year}),r.jsx("span",{children:"年"})]}),!!n.day&&r.jsxs(r.Fragment,{children:[r.jsx($b,{value:n.day}),r.jsx("span",{children:"天"})]})]}),r.jsxs("div",{className:"text-t2 py-2 text-grey3",children:["为保证所有空间成员到期时间均为"," ",ue(s==null?void 0:s.desiredExpireTime).format("YYYY年MM月DD日"),"，新成员需购买到期剩余时长。"]}),r.jsx(Loe,{})]}):r.jsxs(r.Fragment,{children:[r.jsx(qO,{}),r.jsx(hT,{readonly:!0})]})]})}),Ooe=y.memo(()=>{var w;const{upgradePlanName:e,calculateQuote:t,state:n,getOrderParams:s,completionTime:a,isRenew:o,isNeedPayDiff:i}=$m(),l=s(),c=((w=l.currentPlan)==null?void 0:w.monthNum)||1,d=o&&n.selectedRenewalType===Uh.people||i,u=d?"天":uT(c),f=Woe(),{date:h}=f(c<12,t,l.currentPlan),p=u,g=a.year?"".concat(a.year," 年"):"",_=a.day?"".concat(a.day," 天"):"",x=d?l.addPeople:l.people,F=["".concat(x," 人 × ").concat(h," ").concat(p)],b=["".concat(x," 人 × ").concat(g," ").concat(_)];return r.jsx(ha.OrderInfo,{payType:n.selectedPayType,className:"space-y-2",planName:e,price:t==null?void 0:t.amount,priceUnit:t==null?void 0:t.amountUnit,info:d?b:F})}),Moe=y.memo(()=>{const{loading:e,upgradeTitle:t,close:n,payOrder:s,state:a,getOrderParams:o,patchState:i,couponList:l,isNeedPayDiff:c}=$m(),{currentPlan:d}=o(),u=d==null?void 0:d.payList;Cn.stripe,Cn.yoomoneyRu,Cn.sbpRu,Cn.cardRu;const f=js?[]:[Cn.alipay,Cn.wxpay,Cn.offline];js&&(Fb||f.push(Cn.alipay),f.push(Cn.wxpay));const h=f.filter(g=>{var _;return(_=u==null?void 0:u.includes(g))!=null?_:!0}),p=[];return r.jsxs("div",{className:"flex flex-col",children:[r.jsx(ha.Header,{close:n}),r.jsxs(ha.BODY,{className:R("px-8 pt-2.5 pb-0",js&&"px-6",e&&"animate-pulse"),children:[r.jsxs("div",{className:R("grid grid-cols-2 gap-5 pb-5",{"grid-cols-1":js}),children:[r.jsxs("div",{children:[r.jsx(sa,{height:54,className:"text-h2",children:t}),r.jsx(Poe,{})]}),r.jsxs("div",{className:"space-y-2 bg-grey9 px-6 pb-4",children:[r.jsx(ha.SelectPay,{active:a.selectedPayType,payList:h,onChange:g=>i("selectedPayType",g)}),!c&&r.jsx(aN,{onSelectId:g=>i("couponId",g),couponList:l,selectId:a.couponId,className:"my-2.5"}),r.jsx(Ooe,{})]})]}),r.jsx(ha.StripePayBar,{protocols:p,onClick:s})]})]})}),Uoe=e=>r.jsx(Roe,{...e}),Zw=()=>{const e=ie();return y.useCallback((t,n)=>{const s=n||Mt.package;me.event("pay_show",{is_from:s}),e.modal({modalId:Ve.SELECT_UPDATE_PLAN,className:R("max-h-[90vh] overflow-auto w-[860px]",js&&"max-h-screen h-screen fade-in w-full"),keyboard:!1,content:()=>r.jsx(Uoe,{selectPlanType:t,isFrom:s})})},[e])},$e=r.jsx(V,{name:"IcCheck02",size:"middle"}),Sr=r.jsx(V,{name:"IcCheck02",size:"middle",className:"text-active_color"}),QD=r.jsx("span",{className:"text-active_color",children:"无限次"}),Vt=(e,t,n)=>r.jsx(Fe,{popup:n,className:R(t&&"cursor-pointer border-b border-grey6"),children:r.jsx("a",{href:t||void 0,target:"_blank",rel:"noreferrer",children:e})}),Voe={title:r.jsx("span",{className:"text-black",children:"AI 权益"}),data:[[Vt("总次数"),"5次/月",QD,QD],[Vt("AI 问问空间","","AI 将基于空间内容进行回答"),$e,Sr,Sr],[Vt("AI 问问知识库","","AI 将基于知识库的精选免费内容进行回答。"),$e,Sr,Sr],[Vt("AI 问问我的订阅","","AI 将基于订阅的内容进行回答。"),"",Sr,Sr],[Vt("AI 写文章"),$e,Sr,Sr],[Vt("AI 续写"),$e,Sr,Sr],[Vt("AI 翻译"),$e,Sr,Sr],[Vt("AI 总结"),$e,Sr,Sr],[Vt("AI 摘要"),$e,Sr,Sr],[Vt("AI 解释"),$e,Sr,Sr],[Vt("AI PDF 总结"),$e,Sr,Sr]]},$oe=()=>{const e=[Voe,{title:"用量",data:[[Vt("页面/块数量"),"5000","无限","无限"],[Vt("空间成员人数","".concat(Od,"/share/12a522e8-cf0d-4959-af83-28276ead05e6"),"可邀请团队伙伴加入空间实现团队内部的高效协作"),"无限","无限","无限"],[Vt("外部协作人数","".concat(Od,"/share/b987ee4d-ee13-44d2-96a9-07161675ae13"),"可邀请外部临时人员加入空间的指定页面协作，适用于跨团队协作、客户沟通等场景"),"5","100","1000"],[Vt("文件上传","","上传单个图片或文件附件的大小限制"),"2MB","5GB","5GB"],[Vt("存储容量"),zB,"200GB","300GB"],["思维导图节点数","300","无限","无限"],["单个块字数限制","100000","100000","100000"]]},{title:"基础",data:[[Vt("多端同步（Web+APP）","","支持全平台客户端使用，Windows / Mac / iOS / Android"),$e,$e,$e],[Vt("全文搜索","","页面内容层面的搜索"),$e,$e,$e],[Vt("页面动态","","支持查看页面所有具体编辑记录，便于协作时追溯"),$e,$e,$e],[Vt("页面历史","","页面每隔一段时间会保存页面版本，可查看或返回到过去任意一个版本"),"","30天","180天"],[Vt("引用建议","","当页面内容与其它页面标题存在隐含关联时进行的自动推荐，辅助知识点串联"),"",$e,$e],[Vt("文件批量下载"),"",$e,$e]]},{title:"分享与协作",data:[[Vt("分享链接","","支持公开分享页面 / 文件夹 / 单文件"),$e,$e,$e],[Vt("分享链接密码访问","","支持为公开分享的页面设置访问密码，就像网盘分享一样"),$e,$e,$e],[Vt("自定义空间域名","","如，英文域名.flowus.cn 的自定义空间域名"),$e,$e,$e],[Vt("分享页支持订阅","","其他人登陆后可以订阅此页面"),$e,$e,$e],[Vt("分享链接有效期","","有效期过后分享会自动关闭"),"",$e,$e],[Vt("关闭分享页底部广告"),"",$e,$e],[Vt("单页面外部协作","","单个页面可加入的外部协作者人数上限"),"5","100","1000"],[Vt("公共模板","","将页面设置为可快速创建的公共模板"),"5","无限","无限"],[Vt("公开主页","","如，英文域名.flowus.cn 的自定义空间域名"),"",$e,$e],["团队协作",$e,$e,$e],["团队空间",$e,$e,$e]]},{title:"安全与权限管理",data:[["页面权限管理",$e,$e,$e],["空间成员管理",$e,$e,$e],["空间成员分组","",$e,$e],[r.jsx("div",{className:"whitespace-normal",children:"空间安全设置(空间水印/禁止协作分享等)"}),"","",$e]]},{title:"更多功能",data:[[Vt("多维表全部属性","".concat(Od,"/share/6a17bdee-5155-4569-9715-5ad894b0f4dd"),"支持18种属性类型，广泛适用于各类场景"),$e,$e,$e],[Vt("多维表全部视图","".concat(Od,"/share/6a17bdee-5155-4569-9715-5ad894b0f4dd"),"支持7种视图，同组数据多种展现形式"),$e,$e,$e],[Vt("多维表单附件","","多维表媒体属性上传单个文件附件的大小限制"),"2MB","5GB","5GB"],[Vt("文件/文件夹管理","".concat(Od,"/share/fa4ab5ea-075f-4ccc-8e70-a112186310f3"),"支持在页面中插入文件，或通过文件夹形式管理文件"),$e,$e,$e],[Vt("引用页面和双向链接","".concat(Od,"/share/ef1a1829-baf5-4d92-bb9f-55a16e07219f"),"支持引用已有页面以及查看被引用情况，便于网状式管理内容"),$e,$e,$e],[Vt("文件预览","".concat(Od,"/share/771003b8-40d9-4f59-8d3a-99a690338fbe"),"支持PDF/Office/图片/视频等类型在线预览"),$e,$e,$e],[Vt("微信剪藏"),$e,$e,$e],[Vt("全部模板","".concat(Od,"/template"),"通过借鉴优质模板，更好更快上手使用"),$e,$e,$e],["夜间模式",$e,$e,$e],[Vt("字体/页面排版"),"",$e,$e],["拷贝到空间","3次/月","无限","无限"]]}];return Vt("页面/块数量"),Vt("空间成员人数","","可邀请团队伙伴加入空间实现团队内部的高效协作。"),Vt("外部协作人数","","可邀请外部临时人员加入空间的指定页面进行协作，适用于跨团队协作和客户沟通等场景。"),Vt("空间存储容量","","空间所有图片或文件附件的容量限制。"),Vt("单个文件上传","","上传单个图片或文件附件的大小限制。"),Vt("思维导图节点数","","思维导图可添加的节点数量限制。"),Vt("多端同步（Web+APP）","","支持全平台客户端使用，支持 iOS / Android 实时同步。"),Vt("全文搜索","","支持全局搜索空间内所有页面文本。"),Vt("页面动态","","页面每隔一段时间会保存编辑动态。"),Vt("页面历史","","页面每隔一段时间会保存页面版本，可查看或返回到过去任意一个版本。"),Vt("引用建议","","当页面内容与其它页面标题存在隐含关联时进行的自动推荐，辅助知识点串联。"),Vt("文件批量下载"),Vt("分享链接","","支持公开分享页面 / 文件夹 / 单文件"),Vt("分享链接密码访问","","支持为公开分享的页面设置访问密码，就像网盘分享一样"),Vt("自定义空间域名","","如，英文域名.buildin.ai 的自定义空间域名"),Vt("公共模板","","将页面设置为可快速创建的公共模板。"),Vt("多维表全部属性","","支持18种属性类型，广泛适用于各类场景"),Vt("多维表全部视图","","支持7种视图，同组数据多种展现形式"),Vt("多维表附件上传","","多维表媒体属性上传单个附件的大小限制。"),Vt("文件/文件夹管理","","支持在页面中插入文件，或通过文件夹形式管理文件。"),Vt("文件预览（Office、PDF等）","","支持PDF/Office/图片/视频等类型在线预览"),e},Hoe=()=>[{title:"用量",data:[[Vt("GPT-4o mini 请求"),"每天 10 条","每月 3000 条"],[Vt("阅读 PDF"),"每月 2 文件\n每文件 200 页以内","每天 50 文件\n每文件 2000 页以内"]]}],GO=e=>{const{type:t="spacePlan"}=e,n=$oe(),s=Hoe(),a=y.useMemo(()=>t==="spacePlan"?n:t==="ai"?s:n,[s,n,t]);return r.jsx(r.Fragment,{children:a.map((o,i)=>r.jsxs(y.Fragment,{children:[r.jsx("div",{className:"border-grey5 border-b h-9 px-2 flex items-center text-t2-medium text-grey3",children:o.title}),o.data.map((l,c)=>r.jsx("div",{className:R("text-t2 border-grey5 border-b grid",i===a.length-1&&c===o.data.length-1&&"border-none"),style:{gridTemplateColumns:"repeat(".concat(l.length,", minmax(0, 1fr))")},children:l.map((d,u)=>r.jsx("span",{className:R("flex items-center px-2 flex-shrink-0 py-2 min-h-[36px] border-grey5 border-l whitespace-pre-line",u===0&&"text-grey3 border-l-0",u%2!==0&&"bg-black_003"),children:d},u))},"".concat(i,"-").concat(c)))]},i))})},pT=e=>{const t=Pn().planType;return t===St.smallTeam&&e===St.team?!0:t===e},JD={team:void 0,personal:void 0,smallTeam:void 0},zoe=({isFrom:e=Mt.package})=>{const t=Dt(),n=pT(St.team),s=pT(St.smallTeam),a=Ut(),o=hg(),{editor:i}=o(a.uuid),{membersMaxLimit:l}=_c(),[c,d]=y.useState([]),{switchPayType:u,setSwitchPayType:f}=CO({defaultTimeType:"year"}),h=u==="month",p=Zw(),[g,_]=y.useState(JD);y.useEffect(()=>{OO(t.uuid,"all").then(k=>{var T;return((T=k.list)==null?void 0:T.length)&&d(k.list)})},[t.uuid]);const x=y.useCallback(k=>{const v=(k===St.team?oN:iN).upgrade;return c.filter(j=>h?j.monthNum===1:h?!1:j.monthNum===12).find(j=>j.planType===v)},[h,c]),F=y.useMemo(()=>{var v,I,j,S;const k=x(St.pro),T=x(St.team);return[[{hidden:!1,type:St.freePersonal,originalPrice:0,currentPrice:0,description:Zo(St.freePersonal)},{updatePlan:t.planType!==St.team,hidden:!1,type:St.pro,currentPrice:(v=g[St.pro])==null?void 0:v.unitPrice,currentPriceUnit:io(k==null?void 0:k.currentPriceUnit),originalPrice:(I=g[St.pro])==null?void 0:I.originUnitPrice,originalPriceUnit:io(k==null?void 0:k.originalPriceUnit),description:Zo(St.pro),label:k==null?void 0:k.label,id:k==null?void 0:k.id,unit:uT(1,{prefix:"/"}),tips:null}],[{updatePlan:!0,hidden:!1,type:St.team,currentPrice:(j=g[St.team])==null?void 0:j.unitPrice,currentPriceUnit:io(T==null?void 0:T.currentPriceUnit),originalPrice:(S=g[St.team])==null?void 0:S.originUnitPrice,originalPriceUnit:io(T==null?void 0:T.originalPriceUnit),description:Zo(St.team),label:k==null?void 0:k.label,id:T==null?void 0:T.id,unit:uT(1,{prefix:"/"})}]]},[g,t.planType,x]),b=y.useMemo(()=>({proPerson:F[0][1],freePerson:F[0][0],team:F[1][0]}),[F]),w=y.useCallback(k=>{p(k,e)},[e,p]),[E,C]=y.useMemo(()=>[b.proPerson.id,b.team.id],[b]);return tc(()=>{const k=x(St.pro),T=x(St.team),v={...JD};(async()=>{if(C&&T){const I=T.monthNum||1,j=T.originalPrice||0,S=T.currentPrice||0,D=I===1?S:Mc(S/I,Uc),A=I===1?j:Mc(j/I,Uc);v.team={unitPrice:D,originUnitPrice:A}}if(E&&k){const I=k.monthNum||1,j=k.originalPrice||0,S=k.currentPrice||0,D=I===1?S:Mc(S/I,Uc),A=I===1?j:Mc(j/I,Uc);v.personal={unitPrice:D,originUnitPrice:A}}})().then(()=>{_(v)})},[E,C,n,s,l],{wait:200}),{playTypeData:F,planData:b,planList:c,upgradePlan:w,editor:i,switchPayType:u,setSwitchPayType:f}},qoe=()=>r.jsxs("div",{className:"shrink-0 transition-opacity min-w-[720px]",children:[r.jsx(Goe,{}),r.jsx(GO,{type:"spacePlan"})]}),Goe=()=>{const{isFrom:e}=Jw(),{playTypeData:t,upgradePlan:n,editor:s,switchPayType:a,setSwitchPayType:o,planList:i}=zoe({isFrom:e});return r.jsxs("div",{className:R("grid border-b border-grey5 opacity-0 transition-opacity grid-cols-4",i.length&&"opacity-100",js&&"grid-cols-1 border-none"),children:[r.jsx(kO,{onSwitch:o,payType:a}),t.map(l=>l.map((c,d)=>{const u=pT(c.type),f=c.currentPrice!==0&&!c.currentPrice,h=c.type===St.freePersonal||c.type===St.freeTeam;if(c.hidden)return null;let p=r.jsx(r.Fragment,{});c.updatePlan?f||(p=r.jsx(Fe,{className:"flex-1 flex text-t2-medium",popup:s?"":"仅管理员可操作",children:r.jsx(De,{disable:!s,colorType:"active",className:R("flex-1",js&&"rounded h-10"),onClick:()=>n(c.type),children:u?"续费":"升级"})})):p=r.jsx(Fe,{className:"cursor-not-allowed flex-1",popup:u?void 0:"当前空间暂不支持升级到该空间计划",children:r.jsx(De,{className:R("text-t2-medium pointer-events-none w-full bg-white text-grey3 rounded",js&&"h-10"),children:h?r.jsx(r.Fragment,{children:"免费版"}):r.jsx(r.Fragment,{children:u?"当前版本":"升级"})})});let g=r.jsx(r.Fragment,{});return c.label&&(g=r.jsx("span",{className:"mb-5 bg-red/20 w-fit text-red rounded-sm py-px px-1 text-t3",children:c.label})),r.jsxs("div",{className:R("flex flex-col justify-between border-l border-grey5 p-2.5 flex-grow-0 flex-shrink-0",d%2===0&&"bg-black_003",js&&"border-none px-8 py-4 bg-transparent",js&&h&&"w-1/2"),children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:R("text-h4 mb-2.5",{"mb-1 text-h2":js}),children:c.description}),r.jsxs("div",{className:R("mb-5 space-x-1",{"mb-1 text-h4":js}),children:[r.jsx("span",{className:R("text-t2",c.currentPrice!==0&&!c.currentPrice&&"text-grey4",js&&"text-t1"),children:f?"暂未公布":c.currentPrice===0?"免费":"".concat(c.currentPriceUnit).concat(c.currentPrice)}),r.jsx("span",{className:"text-t1 text-grey4",hidden:!c.currentPrice,children:"".concat(c.unit,"/人")}),g,r.jsxs("div",{hidden:!1,className:R("text-t1 text-grey4",(!c.currentPrice||!c.originalPrice||c.currentPrice>=c.originalPrice)&&"opacity-0"),children:[r.jsxs("span",{className:"line-through",children:[c.originalPriceUnit,c.originalPrice]}),"人".concat(c.unit)]})]})]}),r.jsx("div",{children:p})]},"".concat(c,"-").concat(d))}))]})},Woe=()=>y.useCallback((e,t,n)=>{var u,f,h,p,g,_;let s=(h=(f=(u=t==null?void 0:t.amount)!=null?u:n==null?void 0:n.currentPrice)!=null?f:n==null?void 0:n.originalPrice)!=null?h:0;if(e){const x=(p=n==null?void 0:n.monthNum)!=null?p:1;s=Mc(s/x,Uc)}const a=(g=t==null?void 0:t.amount)!=null?g:0,o=(t==null?void 0:t.increasedPeople)||1,i=Mc(t!=null&&t.diffDays?(t==null?void 0:t.diffDays)/30:(_=t==null?void 0:t.increasedMonth)!=null?_:1,Uc),l=Mc(i/12,Uc),c=Mc(a/o/i,Uc),d=Mc(c*12,Uc);return{totalPrice:s,currentPrice:e?c:d,monthlyUnitPrice:c,yearlyUnitPrice:d,date:e?i:l}},[]),WO=BO(),Koe=()=>{const{couponId:e,selectCoupon:t,onPay:n,close:s,payMethod:a,setPayMethod:o,planId:i,onSelectPlan:l,planList:c,curCalculateQuote:d,loading:u,lastDate:f,couponList:h}=an(WO),p=Mm();return r.jsxs(r.Fragment,{children:[r.jsx(ha.Header,{close:s}),r.jsxs("div",{className:"px-7",children:[r.jsx(sa,{height:54,className:"text-h2",children:"购买容量包"}),r.jsxs(sa,{height:36,className:"text-grey3 text-t3",children:["已使用",As(p.currentCapacity),"，",r.jsxs("span",{children:[" 总容量 ",As(p.maxCapacity)," = "]}),r.jsxs("span",{children:[As(p.baseCapacity),"基础容量"]}),r.jsxs("span",{hidden:!(p.buyCapacity+p.giveCapacity),children:[" + ",As(p.buyCapacity+p.giveCapacity),"补充容量包"]}),r.jsxs("span",{hidden:!p.peopleCapacity,children:[" + ",As(p.peopleCapacity),"席位容量"]})]})]}),r.jsx(ha.SelectPlan,{items:c,loading:u,selectId:i,itemClick:l,itemRender:g=>r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2-medium mb-2.5",children:g.name}),r.jsxs("div",{className:"text-h3",children:[io(g.currentPriceUnit),g.currentPrice,"/年"]})]})}),r.jsx(ha.PlanEndTime,{endTime:f}),r.jsx(aN,{onSelectId:t,couponList:h,selectId:e,className:"px-8 my-2.5"}),r.jsx(ha.PayMethod,{payMethod:a,switchPayMethod:o}),r.jsx(ha.PayBar,{price:d==null?void 0:d.amount,priceUnit:d==null?void 0:d.amountUnit,disablePay:u,onPay:n})]})},fN=()=>{const e=ie();return y.useCallback(t=>e.modal({modalId:Ve.UPGRADE_SUPPORT,className:"w-[600px] max-h-[80vh] next-modal-scroll",content:()=>r.jsx(WO,{planId:t==null?void 0:t.planId,isFrom:t==null?void 0:t.isFrom,upgradeType:"capacity",children:r.jsx(Koe,{})})}),[e])};var Yf=(e=>(e.maxCapacity="maxCapacity",e.payCapacity="payCapacity",e.maxGuestCount="maxGuestCount",e.maxFileSize="maxFileSize",e.subscribeAiLimit="subscribeAiLimit",e.maxCopyLimit="maxCopyLimit",e))(Yf||{});const Yoe=e=>({...e});vl(Yoe);"存储容量".concat(zB),"拷贝页面到空间".concat(SZ,"/月"),ds.pricing;const mN=()=>{const e=ya();return y.useCallback(t=>{e(Mt.members)},[e])},Xf=(e,t)=>{const n=new URLSearchParams(location.search);Array.isArray(t)?t.forEach(({key:a,value:o})=>o&&n.set(a,o)):t.value&&n.set(t.key,t.value);const s=n.toString();return"".concat(e).concat(s?"?".concat(s):"")},hN=()=>{const{uuid:e}=Ut();return!!e},Dd=()=>{const e=ie(),t=ya(),n=_o(),s=hN(),a=mN();return y.useCallback(o=>{var j;const{title:i,maxCapacity:l,singleFile:c,planType:d=(j=Pn().planType)!=null?j:"",readonly:u,spaceId:f,copyLimit:h,isMoveOtherSpace:p}=o,g=pg(xa().uuid).editor,_=qte.includes(d),x=t5.includes(d),F=pt(),b=As(l,0),w=!F&&s&&!u&&g,E="当前为".concat(Zo(d),"空间"),C="".concat(E,"，单文件大小上限为").concat(b,"。"),k="".concat(E,"，总容量为").concat(b,"，如需提升上限，请升级扩容。"),T=c?C:k,v=w?"升级扩容":"知道了";if(me.event("single_files_show"),!x&&!_){const S=(()=>h?Yf.maxCopyLimit:c?(F&&be.warning("拷贝失败，拷贝的页面包含超过2M 的文件"),Yf.maxFileSize):(F&&be.warning("拷贝失败，空间储存容量已达上限。"),Yf.maxCapacity))();if(S){if(p&&Xoe(S),F){const D=Xf(Nt.main,[{key:dn.spaceId,value:f},{key:dn.openDialog,value:S}]);setTimeout(()=>{location.href="".concat(Jh).concat(D)},1500);return}a({type:S,spaceId:f});return}}const I={modalId:Ve.SINGLE_CAPACITY,title:r.jsxs("div",{className:"mb-5",children:[r.jsx("p",{className:"text-t1-medium mb-2.5",children:i}),r.jsx("p",{className:"text-t2",children:T})]}),colorType:"active",confirmText:v,confirm:()=>{if(w){if(pt()&&f){G9(f),location.href="".concat(FZ);return}if(p){be.success("正在切换空间，稍等片刻...");const S=new URLSearchParams;S.set(dn.spaceId,f!=null?f:""),S.set(dn.openDialog,_?Hb.space_info:Hb.openUpgradeSpace),window.location.href="".concat(window.location.origin,"?").concat(S.toString());return}_?n({from:Mt.file,defaultMenuType:Kt.spaceInfo}):t(Mt.file)}}};e.warning({...I})},[s,e,n,t,a])},Xoe=e=>{switch(e){case Yf.maxCapacity:{be.warning("移动失败，空间储存容量已达上限");break}case Yf.maxFileSize:{be.warning("移动失败，移动的页面包含>2M的文件");break}}},KO=()=>{const e=Dd(),t=QI();return y.useCallback(async n=>{const s=qe(),{spaceId:a,isDatabase:o,fileSize:i,onComplete:l,key:c,fileName:d,inTransferList:u,blockId:f,pageId:h,type:p}=n;if(p!=="file")return!0;const{singleFileMaxSize:g,maxCapacity:_,currentCapacity:x,isNovice:F}=Zu(a,{isDatabase:o});let{planType:b}=Pn();if(a!==Pn().uuid){const C=await t(a);b=C==null?void 0:C.planType}const w=i>g,E=x+i>_;return E||w?(E?e({title:"有文件上传失败",maxCapacity:_,planType:b,isNovice:F}):w&&e({title:"有文件上传失败",maxCapacity:g,singleFile:!0,planType:b,isNovice:F}),qc({name:d,size:i,key:c!=null?c:"",inTransferList:u,progress:-1,blockId:f,pageId:h,status:is.failure,uploadId:s}),l==null||l({success:!1,errCode:hs.UPLOAD_SINGLE_FILE_CAPACITY_LIMIT,errMsg:""}),!1):!0},[t,e])};Rre({request:ve,ossCallbackHost:{}.VITE_OSS_CALLBACK_PREFIX||"http://".concat(window.location.host),onError:e=>{zp(e)}});const Qoe=e=>{e&&qc({key:e,progress:-1,status:is.failure})},YO=()=>{const e=Dd();return y.useCallback((t,n)=>{const{key:s,singleFileMaxSize:a,planType:o,maxCapacity:i,isNovice:l}=n;if(t.errCode===hs.UPLOAD_SINGLE_FILE_CAPACITY_LIMIT)e({title:"上传失败",maxCapacity:a,singleFile:!0,planType:o,isNovice:l});else if(t.errCode===hs.UPLOAD_MAX_CAPACITY_LIMIT)e({title:"上传失败",maxCapacity:i,planType:o,isNovice:l});else if(t.errCode===hs.UPLOAD_CANCEL){be.success("已取消"),s&&G3(s);return}else be.error(t.errMsg);Qoe(s)},[e])},Uo=()=>{const e=Js(),t=xc(),n=QI(),s=KO(),a=YO(),o=lt();return y.useCallback(async i=>{var v,I,j;const{onCapacitySuccess:l,onComplete:c,onProgress:d,handleFail:u,userId:f=yt.uuid,spaceId:h=Ot(),key:p,isDatabase:g,inTransferList:_,blockId:x,...F}=i;try{hse(h)||await t(h)}catch(S){return qc({name:i.file.name,size:i.file.size,key:p!=null?p:"",progress:-1,inTransferList:_,blockId:x,pageId:(v=i.pageId)!=null?v:o,status:is.failure,uploadId:""}),c==null||c({success:!1,errCode:hs.UPLOAD_FAILED,errMsg:""}),""}let{planType:b}=Pn();if(h!==Pn().uuid){const S=await n(h);b=S==null?void 0:S.planType}const{singleFileMaxSize:w,maxCapacity:E,isNovice:C}=Zu(h,{isDatabase:g});if(!await s({fileName:i.file.name,fileSize:i.file.size,key:p,inTransferList:_,blockId:x,pageId:(I=i.pageId)!=null?I:o,onComplete:c,spaceId:h,isDatabase:g,type:F.type}))return"";const T=N0.upload({...F,isDatabase:g,spaceId:h,userId:f,onCapacitySuccess:l,onProgress:S=>{d==null||d(S),p&&qc({key:p,progress:S,status:is.uploading})},onComplete:S=>{var D,A;if(c==null||c(S),S.success){_&&(S.url&&Gre(T,{expireTime:(D=S.expireTime)!=null?D:Date.now()+1.5*60*k3,url:S.url}),Yre(T)),p&&qc({key:p,progress:100,inTransferList:_,blockId:x,pageId:(A=i.pageId)!=null?A:o,status:is.success,url:S.url}),e(Je.GUIDE_FIRST_TIME_UPLOAD,ct.basicList),e(Je.GUIDE_FIRST_TIME_CREATED_FOLDER,ct.basicList);return}u!=null&&u(S)||a(S,{maxCapacity:E,planType:b,singleFileMaxSize:w,key:p,isNovice:C})}});return p&&qc({key:p,progress:0,name:i.file.name,createdAt:Date.now(),uploadId:T,inTransferList:_,blockId:x,pageId:(j=i.pageId)!=null?j:o,size:i.file.size,status:is.uploading}),_&&Kre(T,i),T},[t,n,o,e,s,a])},Joe=()=>{const e=QI(),t=KO(),n=YO(),s=xc();return y.useCallback(async a=>{const o=await e(a.spaceId);if(!o)return"";await s(a.spaceId);const{onCapacitySuccess:i,onComplete:l,onProgress:c,handleFail:d,key:u,...f}=a,{planType:h}=o,{singleFileMaxSize:p,maxCapacity:g,isNovice:_}=Zu(o.uuid,{isDatabase:a.isDatabase});if(!await t({fileName:a.file.name,fileSize:a.file.size,key:u,inTransferList:a.inTransferList,onComplete:l,spaceId:a.spaceId,isDatabase:a.isDatabase,type:f.type}))return"";const F=N0.uploadWithoutLogin({...f,singleFileMaxCapacity:p,onCapacitySuccess:i,onProgress:b=>{c==null||c(b),u&&qc({key:u,progress:b,status:is.uploading})},onComplete:b=>{if(l==null||l(b),b.success){b.url&&b.expireTime&&Vs.putCache(b.ossName,b.url,b.expireTime),u&&qc({key:u,progress:100,status:is.success,url:b.url});return}d!=null&&d(b)||n(b,{maxCapacity:g,planType:h,singleFileMaxSize:p,key:u,isNovice:_})}});return u&&qc({key:u,progress:0,name:a.file.name,createdAt:Date.now(),uploadId:F,size:a.file.size,status:is.uploading}),F},[s,e,t,n])},XO=()=>{const e=xc(),t=Dd(),n=Uo(),s=Oe(),a=nN();return y.useCallback(async(o,i)=>{const{files:l,onComplete:c,blockId:d,ownerPageId:u,onCapacitySuccess:f,...h}=o,p=C=>{if(!i)return C;const k={parentId:C.parentId};if(i){const{dropId:T,position:v}=i;if(T){const I=J.blocks[T];if(I){const j=J.blocks[I.parentId];(j==null?void 0:j.type)===m.BlockType.COLUMN_LIST?k.parentId=u:k.parentId=I.parentId}}v==="bottom"||v==="right"?k.after=T:(v==="top"||v==="left")&&(k.before=T)}return k};let g=f;const _=(C,k,T)=>{const{extName:v}=rn(k.name),I={segments:ht(k.name),size:k.size,extName:v,display:Ene(v)};if(i)s(()=>{const j=ut({type:m.BlockType.FILE,data:I,updatedAt:Date.now()},T);n({...h,pageId:C,blockId:j,key:"".concat(C,"_").concat(j),file:k,onCapacitySuccess:g,async onComplete(S){if(c(S),S.success){S.url&&S.expireTime&&Vs.putCache(S.ossName,S.url,S.expireTime);const D=await a(k);_e(j,{data:{ossName:S.ossName,...D}}),re(Sa())}}})});else{const j=d!=null?d:qe();n({...h,pageId:C,blockId:j,key:"".concat(C,"_").concat(j),file:k,onCapacitySuccess:g,async onComplete(S){if(c(S),S.success){S.url&&S.expireTime&&Vs.putCache(S.ossName,S.url,S.expireTime);const D=await a(k);s(()=>{ut({uuid:j,type:m.BlockType.FILE,data:{...I,ossName:S.ossName,...D},updatedAt:Date.now()},T)})}}})}};if(l.length===1){_(u,l[0],p({parentId:u,first:!0}));return}const x=await e(),F=l.reduce((C,k)=>C+k.size,0);if(x.currentCapacity+F>x.maxCapacity){t({title:"有文件上传失败",maxCapacity:x.maxCapacity,isNovice:x.isNovice});return}const b=zre(l);if(!b)return;g=void 0,f==null||f();const w=(C,k,T,v=!1)=>{k.name&&s(()=>{C=ut({type:m.BlockType.FOLDER,data:{segments:ht(k.name)}},T),k.blockId=C,v&&(T.parentId=C)},{noThrottle:!0}),k.files.forEach(I=>{_(C,I,v?T:{parentId:C,first:!0})});for(const I of k.folders)w(C,I,v?T:{parentId:C,last:!0});return k.blockId},E=p({parentId:u,last:!0});return w(E.parentId,b,E,!0)},[e,a,t,s,n])},Zoe=()=>{const e=xc(),t=Dd(),n=Uo();return y.useCallback(async s=>{const{files:a,onComplete:o,onCapacitySuccess:i,keys:l,blockIds:c,...d}=s;let u=i;const f=(g,_,x)=>{n({...d,blockId:x,key:g,file:_,onCapacitySuccess:u,async onComplete(F){F.success?(F.url&&F.expireTime&&Vs.putCache(F.ossName,F.url,F.expireTime),o({...F,key:g})):o(F)}})};if(a.length===1){f(l[0],a[0],c[0]);return}const h=await e(),p=a.reduce((g,_)=>g+_.size,0);if(h.currentCapacity+p>h.maxCapacity){t({title:"有文件上传失败",maxCapacity:h.maxCapacity,isNovice:h.isNovice});return}if(a.length!==l.length)throw Error("files length is not equal fileBlockId length");u=void 0,i==null||i(),a.forEach((g,_)=>{f(l[_],g,c[_])})},[e,t,n])};function eie(e){const t=[];return y.Children.toArray(e).forEach(n=>{fn.isValidElement(n)&&t.push({key:n.key,...n.props,node:n})}),t}const xg=({className:e,children:t,defaultActiveIndex:n=0,customButtons:s,onChangeTab:a,active:o,displayMode:i="lazyLoad",style:l,border:c=!0,tabBarClassName:d})=>{var _;const[u,f]=y.useState(n),h=y.useRef(null),p=y.useRef(new Set([u]));y.useEffect(()=>{o!==void 0&&f(o)},[o]);const g=eie(t);return p.current.add(u),r.jsxs("div",{className:e,style:l,"data-no-cancel-selected":!0,children:[r.jsxs("div",{ref:h,className:R("flex p-2 justify-between",{"border-b border-grey6 ":c},d),children:[r.jsx("span",{className:"flex items-center space-x-2",children:g.map((x,F)=>{var b;return y.createElement("span",{...x,...Gs(x.title),key:(b=x.key)!=null?b:F,onClick:()=>{f(F),a==null||a(F)},className:R("text-t2 py-1 px-1.5 rounded flex-shrink-0 space-x-1",u===F?"bg-black_006 animate-click":"animate-hover")},x.icon&&r.jsx(V,{size:"normal",name:x.icon}),x.title)})}),s==null?void 0:s()]}),i==="singleNode"&&((_=g[u])==null?void 0:_.node),i!=="singleNode"&&g.map((x,F)=>p.current.has(F)||i==="preview"?r.jsx("div",{className:R({hidden:F!==u}),children:x.node},x.key||F):null)]})},Zr=({children:e})=>r.jsx(r.Fragment,{children:e}),tie=e=>e.trim()?!0:(be.warning("链接不能为空"),!1),pN=e=>{var a;const{validate:t=tie}=e,[n,s]=y.useState((a=e.defaultValue)!=null?a:"");return r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx(Ct,{autoFocus:!e.defaultValue,defaultValue:e.defaultValue,className:"h-8 rounded-sm mt-4 w-[calc(100%-20px)]",placeholder:e.placeholder,onChange:s,onEnter:()=>{n&&t(n)&&e.onInputUrl(n)}}),r.jsx(De,{disable:!n,size:"large",colorType:"active",className:"mt-4 text-t4-medium w-[300px] mb-4",onClick:()=>{t(n)&&e.onInputUrl(n)},style:{transform:"translateX(50%) translate(-150px)"},children:"提交"})]})},nie=({desc:e,style:t})=>r.jsxs("div",{className:"flex flex-col items-center pointer-events-none relative",style:{...t,top:"calc(50% - 116px + 50px)"},children:[r.jsx("div",{className:"text-[70px] leading-[80px]",children:"👀"}),r.jsx("div",{className:"text-grey4 text-t1",children:e})]}),gT=e=>{const{url:t,description:n,onClick:s,illegal:a,node:o}=e;return a?r.jsx("div",{className:"flex relative h-20 mb-2 overflow-hidden text-t4 text-grey3 bg-grey6 p-2",children:"图片无法查看"}):r.jsxs(Fe,{equalWidth:!0,popupClass:"min-w-[50px] whitespace-pre-wrap w-full break-words line-clamp-none",placement:"bottom",popup:n,offset:[-1,8],className:R("relative overflow-hidden cursor-pointer flex flex-col mb-2",o?"h-[104px]":"h-20"),children:[r.jsx("img",{loading:"lazy",alt:n,src:t,onClick:s,className:"object-cover w-full h-20 transition rounded animate-click hover:brightness-[0.8]"}),o]},n)},sie=e=>{const{imageList:t,hasMore:n,onSelect:s,customFooter:a,loadMore:o=()=>{},style:i}=e,l=y.useRef(null);return r.jsxs("div",{ref:l,className:"px-3 py-1 overflow-y-auto",style:i,children:[r.jsx(xd,{pageStart:1,initialLoad:!0,useWindow:!1,loadMore:o,getScrollParent:()=>l.current,hasMore:n,className:"grid grid-cols-4 gap-2",children:t.map((c,d)=>{let{url:u}=c;if(u&&u.includes("?token=")){const[f]=u.split("?token="),{extName:h}=rn(f);Im.test(h)&&(u=sm(u))}return r.jsx(gT,{description:c.fileName,url:u,illegal:c.illegal,onClick:()=>{c.illegal?be.error("图片无法使用"):s(d)}},"".concat(c.url).concat(d))})}),a]})},xs=y.forwardRef(({fixed:e,style:t,className:n,description:s,size:a="max"},o)=>{const i=y.useMemo(()=>r.jsx($s,{size:a}),[n,a]);return r.jsx("div",{ref:o,className:R("flex items-center justify-center h-full w-full overflow-hidden",e&&"fixed top-0 right-0 z-50 bg-white1 w-screen h-screen",ot.blog&&"flex-1",ot.blog==="walles"&&"!bg-[#0d0c0f]",n),style:t,children:r.jsxs("div",{className:"flex flex-col items-center",children:[i,s&&r.jsx("div",{className:"text-t2 mt-2.5",children:s})]})})}),rie=e=>{const t=y.useRef({async search(c,d,u){var h;return(h=(await ve.editor.querySpaceRecentlyImages(Ot(),e.fileType,c,u)).list)!=null?h:[]},async convert(c){return c.map(d=>{var u;return{url:d.url,ossName:d.ossName,fileName:(u=d.description)!=null?u:""}})},canSearchWithEmpty:!0}),{firstTime:n,resultList:s,loading:a,hasMore:o,search:i}=p9(t.current),l=c=>{i(c,"")};return y.useEffect(()=>{i(1,"")},[]),n?r.jsx(xs,{style:e.style}):r.jsx(sie,{onSelect:c=>{var u;const d=s[c];d&&d.ossName&&((u=e.onSelect)==null||u.call(e,d))},imageList:s,hasMore:o,loadMore:l,style:e.style,customFooter:r.jsxs(r.Fragment,{children:[s.length===0&&r.jsx(nie,{desc:"最近未上传过图片",style:e.style}),a&&o&&r.jsxs("div",{className:"relative flex flex-col items-center justify-center",children:[r.jsx($s,{size:"middle"}),r.jsx("div",{className:"flex items-center ml-2 text-center text-t2 text-grey4",children:"加载更多..."})]})]})})},gN=e=>{const{singleFile:t=!1,labelClassName:n="w-[300px]"}=e,s=a=>{var i;const o=a.target.files;o&&((i=e.onSelect)==null||i.call(e,Array.from(o)))};return r.jsx("div",{className:"flex justify-center items-center h-[62px] w-[full]",style:e.style,children:r.jsxs("label",{className:R("h-8 w-full",n),children:[r.jsx("div",{className:"flex justify-center items-center text-t4-medium rounded active:opacity-50 text-align-center h-8 px-3.5 bg-active_color text-white hover:bg-active_color/90 cursor-pointer",children:e.title||"请选择一个文件"}),r.jsx("input",{type:"file",multiple:!t,...e.inputAttribute,className:"hidden",onChange:s})]})})},QO=e=>{const{showRecently:t=!0,fileType:n}=e,[s,a]=y.useState(Date.now()),o=async()=>{await ve.editor.clearSpaceRecentlyImages(Ot(),{imgType:n}),be.success("已清空"),a(Date.now())};return r.jsxs("div",{className:"pb-1",children:[r.jsx(gN,{singleFile:!0,title:"请选择一张图片",inputAttribute:{accept:"image/*"},onSelect:i=>{var c;const l=i[0];l&&((c=e.onUploadFile)==null||c.call(e,l))},style:{height:"37px",marginTop:"15px"}}),r.jsx("span",{className:"text-t4 text-grey3 flex justify-center mt-2",children:e.tip}),t&&r.jsxs("div",{className:"px-3 py-1 text-t2 text-grey3 mt-3 flex justify-between",children:[r.jsx("span",{children:"最近上传"}),r.jsx("span",{className:"animate-hover px-1 animate-click",onClick:o,children:"清空记录"})]}),t&&r.jsx(rie,{onSelect:e.onSelectImage,fileType:e.fileType,style:e.style},s)]})},aie=0,_N=e=>{const t=ie(),n=y.useRef(!0),[s,a]=y.useState(0),{showRecently:o=!0}=e;return r.jsxs(xg,{onChangeTab:a,className:R("next-modal h-[426px] w-[414px]",{"overflow-scroll":s===2}),customButtons:()=>r.jsxs("div",{className:"mr-2 flex",children:[s===aie&&r.jsxs("div",{className:"animate-hover cursor-pointer items-center rounded py-1.5 px-1 flex-shrink-0 space-x-1",style:{display:e.hideRandom?"none":"flex"},onClick:()=>{const i=zw(n.current);n.current=!1,e.onSelectEmoji&&e.onSelectEmoji(i,!0)},children:[r.jsx(V,{size:"middle",name:"MIcEmojiRandom"}),r.jsx("div",{className:"text-t2 text-grey3",children:"随机选择"})]}),r.jsxs("div",{className:"animate-hover ml-1 cursor-pointer items-center rounded py-1.5 px-1 flex-shrink-0 space-x-1",style:{display:e.hideRemoveBtn?"none":"flex"},onClick:e.onRemoveBtnClick,children:[r.jsx(V,{size:"middle",name:"MIcClear"}),r.jsx("div",{className:"text-t2 text-grey3",children:"清除"})]})]}),children:[r.jsx(Zr,{title:"Emoji",children:r.jsx(lT,{useButton:!0,onSelect:(i,l,c)=>{if(!c&&l&&i.skin)return t.dropdown({popcorn:l.currentTarget,placement:"bottom",content:({onCloseModal:d})=>r.jsx(cT,{emoji:i,onSelect:u=>{e.onSelectEmoji&&(d(),e.onSelectEmoji(u.native),Gf.add(u))}})}),!0;e.onSelectEmoji&&i.native&&e.onSelectEmoji(i.native)}})}),r.jsx(Zr,{title:"Icons",children:r.jsx(lT,{emojiSize:20,useCustomIcon:!0,useButton:!0,onSelect:(i,l,c)=>{if(!c&&l&&i.skin)return t.dropdown({popcorn:l.currentTarget,placement:"bottom",content:({onCloseModal:d})=>r.jsx(cT,{emoji:i,onSelect:u=>{e.onSelectEmoji&&(d(),e.onSelectEmoji(u.native),Gf.add(u))}})}),!0;e.onSelectEmoji&&!i.imgPath&&e.onSelectEmoji(i.native),e.onSelectCustomIcon&&i.imgPath&&e.onSelectCustomIcon(i.imgPath)}})}),r.jsx(Zr,{title:"上传",children:r.jsx(QO,{tip:"建议上传 280 x 280 像素的图片",showRecently:o,onSelectImage:e.onSelectRecentlyImage,fileType:"icon",onUploadFile:e.onUploadFile,style:{height:"254px"}})}),r.jsx(Zr,{title:"链接",children:r.jsx(pN,{defaultValue:e.inputValue,placeholder:"输入图标链接",onInputUrl:i=>{var l;return(l=e.onInputUrl)==null?void 0:l.call(e,i)}})})]})},oie=(e,t={})=>{const n=y.useRef(t);n.current=t;const s=Oe(),a=ie(),o=Uo(),i=ft(e,l=>{var c;if(((c=l==null?void 0:l.data.icon)==null?void 0:c.type)==="http")return l.data.icon.value},[],{wait:200});return y.useEffect(()=>()=>{pO(pe().blocks[e])}),y.useCallback(l=>{const c=n.current;l.preventDefault(),l.stopPropagation();const u=(c.popcorn||l.currentTarget).getBoundingClientRect(),f=p=>{_e(e,{data:{icon:{type:"upload",value:""},iconUrl:URL.createObjectURL(p)}},!0),be.loading({key:vu.UPLOAD_ICON,content:"上传中..."}),o({file:p,type:"file",searchType:"icon",onComplete:g=>{be.closeMessage(vu.UPLOAD_ICON),g.success&&(be.success("更换成功"),s(()=>{var _;_e(e,{data:{icon:{type:"upload",value:(_=g.ossName)!=null?_:""}}})}))}})},h=p=>{s(()=>{_e(e,{data:{icon:{type:"upload",value:p.ossName},iconUrl:p.url}})})};a.dropdown({popcorn:{getBoundingClientRect:()=>u},placement:c.placement||"bottom",modifiers:c.modifiers,offset:c.offset,content:({onCloseModal:p})=>r.jsx(_N,{onSelectCustomIcon:(g,_)=>{_||p(),s(()=>{_e(e,{data:{icon:{type:"icon",value:g},iconUrl:""}})})},onSelectEmoji:(g,_)=>{var x;_||p(),(x=c.onSelectEmoji)==null||x.call(c,g),s(()=>{_e(e,{data:{icon:{type:"emoji",value:g},iconUrl:""}})})},onUploadFile:g=>{if(g.size>=20*1024*1024){be.error("不支持超过20M的图标");return}p(),f(g)},onSelectRecentlyImage:g=>{p(),h(g)},hideRemoveBtn:c.hideRemoveBtn,onRemoveBtnClick:()=>{s(()=>{_e(e,{data:{icon:{},iconUrl:void 0}})}),p()},inputValue:i,onInputUrl:g=>{s(()=>{_e(e,{data:{icon:{type:"http",value:g},iconUrl:g}})}),p()}})})},[e,i,a,s,o])},Fn=e=>{const{illegal:t}=mt(e.blockId),n=We(e.blockId),s=r.jsx(na,{hasOverlay:e.hasOverlay,disableHover:!0,className:e.className,iconSize:e.iconSize,emojiStr:e.defaultEmoji,defaultIcon:e.defaultIcon}),a=e.trigger===!1||n;return t?s:r.jsx(y.Suspense,{fallback:s,children:a?r.jsx(JO,{...e,className:R(e.className,e.tooltipClassName)}):r.jsx(iie,{...e})})},iie=e=>{const t=oie(e.blockId,e);return r.jsx(Fe,{popup:"更换图标",className:R("inline-flex flex-shrink-0",e.tooltipClassName),children:r.jsx(JO,{...e,onClick:t})})},JO=e=>{const t=Pa(),n=ye(e.blockId,["data"],["icon"],{wait:200}),s=n==null?void 0:n.data.icon,a=e.onClick==null;return(s==null?void 0:s.type)==="http"&&s.value!=null?r.jsx(dT,{onClick:e.onClick,trigger:!a,src:s.value,className:e.className,emojiSize:e.iconSize,hasOverlay:e.hasOverlay}):(s==null?void 0:s.type)==="upload"&&s.value!=null?r.jsx(Are,{onClick:e.onClick,trigger:!a,blockId:e.blockId,ossName:s.value,className:e.className,emojiSize:e.iconSize,hasOverlay:e.hasOverlay}):(s==null?void 0:s.type)==="icon"&&s.value?r.jsx(dT,{onClick:e.onClick,trigger:!a,src:c3(t,s.value),className:e.className,emojiSize:e.iconSize,hasOverlay:e.hasOverlay}):r.jsx(na,{onClick:e.onClick,hasOverlay:e.hasOverlay,disableHover:a,className:e.className,iconSize:e.iconSize,emojiStr:((s==null?void 0:s.type)==="emoji"?s.value:"")||e.defaultEmoji,defaultIcon:e.defaultIcon})},lie=e=>{const t=e.listItem.data;if(!t)return null;const n=t.navs&&t.navs.length>0;return r.jsxs("div",{...e.attribute,onClick:s=>{e.onItemClick&&e.onItemClick(e.listItem,e.index,s)},className:R(Yu,"flex items-center rounded cursor-pointer active-bg animate-hover",n?"h-[58px]":"h-10",{"normal-bg":e.selected}),children:[r.jsxs("div",{className:"flex flex-col flex-1 text-ellipsis",children:[r.jsxs("div",{className:"flex flex-row items-center",children:[["SPACE","PRIVATE"].some(s=>s===t.type)?r.jsx(ar,{className:"!text-t3-medium m-0.5",icon:t.icon,name:t.avatarTitle||t.title,color:t.backgroundColor,style:{width:"20px",height:"20px"}}):r.jsx(Fn,{blockId:t.uuid,iconSize:20,trigger:!1,defaultIcon:r.jsx(_s,{uuid:t.uuid,size:"middle"})}),r.jsx("span",{className:"ml-2 text-black text-t2 text-ellipsis",children:t.title})]}),r.jsx("div",{className:"flex flex-col ml-7",children:t.navs&&t.navs.length>0&&r.jsx(x0,{navs:t.navs})})]}),t.renderRight&&t.renderRight()]})},cie=e=>{const t=e.listItem.data;return t?r.jsxs("div",{...e.attribute,onClick:n=>{var s,a;(s=t.onClick)==null||s.call(t),(a=e.onItemClick)==null||a.call(e,e.listItem,e.index,n)},className:R(Yu,"h-auto flex items-center justify-between py-2.5 rounded cursor-pointer active-bg animate-hover",{"normal-bg":e.selected}),children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("div",{className:"text-black text-t2",children:t.title}),t.description&&r.jsx("div",{className:"text-t4 text-grey3",children:t.description})]}),t.selected&&r.jsx(V,{name:"IcCheck02",size:"middle"})]}):null},die=e=>{var n;const t=e.listItem.data;return t?r.jsx("div",{...e.attribute,className:R(Yu,"flex items-center justify-between rounded cursor-pointer active-bg animate-hover",{"normal-bg":e.selected}),onClick:()=>t.onSwitch(!t.switch),"data-no-cancel-selected":t.noCancelSelected,children:r.jsxs(Fe,{className:R("flex items-center justify-between h-full w-full"),placement:"right",theme:"none",offset:[0,16],popup:t.context,children:[r.jsxs("div",{className:"flex items-center",children:[t.icon&&r.jsx(V,{name:t.icon,className:"mr-2",size:(n=t.iconSize)!=null?n:"middle"}),r.jsx("span",{className:"text-black text-t2",children:t.title})]}),r.jsx(en,{open:t.switch,onSwitch:t.onSwitch,disabled:t.disabled})]})}):null};var H=(e=>(e.OPERATION="operation",e.SEARCH="search",e.SEARCH_FILE="search_file",e.LINE="line",e.HISTORY="history",e.TEXT_SWITCH="textSwitch",e.BLOCK_ITEM="blockItem",e.BLOCK_TEXT="blockText",e.OPERABLE_BLOCK_TEXT="operableBlockText",e.BLOCK_TRANSFORM="blockTransform",e.TEXT_DESCRIPTION="textDescription",e.CUSTOM_RENDER="custom_render",e))(H||{});fc(H.OPERATION,Nee);fc(H.SEARCH,lie);fc(H.SEARCH_FILE,one);fc(H.LINE,vee,!0);fc(H.BLOCK_ITEM,wee);fc(H.TEXT_SWITCH,die);fc(H.BLOCK_TEXT,Cee,!0);fc(H.OPERABLE_BLOCK_TEXT,kee);fc(H.BLOCK_TRANSFORM,Tee);fc(H.TEXT_DESCRIPTION,cie);const ze=y.memo(e=>{const{loadMore:t=()=>{},keyDownPriority:n=dr,onGlobalCaptureKeydown:s,defaultActiveIndex:a=-1,activeIndex:o,onSelectedActiveIndex:i,autoResetActiveIndex:l,enableKeyDown:c=!0}=e,d=y.useMemo(()=>e.items.filter(w=>!w.isHidden),[e.items]),u=y.useRef(null),f=y.useRef(null),h=y.useRef(qe()),p=y.useRef(null),g=w=>{var E,C;return(C=(E=f.current)==null?void 0:E.querySelector('[data-list-item="'.concat(h.current,"-").concat(w,'"]')))!=null?C:null},_=(w,E)=>Py(d,w,E),[x,F]=R3(d.length,g,_,n,{scrollContainer:f,defaultActiveIndex:a,activeIndex:o,onGlobalCaptureKeydown:s,onSelectedActiveIndex:i,virtuoso:p,autoResetActiveIndex:l,enableKeyDown:c}),b=(w,E)=>{var T,v,I,j;if(w.isHidden)return null;const C={onMouseDown:S=>S.preventDefault(),"data-list-item":"".concat(h.current,"-").concat(E),...Gs(((T=w.data)==null?void 0:T.dataTestId)||((v=w.data)==null?void 0:v.title)),...w.attribute,onMouseEnter:()=>{c&&F(E)}};if(w.render){const S=w.render();return r.jsx(S.type,{...C,key:(I=w.key)!=null?I:E,...S.props,className:R(S.props.className,E===x&&!w.disableCustomHoverBg&&"normal-bg rounded")})}const k=g9[w.type];return k===void 0?r.jsx("div",{children:"不支持该类型(".concat(w.type,"),请先注册")}):r.jsx(k,{attribute:C,listItem:w,index:E,onItemClick:w.disableClick?void 0:e.onItemClick,selected:E===x},(j=w.key)!=null?j:E)};return r.jsxs("div",{className:R("max-h-[90vh] overflow-y-auto",e.className),ref:f,"data-no-cancel-selected":!0,style:e.style,children:[e.customHeader,e.virtualList?r.jsxs(r.Fragment,{children:[e.loadingView,r.jsx(yee,{className:e.scrollClassName,virtuosoRef:p,items:d,renderItem:b,maxHeight:e.virtualListHeight,computeItemKey:w=>{var E,C;return(C=(E=d[w])==null?void 0:E.key)!=null?C:"".concat(w)}})]}):r.jsx("div",{ref:u,className:R(e.scrollClassName,e.loadMore&&"absolute bottom-0 w-full overflow-auto flex-1"),style:{...e.scrollContainerStyle},children:r.jsxs(xd,{pageStart:1,initialLoad:!1,useWindow:!1,loadMore:t,getScrollParent:()=>u.current,hasMore:e.hasMore,children:[e.loadingView,d.map((w,E)=>b(w,E))]})}),e.customFooter]})});function Py(e,t,n){if(n==="left"||n==="right")return-1;const s=n==="up",a=s?t-1:t+1,o=e[a];return o?o.isHidden||_9.has(o.type)?Py(e,a,n):a:Py(e,s?e.length:-1,n)}const xN="PDF_AI_SOURCE_COVER",uie={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},fie={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3},mie={DISABLE:0,ENABLE:1,ENABLE_ENHANCE:2};var _t=(e=>(e.RECTANGLE="rectangle",e.ELLIPSE="ellipse",e.POLYGON="polygon",e.HIGHLIGHT="highlight",e.UNDERLINE="underline",e.STRIKETHROUGH="strikethrough",e.PENCIL="pencil",e.ERASER="eraser",e.MOVE="move",e.NONE="none",e))(_t||{});const Gd={BLUE:"#3EC1FA",GREEN:"#00E79B",YELLOW:"#FAE143",ORANGE:"#FFB94E",PINK:"#FF5682",PURPLE:"#E76BEC"};var ao=(e=>(e.CATALOGUE="catalogue",e.THUMBNAIL_VIEW="thumbnailView",e.ANNOTATION="annotation",e.NONE="none",e))(ao||{}),zb=(e=>(e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e))(zb||{}),qb=(e=>(e.SINGLE="single",e.DOUBLE="double",e))(qb||{}),Wo=(e=>(e.ADD="add",e.UPDATE="update",e.DELETE="delete",e))(Wo||{});const yN=(e,t)=>e.map(n=>{const[s,a]=t.convertToPdfPoint(n.x,n.y),[o,i]=t.convertToPdfPoint(n.x+n.width,n.y+n.height);return{x:s,y:a,xMax:o,yMax:i}}),ZO=(e,t)=>e.map(n=>{const[s,a,o,i]=t.convertToViewportRectangle([n.x,n.y,n.xMax,n.yMax]);return{x:s,y:a,width:o-s,height:i-a}}),ZD=(e,t)=>({x:e.left-t.left,y:e.top-t.top,width:e.width,height:e.height}),hie=(e,t)=>e.top>t.top&&e.left>t.left&&e.bottom<t.bottom&&e.right<t.right,pie=(e,t,n=10)=>Math.abs(e.top-t.top)<n&&Math.abs(e.height-t.height)<n,gie=(e,t)=>e.left<=t.left&&t.left<=e.right,_ie=(e,t,n=10)=>e.left<=t.left&&e.right<=t.right&&t.left-e.right<=n,xie=(e,t)=>{let n=e.filter(a=>a.width>.1&&a.height>.1&&Math.abs(a.width-t)>10).sort((a,o)=>{const i=a.top-o.top;return i===0?a.left-o.left:i});n=n.filter(a=>n.every(o=>!hie(a,o)));const s=new Set;return n.forEach((a,o)=>{s.has(a)||n.slice(o+1).forEach(i=>{s.has(i)||pie(a,i)&&(gie(a,i)||_ie(a,i))&&(a.width=Math.max(a.width,i.width-(a.left-i.left)),a.height=Math.max(a.height,i.height),s.add(i))})}),n.filter(a=>!s.has(a))},yie=e=>e.sort((t,n)=>{const s=vp(t),a=vp(n);return!s||!(a!=null&&a.point)?1:!a||!(s!=null&&s.point)?-1:s.pageNumber!==a.pageNumber?s.pageNumber-a.pageNumber:a.point.y-s.point.y}),vp=e=>{var i,l;const{type:t,pageNumber:n,pdfRects:s}=e;let{path:a}=e;if(t===_t.RECTANGLE||t===_t.HIGHLIGHT||t===_t.UNDERLINE||t===_t.STRIKETHROUGH){if(!s)return;const c=Object.keys(s);c.sort((h,p)=>Number(h)-Number(p));const d=c[0];if(!d)return;const u=[...(i=s[d])!=null?i:[]].sort((h,p)=>Math.max(p.y,p.yMax)-Math.max(h.y,h.yMax)),f=u==null?void 0:u[0];return f?{pageNumber:Number(d),point:{x:f.x,y:f.y}}:void 0}if(t===_t.ELLIPSE){const c=(l=s==null?void 0:s[n])==null?void 0:l[0];if(!c)return;a=[{x:c.x,y:c.y},{x:c.xMax,y:c.yMax}]}if(!a)return;const o=[...a].sort((c,d)=>c.y!==d.y?d.y-c.y:c.x-d.x);return{pageNumber:n,point:o[0]}},_T=e=>e===_t.RECTANGLE||e===_t.ELLIPSE||e===_t.POLYGON,eE=e=>{const t=ft(e.id,a=>{var o,i;return(i=(o=a==null?void 0:a.data.ref)==null?void 0:o.uuid)!=null?i:e.id}),n=go(t),s=r.jsxs(r.Fragment,{children:[r.jsxs("span",{className:"relative ",style:{fontSize:"20px"},children:[r.jsx(V,{name:"MIcPageUnable",size:"middle"}),r.jsx(V,{size:"normal",className:"absolute right-[-1px] bottom-[0]",name:"MIcBadgePagelink",style:{fontSize:"0.65em",color:"black"}})]}),r.jsx("span",{className:"relative ml-1 w-full font-medium underline decoration-grey5 underline-offset-2",children:"无法访问"})]});return e.disable?r.jsx("span",{className:R("px-0.5 items-center rounded p-1",e.className),children:s}):r.jsx(Fu,{to:n,className:"px-0.5 items-center rounded p-1 animate-hover cursor-pointer",children:s})},eA=[{title:"跟随系统",value:Ti.system},{title:"浅色",value:Ti.light},{title:"深色",value:Ti.dark}];var tE=(e=>(e.JUMP="jump",e.RIGHT_PAGE="rightPage",e))(tE||{});const tA=[{title:"跳转",value:"jump"},{title:"右侧打开",value:"rightPage"}],nA=[{title:Wa.fixed,value:Mb.FIXED},{title:"自适应宽度",value:Mb.AUTO}],xT=[{title:"默认字体",value:"default"}];xT.push({title:"霞鹜文楷",value:"lxgwWenKai"},{title:"思源宋体",value:"sourceHanSerif"});const sA=[{title:"紧密布局",value:"compact"},{title:"默认布局",value:"default"},{title:"宽松布局",value:"loose"}],Hm=()=>{const e=Ed();return y.useCallback((t,n={})=>{e.push({...e.location,search:uw.stringify({"right-page-id":t}),...n})},[e])},ys=()=>{const e=Ed(),t=Hm(),n=lt(),s=Un(),a=Ln(),o=II(),i=(l,c={})=>{const d=QZ(),{setting:u={}}=xa(),{hash:f="",onOpenInRight:h,forceOpenInRight:p,forceOpenNewTab:g,openWay:_}=c,x=o(l);if(g){window.open("".concat(x).concat(f));return}if(s===wt.FORM_ENG_PAGE){window.open("".concat(x).concat(f));return}if(o1()){e.push("".concat(x).concat(f));return}if(xt.$isMobileSize){e.push("".concat(x).concat(f));return}if(a){t(l,{hash:f});return}const F=()=>{if(d){e.push({...e.location,pathname:"/".concat(l),search:"?right-page-id=".concat(d)});return}e.push("".concat(x).concat(f))};if(n===l||l===d){n===l?F():t(l,{hash:f});return}if(p||_==="openInRight"){t(l,{hash:f}),h==null||h();return}if(_==="openFullscreen"){F();return}if(u.openPageMode===tE.RIGHT_PAGE){t(l,{hash:f}),h==null||h();return}F()};return y.useCallback(i,[e,a,o,t,n,s])},_m=e=>{const{clientX:t,clientY:n}=e;return{getBoundingClientRect:()=>({width:0,height:0,x:t,y:n,top:n,right:t,bottom:n,left:t,toJSON:()=>"null"})}},ra=e=>{if(!bie(e))return e;const t=e.getBoundingClientRect();return{getBoundingClientRect:()=>t}},bie=e=>!!(e!=null&&e.tagName),yg=y.createContext({interactable:!0,readonly:!1}),Vo=y.createContext(void 0),Fie=()=>y.useContext(Vo),bg=e=>r.jsx(r.Fragment,{children:e.children}),pr=Symbol("Page Scope"),nE=Mr("");let eM;const wie=e=>{eM=e},yT=e=>{const{pageId:t,blockId:n,loading:s,once:a}=e;let o=go(t);n&&(o+="#".concat(n));const i=rr(()=>dL({initialEntries:[o]}));return y.useEffect(()=>i.block(()=>!1),[i]),r.jsx(bg,{once:a,wait:1e3,waitMode:"debounce",children:r.jsx(uL,{history:i,children:r.jsx(yd,{scope:pr,initialValues:[[nE,t]],children:r.jsx(Mo.Provider,{value:wt.PAGE_LITE_PREVIEW,children:r.jsx(Vo.Provider,{value:uc.PAGE_LITE,children:r.jsx(Oo,{children:s?r.jsx(xs,{className:"flex-1"}):r.jsx(eM,{uuid:t})})})})})})})},tM=y.memo(e=>{const{id:t,className:n,share:s}=e;return r.jsx("iframe",{className:R("w-full h-full",n),sandbox:"allow-same-origin allow-top-navigation allow-forms	allow-scripts",src:"".concat(_n()).concat((s!=null?s:pt())?Nt.share:Nt.main).concat(t,"?").concat(dn.embed,"=true")})}),Eie=()=>{var i,l;const e=Un(),t=Ute(),n=!!y.useContext(rd),s=e===wt.MAIN||e===wt.SHARE||e===void 0,o=(l=(i=Ut().setting)==null?void 0:i.previewDialog)!=null?l:!0;return s&&!n&&o&&!t},P0=(e,t)=>{const n=Ja(),[s,a]=y.useState(()=>!Cie(e));return y.useLayoutEffect(()=>{(async()=>{s&&t&&(await n(e,{prefetch:!0}),a(!1))})()},[n,s,e,t]),s},Cie=e=>{var a,o;const t=J.blocks[e];return((a=t==null?void 0:t.subNodes.reduce((i,l)=>{const c=J.blocks[l];return c&&!tn(c==null?void 0:c.type)?i+1:i},0))!=null?a:0)*1/((o=t==null?void 0:t.subNodes.length)!=null?o:1)>.3};let nM;const sM=e=>{nM=e},Du=e=>{var E;const{isLink:t,pageId:n,blockId:s,mentionBlockMenuProps:a,showMoreBtn:o,hideOpenRightBtn:i}=e,l=ye(n,["data"]),c=y.useRef(),d=y.useMemo(()=>fe(l==null?void 0:l.data.segments)||qt(l==null?void 0:l.type),[l==null?void 0:l.data.segments,l==null?void 0:l.type]),[u,f]=yc(),h=Eie(),p=P0(n,u&&h),g=go(n),_=ys(),x=pt(),F=ie(),b=ln(),w=y.useRef();return y.useEffect(()=>()=>{w.current&&b(w.current)},[b]),y.useLayoutEffect(()=>{var v,I,j,S,D;if(!u||p)return;const C=(v=c.current)==null?void 0:v.querySelector(".page-header");C instanceof HTMLElement&&(C.hidden=!0);const k=(I=c.current)==null?void 0:I.querySelector(".footer");k instanceof HTMLElement&&(k.hidden=!0);const T=(D=(j=c.current)==null?void 0:j.querySelector("#".concat(Bm)))!=null?D:(S=c.current)==null?void 0:S.querySelector(".next-space-page");T instanceof HTMLElement&&T.childNodes.forEach(A=>{A instanceof HTMLElement&&A.setAttribute("style","padding-left:12px;padding-right:12px")})},[p,u]),h?r.jsxs("div",{id:"modalContent",ref:C=>{f(C),C&&(c.current=C)},className:R("page-preview rounded w-[500px] h-[300px] flex flex-col",e.className),style:e.style,children:[r.jsxs("div",{className:"flex items-center justify-between p-4",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(Fn,{trigger:!1,iconSize:20,tooltipClassName:"flex-shrink-0",hasOverlay:t,blockId:n,offset:[100,0],defaultIcon:r.jsx(_s,{uuid:n})}),r.jsx("div",{className:"ml-2 text-t2 h-6 overflow-hidden break-words",children:d})]}),!x&&r.jsxs("div",{className:"flex items-center shrink-0",children:[!o&&r.jsx(Fe,{popup:"复制链接",onClick:()=>{let C="";s&&(C="#".concat(s)),Xt("".concat(_n()).concat(g).concat(C))},children:r.jsx(V,{name:"IcLink",size:"middle",className:"cursor-pointer mr-4"})}),!i&&r.jsx(Fe,{popup:"侧边栏窗口打开",onClick:()=>{var C;_(n,{forceOpenInRight:!0,hash:s?"#".concat(s):void 0}),(C=e.onCloseOutsideModel)==null||C.call(e)},children:r.jsx(V,{name:"IcInSidePeek",size:"middle",className:R("cursor-pointer",{"mr-4":o})})}),o&&a&&r.jsx(Fe,{popup:"更多菜单",onClick:C=>{w.current=F.dropdown({popcorn:ra(C.currentTarget),content:({onCloseModal:k})=>r.jsx(nM,{...a,onCloseOutModel:()=>{var T;k(),(T=e.onCloseOutsideModel)==null||T.call(e)}})}).modalId},children:r.jsx(V,{name:"IcMore",size:"middle",className:"cursor-pointer"})})]})]}),r.jsx("div",{className:"h-px mx-4 bg-grey6"}),(E=e.children)!=null?E:r.jsx(yT,{pageId:n,blockId:s,loading:p})]}):null},rM=()=>{const e=ie();return y.useCallback(t=>{e.warning({title:"确定重置页面权限吗？",content:r.jsxs("div",{className:"text-left text-t2 space-y-2",children:[r.jsx("p",{children:"此操作可以恢复无权限访问的数据"}),r.jsx("p",{children:"页面位置可能会发生移动"})]}),confirmText:"确认",confirm:async()=>{await ve.editor.resetPagePermission(t),be.success("成功"),await es(1e3),location.reload()}})},[e])},_1=function(e){if(cO)return;const t=document.createElement("link"),n=document.getElementById("dynamic-favicon");t.id="dynamic-favicon",t.rel="shortcut icon",t.href=e,n&&document.head.removeChild(n),document.head.appendChild(t)},rA=(e,t)=>{const n=e.getContext("2d");if(!n)return;n.font="64px serif",n.fillText(t,0,54);const s=e.toDataURL();_1(s)},kie=(e,t)=>{const n=e.getContext("2d");if(!n)return;const s=new Image;s.setAttribute("crossOrigin","anonymous"),s.onload=()=>{const a=s.width/57;n.drawImage(s,t.sheet_x*a,t.sheet_y*a,a,a,0,0,e.width,e.height);const o=e.toDataURL();_1(o)},s.src="".concat(Lo,"assets/google_emoji.5dd44719.png")},Tie=function(e=""){if(!e){_1(vn.favicon);return}const t=document.createElement("canvas");if(t.height=64,t.width=64,Hl){rA(t,e);return}const n=J5(e,"google",qw());n?kie(t,n):rA(t,e)},vie=e=>{const t=document.querySelectorAll('meta[name="description"]'),n=document.querySelectorAll('meta[name="keywords"]'),s=e.replace(/\s+/g,"").substring(0,120),a=[...new Set(e.split("\n").map(l=>l.replace(/\s+/g,"")).filter(Boolean))].join(",").substring(0,120);n.length&&n.forEach(l=>l.remove());const o=document.createElement("meta");o.setAttribute("name","keywords"),o.setAttribute("content",a),document.head.appendChild(o),t.length&&t.forEach(l=>l.remove());const i=document.createElement("meta");i.setAttribute("name","description"),i.setAttribute("content",s),document.head.appendChild(i)},bT=qn(async e=>{var o;const{title:t,icon:n}=e,s=(o=n==null?void 0:n.type)!=null?o:"emoji",a=n==null?void 0:n.value;if(Ao(1e3).then(()=>{const i=bn(".next-space-page .block-content");i!=null&&i.innerText&&vie(i.innerText)}),cO){s==="upload"||s==="http"||s==="icon"||gs.check?document.title=t:document.title="".concat(a?"".concat(a," "):"").concat(t);return}if(document.title=t,(s==="upload"||s==="http"||s==="icon")&&a){let i=s==="icon"?c3(Xo(),a):a;s==="upload"&&(i=await Vs.fetchDownloadUrl({ossName:a,blockId:KZ()})),Gu(i)?_1(i):_1(vn.favicon)}else Tie(a)},500,{leading:!0,trailing:!0}),aM=()=>{const e=lt(),t=ye(e,["createdBy","updatedBy"]),n=Ut();return n.uuid===(t==null?void 0:t.createdBy)||n.uuid===(t==null?void 0:t.updatedBy)},Iie=()=>{const e=Ut();return y.useCallback(t=>{const n=J.blocks[t];return e.uuid===(n==null?void 0:n.createdBy)||e.uuid===(n==null?void 0:n.updatedBy)},[e.uuid])},bN=({type:e,onCloseModal:t,success:n,email:s})=>{const a=e==="justice";return r.jsxs("div",{className:"flex w-[400px] sm:w-full items-center flex-col p-7",children:[r.jsx("div",{className:"text-7xl md:text-3xl",children:n?"😀":"😔"}),r.jsxs("div",{className:"my-2.5 font-medium",children:[a&&(n?"提交成功，预计 3 个工作日内完成申诉审核":"审核中，你已申诉过该页面"),!a&&(n?"举报已提交，预计12小时内受理":"审核中，已举报过该页面")]}),r.jsxs("div",{className:"text-t2 text-center mb-7",children:[r.jsxs("div",{children:[a&&(n?"申诉结果会以邮件形式发送至你的邮箱":"72 小时内至多可提交 1 次申诉，请耐心等待复审结果"),!a&&(n?"我们会尽快进行人工审核，感谢你的支持":"一个分享链接7天内仅能举报一次，请耐心等待复审结果，感谢你的支持")]}),r.jsx("div",{className:"text-center text-active_color",children:a&&n&&s})]}),r.jsx("div",{onClick:t,className:"w-full animate-click bg-black text-center text-t2 py-1.5 text-white1 rounded",children:"知道了"})]})},Nie=["请选择","色情低俗","垃圾广告","造谣传谣","政治不实信息","涉嫌欺诈","涉嫌赌博","涉嫌非法集资","涉暴涉恐","邪教迷信","宣扬不良价值观","内容引人不适","危险行为","涉嫌侵权（交由我司人工审核）","其他违法违规"],aA=200,oM=({onCloseModal:e,uuid:t,type:n,blockType:s})=>{const a=ie(),[o,i]=y.useState({email:"",phone:"",complainType:0,description:"",pictureLinks:[],type:s!=null?s:"block"}),[l,c]=y.useState([]),[d,u]=y.useState(!1),f=Uo(),h=Ut(),p=n==="justice",g=p?!(o.email.trim()&&o.description.trim()):!(o.email.trim()&&o.complainType!==0),_=w=>E=>{w==="email"&&typeof E=="string"&&(E=E.replace(/\s+/g,"")),i(C=>({...C,[w]:E}))},x=w=>E=>{const C=E.target.files;if(!C||!C[0])return;const k=C[0];if(k.size>=1024*1024){be.error({content:"文件已超过 1M 大小"});return}f({file:k,type:"private",onComplete:T=>{T.success&&(i(v=>{const I=v.pictureLinks.slice();return I[w]=T.ossName,{...v,pictureLinks:I}}),c(v=>{const I=v.slice();return I[w]=URL.createObjectURL(k),I}))}})},F=w=>{a.modal({content:({onCloseModal:E})=>r.jsx(bN,{success:w,email:o.email,type:n,onCloseModal:E})})},b=async()=>{const w={...o,pictureLinks:o.pictureLinks.filter(Boolean)};if(!(g||d)){u(!0);try{if(p){const E=await ve.editor.shareAppeal.raw(t,w);E.code===200?(e(),F(!0)):E.code===1111&&(e(),F(!1))}else{const C=!!xa().uuid?await ve.editor.shareComplain.raw(t,w):await ve.editor.shareComplainUnSign.raw(t,w);C.code===200?(e(),F(!0)):C.code===1110&&(e(),F(!1))}}finally{u(!1)}}};return r.jsxs("div",{className:"p-4 width-600 sm:fixed sm:inset-0 sm:w-auto sm:h-auto sm:rounded-none sm:border-none text-t2",children:[r.jsx("div",{className:"text-grey3",children:p?"申诉服务":"举报分享内容"}),r.jsxs("div",{className:"my-4",children:["针对本文档发起",p?"申诉":"举报"]}),!p&&r.jsxs("div",{className:"flex relative items-center",children:[r.jsx("div",{className:"text-red",children:"*"}),r.jsx("div",{className:"mr-2 ml-1",children:"举报理由"}),r.jsx("select",{value:o.complainType,className:R("flex-1 py-1.5 px-3 border appearance-none rounded-sm border-grey06 bg-white1",{"text-grey2":o.complainType===0}),onChange:w=>_("complainType")(+w.target.value),children:Nie.map((w,E)=>r.jsx("option",{value:E,children:w},E))}),r.jsx(V,{name:"IcArrowDown01",size:"xxsmall",className:"absolute right-3 text-grey4"})]}),p?r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"mr-1 text-red",children:"*"}),r.jsx("div",{children:"申诉理由（如平台发生误判情况，请简要描述误判内容、提供相应材料依据）"})]}):r.jsx("div",{children:"举报描述"}),r.jsxs("div",{className:"relative my-2",children:[r.jsx("textarea",{className:"py-2 px-3 w-full bg-grey9 rounded border border-grey6 focus-within-border",rows:8,maxLength:aA,onChange:w=>_("description")(w.target.value)}),r.jsxs("div",{className:"absolute right-3 bottom-2",children:[o.description.length," ",r.jsx("span",{className:"text-grey3",children:"/ ".concat(aA)})]})]}),h.uuid&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-grey3",children:"添加图片（单张小于1M，至多上传3张）"}),r.jsx("div",{className:"flex my-2 space-x-5",children:Array.from(Array(3)).map((w,E)=>r.jsxs("label",{className:"flex object-contain overflow-hidden justify-center items-center w-9 h-9 bg-grey8 border border-black_006 border-dashed animate-click",children:[l[E]?r.jsx("img",{src:l[E],className:"w-full"}):r.jsx(V,{name:"IcBtnNew",size:"normal",className:"text-grey4"}),r.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:x(E)})]},E))})]}),r.jsxs("div",{className:"flex space-x-5 sm:block sm:space-x-0",children:[r.jsxs("div",{className:"flex-1 mt-4",children:[r.jsxs("div",{children:[r.jsx("span",{className:"mr-1 text-red",children:"*"}),"联系邮箱"]}),r.jsx(Ct,{value:o.email,onChange:_("email"),className:"mt-2 h-9"})]}),r.jsxs("div",{className:"flex-1 mt-4",children:[r.jsx("div",{children:"手机号"}),r.jsx(Ct,{maxLength:11,onChange:_("phone"),className:"mt-2 h-9"})]})]}),r.jsxs("div",{className:"flex justify-end mt-2.5",children:[r.jsx(De,{colorType:"primary",className:"mr-5",disable:g,onClick:b,children:"提交"}),r.jsx(De,{onClick:()=>e(),children:"取消"})]})]})},jie=({uuid:e})=>{const{parentId:t,isRestricted:n,illegal:s,role:a,shared:o}=mt(e,{wait:100}),{illegal:i}=mt(t!=null?t:e,{wait:100}),l=We(e),c=FN(e),d=T5(e),u=ie(),f=ye(e,["data"],["segments"]),h=wN(e),p=Sw(f==null?void 0:f.spaceId);if(!n&&!s||!f||f.parentId===f.spaceId||!o)return null;const g=()=>{u.warning({title:r.jsxs("div",{className:"px-5 w-80",children:[r.jsx("div",{children:"确认恢复权限继承？"}),r.jsx("div",{children:"将继承上级页面的协作分享设置，同时保留已有协作者"})]}),confirmText:"确认",confirm:()=>{d(),re(Sa()),me.event("restore_to_inherit")}})};return r.jsxs("div",{className:"flex justify-between items-center py-4 px-3 text-grey3 bg-grey9 border-t border-grey6 text-t2",children:[r.jsxs("div",{className:"flex items-center text-t4",children:[(s||t)&&r.jsx(V,{name:"IcShareDanger",size:"small",className:"mr-1"}),s?r.jsxs("span",{children:["该页面涉嫌违反",r.jsx(Fu,{to:"".concat(p,"/").concat(e),className:"ml-1 text-active_color underline animate-click",children:"平台分享政策"}),"，无法继续分享"]}):r.jsx(r.Fragment,{children:t&&r.jsxs("div",{className:"flex font-medium text-grey3 text-t4",children:[n?"不延用上级":"延用上级",r.jsx(Fu,{to:"".concat(p,"/").concat(t),className:"text-black animate-click max-w-[80px] text-ellipsis mx-1",children:i?Ts:oI(f.type,f.data.segments)}),n?"的权限":"的分享"]})})]}),!l&&(s&&h?r.jsx("div",{onClick:c,className:"shrink-0 font-medium text-black text-t4-medium animate-click",children:"我要申诉"}):n&&a===m.PermissionRole.EDITOR&&r.jsx("div",{onClick:g,className:"shrink-0 self-start mr-1 text-black text-t4-medium animate-click",children:"恢复权限继承"}))]})},FN=(e,t)=>{const n=ie();return y.useCallback(()=>{let s;(a=>{a.report="complain",a.justice="appeal"})(s||(s={})),ve.editor.shareCheck(e,"appeal").then(a=>{a===!1?n.modal({content:({onCloseModal:o})=>r.jsx(bN,{success:!1,type:"justice",onCloseModal:o})}):n.modal({content:({onCloseModal:o})=>r.jsx(oM,{blockType:t==null?void 0:t.blockType,type:"justice",uuid:e,onCloseModal:o})})})},[e,n,t==null?void 0:t.blockType])},wN=e=>{const{role:t}=mt(e),n=Iie();return[m.PermissionRole.COMMENTER,m.PermissionRole.READER,m.PermissionRole.EDITOR,m.PermissionRole.WRITER].includes(t)||n(e)};var zo=(e=>(e[e.LOGIN=0]="LOGIN",e[e.FORGET_PASSWORD=1]="FORGET_PASSWORD",e[e.REGISTER=2]="REGISTER",e[e.BIND_PHONE=3]="BIND_PHONE",e[e.WECHAT_LOGIN=4]="WECHAT_LOGIN",e[e.QQ_LOGIN=5]="QQ_LOGIN",e[e.COMPLETE=6]="COMPLETE",e[e.JOIN_TEAM_SPACE=7]="JOIN_TEAM_SPACE",e[e.LOGIN_VERIFY_CODE=8]="LOGIN_VERIFY_CODE",e[e.EMAIL_LOGIN=9]="EMAIL_LOGIN",e[e.MULTI_LOGIN=10]="MULTI_LOGIN",e))(zo||{}),la=(e=>(e[e.CAN_SIGN=0]="CAN_SIGN",e[e.CAN_LOGIN=1]="CAN_LOGIN",e[e.NEED_BIND_PHONE=2]="NEED_BIND_PHONE",e[e.BIND_FAIL=3]="BIND_FAIL",e))(la||{});const iM=e=>y.useCallback(n=>{if(!n.nickname||n.occupation===void 0||n.occupation===0){e({type:zo.COMPLETE,props:{userId:n.uuid}});return}return!0},[e]),{Login:Sie}=Qn(()=>Pe(()=>import("./login-abe67bb6.js"),["assets/login-abe67bb6.js","assets/vendor-2890c4d6.js","assets/title-185783e5.js","assets/verify-code-login-f379b195.js","assets/use-init-yidun-captcha-66ade2f0.js"])),{ForgetPassword:Die}=Qn(()=>Pe(()=>import("./forget-password-88a9b989.js"),["assets/forget-password-88a9b989.js","assets/vendor-2890c4d6.js","assets/use-init-yidun-captcha-66ade2f0.js","assets/title-185783e5.js"])),{BindPhone:Aie}=Qn(()=>Pe(()=>import("./bind-phone-276c6dd9.js"),["assets/bind-phone-276c6dd9.js","assets/vendor-2890c4d6.js","assets/use-init-yidun-captcha-66ade2f0.js","assets/title-185783e5.js","assets/avatar-3c2baad9.js"])),{WechatLogin:Rie}=Qn(()=>Pe(()=>import("./wechat-login-9c819ff8.js"),["assets/wechat-login-9c819ff8.js","assets/vendor-2890c4d6.js"])),{WechatLoginElectron:Pie}=Qn(()=>Pe(()=>import("./wechat-login-electron-af83311b.js"),["assets/wechat-login-electron-af83311b.js","assets/vendor-2890c4d6.js"])),{QQLogin:Lie}=Qn(()=>Pe(()=>import("./qq-login-11927acd.js"),["assets/qq-login-11927acd.js","assets/vendor-2890c4d6.js"])),{Complete:Bie}=Qn(()=>Pe(()=>import("./complete-ee821d68.js"),["assets/complete-ee821d68.js","assets/vendor-2890c4d6.js","assets/occupation-list-5adbf635.js","assets/select-button-4f737be4.js","assets/title-185783e5.js"])),{Register:Oie}=Qn(()=>Pe(()=>import("./register-771a9716.js"),["assets/register-771a9716.js","assets/vendor-2890c4d6.js","assets/verify-code-login-f379b195.js","assets/use-init-yidun-captcha-66ade2f0.js","assets/title-185783e5.js"])),{Login:Mie}=Qn(()=>Pe(()=>import("./login-2375d973.js"),["assets/login-2375d973.js","assets/vendor-2890c4d6.js","assets/use-login-google-ffd73e92.js","assets/title-185783e5.js","assets/use-login-buildin-c2b2bd14.js","assets/verify-code-login-1b24949f.js"])),{ForgetPassword:Uie}=Qn(()=>Pe(()=>import("./forget-password-c2b23cba.js"),["assets/forget-password-c2b23cba.js","assets/vendor-2890c4d6.js","assets/title-185783e5.js","assets/use-login-buildin-c2b2bd14.js"])),{Complete:Vie}=Qn(()=>Pe(()=>import("./complete-a2fbbdb5.js"),["assets/complete-a2fbbdb5.js","assets/vendor-2890c4d6.js","assets/occupation-list-5adbf635.js","assets/select-button-4f737be4.js","assets/title-185783e5.js"])),{Register:$ie}=Qn(()=>Pe(()=>import("./register-66f0b807.js"),["assets/register-66f0b807.js","assets/vendor-2890c4d6.js","assets/verify-code-login-1b24949f.js","assets/title-185783e5.js","assets/use-login-buildin-c2b2bd14.js"])),{Login:Hie}=Qn(()=>Pe(()=>import("./login-23fad9df.js"),["assets/login-23fad9df.js","assets/vendor-2890c4d6.js","assets/title-185783e5.js","assets/title-4d17560c.js","assets/verify-code-login-61544b33.js","assets/use-init-yidun-captcha-66ade2f0.js"])),{Register:zie}=Qn(()=>Pe(()=>import("./register-8c6f6dcf.js"),["assets/register-8c6f6dcf.js","assets/vendor-2890c4d6.js","assets/verify-code-login-61544b33.js","assets/use-init-yidun-captcha-66ade2f0.js","assets/title-4d17560c.js"])),{VerifyCodeLogin:qie}=Qn(()=>Pe(()=>import("./verify-code-login-61544b33.js"),["assets/verify-code-login-61544b33.js","assets/vendor-2890c4d6.js","assets/use-init-yidun-captcha-66ade2f0.js","assets/title-4d17560c.js"])),{ForgetPassword:Gie}=Qn(()=>Pe(()=>import("./forget-password-60d77e0a.js"),["assets/forget-password-60d77e0a.js","assets/vendor-2890c4d6.js","assets/use-init-yidun-captcha-66ade2f0.js","assets/captcha-8626b4b7.js","assets/title-4d17560c.js"])),{Complete:Wie}=Qn(()=>Pe(()=>import("./complete-46f91d34.js"),["assets/complete-46f91d34.js","assets/vendor-2890c4d6.js","assets/occupation-list-5adbf635.js","assets/title-4d17560c.js","assets/select-button-d6ac1849.js"])),{BindPhone:Kie}=Qn(()=>Pe(()=>import("./bind-phone-1307661f.js"),["assets/bind-phone-1307661f.js","assets/vendor-2890c4d6.js","assets/use-init-yidun-captcha-66ade2f0.js","assets/captcha-8626b4b7.js","assets/title-4d17560c.js"])),{Login:Yie}=Qn(()=>Pe(()=>import("./login-163e872f.js"),["assets/login-163e872f.js","assets/vendor-2890c4d6.js","assets/title-4d17560c.js","assets/use-login-buildin-c2b2bd14.js","assets/verify-code-login-cd1e64d4.js","assets/captcha-8626b4b7.js","assets/use-login-google-ffd73e92.js"])),{Register:Xie}=Qn(()=>Pe(()=>import("./register-5926d8bb.js"),["assets/register-5926d8bb.js","assets/vendor-2890c4d6.js","assets/verify-code-login-cd1e64d4.js","assets/captcha-8626b4b7.js","assets/title-4d17560c.js","assets/use-login-buildin-c2b2bd14.js"])),{VerifyCodeLogin:Qie}=Qn(()=>Pe(()=>import("./verify-code-login-cd1e64d4.js"),["assets/verify-code-login-cd1e64d4.js","assets/vendor-2890c4d6.js","assets/captcha-8626b4b7.js","assets/title-4d17560c.js","assets/use-login-buildin-c2b2bd14.js"])),{ForgetPassword:Jie}=Qn(()=>Pe(()=>import("./forget-password-ecbf7269.js"),["assets/forget-password-ecbf7269.js","assets/vendor-2890c4d6.js","assets/captcha-8626b4b7.js","assets/title-4d17560c.js","assets/use-login-buildin-c2b2bd14.js"])),{Complete:Zie}=Qn(()=>Pe(()=>import("./complete-4f7df60a.js"),["assets/complete-4f7df60a.js","assets/vendor-2890c4d6.js","assets/occupation-list-5adbf635.js","assets/title-4d17560c.js","assets/select-button-d6ac1849.js"])),ele=(e,t)=>{switch(e){case zo.LOGIN:{switch(t){case"default":return Sie;case"lite":return Hie;case"build-in-pc":return Mie;case"build-in-lite":return Yie}break}case zo.FORGET_PASSWORD:{switch(t){case"default":return Die;case"lite":return Gie;case"build-in-pc":return Uie;case"build-in-lite":return Jie}break}case zo.REGISTER:{switch(t){case"default":return Oie;case"lite":return zie;case"build-in-pc":return $ie;case"build-in-lite":return Xie}break}case zo.BIND_PHONE:{switch(t){case"default":return Aie;case"lite":return Kie}break}case zo.WECHAT_LOGIN:return XF?Pie:Rie;case zo.COMPLETE:{switch(t){case"default":return Bie;case"lite":return Wie;case"build-in-pc":return Vie;case"build-in-lite":return Zie}break}case zo.QQ_LOGIN:return Lie;case zo.LOGIN_VERIFY_CODE:return t==="lite"?qie:Qie;default:return()=>null}},lM="next_lng";var Gb=(e=>(e.en="en",e.zhHans="zh-Hans",e.zhHant="zh-Hant",e.ja="ja",e.ko="ko",e.fr="fr",e.de="de",e.es="es",e.ru="ru",e))(Gb||{});const oA=[{title:"English",value:"en"},{title:"Русский",value:"ru"},{title:"繁體中文",value:"zh-Hant"},{title:"简体中文",value:"zh-Hans"}],tle=()=>({currentLanguage:rr(()=>{const n=cM();return oA.find(s=>s.value===n)||oA[0]}),changeLanguage:n=>{tm.set(lM,n,{expires:new Date(new Date().getTime()+365*24*60*60*1e3)})}}),cM=()=>{const e=String(tm.get(lM));return nle(e.trim())},nle=e=>{const t=e.toLocaleLowerCase();return["zh-TW","zh-HK","zh-MO","zh-TW","zh-CHT","zh-Hant","tc"].map(o=>o.toLocaleLowerCase()).includes(t)?"zh-Hant":["zh-Hans","hans","zh-CN","zh"].map(o=>o.toLocaleLowerCase()).includes(t)?"zh-Hans":["ru-RU","ru"].map(o=>o.toLocaleLowerCase()).includes(t)?"ru":e},sle={"password wrong":"Incorrect password","verify failed":"Verify failed","Verify the login password":"Verify the login password","Please enter your current login password":"Enter your password","next step":"Continue","before start":"Before start","Please complete the account information":"Please complete the account information","Please input your nickname":"Enter your nickname","Select Identify":"Select Identify",Start:"Start",Score:"Points +5","Setting password":"Setting password","Ensure to Login":"Ensure to Login","Welcome to join":"Welcome to join","Forget Password":"Forgot Password","Please input email":"Enter your email address","Reset password after verify":"Reset password after verify","password format":"6-16 characters, must include numbers, uppercase and lowercase letters","Please input password":"Enter your password","Go back to login":"Back to login","Login by verify code":"Login by verify code",Register:"Register","Login by password":"Login by password","Other Login":"Other Login","Welcome to":"Welcome to","Welcome back":"Welcome back",Continue:"Continue","get score from invite code":"get score from invite code (optional)",forgot_password:"Forgot password",login:"Login",reset_password:"Reset password","input verify code":"Input verify code"},iA={pkg_login:sle},rle={"password wrong":"密码不对","verify failed":"验证失败","Verify the login password":"验证登录密码","Please enter your current login password":"请输入当前登录密码","next step":"下一步","before start":"开始之前","Please complete the account information":"请完善账号信息，可领取5积分，积分支持兑换会员权益","Please input your nickname":"请输入您的昵称，长度需在2-20个字符","Select Identify":"请选择真实身份可获得定制化服务",Start:"开始使用",Score:"积分+5","Setting password":"设置密码","Ensure to Login":"确认并登录","Welcome to join":"欢迎加入","Forget Password":"忘记密码","Please input email":"请输入邮箱","Reset password after verify":"验证账号后可重设密码","password format":"6-16位密码，需包含数字、英文大写字母和小写字母","Please input password":"请输入密码","Go back to login":"返回登录页","Login by verify code":"使用验证码登录",Register:"注册账号","Login by password":"使用密码登录","Other Login":"其他登录方式","Welcome to":"欢迎来到","Welcome back":"欢迎回来",Continue:"继续","get score from invite code":"请输入邀请码领取额外积分（选填）",forgot_password:"忘记密码",login:"登录",reset_password:"重置密码","input verify code":"请输入验证码"},lA={pkg_login:rle},ale={"password wrong":"Неверный пароль","verify failed":"Ошибка проверки","Verify the login password":"Подтвердите пароль для входа","Please enter your current login password":"Введите пароль","next step":"Продолжить","before start":"Перед началом","Please complete the account information":"Заполните информацию об аккаунте","Please input your nickname":"Введите ваш Имя","Select Identify":"Выберите идентификацию",Start:"Начать",Score:"Баллы +5","Setting password":"Настройка пароля","Ensure to Login":"Подтвердить вход","Welcome to join":"Добро пожаловать","Forget Password":"Забыли пароль","Please input email":"Введите адрес электронной почты","Reset password after verify":"Сброс пароля после проверки","password format":"6-16 символов, должны включать цифры, прописные и строчные буквы","Please input password":"Введите пароль","Go back to login":"Вернуться к входу","Login by verify code":"Вход по коду подтверждения",Register:"Регистрация","Login by password":"Вход по паролю","Other Login":"Другие способы входа","Welcome to":"Добро пожаловать в","Welcome back":"С возвращением",Continue:"Продолжить","get score from invite code":"получить баллы по пригласительному коду (необязательно)",forgot_password:"Забыли пароль",login:"Войти",reset_password:"Сбросить пароль","input verify code":"Введите код подтверждения"},cA={pkg_login:ale},ole={en:{translation:iA,...iA},zhHans:{translation:lA,...lA},ru:{translation:cA,...cA}},ile="next_lng",lle=e=>["zh-hk","zh-mo","zh-tw","zh-cht","zh-hant"].includes(e.toLowerCase())?Gb.zhHant:["zh","zh-cn"].includes(e.toLowerCase())?Gb.zhHans:e,dA=EW.createInstance({fallbackLng:Gb.en,lng:cM(),resources:ole,returnObjects:!0,detection:{order:["cookie"],caches:["cookie"],cookieOptions:{maxAge:31536e6},lookupCookie:ile,convertDetectedLanguage:e=>lle(e)}},()=>{}),cle=e=>{var F;const{complete:t=!0,styleType:n="default"}=e,[s,a]=y.useState((F=e.defaultViewState)!=null?F:{type:zo.LOGIN}),{onSuccess:o,onStep:i,onFooterChange:l,...c}=e,d=y.useRef();d.current=e.onSuccess;const u=y.useRef();u.current=e.onFooterChange;const f=y.useCallback(b=>{a(w=>({...w,...b}))},[]),h=iM(f);y.useEffect(()=>{e.autoLogin&&Zt.request.infra.getMyUserInfo.raw().then(b=>{var w;b.code===200&&(!t||h(b.data))&&((w=d.current)==null||w.call(d,b.data,{isAuto:!0}))})},[h,t,e.autoLogin]),y.useEffect(()=>{var b;(b=e.onStep)==null||b.call(e,s.type)},[e,s.type]);const p=ele(s.type,n),g=n==="build-in-pc",_=g?CW:y.Fragment,x={};return g&&(x.i18n=dA),typeof document<"u"?r.jsx(y.Suspense,{fallback:r.jsx("div",{}),children:r.jsx(_,{...x,children:r.jsx(p,{...c,...s.props,switchViewType:f,complete:t,styleType:n,onSuccess:d.current,onFooterChange:u.current})})}):r.jsx(_,{i18n:dA,children:r.jsx(p,{...c,...s.props,switchViewType:f,complete:t,styleType:n,onSuccess:d.current,onFooterChange:u.current})})},uA=()=>{const e="".concat(Zt.cdnHost,"fe-web-app-images/packges-login");return{qqLogo:"".concat(e,"/qq_logo.svg"),wechatBtn:"".concat(e,"/wechat_btn.svg"),wechatLogoLogin:"".concat(e,"/wechat_login_logo.svg"),IcTitleClose:"".concat(e,"/ic_title_close.svg"),IcMenuItemShow:"".concat(e,"/ic_menu_item_show.svg"),IcMenuItemHide:"".concat(e,"/ic_menu_item_hide.svg"),IcLoginCode:"".concat(e,"/ic_login_code.svg"),IcArrow:"".concat(e,"/ic_arrow.svg"),IcArrowRight:"".concat(e,"/ic_arrow_right.svg"),IcSelectedSpace:"".concat(e,"/ic_space_selected.svg"),IcInviteInfo:"".concat(e,"/ic_invite_info.svg"),IcWarning:"".concat(e,"/ic_warning.svg"),googleLogo:"".concat(e,"/google-logo.png"),partnership:"".concat(e,"/partnership.svg")}},Wb=new Proxy(uA(),{get:(e,t)=>uA()[t]}),dle=e=>r.jsx("div",{className:"my-3 tracking-wide text-center text-t4 h-md:text-t2 text-black",children:e.showScoreRule?r.jsxs("div",{className:"flex items-center justify-center w-full",children:[r.jsx("img",{src:Wb.IcInviteInfo,className:"w-5 h-5 mr-1"}),r.jsx("a",{className:"underline",target:"_blank",href:ZY,rel:"noreferrer",children:"了解积分规则"})]}):r.jsxs(r.Fragment,{children:["点击",e.isJoinTeam?"加入团队":"继续"," ",r.jsx("span",{children:"代表你同意"})," ",r.jsx("a",{className:"underline",target:"_blank",href:ds.userAgreement,rel:"noreferrer",children:"用户协议"})," ",r.jsx("span",{children:"和"})," ",r.jsx("a",{className:"underline",target:"_blank",href:ds.privacyPolicy,rel:"noreferrer",children:"隐私政策"})]})}),sE=()=>{const e=ie(),t=lt(),n=s=>{const a=new URLSearchParams(location.search).get(dn.promotionChannel);e.modal({content:()=>r.jsxs("div",{className:"overflow-y-auto w-[450px] px-14 py-[30px]",children:[r.jsx(cle,{promotionChannel:a!=null?a:void 0,hideThirdPartLogin:!1,inviteCodeRequired:!1,defaultTitle:s==null?void 0:s.defaultTitle,onSuccess:()=>{Eu()?location.href="".concat(Jh,"/").concat(t):location.reload()},styleType:wu()?"build-in-pc":"default"}),r.jsx("div",{className:"h-5"}),r.jsx(dle,{})]})})};return y.useCallback(n,[e,t])},dM=e=>{const{icon:t,title:n,description:s,children:a,className:o}=e;return r.jsxs("div",{className:R("login-wrapper",o),children:[t&&r.jsx("p",{className:"text-[70px] leading-[80px] mb-2",children:r.jsx(na,{disableHover:!0,emojiStr:t})}),n&&r.jsx("div",{className:"text-h4 mb-2",children:n}),s&&r.jsx("div",{className:"text-t2 mb-5 text-grey3",children:s}),a]})},ule=()=>{const e=sE(),t=Ut(),n=z9(),s=!!t.uuid,a=lt(),[o,i]=y.useState(),l=s,c=rM();y.useEffect(()=>{a&&ve.editor.getDocPublicData.raw(a).then(f=>{f.code===200&&i(f.data)}).catch(f=>f)},[a]);const d=()=>{Xt(window.location.href.replace("/share",""))},u=f=>"".concat(f==null?void 0:f.nickname,"（").concat(Cm((f==null?void 0:f.phone)||(f==null?void 0:f.email)),"）");return r.jsx(r.Fragment,{children:r.jsx("div",{className:R(l?"flex flex-col items-center justify-center h-full":"login-wrapper"),children:r.jsxs("div",{className:"text-center w-full",children:[r.jsx("p",{className:"text-[70px] leading-[80px]",children:"✋"}),l?r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"text-h0",children:kZ}),o&&r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"text-t2 text-grey3 py-4",children:"本页面来自空间"}),r.jsxs("div",{className:"flex justify-center items-center mx-auto",children:[r.jsx(ar,{className:"flex-shrink-0 mr-3 w-[26px] h-[26px]",icon:o.spaceIcon,name:o.spaceTitle,color:o.spaceBackgroundColor}),r.jsx("span",{className:"text-t2-medium text-ellipsis",children:o.spaceTitle})]}),r.jsx("div",{className:"mt-9 rounded border border-grey6 bg-grey9 p-3 width-600 mx-auto sm:w-10/12",children:o.spaceId&&n[o.spaceId]?r.jsxs("div",{className:"text-left",children:[r.jsx("p",{children:"请发送页面链接给以下成员开通权限："}),r.jsx("p",{children:u(o.ownerUser)}),r.jsxs("div",{className:"flex justify-between items-center mt-12",children:[r.jsxs("div",{className:"text-t2 text-grey3",children:["当前登录账号：",u(t)]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(De,{hidden:!(o!=null&&o.allowResetPagePermission),onClick:()=>c(a),children:"恢复访问权限"}),r.jsx(De,{onClick:d,colorType:"primary",children:"复制链接"})]})]})]}):r.jsxs("div",{className:"text-center",children:[r.jsx("p",{children:"你不是空间成员或访客，无法访问。"}),r.jsx("p",{children:"请联系管理员添加。"}),r.jsxs("div",{className:"mt-8 text-t2 text-grey3",children:["当前登录账号：",u(t)]})]})})]})]}):r.jsx("p",{className:"text-t2 text-grey3 my-2",children:"当前页面未开启分享"}),!s&&r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"mb-4 text-t3 text-grey4",children:"如你拥有访问权限，请尝试登录后查看"}),r.jsx(De,{colorType:"primary",size:"large",className:"mt-2 w-32 mx-auto",onClick:()=>e({defaultTitle:o==null?void 0:o.spaceTitle}),children:"登录"})]})]})})})},L0=({uuid:e,className:t})=>{const n=FN(e),s=wN(e);return r.jsx(dM,{icon:"🚫",title:"当前页面违反平台分享条例，已禁止访问",className:t,children:s&&r.jsx(De,{size:"large",onClick:n,colorType:"primary",className:"mt-3",children:"我要申诉"})})},Fg=({title:e,description:t,showBackButton:n=!0,children:s,icon:a})=>{const o=ns(),i=()=>{o.replace(Nt.main)},l=Ln();return y.useEffect(()=>{l||bT({title:"访问的页面不存在",icon:{type:"emoji",value:a!=null?a:"🌚"}})},[a,l]),r.jsxs("div",{className:"cursor-default login-wrapper w-full",style:{height:"calc(100% - 144px)"},children:[a?r.jsx("p",{className:"text-[70px]",children:a}):r.jsx("img",{className:"w-[130px] dark:contrast-0",src:vn.pageEmpty}),r.jsx("p",{className:"my-8 text-grey3 text-t2",children:e!=null?e:"访问的页面不存在"}),t?r.jsx("p",{className:"text-t2 text-grey3",children:t}):n?r.jsx(De,{colorType:"primary",onClick:i,children:"返回到空间"}):null,s]})};const fle=({downloadUrl:e})=>{const[t,n]=y.useState("");return r.jsx(kW,{autoPlay:!1,preload:"none",autoPlayAfterSrcChange:!1,src:e,onError:s=>{const{error:a}=s.target;if(!(!a||!e))switch(a.code){case MediaError.MEDIA_ERR_DECODE:n("视频解码时发生错误");break;case MediaError.MEDIA_ERR_NETWORK:n("加载失败");break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:n("浏览器不支持播放该音频源");break}},onPlayError:s=>{t?be.warning({key:t,content:t}):be.warning({key:s.message,content:s.message})}})},mle=fn.memo(fle),hle=e=>{const t=ye(e.uuid,[]),n=Un(),s=pt(),a=ya(),o=ln(),[i,l]=y.useState(1),c=u=>{l(u)};return po(t==null?void 0:t.spaceId)?r.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center",onClick:()=>{o(Ve.FILE_PREVIEW)},children:[r.jsx("p",{className:"text-[70px] leading-[80px] text-center",children:"👀"}),r.jsx("p",{className:"".concat(n===wt.PAGE_LITE_PREVIEW,"?'text-black' :text-white"),children:s?"当前格式不支持预览":"仅支持【专业版】或【团队版】预览"}),!s&&r.jsx(De,{className:"mt-3",onClick:u=>{u.stopPropagation(),a(Mt.view_epub)},children:"升级空间"})]}):r.jsx("div",{className:"w-full h-full",children:r.jsx(TW.ReactReader,{epubInitOptions:{openAs:"epub"},location:i,locationChanged:c,url:e.downloadUrl})})};function ple(){return typeof window<"u"?window.innerWidth:0}const s_=new Map,fA=40,gle=0,FT=({downloadUrl:e})=>{const t=y.useRef(null),n=y.useRef(null),s=y.useRef(null),a=y.useRef(),o=y.useRef(),i=y.useRef(),[l,c]=y.useState(!1),[d,u]=y.useState(""),f=ln(),h=y.useCallback((w,E)=>{let C=o.current.height-gle*2,k=o.current.width-fA*2;C=Math.min(C,E),k=Math.min(k,w);const T=k/C,v=w/E;return T>v?{width:w*C/E,height:C}:{width:k,height:E*k/w}},[]),p=y.useCallback(async()=>new Promise(w=>{if(s_.has(e)){w();return}const E=new Image;E.onload=()=>{s_.set(e,{width:E.width,height:E.height}),w()},E.src=e}),[e]),g=y.useCallback(({zoom:w=1})=>{const{width:E,height:C}=s_.get(e),{width:k}=h(E,C);let T=0;const v=ple();E>v&&(T+=(v-E)/2);const I=w*(k/E);a.current={x:T,scaleFactor:I,maxScaleFactor:(o.current.width-fA*2)/E},u("translate3d(".concat(T,"px,0px,0) scale3d(").concat(I,",").concat(I,",1)"))},[h,e]),_=y.useCallback(async()=>{await p(),g({})},[g,p]),x=y.useCallback(w=>{var v,I;const E=(v=n.current)==null?void 0:v.style.transform.split("scale3d(");if(!E)return;const C=(I=E[1])==null?void 0:I.split(",")[0];let k=Number(C);w==="in"?k=Math.max(Number(C)*.8,a.current.scaleFactor/3):k=Math.min(Number(C)*1.2,a.current.maxScaleFactor);let T=0;s_.get(e).height*k+16>o.current.height&&(T=(s_.get(e).height*k+16-o.current.height)/2),u("translate3d(".concat(a.current.x,"px,").concat(T,"px,0) scale3d(").concat(k,",").concat(k,",1)"))},[e]);y.useEffect(()=>{var w;return o.current=(w=t.current)==null?void 0:w.getBoundingClientRect(),_(),()=>F()},[_]);const F=()=>{i.current&&clearTimeout(i.current)},b=w=>{var C;if((C=s.current)!=null&&C.contains(w.target)){F();return}const E=()=>{i.current=setTimeout(()=>{F(),c(!1)},1e3)};l?(F(),E()):(c(!0),E())};return r.jsx("div",{className:"absolute top-2 bottom-2 left-0 w-full overflow-y-auto py-2",ref:t,onMouseMove:b,onClick:w=>{var E;(E=s.current)!=null&&E.contains(w.target)||f(Ve.FILE_PREVIEW)},children:d?r.jsxs(r.Fragment,{children:[r.jsxs("div",{ref:s,className:R("fixed z-50 flex items-center px-1 py-1 -translate-x-1/2 bg-black-base/90 left-1/2 bottom-1 rounded transition-opacity duration-150",l?"opacity-100":"opacity-0"),children:[r.jsx("button",{onClick:()=>x("in"),className:"flex items-center justify-center p-2 mr-1 rounded animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(V,{name:"MIcZoomIn",size:"large"})}),r.jsx("button",{onClick:()=>x("out"),className:"flex items-center justify-center p-2 rounded animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(V,{name:"MIcZoomOut",size:"large"})})]}),r.jsx("img",{className:"absolute top-0 bottom-0 left-0 right-0 mx-auto my-auto max-w-none",src:e,alt:"大图预览",style:{transform:d},ref:n})]}):r.jsx($s,{className:"absolute top-0 bottom-0 left-0 right-0 mx-auto my-auto"})})};var uM=function(e,t){return(uM=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var a in s)s.hasOwnProperty(a)&&(n[a]=s[a])})(e,t)};function EN(e,t){function n(){this.constructor=e}uM(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Kb,Vh,O_,M_,qr=function(){return(qr=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function Gr(e,t,n,s){return new(n||(n=Promise))(function(a,o){function i(d){try{c(s.next(d))}catch(u){o(u)}}function l(d){try{c(s.throw(d))}catch(u){o(u)}}function c(d){var u;d.done?a(d.value):(u=d.value,u instanceof n?u:new n(function(f){f(u)})).then(i,l)}c((s=s.apply(e,t||[])).next())})}function Wr(e,t){var n,s,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(c){return function(d){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,s&&(a=2&u[0]?s.return:u[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,u[1])).done)return a;switch(s=0,a&&(u=[2&u[0],a.value]),u[0]){case 0:case 1:a=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,s=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){i=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){i.label=u[1];break}if(u[0]===6&&i.label<a[1]){i.label=a[1],a=u;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(u);break}a[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(f){u=[6,f],s=0}finally{n=a=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([c,d])}}}(function(e){e.refreshToken="api.getToken"})(Kb||(Kb={})),function(e){e.unknown="unknown",e.spreadsheet="s",e.writer="w",e.presentation="p",e.pdf="f",e.otl="o",e.dbt="d",e.ksheet="k"}(Vh||(Vh={})),function(e){e.nomal="nomal",e.simple="simple",e.embed="embed"}(O_||(O_={})),function(e){e[e.requestFullscreen=1]="requestFullscreen",e[e.exitFullscreen=0]="exitFullscreen"}(M_||(M_={}));var _le=window.navigator.userAgent.toLowerCase(),xle=/iPhone|iPod|iPad/i.test(_le);function Ly(e){if(!e)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var yle=function(){function e(t,n,s,a,o,i,l){var c=this;o===void 0&&(o=!0),i===void 0&&(i=!1),l===void 0&&(l={}),this.instance=t,this.instanceId=n,this.url=s,this.mount=a,this.isListenResize=o,this.addedStyles=i,this.customAttrs=l,this.handleResize=function(){var d=c.mount,u=c.mountResizeObserver,f=d.clientHeight,h=d.clientWidth;f!==0||h!==0||u?f===0&&h===0||!u||(u.disconnect(),u=null):window.ResizeObserver&&(u=new ResizeObserver(function(p){c.handleResize()})).observe(d),c.iframe.style.cssText+="height: "+d.clientHeight+"px; width: "+d.clientWidth+"px"},this.iframe=this.initIframe()}return e.prototype.initIframe=function(){var t=this,n=this.mount,s=document.createElement("iframe");s.classList.add("web-office-iframe");var a=this.mergeAttrs({id:"office-iframe-"+this.instanceId,src:this.url,scrolling:"no",frameborder:"0",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"true",mozallowfullscreen:"true",allow:"clipboard-read; clipboard-write"});for(var o in n?(a.style="width: "+n.clientWidth+"px; height: "+n.clientHeight+"px;",this.isListenResize&&window.addEventListener("resize",this.handleResize)):((n=document.createElement("div")).classList.add("web-office-default-container"),this.addedStyles||this.addStylesheetRules(".web-office-default-container {position: absolute; padding: 0;  margin: 0; width: 100vw; height: 100vh; left: 0; top: 0;}"),document.body.appendChild(n),a.style="width: 100vw; height: 100vh;"),xle&&window.visualViewport&&this.isListenResize&&window.visualViewport.addEventListener("resize",function(){var i=window.visualViewport,l=i.width,c=i.height,d=document.body.clientHeight-t.iframe.clientHeight;t.instance.sendMsgToWps({eventName:"visualViewportResize",data:{width:l,height:c-d}})}),a)s.setAttribute(o,a[o]);return n.appendChild(s),s.destroy=function(){window.removeEventListener("resize",t.handleResize),s.parentNode.removeChild(s),s=null,t.mountResizeObserver&&(t.mountResizeObserver.disconnect(),t.mountResizeObserver=null)},s},e.prototype.destroy=function(){this.iframe.parentNode.removeChild(this.iframe),window.removeEventListener("resize",this.handleResize)},e.prototype.addStylesheetRules=function(t){var n=document.createElement("style");document.head.appendChild(n);var s=n.sheet;s.insertRule(t,s.cssRules.length)},e.prototype.mergeAttrs=function(t){var n=this.customAttrs;if(n&&Object.keys(n).length&&n.allow){var s=n.allow instanceof Array?n.allow:n.allow.split(";");s.unshift("clipboard-write"),s.unshift("clipboard-read"),n.allow=s.join(";"),Object.assign(t,n)}return t},e}(),ble=function(){function e(){this.HANDLE_LIST=[]}return e.prototype.add=function(t){this.HANDLE_LIST.push(t),window.addEventListener("message",t,!1)},e.prototype.remove=function(t){var n=this.HANDLE_LIST.indexOf(t);n>=0&&this.HANDLE_LIST.splice(n,1),window.removeEventListener("message",t,!1)},e.prototype.empty=function(){for(;this.HANDLE_LIST.length;){var t=this.HANDLE_LIST.shift();window.removeEventListener("message",t,!1)}},e.prototype.parse=function(t){try{return typeof t=="object"?t:t&&JSON.parse(t)}catch(n){return t}},e}(),fM=function(){function e(t,n){var s=this;this.collectObjIdHandlers=new Set,this.polyfillApi=["ExportAsFixedFormat","GetOperatorsInfo","ImportDataIntoFields","ReplaceText","ReplaceBookmark","GetBookmarkText","GetComments"],this.getId=function(){return""},this.setterCallbacks={idMap:{}},this.sendMsgToWps=function(){},this.objId=0,this.origin="",this.apiChannel=function(a,o,i,l){return Gr(s,void 0,void 0,function(){var c,d,u,f,h,p,g,_,x,F=this;return Wr(this,function(b){switch(b.label){case 0:return c=this.getId(),f=new Promise(function(w,E){d=w,u=E}),h={},o.args?[4,this.reduceArgs(o.args)]:[3,2];case 1:p=b.sent(),g=p[0],_=p[1],o.args=g,h=_,b.label=2;case 2:return a!==this.prefix+"setter"?[3,4]:[4,this.handleApiSetter(o)];case 3:b.sent(),b.label=4;case 4:return x=function(){var w=function(E){return Gr(F,void 0,void 0,function(){var C,k,T;return Wr(this,function(v){switch(v.label){case 0:return this.instance.originWhiteList.includes(E.origin)||this.origin===E.origin?(C=this.message.parse(E.data)).eventName===this.prefix+"callback"&&C.callbackId&&h[C.callbackId]?[4,h[C.callbackId].apply(h,C.data.args)]:[3,2]:[2];case 1:k=v.sent(),this.sendMsgToWps({result:k,eventName:this.prefix+"callback.reply",callbackId:C.callbackId}),v.label=2;case 2:return C.eventName===a+".reply"&&C.msgId===c&&(C.error?((T=new Error("")).stack=C.error+"\n"+i,l&&l(),u(T)):d(C.result),this.message.remove(w)),[2]}})})};return F.message.add(w),f},this.handleSendApiChannel([{eventName:a,data:o,msgId:c},x]),[2,f]}})})},this.handleApiSetter=function(a){return Gr(s,void 0,void 0,function(){var o,i,l,c,d,u,f,h,p,g,_=this;return Wr(this,function(x){switch(x.label){case 0:return o=function(){return Object.keys(_.setterCallbacks.idMap).find(function(F){return _.setterCallbacks.idMap[F]===l+":"+i})},i=a.prop,l=a.parentObjId,c=a.value,[4,this.reduceArgs([c])];case 1:return d=x.sent(),u=d[0],f=d[1],a.value=u[0],h=Object.keys(f)[0],p=this.setterCallbacks[l],c===null&&p&&p[i]&&((g=o())&&delete this.setterCallbacks.idMap[g],delete p[i],Object.keys(p).length||delete this.setterCallbacks[l],Object.keys(this.setterCallbacks.idMap).length||this.message.remove(this.setterCallbackSubscribe.bind(this))),h&&(Object.keys(this.setterCallbacks.idMap).length||this.message.add(this.setterCallbackSubscribe.bind(this)),this.setterCallbacks[l]||(this.setterCallbacks[l]={}),this.setterCallbacks[l][i]={callbackId:h,callback:f[h]},(g=o())&&delete this.setterCallbacks.idMap[g],this.setterCallbacks.idMap[h]=l+":"+i),[2]}})})},this.prefix=n,this.origin=t.origin,this.sendMsgToWps=t.sendMsgToWps.bind(t),this.getId=t.getId.bind(t),this.message=t.message,this.sdkInstanceId=t.instanceId,this.instance=t}return e.prototype.destroyApplication=function(){this.collectObjIdHandlers=new Set,this.objId=0},e.prototype.subEventHandle=function(t,n){var s=this,a={};this.message.add(function(l){return Gr(s,void 0,void 0,function(){var c,d,u,f,h,p;return Wr(this,function(g){switch(g.label){case 0:return this.instance.originWhiteList.includes(l.origin)||this.origin===l.origin?(c=this.message.parse(l.data),d=c.sdkInstanceId,c.eventName===this.prefix+"event"&&Number(d)===this.sdkInstanceId&&c.data?(u=c.data,f=u.eventName,h=u.data,(p=a[f])?[4,p(h)]:[3,2]):[3,2]):[2];case 1:g.sent(),g.label=2;case 2:return[2]}})})});var o=function(l){var c=n[l];Object.defineProperty(t,c,{set:function(d){a[c]=d,s.sendMsgToWps({eventName:s.prefix+"event.register",data:{eventName:c,register:!!d,objId:s.objId+=1},sdkInstanceId:s.sdkInstanceId})}})};for(var i in n)o(i)},e.prototype.mixinProto=function(t,n){Object.assign(t,n)},e.prototype.makeCollectObjIdHandle=function(t){var n=this;return function(){var s=[],a=function(o){s.push(o)};return n.collectObjIdHandlers.add(a),{End:function(){t(s),n.collectObjIdHandlers.delete(a)}}}},e.prototype.assign=function(t,n,s){for(var a=this,o=n.slice(0),i=function(){var c=o.shift();!c.alias&&~l.polyfillApi.indexOf(c.prop)&&o.push(qr(qr({},c),{alias:c.prop+"Async"})),Object.defineProperty(t,c.alias||c.prop,{get:function(){var d=c.cache===1,u=d&&t["__"+c.prop+"CacheValue"];if(!u){var f=a.getError(),h=a.createObjId(d),p=function(){for(var g,_=[],x=0;x<arguments.length;x++)_[x]=arguments[x];return c.caller!==void 0?(g={objId:a.createObjId()},a.assign(g,s[c.caller],s)):g={},a.wrapper(p,g,a.prefix+"caller",{obj:p,args:_,parentObjId:t.objId,objId:g.objId,prop:c.prop},f),g};return p.objId=-1,c.getter!==void 0&&(p.objId=h,a.assign(p,s[c.getter],s)),a.wrapper(t,p,a.prefix+"getter",{parentObjId:t.objId,objId:p.objId,prop:c.prop},f,function(){delete t["__"+c.prop+"CacheValue"]}),d&&(t["__"+c.prop+"CacheValue"]=p),p}return u},set:function(d){var u=a.getError();return a.wrapper(t,{},a.prefix+"setter",{value:d,parentObjId:t.objId,objId:-1,prop:c.prop},u)}})},l=this;o.length;)i()},e.prototype.wrapper=function(t,n,s,a,o,i){var l,c=this,d=(t.done?t.done():Promise.resolve()).then(function(){return l||(l=c.apiChannel(s,a,o,i)),l});n.done=function(){return d},n.then=function(u,f){return a.objId>=0?(n.then=null,n.catch=null,d.then(function(){u(n)}).catch(function(h){return f(h)})):d.then(u,f)},n.catch=function(u){return d.catch(u)},n.Destroy=function(){return this.apiChannel(this.prefix+"free",{objId:n.objId},"")}},e.prototype.handleSendApiChannel=function(t){var n=t[0],s=t[1];typeof(n=qr({},n)).data=="function"&&(n.data=n.data()),s(),this.sendMsgToWps(n)},e.prototype.setterCallbackSubscribe=function(t){return Gr(this,void 0,void 0,function(){var n,s,a,o,i,l,c,d,u,f;return Wr(this,function(h){switch(h.label){case 0:return this.instance.originWhiteList.includes(t.origin)||this.origin===t.origin?(n=this.message.parse(t.data),s=n.eventName,a=n.callbackId,o=n.data,a&&(i=this.setterCallbacks.idMap[a])?(l=i.split(":"),c=l[0],d=l[1],s===this.prefix+"callback"&&this.setterCallbacks[c]&&this.setterCallbacks[c][d]?[4,(f=this.setterCallbacks[c][d]).callback.apply(f,o.args)]:[3,2]):[3,2]):[2];case 1:u=h.sent(),this.sendMsgToWps({result:u,callbackId:a,eventName:this.prefix+"callback.reply"}),h.label=2;case 2:return[2]}})})},e.prototype.reduceArgs=function(t){return Gr(this,void 0,void 0,function(){var n,s,a,o,i,l,c,d,u,f,h;return Wr(this,function(p){switch(p.label){case 0:n={},s=[],a=t.slice(0),p.label=1;case 1:return a.length?(o=void 0,[4,a.shift()]):[3,13];case 2:return(i=p.sent())&&i.done?[4,i.done()]:[3,4];case 3:p.sent(),p.label=4;case 4:if(!Ly(o))return[3,11];for(c in o={},l=[],i)l.push(c);d=0,p.label=5;case 5:return d<l.length?(u=l[d],f=i[u],/^[A-Z]/.test(u)?f&&f.done?[4,f.done()]:[3,7]:[3,8]):[3,10];case 6:p.sent(),p.label=7;case 7:f&&f.objId?f={objId:f.objId}:typeof f=="function"&&(h=this.getId(),n[h]=f,f={callbackId:h}),p.label=8;case 8:o[u]=f,p.label=9;case 9:return d++,[3,5];case 10:return[3,12];case 11:i&&i.objId?o={objId:i.objId}:typeof i=="function"&&i.objId===void 0?(h=this.getId(),n[h]=i,o={callbackId:h}):o=i,p.label=12;case 12:return s.push(o),[3,1];case 13:return[2,[s,n]]}})})},e.prototype.createObjId=function(t){return this.objId+=1,!t&&this.collectObjId(),this.objId},e.prototype.collectObjId=function(){var t=this;this.collectObjIdHandlers.forEach(function(n){return n(t.objId)})},e.prototype.getError=function(){var t=new Error("");return(t.stack||t.message||"").split("\n").slice(2).join("\n")},e}(),Fle=function(e){function t(n,s,a){var o=e.call(this,n,a)||this,i={},l=n.officeType,c=s.Events,d=s.Enum,u=s.Props,f=u[0],h=u[1],p={objId:o.objId};switch(o.assign(p,f,h),p.Events=c,p.Enum=d,p.Sub={},i.Enum=p.Enum,i.Events=p.Events,i.Props=u,l){case Vh.writer:i.WordApplication=n.WpsApplication=function(){return p};break;case Vh.spreadsheet:i.ExcelApplication=n.EtApplication=function(){return p};break;case Vh.presentation:i.PPTApplication=n.WppApplication=function(){return p};break;case Vh.pdf:i.PDFApplication=function(){return p}}return i.Application=p,i.Free=function(g){return o.apiChannel(o.prefix+"free",{objId:g},"")},i.Stack=p.Stack=o.makeCollectObjIdHandle(function(g){o.apiChannel(o.prefix+"free",{objId:g},"")}),i.destroyApplication=function(){o.destroyApplication()},o.subEventHandle(p.Sub,c),o.mixinProto(n,i),o}return EN(t,e),t}(fM),wle=function(e){function t(n,s,a){var o=e.call(this,n,a)||this,i={},l=s.Events,c=s.Enum,d=s.Props,u=d[0],f=d[1],h={objId:o.objId};return o.assign(h,u,f),h.Events=l,h.Enum=c,h.Sub={},i.CommonEnum=h.Enum,i.CommonEvents=h.Events,i.CommonProps=d,i.CommonApi=h,i.CommonFree=function(p){return o.apiChannel(o.prefix+"free",{objId:p},"")},i.CommonStack=h.Stack=o.makeCollectObjIdHandle(function(p){o.apiChannel(o.prefix+"free",{objId:p},"")}),i.destroyCommonApp=function(){o.destroyApplication()},o.subEventHandle(h.Sub,l),o.mixinProto(n,i),o}return EN(t,e),t}(fM),Ele=function(){function e(t){var n,s=this;this.id=0,this.origin="",this.originWhiteList=[],this.realOrigin="",this.iframeWH=null,this.cbConfigsSub={},this.readyEventNames=[{event:"ready",callback:function(){s.handleBaseReady()},after:!0},{event:"open.result"},{event:"api.ready",callback:function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var i=a[0];return new Fle(s,i,"api."),s.Application}},{event:"commonApi.ready",callback:function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var i=a[0];return new wle(s,i,"commonApi."),s.CommonApi}}],this.cbConfigs=["refreshToken"],this.onEventNames={"open.result":"fileOpen","tab.switch":"tabSwitch","file.saved":"fileStatus",error:"error",stage:"stage"},this.polyfillConfigName=[["wpsOptions","wordOptions"],["etOptions","excelOptions"],["wppOptions","pptOptions"]],this.flag={advancedApiReadySended:!1,advancedApiReadySendedJust:!1,commonApiReadySended:!1,commonApiReadySendedJust:!1},this.baseReadyPromise=Promise.resolve(),this.fileOpenPromise=Promise.resolve(),this.advancedReadyPromise=Promise.resolve(),this.commonApiPromise=Promise.resolve(),this.iframeInstance=null,this.officeType="",this.url="",this.version="2.0.5",this.iframeReady=!1,this.forceIframeResize=function(){s.iframeInstance&&s.iframeInstance.handleResize()},this.isOtherEvent=function(a){return a!==void 0&&a!==s.instanceId},this.handleBaseReady=function(){s.sendMsgToWps({eventName:"setConfig",data:qr(qr({},s.sdkConfig),{version:s.version})}),s.tokenData&&s.setToken(qr(qr({},s.tokenData),{hasRefreshTokenConfig:!!s.sdkConfig.refreshToken})),s.flag.advancedApiReadySended&&s.sendMsgToWps({eventName:"api.ready"}),s.flag.commonApiReadySended&&s.sendMsgToWps({eventName:"commonApi.ready"}),s.iframeReady=!0},this.handleFullscreenChange=function(){var a={status:M_.requestFullscreen};document.fullscreenElement?a.status=M_.requestFullscreen:a.status=M_.exitFullscreen,s.sendMsgToWps({data:a,eventName:"fullscreenchange"})},this.instanceId=e.instanceId,e.instanceId+=1,this.message=new ble,this.mittInstance=(n=n||Object.create(null),{on:function(a,o){(n[a]||(n[a]=[])).push(o)},off:function(a,o){n[a]&&n[a].splice(n[a].indexOf(o)>>>0,1)},emit:function(a,o){(n[a]||[]).slice().map(function(i){i(o)}),(n["*"]||[]).slice().map(function(i){i(a,o)})}}),this.handleConfig(t)}return e.config=function(t){return t===void 0&&(t={}),e.singleInstance||(e.singleInstance=new e(t)),e.singleInstance},e.prototype.setToken=function(t){return Gr(this,void 0,void 0,function(){return Wr(this,function(n){switch(n.label){case 0:return[4,this.basicReady()];case 1:return n.sent(),this.tokenData=t,this.sendMsgToWps({eventName:"setToken",data:t}),[2]}})})},e.prototype.advancedApiReady=function(){return Gr(this,void 0,void 0,function(){return Wr(this,function(t){switch(t.label){case 0:return this.flag.advancedApiReadySendedJust?[3,2]:(this.flag.advancedApiReadySendedJust=!0,[4,this.fileOpenPromise]);case 1:t.sent(),this.flag.advancedApiReadySended||(this.flag.advancedApiReadySended=!0,this.sendMsgToWps({eventName:"api.ready"})),t.label=2;case 2:return[4,this.advancedReadyPromise];case 3:return[2,t.sent()]}})})},e.prototype.commonApiReady=function(){return Gr(this,void 0,void 0,function(){return Wr(this,function(t){switch(t.label){case 0:return this.flag.commonApiReadySendedJust?[3,2]:(this.flag.commonApiReadySendedJust=!0,[4,this.basicReady()]);case 1:t.sent(),this.flag.commonApiReadySended||(this.flag.commonApiReadySended=!0,this.sendMsgToWps({eventName:"commonApi.ready"})),t.label=2;case 2:return[4,this.commonApiPromise];case 3:return[2,t.sent()]}})})},e.prototype.destroy=function(){this.iframeInstance.destroy(),this.message.empty(),this.destroyApplication&&this.destroyApplication(),this.destroyCommonApp&&this.destroyCommonApp(),this.removeFullscreenEventListener()},e.prototype.on=function(t,n){return Gr(this,void 0,void 0,function(){var s;return Wr(this,function(a){switch(a.label){case 0:return[4,this.basicReady()];case 1:return a.sent(),s=t,t==="fullscreenChange"&&(s="fullscreenchange"),this.handleBasicEvent(s,"on"),this.mittInstance.on(t,n),[2]}})})},e.prototype.off=function(t,n){return Gr(this,void 0,void 0,function(){return Wr(this,function(s){switch(s.label){case 0:return[4,this.basicReady()];case 1:return s.sent(),this.handleBasicEvent(t,"off"),this.mittInstance.off(t,n),[2]}})})},e.prototype.handleConfig=function(t){var n,s=this;t===void 0&&(t={});try{var a=this.userConfHandler(t),o=a.subscriptions,i=o===void 0?{}:o,l=a.mount,c=l===void 0?null:l,d=a.url,u=a.originWhiteList;this.origin=(d.match(/https*:\/\/[^\/]+/g)||[])[0],this.originWhiteList=u||[];var f=this.readyEventNames.map(function(x){return s.makeReady(x)}),h=f[0],p=f[1],g=f[2],_=f[3];this.baseReadyPromise=h,this.fileOpenPromise=p,this.advancedReadyPromise=g,this.commonApiPromise=_,this.iframeWH=c?{width:c.clientWidth+"px",height:c.clientHeight+"px"}:{width:"100vw",height:"100vh"},delete a.mount,d&&delete a.url,this.url=d,delete a.subscriptions,this.sdkConfig=a,this.iframeInstance=new yle(this,this.instanceId,d,c,(n=a.isListenResize)===null||n===void 0||n,!1,{allow:a.attrAllow}),this.iframe=this.iframeInstance.iframe,this.listener(i)}catch(x){return console.error(x),null}},e.prototype.listener=function(t){var n=this;this.message.add(function(s){return Gr(n,void 0,void 0,function(){var a,o,i,l,c,d,u,f,h;return Wr(this,function(p){return a=this.message.parse(s.data),o=a.eventName,i=o===void 0?"":o,l=a.data,c=l===void 0?null:l,d=a.url,u=d===void 0?null:d,f=a.sdkInstanceId,this.isOtherEvent(f)?[2]:["wps.jssdk.api"].indexOf(i)!==-1?[2]:((h=this.handleListenEvent(i,c))?h():Object.keys(this.onEventNames).includes(i)&&(i==="open.result"&&(this.officeType=c.fileInfo.officeType),this.mittInstance.emit(this.onEventNames[i],c)),typeof t[i]=="function"&&t[i](this,u||c),[2])})})})},e.prototype.handleListenEvent=function(t,n){var s,a=this;return((s={"api.scroll":function(){return window.scrollTo(n.x,n.y)},"event.callback":function(){return Gr(a,void 0,void 0,function(){var o,i,l,c,d,u,f;return Wr(this,function(h){return o=n.eventName,i=n.data,l=o,o==="fullScreenChange"&&(l="fullscreenChange"),(!((u=this.sdkConfig.commonOptions)===null||u===void 0)&&u.isBrowserViewFullscreen||!((f=this.sdkConfig.commonOptions)===null||f===void 0)&&f.isParentFullscreen)&&l==="fullscreenchange"&&(c=i.status,d=i.isDispatchEvent,this.sdkConfig.commonOptions.isBrowserViewFullscreen?this.iframeWH&&function(p,g,_,x){p===0?g.style="position: static; width: "+_.width+"; height: "+_.height:p===1&&(g.style="position: absolute; width: 100%; height: 100%"),x&&function(F){["fullscreen","fullscreenElement"].forEach(function(w){Object.defineProperty(document,w,{get:function(){return!!F.status},configurable:!0})});var b=new CustomEvent("fullscreenchange");document.dispatchEvent(b)}({status:p})}(c,this.iframe,this.iframeWH,d):this.sdkConfig.commonOptions.isParentFullscreen&&function(p,g){if(p===0){var _=document,x=_.exitFullscreen||_.mozCancelFullScreen||_.msExitFullscreen||_.webkitCancelFullScreen||_.webkitExitFullscreen;x.call(document)}else if(p===1){var F=g.requestFullscreen||g.mozRequestFullScreen||g.msRequestFullscreen||g.webkitRequestFullscreen;F.call(g)}}(c,this.iframe)),this.mittInstance.emit(l,i),[2]})})}})[Kb.refreshToken]=function(){return Gr(a,void 0,void 0,function(){var o,i;return Wr(this,function(l){switch(l.label){case 0:o={token:!1},l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.cbConfigsSub.refreshToken()];case 2:return o=l.sent(),[3,4];case 3:return i=l.sent(),console.error("refreshToken: "+(i||"fail to get")),[3,4];case 4:return this.sendMsgToWps({eventName:t+".reply",data:o}),[2]}})})},s)[t]},e.prototype.basicReady=function(){return this.baseReadyPromise},e.prototype.userConfHandler=function(t,n){var s=this;n===void 0&&(n=!0);var a=qr({},t),o=a.headers,i=o===void 0?{}:o,l=a.subscriptions,c=l===void 0?{}:l,d=a.commonOptions,u=a.url,f=u===void 0?"":u,h=a.wpsUrl,p=h===void 0?"":h,g=a.mode,_=g===void 0?O_.nomal:g,x=a.debug,F=a.disablePlugins,b=a.hideGuide,w=a.readOnly;return Object.assign(a,this.handleHeadersAndSubscriptionsConfig(i,c,n)),a.url=this.handleUrlConfig(d,_,x,f,p,F,b,w),d&&(d.isParentFullscreen||d.isBrowserViewFullscreen)&&document.addEventListener("fullscreenchange",this.handleFullscreenChange),this.polyfillConfigName.map(function(E){var C=E[0],k=E[1];a[k]&&(a[C]=a[k])}),this.cbConfigs.map(function(E){var C,k,T=a[E];T&&(C=T,k="Function",{}.toString.call(C)==="[object "+k+"]")&&(s.cbConfigsSub[E]=T,a[E]={eventName:Kb[E]})}),a.commandBars&&this.handleCommandBarsConfig(a.commandBars,!1),qr({},a)},e.prototype.handleBasicEvent=function(t,n){if(!["error","fileOpen"].includes(t)){var s={eventName:"basic.event",data:{eventName:t,action:n}};this.sendMsgToWps(s)}},e.prototype.removeFullscreenEventListener=function(){document.removeEventListener("fullscreenchange",this.handleFullscreenChange)},e.prototype.handleHeadersAndSubscriptionsConfig=function(t,n,s){var a=t.backBtn,o=a===void 0?{}:a,i=t.shareBtn,l=i===void 0?{}:i,c=t.otherMenuBtn,d=c===void 0?{}:c,u=[["wpsconfig_back_btn",o],["wpsconfig_share_btn",l],["wpsconfig_other_menu_btn",d]],f=[];return d.items&&Array.isArray(d.items)&&d.items.forEach(function(h,p){h===void 0&&(h={}),h.type==="custom"&&f.push(["wpsconfig_other_menu_btn_"+p,h])}),u.concat(f).forEach(function(h){var p,g;p=h[1],g=h[0],p.subscribe&&typeof p.subscribe=="function"&&(p.callback=g,n[g]=p.subscribe,s&&delete p.subscribe)}),{}},e.prototype.handleUrlConfig=function(t,n,s,a,o,i,l,c){var d=[];d.push("sdkId="+this.instanceId),n===O_.simple||t&&t.isShowTopArea===!1?d.push("simple","hidecmb"):n===O_.embed&&d.push("simple=1","hidecmb=1","embed=1"),i&&d.push("disablePlugins"),l&&d.push("hideguide"),c&&d.push("readonly"),s&&d.push("debugger");var u=a||o;return u&&d.length&&(u=u+(u.indexOf("?")>=0?"&":"?")+d.join("&")),u},e.prototype.handleCommandBarsConfig=function(t,n){n===void 0&&(n=!0);var s=t.map(function(a){var o=a.attributes;if(!Array.isArray(o)){var i=[];for(var l in o)if(o.hasOwnProperty(l)){var c={name:l,value:o[l]};i.push(c)}a.attributes=i}return a});return n&&this.sendMsgToWps({data:s,eventName:"setCommandBars"}),s},e.prototype.sendMsgToWps=function(t){var n,s,a=qr(qr({},t),{sdkInstanceId:this.instanceId});(s=(n=this.iframe)===null||n===void 0?void 0:n.contentWindow)===null||s===void 0||s.postMessage(JSON.stringify(a),this.realOrigin)},e.prototype.makeReady=function(t){var n=this,s=t.event,a=t.callback,o=t.after;return new Promise(function(i){var l=function(c){if(n.realOrigin=c.origin,n.originWhiteList.includes(c.origin)||n.origin===c.origin){var d=n.message.parse(c.data),u=d.eventName,f=d.data,h=d.sdkInstanceId;if(!n.isOtherEvent(h)&&u===s){var p=void 0;!o&&a&&(p=a(f)),i(p),o&&a&&a(f),s!=="ready"&&n.message.remove(l)}}};n.message.add(l)})},e.prototype.getId=function(){return this.id+=1,this.instanceId+"-"+this.id},e.instanceId=1,e}(),mA={executeCommandBar:"ExecuteCommandBar",off:"Off",save:"Save",setCommandBars:"SetCommandBars",setCooperUserColor:"SetCooperUserColor",tabs:"Tabs",Stack:"Stack",WhenStacksEmpty:"WhenStacksEmpty"};function Cle(e,t){var n=this;return t===void 0&&(t={}),new Proxy(e,qr(qr({},{get:function(s,a){if(Object.keys(mA).includes(a)){var o=mA[a];return o==="Tabs"?function(i){var l=this;return{switchTab:function(c){return Gr(l,void 0,void 0,function(){return Wr(this,function(d){switch(d.label){case 0:return[4,i.commonApiReady()];case 1:return d.sent(),[4,i.CommonApi.Tabs.SwitchTab(c.tabKey)];case 2:return[2,d.sent()]}})})},getTabs:function(){return Gr(l,void 0,void 0,function(){return Wr(this,function(c){switch(c.label){case 0:return[4,i.commonApiReady()];case 1:return c.sent(),[4,i.CommonApi.Tabs.GetTabs()];case 2:return[2,c.sent()]}})})}}}(s):s.CommonApi?Reflect.get(s.CommonApi,o):function(){return Gr(n,void 0,void 0,function(){var i;return Wr(this,function(l){switch(l.label){case 0:return[4,s.commonApiReady()];case 1:return l.sent(),[4,s.commonApiPromise];case 2:return l.sent(),typeof s.CommonApi[o]!="function"?[3,4]:[4,s.CommonApi[o]()];case 3:return i=l.sent(),[3,5];case 4:i=s.CommonApi[o],l.label=5;case 5:return[2,i]}})})}}return Reflect.get(s,a)},set:function(s,a,o){return!!Reflect.has(s,a)&&Reflect.set(s,a,o)}}),t))}var Yb;(function(e){e.Spreadsheet="s",e.Writer="w",e.Presentation="p",e.Pdf="f",e.Otl="o",e.Dbt="d",e.KSheet="k"})(Yb||(Yb={}));var mM=function(e){function t(n){var s=e.call(this,n)||this;return n.token&&(Ly(n.token)?s.setToken(qr({},n.token)):s.setToken({token:n.token})),s.ApiEvent={AddApiEventListener:function(a,o){s.on(a,o)},RemoveApiEventListener:function(a,o){s.off(a,o)}},s}return EN(t,e),t.init=function(n){var s=qr({},n);if(typeof s.mount=="string"){var a=document.querySelector(s.mount);a?s.mount=a:(console.warn("[WebOfficeSDK.init] mount挂载节点未找到"),delete s.mount)}if(s.url)throw Error("[WebOfficeSDK.init] 不支持传递url，请使用appId、fileId、officeType、token等参数初始化！");if(!s.appId||!s.fileId||!s.officeType)throw Error("[WebOfficeSDK.init] appId、fileId、officeType为必选项！");s.endpoint=s.endpoint||"https://o.wpsgo.com";var o=new t(function(i){var l=qr({},i);l.token=l.token||l.fileToken;var c=l.appId,d=l.fileId,u=l.officeType,f=l.token,h=l.endpoint,p=l.customArgs,g=p===void 0?"":p;if(!Object.values(Yb).includes(u))throw Error("[WebOfficeSDK.init] officeType属性值错误，可选值参考WebOfficeSDK.OfficeType: "+JSON.stringify(Yb));var _=f?1:0,x={token:""};if(typeof f=="string"?x.token=f:Ly(f)&&(x=qr({tokenData:x},f)),_&&!x.token)return console.error("[WebOfficeSDK.init] token设置无效"),l;if(l.url=h+"/office/"+u+"/"+d+"?_w_appid="+c+"&_w_tokentype="+_,Ly(g)){var F=Object.entries(g).map(function(b){var w=b[0],E=b[1];return w+"="+encodeURIComponent(E)}).join("&");l.url=l.url+"&"+F}return qr({},l)}(s));return function(i,l){Gr(this,void 0,void 0,function(){var c,d,u,f;return Wr(this,function(h){switch(h.label){case 0:return[4,i.commonApiReady()];case 1:for(d in h.sent(),c=[],l)c.push(d);u=0,h.label=2;case 2:if(!(u<c.length))return[3,11];switch(f=c[u]){case"onHyperLinkOpen":return[3,3];case"onToast":return[3,5];case"getClipboardData":return[3,7]}return[3,9];case 3:return[4,i.CommonApi.Hooks.Add("hyperLink")];case 4:return h.sent().OnAction=l[f],[3,10];case 5:return[4,i.CommonApi.Hooks.Add("toast")];case 6:return h.sent().OnAction=l[f],[3,10];case 7:return[4,i.CommonApi.Hooks.Add("getClipboardData")];case 8:return h.sent().OnAction=l[f],[3,10];case 9:return[3,10];case 10:return u++,[3,2];case 11:return[2]}})})}(o,n),Cle(o)},Object.defineProperty(t,"version",{get:function(){return"2.0.5"},enumerable:!1,configurable:!0}),t.prototype.ready=function(){return Gr(this,void 0,void 0,function(){return Wr(this,function(n){switch(n.label){case 0:return[4,this.advancedApiReady()];case 1:return[2,n.sent()]}})})},t.OfficeType=Object.freeze({Spreadsheet:"s",Writer:"w",Presentation:"p",Pdf:"f",Otl:"o",KSheet:"ksheet",Dbt:"dbt"}),t}(Ele);window.WPS=mM;const pu=mM,kle=e=>{const{getToken:t,appId:n,className:s,mountRoot:a}=e,o=y.useRef(null),i=y.useRef(),l=async()=>({...await t(),timeout:1e3*30*10,hasRefreshTokenConfig:!0});return y.useLayoutEffect(()=>(l().then(c=>{var u;if(!o.current)return;const d=(u=Tle(tQ(c.ossName).extName))!=null?u:pu.OfficeType.Writer;i.current=pu.init({appId:n,officeType:d,fileId:c.fileId,token:c.token,attrAllow:["clipboard-read","clipboard-write"],refreshToken:l,mount:a?void 0:o.current,isListenResize:!0})}),()=>{var c;(c=i.current)==null||c.destroy()}),[n]),r.jsx("div",{ref:o,className:s})},sC={excel:["xls","xlt","et","xlsx","xltx","csv","xlsm","xltm","ett"],ppt:["ppt","pptx","pptm","ppsx","ppsm","pps","potx","potm","dpt","dps","pot"],word:["doc","dot","wps","wpt","docx","dotx","docm","dotm","rtf","txt","xml","mhtml","mht","html","htm","uof"]},rC={excel:["xls","xlsx"],ppt:["ppt","pptx"],word:["doc","docx"]},Tle=(e="")=>{if(sC.word.includes(e))return pu.OfficeType.Writer;if(sC.excel.includes(e))return pu.OfficeType.Spreadsheet;if(sC.ppt.includes(e))return pu.OfficeType.Presentation},vle=(e="")=>{if(rC.word.includes(e))return pu.OfficeType.Writer;if(rC.excel.includes(e))return pu.OfficeType.Spreadsheet;if(rC.ppt.includes(e))return pu.OfficeType.Presentation},rE=e=>{var a;const t=ye(e,["data"],["format"]),n=Ce(({blocks:o})=>{const i=o[e];if(!i)return[];const l=[];return i.subNodes.forEach(c=>{const d=o[c];d&&l.push(d)}),l},[e],{wait:200,waitMode:"debounce"});return y.useMemo(()=>{const o=c=>{var _,x;const{sortType:d,reverse:u}=aw((x=(_=t==null?void 0:t.data)==null?void 0:_.format)==null?void 0:x.orderFolder),f=c.map(F=>({...F,sortTitle:fe(F.data.segments),sortSize:m.BlockType.FOLDER===F.type?F.subNodes.length:F.data.size}));let h="updatedAt";switch(d){case m.OrderFolderType.SIZE:case m.OrderFolderType.SIZE_REVERSED:{h="sortSize";break}case m.OrderFolderType.NAME:case m.OrderFolderType.NAME_REVERSED:{h="sortTitle";break}default:case m.OrderFolderType.TIME:case m.OrderFolderType.TIME_REVERSED:{h="updatedAt";break}}const p=["updatedAt","sortSize"].includes(h);return CJ({items:f,key:h,reverse:u,isNumber:p}).map(F=>kn(F,["sortTitle","sortSize"]))},i=o(n.filter(c=>c.type!==m.BlockType.FOLDER));return{folder:o(n.filter(c=>c.type===m.BlockType.FOLDER)),files:i}},[(a=t==null?void 0:t.data)==null?void 0:a.format,n])},_a=e=>{const{checked:t,className:n,size:s="middle",name:a,checkbox2:o,...i}=e;return r.jsx(V,{size:s,className:R("todo",t?"text-active_color":"dark:text-white",n),name:a!=null?a:t?o?"IcCheckbox2Check":"IcCheckboxCheck":o?"IcCheckbox2":"IcCheckbox",...i})},aC=qe(),Ile=e=>{const{resolve:t,reject:n}=e,[s,a]=y.useState(!1);return r.jsxs("div",{className:"pt-10 pb-5 px-7 text-t3 space-y-2.5",children:[r.jsx("div",{className:"text-t1-medium",children:"检测到你已经登录FlowUs，可直接授权"}),r.jsx("div",{children:"允许“WPS文档”应用进行以下操作"}),r.jsxs("div",{className:"flex items-center cursor-not-allowed",children:[r.jsx(_a,{checked:!0}),r.jsx("span",{children:"访问你的个人资料等基础信息"})]}),r.jsxs("div",{className:"flex items-center animate-click",onClick:()=>a(!s),children:[r.jsx(_a,{checked:s}),r.jsx("span",{children:"在你的FlowUs空间读写文件数据"})]}),r.jsxs("div",{className:"pt-2.5 space-y-2.5",children:[r.jsx(De,{disable:!s,size:"auto",colorType:"active",onClick:t,children:"授权"}),r.jsx(De,{size:"auto",onClick:n,children:"取消"})]})]})},Nle=()=>{const e=ie(),t=Pm();return y.useCallback(async()=>{const n=new Wp;e.modal({modalId:aC,content:()=>r.jsx(Ile,{resolve:()=>{t({setting:{wpsAuth:!0}}),n.resolve(),e.closeModal(aC)},reject:()=>{n.reject(new Error),e.closeModal(aC)}})}),await n.promise},[e,t])},CN=Symbol("File Preview Scope"),hM=e=>{const{uuid:t="",pageId:n=""}=e,s=ye(n,[]),{files:a}=rE(n);return y.useMemo(()=>{let i=pI(t,[m.BlockType.FILE,m.BlockType.EXTERNAL_FILE,m.BlockType.REFERENCE],l=>{var d,u,f,h;if(l.type===m.BlockType.EXTERNAL_FILE&&l.data.display==="image"&&l.data.link)return!0;if(l.type===m.BlockType.FILE){if((l.data.display==="image"||l.data.display==="file")&&l.data.ossName&&_3(rn(l.data.ossName).extName))return!0;const p=Jt.image.test(rn(l.data.ossName).extName);if(l.data.display===void 0&&(p||Jt.image.test((d=l.data.extName)!=null?d:"")))return!0}const c=(f=(u=l==null?void 0:l.data)==null?void 0:u.ref)==null?void 0:f.uuid;if(l.type===m.BlockType.REFERENCE&&c){const p=J.blocks[c];if((p==null?void 0:p.type)===m.BlockType.FILE&&(p!=null&&p.data.ossName)&&Jt.image.test(rn(p.data.ossName).extName)||(p==null?void 0:p.type)===m.BlockType.PDF_ANNOTATION&&((h=p==null?void 0:p.data.pdfAnnotation)!=null&&h.ossName))return!0}return!1});return(s==null?void 0:s.type)===m.BlockType.FOLDER&&(i=a==null?void 0:a.filter(l=>i.includes(l.uuid)).map(l=>l.uuid)),i.length?i:[]},[a,s==null?void 0:s.type,t])},kN=Mr({editor:!1,uuid:""}),pM=()=>{const[e,t]=pp(kN,CN),n=Ur(),s=ie(),a=ya(),o=Ut(),{role:i}=mt(e.uuid),l=We(),c=Nle();return{officeOptions:{canEditor:!l&&Xn(i,m.PermissionRole.WRITER)&&$ee,editor:e.editor,openEditor:async()=>{if(!n){s.warning({title:"升级到“专业版/团队版”体验完整功能",confirm(){a(Mt.wps)},confirmText:"立即升级"});return}o.setting.wpsAuth||await c(),t(u=>({...u,editor:!0}))}}}},jle=({downloadUrl:e,uuid:t,propertyId:n})=>{const[s,a]=y.useState(!0),{officeOptions:o}=pM(),i=Ut();if(y.useEffect(()=>(t&&(i.uuid?Db(t).then(()=>a(!1)):a(!1)),document.body.classList.add("overscroll-none"),()=>{document.body.classList.remove("overscroll-none")}),[i.uuid,t]),!e||!t)return null;const l=f3(e);if(s)return r.jsx(xs,{});if(!o.editor){const d="https://view.officeapps.live.com/op/embed.aspx?src=".concat(encodeURIComponent("".concat(e)));return r.jsx("iframe",{title:"office",src:d,width:"100%",height:"100%",frameBorder:"1"})}const c=()=>{Db(t)};return r.jsx(kle,{className:"w-full h-full flex-1 overflow-hidden",appId:"SX20231127MUOIEW",getToken:async()=>{const d=await ve.infra.getWpsToken({blockId:t,ossName:l,schemaId:n});return d.ossName!==l&&c(),d}})},gM=()=>r.jsxs("div",{className:"w-full h-full pointer-events-none flex flex-col items-center justify-center",children:[r.jsx("p",{className:"text-[70px] leading-[80px] text-center",children:"👀"}),r.jsx("p",{className:"text-white",children:"当前格式不支持预览"})]});const _M=()=>{const e=Oe(),t=(n,s,a)=>e(()=>{e(()=>{const{blocks:o}=pe(),i=o[n];i&&i.data.pdfAnnotation&&_e(n,{data:{localUrl:a,pdfAnnotation:{...i.data.pdfAnnotation,...s}}})})});return y.useCallback(t,[e])},xM=()=>{const e=Oe(),t=(n,s,a=!1)=>{const o=()=>{var c;const{blocks:i}=pe(),l=i[n];l&&_e(n,{data:{format:{pdfFormat:{...(c=l.data.format)==null?void 0:c.pdfFormat,...s}}}})};a?o():e(o)};return y.useCallback(t,[e])},Sle=(e,t,n=!1)=>{e===t.parentId||!t.parentId||(t.first||t.before?re(l1({uuid:e,parentId:t.parentId,before:t.before,ignoreOp:n})):re(c1({uuid:e,parentId:t.parentId,after:t.after,ignoreOp:n})))},TN=(e,t,n=!1)=>{e===t.parentId||!t.parentId||re(d1({parentId:t.parentId,uuid:e,ignoreOp:n}))},Xb=e=>{var o;const{blocks:t,collectionViews:n}=pe(),s=t[e];if(!s)return;const a=t[s.parentId];a&&(a.type===m.BlockType.COLLECTION_VIEW||a.type===m.BlockType.COLLECTION_VIEW_PAGE)&&((o=a.views)==null||o.forEach(i=>{n[i]&&re(cd({viewId:i,uuid:e}))}))},wc=vd.create((e,t,n=pe().blocks)=>{var h,p,g,_;const s=n[e],a=s==null?void 0:s.parentId,o=n[a!=null?a:""],i=(h=o==null?void 0:o.data.schema)==null?void 0:h[t],{collectionId:l}=i!=null?i:{},c=n[l!=null?l:""],d=(g=(p=s==null?void 0:s.data.collectionProperties)==null?void 0:p[t])!=null?g:[],u=new Set((_=c==null?void 0:c.subNodes)!=null?_:[]),f=new Set;return d.forEach(x=>{x.type===m.TextType.LINK_PAGE&&x.uuid&&u.has(x.uuid)&&f.add(x.uuid)}),{relationRecords:[...f],relationCollection:c}},(e,t)=>[e,t]),Dle={},Qb=qp(()=>Dle),vN=(e,t,n)=>Qb(s=>{var a,o;return(o=(a=s[e+t])==null?void 0:a[n])!=null?o:!1}),IN=(e,t,n)=>y.useCallback(s=>Ale(e,t,n,s),[e,n,t]),Ale=(e,t,n,s)=>{const a=Qb.getState(),o=a[e+t];Qb.setState({...a,[e+t]:{...o,["".concat(n)]:s}})},zm=e=>ft(e,t=>ef(e)),aE=e=>ft(e,t=>{var n;return(n=t==null?void 0:t.data.format)==null?void 0:n.openSubItem}),ef=e=>{var s,a;if(!e)return;const t=pe().blocks[e],n=(s=t==null?void 0:t.data.format)==null?void 0:s.openSubItem;return!n||!n.parentPropertyId?!1:!!((a=t==null?void 0:t.data.schema)!=null&&a[n.parentPropertyId])},yM=e=>{var n;if(!e)return;if(ef(e.uuid)){const{subNodes:s}=e,a=(n=e.data.format)==null?void 0:n.openSubItem,o=a==null?void 0:a.parentPropertyId;if(a&&o){const i=new Map,l=new Map;return s.forEach(c=>{const{relationRecords:d}=wc(c,o);d.forEach(u=>{var p,g;const f=(p=i.get(u))!=null?p:[];f.push(c),i.set(u,f);const h=(g=l.get(c))!=null?g:[];h.push(u),l.set(c,h)})}),[i,l]}}},bM=(e,t,n=!0)=>{const s=yM(pe().blocks[e]);let a=t;const o=s==null?void 0:s[0];return o&&(t.forEach(i=>{const l=FM(i,o);a.push(i),a.push(...l)}),n&&(a=[...new Set(a)])),a},FM=(e,t,n=0)=>{const s=t.get(e),a=[];return n>=10?[]:s?(s.forEach(o=>{a.push(o);const i=FM(o,t,n+1);a.push(...i)}),a):[]},By=(e,t,n)=>{const s=yM(pe().blocks[e]),a=[],o=s==null?void 0:s[0];return o?(n.forEach(i=>{const l=Rle(e,t,i,o);a.push(i),a.push(...l)}),a):n},Rle=(e,t,n,s,a=0)=>{const o=s.get(n),i=Qb.getState(),l=[];return a>=10?[]:(o==null||o.forEach(c=>{var u;((u=i[e+t])==null?void 0:u[n])&&l.push(c)}),l)},Il=e=>Ce(t=>wM(e,t),[e]),wM=(e,t)=>{var a;const n=t.collectionViews[e];let s="Card";return Jb(n==null?void 0:n.type)&&(s="Nested"),(a=n==null?void 0:n.format.subItemstyle)!=null?a:s},Jb=e=>e&&[m.CollectionViewType.TABLE,m.CollectionViewType.TIMELINE,m.CollectionViewType.LIST].includes(e),gr=e=>{const t=Array.isArray(e)?e:[e],{blocks:n}=pe(),s=new Map;t.forEach(o=>{var l,c;const i=(l=n[o])==null?void 0:l.parentId;if(i){const d=n[i];if(((d==null?void 0:d.type)===m.BlockType.COLLECTION_VIEW_PAGE||(d==null?void 0:d.type)===m.BlockType.COLLECTION_VIEW)&&ef(d.uuid)){const f=(c=s.get(d.uuid))!=null?c:[];f.push(o),s.set(d.uuid,f)}}});let a=[...t];s.forEach((o,i)=>{const l=bM(i,o);a.push(...l)}),a=[...new Set(a)],Ls.unstable_batchedUpdates(()=>{a.forEach(o=>{var c,d;const i=n[o];if(!i)return;const l=Pn();if(l.uuid!==i.uuid){if(Xb(o),re(Sn({uuid:o,patch:{status:m.BlockStatus.DELETED,...fu()}})),i.isTemplate){const u=i.parentId,f=pe().blocks[u];if(f!=null){const h=(c=f.templatePages)!=null?c:[],p=fL(h,o);re(Sn({uuid:u,patch:{templatePages:p}}))}}else re(Tr({uuid:o}));nI(o)&&re(dm({parentId:yt.currentSpaceViewId,uuid:o})),(d=l==null?void 0:l.customTemplates)==null||d.forEach(u=>{sc(u).has(o)&&TN(u,{parentId:l.uuid})}),C0(o),fm(i.uuid,i.parentId)}})})},wT=e=>{var l;const[t,n]=e.split(",");if(!t||!n)return;const s=atob(n),a=(l=t.split(":")[1])==null?void 0:l.split(";")[0],o=new ArrayBuffer(s.length),i=new Uint8Array(o);for(let c=0;c<s.length;c++)i[c]=s.charCodeAt(c);return new Blob([o],{type:a})},NN=()=>r.jsx("div",{className:"text-t2 text-grey4 flex justify-center w-full h-10 items-center",children:"正在搜索..."}),EM=()=>{const e=$1(),t=async(s,a=!0)=>{var F,b,w;const{spaceId:o=Ot(),pageNo:i,perPage:l,search:c,fileType:d,type:u,source:f,parentId:h}=s,p=await ve.editor.searchDocs(o,i,l,c,d,u,f,h),{blocks:g}=(F=p.recordMap)!=null?F:{};if(!g)return{hasMore:!1,result:[],total:(b=p.total)!=null?b:0};const _=E=>{const C=[];let k=g[E];for(;k&&k.spaceId!==k.uuid;)k=g[k.parentId],k&&tn(k.type)&&C.unshift(k);return C};a&&e(Tn.update({blocks:g}));const x=p.results.map(E=>{const C=g[E.uuid];if(C)return{block:C,coverUrl:E.coverUrl,navs:_(E.uuid)}}).filter(E=>!!E);return{hasMore:p.more,result:x,total:(w=p.total)!=null?w:0}};return async(s,a=!0)=>{let o=!0;const i=[];let l=0;const c=10;let d=0;do{const u=await t({...s,pageNo:s.pageNo+l},a);o=u.hasMore,i.push(...u.result),l++,d=u.total}while(o&&i.length<s.perPage&&l<c);return{hasMore:o,total:d,newPageNo:s.pageNo+l-1,resultBlocks:i}}},rRe=()=>{const e=async(n,s,a,o=!0)=>{var d,u,f;const i=await ve.infra.getSpaceTrash(n,s,a),l=(d=i.recordMap)==null?void 0:d.blocks;if(!l)return{hasMore:!1,result:[],total:(u=i.total)!=null?u:0};o&&re(Tn.update({blocks:l}));const c=i.results.map(h=>{const p=l[h.uuid];if(p)return p.deletedAt=h.deletedAt,{block:p,coverUrl:h.coverUrl,navs:CM(l,h.uuid)}}).filter(h=>!!h);return{hasMore:i.more,result:c,total:(f=i.total)!=null?f:0}};return async(n,s,a,o=!0)=>{let i=!0;const l=[];let c=0;const d=10;let u=0;do{const f=await e(n,s+c,a,o);i=f.hasMore,l.push(...f.result),c++,u=f.total}while(i&&l.length<a&&c<d);return{hasMore:i,total:u,newPageNo:s+c-1,resultBlocks:l}}},CM=(e=pe().blocks,t)=>{const n=[];let s=e[t];for(;s&&s.spaceId!==s.uuid;)s=e[s.parentId],s&&tn(s.type)&&n.unshift(s);return n},oE=e=>{const{defaultList:t,type:n,fileType:s,source:a,parentId:o,canSearchWithEmpty:i=!1,getPerPage:l,spaceId:c}=e,d=EM(),u=y.useRef(1),f=y.useRef({search:async(E,C,k)=>{const T=await d({pageNo:E,search:C,perPage:k,type:n,fileType:s,source:a,parentId:o,spaceId:c});return u.current=T.newPageNo,T.resultBlocks},async convert(E){return E.map(C=>({uuid:C.block.uuid,title:fe(C.block.data.segments),type:C.block.type,navs:C.navs,data:{icon:C.block.data.icon,ossName:C.block.data.ossName,extName:rn(fe(C.block.data.segments)).extName,size:C.block.data.size},coverUrl:C.coverUrl,parentId:C.block.parentId}))},defaultList:t,getPerPage:l,canSearchWithEmpty:i}),{search:h,resultList:p,loading:g,hasMore:_,firstTime:x}=p9(f.current),F=y.useRef(""),{run:b}=Zv(E=>{F.current=E,u.current=1,h(1,F.current)},{wait:800}),w=y.useCallback(()=>{const E=u.current+1;h(u.current+1,F.current),u.current=E},[h]);return y.useEffect(()=>{f.current.defaultList=t,h(u.current,F.current)},[i,t,h]),{firstTime:x,resultList:p,loading:g,hasMore:_,loadMore:w,onInputChange:b,keyword:F.current}},hA=40,Ple=58,pA=256,oc=e=>r.jsx(jN,{...e,className:R("relative py-2.5 overflow-hidden next-modal w-60")}),jN=e=>{const t=!!e.footer,{filterItems:n=[]}=e,{keyword:s,resultList:a,loading:o,hasMore:i,loadMore:l,onInputChange:c}=oE({defaultList:e.defaultValue,type:e.searchType,source:e.source,parentId:e.parentId,canSearchWithEmpty:e.canSearchWithEmpty,fileType:e.fileType,spaceId:e.spaceId});y.useEffect(()=>{e.canSearchWithEmpty&&c("")},[e.canSearchWithEmpty]);const d=y.useMemo(()=>a.map(h=>({type:H.SEARCH,data:{uuid:h.uuid,title:fe(h.data.segments)||h.title||qt(h.type),avatarTitle:h.avatarTitle,icon:h.data.icon,navs:h.navs,type:h.type,backgroundColor:h.backgroundColor,...Gs(Hs.moveToItem)}})).filter(h=>!n.includes(h.data.uuid)),[n,a]),u=(h,p)=>{var _,x;const g=(_=d[p])==null?void 0:_.data;if(g){const F=a.find(b=>b.uuid===g.uuid);F&&((x=e.onSelect)==null||x.call(e,F))}},f=y.useMemo(()=>{const h=t?40:0,p=e.header?30:0;if(d.length===0)return pA/2;if(d.length>5)return pA+hA/2+h;let g=0;return d.forEach(_=>{_.data.navs&&_.data.navs.length>0?g+=Ple:g+=hA}),g+32+20+10+h+p},[d,t,e.header]);return r.jsxs("div",{className:R("relative max-h-[60vh]",e.className),style:{height:f,...e.style},children:[e.header,r.jsx(ze,{items:d,hasMore:i,loadMore:l,scrollContainerStyle:{top:e.header?"80px":"52px",paddingBottom:t?"40px":"0px"},onItemClick:u,customHeader:r.jsx(Ct,{autoFocus:!0,className:"h-8 mx-2.5",...Gs(Hs.moveToInput),placeholder:e.placeholder||"搜索页面",onChange:c}),loadingView:o&&r.jsx(NN,{}),customFooter:r.jsxs(r.Fragment,{children:[o&&i&&r.jsxs("div",{className:"relative flex flex-row items-center justify-center h-10",children:[r.jsx($s,{size:"middle"}),r.jsx("div",{className:"flex items-center ml-2 text-center text-t2 text-grey4",children:"正在加载..."})]}),!o&&d.length===0&&r.jsx("div",{className:"relative flex justify-center items-center h-10 text-t2 text-grey4 mt-auto",children:s?"没有找到相关结果":"搜点什么？"})]})}),e.footer]})};const Lle=y.memo(({copyButton:e,className:t,content:n="",...s})=>{const a=y.useRef(null),o=y.useRef(!0);return y.useEffect(()=>{const i=a.current;if(!i)return;const l=()=>{o.current=!1};return i.addEventListener("wheel",l),()=>{i.removeEventListener("wheel",l)}},[]),y.useEffect(()=>{const i=a.current;i&&o.current&&i.scrollHeight>i.offsetHeight&&(i.scrollTop=i.scrollHeight)},[n]),r.jsx("div",{dir:"auto",className:R("text-t2 markdown-render space-y-1",t),ref:a,children:r.jsx(vW,{remarkPlugins:[mL,IW],rehypePlugins:[NW,[jW,{detect:!0,ignoreMissing:!0}]],components:{a:({href:i,children:l})=>r.jsx("a",{href:i,target:"_blank",className:"border-b border-p6 border-dashed",rel:"nofollow noopener noreferrer",children:l}),pre:({children:i,...l})=>r.jsx(Ble,{copyButton:e,...l,children:i})},...s,children:n})})},yn),Ble=y.memo(({copyButton:e,className:t,children:n})=>{const[s,a]=y.useState(!1);return r.jsxs("pre",{className:R(t,"group group/pre_render relative pre-tag rounded overflow-hidden whitespace-pre-wrap"),children:[n,e||r.jsx("button",{onClick:async o=>{var l;const i=o.target.previousElementSibling;i&&(await iL((l=i.textContent)!=null?l:""),a(!0),setTimeout(()=>{a(!1)},3e3))},className:"group-hover:opacity-100 opacity-0 absolute right-2 top-2 flex justify-center items-center p-2 rounded border bg-white1 duration-200",children:s?"已复制":"复制"})]})},yn),ET=new Set;let CT=new Set;const Ole=qn(async e=>{const t=CT;CT=new Set;const n=await ve.editor.queryRecords({requests:[...t].map(s=>({id:s,table:"user"}))});if(n.users){re(Ha.updateSpaceUsers({users:n.users,space:e}));for(const s of Object.values(n.users))ET.delete(s.uuid)}},32),Mle=(e,t)=>{ET.has(e)||(CT.add(e),ET.add(e),Ole(t))},Pi=e=>{const t=Ce(s=>{if(e!=null)return typeof e=="object"?e:s.users[e]},[e],{allUser:!0}),n=Dt();return y.useEffect(()=>{e==null||e==="me"||typeof e=="object"||!e||t||Mle(e,n)},[e,t,n]),t},Ule=y.forwardRef(({singleLine:e,...t},n)=>e?r.jsx("input",{...t,ref:n}):r.jsx("textarea",{...t,ref:n})),oi=y.forwardRef((e,t)=>{const{className:n,fontClassName:s,boxClassName:a,singleLine:o,style:i,onKeyDown:l,autoSelectAll:c,shiftEnter:d,readonly:u,disabled:f,...h}=e;y.useEffect(()=>{const g=t==null?void 0:t.current;c&&setTimeout(()=>g.select())},[c,t]);const p={spellCheck:!1,ref:t,disabled:f||u,style:{...i,height:typeof(i==null?void 0:i.height)=="string"?Number(i==null?void 0:i.height):i==null?void 0:i.height,fontWeight:"inherit"},className:R("w-full h-full bg-transparent resize-none block overflow-hidden appearance-none outline-none placeholder-grey4 overscroll-none",(f||u)&&"pointer-events-none",n,s),...h,onKeyDown:g=>{Ie(["Enter","Shift+Enter"])(g)&&(d||g.preventDefault()),l==null||l(g)}};return o?r.jsxs("div",{className:R("relative",a),children:[r.jsx(Ule,{...p,singleLine:!0}),e.children]}):r.jsxs("div",{className:R("relative",a),children:[r.jsx(SW,{...p}),e.children]})}),SN=new Map,oC=e=>SN.get(e),kM=(e,t)=>{SN.set(e,t)},TM=e=>{SN.delete(e)},B0=e=>{const t=J.blocks[e];return t?t.type===m.BlockType.FILE&&t.data.display==="image"?!0:[m.BlockType.TEXTAREA,m.BlockType.HEADER,m.BlockType.QUOTE,m.BlockType.TODO,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.MARK,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE].includes(t.type):!1},vM=(e,t,n)=>{NM.put(iE(e.getState().rootId,n),t)},IM=(e,t)=>NM.get(iE(e,t)),iE=(e,t)=>t?"embed_".concat(e):e,Vle=(e,t)=>jM.get(iE(e,t)),$le=(e,t,n)=>{jM.put(iE(e,t),n)},NM=new Ai(localStorage,"mindMap-scale",30),jM=new Ai(localStorage,"mindMap-scroll",30);new Ai(localStorage,"embed-mindMap-scale",30).clear();const Hle=e=>{let t="";return e.split("data: ").forEach(n=>{if(n=n.trim(),n)try{const s=JSON.parse(n);t+=s.content}catch(s){return console.log("----parse error",s,e),""}}),t},zle=e=>{const t=[];return e.split("data: ").forEach(n=>{if(n=n.trim(),n)try{const s=JSON.parse(n);t.push(s)}catch(s){console.log("----parse error",s,e)}}),t},U_=e=>{var t,n,s,a,o,i;return e.type===m.BlockType.HEADER?"".concat(e.type,"-").concat((t=e.data.level)!=null?t:0):e.type===m.BlockType.ORDER_LIST?"".concat(e.type,"-").concat((s=(n=e.data.format)==null?void 0:n.orderListFormat)!=null?s:"number"):e.type===m.BlockType.LIST?"".concat(e.type,"-").concat((o=(a=e.data.format)==null?void 0:a.listFormat)!=null?o:"disc"):"".concat(e.type,"-").concat((i=e.data.level)!=null?i:0)},SM=e=>{if(B0(e)){const t=J.blocks[e];if((t==null?void 0:t.subNodes.length)===0)return e;const n=An(t==null?void 0:t.subNodes);return n?SM(n):e}return e},gA=e=>{const t=[];let n=e;for(;n;){const s=J.blocks[n];if(!s||!B0(n))break;t.push(U_(s)),n=An(s.subNodes)}return t},V_=e=>{var s;const t=J.blocks[e];if(ir(t==null?void 0:t.type))return{isMindMapPage:!0,isInMindMap:!1};const n=ks(e);return n&&ir((s=J.blocks[n])==null?void 0:s.type)?{isMindMapPage:!1,isInMindMap:!0}:{isMindMapPage:!1,isInMindMap:!1}},qle=({recordId:e,uuid:t,propertyId:n,ossName:s,container:a})=>{const[o,i]=y.useState(""),l=nee(),c=Ut(),d=y.useRef(null),u=Dt();y.useEffect(()=>{var h;(h=d.current)==null||h.focus()},[l]);const f=async()=>{var _;const h=t!=null?t:e;if(!h||!o.trim())return;i(""),(_=d.current)==null||_.blur();const g={quote:l.length>0?l.map(x=>({pageNumber:x[0],content:x[1],coords:x[2]})):[],question:o,ossName:s,blockId:h,propertyId:n,spaceId:u.uuid};kT(c.uuid,g,a)};return r.jsxs("div",{className:"p-4 bg-white2 sticky bottom-0 border-t",children:[l.length>0&&r.jsx(r.Fragment,{children:l.map(h=>r.jsxs("div",{className:"flex justify-between items-center mb-2.5",children:[r.jsxs(Fe,{popup:h[1],popupClass:"line-clamp-none",className:"py-2 px-3 bg-grey8 rounded text-ellipsis flex-1 flex items-center ",children:[r.jsx("span",{className:"w-1 bg-grey4 mr-3 inline-block h-5 flex-shrink-0"}),r.jsx("span",{className:"text-ellipsis",children:h[1]})]}),r.jsx(V,{name:"IcUploadCancel",size:"middle",className:"ml-3 text-grey4 cursor-pointer",onClick:()=>{st({$pdfQuotes:l.filter(p=>p[0]!==h[0]||p[1]!==h[1])})}})]},h[1]))}),r.jsxs("div",{className:"flex justify-between items-end bg-white2 px-4 py-2.5 border rounded",children:[r.jsx(oi,{ref:d,singleLine:!1,placeholder:"告诉 ".concat(pm," 助手写什么..."),boxClassName:"flex-grow",fontClassName:"text-t2 pdf-sidebar-input",onKeyDown:h=>{h.nativeEvent.isComposing||Ie("enter")(h)&&f()},value:o,onChange:h=>{const p=h.target;p&&i(p.value)}}),r.jsx(V,{name:"IcCommentSend",onClick:()=>f(),size:"large",className:R("text-grey4 self-end cursor-pointer justify-end",o&&"text-active_color")})]})]})},kT=async(e,t,n,s="")=>{var g;let a=[...xt.$pdfAIContents];s&&(a=xt.$pdfAIContents.filter(_=>_.uuid!==s));const o=qe(),i={uuid:o,ai:"",user:t.question,createdBy:e,createdAt:Date.now(),quote:t.quote.length>0?t.quote.map(_=>_.content).join("\n"):"",originQuote:t.quote,links:[]};st({$pdfAIContents:a.concat({...i}),$pdfQuotes:[]}),setTimeout(()=>{const _=n.current;_&&(_.scrollTop=_.scrollHeight)});const l={"Content-Type":"application/json"},c=eg();c&&(l.Authorization="Bearer ".concat(c));const d=await fetch("/api/chat/ask",{method:"POST",headers:l,body:JSON.stringify(t)});if(!d.ok)return;const u=d.body;if(!u)return;const f=u.getReader(),h=new TextDecoder,p=[];for(;;){const{value:_,done:x}=await f.read();if(x){const C=xt.$pdfAIContents.findIndex(k=>k.uuid===i.uuid);if(C>-1){const k=[...xt.$pdfAIContents];k[C]={...i,links:p.map(({page:T,coords:v})=>({type:"quote",pageNumber:T,content:"",coords:v}))},st({$pdfAIContents:k})}break}const F=h.decode(_);if(F.startsWith("error:"))break;const b=zle(F),w=b.find(C=>C.code===500);if(w){const C=[...xt.$pdfAIContents],k=xt.$pdfAIContents.findIndex(T=>T.uuid===i.uuid);C[k]={...i,error:w.msg},st({$pdfAIContents:C}),be.warning((g=w.msg)!=null?g:"");return}b.forEach(C=>{const{type:k,pageNumber:T,content:v,coords:I=[]}=C;k==="quote"&&T&&p.push({page:Number(T),coords:I}),k==="uuid"&&v&&(i.uuid=v),k==="answer"&&v&&(i.ai+=v)});const E=xt.$pdfAIContents.findIndex(C=>C.uuid===i.uuid||C.uuid===o);if(E>-1){const C=[...xt.$pdfAIContents];C[E]={...i},st({$pdfAIContents:C})}}},Gle=({chatInfo:e,recordId:t,uuid:n,propertyId:s,ossName:a,editable:o,application:i,container:l})=>{const{uuid:c,ai:d,user:u,error:f,quote:h,createdBy:p,links:g=[],originQuote:_=[]}=e,x=ie(),F=Ut(),b=Pi(p),w=_r(p,b==null?void 0:b.nickname),E=Dt(),C=()=>{x.warning({title:"确定删除该会话？",confirm:async()=>{ve.ai.deleteAiChatFile({uuid:c}).then(()=>{st({$pdfAIContents:xt.$pdfAIContents.filter(S=>S.uuid!==c)}),be.success("已删除")})}})},k=()=>{let S="";h&&(S="".concat(S+h,"\n\n")),u&&(S="".concat(S+u,"\n\n")),d&&(S="".concat(S+d,"\n\n")),g&&g.forEach(D=>{D.content&&(S="".concat(S+D.content,"\n\n"))}),Xt(S)},T=(S,D=[])=>{if(!S||!i.pdfViewer)return;document.querySelectorAll(".".concat(xN)).forEach(U=>U.remove());let P;const[L=56.69292,O,$,M=765.5412]=D;if(L&&M){P=[null,{name:"XYZ"},L,M+15,null];const{viewport:U,textLayer:z}=i.pdfViewer.getPageView(S-1);if(z&&U)_A(U,z.textLayerDiv,D);else{const K=W=>{const{source:Y}=W,{textLayerDiv:G,viewport:ee,pageNumber:te}=Y;S===te&&(xn.off("pdfRenderPage",K),!(!G||!ee)&&_A(ee,G,D))};xn.on("pdfRenderPage",K)}}i.pdfViewer.scrollPageIntoView({pageNumber:S,destArray:P})},v=async S=>{if(!o||(n=n!=null?n:t,!n))return;const D={quote:[],question:S,ossName:a,blockId:n,propertyId:s,spaceId:E.uuid};kT(F.uuid,D,l)},I=()=>{if(n=n!=null?n:t,!n)return;const S={quote:_,question:u,ossName:a,blockId:n,propertyId:s,spaceId:E.uuid};kT(p,S,l,c)},j=g.find(S=>S.type==="question");return r.jsxs("div",{className:"flex flex-col group relative ",children:[u&&r.jsxs("div",{className:"flex items-start py-2 w-fit",children:[r.jsx(ar,{className:"!text-t2-medium mr-2 rounded-full text-white mt-1.5",imgClassName:"rounded-full",name:w||"客",color:(b==null?void 0:b.backgroundColor)||void 0,icon:b!=null&&b.avatar?{type:"upload",value:b.avatar}:void 0,iconSize:24}),r.jsxs("div",{className:"flex-1 bg-active_color/10 rounded",children:[h&&r.jsx("div",{className:"px-2 mt-2 text-t2 rounded flex relative text-grey3 max-h-[300px] overflow-auto",children:r.jsx("span",{className:"whitespace-pre-wrap ml-1 h-fit border-l-4 border-grey4 pl-2",children:h})}),r.jsx("div",{className:"p-2 text-t2 rounded",children:u})]})]}),r.jsxs("div",{className:"flex items-start py-2 w-fit",children:[r.jsx("div",{className:"w-6 h-6 mr-2 rounded-full flex items-center justify-center mt-1.5 flex-shrink-0",children:r.jsx(V,{size:"small",name:"IcAi"})}),r.jsxs("div",{className:"flex-1 break-words",children:[r.jsxs("div",{className:"bg-grey7 p-2 text-t2 rounded min-h-[36px]",children:[!f&&r.jsx(r.Fragment,{children:d?r.jsx(Lle,{content:d}):r.jsx("span",{className:"relative top-0.5 w-0.5 h-4 bg-black cursor-text blink inline-block ml-0.5"})}),f]}),f&&r.jsxs("div",{className:"ml-auto text-t3 text-grey3 mt-2 flex items-center cursor-pointer",onClick:I,children:[r.jsx(V,{size:"middle",name:"IcTryAgain",className:"mr-1"}),"重试"]}),j&&r.jsx(r.Fragment,{children:g.map((S,D)=>{const{content:A}=S;return A?r.jsxs("div",{className:"bg-grey7 p-2 text-t2 mt-2 rounded w-fit text-active_color cursor-pointer",onClick:()=>v(A),children:["问题",D+1,"：",A]},A):null})}),!j&&(g==null?void 0:g.length)>0&&r.jsx("div",{className:"bg-grey8 p-2 text-t2 mt-2 w-fit rounded",children:g.map(S=>{var D;return r.jsxs("span",{className:"text-grey3 underline cursor-pointer ml-2 first:ml-0",onClick:()=>{var A;S.pageNumber&&T(S.pageNumber,(A=S.coords)!=null?A:[])},children:["页码 ",S.pageNumber]},S.pageNumber+((D=S.coords)!=null?D:[]).toString())})})]})]}),r.jsx(Cr,{className:"my-1"}),o&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"absolute -top-3 right-0 border border-black/10 transition-opacity duration-250 rounded opacity-0 group-hover:opacity-100 flex bg-white2 items-center h-[26px]",children:[r.jsx("span",{className:"px-1 border-r border-black/10 cursor-pointer h-full flex items-center animate-hover-black3",onClick:k,children:r.jsx(V,{name:"IcCopy",size:"middle"})}),r.jsx("span",{className:"px-1 border-r border-black/10 cursor-pointer h-full flex items-center animate-hover-black3",onClick:C,children:r.jsx(V,{name:"IcTrash",size:"middle"})})]})})]})},_A=(e,t,n)=>{if(n.length!==4)return;const[s=56.69292,a=159.4032,o=535.59992,i=765.5412]=n,l=n.toString();let c=t.parentElement.querySelector('[data-coords="'.concat(l,'"]'));if(c)return;const d=e.convertToViewportPoint(s,a),u=e.convertToViewportPoint(o,i);c=document.createElement("div"),c.classList.add(xN),c.setAttribute("data-coords",l),t.parentElement.appendChild(c),c.style.cssText="\n    position: absolute;\n    left: ".concat(d[0],"px;\n    top : ").concat(u[1],"px;\n    width: ").concat(u[0]-d[0],"px;\n    height: ").concat(d[1]-u[1],"px;\n    background: rgba(24, 160, 251, 0.10);\n  ")};Aa(()=>({aiMembers:[]}));const Wle=e=>{const{space:t,user:n,members:s}=e,{permissionGroups:a=[]}=t!=null?t:{},o=new Map;a.forEach(c=>{o.set(c.id,new Set(c.userIds))});const i=!0,l=!0;return{enableAI:l&&i&&!vY(),spaceAiOpen:l,isAllowed:i}},xr=()=>{const e=Dt(),t=Ut(),n=cee();return Wle({members:n,space:e,user:t})};const Kle=e=>{const{uuid:t,recordId:n,propertyId:s,ossName:a,application:o}=e,i=t!=null?t:n,l=ie(),c=lt(),d=see(),[u,f]=y.useState(0),[h,p]=y.useState(!1),g=y.useRef(),{enableAI:_,isAllowed:x}=xr(),{role:F}=mt(i),b=We(i),w=y.useRef(null),E=Dt(),C=Ot(),k=_&&x&&(F===m.PermissionRole.WRITER||F===m.PermissionRole.EDITOR);y.useEffect(()=>{var S;(S=g.current)==null||S.abort(),f(0),T()},[t,n,a,s]);const T=()=>{if(!i)return;if(b&&!location.pathname.includes("preview")){p(!0),f(3),ve.ai.getAiChatFile(a,C,i,s).then(P=>{st({$pdfAIContents:P})});return}const S={ossName:a,blockId:i,propertyId:s,spaceId:E.uuid};g.current=new AbortController;const D={"Content-Type":"application/json"},A=eg();A&&(D.Authorization="Bearer ".concat(A)),fetch("/api/chat/file",{signal:g.current.signal,method:"POST",headers:D,body:JSON.stringify(S)}).then(P=>P.json()).then(P=>{if(P.code!==200){be.error(P.msg),f(2);return}P&&(p(!0),f(3),ve.ai.getAiChatFile(a,C,i,s).then(L=>{o.setAIShowSideBar(!0),s?c===n&&ot.ossName===a&&ot.propertyId===s&&st({$pdfAIContents:L}):c===t&&st({$pdfAIContents:L})}))}).catch(()=>{f(2)})},v=S=>{hn(()=>{d.forEach(D=>{const{quote:A,user:P,ai:L,links:O}=D;A&&ut({type:m.BlockType.QUOTE,data:{segments:ht(A)}},{parentId:S,last:!0});let $=[],M="";if(P&&(M="".concat(M+P,"\n")),L&&(M="".concat(M+L,"\n")),O){const U=O.find(z=>z.type==="quote");$=ht(M),U&&t?O.forEach((z,K)=>{K>0&&$.push({enhancer:{},text:"  ",type:m.TextType.TEXT}),$.push({enhancer:{},text:["页码",z.pageNumber,K===O.length-1?"\n":""].join(""),type:m.TextType.URL,url:"".concat(_n(),"/preview/").concat(t,"?annotationPos=").concat(z.pageNumber)})}):(O.forEach(z=>{z.content&&(M="".concat(M+z.content,"\n"))}),$=ht(M))}ut({type:m.BlockType.TEXTAREA,data:{segments:$}},{parentId:S,last:!0})}),be.success({duration:5e3,content:r.jsxs("div",{className:"flex items-center justify-between w-40",children:[r.jsx("div",{className:"text-t2",children:"导出成功"}),r.jsx("a",{href:"/".concat(S),target:"_blank",className:"text-t4 text-active_color animate-click",children:"跳转查看"})]})})})},I=async S=>{var O,$;const D=S.currentTarget,A=Ot(),{blocks:P}=pe(),L=(($=(O=P[A])==null?void 0:O.subNodes)!=null?$:[]).map(M=>{const U=P[M];if(U&&(U.type===m.BlockType.PAGE||U.type===m.BlockType.COLLECTION_VIEW||U.type===m.BlockType.COLLECTION_VIEW_PAGE))return fg(U)}).filter(M=>!!M);l.dropdown({popcorn:D,placement:"bottom-end",offset:[0,10],content:({onCloseModal:M})=>r.jsx(oc,{onSelect:U=>{if(U.type!==m.BlockType.PAGE){be.warning("不支持该页面类型");return}v(U.uuid),M()},defaultValue:L,searchType:"page",source:"move"})})},j={0:"正在阅读文档...",1:"已停止阅读，请重试",2:"处理失败，请重试"};return r.jsxs("div",{className:"w-full h-full bg-white2 border-l overflow-auto flex flex-col",ref:w,children:[r.jsxs("div",{className:"h-10 flex items-center text-t2-medium justify-between px-4 border-b sticky top-0 bg-white2 z-10",children:[r.jsx("span",{children:"AI 聊天"}),h&&!b&&r.jsx("button",{className:"text-t2 text-active_color p-1",onClick:I,children:"导出"})]}),u!==3&&r.jsxs("div",{className:"text-t2 flex items-center mt-4 px-4 pb-20",children:[r.jsx("div",{className:"w-6 h-6 mr-2 rounded-full flex items-center justify-center",children:r.jsx(V,{size:"small",name:"IcAi"})}),j[u],r.jsx("span",{className:"ml-auto cursor-pointer text-grey3",onClick:()=>{var S;u===0?((S=g.current)==null||S.abort(),f(1)):(f(0),T())},children:u===0?"停止":"重试"})]}),u===3&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mt-4 px-4 pb-20 flex-1",children:d.map(S=>y.createElement(Gle,{...e,key:S.uuid,chatInfo:S,editable:k,container:w}))}),k&&r.jsx(qle,{...e,container:w})]})]})},cr=e=>ft(e),Zb=[{name:"蓝色",value:Gd.BLUE},{name:"绿色",value:Gd.GREEN},{name:"黄色",value:Gd.YELLOW},{name:"橙色",value:Gd.ORANGE},{name:"粉红色",value:Gd.PINK},{name:"粉紫色",value:Gd.PURPLE}],Yle=({closeModal:e,color:t,setColor:n})=>{const s=Zb.map(o=>({type:H.OPERATION,data:{title:o.name,value:o.value,icon:r.jsx("span",{className:"rounded-full w-[18px] h-[18px]",style:{backgroundColor:o.value}}),arrow:r.jsx(V,{name:"IcCheck02",size:"normal"}),hasArrow:t===o.value}})),a=({data:o})=>{xn.emit("pdfCursorColor",o.value),n(o.value),e()};return r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:s,onItemClick:a})},Xle=({className:e,pdfViewer:t})=>{const n=ie(),[s,a]=y.useState(Gd.YELLOW),o=i=>{n.dropdown({popcorn:i.currentTarget,placement:"bottom",offset:[0,10],content:({onCloseModal:l})=>r.jsx(Yle,{closeModal:l,pdfViewer:t,color:s,setColor:a})})};return r.jsxs("div",{className:R("flex items-center animate-hover p-1",e),onClick:o,children:[r.jsx("span",{className:"rounded-full w-[18px] h-[18px]",style:{backgroundColor:s}}),r.jsx(V,{size:"xxsmall",name:"IcArrowDown01",className:"ml-1"})]})},TT={filter:""},DM=e=>Ce(({blocks:n})=>{const s=n[e];if(!s)return;const a={};return s==null||s.subNodes.forEach(o=>{var f;const i=n[o];if(!i)return;const{pdfAnnotation:l,localUrl:c}=i.data;if(!l)return;const d={...l,localUrl:c,uuid:o},{pageNumber:u}=l;a[u]=[...(f=a[u])!=null?f:[],d]}),Object.keys(a).forEach(o=>{const i=a[o];i&&(a[o]=yie(i))}),a},[e]),xA=[{name:"所有标注",type:"all"},{name:"当前筛选范围",type:"filter"}],yA=[{name:"带引用链接的标注",type:"refBlock"},{name:"仅导出标注内容",ype:"AnnotationContent"}],AM=({onCloseModal:e,uuid:t})=>{const n=ie(),s=Oe(),a=Ut(),o=DM(t),[i,l]=y.useState(xA[0]),[c,d]=y.useState(yA[0]),[u,f]=y.useState({id:"",title:"创建新页面"}),h=F=>{n.dropdown({popcorn:F.currentTarget,placement:"bottom-end",offset:[0,10],content:({onCloseModal:b})=>r.jsx(ze,{className:"next-modal w-[180px] py-[5px] bg-white4",onItemClick:()=>b(),items:xA.map(w=>({type:H.OPERATION,data:{title:w.name,arrow:r.jsx(V,{name:"IcCheck02",size:"normal"}),hasArrow:(i==null?void 0:i.type)===w.type,onClick:()=>l(w)}}))})})},p=F=>{n.dropdown({popcorn:F.currentTarget,placement:"bottom-end",offset:[0,10],content:({onCloseModal:b})=>r.jsx(ze,{className:"next-modal w-[180px] py-[5px] bg-white4",onItemClick:()=>b(),items:yA.map(w=>({type:H.OPERATION,data:{title:w.name,arrow:r.jsx(V,{name:"IcCheck02",size:"normal"}),hasArrow:(c==null?void 0:c.type)===w.type,onClick:()=>d(w)}}))})})},g=async F=>{const b=F.currentTarget,w=Ot();(()=>{var T,v;const{blocks:C}=pe(),k=((v=(T=C[w])==null?void 0:T.subNodes)!=null?v:[]).map(I=>{const j=C[I];if(j&&(j.type===m.BlockType.PAGE||j.type===m.BlockType.COLLECTION_VIEW||j.type===m.BlockType.COLLECTION_VIEW_PAGE))return fg(j)}).filter(I=>!!I);n.dropdown({popcorn:b,placement:"bottom-end",offset:[0,10],content:({onCloseModal:I})=>r.jsx(oc,{onSelect:j=>{if(j.type!==m.BlockType.PAGE){be.warning("不支持该页面类型");return}f({id:j.uuid,title:j.title}),I()},defaultValue:k,searchType:"page",footer:r.jsx("div",{className:"absolute bottom-0 w-full h-10 bg-white2 border-t border-grey6",children:r.jsxs("div",{className:"flex items-center justify-center h-full animate-hover text-grey3",onClick:()=>{f({id:"",title:"创建新页面"}),I()},children:[r.jsx(V,{name:"IcAdd",size:"middle"}),r.jsx("div",{className:"ml-1.5 text-t2",children:"创建新页面"})]})}),source:"move"})})})()},_=[{title:"导出范围",name:i==null?void 0:i.name,onClick:h},{title:"导出内容",name:c==null?void 0:c.name,onClick:p},{title:"导出至页面",name:u.title,onClick:g}],x=()=>{me.event("export_pdf_highlight",{file_id:t}),s(()=>{const F=Ot(),b=u.id||ut({type:m.BlockType.PAGE,permissions:[{role:m.PermissionRole.EDITOR,type:m.PermissionType.USER,userId:a.uuid}]},{parentId:F,last:!0});Object.keys(o!=null?o:{}).sort((E,C)=>Number(E)-Number(C)).forEach(E=>{const C=o==null?void 0:o[E];C&&C.forEach(k=>{var T;if(!((i==null?void 0:i.type)==="filter"&&TT.filter&&k.color!==TT.filter))if(k.type===_t.HIGHLIGHT){const v={enhancer:{},type:m.TextType.TEXT,text:(T=k.text)!=null?T:""};(c==null?void 0:c.type)==="refBlock"&&(v.type=m.TextType.MENTION_BLOCK,v.uuid=k.uuid),ut({type:m.BlockType.TEXTAREA,data:{segments:[v]}},{parentId:b,last:!0})}else{const v={enhancer:{},type:m.TextType.TEXT,text:"图片标注.png"};(c==null?void 0:c.type)==="refBlock"?ut({type:m.BlockType.REFERENCE,data:{ref:{uuid:k.uuid},display:"image",segments:[v]}},{parentId:b,last:!0}):ut({type:m.BlockType.FILE,data:{display:"image",segments:[v],extName:"png",height:k.height,ossName:k.ossName,size:k.size,width:k.width}},{parentId:b,last:!0})}})}),window.open("".concat(_n(),"/").concat(b)),e()})};return r.jsxs("div",{className:"next-modal w-[360px] py-4",children:[_.map(({title:F,name:b,onClick:w})=>r.jsxs("div",{className:"flex justify-between items-center h-10 px-8",children:[r.jsx("span",{className:"text-t2 text-grey3",children:F}),r.jsxs("button",{className:R("flex items-center animate-hover p-1 text-t2 text-black"),onClick:w,children:[b,r.jsx(V,{size:"xxsmall",name:"IcArrowDown01",className:"ml-2"})]})]},b)),r.jsxs("div",{className:"flex items-center justify-end mt-3.5 pr-8",children:[r.jsx(De,{onClick:e,className:"mr-2.5 text-t2",children:"取消"}),r.jsx(De,{colorType:"active",className:"text-t2-medium text-white",onClick:x,children:"导出"})]})]})},Qle=({filterColor:e,setFilterColor:t,colorOptions:n})=>{const[s,a]=y.useState(e),o=n.map(l=>({type:H.OPERATION,data:{title:l.name,value:l.value,icon:r.jsx("span",{className:"rounded-full w-[18px] h-[18px]",style:{backgroundColor:l.value}}),arrow:r.jsx(V,{name:"IcCheck02",size:"normal"}),hasArrow:s===l.value}})),i=({data:l})=>{a(l.value),TT.filter=l.value,t(l.value)};return r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:o,onItemClick:i})},Jle=({uuid:e,pdfViewer:t})=>{var h,p;const n=ie(),[s,a]=y.useState(),o=DM(e),i=We(e),l=Object.keys(o!=null?o:{}).length===0,c=g=>{const _=new Set;Object.values(o!=null?o:{}).flat().forEach(F=>{_.add(F.color)});const x=[{type:H.OPERATION,data:{title:"所有标注",onClick:()=>a(void 0)}},{type:H.OPERATION,data:{title:"按颜色筛选",hasArrow:!0,disable:l,renderSubMenu:()=>r.jsx(Qle,{filterColor:s,setFilterColor:a,colorOptions:Zb.filter(F=>_.has(F.value))})}}];n.dropdown({popcorn:g.currentTarget,placement:"bottom-end",content:({onCloseModal:F})=>r.jsx(ze,{className:"next-modal w-[160px] py-[5px] bg-white4",items:x,onItemClick:()=>F()})})},d=g=>{const _=[{type:H.OPERATION,data:{icon:"IcExportPage",title:"导出标注",label:r.jsx("span",{className:"bg-grey6 text-t4 text-grey3 ml-1 rounded-sm px-1.5 py-0.5",children:"限免"}),onClick:()=>{n.modal({content:({onCloseModal:x})=>r.jsx(AM,{onCloseModal:x,uuid:e})})}}}];n.dropdown({popcorn:g.currentTarget,placement:"bottom",content:({onCloseModal:x})=>r.jsx(ze,{className:"next-modal w-[180px] py-[5px] bg-white4",items:_,onItemClick:()=>x()})})};if(!o)return null;const u=Object.keys(o!=null?o:{}).sort((g,_)=>Number(g)-Number(_)),f=(p=(h=Zb.find(g=>g.value===s))==null?void 0:h.name)!=null?p:"所有标注";return r.jsxs("div",{className:"px-3",children:[r.jsx("div",{className:"text-grey3",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("button",{className:"text-t2 h-9 animate-hover flex items-center p-1",onClick:c,children:[f,r.jsx(V,{name:"IcArrowDown01",className:"ml-1.5",size:"xxxsmall"})]}),!i&&r.jsx("button",{className:"p-1 animate-hover flex",onClick:d,children:r.jsx(V,{name:"IcMore",size:"middle"})})]})}),l&&r.jsx("div",{className:"text-center mt-2 text-grey3 text-t2",children:"当前暂无标注"}),u.map(g=>{const _=o[g];return _?r.jsx(fn.Fragment,{children:_.map(x=>{if(x.type===_t.NONE||x.type===_t.HIGHLIGHT&&!x.text||s&&x.color!==s)return null;const{uuid:F}=x;return r.jsx(Zle,{uuid:F,pdfViewer:t},F)})},g):null})]})},Zle=({uuid:e,pdfViewer:t})=>{var b;const n=cr(e),{pdfAnnotation:s,localUrl:a}=(b=n==null?void 0:n.data)!=null?b:{},{height:o,width:i,pageNumber:l,color:c,ossName:d,text:u,type:f}=s!=null?s:{},[h,p]=y.useState(a!=null?a:d),g=f&&_T(f),_=y.useRef(null),x=y.useRef(!1);y.useEffect(()=>{a?p(a):h||d&&x.current&&Vs.fetchDownloadUrl({blockId:e,ossName:d}).then(w=>{p(w)})},[a,d,e,h]),y.useEffect(()=>{if(!g||!_.current||a||x.current)return;const w=new IntersectionObserver(async([E])=>{if(E!=null&&E.isIntersecting&&(x.current=!0,w.disconnect(),d)){const C=await Vs.fetchDownloadUrl({blockId:e,ossName:d});p(C)}},{rootMargin:"200px"});return w.observe(_.current),()=>{w.disconnect()}},[g,a,d,e]);const F=w=>{var k;const{pageNumber:E,point:C}=(k=vp(w))!=null?k:{};!C||!E||t.scrollPageIntoView({pageNumber:E,destArray:[null,{name:"XYZ"},C.x,C.y+5,null]})};return s?r.jsxs("div",{ref:_,className:"animate-hover p-2 hover:bg-active_color_10",onClick:()=>F(s),children:[r.jsxs("p",{className:"text-t2-medium",children:["页面",l]}),r.jsx("div",{className:R("my-2 cursor-pointer rounded",g?"pl-1.5":"p-2 pl-3.5"),style:{background:"linear-gradient(to right, ".concat(c," 6px, var(--white1) 6px)")},children:g?((h==null?void 0:h.startsWith("http"))||(h==null?void 0:h.startsWith("data:")))&&r.jsx("img",{src:h,width:i,height:o,className:"max-w-[calc(100%-6px)]"}):r.jsx("p",{className:"text-t2 line-clamp-3 text-ellipsis whitespace-pre-wrap",children:u})})]}):null},ece=({pdfViewer:e})=>{const[t,n]=y.useState([]),[s,a]=y.useState(!0);return y.useEffect(()=>{e.pdfDocument&&e.pdfDocument.getOutline().then(o=>{o&&n(o)}).catch(o=>{console.log(o)})},[e.pdfDocument]),y.useEffect(()=>{xn.on("showOutline",o=>{a(o)})},[]),s?r.jsx("div",{className:"select-none px-2",children:r.jsx(RM,{outlines:t,deep:0,pdfViewer:e})}):null},RM=({outlines:e,deep:t,pdfViewer:n})=>r.jsx("div",{children:e.map(s=>r.jsx(tce,{outline:s,pdfViewer:n,deep:t},s.title))}),tce=({outline:e,pdfViewer:t,deep:n})=>{const[s,a]=y.useState(!1),{title:o,items:i,dest:l}=e,c=()=>{l&&t.linkService.goToDestination(l)},d=i.length>0,u=r.jsx(V,{size:"middle",name:d?"IcNaviFold":"IcNaviDot",className:R(s&&"rotate-90"),onClick:f=>{f.stopPropagation(),a(!s)}});return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex cursor-pointer items-center pl-1 hover:bg-active_color_10 p-2 rounded",style:{paddingLeft:"".concat(n*16,"px")},onClick:c,children:[u,r.jsx("p",{className:"flex-1 text-t2-medium text-ellipsis",children:o})]}),d&&s&&r.jsx(RM,{outlines:i,deep:n+1,pdfViewer:t})]})},nce=({reason:e,onPassword:t,onCancel:n,uuid:s})=>{const a=y.useRef(null),o=We(s),[i,l]=y.useState(!0);return r.jsxs("div",{className:"flex flex-col next-modal px-[30px] w-[400px] pb-[30px]",children:[r.jsx("p",{className:"text-t1-medium mt-[30px] text-center",children:"请输入 PDF 访问密码"}),r.jsx("input",{autoFocus:!0,type:"text",ref:a,className:R("border border-black/5 text-t2 rounded px-3 py-1.5 mt-5 bg-grey8",e===2&&"border-red"),onKeyDown:c=>{Ie("enter")(c)&&t(c.target.value,i)}}),e===2&&r.jsx("span",{className:"text-red text-t4 mt-1",children:"密码输入错误"}),!o&&r.jsxs("button",{className:"flex text-t4 h-8 items-center",onClick:()=>l(!i),children:[r.jsx(V,{size:"large",name:i?"IcCheckboxCheck":"IcCheckbox",className:"mr-1 text-active_color"}),"记住密码"]}),r.jsxs("div",{className:"flex justify-end mt-2",children:[r.jsx(De,{onClick:n,children:"取消"}),r.jsx(De,{colorType:"active",className:"ml-2.5",onClick:()=>{a.current&&t(a.current.value,i)},children:"确定"})]})]})},sce=({pdfId:e,annotation:t,application:n,closeModal:s})=>{const a=Oe(),o=t.type!==_t.HIGHLIGHT,i=[{type:H.OPERATION,data:{icon:"IcColor",title:"高亮颜色",hasArrow:!0,renderSubMenu:()=>r.jsx(rce,{application:n,annotation:t})}},{type:H.LINE},{type:H.OPERATION,isHidden:!o,data:{title:"复制为图片块引用",onClick:()=>{const c='{"annotationId": "'.concat(t.uuid,'", "type": "imageBlock"}');Xt(c)}}},{type:H.OPERATION,data:{title:o?"复制为行内图片引用":"复制为行内引用",onClick:()=>{me.event("copy_pdf_quote",{file_id:e});const c='{"annotationId": "'.concat(t.uuid,'"}');Xt(c)}}},{type:H.OPERATION,data:{title:"复制标注内容",onClick:async()=>{var c,d;if(me.event("copy_highlight_content",{file_id:e}),t.type===_t.HIGHLIGHT)Xt((c=t.text)!=null?c:"");else if((d=t.url)!=null&&d.startsWith("data:")){const u=wT(t.url);if(!u)return;const f=new ClipboardItem({"image/png":u});navigator.clipboard.write([f])}else{if(!t.ossName)return;const u=await Vs.fetchDownloadUrl({blockId:t.uuid,ossName:t.ossName}),h=await(await fetch(u)).blob(),p=new ClipboardItem({"image/png":h});navigator.clipboard.write([p])}be.success("复制成功！"),s==null||s()}}},{type:H.OPERATION,data:{title:"复制访问链接",onClick:async()=>{var d,u;me.event("copy_highlight_link",{file_id:e});const c=vp(t);c&&(Xt("".concat(_n(),"/preview/").concat(e,"?annotationPos=").concat(t.pageNumber,",").concat((d=c.point)==null?void 0:d.x,",").concat((u=c.point)==null?void 0:u.y)),s==null||s())}}},{type:H.LINE},{type:H.OPERATION,data:{title:"清除高亮",onClick:()=>{a(()=>{gr(t.uuid),n.deleteAnnotation(t)}),s==null||s()}}}],l=()=>{};return r.jsx(ze,{className:"next-modal w-[210px] py-[5px]",items:i,onItemClick:l})},rce=({annotation:e,application:t})=>{const n=Oe(),s=_M(),[a,o]=y.useState(e.color),i=Zb.map(c=>({type:H.OPERATION,data:{title:c.name,value:c.value,icon:r.jsx("span",{className:"rounded-full w-[18px] h-[18px]",style:{backgroundColor:c.value}}),arrow:r.jsx(V,{name:"IcCheck02",size:"normal"}),hasArrow:a===c.value}})),l=({data:c})=>{o(c.value),t.updateAnnotation({...e,color:c.value}),n(()=>{s(e.uuid,{color:c.value})})};return r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:i,onItemClick:l})},Ad=({fileName:e,className:t,addonAfter:n})=>{const{name:s,extName:a}=rn(e),[o,i]=Cne(s);return r.jsxs("div",{className:R("flex w-full whitespace-nowrap",t),children:[o?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-ellipsis sm:min-w-[2em]",children:o}),r.jsx("span",{children:i}),r.jsx("span",{children:"".concat(s?".":"").concat(a)})]}):r.jsx("span",{className:"text-ellipsis sm:min-w-[2em]",children:e}),n]})},O0=async e=>{var s;const{results:t,recordMap:n}=await ve.infra.getSpaceGuests(e);st({$guestsList:t}),re(Ha.updateSpaceUsers({users:(s=n.users)!=null?s:{},space:Pn()})),re(Tn.update({blocks:n.blocks}))},Io=(e,t,n=!1)=>{const s=qe(),a=pe().blocks[t.parentId];if(!a)return;const o=Date.now(),i={uuid:s,spaceId:a.spaceId,status:m.BlockStatus.NORMAL,parentId:t.parentId,createdAt:o,updatedAt:o,version:0,...e};return re(ku({collectionView:i,ignoreOp:n})),t.first||t.before?re(im({uuid:s,parentId:t.parentId,before:t.before,ignoreOp:n})):re(Tu({uuid:s,parentId:t.parentId,after:t.after,ignoreOp:n})),s},PM=e=>{const{collectionViews:t}=pe(),n=t[e];n&&(re(Xc({uuid:e,patch:{status:-1}})),re(lm({uuid:e,parentId:n.parentId})))};function gn(e,t=pe().blocks,n=pe().collectionViews){var i,l,c,d,u,f,h,p,g,_,x,F,b;let s;typeof e=="string"?s=n[e]:s=e;let a=t[(i=s==null?void 0:s.parentId)!=null?i:""];if(a&&(a.type===m.BlockType.REFERENCE_COLLECTION||a.type===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(a=t[(c=(l=a.data.ref)==null?void 0:l.uuid)!=null?c:""]),!s||!a)return;const o={view:s,collection:a};switch(s.type){case m.CollectionViewType.BOARD:return{...o,propertiesName:"boardProperties",groupBy:s.format.boardGroupBy,subGroupBy:s.format.collectionGroupBy,groups:s.format.boardGroups,subGroups:s.format.collectionGroups,cardSize:(d=s.format.boardCardSize)!=null?d:m.CardSize.MEDIUM,coverType:s.format.boardCoverType,properties:(u=s.format.boardProperties)!=null?u:[],coverAspectType:s.format.boardCoverAspect};case m.CollectionViewType.GALLERY:return{...o,propertiesName:"galleryProperties",groupBy:s.format.collectionGroupBy,groups:s.format.collectionGroups,cardSize:(f=s.format.galleryCardSize)!=null?f:m.CardSize.MEDIUM,coverType:s.format.galleryCoverType,properties:(h=s.format.galleryProperties)!=null?h:[],coverAspectType:s.format.galleryCoverAspect};case m.CollectionViewType.LIST:return{...o,propertiesName:"listProperties",groupBy:s.format.collectionGroupBy,groups:s.format.collectionGroups,properties:(p=s.format.listProperties)!=null?p:[]};case m.CollectionViewType.TIMELINE:return{...o,propertiesName:"timelineProperties",groupBy:s.format.collectionGroupBy,groups:s.format.collectionGroups,properties:(g=s.format.timelineProperties)!=null?g:[],timelineTableProperties:(_=s.format.timelineTableProperties)!=null?_:[],timelineBy:s.format.timelineBy,timelineByEnd:s.format.timelineByEnd,timelineShowTable:s.format.timelineShowTable!==!1};case m.CollectionViewType.CALENDAR:return{...o,propertiesName:"calendarProperties",properties:(x=s.format.calendarProperties)!=null?x:[],calendarBy:s.format.calendarBy,calendarByEnd:s.format.calendarByEnd};case m.CollectionViewType.FORM:return{...o,propertiesName:"formProperties",properties:(F=s.format.formProperties)!=null?F:[],formLogic:(b=s.format.formLogic)!=null?b:[]};default:{const w=a.data.schema,{tableProperties:E=[]}=s.format,C=new Set(E.map(T=>T.property)),k=[...E];return w&&Object.entries(w).forEach(([T,v])=>{if(C.has(T))return;const I={property:T,visible:!0,width:kp};C.add(T),k.push(I)}),{...o,propertiesName:"tableProperties",groupBy:s.format.collectionGroupBy,groups:s.format.collectionGroups,properties:k}}}}const Rs=(e,t,n)=>{var o;const s=gn(e);if(!s)return;const{view:a}=s;n||_e(a.parentId,{}),ace(e,n,(o=t.format)==null?void 0:o.filter),re(Xc({uuid:e,patch:{...t,updatedAt:Date.now()},ignoreOp:n}))},vT=new mO(Fs,"filters",100),ace=(e,t,n)=>{n&&(t?vT.put(e,n):vT.delete(e))},DN=e=>vT.get(e)||void 0,ic=(e,t)=>{hn(()=>{Rs(e,t)})},Rt=(e,t,n=!1)=>{hn(()=>{Rs(e,{format:t},n)})},LM=()=>{const e=Dt();y.useEffect(()=>{(async()=>{const s=xt.$subscriptionData[e.uuid];if(s){const{users:a}=s,o=a.filter(({userId:i})=>!J.users[i]).map(({userId:i})=>({id:i,table:"user"}));if(o.length){const{users:i}=await ve.editor.queryRecords({requests:o});i&&re(Ha.updateSpaceUsers({users:i}))}}})()},[e.uuid])},oce=()=>{const e=Dt();return qne(e.uuid)},M0=()=>{const e=oce();return Ce(({users:t})=>e.map(({userId:n})=>t[n]).filter(Boolean),[e])},lE=()=>Ce(e=>e.users,[],{allUser:!0}),AN=[{groupCn:"常量",groupEn:"Constants",list:[{description:"自然常数，自然对数的底数",descriptionEn:"Natural constant e, the base of natural logarithms",examples:"e == 2.718281828459045",examplesEn:"e == 2.718281828459045",resultType:"number",syntax:"e",title:"e"},{description:"圆周率",descriptionEn:"Pi",examples:"pi == 3.141592653589793",examplesEn:"pi == 3.141592653589793",resultType:"number",syntax:"pi",title:"pi"},{description:"真（true）",descriptionEn:"True",examples:'(true ? "是" : "否") == "是"',examplesEn:'(true ? "Yes" : "No") == "Yes"',resultType:"boolean",syntax:"true",title:"true"},{description:"假（false）",descriptionEn:"False",examples:'(false ? "是" : "否") == "否"',examplesEn:'(false ? "Yes" : "No") == "No"',resultType:"boolean",syntax:"false",title:"false"}]},{groupCn:"运算",groupEn:"Operators",list:[{description:"根据条件判断，在两个选项中返回值",descriptionEn:"Returns one of two values based on a condition",examples:'(true ? 1 : -1) == 1\nif(false, "是", "否") == "否"',examplesEn:'(true ? 1 : -1) == 1\nif(false, "Yes", "No") == "No"',resultType:"string",syntax:"boolean ? value_if_true : value_if_false\nif(boolean, value_if_true, value_if_false)",title:"if"},{description:"将两个数字相加返回和",descriptionEn:"Adds two numbers and returns the sum",examples:"1 + 1 == 2\nadd(2, 2) == 4",examplesEn:"1 + 1 == 2\nadd(2, 2) == 4",resultType:"number",syntax:"number + number\nadd(number, number)",title:"add"},{description:"将两个数字相减返回差",descriptionEn:"Subtracts two numbers and returns the difference",examples:"100 - 99 == 1\nsubtract(1, 2) == -1",examplesEn:"100 - 99 == 1\nsubtract(1, 2) == -1",resultType:"number",syntax:"number - number\nsubtract(number, number)",title:"subtract"},{description:"将两个数字相乘返回乘积",descriptionEn:"Multiplies two numbers and returns the product",examples:"9 * 9 == 81\nmultiply(5, 100) == 500",examplesEn:"9 * 9 == 81\nmultiply(5, 100) == 500",resultType:"number",syntax:"number * number\nmultiply(number, number)",title:"multiply"},{description:"将两个数字相除返回商",descriptionEn:"Divides two numbers and returns the quotient",examples:"12 / 4 == 3\ndivide(12, 3) == 4",examplesEn:"12 / 4 == 3\ndivide(12, 3) == 4",resultType:"number",syntax:"number / number\ndivide(number, number)",title:"divide"},{description:"将底数根据指数进行乘方，返回乘幂",descriptionEn:"Raises a base to an exponent power and returns the result",examples:"5 ^ 3 == 125\npow(2, 6) == 64",examplesEn:"5 ^ 3 == 125\npow(2, 6) == 64",resultType:"number",syntax:"number ^ number\npow(number, number)",title:"pow"},{description:"将两个数字相除返回余数",descriptionEn:"Divides two numbers and returns the remainder",examples:"7 % 5 == 2\nmod(3, 3) == 0",examplesEn:"7 % 5 == 2\nmod(3, 3) == 0",resultType:"number",syntax:"number % number\nmod(number, number)",title:"mod"},{description:"返回数字负数",descriptionEn:"Returns the negation of a number",examples:"-1 + 2 == 1\nunaryMinus(42) == -42",examplesEn:"-1 + 2 == 1\nunaryMinus(42) == -42",resultType:"number",syntax:"- number\nunaryMinus(number)",title:"unaryMinus"},{description:"返回数字本身",descriptionEn:"Returns the number itself",examples:"+ 42 == 42",examplesEn:"+ 42 == 42",resultType:"number",syntax:"+ value\nunaryPlus(value)",title:"unaryPlus"},{description:"将条件参数进行逻辑“非”运算，取反",descriptionEn:"Logical NOT, inverts a condition",examples:"(not true) == false\nnot(false) == true",examplesEn:"(not true) == false\nnot(false) == true",resultType:"boolean",syntax:"not boolean\nnot (boolean)",title:"not"},{description:"将两个参数进行逻辑”与”运算，若均为真（true），则返回真（true）；否则反之",descriptionEn:"Logical AND, returns true if both operands are true, else false",examples:"(true and false) == false\nand(true, true) == true",examplesEn:"(true and false) == false\nand(true, true) == true",resultType:"boolean",syntax:"boolean and boolean\nand(boolean, boolean)",title:"and"},{description:"将两个参数进行逻辑“或”运算，若均为假（false），则返回假（false）；否则反之",descriptionEn:"Logical OR, returns true if either operand is true, else false",examples:"(false or true) == true\nor(false, false) == false",examplesEn:"(false or true) == true\nor(false, false) == false",resultType:"boolean",syntax:"boolean or boolean\nor(boolean, boolean)",title:"or"},{description:"判断两个参数是否相等，若相等，则返回真（true）；否则反之",descriptionEn:"Checks if two values are equal, returns true if equal, else false",examples:"(1 == 1) == true\nequal(1, 0) == false",examplesEn:"(1 == 1) == true\nequal(1, 0) == false",resultType:"boolean",syntax:"value == value\nequal(value, value)",title:"equal"},{description:"判断两个参数是否不相等，若不相等，则返回（true）；否则反之",descriptionEn:"Checks if two values are not equal, returns true if not equal, else false",examples:"(6 * 9 != 42) == true\nunequal(true, not false) == false",examplesEn:"(6 * 9 != 42) == true\nunequal(true, not false) == false",resultType:"boolean",syntax:"value != value\nunequal(value, value)",title:"unequal"},{description:"比较两个参数大小，如果首个参数大于第二个参数，则返回真（true）；否则反之",descriptionEn:"Checks if first value is greater than second, returns true if so, else false",examples:"(5 > 3) == true",examplesEn:"(5 > 3) == true",resultType:"boolean",syntax:"text > text\nboolean > boolean\ndate > date\nnumber > number\nlarger(text, text)\nlarger(boolean, boolean)\nlarger(date, date)\nlarger(number, number)",title:"larger"},{description:"比较两个参数大小，如果首个参数大于等于第二个参数，则返回真（true）；否则反之",descriptionEn:"Checks if first value is greater than or equal to second, returns true if so, else false",examples:"(5 >= 3) == true\n(4 >= 4) == true",examplesEn:"(5 >= 3) == true\n(4 >= 4) == true",resultType:"boolean",syntax:"text >= text\nboolean >= boolean\ndate >= date\nnumber >= number\nlargerEq(text, text)\nlargerEq(boolean, boolean)\nlargerEq(date, date)\nlargerEq(number, number)",title:"largerEq"},{description:"比较两个参数大小，如果首个参数小于第二个参数，则返回真（true）；否则反之",descriptionEn:"Checks if first value is less than second, returns true if so, else false",examples:"(10 < 8) == false",examplesEn:"(10 < 8) == false",resultType:"boolean",syntax:"text < text\nboolean < boolean\ndate < date\nnumber < number\nsmaller(text, text)\nsmaller(boolean, boolean)\nsmaller(date, date)\nsmaller(number, number)",title:"smaller"},{description:"比较两个参数大小，如果首个参数小于等于第二个参数，则返回真（true）；否则反之",descriptionEn:"Checks if first value is less than or equal to second, returns true if so, else false",examples:"(10 <= 8) == false\n(8 <= 8) == true",examplesEn:"(10 <= 8) == false\n(8 <= 8) == true",resultType:"boolean",syntax:"text <= text\nboolean <= boolean\ndate <= date\nnumber <= number\nsmallerEq(text, text)\nsmallerEq(boolean, boolean)\nsmallerEq(date, date)\nsmallerEq(number, number)",title:"smallerEq"}]},{groupCn:"函数",groupEn:"Functions",list:[{description:"将多个字符串相连返回结果",descriptionEn:"Concatenates strings and returns the result",examples:'"Flow" + "Us" == "FlowUs"\nconcat("Flow", "Us") == "FlowUs"',examplesEn:'"Build" + "IN" == "BuildIn"\nconcat("Build", "In") == "BuildIn"',resultType:"string",syntax:"concat(text...)",title:"concat"},{description:"将首个字符串插入到其它字符串之间相连，返回结果",descriptionEn:"Inserts strings into the first string and returns the result ",examples:'join("!", "大", "家", "好") == "大!家!好"',examplesEn:'join("!", "H", "E", "L","L","O") == "H!E!L!L!O"',resultType:"string",syntax:"join(text...)",title:"join"},{description:"将字符串进行切割，通过指定的开始/结束索引提取并返回子字符串",descriptionEn:"Extracts a substring from a string based on start/end indexes and returns it",examples:'slice("FlowUs", 4, 5) == "Us"\nslice("FlowUs", 2) == "owUs"',examplesEn:'slice("BuildIn", 5, 6) == "In"\nslice("BuildIn", 2) == "ildIn"',resultType:"string",syntax:"slice(text, number)\nslice(text, number, number)",title:"slice"},{description:"返回字符串长度",descriptionEn:"Returns the length of a string",examples:'length("FlowUs") == 6',examplesEn:'length("BuildIn") == 7',resultType:"number",syntax:"length(text)",title:"length"},{description:"将参数转换为字符串",descriptionEn:"Converts a value to a string",examples:'format(true) == "true"\nformat(111) === "111"\nformat(now()) == "2022-04-19 12:56:45"',examplesEn:'format(true) == "true"\nformat(111) === "111"\nformat(now()) == "2022-04-19 12:56:45"',resultType:"string",syntax:"format(value)",title:"format"},{description:"将参数转换为数字",descriptionEn:"Converts a value to a number",examples:'toNumber(true) == 1\ntoNumber("111") == 111',examplesEn:'toNumber(true) == 1\ntoNumber("111") == 111',resultType:"number",syntax:"toNumber(value)",title:"toNumber"},{description:"判断字符串是否包含另一个字符串，如果第一个参数包含第二个参数，则返回真（true）；否则反之",descriptionEn:"Checks if a string contains another string, returns true if so, else false",examples:'contains("FlowUs", "Us") == true',examplesEn:'contains("FlowUs", "Us") == true',resultType:"boolean",syntax:"contains(text, text)",title:"contains"},{description:"将参数中首位匹配正则表达式的内容替换为其它内容，返回结果",descriptionEn:"Replaces first match of regex in string with new text, returns result",examples:'replace("a-b-c", "-", "&") == "a&b-c"',examplesEn:'replace("a-b-c", "-", "&") == "a&b-c"',resultType:"string",syntax:"replace(value, text, text)\n",title:"replace"},{description:"将参数中全部匹配正则表达式的内容替换为其它内容，返回结果",descriptionEn:"Replaces all regex matches in string with new text, returns result",examples:'replaceAll("a-b-c", "-", "&") == "a&b&c"',examplesEn:'replaceAll("a-b-c", "-", "&") == "a&b&c"',resultType:"string",syntax:"replaceAll(value, text, text)",title:"replaceAll"},{description:"判断字符串是否匹配正则表达式，若是则返回真（true），否则反之",descriptionEn:"Checks if string matches regex, returns true if so, else false",examples:'test("a-b-c","-") == true',examplesEn:'test("a-b-c","-") == true',resultType:"boolean",syntax:"test(value, text)",title:"test"},{description:"判断值是否为空，若是则返回真（true）",descriptionEn:"Checks if value is empty/null/undefined, returns true if so",examples:'empty(prop("姓名")) == true',examplesEn:'empty(prop("Name")) == true',resultType:"boolean",syntax:"empty(value)",title:"empty"},{description:"返回数字绝对值",descriptionEn:"Returns the absolute value of a number",examples:"abs(-1) == 1",examplesEn:"abs(-1) == 1",resultType:"number",syntax:"abs(number)",title:"abs"},{description:"返回数字的立方根",descriptionEn:"Returns the cube root of a number",examples:"cbrt(27) == 3",examplesEn:"cbrt(27) == 3",resultType:"number",syntax:"cbrt(number)",title:"cbrt"},{description:"将数字向上取整返回结果",descriptionEn:"Rounds a number up to the nearest integer and returns the result",examples:"ceil(18.1) == 19",examplesEn:"ceil(18.1) == 19",resultType:"number",syntax:"ceil(number)",title:"ceil"},{description:"将自然常数 e 根据指数进行乘方，返回乘幂",descriptionEn:"Raises Euler's number e to the power of exponent and returns the result",examples:"exp(1) == 2.718281828459045",examplesEn:"exp(1) == 2.718281828459045",resultType:"number",syntax:"exp(number)",title:"exp"},{description:"将数字向下取整返回结果",descriptionEn:"Rounds a number down to the nearest integer and returns the result",examples:"floor(3.9) == 3",examplesEn:"floor(3.9) == 3",resultType:"number",syntax:"floor(number)",title:"floor"},{description:"返回数字的自然对数",descriptionEn:"Returns the natural logarithm of a number",examples:"ln(e) == 1",examplesEn:"ln(e) == 1",resultType:"number",syntax:"ln(number)",title:"ln"},{description:"返回数字以10为底数的对数",descriptionEn:"Returns the base 10 logarithm of a number",examples:"log10(10000) == 4",examplesEn:"log10(10000) == 4",resultType:"number",syntax:"log10(number)",title:"log10"},{description:"返回数字以2为底数的对数",descriptionEn:"Returns the base 2 logarithm of a number",examples:"log2(8) == 3",examplesEn:"log2(8) == 3",resultType:"number",syntax:"log2(number)",title:"log2"},{description:"将多个数字比较，返回最大值",descriptionEn:"Compares numbers and returns the maximum",examples:"max(9, 2, 100, 89) == 100",examplesEn:"max(9, 2, 100, 89) == 100",resultType:"number",syntax:"max(number...)",title:"max"},{description:"将多个数字比较，返回最小值",descriptionEn:"Compares numbers and returns the minimum",examples:"min(9, 2, 100, 89) == 2",examplesEn:"min(9, 2, 100, 89) == 2",resultType:"number",syntax:"min(number...)",title:"min"},{description:"将数字四舍五入取整返回结果",descriptionEn:"Rounds a number to the nearest integer and returns the result",examples:"round(0.4) == 0\nround(0.5) == 1",examplesEn:"round(0.4) == 0\nround(0.5) == 1",resultType:"number",syntax:"round(number)",title:"round"},{description:"判断数字的符号位，返回正数（1），负数（-1）或 0",descriptionEn:"Returns the sign of a number, 1 for positive, -1 for negative, 0 for zero",examples:"sign(100) == 1\nsign(-2) == -1\nsign(0) == 0",examplesEn:"sign(100) == 1\nsign(-2) == -1\nsign(0) == 0",resultType:"number",syntax:"sign(number)",title:"sign"},{description:"返回数字的平方根",descriptionEn:"Returns the square root of a number",examples:"sprt(81) == 9 ",examplesEn:"sprt(81) == 9 ",resultType:"number",syntax:"sprt(number)",title:"sqrt"},{description:"返回当时前日期和时间",descriptionEn:"Returns the current date and time",examples:"now() == 2022/01/01 00:00",examplesEn:"now() == 2022/01/01 00:00",resultType:"date",syntax:"now()",title:"now"},{description:"返回指定日期时间值的时间戳，即从 1970 年 1 月 1 日开始计的 UNIX 毫秒数",descriptionEn:"Converts a datetime to unix timestamp in milliseconds",examples:"timestamp(now()) == 1650467710637",examplesEn:"timestamp(now()) == 1650467710637",resultType:"number",syntax:"timestamp(date)",title:"timestamp"},{description:"返回指定时间戳对应的日期时间",descriptionEn:"Converts a unix timestamp in milliseconds to a datetime",examples:'format(fromTimestamp(1614127553)) == "2022-04-20 23:15:10"',examplesEn:'format(fromTimestamp(1614127553)) == "2022-04-20 23:15:10"',resultType:"date",syntax:"fromTimestamp(number)",title:"fromTimestamp"},{description:"在日期时间中增加时间间隔。最后的参数为“单位”，可选值为“years”（年），“quarters”(季度)，“months”（月），“weeks”（周），“days”（日），“hours”（小时），“minutes”（分钟），“seconds”（秒），“milliseconds”（毫秒）。",descriptionEn:"Adds an interval to a datetime. Last param is 'unit' - 'years', 'quarters', 'months', 'weeks', 'days', 'hours', 'minutes', 'seconds', 'milliseconds'.",examples:'dateAdd(prop("开始时间"),  50, "hours")',examplesEn:'dateAdd(prop("StartTime"),  50, "hours")',resultType:"date",syntax:"dateAdd(date, number, text)",title:"dateAdd"},{description:"在日期时间中减去时间间隔。最后的参数为“单位”，可选值为“years”（年），“quarters”(季度)，“months”（月），“weeks”（周），“days”（日），“hours”（小时），“minutes”（分钟），“seconds”（秒），“milliseconds”（毫秒）。",descriptionEn:"Subtracts an interval from a datetime. Last param is 'unit' - 'years', 'quarters', 'months', 'weeks', 'days', 'hours', 'minutes', 'seconds', 'milliseconds'.",examples:'dateSubtract(prop("开始时间"),  2, "months")',examplesEn:'dateSubtract(prop("StartTime"),  2, "months")',resultType:"date",syntax:"dateSubtract(date, number, text)",title:"dateSubtract"},{description:"对两个日期时间进行运算，返回时间间隔。最后的参数为“单位”，可选值为“years”（年），“quarters”(季度)，“months”（月），“weeks”（周），“days”（日），“hours”（小时），“minutes”（分钟），“seconds”（秒），“milliseconds”（毫秒）。",descriptionEn:"Calculates interval between two datetimes. Last param is 'unit' - 'years', 'quarters', 'months', 'weeks', 'days', 'hours', 'minutes', 'seconds', 'milliseconds'.",examples:'dateBetween(prop("开始时间"),  prop("结束时间"), "months") == 2',examplesEn:'dateBetween(prop("StartTime"),  prop("EndTime"), "months") == 2',resultType:"number",syntax:"dateBetween(date, date, text)",title:"dateBetween"},{description:"对日期时间进行格式化，返回对应格式的字符串",descriptionEn:"Formats a datetime string based on the format pattern",examples:'formatDate(now(), "MMMM D YYYY, HH:mm") == "二月 24 2021, 08:45"\nformatDate(now(), "YYYY/MM/DD, HH:mm") == "2021/02/24, 08:45"\nformatDate(now(), "MM/DD/YYYY, HH:mm") == "02/24/2021, 08:45"\nformatDate(now(), "HH:mm A") == "08:45 AM"\nformatDate(now(), "M/D/YY") == "2/24/21"',examplesEn:'formatDate(now(), "MMMM D YYYY, HH:mm") == "February 24 2021, 08:45"\nformatDate(now(), "YYYY/MM/DD, HH:mm") == "2021/02/24, 08:45"\nformatDate(now(), "MM/DD/YYYY, HH:mm") == "02/24/2021, 08:45"\nformatDate(now(), "HH:mm A") == "08:45 AM"\nformatDate(now(), "M/D/YY") == "2/24/21"',resultType:"string",syntax:"formatDate(date, text)",title:"formatDate"},{description:"返回日期时间中的 0 - 59 整数分钟数",descriptionEn:"Returns the minute (0-59) from a datetime",examples:"minute(now()) == 45",examplesEn:"minute(now()) == 45",resultType:"number",syntax:"minute(date)",title:"minute"},{description:"返回日期时间中的 0 - 23 整数小时数",descriptionEn:"Returns the hour (0-23) from a datetime",examples:"hour(now()) == 8",examplesEn:"hour(now()) == 8",resultType:"number",syntax:"hour(date)",title:"hour"},{description:"返回日期时间为星期中的第几天，0 - 6 整数，0 表示星期日，以此类推",descriptionEn:"Returns the weekday number (0-6) from a datetime, 0 for Sunday",examples:"day(now()) == 2",examplesEn:"day(now()) == 2",resultType:"number",syntax:"day(date)",title:"day"},{description:"返回日期时间为月中的第几天",descriptionEn:"Returns the day of month from a datetime",examples:"date(now()) == 24",examplesEn:"date(now()) == 24",resultType:"number",syntax:"date(date)",title:"date"},{description:"返回日期时间中的月份",descriptionEn:"Returns the month (1-12) from a datetime",examples:"month(now()) == 2",examplesEn:"month(now()) == 2",resultType:"number",syntax:"month(date)",title:"month"},{description:"返回日期时间中的年份",descriptionEn:"Returns the 4-digit year from a datetime",examples:"year(now()) == 2021",examplesEn:"year(now()) == 2021",resultType:"number",syntax:"year(date)",title:"year"},{description:"返回记录的唯一 id",descriptionEn:"Returns the unique ID of the record",examples:'id() == "e68380be-23cf-42c4-9b95-23a52713213d"',examplesEn:'id() == "e68380be-23cf-42c4-9b95-23a52713213d"',resultType:"string",syntax:"id()",title:"id"}]}],IT={};(function(e,t){e.formula=e.formula||{};var n=function(){return S.__string_rec(this,"")},s=s||{},a;function o(N,B){var X=Object.create(N);for(var Z in B)X[Z]=B[Z];return B.toString!==Object.prototype.toString&&(X.toString=B.toString),X}var i=function(){};i.__name__=!0,i.__format_get=function(N,B){switch(B){case"%":return"%";case"A":return i.DAY_NAMES[N.getDay()];case"B":return i.MONTH_NAMES[N.getMonth()];case"C":return f.lpad(u.string(N.getFullYear()/100|0),"0",2);case"D":return i.__format(N,"%m/%d/%y");case"F":return i.__format(N,"%Y-%m-%d");case"M":return f.lpad(u.string(N.getMinutes()),"0",2);case"R":return i.__format(N,"%H:%M");case"S":return f.lpad(u.string(N.getSeconds()),"0",2);case"T":return i.__format(N,"%H:%M:%S");case"Y":return u.string(N.getFullYear());case"a":return i.DAY_SHORT_NAMES[N.getDay()];case"d":return f.lpad(u.string(N.getDate()),"0",2);case"e":return u.string(N.getDate());case"b":case"h":return i.MONTH_SHORT_NAMES[N.getMonth()];case"H":case"k":return f.lpad(u.string(N.getHours()),B=="H"?"0":" ",2);case"I":case"l":var X=N.getHours()%12;return f.lpad(u.string(X==0?12:X),B=="I"?"0":" ",2);case"m":return f.lpad(u.string(N.getMonth()+1),"0",2);case"n":return"\n";case"p":return N.getHours()>11?"PM":"AM";case"r":return i.__format(N,"%I:%M:%S %p");case"s":return u.string(N.getTime()/1e3|0);case"t":return"	";case"u":var Z=N.getDay();return Z==0?"7":Z==null?"null":""+Z;case"w":return u.string(N.getDay());case"y":return f.lpad(u.string(N.getFullYear()%100),"0",2);default:throw new A("Date.format %"+B+"- not implemented yet.",null,{fileName:"DateTools.hx",lineNumber:101,className:"DateTools",methodName:"__format_get"})}},i.__format=function(N,B){for(var X="",Z=0;;){var oe=B.indexOf("%",Z);if(oe<0)break;var xe=oe-Z;X+=xe==null?c.substr(B,Z,null):c.substr(B,Z,xe),X+=u.string(i.__format_get(N,c.substr(B,oe+1,1))),Z=oe+2}var xe=B.length-Z;return X+=xe==null?c.substr(B,Z,null):c.substr(B,Z,xe),X},i.format=function(N,B){return i.__format(N,B)};var l=function(N,B){this.r=new RegExp(N,B.split("u").join(""))};l.__name__=!0,l.prototype={match:function(N){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(N),this.r.s=N,this.r.m!=null},matched:function(N){if(this.r.m!=null&&N>=0&&N<this.r.m.length)return this.r.m[N];throw I.thrown("EReg::matched")},matchedPos:function(){if(this.r.m==null)throw I.thrown("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(N,B,X){if(X==null&&(X=-1),this.r.global){this.r.lastIndex=B,this.r.m=this.r.exec(X<0?N:c.substr(N,0,B+X));var Z=this.r.m!=null;return Z&&(this.r.s=N),Z}else{var Z=this.match(X<0?c.substr(N,B,null):c.substr(N,B,X));return Z&&(this.r.s=N,this.r.m.index+=B),Z}},map:function(N,B){var X=0,Z="";do{if(X>=N.length)break;if(!this.matchSub(N,X)){Z+=u.string(c.substr(N,X,null));break}var oe=this.matchedPos();Z+=u.string(c.substr(N,X,oe.pos-X)),Z+=u.string(B(this)),oe.len==0?(Z+=u.string(c.substr(N,oe.pos,1)),X=oe.pos+1):X=oe.pos+oe.len}while(this.r.global);return!this.r.global&&X>0&&X<N.length&&(Z+=u.string(c.substr(N,X,null))),Z}};var c=function(){};c.__name__=!0,c.dateStr=function(N){var B=N.getMonth()+1,X=N.getDate(),Z=N.getHours(),oe=N.getMinutes(),xe=N.getSeconds();return N.getFullYear()+"-"+(B<10?"0"+B:""+B)+"-"+(X<10?"0"+X:""+X)+" "+(Z<10?"0"+Z:""+Z)+":"+(oe<10?"0"+oe:""+oe)+":"+(xe<10?"0"+xe:""+xe)},c.cca=function(N,B){var X=N.charCodeAt(B);if(X==X)return X},c.substr=function(N,B,X){if(X==null)X=N.length;else if(X<0)if(B==0)X=N.length+X;else return"";return N.substr(B,X)},c.now=function(){return Date.now()};var d=function(){};d.__name__=!0,d.fold=function(N,B,X){for(var Z=sn(N);Z.hasNext();)X=B(Z.next(),X);return X},Math.__name__=!0;var u=function(){};u.__name__=!0,u.string=function(N){return S.__string_rec(N,"")},u.parseInt=function(N){var B=parseInt(N);return isNaN(B)?null:B};var f=function(){};f.__name__=!0,f.isSpace=function(N,B){var X=c.cca(N,B);return X>8&&X<14?!0:X==32},f.ltrim=function(N){for(var B=N.length,X=0;X<B&&f.isSpace(N,X);)++X;return X>0?c.substr(N,X,B-X):N},f.rtrim=function(N){for(var B=N.length,X=0;X<B&&f.isSpace(N,B-X-1);)++X;return X>0?c.substr(N,0,B-X):N},f.trim=function(N){return f.ltrim(f.rtrim(N))},f.lpad=function(N,B,X){if(B.length<=0)return N;var Z="";for(X-=N.length;Z.length<X;)Z+=B==null?"null":""+B;return Z+=N==null?"null":""+N,Z};var h=s["datetime.DTPeriod"]={__ename__:!0,__constructs__:null,Year:(a=function(N){return{_hx_index:0,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Year",a.__params__=["n"],a),Month:(a=function(N){return{_hx_index:1,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Month",a.__params__=["n"],a),Day:(a=function(N){return{_hx_index:2,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Day",a.__params__=["n"],a),Hour:(a=function(N){return{_hx_index:3,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Hour",a.__params__=["n"],a),Minute:(a=function(N){return{_hx_index:4,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Minute",a.__params__=["n"],a),Second:(a=function(N){return{_hx_index:5,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Second",a.__params__=["n"],a),Week:(a=function(N){return{_hx_index:6,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Week",a.__params__=["n"],a)};h.__constructs__=[h.Year,h.Month,h.Day,h.Hour,h.Minute,h.Second,h.Week];var p=s["datetime.DTSnap"]={__ename__:!0,__constructs__:null,Year:(a=function(N){return{_hx_index:0,direction:N,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Year",a.__params__=["direction"],a),Month:(a=function(N){return{_hx_index:1,direction:N,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Month",a.__params__=["direction"],a),Day:(a=function(N){return{_hx_index:2,direction:N,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Day",a.__params__=["direction"],a),Hour:(a=function(N){return{_hx_index:3,direction:N,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Hour",a.__params__=["direction"],a),Minute:(a=function(N){return{_hx_index:4,direction:N,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Minute",a.__params__=["direction"],a),Second:(a=function(N){return{_hx_index:5,direction:N,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Second",a.__params__=["direction"],a),Week:(a=function(N,B){return{_hx_index:6,direction:N,day:B,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Week",a.__params__=["direction","day"],a)};p.__constructs__=[p.Year,p.Month,p.Day,p.Hour,p.Minute,p.Second,p.Week];var g={};g.now=function(){return Math.floor(new Date().getTime()/1e3)+62135596800},g.local=function(){return Math.floor(new Date().getTime()/1e3)+62135596800-62135596800+g.getLocalOffset()+62135596800},g.make=function(N,B,X,Z,oe,xe){return xe==null&&(xe=0),oe==null&&(oe=0),Z==null&&(Z=0),X==null&&(X=1),B==null&&(B=1),N==null&&(N=1970),E.yearToStamp(N)+b.toSeconds(B,N%4==0&&(N%100==0?N%400==0:!0))+(X-1)*86400+Z*3600+oe*60+xe-62135596800+62135596800},g.fromTime=function(N){return N+62135596800},g.fromString=function(N){return E.fromString(N)},g.fromDate=function(N){return Math.floor(N.getTime()/1e3)+62135596800},g.daysInMonth=function(N,B){return B==null&&(B=!1),b.days(N,B)},g.weeksInYear=function(N){var B=E.yearToStamp(N)-62135596800+62135596800,X=g.getWeekDay(B);return X==4||X==3&&g.isLeapYear(B)?53:52},g.isLeap=function(N){return N%4==0?N%100==0?N%400==0:!0:!1},g.getLocalOffset=function(){var N=new Date,B=N.getFullYear(),X=N.getMonth()+1,Z=N.getDate(),oe=N.getHours(),xe=N.getMinutes(),Be=N.getSeconds();return Be==null&&(Be=0),xe==null&&(xe=0),oe==null&&(oe=0),Z==null&&(Z=1),X==null&&(X=1),B==null&&(B=1970),E.yearToStamp(B)+b.toSeconds(X,B%4==0&&(B%100==0?B%400==0:!0))+(Z-1)*86400+oe*3600+xe*60+Be-62135596800+62135596800-62135596800-(N.getTime()/1e3|0)|0},g._new=function(N){return N+62135596800},g.utc=function(N){return N-62135596800-g.getLocalOffset()+62135596800},g.getYear=function(N){var B=(N/12622780800|0)*12622780800,X=((N-B)/3155673600|0)*3155673600;X>9467020800&&(X-=3155673600);var Z=((N-B-X)/126230400|0)*126230400,oe=(N-B-X-Z)/31536e3|0;return(B/12622780800|0)*400+(X/3155673600|0)*100+(Z/126230400|0)*4+(oe==4?oe:oe+1)},g.yearStart=function(N){var B=(N/12622780800|0)*12622780800,X=((N-B)/3155673600|0)*3155673600;X>9467020800&&(X-=3155673600);var Z=((N-B-X)/126230400|0)*126230400,oe=(N-B-X-Z)/31536e3|0;return oe==4&&--oe,B+X+Z+oe*31536e3-62135596800},g.monthStart=function(N,B){return B==null&&(B=0),B==0&&(B=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))),g.yearStart(N)+b.toSeconds(B,g.isLeapYear(N))},g.getMonthStart=function(N,B){return g.monthStart(N,B)+62135596800},g.isLeapYear=function(N){var B=g.getYear(N);return B%4==0?B%100==0?B%400==0:!0:!1},g.getMonth=function(N){return b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))},g.getDay=function(N){return b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))},g.daysInThisMonth=function(N){var B=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N));return b.days(B,B==2&&g.isLeapYear(N))},g.getYearDay=function(N){return((N-62135596800-g.yearStart(N))/86400|0)+1},g.weeksInThisYear=function(N){return g.weeksInYear(g.getYear(N))},g.getWeekDay=function(N,B){B==null&&(B=!1);var X=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),Z=(14-X)/12|0,oe=g.getYear(N)-Z,xe=(7e3+(b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+oe+(oe/4|0)-(oe/100|0)+(oe/400|0)+(31*(X+12*Z-2)/12|0)))%7;return B&&xe==0?7:xe},g.getWeekDayNum=function(N,B,X){return X==null&&(X=1),E.getWeekDayNum(N-62135596800+62135596800,B,X)+62135596800},g.getWeek=function(N){var B=(((N-62135596800-g.yearStart(N))/86400|0)+1-g.getWeekDay(N,!0)+10)/7|0,X=g.getYear(N);return B<1?g.weeksInYear(X-1):B>52&&B>g.weeksInYear(X)?1:B},g.getHour=function(N){return(N-Math.floor(N/86400)*86400)/3600|0},g.getHour12=function(N){var B=(N-Math.floor(N/86400)*86400)/3600|0;return B==0?12:B>12?B-12:B},g.getMinute=function(N){return(N-Math.floor(N/3600)*3600)/60|0},g.getSecond=function(N){return N-Math.floor(N/60)*60|0},g.add=function(N,B){var X;switch(B._hx_index){case 0:X=E.addYear(N-62135596800+62135596800,B.n);break;case 1:X=E.addMonth(N-62135596800+62135596800,B.n);break;case 2:X=N-62135596800+B.n*86400;break;case 3:X=N-62135596800+B.n*3600;break;case 4:X=N-62135596800+B.n*60;break;case 5:X=N-62135596800+B.n;break;case 6:X=N-62135596800+B.n*7*86400;break}return X+62135596800},g.sub=function(N,B){var X;switch(B._hx_index){case 0:X=E.addYear(N-62135596800+62135596800,-B.n);break;case 1:X=E.addMonth(N-62135596800+62135596800,-B.n);break;case 2:X=N-62135596800-B.n*86400;break;case 3:X=N-62135596800-B.n*3600;break;case 4:X=N-62135596800-B.n*60;break;case 5:X=N-62135596800-B.n;break;case 6:X=N-62135596800-B.n*7*86400;break}return X+62135596800},g.snap=function(N,B){var X;switch(B._hx_index){case 0:X=w.snapYear(N-62135596800+62135596800,B.direction);break;case 1:X=w.snapMonth(N-62135596800+62135596800,B.direction);break;case 2:X=w.snapDay(N-62135596800+62135596800,B.direction);break;case 3:X=w.snapHour(N-62135596800+62135596800,B.direction);break;case 4:X=w.snapMinute(N-62135596800+62135596800,B.direction);break;case 5:X=B.direction==1?N-62135596800+1:N-62135596800;break;case 6:X=w.snapWeek(N-62135596800+62135596800,B.direction,B.day);break}return X+62135596800},g.toString=function(N){var B=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),X=b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),Z=(N-Math.floor(N/86400)*86400)/3600|0,oe=(N-Math.floor(N/3600)*3600)/60|0,xe=N-Math.floor(N/60)*60|0;return""+g.getYear(N)+"-"+(B<10?"0"+B:""+B)+"-"+(X<10?"0"+X:""+X)+" "+(Z<10?"0"+Z:""+Z)+":"+(oe<10?"0"+oe:""+oe)+":"+(xe<10?"0"+xe:""+xe)},g.format=function(N,B){return E.strftime(N-62135596800+62135596800,B)},g.getTime=function(N){return N-62135596800},g.getDate=function(N){return new Date((N-62135596800)*1e3)},g.gt=function(N,B){return N-62135596800>B-62135596800},g.gte=function(N,B){return N-62135596800>=B-62135596800},g.lt=function(N,B){return N-62135596800<B-62135596800},g.lte=function(N,B){return N-62135596800<=B-62135596800},g.eq=function(N,B){return N-62135596800==B-62135596800},g.neq=function(N,B){return N-62135596800!=B-62135596800},g.mathPlus1=function(N,B){return g.add(N,B)},g.mathPlus2=function(N,B){return g.add(N,B)},g.mathPlus3=function(N,B){return N=g.add(N,B)-62135596800+62135596800,N+62135596800},g.mathMinus1=function(N,B){return g.sub(N,B)},g.mathMinus2=function(N,B){return N=g.sub(N,B)-62135596800+62135596800,N+62135596800},g.dtiCreate=function(N,B){return _.create(B,N-62135596800+62135596800)},g.dtiMinus=function(N,B){return _.subFrom(B,N-62135596800+62135596800)},g.dtiPlus1=function(N,B){return _.addTo(B,N-62135596800+62135596800)},g.dtiPlus2=function(N,B){return _.addTo(B,N-62135596800+62135596800)},g.dtiMinus2=function(N,B){return N=_.subFrom(B,N-62135596800+62135596800)-62135596800+62135596800,N+62135596800},g.dtiPlus3=function(N,B){return N=_.addTo(B,N-62135596800+62135596800)-62135596800+62135596800,N+62135596800};var _={};_.create=function(N,B){var X=new x;return X.begin=B-62135596800<N-62135596800?B:N,X.end=B-62135596800<N-62135596800?N:B,X.negative=B-62135596800<N-62135596800,X},_._new=function(N){return N},_.invert=function(N){return N.negative=!N.negative,N},_.addTo=function(N,B){return B-62135596800+(N.negative?-1:1)*(N.end-62135596800-(N.begin-62135596800))+62135596800},_.subFrom=function(N,B){return B-62135596800-(N.negative?-1:1)*(N.end-62135596800-(N.begin-62135596800))+62135596800},_.toString=function(N){var B=N.getYears(),X=N.getMonths(),Z=N.getDays(),oe=N.getHours(),xe=N.getMinutes(),Be=N.getSeconds(),Le=[];return B!=0&&Le.push(""+B+"y"),X!=0&&Le.push(""+X+"m"),Z!=0&&Le.push(""+Z+"d"),oe!=0&&Le.push(""+oe+"hrs"),xe!=0&&Le.push(""+xe+"min"),Be!=0&&Le.push(""+Be+"sec"),(N.negative?"-":"")+"("+(Le.length==0?"0sec":Le.join(", "))+")"},_.sign=function(N){return N.negative?-1:1},_.format=function(N,B){return F.strftime(N,B)},_.formatPartial=function(N,B){return F.formatPartial(N,B)},_.eq=function(N,B){return N.negative==B.negative?N.getTotalSeconds()==B.getTotalSeconds():!1},_.gt=function(N,B){if(N.negative!=B.negative)return B.negative;var X=N.getTotalSeconds()-B.getTotalSeconds();return N.negative?X<0:X>0},_.gte=function(N,B){if(N.negative==B.negative&&N.getTotalSeconds()==B.getTotalSeconds())return!0;if(N.negative!=B.negative)return B.negative;var X=N.getTotalSeconds()-B.getTotalSeconds();return N.negative?X<0:X>0},_.lt=function(N,B){var X;if(N.negative==B.negative&&N.getTotalSeconds()==B.getTotalSeconds())X=!0;else if(N.negative!=B.negative)X=B.negative;else{var Z=N.getTotalSeconds()-B.getTotalSeconds();X=N.negative?Z<0:Z>0}return!X},_.lte=function(N,B){var X;if(N.negative!=B.negative)X=B.negative;else{var Z=N.getTotalSeconds()-B.getTotalSeconds();X=N.negative?Z<0:Z>0}return!X},_.neq=function(N,B){return!(N.negative==B.negative&&N.getTotalSeconds()==B.getTotalSeconds())};var x=function(){this.seconds=-1,this.minutes=-1,this.hours=-1,this.days=-1,this.months=-1,this.years=-1,this.negative=!1};x.__name__=!0,x.prototype={getYears:function(){if(this.years<0){this.years=g.getYear(this.end)-g.getYear(this.begin);var B=this.begin,N=b.getMonth(((B-62135596800-g.yearStart(B))/86400|0)+1,g.isLeapYear(B)),B=this.end,X=b.getMonth(((B-62135596800-g.yearStart(B))/86400|0)+1,g.isLeapYear(B));if(X<N)this.years--;else if(N==X){var B=this.begin,Z=b.getMonthDay(((B-62135596800-g.yearStart(B))/86400|0)+1,g.isLeapYear(B)),B=this.end,oe=b.getMonthDay(((B-62135596800-g.yearStart(B))/86400|0)+1,g.isLeapYear(B));if(oe<Z)this.years--;else if(Z==oe){var B=this.begin,xe=(B-Math.floor(B/86400)*86400)/3600|0,B=this.end,Be=(B-Math.floor(B/86400)*86400)/3600|0;if(Be<xe)this.years--;else if(Be==xe){var B=this.begin,N=(B-Math.floor(B/3600)*3600)/60|0,B=this.end,X=(B-Math.floor(B/3600)*3600)/60|0;if(X<N)this.years--;else{var Le;if(X==N){var B=this.end,bt=this.begin;Le=(B-Math.floor(B/60)*60|0)<(bt-Math.floor(bt/60)*60|0)}else Le=!1;Le&&this.years--}}}}}return this.years},getMonths:function(){if(this.months<0){var Z=this.begin,N=b.getMonth(((Z-62135596800-g.yearStart(Z))/86400|0)+1,g.isLeapYear(Z)),Z=this.end,B=b.getMonth(((Z-62135596800-g.yearStart(Z))/86400|0)+1,g.isLeapYear(Z));this.months=N<=B?B-N:12-N+B;var Z=this.begin,X=b.getMonthDay(((Z-62135596800-g.yearStart(Z))/86400|0)+1,g.isLeapYear(Z)),Z=this.end,oe=b.getMonthDay(((Z-62135596800-g.yearStart(Z))/86400|0)+1,g.isLeapYear(Z));if(oe<X)this.months--;else if(X==oe){var Z=this.begin,xe=(Z-Math.floor(Z/86400)*86400)/3600|0,Z=this.end,Be=(Z-Math.floor(Z/86400)*86400)/3600|0;if(Be<xe)this.months--;else if(Be==xe){var Z=this.begin,Le=(Z-Math.floor(Z/3600)*3600)/60|0,Z=this.end,bt=(Z-Math.floor(Z/3600)*3600)/60|0;if(bt<Le)this.months--;else{var Ue;if(bt==Le){var Z=this.end,He=this.begin;Ue=(Z-Math.floor(Z/60)*60|0)<(He-Math.floor(He/60)*60|0)}else Ue=!1;Ue&&this.months--}}}}return this.months},getTotalMonths:function(){return this.getYears()*12+this.getMonths()},getDays:function(){if(this.days<0){var oe=this.begin,N=b.getMonthDay(((oe-62135596800-g.yearStart(oe))/86400|0)+1,g.isLeapYear(oe)),oe=this.end,B=b.getMonthDay(((oe-62135596800-g.yearStart(oe))/86400|0)+1,g.isLeapYear(oe)),X;if(N<=B)X=B-N;else{var oe=this.begin;X=b.days(b.getMonth(((oe-62135596800-g.yearStart(oe))/86400|0)+1,g.isLeapYear(oe)),g.isLeapYear(this.begin))-N+B}this.days=X;var oe=this.begin,Z=(oe-Math.floor(oe/86400)*86400)/3600|0,oe=this.end,xe=(oe-Math.floor(oe/86400)*86400)/3600|0;if(xe<Z)this.days--;else if(xe==Z){var oe=this.begin,Be=(oe-Math.floor(oe/3600)*3600)/60|0,oe=this.end,Le=(oe-Math.floor(oe/3600)*3600)/60|0;if(Le<Be)this.days--;else{var X;if(Le==Be){var oe=this.end,bt=this.begin;X=(oe-Math.floor(oe/60)*60|0)<(bt-Math.floor(bt/60)*60|0)}else X=!1;X&&this.days--}}}return this.days},getTotalDays:function(){return(this.end-62135596800-(this.begin-62135596800))/86400|0},getHours:function(){if(this.hours<0){var Z=this.begin,N=(Z-Math.floor(Z/86400)*86400)/3600|0,Z=this.end,B=(Z-Math.floor(Z/86400)*86400)/3600|0;this.hours=N<=B?B-N:24-N+B;var Z=this.begin,X=(Z-Math.floor(Z/3600)*3600)/60|0,Z=this.end,oe=(Z-Math.floor(Z/3600)*3600)/60|0;if(oe<X)this.hours--;else{var xe;if(oe==X){var Z=this.end,Be=this.begin;xe=(Z-Math.floor(Z/60)*60|0)<(Be-Math.floor(Be/60)*60|0)}else xe=!1;xe&&this.hours--}}return this.hours},getTotalHours:function(){return(this.end-62135596800-(this.begin-62135596800))/3600|0},getMinutes:function(){if(this.minutes<0){var X=this.begin,N=(X-Math.floor(X/3600)*3600)/60|0,X=this.end,B=(X-Math.floor(X/3600)*3600)/60|0;this.minutes=N<=B?B-N:60-N+B;var X=this.end,Z=this.begin;(X-Math.floor(X/60)*60|0)<(Z-Math.floor(Z/60)*60|0)&&this.minutes--}return this.minutes},getTotalMinutes:function(){return(this.end-62135596800-(this.begin-62135596800))/60|0},getSeconds:function(){if(this.seconds<0){var B=this.begin,N=B-Math.floor(B/60)*60|0,B=this.end,X=B-Math.floor(B/60)*60|0;this.seconds=N<=X?X-N:60-N+X}return this.seconds},getTotalSeconds:function(){return this.end-62135596800-(this.begin-62135596800)},getTotalWeeks:function(){return(this.end-62135596800-(this.begin-62135596800))/604800|0}};var F=function(){};F.__name__=!0,F.strftime=function(N,B){for(var X=0,Z=B.indexOf("%"),oe="";Z>=0;){switch(oe+=B.substring(X,Z),++Z,B.charCodeAt(Z)){case 37:oe+="%";break;case 68:oe+=f.lpad(N.getDays()+"","0",2);break;case 72:oe+=f.lpad(N.getHours()+"","0",2);break;case 73:oe+=f.lpad(N.getMinutes()+"","0",2);break;case 77:oe+=f.lpad(N.getMonths()+"","0",2);break;case 82:oe+=N.negative?"-":"+";break;case 83:oe+=f.lpad(N.getSeconds()+"","0",2);break;case 89:oe+=f.lpad(N.getYears()+"","0",2);break;case 97:oe+=N.getTotalDays()+"";break;case 98:oe+=N.getTotalMonths()+"";break;case 99:oe+=N.getTotalHours()+"";break;case 100:oe+=N.getDays()+"";break;case 101:oe+=N.getTotalMinutes()+"";break;case 102:oe+=N.getTotalSeconds()+"";break;case 104:oe+=N.getHours()+"";break;case 105:oe+=N.getMinutes()+"";break;case 109:oe+=N.getMonths()+"";break;case 114:oe+=N.negative?"-":"";break;case 115:oe+=N.getSeconds()+"";break;case 121:oe+=N.getYears()+"";break}X=Z+1,Z=B.indexOf("%",Z+1)}return oe+=B.substring(X),oe},F.formatPartial=function(N,B){for(var X=[],Z=0,oe="",xe=0,Be=B.length;xe<Be;){var Le=xe++;if(Z=B[Le].indexOf("%"),Z>=0){switch(B[Le].charCodeAt(Z+1)){case 68:if(N.getDays()==0)continue;oe=B[Le].substring(0,Z)+f.lpad(N.getDays()+"","0",2)+B[Le].substring(Z+2);break;case 72:if(N.getHours()==0)continue;oe=B[Le].substring(0,Z)+f.lpad(N.getHours()+"","0",2)+B[Le].substring(Z+2);break;case 73:if(N.getMinutes()==0)continue;oe=B[Le].substring(0,Z)+f.lpad(N.getMinutes()+"","0",2)+B[Le].substring(Z+2);break;case 77:if(N.getMonths()==0)continue;oe=B[Le].substring(0,Z)+f.lpad(N.getMonths()+"","0",2)+B[Le].substring(Z+2);break;case 83:if(N.getSeconds()==0)continue;oe=B[Le].substring(0,Z)+f.lpad(N.getSeconds()+"","0",2)+B[Le].substring(Z+2);break;case 89:if(N.getYears()==0)continue;oe=B[Le].substring(0,Z)+f.lpad(N.getYears()+"","0",2)+B[Le].substring(Z+2);break;case 97:if(N.getTotalDays()==0)continue;oe=B[Le].substring(0,Z)+N.getTotalDays()+B[Le].substring(Z+2);break;case 98:if(N.getTotalMonths()==0)continue;oe=B[Le].substring(0,Z)+N.getTotalMonths()+B[Le].substring(Z+2);break;case 99:if(N.getTotalHours()==0)continue;oe=B[Le].substring(0,Z)+N.getTotalHours()+B[Le].substring(Z+2);break;case 100:if(N.getDays()==0)continue;oe=B[Le].substring(0,Z)+N.getDays()+B[Le].substring(Z+2);break;case 101:if(N.getTotalMinutes()==0)continue;oe=B[Le].substring(0,Z)+N.getTotalMinutes()+B[Le].substring(Z+2);break;case 102:if(N.getTotalSeconds()==0)continue;oe=B[Le].substring(0,Z)+N.getTotalSeconds()+B[Le].substring(Z+2);break;case 104:if(N.getHours()==0)continue;oe=B[Le].substring(0,Z)+N.getHours()+B[Le].substring(Z+2);break;case 105:if(N.getMinutes()==0)continue;oe=B[Le].substring(0,Z)+N.getMinutes()+B[Le].substring(Z+2);break;case 109:if(N.getMonths()==0)continue;oe=B[Le].substring(0,Z)+N.getMonths()+B[Le].substring(Z+2);break;case 115:if(N.getSeconds()==0)continue;oe=B[Le].substring(0,Z)+N.getSeconds()+B[Le].substring(Z+2);break;case 121:if(N.getYears()==0)continue;oe=B[Le].substring(0,Z)+N.getYears()+B[Le].substring(Z+2);break;default:continue}X.push(oe)}}return X};var b=function(){};b.__name__=!0,b.days=function(N,B){return B==null&&(B=!1),N==1?31:N==2&&B?29:N==2?28:N==3?31:N==4?30:N==5?31:N==6?30:N==7||N==8?31:N==9?30:N==10?31:N==11?30:31},b.getMonth=function(N,B){return B==null&&(B=!1),N<32?1:B?N<61?2:N<92?3:N<122?4:N<153?5:N<183?6:N<214?7:N<245?8:N<275?9:N<306?10:N<336?11:12:N<60?2:N<91?3:N<121?4:N<152?5:N<182?6:N<213?7:N<244?8:N<274?9:N<305?10:N<335?11:12},b.getMonthDay=function(N,B){return B==null&&(B=!1),N<32?N:B?N<61?N-31:N<92?N-60:N<122?N-91:N<153?N-121:N<183?N-152:N<214?N-182:N<245?N-213:N<275?N-244:N<306?N-274:N<336?N-305:N-335:N<60?N-31:N<91?N-59:N<121?N-90:N<152?N-120:N<182?N-151:N<213?N-181:N<244?N-212:N<274?N-243:N<305?N-273:N<335?N-304:N-334},b.toSeconds=function(N,B){return B==null&&(B=!1),86400*(N==1?0:B?N==2?31:N==3?60:N==4?91:N==5?121:N==6?152:N==7?182:N==8?213:N==9?244:N==10?274:N==11?305:335:N==2?31:N==3?59:N==4?90:N==5?120:N==6?151:N==7?181:N==8?212:N==9?243:N==10?273:N==11?304:334)};var w=function(){};w.__name__=!0,w.snapYear=function(N,B){switch(B){case-1:return g.yearStart(N);case 0:var X=g.yearStart(E.addYear(N,1)+62135596800),Z=g.yearStart(N);return X-(N-62135596800)>N-62135596800-Z?Z:X;case 1:return g.yearStart(E.addYear(N,1)+62135596800)}},w.snapMonth=function(N,B){var X=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),Z=g.isLeapYear(N);switch(B){case-1:return g.yearStart(N)+b.toSeconds(X,Z);case 0:var oe=g.yearStart(N)+b.toSeconds(X,Z),xe=g.yearStart(N)+b.toSeconds(X,Z)+b.days(X,Z)*86400;return xe-(N-62135596800)>N-62135596800-oe?oe:xe;case 1:return g.yearStart(N)+b.toSeconds(X,Z)+b.days(X,Z)*86400}},w.snapDay=function(N,B){var X=(N-62135596800)/86400;switch(B){case-1:return Math.floor(X)*86400;case 0:return Math.round(X)*86400;case 1:return Math.ceil(X)*86400}},w.snapHour=function(N,B){var X=(N-62135596800)/3600;switch(B){case-1:return Math.floor(X)*3600;case 0:return Math.round(X)*3600;case 1:return Math.ceil(X)*3600}},w.snapMinute=function(N,B){var X=(N-62135596800)/60;switch(B){case-1:return Math.floor(X)*60;case 0:return Math.round(X)*60;case 1:return Math.ceil(X)*60}},w.snapWeek=function(N,B,X){var Z=g.getWeekDay(N),oe=Math.floor((N-62135596800)/86400);switch(B){case-1:return(oe-(Z>=X?Z-X:Z+7-X))*86400;case 0:var xe=(oe-(Z>=X?Z-X:Z+7-X))*86400,Be=(oe+(X>Z?X-Z:X+7-Z))*86400;return Be-(N-62135596800)>N-62135596800-xe?xe:Be;case 1:return(oe+(X>Z?X-Z:X+7-Z))*86400}};var E=function(){};E.__name__=!0,E.fromString=function(N){if(N.length==10||N.charCodeAt(10)==32)return E.parse(N);if(N.charCodeAt(10)==84)return E.fromIsoString(N);throw I.thrown("`"+N+"` - incorrect date/time format. Should be either `YYYY-MM-DD hh:mm:ss` or `YYYY-MM-DD` or `YYYY-MM-DDThh:mm:ss[.SSS]Z`")},E.parse=function(N){var B=N.indexOf("-");if(B<1||N.length-B!=6&&N.length-B!=15)throw I.thrown("`"+N+"` - incorrect date/time format. Should be either `YYYY-MM-DD hh:mm:ss` or `YYYY-MM-DD`");N.length-B==6&&(N+=" 00:00:00");var X=u.parseInt(c.substr(N,0,B)),Z=u.parseInt(c.substr(N,B+1,2)),oe=u.parseInt(c.substr(N,B+4,2)),xe=u.parseInt(c.substr(N,B+7,2)),Be=u.parseInt(c.substr(N,B+10,2)),Le=u.parseInt(c.substr(N,B+13,2));if(X==null||Z==null||oe==null||xe==null||Be==null||Le==null)throw I.thrown("`"+N+"` - incorrect date/time format. Should be either `YYYY-MM-DD hh:mm:ss` or `YYYY-MM-DD`");var bt=X,Ue=Z,He=oe,rt=xe,je=Be,le=Le;return Le==null&&(le=0),Be==null&&(je=0),xe==null&&(rt=0),oe==null&&(He=1),Z==null&&(Ue=1),X==null&&(bt=1970),E.yearToStamp(bt)+b.toSeconds(Ue,bt%4==0&&(bt%100==0?bt%400==0:!0))+(He-1)*86400+rt*3600+je*60+le-62135596800+62135596800},E.fromIsoString=function(N){if(N.charCodeAt(N.length-1)!=90)throw I.thrown("`"+N+"` - incorrect date/time format. Not an ISO 8601 UTC/Zulu string: Z not found.");if(N.length>20){if(N.charCodeAt(19)!=46)throw I.thrown("`"+N+"` - incorrect date/time format. Not an ISO 8601 string: Millisecond specification erroneous.");if(N.charCodeAt(23)!=90)throw I.thrown("`"+N+"` - incorrect date/time format. Not an ISO 8601 string: Timezone specification erroneous.")}return E.parse(c.substr(N,0,10)+" "+c.substr(N,11,8))},E.clamp=function(N,B,X){return N<B?B:N>X?X:N},E.yearToStamp=function(N){--N;var B=N/400|0,X=(N-B*400)/4|0;return B*12622780800+X*126230400-(X/25|0)*86400+(N-B*400-X*4)*31536e3},E.addYear=function(N,B){var X=g.getYear(N)+B;return E.yearToStamp(X)+b.toSeconds(b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),X%4==0&&(X%100==0?X%400==0:!0))+(N-62135596800-(g.yearStart(N)+b.toSeconds(b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),g.isLeapYear(N))))-62135596800},E.addMonth=function(N,B){var X=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+B;if(X>12){var Z=X/12|0;N=E.addYear(N,Z)+62135596800,X-=Z*12}else if(X<=0){var Z=(X/12|0)-1;N=E.addYear(N,Z)+62135596800,X-=Z*12}var oe=g.isLeapYear(N),xe=b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),Be=b.days(X,oe);return g.yearStart(N)+b.toSeconds(X,oe)+((xe<1?1:xe>Be?Be:xe)-1)*86400+((N-Math.floor(N/86400)*86400)/3600|0)*3600+((N-Math.floor(N/3600)*3600)/60|0)*60+(N-Math.floor(N/60)*60|0)},E.getWeekDayNum=function(N,B,X){var Z=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N));return X>0?g.add(g.snap(g.monthStart(N,Z)-1+62135596800,p.Week(1,B)),h.Week(X-1))-62135596800:X<0?g.add(g.snap(g.monthStart(N,Z+1)-1+62135596800,p.Week(-1,B)),h.Week(X+1))-62135596800:N-62135596800},E.strftime=function(N,B){for(var X=0,Z=B.indexOf("%"),oe="";Z>=0;){switch(oe+=B.substring(X,Z),++Z,B.charCodeAt(Z)){case 37:oe+="%";break;case 67:oe+=f.lpad((g.getYear(N)/100|0)+"","0",2);break;case 68:oe+=f.lpad(b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+"/","0",3)+f.lpad(b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+"/","0",3)+f.lpad(c.substr(g.getYear(N)+"",-2,null),"0",2);break;case 70:oe+=g.getYear(N)+"-"+f.lpad(b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+"-","0",3)+f.lpad(b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+"","0",2);break;case 72:oe+=f.lpad(((N-Math.floor(N/86400)*86400)/3600|0)+"","0",2);break;case 73:oe+=f.lpad(g.getHour12(N)+"","0",2);break;case 77:oe+=f.lpad(((N-Math.floor(N/3600)*3600)/60|0)+"","0",2);break;case 80:oe+=((N-Math.floor(N/86400)*86400)/3600|0)<12?"am":"pm";break;case 82:oe+=f.lpad(((N-Math.floor(N/86400)*86400)/3600|0)+":","0",3)+f.lpad(((N-Math.floor(N/3600)*3600)/60|0)+"","0",2);break;case 83:oe+=f.lpad((N-Math.floor(N/60)*60|0)+"","0",2);break;case 84:oe+=f.lpad(((N-Math.floor(N/86400)*86400)/3600|0)+":","0",3)+f.lpad(((N-Math.floor(N/3600)*3600)/60|0)+":","0",3)+f.lpad((N-Math.floor(N/60)*60|0)+"","0",2);break;case 86:oe+=f.lpad(g.getWeek(N)+"","0",2);break;case 89:oe+=g.getYear(N)+"";break;case 100:oe+=f.lpad(b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+"","0",2);break;case 101:oe+=f.lpad(b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+""," ",2);break;case 106:oe+=f.lpad(""+(((N-62135596800-g.yearStart(N))/86400|0)+1),"0",3);break;case 107:oe+=f.lpad(((N-Math.floor(N/86400)*86400)/3600|0)+""," ",2);break;case 108:oe+=f.lpad(g.getHour12(N)+""," ",2);break;case 109:oe+=f.lpad(b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+"","0",2);break;case 112:oe+=((N-Math.floor(N/86400)*86400)/3600|0)<12?"AM":"PM";break;case 114:oe+=f.lpad(g.getHour12(N)+":","0",3)+f.lpad(((N-Math.floor(N/3600)*3600)/60|0)+":","0",3)+f.lpad((N-Math.floor(N/60)*60|0)+"","0",2);break;case 115:oe+=N-62135596800+"";break;case 117:oe+=g.getWeekDay(N,!0)+"";break;case 119:oe+=g.getWeekDay(N)+"";break;case 121:oe+=f.lpad(c.substr(g.getYear(N)+"",-2,null),"0",2);break}X=Z+1,Z=B.indexOf("%",Z+1)}return oe+=B.substring(X),oe};var C=s["formula.TypeSlot"]={__ename__:!0,__constructs__:null,TCon:(a=function(N){return{_hx_index:0,type:N,__enum__:"formula.TypeSlot",toString:n}},a._hx_name="TCon",a.__params__=["type"],a),TVar:(a=function(N){return{_hx_index:1,id:N,__enum__:"formula.TypeSlot",toString:n}},a._hx_name="TVar",a.__params__=["id"],a)};C.__constructs__=[C.TCon,C.TVar];var k=s["formula.ValueType"]={__ename__:!0,__constructs__:null,TNumber:{_hx_name:"TNumber",_hx_index:0,__enum__:"formula.ValueType",toString:n},TString:{_hx_name:"TString",_hx_index:1,__enum__:"formula.ValueType",toString:n},TBoolean:{_hx_name:"TBoolean",_hx_index:2,__enum__:"formula.ValueType",toString:n},TDate:{_hx_name:"TDate",_hx_index:3,__enum__:"formula.ValueType",toString:n},TRichText:{_hx_name:"TRichText",_hx_index:4,__enum__:"formula.ValueType",toString:n}};k.__constructs__=[k.TNumber,k.TString,k.TBoolean,k.TDate,k.TRichText];var T=s["formula.Value"]={__ename__:!0,__constructs__:null,VNumber:(a=function(N){return{_hx_index:0,value:N,__enum__:"formula.Value",toString:n}},a._hx_name="VNumber",a.__params__=["value"],a),VString:(a=function(N){return{_hx_index:1,value:N,__enum__:"formula.Value",toString:n}},a._hx_name="VString",a.__params__=["value"],a),VBoolean:(a=function(N){return{_hx_index:2,value:N,__enum__:"formula.Value",toString:n}},a._hx_name="VBoolean",a.__params__=["value"],a),VDate:(a=function(N){return{_hx_index:3,value:N,__enum__:"formula.Value",toString:n}},a._hx_name="VDate",a.__params__=["value"],a),VRichText:(a=function(N){return{_hx_index:4,format:N,__enum__:"formula.Value",toString:n}},a._hx_name="VRichText",a.__params__=["format"],a)};T.__constructs__=[T.VNumber,T.VString,T.VBoolean,T.VDate,T.VRichText];var v=e.formula.ValueTool=function(){};v.__name__=!0,v.typeOf=function(N){switch(N._hx_index){case 0:return k.TNumber;case 1:return k.TString;case 2:return k.TBoolean;case 3:return k.TDate;case 4:return k.TRichText}},v.number=function(N){return T.VNumber(N)},v.string=function(N){return T.VString(N)},v.boolean=function(N){return T.VBoolean(N)},v.date=function(N){return T.VDate(N)},v.richText=function(N){return T.VRichText(N)},v.toDynamic=function(N){switch(N._hx_index){case 0:return N.value;case 1:return N.value;case 2:return N.value;case 3:return N.value;case 4:return N.format}},v.asNumber=function(N){if(N._hx_index==0)return N.value;throw new I("")},v.asString=function(N){if(N==null)return"";if(N._hx_index==1)return N.value;throw new I("")},v.asBoolean=function(N){if(N==null)return!1;if(N._hx_index==2)return N.value;throw new I("")},v.asDate=function(N){if(N._hx_index==3)return N.value;throw new I("")},v.asRichText=function(N){if(N._hx_index==4)return N.format;throw new I("")},v.formatFloat=function(N){var B=N==null?"null":""+N,X=B.lastIndexOf("."),Z=B.length-X-1;if(X>=0&&Z>=10){var oe=Math.pow(10,Math.max(10,Z-6)),xe=u.string(Math.round(N*oe)/oe);if(B.length-xe.length>=Z-12&&B.length-xe.length>=4)return xe}return u.string(Math.round(N*1e12)/1e12)},v.toString=function(N){if(N==null)return"";switch(N._hx_index){case 0:var B=N.value;return isNaN(B)?"":v.formatFloat(B);case 1:return N.value;case 2:return N.value?"true":"false";case 3:return c.dateStr(N.value);case 4:return N.format.toString()}},v.nameOfType=function(N){switch(N._hx_index){case 0:return"number";case 1:return"string";case 2:return"boolean";case 3:return"date";case 4:return"richtext"}};var I=function(N,B,X){Error.call(this,N),this.message=N,this.__previousException=B,this.__nativeException=X!=null?X:this};I.__name__=!0,I.caught=function(N){return N instanceof I?N:N instanceof Error?new I(N.message,null,N):new ge(N,null,N)},I.thrown=function(N){if(N instanceof I)return N.get_native();if(N instanceof Error)return N;var B=new ge(N);return B},I.__super__=Error,I.prototype=o(Error.prototype,{unwrap:function(){return this.__nativeException},toString:function(){return this.get_message()},get_message:function(){return this.message},get_native:function(){return this.__nativeException}});var j=function(){};j.__name__=!0,j.compareNumber=function(N,B){return N-B},j.compareString=function(N,B){for(var X=Math.min(N.length,B.length)|0,Z=0;Z<X;){var oe=Z++,xe=c.cca(N,oe),Be=c.cca(B,oe);if(xe<Be)return-1;if(xe>Be)return 1}return N.length-B.length},j.compareBoolean=function(N,B){return N?B?0:1:B?-1:0},j.compareDate=function(N,B){return j.compareNumber(N.getTime(),B.getTime())};var S=function(){};S.__name__=!0,S.__string_rec=function(N,B){if(N==null)return"null";if(B.length>=5)return"<...>";var X=typeof N;switch(X=="function"&&(N.__name__||N.__ename__)&&(X="object"),X){case"function":return"<function>";case"object":if(N.__enum__){var Z=s[N.__enum__],oe=Z.__constructs__[N._hx_index],xe=oe._hx_name;return oe.__params__?(B=B+"	",xe+"("+function(Qe){for(var Tt,Pt=[],cn=0,Lt=oe.__params__;cn<Lt.length;){var Bn=Lt[cn];cn=cn+1,Pt.push(S.__string_rec(N[Bn],B))}return Tt=Pt,Tt}().join(",")+")"):xe}if(N instanceof Array){var rt="[";B+="	";for(var Be=0,Le=N.length;Be<Le;){var bt=Be++;rt+=(bt>0?",":"")+S.__string_rec(N[bt],B)}return rt+="]",rt}var Ue;try{Ue=N.toString}catch(Qe){return"???"}if(Ue!=null&&Ue!=Object.toString&&typeof Ue=="function"){var He=N.toString();if(He!="[object Object]")return He}var rt="{\n";B+="	";var je=N.hasOwnProperty!=null,le=null;for(le in N)je&&!N.hasOwnProperty(le)||le=="prototype"||le=="__class__"||le=="__super__"||le=="__interfaces__"||le=="__properties__"||(rt.length!=2&&(rt+=", \n"),rt+=B+le+" : "+S.__string_rec(N[le],B));return B=B.substring(1),rt+="\n"+B+"}",rt;case"string":return N;default:return String(N)}};var D=function(N,B,X){I.call(this,N,B),X==null?this.posInfos={fileName:"(unknown)",lineNumber:0,className:"(unknown)",methodName:"(unknown)"}:this.posInfos=X};D.__name__=!0,D.__super__=I,D.prototype=o(I.prototype,{toString:function(){return""+I.prototype.toString.call(this)+" in "+this.posInfos.className+"."+this.posInfos.methodName+" at "+this.posInfos.fileName+":"+this.posInfos.lineNumber}});var A=function(N,B,X){N==null&&(N="Not implemented"),D.call(this,N,B,X)};A.__name__=!0,A.__super__=D,A.prototype=o(D.prototype,{});var P=function(){};P.__name__=!0,P.getTotalMonthsFix=function(N){var B=N.begin,X=N.end,Z=(g.getYear(X)-g.getYear(B))*12+(b.getMonth(((X-62135596800-g.yearStart(X))/86400|0)+1,g.isLeapYear(X))-b.getMonth(((B-62135596800-g.yearStart(B))/86400|0)+1,g.isLeapYear(B))),oe=b.getMonthDay(((B-62135596800-g.yearStart(B))/86400|0)+1,g.isLeapYear(B)),xe=b.getMonthDay(((X-62135596800-g.yearStart(X))/86400|0)+1,g.isLeapYear(X));if(xe<oe)--Z;else if(oe==xe){var Be=(B-Math.floor(B/86400)*86400)/3600|0,Le=(X-Math.floor(X/86400)*86400)/3600|0;if(Le<Be)--Z;else if(Le==Be){var bt=(B-Math.floor(B/3600)*3600)/60|0,Ue=(X-Math.floor(X/3600)*3600)/60|0;(Ue<bt||Ue==bt&&(X-Math.floor(X/60)*60|0)<(B-Math.floor(B/60)*60|0))&&--Z}}return Z},P.getLocalWeek=function(N){return g.getWeek(N-62135596800+g.getLocalOffset()+62135596800)};var L=function(){this.constMap=new Ae,this.funcMap=new Ae;var N=C.TCon(k.TNumber),B=C.TCon(k.TString),X=C.TCon(k.TBoolean),Z=C.TCon(k.TDate);this.constMap.h.e=T.VNumber(2.718281828459045),this.constMap.h.pi=T.VNumber(3.141592653589793),this.constMap.h.true=T.VBoolean(!0),this.constMap.h.false=T.VBoolean(!1),this.funcMap.h.prop={type:L.fnTy(null,[B]),eval:null};var je={type:L.fnTy(N,[N]),eval:function(le){return T.VNumber(-v.asNumber(le[0]))}};this.funcMap.h.unaryMinus=je,this.funcMap.h.unaryPlus={type:L.fnTy(N,[N]),eval:function(le){return le[0]}};var je={type:L.fnTy(N,[N,N]),eval:function(le){return T.VNumber(v.asNumber(le[0])+v.asNumber(le[1]))}};this.funcMap.h.add=je;var je={type:L.fnTy(N,[N,N]),eval:function(le){return T.VNumber(v.asNumber(le[0])-v.asNumber(le[1]))}};this.funcMap.h.subtract=je;var je={type:L.fnTy(N,[N,N]),eval:function(le){return T.VNumber(v.asNumber(le[0])*v.asNumber(le[1]))}};this.funcMap.h.multiply=je;var je={type:L.fnTy(N,[N,N]),eval:function(le){return T.VNumber(v.asNumber(le[0])/v.asNumber(le[1]))}};this.funcMap.h.divide=je;var je={type:L.fnTy(N,[N,N]),eval:function(le){return T.VNumber(v.asNumber(le[0])%v.asNumber(le[1]))}};this.funcMap.h.mod=je;var je={type:L.fnTy(N,[N]),eval:function(le){var Qe=v.asNumber(le[0]);return T.VNumber(Qe>0?1:Qe<0?-1:0)}};this.funcMap.h.sign=je;var je={type:L.fnTy(N,[N]),eval:function(le){return T.VNumber(Math.abs(v.asNumber(le[0])))}};this.funcMap.h.abs=je;var je={type:L.fnTy(N,[N]),eval:function(le){return T.VNumber(Math.floor(v.asNumber(le[0])))}};this.funcMap.h.floor=je;var je={type:L.fnTy(N,[N]),eval:function(le){return T.VNumber(Math.ceil(v.asNumber(le[0])))}};this.funcMap.h.ceil=je;var je={type:L.fnTy(N,[N]),eval:function(le){return T.VNumber(Math.round(v.asNumber(le[0])))}};this.funcMap.h.round=je;var je={type:L.vaFnTy(N,[N],N),eval:function(le){for(var Qe=new Array(le.length),Tt=0,Pt=le.length;Tt<Pt;){var cn=Tt++;Qe[cn]=v.asNumber(le[cn])}return T.VNumber(d.fold(Qe.slice(1),Math.max,Qe[0]))}};this.funcMap.h.max=je;var je={type:L.vaFnTy(N,[N],N),eval:function(le){for(var Qe=new Array(le.length),Tt=0,Pt=le.length;Tt<Pt;){var cn=Tt++;Qe[cn]=v.asNumber(le[cn])}return T.VNumber(d.fold(Qe.slice(1),Math.min,Qe[0]))}};this.funcMap.h.min=je;var je={type:L.fnTy(N,[N,N]),eval:function(le){return T.VNumber(Math.pow(v.asNumber(le[0]),v.asNumber(le[1])))}};this.funcMap.h.pow=je;var je={type:L.fnTy(N,[N]),eval:function(le){return T.VNumber(Math.exp(v.asNumber(le[0])))}};this.funcMap.h.exp=je;var je={type:L.fnTy(N,[N]),eval:function(le){return T.VNumber(Math.log(v.asNumber(le[0])))}};this.funcMap.h.ln=je;var je={type:L.fnTy(N,[N]),eval:function(le){return T.VNumber(Math.log(v.asNumber(le[0]))*1.4426950408889634)}};this.funcMap.h.log2=je;var je={type:L.fnTy(N,[N]),eval:function(le){return T.VNumber(Math.log(v.asNumber(le[0]))*.4342944819032518)}};this.funcMap.h.log10=je;var je={type:L.fnTy(N,[N]),eval:function(le){return T.VNumber(Math.sqrt(v.asNumber(le[0])))}};this.funcMap.h.sqrt=je;var je={type:L.fnTy(N,[N]),eval:function(le){var Qe=v.asNumber(le[0]);return T.VNumber(Qe<0?-Math.pow(-Qe,.3333333333333333):Math.pow(Qe,.3333333333333333))}};this.funcMap.h.cbrt=je;var xe=new Re;xe.h[0]=null;var je={type:L.genFnTy(xe,N,[C.TVar(0)]),eval:function(le){var Qe=le[0];switch(Qe._hx_index){case 0:return T.VNumber(Qe.value);case 1:var Tt=Qe.value;if(Tt=="")return null;var Pt=parseFloat(f.trim(Tt));return isNaN(Pt)?null:T.VNumber(Pt);case 2:return T.VNumber(Qe.value?1:0);case 3:return T.VNumber(Qe.value.getTime());case 4:var Pt=parseFloat(f.trim(Qe.format[0]));return isNaN(Pt)?null:T.VNumber(Pt)}}};this.funcMap.h.toNumber=je;var xe=new Re;xe.h[0]=null,this.funcMap.h.if={type:L.genFnTy(xe,C.TVar(0),[X,C.TVar(0),C.TVar(0)]),eval:null},this.funcMap.h.and={type:L.fnTy(X,[X,X]),eval:null},this.funcMap.h.or={type:L.fnTy(X,[X,X]),eval:null};var je={type:L.fnTy(X,[X]),eval:function(le){return T.VBoolean(!v.asBoolean(le[0]))}};this.funcMap.h.not=je;var xe=new Re;xe.h[0]=null;var je={type:L.genFnTy(xe,X,[C.TVar(0)]),eval:function(le){var Qe=le[0],Tt;if(Qe==null)Tt=!0;else switch(Qe._hx_index){case 0:Tt=isNaN(Qe.value);break;case 1:Tt=Qe.value=="";break;case 2:Tt=Qe.value==!1;break;default:Tt=!1}return T.VBoolean(Tt)}};this.funcMap.h.empty=je;var oe=function(le,Qe){switch(le._hx_index){case 0:return j.compareNumber(v.asNumber(le),v.asNumber(Qe));case 1:return j.compareString(v.asString(le),v.asString(Qe));case 2:return j.compareBoolean(v.asBoolean(le),v.asBoolean(Qe));case 3:return j.compareDate(v.asDate(le),v.asDate(Qe));case 4:return j.compareString(v.asRichText(le)[0],v.asRichText(Qe)[0])}},xe=new Re;xe.h[0]=null;var je={type:L.genFnTy(xe,X,[C.TVar(0),C.TVar(0)]),eval:function(le){return T.VBoolean(oe(le[0],le[1])==0)}};this.funcMap.h.equal=je;var xe=new Re;xe.h[0]=null;var je={type:L.genFnTy(xe,X,[C.TVar(0),C.TVar(0)]),eval:function(le){return T.VBoolean(oe(le[0],le[1])!=0)}};this.funcMap.h.unequal=je;var xe=new Re;xe.h[0]=null;var je={type:L.genFnTy(xe,X,[C.TVar(0),C.TVar(0)]),eval:function(le){return T.VBoolean(oe(le[0],le[1])<0)}};this.funcMap.h.smaller=je;var xe=new Re;xe.h[0]=null;var je={type:L.genFnTy(xe,X,[C.TVar(0),C.TVar(0)]),eval:function(le){return T.VBoolean(oe(le[0],le[1])<=0)}};this.funcMap.h.smallerEq=je;var xe=new Re;xe.h[0]=null;var je={type:L.genFnTy(xe,X,[C.TVar(0),C.TVar(0)]),eval:function(le){return T.VBoolean(oe(le[0],le[1])>0)}};this.funcMap.h.larger=je;var xe=new Re;xe.h[0]=null;var je={type:L.genFnTy(xe,X,[C.TVar(0),C.TVar(0)]),eval:function(le){return T.VBoolean(oe(le[0],le[1])>=0)}};this.funcMap.h.largerEq=je;var je={type:L.fnTy(N,[B]),eval:function(le){return T.VNumber(v.asString(le[0]).length)}};this.funcMap.h.length=je;var je={type:L.fnTy(B,[B,N],[N]),eval:function(le){var Qe=v.asString(le[0]),Tt=v.asNumber(le[1])|0;if(Tt<0&&(Tt=Math.max(0,Qe.length+Tt)|0),le.length==2)return T.VString(Qe.substring(Tt,Qe.length));var Pt=v.asNumber(le[2])|0;return Pt<0&&(Pt=Math.max(0,Qe.length+Pt)|0),T.VString(Tt>=Pt?"":Qe.substring(Tt,Pt))}};this.funcMap.h.slice=je;var xe=new Re;xe.h[0]=null;var je={type:L.genFnTy(xe,B,[C.TVar(0)]),eval:function(le){return T.VString(v.toString(le[0]))}};this.funcMap.h.format=je;var je={type:L.vaFnTy(B,[],B),eval:function(le){if(le.length==2)return T.VString(v.asString(le[0])+v.asString(le[1]));for(var Qe=new Array(le.length),Tt=0,Pt=le.length;Tt<Pt;){var cn=Tt++;Qe[cn]=v.asString(le[cn])}return T.VString(Qe.join(""))}};this.funcMap.h.concat=je;var je={type:L.vaFnTy(B,[B],B),eval:function(le){for(var Qe=le.slice(1),Tt=new Array(Qe.length),Pt=0,cn=Qe.length;Pt<cn;){var Lt=Pt++;Tt[Lt]=v.asString(Qe[Lt])}return T.VString(Tt.join(v.asString(le[0])))}};this.funcMap.h.join=je;var je={type:L.fnTy(X,[B,B]),eval:function(le){var Qe=v.asString(le[0]),Tt=v.asString(le[1]);return T.VBoolean(Qe.length<=0?!1:Qe.indexOf(Tt)>=0)}};this.funcMap.h.contains=je;var je={type:L.fnTy(B,[B,B,B]),eval:function(le){var Qe=new RegExp(v.asString(le[1]),"".split("u").join("")),Tt=v.asString(le[0]),Pt=v.asString(le[2]);return T.VString(Tt.replace(Qe,Pt))}};this.funcMap.h.replace=je;var je={type:L.fnTy(B,[B,B,B]),eval:function(le){var Qe=new RegExp(v.asString(le[1]),"g".split("u").join("")),Tt=v.asString(le[0]),Pt=v.asString(le[2]);return T.VString(Tt.replace(Qe,Pt))}};this.funcMap.h.replaceAll=je;var je={type:L.fnTy(X,[B,B]),eval:function(le){return T.VBoolean(new l(v.asString(le[1]),"").match(v.asString(le[0])))}};this.funcMap.h.test=je,this.funcMap.h.now={type:L.fnTy(Z,[]),eval:null};var Be=function(le,Qe){var Tt="0000"+(le==null?"null":""+le);return Tt.substring(Tt.length-Qe)},Le=function(le){switch(le%10){case 1:return le!=11?""+le+"st":""+le+"th";case 2:return le!=12?""+le+"nd":""+le+"th";case 3:return le!=13?""+le+"rd":""+le+"th";default:return""+le+"th"}},bt=function(le,Qe){var Tt=Math.abs(le);return(le<0?"-":"+")+Be(Math.floor(Tt/60),2)+(Qe?":":"")+Be(Tt%60|0,2)},Ue=function(le,Qe){return new l("YYYY|YY|Qo|Q|MMMM|MMM|MM|Mo|M|ww|wo|w|DDDD|DDDo|DDD|DD|Do|D|dddd|ddd|dd|d|HH|H|hh|h|mm|m|ss|s|A|a|ZZ|Z|SSS|SS|S|X|x","g").map(Qe,function(Tt){switch(Tt.matched(0)){case"A":return le.getHours()<12?"AM":"PM";case"D":return u.string(le.getDate());case"DD":return Be(le.getDate(),2);case"DDD":var Pt=Math.floor(le.getTime()/1e3)+62135596800;return u.string(((Pt-62135596800-g.yearStart(Pt))/86400|0)+1);case"DDDD":var Pt=Math.floor(le.getTime()/1e3)+62135596800;return Be(((Pt-62135596800-g.yearStart(Pt))/86400|0)+1,3);case"DDDo":var Pt=Math.floor(le.getTime()/1e3)+62135596800;return Le(((Pt-62135596800-g.yearStart(Pt))/86400|0)+1);case"Do":return Le(le.getDate());case"H":return u.string(le.getHours());case"HH":return Be(le.getHours(),2);case"M":return u.string(le.getMonth()+1);case"MM":return Be(le.getMonth()+1,2);case"MMM":return i.format(le,"%b");case"MMMM":return i.format(le,"%B");case"Mo":return Le(le.getMonth()+1);case"Q":return u.string(Math.floor(le.getMonth()/3)+1);case"Qo":return Le(Math.floor(le.getMonth()/3)+1);case"S":return u.string(Math.floor(le.getTime()%1e3/100));case"SS":return u.string(Math.floor(le.getTime()%1e3/10));case"SSS":return u.string(le.getTime()%1e3);case"X":return u.string(Math.floor(le.getTime()/1e3));case"XX":return u.string(le.getTime());case"YY":return Be(le.getFullYear(),2);case"YYYY":return Be(le.getFullYear(),4);case"Z":return bt(-le.getTimezoneOffset(),!0);case"ZZ":return bt(-le.getTimezoneOffset(),!1);case"a":return le.getHours()<12?"am":"pm";case"d":return u.string(le.getDay());case"dd":return c.substr(i.format(le,"%a"),0,2);case"ddd":return i.format(le,"%a");case"dddd":return i.format(le,"%A");case"do":return Le(le.getDay());case"h":return u.string(le.getHours()%12);case"hh":return Be(le.getHours()%12,2);case"m":return u.string(le.getMinutes());case"mm":return Be(le.getMinutes(),2);case"s":return u.string(le.getSeconds());case"ss":return Be(le.getSeconds(),2);case"w":return u.string(P.getLocalWeek(Math.floor(le.getTime()/1e3)+62135596800));case"wo":return Le(P.getLocalWeek(Math.floor(le.getTime()/1e3)+62135596800));case"ww":return Be(P.getLocalWeek(Math.floor(le.getTime()/1e3)+62135596800),2);default:throw new I("")}})},je={type:L.fnTy(B,[Z,B]),eval:function(le){return T.VString(Ue(v.asDate(le[0]),v.asString(le[1])))}};this.funcMap.h.formatDate=je;var je={type:L.fnTy(Z,[N]),eval:function(le){return T.VDate(new Date(v.asNumber(le[0])))}};this.funcMap.h.fromTimestamp=je;var je={type:L.fnTy(N,[Z]),eval:function(le){return T.VNumber(Math.round(v.asDate(le[0]).getTime()))}};this.funcMap.h.timestamp=je;var je={type:L.fnTy(N,[Z]),eval:function(le){return T.VNumber(v.asDate(le[0]).getFullYear())}};this.funcMap.h.year=je;var je={type:L.fnTy(N,[Z]),eval:function(le){return T.VNumber(v.asDate(le[0]).getMonth()+1)}};this.funcMap.h.month=je;var je={type:L.fnTy(N,[Z]),eval:function(le){return T.VNumber(v.asDate(le[0]).getDate())}};this.funcMap.h.date=je;var je={type:L.fnTy(N,[Z]),eval:function(le){return T.VNumber(v.asDate(le[0]).getDay())}};this.funcMap.h.day=je;var je={type:L.fnTy(N,[Z]),eval:function(le){return T.VNumber(v.asDate(le[0]).getHours())}};this.funcMap.h.hour=je;var je={type:L.fnTy(N,[Z]),eval:function(le){return T.VNumber(v.asDate(le[0]).getMinutes())}};this.funcMap.h.minute=je;var He=function(le,Qe,Tt){if(Tt=="milliseconds"){var Pt=le.getTime()%1e3+Qe,cn=Math.floor(Pt/1e3);return Pt-=cn*1e3,new Date((g.add(Math.floor(le.getTime()/1e3)+62135596800,h.Second(cn))-62135596800)*1e3+Pt)}var Lt=le.getFullYear(),Bn=le.getMonth(),Gt=le.getDate(),jr=le.getHours(),to=le.getMinutes(),or=le.getSeconds();switch(Tt){case"days":Gt+=Qe;break;case"hours":jr+=Qe;break;case"minutes":to+=Qe;break;case"months":Bn+=Qe;break;case"quarters":Bn+=Qe*3;break;case"seconds":or+=Qe;break;case"weeks":Gt+=7*Qe;break;case"years":Lt+=Qe;break;default:throw new I("")}return new Date(Lt,Bn,Gt,jr,to,or)},je={type:L.fnTy(Z,[Z,N,B]),eval:function(le){return T.VDate(He(v.asDate(le[0]),v.asNumber(le[1])|0,v.asString(le[2])))}};this.funcMap.h.dateAdd=je;var je={type:L.fnTy(Z,[Z,N,B]),eval:function(le){return T.VDate(He(v.asDate(le[0]),-(v.asNumber(le[1])|0),v.asString(le[2])))}};this.funcMap.h.dateSubtract=je;var rt=function(le,Qe,Tt){var Pt=le.getTime()%1e3-Qe.getTime()%1e3,cn=Math.floor(le.getTime()/1e3)+62135596800;Pt<0&&(Pt+=1e3,cn=g.add(cn,h.Second(-1)));var Lt=_.create(Math.floor(Qe.getTime()/1e3)+62135596800,cn),Bn=Lt.negative?-1:1,Gt;switch(Tt){case"days":Gt=Lt.getTotalDays();break;case"hours":Gt=Lt.getTotalHours();break;case"milliseconds":Gt=Lt.getTotalSeconds()*1e3+Pt;break;case"minutes":Gt=Lt.getTotalMinutes();break;case"months":Gt=P.getTotalMonthsFix(Lt);break;case"quarters":Gt=P.getTotalMonthsFix(Lt)/3;break;case"seconds":Gt=Lt.getTotalSeconds();break;case"weeks":Gt=Lt.getTotalWeeks();break;case"years":Gt=Lt.getYears();break;default:throw new I("")}return Bn*Gt},je={type:L.fnTy(N,[Z,Z,B]),eval:function(le){return T.VNumber(rt(v.asDate(le[0]),v.asDate(le[1]),v.asString(le[2])))}};this.funcMap.h.dateBetween=je,this.funcMap.h.id={type:L.fnTy(B,[]),eval:null}};L.__name__=!0,L.fnTy=function(N,B,X){return{typeVars:null,params:B,optParams:X,variadic:null,ret:N}},L.vaFnTy=function(N,B,X){return{typeVars:null,params:B,optParams:null,variadic:X,ret:N}},L.genFnTy=function(N,B,X,Z){return{typeVars:N,params:X,optParams:Z,variadic:null,ret:B}},L.prototype={findFuncDef:function(N){return this.funcMap.h[N]},findConstDef:function(N){return this.constMap.h[N]}};var O=s["formula.ExpectedKind"]={__ename__:!0,__constructs__:null,EkExpr:{_hx_name:"EkExpr",_hx_index:0,__enum__:"formula.ExpectedKind",toString:n},EkUnknown:{_hx_name:"EkUnknown",_hx_index:1,__enum__:"formula.ExpectedKind",toString:n},EkRparen:{_hx_name:"EkRparen",_hx_index:2,__enum__:"formula.ExpectedKind",toString:n}};O.__constructs__=[O.EkExpr,O.EkUnknown,O.EkRparen];var $=s["formula.Error"]={__ename__:!0,__constructs__:null,UnclosedStringLiteral:(a=function(N){return{_hx_index:0,pos:N,__enum__:"formula.Error",toString:n}},a._hx_name="UnclosedStringLiteral",a.__params__=["pos"],a),InvalidStringLiteral:(a=function(N){return{_hx_index:1,pos:N,__enum__:"formula.Error",toString:n}},a._hx_name="InvalidStringLiteral",a.__params__=["pos"],a),UnexpectedChar:(a=function(N,B){return{_hx_index:2,char:N,pos:B,__enum__:"formula.Error",toString:n}},a._hx_name="UnexpectedChar",a.__params__=["char","pos"],a),UnexpectedToken:(a=function(N,B){return{_hx_index:3,token:N,expected:B,__enum__:"formula.Error",toString:n}},a._hx_name="UnexpectedToken",a.__params__=["token","expected"],a),UnbalancedParen:(a=function(N){return{_hx_index:4,pos:N,__enum__:"formula.Error",toString:n}},a._hx_name="UnbalancedParen",a.__params__=["pos"],a),UnknownError:(a=function(N){return{_hx_index:5,pos:N,__enum__:"formula.Error",toString:n}},a._hx_name="UnknownError",a.__params__=["pos"],a),UndefinedConstant:(a=function(N,B){return{_hx_index:6,name:N,pos:B,__enum__:"formula.Error",toString:n}},a._hx_name="UndefinedConstant",a.__params__=["name","pos"],a),FunctionAsConstant:(a=function(N,B){return{_hx_index:7,name:N,pos:B,__enum__:"formula.Error",toString:n}},a._hx_name="FunctionAsConstant",a.__params__=["name","pos"],a),UndefinedFunction:(a=function(N,B){return{_hx_index:8,name:N,pos:B,__enum__:"formula.Error",toString:n}},a._hx_name="UndefinedFunction",a.__params__=["name","pos"],a),UndefinedProp:(a=function(N,B){return{_hx_index:9,name:N,pos:B,__enum__:"formula.Error",toString:n}},a._hx_name="UndefinedProp",a.__params__=["name","pos"],a),TypeMismatch:(a=function(N,B){return{_hx_index:10,expr:N,types:B,__enum__:"formula.Error",toString:n}},a._hx_name="TypeMismatch",a.__params__=["expr","types"],a),TooManyArguments:(a=function(N,B,X){return{_hx_index:11,actual:N,expected:B,pos:X,__enum__:"formula.Error",toString:n}},a._hx_name="TooManyArguments",a.__params__=["actual","expected","pos"],a),TooFewArguments:(a=function(N,B,X){return{_hx_index:12,actual:N,expected:B,pos:X,__enum__:"formula.Error",toString:n}},a._hx_name="TooFewArguments",a.__params__=["actual","expected","pos"],a)};$.__constructs__=[$.UnclosedStringLiteral,$.InvalidStringLiteral,$.UnexpectedChar,$.UnexpectedToken,$.UnbalancedParen,$.UnknownError,$.UndefinedConstant,$.FunctionAsConstant,$.UndefinedFunction,$.UndefinedProp,$.TypeMismatch,$.TooManyArguments,$.TooFewArguments];var M=e.formula.ErrorTool=function(){};M.__name__=!0,M.getPosition=function(N){switch(N._hx_index){case 0:return N.pos;case 1:return N.pos;case 2:return N.pos;case 3:return N.token.pos;case 4:return N.pos;case 5:return N.pos;case 6:return N.pos;case 7:return N.pos;case 8:return N.pos;case 9:return N.pos;case 10:return N.expr.pos;case 11:return N.pos;case 12:return N.pos}},M.reprType=function(N){switch(N._hx_index){case 0:return"数值";case 1:return"文本";case 2:return"布尔";case 3:return"日期";case 4:return"样式: style()"}},M.toString=function(N){switch(N._hx_index){case 0:return"缺少成对的引号";case 1:return"字符串语法错误";case 2:return"语法错误";case 3:return"语法错误";case 4:return"缺少成对的括号";case 5:return"语法错误";case 6:return"找不到常量`"+N.name+"`";case 7:return"`"+N.name+"`是一个函数而不是常量";case 8:return"找不到函数`"+N.name+"`";case 9:return"找不到属性`"+N.name+"`";case 10:for(var B=N.types,X=M.reprType,Z=new Array(B.length),oe=0,xe=B.length;oe<xe;){var Be=oe++;Z[Be]=X(B[Be])}return"类型错误，期望"+Z.join("或")+"类型";case 11:return"参数过多，期望"+N.expected+"个，传入"+N.actual+"个";case 12:return"参数过少，期望"+N.expected+"个，传入"+N.actual+"个"}};var U=s["formula.EvalError"]={__ename__:!0,__constructs__:null};U.__constructs__=[];var z=e.formula.EvalContext=function(){};z.__name__=!0;var K=function(N){this.ctx=N};K.__name__=!0,K.prototype={eval:function(N,B){var X=this,Z=null;Z=function(xe){for(;;){var Be=xe.desc;switch(Be._hx_index){case 0:return T.VNumber(Be.value);case 1:return T.VString(Be.value);case 2:return L.singleton.findConstDef(Be.$const);case 3:var Le=Be.fn,bt=Be.args;if(Le=="id")return T.VString(B);if(Le=="prop")return X.ctx.readProp(B,ee.getStringValue(bt[1]),xe.type);if(Le=="if"){var Ue=bt[1],He=bt[2];return v.asBoolean(Z(bt[0]))?Z(Ue):Z(He)}else if(Le=="and"){var rt=bt[1];return T.VBoolean(v.asBoolean(Z(bt[0]))&&v.asBoolean(Z(rt)))}else if(Le=="or"){var je=bt[1];return T.VBoolean(v.asBoolean(Z(bt[0]))||v.asBoolean(Z(je)))}else if(Le=="now"){var le=new Date;return T.VDate(le)}for(var Qe=new Array(bt.length),Tt=0,Pt=bt.length;Tt<Pt;){var cn=Tt++;Qe[cn]=Z(bt[cn])}return L.singleton.findFuncDef(Le).eval(Qe);case 4:xe=Be.exp;continue;case 5:var Lt=[Z(Be.arg)],Bn;switch(Be.op._hx_index){case 0:Bn="unaryPlus";break;case 1:Bn="unaryMinus";break;case 2:Bn="not";break}return L.singleton.findFuncDef(Bn).eval(Lt);case 6:var Gt=Be.arg1,jr=Be.arg2,to=[Z(Gt),Z(jr)],or;switch(Be.op._hx_index){case 0:or=Gt.type==k.TNumber?"add":"concat";break;case 1:or="subtract";break;case 2:or="multiply";break;case 3:or="divide";break;case 4:or="mod";break;case 5:or="pow";break;case 6:or="equal";break;case 7:or="unequal";break;case 8:or="smaller";break;case 9:or="smallerEq";break;case 10:or="larger";break;case 11:or="largerEq";break;case 12:or="and";break;case 13:or="or";break}return or=="and"?T.VBoolean(v.asBoolean(Z(Gt))&&v.asBoolean(Z(jr))):or=="or"?T.VBoolean(v.asBoolean(Z(Gt))||v.asBoolean(Z(jr))):L.singleton.findFuncDef(or).eval(to);case 7:if(v.asBoolean(Z(Be.test))){xe=Be.then;continue}else{xe=Be.else_;continue}}}};var oe=Z;try{return oe(N)}catch(xe){return null}}};var W=s["formula.UnOp"]={__ename__:!0,__constructs__:null,OpUnaryPlus:{_hx_name:"OpUnaryPlus",_hx_index:0,__enum__:"formula.UnOp",toString:n},OpUnaryMinus:{_hx_name:"OpUnaryMinus",_hx_index:1,__enum__:"formula.UnOp",toString:n},OpNot:{_hx_name:"OpNot",_hx_index:2,__enum__:"formula.UnOp",toString:n}};W.__constructs__=[W.OpUnaryPlus,W.OpUnaryMinus,W.OpNot];var Y=s["formula.BinOp"]={__ename__:!0,__constructs__:null,OpAdd:{_hx_name:"OpAdd",_hx_index:0,__enum__:"formula.BinOp",toString:n},OpSub:{_hx_name:"OpSub",_hx_index:1,__enum__:"formula.BinOp",toString:n},OpMul:{_hx_name:"OpMul",_hx_index:2,__enum__:"formula.BinOp",toString:n},OpDiv:{_hx_name:"OpDiv",_hx_index:3,__enum__:"formula.BinOp",toString:n},OpMod:{_hx_name:"OpMod",_hx_index:4,__enum__:"formula.BinOp",toString:n},OpPow:{_hx_name:"OpPow",_hx_index:5,__enum__:"formula.BinOp",toString:n},OpEq:{_hx_name:"OpEq",_hx_index:6,__enum__:"formula.BinOp",toString:n},OpNeq:{_hx_name:"OpNeq",_hx_index:7,__enum__:"formula.BinOp",toString:n},OpLt:{_hx_name:"OpLt",_hx_index:8,__enum__:"formula.BinOp",toString:n},OpLeq:{_hx_name:"OpLeq",_hx_index:9,__enum__:"formula.BinOp",toString:n},OpGt:{_hx_name:"OpGt",_hx_index:10,__enum__:"formula.BinOp",toString:n},OpGeq:{_hx_name:"OpGeq",_hx_index:11,__enum__:"formula.BinOp",toString:n},OpAnd:{_hx_name:"OpAnd",_hx_index:12,__enum__:"formula.BinOp",toString:n},OpOr:{_hx_name:"OpOr",_hx_index:13,__enum__:"formula.BinOp",toString:n}};Y.__constructs__=[Y.OpAdd,Y.OpSub,Y.OpMul,Y.OpDiv,Y.OpMod,Y.OpPow,Y.OpEq,Y.OpNeq,Y.OpLt,Y.OpLeq,Y.OpGt,Y.OpGeq,Y.OpAnd,Y.OpOr];var G=s["formula.ExprDesc"]={__ename__:!0,__constructs__:null,ENumber:(a=function(N){return{_hx_index:0,value:N,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="ENumber",a.__params__=["value"],a),EString:(a=function(N){return{_hx_index:1,value:N,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="EString",a.__params__=["value"],a),EConst:(a=function(N){return{_hx_index:2,$const:N,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="EConst",a.__params__=["$const"],a),ECall:(a=function(N,B,X){return{_hx_index:3,fn:N,fnPos:B,args:X,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="ECall",a.__params__=["fn","fnPos","args"],a),EParen:(a=function(N){return{_hx_index:4,exp:N,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="EParen",a.__params__=["exp"],a),EUnary:(a=function(N,B,X){return{_hx_index:5,op:N,opPos:B,arg:X,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="EUnary",a.__params__=["op","opPos","arg"],a),EBinary:(a=function(N,B,X,Z){return{_hx_index:6,op:N,opPos:B,arg1:X,arg2:Z,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="EBinary",a.__params__=["op","opPos","arg1","arg2"],a),ETernary:(a=function(N,B,X){return{_hx_index:7,test:N,then:B,else_:X,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="ETernary",a.__params__=["test","then","else_"],a)};G.__constructs__=[G.ENumber,G.EString,G.EConst,G.ECall,G.EParen,G.EUnary,G.EBinary,G.ETernary];var ee=e.formula.ExprTool=function(){};ee.__name__=!0,ee.getStringValue=function(N){var B=N.desc;return B._hx_index==1?B.value:null},ee.typeOf=function(N){return N.type},o(z.prototype,{readProp:function(N,B,X){return T.VNumber(10)}});var te=e.formula.Formula=function(){};te.__name__=!0,te.main=function(){},te.toServer=function(N,B){var X={};return{text:te.regex.map(N,function(Z){var oe=JSON.parse(Z.matched(1)),xe=B.findPropDefByName(oe);X[xe.id]=oe;var Be=new RegExp('"(?:[^\\\\"]|\\\\.)*"',"".split("u").join("")),Le=Z.matched(0),bt=JSON.stringify(xe.id);return Le.replace(Be,bt)}),refProps:X}},te.fromServer=function(N,B){return te.regex.map(N.text==null?"":N.text,function(X){var Z=JSON.parse(X.matched(1)),oe=B.findPropDefById(Z),xe=oe==null?N.refProps[Z]:oe.name,Be=new RegExp('"(?:[^\\\\"]|\\\\.)*"',"".split("u").join("")),Le=X.matched(0),bt=JSON.stringify(xe);return Le.replace(Be,bt)})},te.parse=function(N,B){var X=new ae(new se(N),B);try{return de.Ok(X.parse())}catch(Be){var Z=I.caught(Be),oe=Z.unwrap();if(Z instanceof ne)return de.Error(Z.error);if(oe instanceof kt)return de.Error($.UnexpectedToken(oe.token,O.EkUnknown));if(oe instanceof Qt)return de.Error($.UnexpectedToken(oe.token,O.EkUnknown));if(oe instanceof nn){var xe=oe;return de.Error($.UnexpectedChar(xe.char,xe.pos))}else{if(oe instanceof gt)return de.Error($.UnknownError(oe.pos));throw Be}}},te.eval=function(N,B,X){return new K(B).eval(N,X)},te.objc_parse=function(N,B){for(var X=new Te,Z=0;Z<B.length;){var oe=B[Z];++Z;var xe;switch(oe.type){case"boolean":xe=k.TBoolean;break;case"date":xe=k.TDate;break;case"number":xe=k.TNumber;break;case"string":xe=k.TString;break;default:xe=k.TString}X.defineProp(oe.id,oe.name,xe)}var Be=te.parse(N,X);return{ok:ke.isOk(Be)?ke.getOk(Be):null,error:ke.isError(Be)?M.toString(ke.getError(Be)):null}},te.objc_eval=function(N,B){var X=te.eval(N,Q.singleton,B),Z=v.toString(X),oe;switch(X._hx_index){case 0:oe="number";break;case 1:oe="string";break;case 2:oe="boolean";break;case 3:oe="date";break;case 4:oe="richtext";break}return{value:Z,type:oe}},te.objc_expr_type=function(N){switch(N.type._hx_index){case 0:return"number";case 1:return"string";case 2:return"boolean";case 3:return"date";case 4:return"richtext"}};var Q=function(){};Q.__name__=!0,Q.__super__=z,Q.prototype=o(z.prototype,{readProp:function(N,B,X){var Z=objc_read_prop(N,B);return typeof Z=="string"?T.VString(Z):typeof Z=="number"?T.VNumber(Z):typeof Z=="boolean"?T.VBoolean(Z):Z instanceof Date?T.VDate(Z):null}});var ne=function(N){I.call(this,M.toString(N)),this.error=N};ne.__name__=!0,ne.__super__=I,ne.prototype=o(I.prototype,{});var se=function(N,B){B==null&&(B="(none)"),this.cursor=0,this.input=N,this.source=B};se.__name__=!0,se.prototype={token:function(){var N=this;this.skip(new l("^[ 	\r\n]+",""));var B=this.cursor,X=function(Le){return{tok:Le,pos:new At(N.source,B,N.cursor)}};if(this.cursor==this.input.length)return X(he.TkEof);var Z=new l('(?:"([^"\\\\]|\\\\.)*"?|(0|[1-9][0-9]*)([.][0-9]+)?([eE][\\\\+\\\\-]?0|[1-9][0-9]*)?|[A-Za-z_][A-Za-z0-9_]*|\\(|\\)|\\+|\\-|\\*|/|%|\\^|==|!=|<>|<=|<|>=|>|,|\\?|:)',"");if(Z.match(this.input.substring(this.cursor))){var oe=Z.matched(0);switch(this.cursor+=Z.matchedPos().len,oe){case"!=":return X(he.TkBinOp(Y.OpNeq));case"%":return X(he.TkBinOp(Y.OpMod));case"(":return X(he.TkLparen);case")":return X(he.TkRparen);case"*":return X(he.TkBinOp(Y.OpMul));case"+":return X(he.TkBinOp(Y.OpAdd));case",":return X(he.TkComma);case"-":return X(he.TkBinOp(Y.OpSub));case"/":return X(he.TkBinOp(Y.OpDiv));case":":return X(he.TkColon);case"<":return X(he.TkBinOp(Y.OpLt));case"<=":return X(he.TkBinOp(Y.OpLeq));case"<>":return X(he.TkBinOp(Y.OpNeq));case"==":return X(he.TkBinOp(Y.OpEq));case">":return X(he.TkBinOp(Y.OpGt));case">=":return X(he.TkBinOp(Y.OpGeq));case"?":return X(he.TkQuestion);case"^":return X(he.TkBinOp(Y.OpPow));default:var xe=oe.charAt(0);if(xe=='"')if(oe.length>1&&oe.charAt(oe.length-1)=='"')try{return X(he.TkStr(JSON.parse(oe)))}catch(Le){var Be=this.cursor-Z.matchedPos().len;throw new ne($.InvalidStringLiteral(new At(this.source,Be,this.cursor)))}else{var Be=this.cursor-Z.matchedPos().len;throw new ne($.UnclosedStringLiteral(new At(this.source,Be,Be+1)))}else return xe>="0"&&xe<="9"?X(he.TkNum(parseFloat(oe))):X(he.TkIdent(oe))}}else throw new ne($.UnexpectedChar(this.input.charAt(this.cursor),new At(this.source,this.cursor,this.cursor+1)))},skip:function(N){N.match(this.input.substring(this.cursor))&&(this.cursor+=N.matchedPos().len)},curPos:function(){return new At(this.source,this.cursor,this.cursor)}};var ce=function(N){this.stream=N};ce.__name__=!0,ce.prototype={peek:function(N){this.token==null&&(this.token=new Se(this.stream.token(),null),--N);for(var B=this.token;N>0;)B.next==null&&(B.next=new Se(this.stream.token(),null)),B=B.next,--N;return B.elt},junk:function(){this.last=this.token.elt,this.token=this.token.next},curPos:function(){return this.stream.curPos()},parseSeparated:function(N,B){for(var X=[];;){try{X.push(B())}catch(Z){if(I.caught(Z).unwrap()instanceof kt)break;throw Z}if(N(this.peek(0)))this.last=this.token.elt,this.token=this.token.next;else break}return X},parseOptional:function(N){try{return N()}catch(B){if(I.caught(B).unwrap()instanceof kt)return null;throw B}},parseRepeat:function(N){for(var B=[];;)try{B.push(N())}catch(X){if(I.caught(X).unwrap()instanceof kt)return B;throw X}},parseExpect:function(N){try{return N()}catch(B){throw I.caught(B).unwrap()instanceof kt?I.thrown(new Qt(this.peek(0),this.stream.curPos())):B}},noMatch:function(){return new kt(this.stream.curPos(),this.peek(0))},unexpected:function(){throw I.thrown(new Qt(this.peek(0),this.stream.curPos()))}};var ae=function(N,B){ce.call(this,N),this.schema=B,this.typer=new Ee(B)};ae.__name__=!0,ae.punion=function(N,B){return new At(N.psource,N.pmin<B.pmin?N.pmin:B.pmin,N.pmax>B.pmax?N.pmax:B.pmax)},ae.__super__=ce,ae.prototype=o(ce.prototype,{mk:function(N,B){return{desc:N,pos:B,type:null}},mkUnary:function(N,B,X){var Z=X.desc;switch(Z._hx_index){case 6:var oe=Z.op,xe=Z.arg1;return N!=W.OpNot||this.precedence(oe).p>=7?this.mk(G.EBinary(oe,Z.opPos,this.mkUnary(N,B,xe),Z.arg2),ae.punion(B,xe.pos)):this.mk(G.EUnary(N,B,X),ae.punion(B,X.pos));case 7:return this.mk(G.ETernary(this.mkUnary(N,B,Z.test),Z.then,Z.else_),ae.punion(B,X.pos));default:return this.mk(G.EUnary(N,B,X),ae.punion(B,X.pos))}},mkBinary:function(N,B,X,Z){var oe=Z.desc;switch(oe._hx_index){case 6:var Le=oe.op,xe=oe.arg2;if(this.swap(N,Le)){var Be=this.mkBinary(N,B,X,oe.arg1);return this.mk(G.EBinary(Le,oe.opPos,Be,xe),ae.punion(Be.pos,xe.pos))}else return this.mk(G.EBinary(N,B,X,Z),ae.punion(X.pos,Z.pos));case 7:var Le=oe.else_,bt=this.mkBinary(N,B,X,oe.test);return this.mk(G.ETernary(bt,oe.then,Le),ae.punion(bt.pos,Le.pos));default:return this.mk(G.EBinary(N,B,X,Z),ae.punion(X.pos,Z.pos))}},psep:function(N,B){for(var X=[];;)try{if(X.push(B()),this.peek(0).tok==N)this.last=this.token.elt,this.token=this.token.next;else throw I.thrown(new kt(this.stream.curPos(),this.peek(0)))}catch(oe){var Z=I.caught(oe);if(Z.unwrap()instanceof kt)break;if(Z instanceof ne)break;throw oe}return X},precedence:function(N){switch(N._hx_index){case 0:case 1:return{p:3,left:!0};case 2:case 3:case 4:return{p:2,left:!0};case 5:return{p:1,left:!0};case 6:case 7:case 8:case 9:case 10:case 11:return{p:6,left:!0};case 12:case 13:return{p:7,left:!0}}},swap:function(N,B){var X=this.precedence(N),Z=this.precedence(B);return X.left?X.p<=Z.p:!1},parse:function(){var N=this.expr();if(this.peek(0).tok._hx_index==9)this.last=this.token.elt,this.token=this.token.next;else throw I.thrown(new Qt(this.peek(0),this.stream.curPos()));return this.typer.infer(N),N},expr:function(){var N=this.peek(0),B=N.pos,X=N.tok;switch(X._hx_index){case 0:return this.last=this.token.elt,this.token=this.token.next,this.exprNext(this.mk(G.ENumber(X.value),B));case 1:return this.last=this.token.elt,this.token=this.token.next,this.exprNext(this.mk(G.EString(X.value),B));case 2:this.last=this.token.elt,this.token=this.token.next;var Z=this.expr(),N=this.peek(0);if(N.tok._hx_index==3)return this.last=this.token.elt,this.token=this.token.next,this.exprNext(this.mk(G.EParen(Z),ae.punion(B,N.pos)));throw new ne($.UnbalancedParen(B));case 4:var N=X.name;if(N=="not")return this.last=this.token.elt,this.token=this.token.next,this.mkUnary(W.OpNot,B,this.expr());this.last=this.token.elt,this.token=this.token.next;var oe=this.peek(0),xe=oe.pos;if(oe.tok._hx_index==2){this.last=this.token.elt,this.token=this.token.next;var Be=this.psep(he.TkComma,ms(this,this.expr)),oe=this.peek(0);if(oe.tok._hx_index==3)return this.last=this.token.elt,this.token=this.token.next,this.exprNext(this.mk(G.ECall(N,B,Be),ae.punion(B,oe.pos)));var Le=this.peek(0);throw Le.tok==he.TkEof?new ne($.UnbalancedParen(xe)):new ne($.UnexpectedToken(Le,O.EkRparen))}else return this.exprNext(this.mk(G.EConst(N),B));case 8:switch(X.op._hx_index){case 0:return this.last=this.token.elt,this.token=this.token.next,this.mkUnary(W.OpUnaryPlus,B,this.expr());case 1:return this.last=this.token.elt,this.token=this.token.next,this.mkUnary(W.OpUnaryMinus,B,this.expr());default:throw new ne($.UnexpectedToken(this.peek(0),O.EkExpr))}default:throw new ne($.UnexpectedToken(this.peek(0),O.EkExpr))}},exprNext:function(N){var B=this.peek(0),X=B.pos,Z=B.tok;switch(Z._hx_index){case 4:switch(Z.name){case"and":return this.last=this.token.elt,this.token=this.token.next,this.mkBinary(Y.OpAnd,X,N,this.expr());case"or":return this.last=this.token.elt,this.token=this.token.next,this.mkBinary(Y.OpOr,X,N,this.expr());default:return N}case 6:this.last=this.token.elt,this.token=this.token.next;var oe=this.expr();if(this.peek(0).tok._hx_index==7){this.last=this.token.elt,this.token=this.token.next;var xe=this.expr();return this.mk(G.ETernary(N,oe,xe),ae.punion(N.pos,xe.pos))}else throw I.thrown(new Qt(this.peek(0),this.stream.curPos()));case 8:return this.last=this.token.elt,this.token=this.token.next,this.mkBinary(Z.op,X,N,this.expr());default:return N}}});var de=s["formula.Result"]={__ename__:!0,__constructs__:null,Ok:(a=function(N){return{_hx_index:0,value:N,__enum__:"formula.Result",toString:n}},a._hx_name="Ok",a.__params__=["value"],a),Error:(a=function(N){return{_hx_index:1,error:N,__enum__:"formula.Result",toString:n}},a._hx_name="Error",a.__params__=["error"],a)};de.__constructs__=[de.Ok,de.Error];var ke=e.formula.ResultTool=function(){};ke.__name__=!0,ke.isOk=function(N){switch(N._hx_index){case 0:return!0;case 1:return!1}},ke.isError=function(N){switch(N._hx_index){case 0:return!1;case 1:return!0}},ke.getOk=function(N){switch(N._hx_index){case 0:return N.value;case 1:throw new I("Invalid argument")}},ke.getError=function(N){switch(N._hx_index){case 0:throw new I("Invalid argument");case 1:return N.error}};var Te=e.formula.Schema=function(){this.byNameMap=new Ae,this.byIdMap=new Ae};Te.__name__=!0,Te.prototype={defineProp:function(N,B,X){var Z={id:N,name:B,type:X};this.byIdMap.h[N]=Z,this.byNameMap.h[B]=Z},findPropDefById:function(N){return this.byIdMap.h[N]},findPropDefByName:function(N){return this.byNameMap.h[N]}};var he=s["formula.TokenDesc"]={__ename__:!0,__constructs__:null,TkNum:(a=function(N){return{_hx_index:0,value:N,__enum__:"formula.TokenDesc",toString:n}},a._hx_name="TkNum",a.__params__=["value"],a),TkStr:(a=function(N){return{_hx_index:1,value:N,__enum__:"formula.TokenDesc",toString:n}},a._hx_name="TkStr",a.__params__=["value"],a),TkLparen:{_hx_name:"TkLparen",_hx_index:2,__enum__:"formula.TokenDesc",toString:n},TkRparen:{_hx_name:"TkRparen",_hx_index:3,__enum__:"formula.TokenDesc",toString:n},TkIdent:(a=function(N){return{_hx_index:4,name:N,__enum__:"formula.TokenDesc",toString:n}},a._hx_name="TkIdent",a.__params__=["name"],a),TkComma:{_hx_name:"TkComma",_hx_index:5,__enum__:"formula.TokenDesc",toString:n},TkQuestion:{_hx_name:"TkQuestion",_hx_index:6,__enum__:"formula.TokenDesc",toString:n},TkColon:{_hx_name:"TkColon",_hx_index:7,__enum__:"formula.TokenDesc",toString:n},TkBinOp:(a=function(N){return{_hx_index:8,op:N,__enum__:"formula.TokenDesc",toString:n}},a._hx_name="TkBinOp",a.__params__=["op"],a),TkEof:{_hx_name:"TkEof",_hx_index:9,__enum__:"formula.TokenDesc",toString:n}};he.__constructs__=[he.TkNum,he.TkStr,he.TkLparen,he.TkRparen,he.TkIdent,he.TkComma,he.TkQuestion,he.TkColon,he.TkBinOp,he.TkEof];var Ee=function(N){this.schema=N};Ee.__name__=!0,Ee.prototype={inferResult:function(N,B,X,Z){var oe=L.singleton.findFuncDef(N);if(oe==null)throw new ne($.UndefinedFunction(N,X));var xe=oe.type,Be={},Le=function(Lt,Bn){switch(Bn._hx_index){case 0:var Gt=Bn.type;if(Lt.type!=Gt)throw new ne($.TypeMismatch(Lt,[Gt]));break;case 1:var Gt=Bn.id;if(Be.hasOwnProperty(Gt)){var jr=Be[Gt];if(Lt.type!=jr)throw new ne($.TypeMismatch(Lt,[jr]))}else{var to=xe.typeVars.h[Gt];if(to!=null&&to.indexOf(Lt.type)==-1)throw new ne($.TypeMismatch(Lt,to));Be[Gt]=Lt.type}break}};if(B.length<xe.params.length)throw new ne($.TooFewArguments(B.length,xe.params.length,Z));var bt=xe.optParams==null?0:xe.optParams.length;if(B.length>xe.params.length+bt&&xe.variadic==null)throw new ne($.TooManyArguments(B.length,xe.params.length,Z));for(var Ue=xe.params,He=0;He<Ue.length;){var rt=Ue[He++];Le(B[He-1],rt)}if(xe.optParams!=null&&B.length>xe.params.length)for(var cn=xe.params.length,je=xe.params.length+bt;cn<je;){var le=cn++;Le(B[le],xe.optParams[le-xe.params.length])}if(xe.variadic!=null&&B.length>xe.params.length+bt)for(var cn=xe.params.length+bt,je=B.length;cn<je;)Le(B[cn++],xe.variadic);if(N=="prop"){var Qe=B[0],Tt=ee.getStringValue(Qe),Pt=this.schema.findPropDefByName(Tt);if(Pt==null)throw new ne($.UndefinedProp(Tt,Qe.pos));return B[1]={desc:G.EString(Pt.id),pos:Qe.pos,type:k.TString},Pt.type}var cn=xe.ret;switch(cn._hx_index){case 0:return cn.type;case 1:return Be[cn.id]}},infer:function(N){if(N.type!=null)return N.type;var B=N.desc,X;switch(B._hx_index){case 0:X=k.TNumber;break;case 1:X=k.TString;break;case 2:var Be=B.$const,Z=L.singleton.findConstDef(Be);if(Z==null)throw L.singleton.findFuncDef(Be)!=null?new ne($.FunctionAsConstant(Be,N.pos)):new ne($.UndefinedConstant(Be,N.pos));switch(Z._hx_index){case 0:X=k.TNumber;break;case 1:X=k.TString;break;case 2:X=k.TBoolean;break;case 3:X=k.TDate;break;case 4:X=k.TRichText;break}break;case 3:for(var Be=B.fn,Le=B.fnPos,bt=B.args,oe=0;oe<bt.length;)this.infer(bt[oe++]);X=this.inferResult(Be,bt,Le,N.pos);break;case 4:X=this.infer(B.exp);break;case 5:var Be=B.opPos,Le=B.arg;this.infer(Le);var xe;switch(B.op._hx_index){case 0:xe="unaryPlus";break;case 1:xe="unaryMinus";break;case 2:xe="not";break}X=this.inferResult(xe,[Le],Be,N.pos);break;case 6:var Be=B.opPos,Le=B.arg1,bt=B.arg2;this.infer(Le),this.infer(bt);var xe;switch(B.op._hx_index){case 0:xe=Le.type==k.TNumber?"add":"concat";break;case 1:xe="subtract";break;case 2:xe="multiply";break;case 3:xe="divide";break;case 4:xe="mod";break;case 5:xe="pow";break;case 6:xe="equal";break;case 7:xe="unequal";break;case 8:xe="smaller";break;case 9:xe="smallerEq";break;case 10:xe="larger";break;case 11:xe="largerEq";break;case 12:xe="and";break;case 13:xe="or";break}X=this.inferResult(xe,[Le,bt],Be,N.pos);break;case 7:var Be=B.test,Le=B.then,bt=B.else_;this.infer(Be),this.infer(Le),this.infer(bt),X=this.inferResult("if",[Be,Le,bt],null,N.pos);break}return N.type=X},check:function(){}};var ge=function(N,B,X){I.call(this,String(N),B,X),this.value=N};ge.__name__=!0,ge.__super__=I,ge.prototype=o(I.prototype,{unwrap:function(){return this.value}});var Se=function(N,B){this.elt=N,this.next=B};Se.__name__=!0;var Re=function(){this.h={}};Re.__name__=!0;var Ae=function(){this.h=Object.create(null)};Ae.__name__=!0;var Me=s["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:n},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:n}};Me.__constructs__=[Me.UTF8,Me.RawNative];var Ge=s["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:n},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:n},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:n},Custom:(a=function(N){return{_hx_index:3,e:N,__enum__:"haxe.io.Error",toString:n}},a._hx_name="Custom",a.__params__=["e"],a)};Ge.__constructs__=[Ge.Blocked,Ge.Overflow,Ge.OutsideBounds,Ge.Custom];var tt=function(N){this.current=0,this.array=N};tt.__name__=!0,tt.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]}};var gt=function(N){this.pos=N};gt.__name__=!0,gt.prototype={toString:function(){return"Parser error"}};var kt=function(N,B){gt.call(this,N),this.token=B};kt.__name__=!0,kt.__super__=gt,kt.prototype=o(gt.prototype,{toString:function(){return"No match: "+u.string(this.token)}});var At=function(N,B,X){this.psource=N,this.pmin=B,this.pmax=X};At.__name__=!0,At.union=function(N,B){return new At(N.psource,N.pmin<B.pmin?N.pmin:B.pmin,N.pmax>B.pmax?N.pmax:B.pmax)},At.prototype={toString:function(){return""+this.psource+":characters "+this.pmin+"-"+this.pmax},getLinePosition:function(N){for(var B=1,X=1,Z=0,oe=0,xe=0;xe<this.pmin;)N.b[xe]==10&&(++B,Z=xe+1),++xe;for(X=B,oe=Z,Z=xe-Z;xe<this.pmax;)N.b[xe]==10&&(++X,oe=xe+1),++xe;return oe=xe-oe,{lineMin:B,lineMax:X,posMin:Z,posMax:oe}},format:function(N){var B=this.getLinePosition(N);return B.lineMin!=B.lineMax?""+this.psource+":lines "+B.lineMin+"-"+B.lineMax:""+this.psource+":"+B.lineMin+": characters "+B.posMin+"-"+B.posMax}};var Qt=function(N,B){gt.call(this,B),this.token=N};Qt.__name__=!0,Qt.__super__=gt,Qt.prototype=o(gt.prototype,{toString:function(){return"Unexpected "+u.string(this.token)}});var nn=function(N,B){gt.call(this,B),this.char=N};nn.__name__=!0,nn.__super__=gt,nn.prototype=o(gt.prototype,{toString:function(){return"Unexpected "+this.char}});function sn(N){return N instanceof Array?new tt(N):N.iterator()}function ms(N,B){if(B==null)return null;B.__id__==null&&(B.__id__=t.$haxeUID++);var X;return N.hx__closures__==null?N.hx__closures__={}:X=N.hx__closures__[B.__id__],X==null&&(X=B.bind(N),N.hx__closures__[B.__id__]=X),X}t.$haxeUID|=0,typeof performance<"u"&&typeof performance.now=="function"&&(c.now=performance.now.bind(performance)),String.fromCodePoint==null&&(String.fromCodePoint=function(N){return N<65536?String.fromCharCode(N):String.fromCharCode((N>>10)+55232)+String.fromCharCode((N&1023)+56320)}),String.__name__=!0,Array.__name__=!0,Date.__name__="Date",S.__toStr={}.toString,i.DAY_SHORT_NAMES=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i.DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i.MONTH_SHORT_NAMES=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i.MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"],g.UNIX_EPOCH_DIFF=62135596800,g.SECONDS_IN_MINUTE=60,g.SECONDS_IN_HOUR=3600,g.SECONDS_IN_DAY=86400,g.SECONDS_IN_WEEK=604800,g.SECONDS_IN_YEAR=31536e3,g.SECONDS_IN_LEAP_YEAR=31622400,g.SECONDS_IN_3_YEARS=94608e3,g.SECONDS_IN_QUAD=126230400,g.SECONDS_IN_HALF_QUAD=63072e3,g.SECONDS_IN_HALF_QUAD_LEAP=63158400,g.SECONDS_IN_3_PART_QUAD=94694400,g.SECONDS_IN_CQUAD=12622780800,g.SECONDS_IN_CENTURY=3155673600,g.SECONDS_IN_LEAP_CENTURY=315576e4,v.numberType=k.TNumber,v.stringType=k.TString,v.booleanType=k.TBoolean,v.dateType=k.TDate,v.richTextType=k.TRichText,L.FLAG_BOLD=1,L.FLAG_UNDERLINE=2,L.FLAG_ITALICS=4,L.FLAG_CODE=8,L.FLAG_STRIKETHROUGH=16,L.FLAG_COLOR=32,L.FLAG_BACKGROUND_COLOR=64,L.STYLES=["b","u","i","c","s"],L.STYLES_FLAGS=[L.FLAG_BOLD,L.FLAG_UNDERLINE,L.FLAG_ITALICS,L.FLAG_CODE,L.FLAG_STRIKETHROUGH],L.COLORS=["grey","brown","orange","yellow","green","blue","purple","pink","red","black"],L.BACKGROUND_COLORS=function(N){for(var B,X=L.COLORS,Z=new Array(X.length),oe=0,xe=X.length;oe<xe;){var Be=oe++;Z[Be]=X[Be]+"_background"}return B=Z,B}(),L.singleton=new L,te.regex=new l('\\bprop\\s*\\(\\s*("(?:[^\\\\"]|\\\\.)*")\\s*\\)',"g"),Q.singleton=new Q,te.main()})(typeof IT<"u"?IT:typeof window<"u"?window:typeof self<"u"?self:globalThis,typeof window<"u"?window:typeof CS<"u"?CS:typeof self<"u"?self:globalThis);const et=IT.formula;AN.map(e=>{const t=e.list.map(n=>({...n,examples:n.examplesEn,description:n.descriptionEn}));return{...e,list:t}});const pn={none:"不展示",countAll:"记录数",countValue:"值数",countUniqueValue:"唯一值",countEmpty:Wa.countEmpty,countNotEmpty:Wa.countNotEmpty,percentEmpty:"未填写占比",percentNotEmpty:"已填写占比",sum:"求和",average:"平均值",median:"中位数",min:"最小值",max:"最大值",range:"范围",checked:"已完成",unchecked:"未完成",percentChecked:"已完成占比",percentUnchecked:"未完成占比",earliestDate:"最早",latestDate:"最晚",dateRange:"日期范围",showUnique:"显示 唯一值",showOrigin:"显示 原始值",deduplication:"去重"},wa=[{type:m.AggregationAction.NONE,title:pn.none},{type:m.AggregationAction.COUNT_ALL,title:pn.countAll},{type:m.AggregationAction.COUNT_VALUE,title:pn.countValue},{type:m.AggregationAction.COUNT_UNIQUE_VALUE,title:pn.countUniqueValue},{type:m.AggregationAction.COUNT_EMPTY,title:pn.countEmpty},{type:m.AggregationAction.COUNT_NOT_EMPTY,title:pn.countNotEmpty},{type:m.AggregationAction.PERCENT_EMPTY,title:pn.percentEmpty},{type:m.AggregationAction.PERCENT_NOT_EMPTY,title:pn.percentNotEmpty}],Oy=[...wa,{type:m.AggregationAction.EARLIEST_DATE,title:pn.earliestDate},{type:m.AggregationAction.LATEST_DATE,title:pn.latestDate},{type:m.AggregationAction.DATE_RANGE,title:pn.dateRange}],ice=[{type:m.AggregationAction.NONE,title:pn.none},{type:m.AggregationAction.COUNT_ALL,title:pn.countAll},{type:m.AggregationAction.CHECKED,title:pn.checked},{type:m.AggregationAction.UNCHECKED,title:pn.unchecked},{type:m.AggregationAction.PERCENT_CHECKED,title:pn.percentChecked},{type:m.AggregationAction.PERCENT_UNCHECKED,title:pn.percentUnchecked}],BM=[...wa,{type:m.AggregationAction.SUM,title:pn.sum},{type:m.AggregationAction.AVERAGE,title:pn.average},{type:m.AggregationAction.MEDIAN,title:pn.median},{type:m.AggregationAction.MIN,title:pn.min},{type:m.AggregationAction.MAX,title:pn.max},{type:m.AggregationAction.RANGE,title:pn.range}],bA={[m.CollectionSchemaType.TITLE]:wa,[m.CollectionSchemaType.TEXT]:wa,[m.CollectionSchemaType.SELECT]:wa,[m.CollectionSchemaType.MULTI_SELECT]:wa,[m.CollectionSchemaType.NUMBER]:BM,[m.CollectionSchemaType.CHECKBOX]:ice,[m.CollectionSchemaType.DATE]:Oy,[m.CollectionSchemaType.CREATED_AT]:Oy,[m.CollectionSchemaType.UPDATED_AT]:Oy,[m.CollectionSchemaType.CREATED_BY]:wa,[m.CollectionSchemaType.UPDATED_BY]:wa,[m.CollectionSchemaType.PERSON]:wa,[m.CollectionSchemaType.FILE]:wa,[m.CollectionSchemaType.URL]:wa,[m.CollectionSchemaType.EMAIL]:wa,[m.CollectionSchemaType.PHONE]:wa,[m.CollectionSchemaType.FORMULA]:wa,[m.CollectionSchemaType.RELATION]:wa,[m.CollectionSchemaType.ROLLUP]:wa},lce=(e,t)=>ni(t)?wa:(e===m.CollectionSchemaType.DATE||e===m.CollectionSchemaType.CREATED_AT||e===m.CollectionSchemaType.UPDATED_AT)&&fl(t)?Oy:BM,ni=e=>!e||e===m.AggregationAction.SHOW_UNIQUE||e===m.AggregationAction.SHOW_ORIGIN,fl=e=>e===m.AggregationAction.EARLIEST_DATE||e===m.AggregationAction.LATEST_DATE||e===m.AggregationAction.DATE_RANGE,Qc=e=>e===m.AggregationAction.SUM||e===m.AggregationAction.AVERAGE||e===m.AggregationAction.MEDIAN||e===m.AggregationAction.MIN||e===m.AggregationAction.MAX||e===m.AggregationAction.RANGE,qm=e=>e===m.AggregationAction.PERCENT_EMPTY||e===m.AggregationAction.PERCENT_NOT_EMPTY||e===m.AggregationAction.PERCENT_CHECKED||e===m.AggregationAction.PERCENT_UNCHECKED,OM=e=>fl(e)?"date":Qc(e)||e===m.AggregationAction.COUNT_ALL||e===m.AggregationAction.COUNT_VALUE||e===m.AggregationAction.COUNT_UNIQUE_VALUE||e===m.AggregationAction.COUNT_EMPTY||e===m.AggregationAction.COUNT_NOT_EMPTY||e===m.AggregationAction.CHECKED||e===m.AggregationAction.UNCHECKED?"number":"string";class tf{isEmpty(t){return t===void 0||this.isNonNullEmpty(t)}useRender(t){return null}}class cE extends tf{isNonNullEmpty(t){return t.length===0}compare(t,n){const s=t[Symbol.iterator](),a=n[Symbol.iterator]();for(;;){const o=s.next(),i=a.next();if(o.done&&i.done)return 0;if(o.done)return-1;if(i.done)return 1;const l=this.compareElement(o.value,i.value);if(l!==0)return l}}}const us=(e,t)=>(e=e==null?void 0:e.trim().toLocaleUpperCase(),t?e==="NO"||e==="否"||e==="FALSE"||e==="错":e==="YES"||e==="是"||e==="TRUE"||e==="对");class RN extends tf{fromSegments(t){return t===void 0?!1:us(t.map(n=>n.text).join(""))}toSegments(t){if(t)return[{type:m.TextType.TEXT,text:"YES",enhancer:{}}]}isNonNullEmpty(t){return t===!1}compare(t,n){return t===n?0:t?1:-1}}const cce=new RN;class MM extends tf{fromSegments(t){if(t===void 0)return;const n=t.find(s=>s.type===m.TextType.DATE||s.type===m.TextType.DATETIME);if(n!==void 0)return n.type===m.TextType.DATE?{timestamp:ue("".concat(n.startDate),Et).startOf("day").valueOf(),noTimePart:!0}:{timestamp:ue("".concat(n.startDate," ").concat(n.startTime),On).startOf("minute").valueOf(),noTimePart:!1}}toSegments(t){return t.noTimePart?[{type:m.TextType.DATE,enhancer:{},text:"@",startDate:ue(t.timestamp).format(Et)}]:[{type:m.TextType.DATETIME,enhancer:{},text:"@",startDate:ue(t.timestamp).format(Et),startTime:ue(t.timestamp).format(co)}]}isNonNullEmpty(t){return!1}compare(t,n){const s=t.timestamp-n.timestamp;return s===0?t.noTimePart===n.noTimePart?0:t.noTimePart?-1:1:s}}const dce=new MM;class UM extends cE{fromSegments(t){if(t===void 0)return;const n=t.filter(s=>s.type===m.TextType.URL&&s.fileStorageType==="internal");if(n.length!==0)return n}toSegments(t){return t}compareElement(t,n){return el(t.text,n.text)}}const uce=new UM;class PN extends tf{constructor(n){super();q(this,"optionValueToIndex");this.options=n,this.optionValueToIndex=new Map(n.map(({value:s},a)=>[s,a]))}fromSegments(n){const a=fe(n).split(/\s*,\s*/g);for(const o of a){const i=this.optionValueToIndex.get(o);if(i!==void 0)return i}}toSegments(n){const s=this.options[n];if(s!==void 0)return ht(s.value)}isNonNullEmpty(n){return n<0||n>=this.options.length}compare(n,s){return n-s}}class VM extends cE{constructor(n){super();q(this,"optionValueToIndex");this.options=n,this.optionValueToIndex=new Map(this.options.map(({value:s},a)=>[s,a]))}get elementType(){return new PN(this.options)}fromSegments(n){const a=fe(n).split(/\s*,\s*/g),o=[];for(const i of a){const l=this.optionValueToIndex.get(i);l!==void 0&&o.push(l)}if(o.length!==0)return o}toSegments(n){return ht(n.map(s=>this.options[s].value).join(", "))}compareElement(n,s){return this.elementType.compare(n,s)}}class $M extends tf{constructor(t){super(),this.format=t}fromSegments(t){return fce(fe(t))}toSegments(t){if(!this.isNonNullEmpty(t))return ht("".concat(t))}isNonNullEmpty(t){return isNaN(t)}compare(t,n){return t-n}}function fce(e){var n,s;if(e==="")return;let t=parseFloat(e);if(Number.isNaN(t)&&(t=parseFloat((s=(n=e.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:n[0])!=null?s:"")),!isNaN(t))return t}class HM extends cE{constructor(t,n){super(),this.relCollId=t,this.resolver=n}fromSegments(t){if(t===void 0)return;const n=[];for(const s of t)s.type===m.TextType.LINK_PAGE&&s.uuid!==void 0&&n.push(s.uuid);if(n.length!==0)return n}toSegments(t){return t.map(n=>({type:m.TextType.LINK_PAGE,enhancer:{},text:"@",uuid:n}))}isNonNullEmpty(t){return t.every(n=>{var s;return fe((s=this.resolver.findRecord(this.relCollId,n))==null?void 0:s.data.segments)===""})}compare(t,n){return super.compare(t.map(s=>{var a;return fe((a=this.resolver.findRecord(this.relCollId,s))==null?void 0:a.data.segments)}).filter(s=>s!==""),n.map(s=>{var a;return fe((a=this.resolver.findRecord(this.relCollId,s))==null?void 0:a.data.segments)}).filter(s=>s!==""))}compareElement(t,n){return el(t,n)}}class zM extends tf{fromSegments(t){if(t!==void 0&&t.length!==0&&!t.every(n=>n.type===m.TextType.TEXT&&n.text===""))return t}toSegments(t){return t}isNonNullEmpty(t){return fe(t)===""}compare(t,n){return el(fe(t),fe(n))}}const mce=new zM;class hce extends tf{fromSegments(t){}toSegments(t){}isNonNullEmpty(t){return!0}compare(t,n){return 0}}const iC=new hce;class qM extends tf{constructor(t){super(),this.resolver=t}fromSegments(t){var n;return(n=t==null?void 0:t.find(s=>s.type===m.TextType.USER))==null?void 0:n.uuid}toSegments(t){return[{type:m.TextType.USER,text:"@",enhancer:{},uuid:t}]}isNonNullEmpty(t){return this.resolver.findUser(t)===void 0}compare(t,n){const s=Rn(t),a=Rn(n);return el(s,a)}}class GM extends cE{constructor(t){super(),this.resolver=t}get elementType(){return new qM(this.resolver)}fromSegments(t){if(t===void 0)return;const n=[];for(const s of t)s.type===m.TextType.USER&&s.uuid!==void 0&&n.push(s.uuid);if(n.length!==0)return n}toSegments(t){return t.map(n=>({type:m.TextType.USER,enhancer:{},text:"@",uuid:n}))}compareElement(t,n){return this.elementType.compare(t,n)}}function WM(e,t,n){var a,o;const s=n.findSchema(e,t);if(s===void 0)return iC;switch(s.type){case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.PHONE:return mce;case m.CollectionSchemaType.NUMBER:return new $M(s.numberFormat);case m.CollectionSchemaType.SELECT:return new PN((a=s.options)!=null?a:[]);case m.CollectionSchemaType.MULTI_SELECT:return new VM((o=s.options)!=null?o:[]);case m.CollectionSchemaType.CHECKBOX:return cce;case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:return dce;case m.CollectionSchemaType.UPDATED_BY:case m.CollectionSchemaType.CREATED_BY:return new qM(n);case m.CollectionSchemaType.PERSON:return new GM(n);case m.CollectionSchemaType.FILE:return uce;case m.CollectionSchemaType.RELATION:return new HM(s.collectionId,n);case m.CollectionSchemaType.FORMULA:case m.CollectionSchemaType.ROLLUP:return iC;default:return iC}}function FA(e,t,n,s,a){var l;const o=a.findSchema(e,n);if(o==null)return;const i=a.findRecord(e,t);if(i!==void 0)switch(o.type){case m.CollectionSchemaType.TITLE:return s.fromSegments(i.data.segments);case m.CollectionSchemaType.CREATED_AT:return{timestamp:i.createdAt,noTimePart:!1};case m.CollectionSchemaType.UPDATED_AT:return{timestamp:i.updatedAt,noTimePart:!1};case m.CollectionSchemaType.CREATED_BY:return i.createdBy;case m.CollectionSchemaType.UPDATED_BY:return i.updatedBy;case m.CollectionSchemaType.FORMULA:case m.CollectionSchemaType.ROLLUP:return;default:return s.fromSegments((l=i.data.collectionProperties)==null?void 0:l[n])}}function pce(e,t,n){var a,o;const s=n.findSchema(e,t);if((s==null?void 0:s.type)===m.CollectionSchemaType.FORMULA)return Object.keys((o=(a=s.formula)==null?void 0:a.refProps)!=null?o:{}).filter(i=>n.findSchema(e,i)!=null).map(i=>[e,i]);if((s==null?void 0:s.type)===m.CollectionSchemaType.ROLLUP){const i=[];if(s.relationProperty!=null){i.push([e,s.relationProperty]);const l=n.findSchema(e,s.relationProperty);if((l==null?void 0:l.collectionId)!=null){const c=l.collectionId;if(s.targetProperty!=null){const d=n.findSchema(c,s.targetProperty);(d==null?void 0:d.type)===s.targetPropertyType&&i.push([c,s.targetProperty])}}}return i}return[]}function KM(e,t,n,s,a){const o=new Set,i=(l,c)=>{if(o.has("".concat(l,"/").concat(c)))return!1;if(l===e&&c===t)return!0;o.add("".concat(l,"/").concat(c));for(const d of pce(l,c,a))if(i(d[0],d[1]))return!0;return!1};return i(n,s)}const wg=Symbol("Block Scope"),Eg=Mr(void 0),YM=Symbol("Row Scope"),XM=Mr(void 0),NT="comment/discussion-",jf="#FFC408",QM=[Xr.rgb(jf).alpha(.1).toString(),Xr.rgb(jf).alpha(.2).toString(),Xr.rgb(jf).alpha(.3).toString(),Xr.rgb(jf).alpha(.4).toString(),Xr.rgb(jf).alpha(.5).toString()];Mn({backgroundColor:QM[0],textDecoration:"underline",textUnderlineOffset:"0.15em",textDecorationColor:jf});const Pc=e=>{if(e.customs==null)return[];const t=Object.keys(e.customs),n=[];for(const s of t)s.startsWith(NT)&&e.customs[s]===!0&&n.push(s.slice(NT.length));return n},LN=(e,t,n=pe())=>{var o;const s=[];if(e==null)return s;const a=n.blocks[e];if(t.noTable&&(a==null?void 0:a.type)===m.BlockType.TABLE)return s;for(const i of(o=a==null?void 0:a.discussions)!=null?o:[]){const l=n.discussions[i];l&&l.status===m.BlockStatus.NORMAL&&(t.noResolved?!(l!=null&&l.resolved):fe(l.context)==="")&&s.push(l.uuid)}return s},gce=e=>{const t=ea(Eg,wg);return Ce(n=>{var s,a;return t==null?[]:LN(t,{noTable:(s=e==null?void 0:e.noTable)!=null?s:!1,noResolved:(a=e==null?void 0:e.noResolved)!=null?a:!1},n)},[e,t])},JM=()=>{const e=ea(Eg,wg);return Ce(t=>e==null?!1:LN(e,{noTable:!1,noResolved:!0},t).length>0,[e])},ZM=e=>({["".concat(NT).concat(e)]:!0}),e8=e=>{const n=[...gce({noTable:!0}),...Pc(e)],s=Ce(a=>{const o=n.map(i=>a.discussions[i]).filter(i=>i!=null&&i.status===m.BlockStatus.NORMAL&&!i.resolved);return o.length>=5?5:o.length},[n]);return s>=1?{backgroundColor:QM[s-1],textDecoration:"underline",textUnderlineOffset:"0.15em",textDecorationColor:jf}:{}},_ce={elementMeta:{tag:"comment"},initialize:e=>{e.overrideTextComponent(t=>({format:s,className:a,...o})=>{const i=e8(s);return r.jsx(t,{className:R(a,Mn(i)),...o,format:s})})}},fa="code",Ei="link",Xi="select-inline",Au="inline-date",Gm="inline-person",ml="inline-link-page",U0="inline-mention-block",Jl="inline-equation",xm="emoji",xce="inline-link-suggest",t8={tag:Ei,hasBoundary:!1,hasContent:!0},BN={tag:fa,hasBoundary:!0,hasContent:!0,allowContentElementTags:new Set([Ei,Xi,ml,Au,Gm,Jl,xm])},yce=new RegExp("\\u{1F3F4}\\u{E0067}\\u{E0062}(?:\\u{E0077}\\u{E006C}\\u{E0073}|\\u{E0073}\\u{E0063}\\u{E0074}|\\u{E0065}\\u{E006E}\\u{E0067})\\u{E007F}|(?:\\u{1F9D1}\\u{1F3FF}\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D)?\\u{1F9D1}|\\u{1F469}\\u{1F3FF}\\u200D\\u{1F91D}\\u200D[\\u{1F468}\\u{1F469}])[\\u{1F3FB}-\\u{1F3FE}]|(?:\\u{1F9D1}\\u{1F3FE}\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D)?\\u{1F9D1}|\\u{1F469}\\u{1F3FE}\\u200D\\u{1F91D}\\u200D[\\u{1F468}\\u{1F469}])[\\u{1F3FB}-\\u{1F3FD}\\u{1F3FF}]|(?:\\u{1F9D1}\\u{1F3FD}\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D)?\\u{1F9D1}|\\u{1F469}\\u{1F3FD}\\u200D\\u{1F91D}\\u200D[\\u{1F468}\\u{1F469}])[\\u{1F3FB}\\u{1F3FC}\\u{1F3FE}\\u{1F3FF}]|(?:\\u{1F9D1}\\u{1F3FC}\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D)?\\u{1F9D1}|\\u{1F469}\\u{1F3FC}\\u200D\\u{1F91D}\\u200D[\\u{1F468}\\u{1F469}])[\\u{1F3FB}\\u{1F3FD}-\\u{1F3FF}]|(?:\\u{1F9D1}\\u{1F3FB}\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D)?\\u{1F9D1}|\\u{1F469}\\u{1F3FB}\\u200D\\u{1F91D}\\u200D[\\u{1F468}\\u{1F469}])[\\u{1F3FC}-\\u{1F3FF}]|\\u{1F468}(?:\\u{1F3FB}(?:\\u200D(?:\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D\\u{1F468}[\\u{1F3FB}-\\u{1F3FF}]|\\u{1F468}[\\u{1F3FB}-\\u{1F3FF}])|\\u{1F91D}\\u200D\\u{1F468}[\\u{1F3FC}-\\u{1F3FF}]|[\\u2695\\u2696\\u2708]\\uFE0F|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]))?|[\\u{1F3FC}-\\u{1F3FF}]\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D\\u{1F468}[\\u{1F3FB}-\\u{1F3FF}]|\\u{1F468}[\\u{1F3FB}-\\u{1F3FF}])|\\u200D(?:\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D)?\\u{1F468}|[\\u{1F468}\\u{1F469}]\\u200D(?:\\u{1F466}\\u200D\\u{1F466}|\\u{1F467}\\u200D[\\u{1F466}\\u{1F467}])|\\u{1F466}\\u200D\\u{1F466}|\\u{1F467}\\u200D[\\u{1F466}\\u{1F467}]|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F3FF}\\u200D(?:\\u{1F91D}\\u200D\\u{1F468}[\\u{1F3FB}-\\u{1F3FE}]|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F3FE}\\u200D(?:\\u{1F91D}\\u200D\\u{1F468}[\\u{1F3FB}-\\u{1F3FD}\\u{1F3FF}]|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F3FD}\\u200D(?:\\u{1F91D}\\u200D\\u{1F468}[\\u{1F3FB}\\u{1F3FC}\\u{1F3FE}\\u{1F3FF}]|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F3FC}\\u200D(?:\\u{1F91D}\\u200D\\u{1F468}[\\u{1F3FB}\\u{1F3FD}-\\u{1F3FF}]|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|(?:\\u{1F3FF}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FE}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FD}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FC}\\u200D[\\u2695\\u2696\\u2708]|\\u200D[\\u2695\\u2696\\u2708])\\uFE0F|\\u200D(?:[\\u{1F468}\\u{1F469}]\\u200D[\\u{1F466}\\u{1F467}]|[\\u{1F466}\\u{1F467}])|\\u{1F3FF}|\\u{1F3FE}|\\u{1F3FD}|\\u{1F3FC})?|(?:\\u{1F469}(?:\\u{1F3FB}\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D[\\u{1F468}\\u{1F469}]|[\\u{1F468}\\u{1F469}])|[\\u{1F3FC}-\\u{1F3FF}]\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D[\\u{1F468}\\u{1F469}]|[\\u{1F468}\\u{1F469}]))|\\u{1F9D1}[\\u{1F3FB}-\\u{1F3FF}]\\u200D\\u{1F91D}\\u200D\\u{1F9D1})[\\u{1F3FB}-\\u{1F3FF}]|\\u{1F469}\\u200D\\u{1F469}\\u200D(?:\\u{1F466}\\u200D\\u{1F466}|\\u{1F467}\\u200D[\\u{1F466}\\u{1F467}])|\\u{1F469}(?:\\u200D(?:\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D[\\u{1F468}\\u{1F469}]|[\\u{1F468}\\u{1F469}])|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F3FF}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FE}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FD}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FC}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FB}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F9D1}(?:\\u200D(?:\\u{1F91D}\\u200D\\u{1F9D1}|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F384}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F3FF}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F384}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FE}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F384}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FD}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F384}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FC}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F384}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FB}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F384}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F469}\\u200D\\u{1F466}\\u200D\\u{1F466}|\\u{1F469}\\u200D\\u{1F469}\\u200D[\\u{1F466}\\u{1F467}]|\\u{1F469}\\u200D\\u{1F467}\\u200D[\\u{1F466}\\u{1F467}]|(?:\\u{1F441}\\uFE0F\\u200D\\u{1F5E8}|\\u{1F9D1}(?:\\u{1F3FF}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FE}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FD}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FC}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FB}\\u200D[\\u2695\\u2696\\u2708]|\\u200D[\\u2695\\u2696\\u2708])|\\u{1F469}(?:\\u{1F3FF}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FE}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FD}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FC}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FB}\\u200D[\\u2695\\u2696\\u2708]|\\u200D[\\u2695\\u2696\\u2708])|\\u{1F636}\\u200D\\u{1F32B}|\\u{1F3F3}\\uFE0F\\u200D\\u26A7|\\u{1F43B}\\u200D\\u2744|(?:[\\u{1F3C3}\\u{1F3C4}\\u{1F3CA}\\u{1F46E}\\u{1F470}\\u{1F471}\\u{1F473}\\u{1F477}\\u{1F481}\\u{1F482}\\u{1F486}\\u{1F487}\\u{1F645}-\\u{1F647}\\u{1F64B}\\u{1F64D}\\u{1F64E}\\u{1F6A3}\\u{1F6B4}-\\u{1F6B6}\\u{1F926}\\u{1F935}\\u{1F937}-\\u{1F939}\\u{1F93D}\\u{1F93E}\\u{1F9B8}\\u{1F9B9}\\u{1F9CD}-\\u{1F9CF}\\u{1F9D4}\\u{1F9D6}-\\u{1F9DD}][\\u{1F3FB}-\\u{1F3FF}]|[\\u{1F46F}\\u{1F93C}\\u{1F9DE}\\u{1F9DF}])\\u200D[\\u2640\\u2642]|[\\u26F9\\u{1F3CB}\\u{1F3CC}\\u{1F575}][\\uFE0F\\u{1F3FB}-\\u{1F3FF}]\\u200D[\\u2640\\u2642]|\\u{1F3F4}\\u200D\\u2620|[\\u{1F3C3}\\u{1F3C4}\\u{1F3CA}\\u{1F46E}\\u{1F470}\\u{1F471}\\u{1F473}\\u{1F477}\\u{1F481}\\u{1F482}\\u{1F486}\\u{1F487}\\u{1F645}-\\u{1F647}\\u{1F64B}\\u{1F64D}\\u{1F64E}\\u{1F6A3}\\u{1F6B4}-\\u{1F6B6}\\u{1F926}\\u{1F935}\\u{1F937}-\\u{1F939}\\u{1F93D}\\u{1F93E}\\u{1F9B8}\\u{1F9B9}\\u{1F9CD}-\\u{1F9CF}\\u{1F9D4}\\u{1F9D6}-\\u{1F9DD}]\\u200D[\\u2640\\u2642]|[\\xA9\\xAE\\u203C\\u2049\\u2122\\u2139\\u2194-\\u2199\\u21A9\\u21AA\\u2328\\u23CF\\u23ED-\\u23EF\\u23F1\\u23F2\\u23F8-\\u23FA\\u24C2\\u25AA\\u25AB\\u25B6\\u25C0\\u25FB\\u25FC\\u2600-\\u2604\\u260E\\u2611\\u2618\\u2620\\u2622\\u2623\\u2626\\u262A\\u262E\\u262F\\u2638-\\u263A\\u2640\\u2642\\u265F\\u2660\\u2663\\u2665\\u2666\\u2668\\u267B\\u267E\\u2692\\u2694-\\u2697\\u2699\\u269B\\u269C\\u26A0\\u26A7\\u26B0\\u26B1\\u26C8\\u26CF\\u26D1\\u26D3\\u26E9\\u26F0\\u26F1\\u26F4\\u26F7\\u26F8\\u2702\\u2708\\u2709\\u270F\\u2712\\u2714\\u2716\\u271D\\u2721\\u2733\\u2734\\u2744\\u2747\\u2763\\u27A1\\u2934\\u2935\\u2B05-\\u2B07\\u3030\\u303D\\u3297\\u3299\\u{1F170}\\u{1F171}\\u{1F17E}\\u{1F17F}\\u{1F202}\\u{1F237}\\u{1F321}\\u{1F324}-\\u{1F32C}\\u{1F336}\\u{1F37D}\\u{1F396}\\u{1F397}\\u{1F399}-\\u{1F39B}\\u{1F39E}\\u{1F39F}\\u{1F3CD}\\u{1F3CE}\\u{1F3D4}-\\u{1F3DF}\\u{1F3F5}\\u{1F3F7}\\u{1F43F}\\u{1F4FD}\\u{1F549}\\u{1F54A}\\u{1F56F}\\u{1F570}\\u{1F573}\\u{1F576}-\\u{1F579}\\u{1F587}\\u{1F58A}-\\u{1F58D}\\u{1F5A5}\\u{1F5A8}\\u{1F5B1}\\u{1F5B2}\\u{1F5BC}\\u{1F5C2}-\\u{1F5C4}\\u{1F5D1}-\\u{1F5D3}\\u{1F5DC}-\\u{1F5DE}\\u{1F5E1}\\u{1F5E3}\\u{1F5E8}\\u{1F5EF}\\u{1F5F3}\\u{1F5FA}\\u{1F6CB}\\u{1F6CD}-\\u{1F6CF}\\u{1F6E0}-\\u{1F6E5}\\u{1F6E9}\\u{1F6F0}\\u{1F6F3}])\\uFE0F|\\u{1F3F3}\\uFE0F\\u200D\\u{1F308}|\\u{1F469}\\u200D\\u{1F467}|\\u{1F469}\\u200D\\u{1F466}|\\u{1F635}\\u200D\\u{1F4AB}|\\u{1F62E}\\u200D\\u{1F4A8}|\\u{1F415}\\u200D\\u{1F9BA}|\\u{1F9D1}(?:\\u{1F3FF}|\\u{1F3FE}|\\u{1F3FD}|\\u{1F3FC}|\\u{1F3FB})?|\\u{1F469}(?:\\u{1F3FF}|\\u{1F3FE}|\\u{1F3FD}|\\u{1F3FC}|\\u{1F3FB})?|\\u{1F1FD}\\u{1F1F0}|\\u{1F1F6}\\u{1F1E6}|\\u{1F1F4}\\u{1F1F2}|\\u{1F408}\\u200D\\u2B1B|\\u2764\\uFE0F\\u200D[\\u{1F525}\\u{1FA79}]|\\u{1F441}\\uFE0F|\\u{1F3F3}\\uFE0F|\\u{1F1FF}[\\u{1F1E6}\\u{1F1F2}\\u{1F1FC}]|\\u{1F1FE}[\\u{1F1EA}\\u{1F1F9}]|\\u{1F1FC}[\\u{1F1EB}\\u{1F1F8}]|\\u{1F1FB}[\\u{1F1E6}\\u{1F1E8}\\u{1F1EA}\\u{1F1EC}\\u{1F1EE}\\u{1F1F3}\\u{1F1FA}]|\\u{1F1FA}[\\u{1F1E6}\\u{1F1EC}\\u{1F1F2}\\u{1F1F3}\\u{1F1F8}\\u{1F1FE}\\u{1F1FF}]|\\u{1F1F9}[\\u{1F1E6}\\u{1F1E8}\\u{1F1E9}\\u{1F1EB}-\\u{1F1ED}\\u{1F1EF}-\\u{1F1F4}\\u{1F1F7}\\u{1F1F9}\\u{1F1FB}\\u{1F1FC}\\u{1F1FF}]|\\u{1F1F8}[\\u{1F1E6}-\\u{1F1EA}\\u{1F1EC}-\\u{1F1F4}\\u{1F1F7}-\\u{1F1F9}\\u{1F1FB}\\u{1F1FD}-\\u{1F1FF}]|\\u{1F1F7}[\\u{1F1EA}\\u{1F1F4}\\u{1F1F8}\\u{1F1FA}\\u{1F1FC}]|\\u{1F1F5}[\\u{1F1E6}\\u{1F1EA}-\\u{1F1ED}\\u{1F1F0}-\\u{1F1F3}\\u{1F1F7}-\\u{1F1F9}\\u{1F1FC}\\u{1F1FE}]|\\u{1F1F3}[\\u{1F1E6}\\u{1F1E8}\\u{1F1EA}-\\u{1F1EC}\\u{1F1EE}\\u{1F1F1}\\u{1F1F4}\\u{1F1F5}\\u{1F1F7}\\u{1F1FA}\\u{1F1FF}]|\\u{1F1F2}[\\u{1F1E6}\\u{1F1E8}-\\u{1F1ED}\\u{1F1F0}-\\u{1F1FF}]|\\u{1F1F1}[\\u{1F1E6}-\\u{1F1E8}\\u{1F1EE}\\u{1F1F0}\\u{1F1F7}-\\u{1F1FB}\\u{1F1FE}]|\\u{1F1F0}[\\u{1F1EA}\\u{1F1EC}-\\u{1F1EE}\\u{1F1F2}\\u{1F1F3}\\u{1F1F5}\\u{1F1F7}\\u{1F1FC}\\u{1F1FE}\\u{1F1FF}]|\\u{1F1EF}[\\u{1F1EA}\\u{1F1F2}\\u{1F1F4}\\u{1F1F5}]|\\u{1F1EE}[\\u{1F1E8}-\\u{1F1EA}\\u{1F1F1}-\\u{1F1F4}\\u{1F1F6}-\\u{1F1F9}]|\\u{1F1ED}[\\u{1F1F0}\\u{1F1F2}\\u{1F1F3}\\u{1F1F7}\\u{1F1F9}\\u{1F1FA}]|\\u{1F1EC}[\\u{1F1E6}\\u{1F1E7}\\u{1F1E9}-\\u{1F1EE}\\u{1F1F1}-\\u{1F1F3}\\u{1F1F5}-\\u{1F1FA}\\u{1F1FC}\\u{1F1FE}]|\\u{1F1EB}[\\u{1F1EE}-\\u{1F1F0}\\u{1F1F2}\\u{1F1F4}\\u{1F1F7}]|\\u{1F1EA}[\\u{1F1E6}\\u{1F1E8}\\u{1F1EA}\\u{1F1EC}\\u{1F1ED}\\u{1F1F7}-\\u{1F1FA}]|\\u{1F1E9}[\\u{1F1EA}\\u{1F1EC}\\u{1F1EF}\\u{1F1F0}\\u{1F1F2}\\u{1F1F4}\\u{1F1FF}]|\\u{1F1E8}[\\u{1F1E6}\\u{1F1E8}\\u{1F1E9}\\u{1F1EB}-\\u{1F1EE}\\u{1F1F0}-\\u{1F1F5}\\u{1F1F7}\\u{1F1FA}-\\u{1F1FF}]|\\u{1F1E7}[\\u{1F1E6}\\u{1F1E7}\\u{1F1E9}-\\u{1F1EF}\\u{1F1F1}-\\u{1F1F4}\\u{1F1F6}-\\u{1F1F9}\\u{1F1FB}\\u{1F1FC}\\u{1F1FE}\\u{1F1FF}]|\\u{1F1E6}[\\u{1F1E8}-\\u{1F1EC}\\u{1F1EE}\\u{1F1F1}\\u{1F1F2}\\u{1F1F4}\\u{1F1F6}-\\u{1F1FA}\\u{1F1FC}\\u{1F1FD}\\u{1F1FF}]|[#\\*0-9]\\uFE0F\\u20E3|\\u2764\\uFE0F|[\\u{1F3C3}\\u{1F3C4}\\u{1F3CA}\\u{1F46E}\\u{1F470}\\u{1F471}\\u{1F473}\\u{1F477}\\u{1F481}\\u{1F482}\\u{1F486}\\u{1F487}\\u{1F645}-\\u{1F647}\\u{1F64B}\\u{1F64D}\\u{1F64E}\\u{1F6A3}\\u{1F6B4}-\\u{1F6B6}\\u{1F926}\\u{1F935}\\u{1F937}-\\u{1F939}\\u{1F93D}\\u{1F93E}\\u{1F9B8}\\u{1F9B9}\\u{1F9CD}-\\u{1F9CF}\\u{1F9D4}\\u{1F9D6}-\\u{1F9DD}][\\u{1F3FB}-\\u{1F3FF}]|[\\u26F9\\u{1F3CB}\\u{1F3CC}\\u{1F575}][\\uFE0F\\u{1F3FB}-\\u{1F3FF}]|\\u{1F3F4}|[\\u270A\\u270B\\u{1F385}\\u{1F3C2}\\u{1F3C7}\\u{1F442}\\u{1F443}\\u{1F446}-\\u{1F450}\\u{1F466}\\u{1F467}\\u{1F46B}-\\u{1F46D}\\u{1F472}\\u{1F474}-\\u{1F476}\\u{1F478}\\u{1F47C}\\u{1F483}\\u{1F485}\\u{1F48F}\\u{1F491}\\u{1F4AA}\\u{1F57A}\\u{1F595}\\u{1F596}\\u{1F64C}\\u{1F64F}\\u{1F6C0}\\u{1F6CC}\\u{1F90C}\\u{1F90F}\\u{1F918}-\\u{1F91C}\\u{1F91E}\\u{1F91F}\\u{1F930}-\\u{1F934}\\u{1F936}\\u{1F977}\\u{1F9B5}\\u{1F9B6}\\u{1F9BB}\\u{1F9D2}\\u{1F9D3}\\u{1F9D5}][\\u{1F3FB}-\\u{1F3FF}]|[\\u261D\\u270C\\u270D\\u{1F574}\\u{1F590}][\\uFE0F\\u{1F3FB}-\\u{1F3FF}]|[\\u270A\\u270B\\u{1F385}\\u{1F3C2}\\u{1F3C7}\\u{1F408}\\u{1F415}\\u{1F43B}\\u{1F442}\\u{1F443}\\u{1F446}-\\u{1F450}\\u{1F466}\\u{1F467}\\u{1F46B}-\\u{1F46D}\\u{1F472}\\u{1F474}-\\u{1F476}\\u{1F478}\\u{1F47C}\\u{1F483}\\u{1F485}\\u{1F48F}\\u{1F491}\\u{1F4AA}\\u{1F57A}\\u{1F595}\\u{1F596}\\u{1F62E}\\u{1F635}\\u{1F636}\\u{1F64C}\\u{1F64F}\\u{1F6C0}\\u{1F6CC}\\u{1F90C}\\u{1F90F}\\u{1F918}-\\u{1F91C}\\u{1F91E}\\u{1F91F}\\u{1F930}-\\u{1F934}\\u{1F936}\\u{1F977}\\u{1F9B5}\\u{1F9B6}\\u{1F9BB}\\u{1F9D2}\\u{1F9D3}\\u{1F9D5}]|[\\u{1F3C3}\\u{1F3C4}\\u{1F3CA}\\u{1F46E}\\u{1F470}\\u{1F471}\\u{1F473}\\u{1F477}\\u{1F481}\\u{1F482}\\u{1F486}\\u{1F487}\\u{1F645}-\\u{1F647}\\u{1F64B}\\u{1F64D}\\u{1F64E}\\u{1F6A3}\\u{1F6B4}-\\u{1F6B6}\\u{1F926}\\u{1F935}\\u{1F937}-\\u{1F939}\\u{1F93D}\\u{1F93E}\\u{1F9B8}\\u{1F9B9}\\u{1F9CD}-\\u{1F9CF}\\u{1F9D4}\\u{1F9D6}-\\u{1F9DD}]|[\\u{1F46F}\\u{1F93C}\\u{1F9DE}\\u{1F9DF}]|[\\u231A\\u231B\\u23E9-\\u23EC\\u23F0\\u23F3\\u25FD\\u25FE\\u2614\\u2615\\u2648-\\u2653\\u267F\\u2693\\u26A1\\u26AA\\u26AB\\u26BD\\u26BE\\u26C4\\u26C5\\u26CE\\u26D4\\u26EA\\u26F2\\u26F3\\u26F5\\u26FA\\u26FD\\u2705\\u2728\\u274C\\u274E\\u2753-\\u2755\\u2757\\u2795-\\u2797\\u27B0\\u27BF\\u2B1B\\u2B1C\\u2B50\\u2B55\\u{1F004}\\u{1F0CF}\\u{1F18E}\\u{1F191}-\\u{1F19A}\\u{1F201}\\u{1F21A}\\u{1F22F}\\u{1F232}-\\u{1F236}\\u{1F238}-\\u{1F23A}\\u{1F250}\\u{1F251}\\u{1F300}-\\u{1F320}\\u{1F32D}-\\u{1F335}\\u{1F337}-\\u{1F37C}\\u{1F37E}-\\u{1F384}\\u{1F386}-\\u{1F393}\\u{1F3A0}-\\u{1F3C1}\\u{1F3C5}\\u{1F3C6}\\u{1F3C8}\\u{1F3C9}\\u{1F3CF}-\\u{1F3D3}\\u{1F3E0}-\\u{1F3F0}\\u{1F3F8}-\\u{1F407}\\u{1F409}-\\u{1F414}\\u{1F416}-\\u{1F43A}\\u{1F43C}-\\u{1F43E}\\u{1F440}\\u{1F444}\\u{1F445}\\u{1F451}-\\u{1F465}\\u{1F46A}\\u{1F479}-\\u{1F47B}\\u{1F47D}-\\u{1F480}\\u{1F484}\\u{1F488}-\\u{1F48E}\\u{1F490}\\u{1F492}-\\u{1F4A9}\\u{1F4AB}-\\u{1F4FC}\\u{1F4FF}-\\u{1F53D}\\u{1F54B}-\\u{1F54E}\\u{1F550}-\\u{1F567}\\u{1F5A4}\\u{1F5FB}-\\u{1F62D}\\u{1F62F}-\\u{1F634}\\u{1F637}-\\u{1F644}\\u{1F648}-\\u{1F64A}\\u{1F680}-\\u{1F6A2}\\u{1F6A4}-\\u{1F6B3}\\u{1F6B7}-\\u{1F6BF}\\u{1F6C1}-\\u{1F6C5}\\u{1F6D0}-\\u{1F6D2}\\u{1F6D5}-\\u{1F6D7}\\u{1F6EB}\\u{1F6EC}\\u{1F6F4}-\\u{1F6FC}\\u{1F7E0}-\\u{1F7EB}\\u{1F90D}\\u{1F90E}\\u{1F910}-\\u{1F917}\\u{1F91D}\\u{1F920}-\\u{1F925}\\u{1F927}-\\u{1F92F}\\u{1F93A}\\u{1F93F}-\\u{1F945}\\u{1F947}-\\u{1F976}\\u{1F978}\\u{1F97A}-\\u{1F9B4}\\u{1F9B7}\\u{1F9BA}\\u{1F9BC}-\\u{1F9CB}\\u{1F9D0}\\u{1F9E0}-\\u{1F9FF}\\u{1FA70}-\\u{1FA74}\\u{1FA78}-\\u{1FA7A}\\u{1FA80}-\\u{1FA86}\\u{1FA90}-\\u{1FAA8}\\u{1FAB0}-\\u{1FAB6}\\u{1FAC0}-\\u{1FAC2}\\u{1FAD0}-\\u{1FAD6}]","u"),n8=new RegExp(yce.source,"ug"),bce=(e,t)=>e.type!==m.TextType.TEXT||t.type!==m.TextType.TEXT||!ol(e.discussions)||!ol(t.discussions)?!1:El(e.enhancer,t.enhancer),ON=e=>{const t=[];let n=!1,s;return e.forEach(a=>{var o,i;if(a.type!==m.TextType.TEXT)t.push({...a});else{let l,c,d=0;const u=(o=a.text)!=null?o:"";for(;(l=n8.exec(u))!=null;){const f=l[0];f&&(c=u.slice(d,l.index),d=l.index+f.length,c&&t.push({...a,text:c}),t.push({...a,type:m.TextType.EMOJI,text:f}),n=!0)}if(d===0&&s&&bce(s,a)){const f=t.pop();t.push({...a,text:((i=f==null?void 0:f.text)!=null?i:"")+a.text})}else{const f=u.slice(d,u.length);f&&t.push({...a,text:f})}}s=a}),{wrapSegments:t,hasNewEmoji:n}},Fce=e=>{const t=[];let n;for(const s of e){const a={...s,enhancer:{...s.enhancer}};let o=!1;a.type===m.TextType.EMOJI&&(a.type=m.TextType.TEXT,(n==null?void 0:n.type)===m.TextType.TEXT&&El(n.enhancer,a.enhancer)&&(n.text+=a.text,o=!0)),o||(n=a,t.push(n))}return t},mi=e=>{if(e!==void 0&&(e=e.filter(t=>!(t.type===m.TextType.TEXT&&t.text==="")),e.length!==0))return e},ud=e=>{let t;if(e.type===m.TextType.DATETIME){const n=ue("".concat(e.startDate," ").concat(e.startTime),On).startOf("minute");t=n.isValid()?n.toDate():ue().toDate()}else if(e.type===m.TextType.DATE){const n=ue("".concat(e.startDate),Et).startOf("day");t=n.isValid()?n.toDate():ue().toDate()}else t=ue().toDate();return t},wce=e=>{const t=(e!=null?e:[]).find(n=>n.type===m.TextType.DATE||n.type===m.TextType.DATETIME);return t&&ud(t).getTime()},jT=e=>{var s,a;const t=fe(e);let n=parseFloat(t);return Number.isNaN(n)&&(n=parseFloat((a=(s=t.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:s[0])!=null?a:"")),isNaN(n)?void 0:n},Gn=(e,t={})=>{let n;return ue(e.from).isValid()&&(n=ue(e.from).format(Et)),{type:e.includeTime?m.TextType.DATETIME:m.TextType.DATE,enhancer:t,text:"‣",startDate:n,startTime:ue(e.from).format(co),dateFormat:e.dateFormat,timeFormat:e.timeFormat,reminder:e.reminder}},Ece=e=>{const t=(e!=null?e:[]).filter(n=>n.type===m.TextType.USER&&n.uuid!=null).map(n=>n.uuid);if(t.length!==0)return t},Ru=(e,t={})=>({type:m.TextType.USER,enhancer:t,text:"",uuid:e}),Cce=(e,t={})=>({type:m.TextType.EQUATION,enhancer:t,text:e!=null?e:""}),qi=e=>{const{enhancer:t,discussions:n}=e,s={};for(const a of n!=null?n:[]){const o=ZM(a);Object.assign(s,o)}return{bold:t==null?void 0:t.bold,backgroundColor:t==null?void 0:t.backgroundColor,italic:t==null?void 0:t.italic,lineThrough:t==null?void 0:t.lineThrough,color:(t==null?void 0:t.textColor)||"",underline:t==null?void 0:t.underline,customs:s}},Ki=e=>e===!0?!0:void 0,xf=e=>e.length===0?void 0:e,yf=e=>{var t;return{bold:Ki(e.bold),italic:Ki(e.italic),underline:Ki(e.underline),lineThrough:Ki(e.lineThrough),textColor:e.color||void 0,backgroundColor:(t=e.backgroundColor)!=null?t:void 0}},mr=e=>s8(e,!0).unwrapSegments;function s8(e,t){const n=[],s=o=>{var l;const i=(l=n[n.length-1])!=null?l:null;i===null?n.push({type:m.TextType.TEXT,text:o,enhancer:{}}):i.text+=o},a=(o,i)=>{var c,d,u,f,h,p,g,_,x,F,b,w,E,C,k,T;const l=v=>i.find(I=>I.tag===v);for(const v of o.items)if(v.type==="element")v.tag===Xi?s("@"):v.tag===Au?n.push({...Gn({from:new Date(v.props.datetime),dateFormat:v.props.dateFormat,timeFormat:v.props.timeFormat,includeTime:v.props.includeTime,reminder:v.props.reminder},{...yf((c=v.props.textFormat)!=null?c:{}),code:Ki(l(fa)!==void 0)}),discussions:xf(Pc((d=v.props.textFormat)!=null?d:{}))}):v.tag===ml?n.push({type:m.TextType.LINK_PAGE,enhancer:{...yf((u=v.props.textFormat)!=null?u:{}),code:Ki(l(fa)!==void 0)},text:"",uuid:v.props.pageId,discussions:xf(Pc((f=v.props.textFormat)!=null?f:{}))}):v.tag===U0?n.push({type:m.TextType.MENTION_BLOCK,enhancer:{...yf((h=v.props.textFormat)!=null?h:{}),code:Ki(l(fa)!==void 0)},text:(p=v.props.text)!=null?p:"",uuid:v.props.blockId,discussions:xf(Pc((g=v.props.textFormat)!=null?g:{}))}):v.tag===Gm?n.push({...Ru(v.props.userId,{...yf((_=v.props.textFormat)!=null?_:{}),code:Ki(l(fa)!==void 0)}),discussions:xf(Pc((x=v.props.textFormat)!=null?x:{}))}):v.tag===Jl&&v.props.text&&n.push({...Cce(v.props.text,{...yf((F=v.props.textFormat)!=null?F:{}),code:Ki(l(fa)!==void 0)}),discussions:xf(Pc((b=v.props.textFormat)!=null?b:{}))}),v.tag===xm?n.push({type:m.TextType.EMOJI,text:(w=v.props.text)!=null?w:"",enhancer:{...yf((E=v.props.textFormat)!=null?E:{}),code:Ki(l(fa)!==void 0)},discussions:xf(Pc((C=v.props.textFormat)!=null?C:{}))}):v.content!==null&&a(v.content,[...i,v]);else{const I=l(Ei),j={type:I!==void 0?m.TextType.URL:m.TextType.TEXT,text:(k=v.content)!=null?k:"",enhancer:{...yf(v.format),code:Ki(l(fa)!==void 0)},discussions:xf(Pc(v.format)),...(T=I==null?void 0:I.props)!=null?T:{}};n.push(j)}};return a(e,[]),t?{unwrapSegments:Fce(n),segments:n}:{unwrapSegments:[],segments:n}}const lC=new WeakMap,kce=Wn([]),x1=e=>{var i,l,c,d,u,f,h;if(e==null)return kce;if(lC.has(e))return lC.get(e);const t=[];let n=null;const s=p=>{n!==null&&n.type==="element"&&n.content!==null&&n.tag===Ei&&p.type==="element"&&p.content!==null&&p.tag===Ei&&El(p.props,n.props)?n.content=DW(n.content,p.content):(t.push(p),n=p)},{wrapSegments:a}=ON(e);for(const p of a){let g;if(p.type===m.TextType.DATE||p.type===6){const _=ud(p);g=Is(Au,{datetime:_.getTime(),includeTime:p.type===6,dateFormat:p.dateFormat,timeFormat:p.timeFormat,textFormat:qi(p),reminder:p.reminder})}else if(p.type===m.TextType.USER)g=Is(Gm,{userId:p.uuid,textFormat:qi(p)});else if(p.type===m.TextType.LINK_PAGE)g=Is(ml,{pageId:p.uuid,textFormat:qi(p)});else if(p.type===m.TextType.MENTION_BLOCK){const _=ks((i=p.uuid)!=null?i:"");tn((c=J.blocks[(l=p.uuid)!=null?l:""])==null?void 0:c.type)?g=Is(ml,{pageId:p.uuid,textFormat:qi(p)}):g=Is(U0,{pageId:_,blockId:p.uuid,textFormat:qi(p),text:(d=p.text)!=null?d:""})}else if(p.type===m.TextType.EQUATION)g=Is(Jl,{text:(u=p.text)!=null?u:"",textFormat:qi(p)});else if(p.type===m.TextType.EMOJI)g=Is(xm,{text:(f=p.text)!=null?f:"",textFormat:qi(p)});else if(p.type==="suggest")g=Is(xce,{pageId:p.uuid,textFormat:qi(p)});else{const _=qi(p);try{g=ti(p.text,_)}catch(x){g=ti("�",_)}p.type===m.TextType.URL&&(g=Is(Ei,{url:p.url,fileStorageType:p.fileStorageType,width:p.width,height:p.height,textFormat:qi(p)},Wn([g])))}(h=p==null?void 0:p.enhancer)!=null&&h.code&&(g=Is(fa,{},Wn([g]))),s(g)}const o=Wn(t);return lC.set(e,o),o},Tce=function*(e){if(e!==void 0)for(const t of e)t.discussions!==void 0&&(yield*pf(t.discussions))},vce=function(e,t){return e==null?e:Yn(e,n=>{for(const s of n)if(s.discussions!=null){const a=s.discussions.indexOf(t);a>=0&&s.discussions.splice(a)}})},wA=function(e){return e==null?e:Yn(e,t=>{for(const n of t)n.discussions!=null&&(n.discussions=void 0)})},lo=(e,t=2)=>String((e*100).toFixed(t)).concat("%"),V0=e=>{var s,a;const t=(s=e.split("%")[0])!=null?s:"";if(!t)return 0;const n=Math.pow(10,((a=t.split(".")[1])!=null?a:"").length);return Number(t)*n/(100*n)},ST=e=>String(e).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),r8=e=>/^[-0-9+() ]+$/.test("".concat(e)),dE=e=>{const t=e.toString(),n=t.lastIndexOf("."),s=t.length-n-1;if(n>=0&&s>=10){const a=Math.max(10,s-6),o=Math.pow(10,a),i="".concat(Math.round(e*o)/o);return t.length-i.length>=s-12&&t.length-i.length>=4?i:"".concat(Math.round(e*1e12)/1e12)}return a8(Number(t))},a8=e=>{const t=e.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);if(!t)return"".concat(e);const n=Number(t[2])||0;return Math.abs(n)>20?"".concat(e):e.toFixed(Math.max(0,(t[1]||"").length-n))};let o8;const Ice=e=>{o8=e},Nce=(...e)=>o8(...e);class jce extends et.EvalContext{constructor(t=pe){super(),this.getState=t}readProp(t,n){var u,f,h,p,g,_;const s=this.getState(),{blocks:a}=s,o=a[t];if(o==null)return null;const i=o.parentId,l=a[i];if(l==null)return null;const c=(u=l.data.schema)==null?void 0:u[n];if(c==null)return null;if(c.type===m.CollectionSchemaType.FORMULA)return $n(i).getBoxedValue(t,n);if(c.type===m.CollectionSchemaType.ROLLUP){const{dateStartTimestamp:x,dateEndTimestamp:F,aggregationValue:b,originValues:w,originValueToStringFunc:E}=(f=Nce(t,n))!=null?f:{};if(ni(c.aggregation))return et.ValueTool.string((h=w==null?void 0:w.map(C=>E==null?void 0:E(C)).join(", "))!=null?h:"");if(fl(c.aggregation)){if(c.aggregation===m.AggregationAction.DATE_RANGE)return x==null?null:et.ValueTool.string("".concat(ue(x).format(On)," - ").concat(ue(F).format(On)));const C=ue(x);return x!==void 0&&C.isValid()?et.ValueTool.date(C.toDate()):null}else if(qm(c.aggregation))return typeof b=="string"?et.ValueTool.number(V0(b)):null;return et.ValueTool.number(Number(b))}if(c.type===m.CollectionSchemaType.CREATED_AT)return o.createdAt==null?null:et.ValueTool.date(new Date(o.createdAt));if(c.type===m.CollectionSchemaType.UPDATED_AT)return o.updatedAt==null?null:et.ValueTool.date(new Date(o.updatedAt));if(c.type===m.CollectionSchemaType.CREATED_BY){const x=o.createdBy==null?"":Rn(o.createdBy);return et.ValueTool.string(x)}if(c.type===m.CollectionSchemaType.UPDATED_BY){const x=o.updatedBy==null?"":Rn(o.updatedBy);return et.ValueTool.string(x)}const d=c.type===m.CollectionSchemaType.TITLE?o.data.segments:(p=o.data.collectionProperties)==null?void 0:p[n];if(c.type===m.CollectionSchemaType.CHECKBOX)return et.ValueTool.boolean(us(fe(d)));if(c.type===m.CollectionSchemaType.NUMBER){const x=fe(d);let F=parseFloat(x);return Number.isNaN(F)&&(F=parseFloat((_=(g=x.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:g[0])!=null?_:"")),Number.isNaN(F)?et.ValueTool.number(0):et.ValueTool.number(F)}if(c.type===m.CollectionSchemaType.DATE){if(d==null)return null;const x=d.find(b=>b.type===m.TextType.DATE||b.type===m.TextType.DATETIME);if(x==null)return null;const F=ud(x);return ue(F).isValid()?et.ValueTool.date(F):null}if(c.type===m.CollectionSchemaType.PERSON){const x=(d!=null?d:[]).filter(F=>F.type===m.TextType.USER).map(F=>F.uuid==null?"":Rn(F.uuid)).join(", ");return et.ValueTool.string(x)}if(c.type===m.CollectionSchemaType.FILE){const x=(d!=null?d:[]).filter(F=>F.type===m.TextType.URL&&F.fileStorageType==="internal").map(F=>F.text).join(", ");return et.ValueTool.string(x)}if(c.type===m.CollectionSchemaType.MULTI_SELECT){const x=fe(d);return et.ValueTool.string(x.replace(/\s*,\s*/g,", "))}return et.ValueTool.string(fe(d))}}const Sce=(e,t,n,s)=>{const a=t!=null?t:{},o=new et.Schema;for(const[g,_]of Object.entries(a))o.defineProp(g,_.name,null);const i=g=>{try{return et.Formula.fromServer(g,o)}catch(_){return console.warn(_),""}},l=g=>{const _=new Set;for(const[x]of Object.entries(a))KM(e,g,e,x,n)||_.add(x);return _},c=new Map,d=g=>{const _=new et.Schema;for(const x of g){const F=a[x];if(F!=null)if(F.type===m.CollectionSchemaType.FORMULA){const b=c.get(x);_.defineProp(x,F.name,b==null?et.ValueTool.stringType:et.ExprTool.typeOf(b))}else F.type===m.CollectionSchemaType.ROLLUP?ni(F.aggregation)?_.defineProp(x,F.name,et.ValueTool.stringType):fl(F.aggregation)?F.aggregation===m.AggregationAction.DATE_RANGE?_.defineProp(x,F.name,et.ValueTool.stringType):_.defineProp(x,F.name,et.ValueTool.dateType):_.defineProp(x,F.name,et.ValueTool.numberType):F.type===m.CollectionSchemaType.NUMBER?_.defineProp(x,F.name,et.ValueTool.numberType):F.type===m.CollectionSchemaType.DATE||F.type===m.CollectionSchemaType.CREATED_AT||F.type===m.CollectionSchemaType.UPDATED_AT?_.defineProp(x,F.name,et.ValueTool.dateType):F.type===m.CollectionSchemaType.CHECKBOX?_.defineProp(x,F.name,et.ValueTool.booleanType):_.defineProp(x,F.name,et.ValueTool.stringType)}return _},u=g=>{const _=a[g];if(_==null||_.type!==m.CollectionSchemaType.FORMULA||c.has(g))return;const x=()=>{c.set(g,null)};if(_.formula==null)return x();const F=_.formula,b=l(g),w=Object.keys(F.refProps);if(!w.every(v=>b.has(v)))return x();for(const v of w)u(v);const E=d(b),C=i(F),k=et.Formula.parse(C,E);if(et.ResultTool.isError(k))return x();const T=et.ResultTool.getOk(k);c.set(g,T)};for(const g of Object.keys(a))u(g);const f=(g,_)=>{if(!c.has(_))return s.readProp(g,_);const x=c.get(_);return x==null?null:et.Formula.eval(x,s,g)},h=(g,_)=>{const x=f(g,_);if(x==null)return null;const F=et.ValueTool.typeOf(x);return F===et.ValueTool.numberType?et.ValueTool.asNumber(x):F===et.ValueTool.stringType?et.ValueTool.asString(x):F===et.ValueTool.booleanType?et.ValueTool.asBoolean(x):F===et.ValueTool.dateType?et.ValueTool.asDate(x):null},p=g=>{const _=c.get(g);return _==null?null:et.ExprTool.typeOf(_)};return{fromServer:i,toServer(g){return et.Formula.toServer(g,o)},getType:p,getTypeAsCollectionSchemaType(g){const _=p(g);return _===et.ValueTool.numberType?m.CollectionSchemaType.NUMBER:_===et.ValueTool.booleanType?m.CollectionSchemaType.CHECKBOX:_===et.ValueTool.dateType?m.CollectionSchemaType.DATE:m.CollectionSchemaType.TEXT},getBoxedValue:f,getValue:h,getValueAsSegments(g,_){const x=f(g,_);if(x==null)return;const F=et.ValueTool.typeOf(x);if(F===et.ValueTool.numberType)return[{type:m.TextType.TEXT,text:"".concat(et.ValueTool.asNumber(x)),enhancer:{}}];if(F===et.ValueTool.stringType)return[{type:m.TextType.TEXT,text:et.ValueTool.asString(x),enhancer:{}}];if(F===et.ValueTool.booleanType)return et.ValueTool.asBoolean(x)?[{type:m.TextType.TEXT,text:"YES",enhancer:{}}]:void 0;if(F===et.ValueTool.dateType)return[Gn({from:et.ValueTool.asDate(x)})]},getAvailablePropIds(g){return l(g)},render(g,_){const x=c.get(_),F=x==null?null:et.Formula.eval(x,s,g);return et.ValueTool.toString(F)},validate(g,_,x){const F=l(x),b=d(F),w=et.Formula.parse(g,b);if(et.ResultTool.isError(w)){const k=et.ResultTool.getError(w);return{type:"error",pos:et.ErrorTool.getPosition(k),message:et.ErrorTool.toString(k)}}const E=et.ResultTool.getOk(w),C=et.Formula.eval(E,s,_);return{type:"preview",preview:C==null?"":et.ValueTool.typeOf(C)===et.ValueTool.numberType?dE(et.ValueTool.asNumber(C)):et.ValueTool.toString(C)}}}},EA=Symbol("Formula Tools"),Dce=(e,t)=>{var o,i;const n=(i=(o=t.blocks[e])==null?void 0:o.data.schema)!=null?i:{},s=new jce(()=>t);return Sce(e,n,{findSchema(l,c){var d,u;return(u=(d=t.blocks[l])==null?void 0:d.data.schema)==null?void 0:u[c]}},s)},$n=(e,t=pe())=>{let n=t[EA];n==null&&(n=new Map,t[EA]=n);let s=n.get(e);return s==null&&(s=Dce(e,t),n.set(e,s)),s},eo=(e,t)=>Ce(({blocks:n})=>ii(e,t,n),[e,t]),ii=vd.create((e,t,n=pe().blocks)=>{var l,c,d,u,f,h;const s=n[e],a=(l=s==null?void 0:s.data.schema)==null?void 0:l[t];let o,i;if((a==null?void 0:a.type)===m.CollectionSchemaType.ROLLUP){o=(d=s==null?void 0:s.data.schema)==null?void 0:d[(c=a.relationProperty)!=null?c:""];const p=n[(u=o==null?void 0:o.collectionId)!=null?u:""];i=(h=p==null?void 0:p.data.schema)==null?void 0:h[(f=a.targetProperty)!=null?f:""]}return{propertySchema:a,relationPropertySchema:o,targetPropertySchema:i}},(e,t)=>[e,t]),MN=(e,t,n)=>!n||!t?!1:!!$n(e).getType(t),Pu=(e,t)=>{var a;if(!t)return;const{propertySchema:n}=ii(e,t);if(!n)return;let s=n.type;return n.type===m.CollectionSchemaType.FORMULA&&MN(e,t,n.formula)&&((a=pe().blocks[e])!=null&&a.data.schema)&&(s=$n(e).getTypeAsCollectionSchemaType(t)),s===m.CollectionSchemaType.TITLE||s===m.CollectionSchemaType.TEXT||s===m.CollectionSchemaType.PHONE||s===m.CollectionSchemaType.EMAIL||s===m.CollectionSchemaType.RELATION||s===m.CollectionSchemaType.URL?"text":s===m.CollectionSchemaType.DATE||s===m.CollectionSchemaType.UPDATED_AT||s===m.CollectionSchemaType.CREATED_AT?"date":s===m.CollectionSchemaType.NUMBER?"number":s},Wl="NewRecordPlaceholderId",y1=60*1e3,Lu=15*y1,eF=4*Lu,Kn=24*eF,gu=44,uE=32,CA=300,i8=-2;var ym=(e=>(e.PREV="prev",e.NEXT="next",e))(ym||{}),Ft=(e=>(e.HOUR="hour",e.DAY="day",e.WEEK="week",e.BIWEEK="biweek",e.MONTH="month",e.QUARTER="quarter",e.YEAR="year",e))(Ft||{});const Ace={hour:4,day:12,month:5,week:1,biweek:5,quarter:14,year:28},DT={hour:60,day:60,month:100,biweek:50,week:25,quarter:25,year:25},hr={hour:80,day:20,week:180,biweek:80,month:40,quarter:10,year:5},kA=[{name:"小时",level:"hour"},{name:"天",level:"day"},{name:"周",level:"week"},{name:"双周",level:"biweek"},{name:"月",level:"month"},{name:"季",level:"quarter"},{name:"年",level:"year"}];var b1=(e=>(e.left="left",e.right="right",e))(b1||{});const l8=["left","right"],UN=e=>{var o;const{blocks:t,collectionViews:n}=pe(),s=n[e];if(!s)return;const a=t[s.parentId];if(a){if(a.type===m.BlockType.COLLECTION_VIEW_PAGE||a.type===m.BlockType.COLLECTION_VIEW)return a.uuid;if(a.type===m.BlockType.REFERENCE_COLLECTION||a.type===m.BlockType.REFERENCE_COLLECTION_PAGE)return(o=a.data.ref)==null?void 0:o.uuid}},Ec=y.createContext(void 0),tF=y.createContext(void 0),c8=y.createContext(void 0),yr=()=>{const e=y.useContext(Ec);if(!e)throw new Error("no usePageScrollRef");return e},nf=()=>{const e=y.useContext(Ec),t=y.useContext(tF);return t!=null?t:e},d8=()=>{const e=nf(),t=y.useContext(c8);return t!=null?t:e},u8=Mr(!1),f8=()=>ea(u8,pr),m8=Mr(0),Rce=()=>ea(m8,pr),h8=Mr(0),Pce=()=>ea(h8,pr),p8=Mr(0),Lce=()=>ea(p8,pr),g8=Mr(!1),VN=()=>ea(g8,pr),_8=()=>So(g8,pr),x8=Mr({isVirtualListMode:!1,virtualRef:void 0,subNodes:[]}),$N=()=>ea(x8,pr),y8=()=>So(x8,pr),Bce=e=>e===m.CollectionSchemaType.SELECT||e===m.CollectionSchemaType.MULTI_SELECT,fE=(e,t,n=!1)=>Ce(({collectionViews:s,blocks:a})=>{var i;const o=b8(e,n,a,s);if(o&&Bce(o.type))return(i=o.options)==null?void 0:i.find(l=>l.value===t)},[e,t,n]),sf=(e,t=!1)=>Ce(({collectionViews:n,blocks:s})=>b8(e,t,s,n),[e,t]),b8=(e,t=!1,n=pe().blocks,s=pe().collectionViews)=>{var u,f,h,p,g,_,x,F;const a=s[e];if(!a)return;const o=UN(e);if(!o)return;const i=n[o],l=a.type===m.CollectionViewType.BOARD,c={...(h=i==null?void 0:i.data.schema)==null?void 0:h[(f=(u=a.format.boardGroupBy)==null?void 0:u.property)!=null?f:""],propertyId:(p=a.format.boardGroupBy)==null?void 0:p.property},d={...(x=i==null?void 0:i.data.schema)==null?void 0:x[(_=(g=a.format.collectionGroupBy)==null?void 0:g.property)!=null?_:""],propertyId:(F=a.format.collectionGroupBy)==null?void 0:F.property};return l&&t?d:l?c:d},vs=e=>Ce(({collectionViews:t})=>t[e],[e]),F8=e=>Ce(({collectionViews:t})=>{var s;const n=t[e];return(s=(n==null?void 0:n.format.tableWrap)&&n.type!==m.CollectionViewType.TIMELINE)!=null?s:(n==null?void 0:n.type)===m.CollectionViewType.BOARD},[e]),Cg=e=>Ce(({collectionViews:t})=>{const n=t[e];return(n==null?void 0:n.format.showPageIcon)!==!1},[e]),w8=e=>Ce(({collectionViews:t})=>{const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.CALENDAR&&n.format.showLunarCalendar===!0},[e]),Li=e=>Ce(({collectionViews:t})=>{const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.BOARD?(n.format.boardCoverType===m.CoverType.PAGE_COVER||n.format.boardCoverType===m.CoverType.PAGE_CONTENT)&&n.format.boardImageDir===m.CollectionCardImageDir.VERTICAL?m.CollectionCardImageDir.VERTICAL:m.CollectionCardImageDir.HORIZONTAL:((n==null?void 0:n.format.galleryCoverType)===m.CoverType.PAGE_COVER||(n==null?void 0:n.format.galleryCoverType)===m.CoverType.PAGE_CONTENT)&&n.format.galleryImageDir===m.CollectionCardImageDir.VERTICAL?m.CollectionCardImageDir.VERTICAL:m.CollectionCardImageDir.HORIZONTAL},[e]),Bi=e=>Ce(({collectionViews:t})=>{var s,a;const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.BOARD?(s=n.format.boardCardSize)!=null?s:m.CardSize.MEDIUM:(a=n==null?void 0:n.format.galleryCardSize)!=null?a:m.CardSize.MEDIUM},[e]),mE=e=>Ce(({collectionViews:t})=>{var s,a;const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.BOARD?(s=n.format.boardCoverAspect)!=null?s:m.CoverAspectType.COVER:(a=n==null?void 0:n.format.galleryCoverAspect)!=null?a:m.CoverAspectType.COVER},[e]),E8=e=>Ce(({collectionViews:t})=>{var s,a;const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.BOARD?(s=n==null?void 0:n.format.boardShowPropertyName)!=null?s:!0:(a=n==null?void 0:n.format.galleryShowPropertyName)!=null?a:!0},[e]),hE=e=>Ce(({collectionViews:t})=>{const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.TIMELINE?n==null?void 0:n.format.timelineColorSetting:n==null?void 0:n.format.calendarColorSetting},[e]),Wm=e=>Ce(t=>C8(e,t),[e]),C8=(e,t={blocks:pe().blocks,collectionViews:pe().collectionViews})=>{var l,c,d,u,f;const{blocks:n,collectionViews:s}=t,a=s[e];let o,i;if((a==null?void 0:a.type)===m.CollectionViewType.BOARD?o=(l=a.format.boardCoverType)!=null?l:m.CoverType.NONE:o=(c=a==null?void 0:a.format.galleryCoverType)!=null?c:m.CoverType.NONE,o===m.CoverType.FILE_PROPERTY){const h=UN(e),p=(u=(d=n[h!=null?h:""])==null?void 0:d.data.schema)!=null?u:{};let g;(a==null?void 0:a.type)===m.CollectionViewType.BOARD?g=a.format.boardCoverProperty:g=a==null?void 0:a.format.galleryCoverProperty,((f=p[g!=null?g:""])==null?void 0:f.type)===m.CollectionSchemaType.FILE?i=g:o=m.CoverType.NONE}return{previewType:o,previewProperty:i}},$0=e=>Ce(({collectionViews:t})=>{var n;if(e)return(n=t[e])==null?void 0:n.parentId},[e]),Oce=e=>Ce(({collectionViews:t})=>{var n,s,a;return(a=(s=(n=t[e])==null?void 0:n.format.timelinePreference)==null?void 0:s.zoomLevel)!=null?a:Ft.MONTH},[e]),HN=e=>Ce(({collectionViews:t})=>{var n,s;return(s=(n=t[e])==null?void 0:n.format.calendarType)!=null?s:"month"},[e]),kg=e=>Ce(({collectionViews:t})=>{var n;return((n=t[e])==null?void 0:n.format.timelineShowTable)!==!1},[e]),zN=e=>Ce(({collectionViews:t})=>{var s,a;const n=(a=(s=t[e])==null?void 0:s.format.loadLimit)!=null?a:gre;return Math.min(n,Tp)},[e]),li=e=>Ce(({collectionViews:t})=>{var s;let n=(s=t[e])==null?void 0:s.format.openPageWay;if(n===void 0){const{setting:a={}}=xa();n=(a==null?void 0:a.openPageMode)===tE.RIGHT_PAGE?"openInRight":"openFullscreen"}return n},[e]),rf=(e,t)=>Ce(({collectionViews:n})=>{const s=n[e];return t||(s==null?void 0:s.type)!==m.CollectionViewType.BOARD?s==null?void 0:s.format.collectionGroupBy:s.format.boardGroupBy},[e,t]),qN=e=>{const{collectionId:t,viewId:n}=Ne(),s=rf(n,e),a=sf(n,e),o=Pu(t,s==null?void 0:s.property);return(a==null?void 0:a.type)===m.CollectionSchemaType.SELECT||(a==null?void 0:a.type)===m.CollectionSchemaType.MULTI_SELECT||(a==null?void 0:a.type)===m.CollectionSchemaType.CHECKBOX||(a==null?void 0:a.type)===m.CollectionSchemaType.PERSON||(a==null?void 0:a.type)===m.CollectionSchemaType.CREATED_BY||(a==null?void 0:a.type)===m.CollectionSchemaType.UPDATED_BY||o==="text"&&(s==null?void 0:s.sort)===m.GroupSortType.MANUAL||o==="checkbox"},pE=(e,t)=>{const{embed:n}=Ne(),s=d8(),{width:a}=ja(s==null?void 0:s.current,{type:"width",mode:"debounce",wait:1e3,leading:!1}),o=Ce(({collectionViews:u})=>{var h;const f=u[e];return(h=f==null?void 0:f.format.tableFreezeColumnIndex)!=null?h:-1},[e]),[i,l]=y.useState(0);if(y.useEffect(()=>{var u;if(n){const f=(u=s==null?void 0:s.current)==null?void 0:u.getBoundingClientRect().width;f&&l(f)}else{const f=document.querySelector(".next-space-page"),h=f==null?void 0:f.getBoundingClientRect().width;h&&l(h)}},[n,s,a]),!t||!i)return o;let c=30,d=-1;for(const u of t){const f=oo(u);if(c+f>i)break;d+=1,c+=f}return d<o?d:o};function Ip(e,t){var a,o;const n=pc(t),s=Dt();if(n.uuid)return h1(n.planType)?((a=n==null?void 0:n.setting)==null?void 0:a[e])||n[e]:!1;if(s.uuid)return h1(s.planType)?(o=s==null?void 0:s.setting)==null?void 0:o[e]:!1}const TA=new Map,vA=new Map;function lc(e,t,n){return e.filter(s=>AT(s,t,n))}function AT(e,t,n){var f;const{includePhoneNumber:s=!0,includeEmail:a=!0}=n!=null?n:{},o=t.replace(/\s+/g,"").toLowerCase();let i=IA(e.nickname||Po);s&&e.phone&&(i+="".concat(e.phone)),a&&e.email&&(i+="".concat(e.email));const l=NA(e.nickname),c="".concat(e.nickname.replace(/\s+/g,"").toLowerCase()," ").concat(i," ").concat(l),d=(f=Pn().userRemark)==null?void 0:f[e.uuid];let u="";if(d){const h=IA(d),p=NA(d);u="".concat(d.replace(/\s+/g,"").toLowerCase()," ").concat(h," ").concat(p)}return c.includes(o)||u.includes(o)}const IA=e=>{if(!e)return"";let t=TA.get(e);return t||(t=dd(e),TA.set(e,t)),t},NA=e=>{if(!e)return"";let t=vA.get(e);return t||(t=f0(e),vA.set(e,t)),t},RT=async e=>{try{await QL("https://cdn.staticfile.net/jschardet/3.0.0/jschardet.min.js","script")}catch(t){}return new Promise(t=>{const n=new FileReader;n.readAsDataURL(e),n.onload=async()=>{var l;const s=n.result;if(typeof s!="string"){t(s);return}const a=atob((l=s.split(";base64,")[1])!=null?l:"");let o="UTF-8";try{o=window.jschardet.detect(a).encoding}catch(c){try{const d=await AW(e);d.encoding&&(o=d.encoding)}catch(d){console.warn(d)}}const i=new FileReader;i.readAsText(e,o),i.onload=()=>{t(i.result)}}})},Mce=({downloadUrl:e})=>{const t=Qa(),n=y.useRef(null),[s,a]=y.useState(!0),o=async i=>{fetch(i).then(l=>l.blob()).then(l=>{if(l.type.startsWith("video")){n.current&&(n.current.innerText="预览失败！"),a(!1);return}RT(l).then(c=>{if(!n.current||typeof c!="string"){a(!1);return}n.current.innerText=c,a(!1)})})};return y.useEffect(()=>{o(e)},[e]),r.jsxs("div",{className:"h-full overflow-auto",style:{width:t?"calc(100vw - 40px)":"860px"},children:[r.jsx("pre",{ref:n,className:"pl-2 pt-2 text-t4 min-h-full min-w-full text-black bg-white1",style:{width:"max-content",height:"max-height"}}),s&&r.jsx($s,{className:"absolute top-0 bottom-0 left-0 right-0 mx-auto my-auto z-50"})]})},Uce=fn.memo(Mce),nF=2e3,Vce=3*1024*1024,$ce=async e=>{if(e.size>Vce)throw Error("文件大小不能超过3Mb");if(e.name.endsWith(".txt")){const t=await RT(e);if(typeof t=="string")return zce(t)}else if(e.name.endsWith(".csv")){const t=await RT(e);if(typeof t=="string")return Hce(t)}return[]},Hce=e=>{let t;try{t=RW(e)}catch(s){throw Error("csv文件格式不对")}const n=new Map;if(t instanceof Array){if(t.length>nF)throw Error("csv文件不能超过".concat(nF,"行"));return t.forEach((a,o)=>{if(a instanceof Array&&a.length===2){const i=a[0],l=a[1];if(!i||!l)throw Error("csv格式不对");if(!Gl.Mobile.test(l))throw new Error("".concat(o+1,", [").concat(a.join(","),"]"));n.set(l,i)}else throw Error("csv格式不对")}),Array.from(n,([a,o])=>({contact:a,name:o}))}throw Error("csv格式不对")},zce=e=>{let t=e.split(/[\r\n]+/g);t=t.filter(a=>a.trim());const n=new Map;if(t.length>nF)throw Error("txt文件不能超过".concat(nF,"行"));return t.forEach((a,o)=>{const i=a.split(",");if(i.length!==2)throw new Error("".concat(o+1,", [").concat(a,"]"));const l=i[0],c=i[1];if(!l||!c)throw new Error("".concat(o+1,", [").concat(a,"]"));if(!Gl.Mobile.test(c))throw new Error("".concat(o+1,", [").concat(a,"]"));n.set(c,l)}),Array.from(n,([a,o])=>({contact:a,name:o}))},k8=e=>r.jsxs("div",{className:"next-modal px-7 pb-4 w-[480px]",children:[r.jsxs("div",{className:"flex justify-between mt-7 items-center",children:[r.jsxs("div",{className:"text-h2 ",children:["批量导入"," ",e.isGuest?"外部协作者":"空间成员"]}),r.jsx(ul,{className:"text-grey4 text-t4",linkContainer:!0,link:ds.importGuest,children:"查看帮助"})]}),r.jsxs("div",{className:"text-t3-medium mt-7",children:["支持批量导入姓名和手机号，快速添加"," ",e.isGuest?"外部协作者至当前页面":"成员至当前空间"]}),r.jsxs("div",{className:"text-t4 text-grey3 mt-2.5 flex items-center",children:[r.jsx("span",{className:"w-1 h-1 rounded-full bg-grey3 ml-1 mr-1.5"}),"请使用 UTF-8 编码格式，上传后缀为 .csv 或 .txt 格式的文件"]}),r.jsxs("div",{className:"text-t4 text-grey3 flex items-center",children:[r.jsx("span",{className:"w-1 h-1 rounded-full bg-grey3 ml-1 mr-1.5"}),"每行一个对应关系，以英文逗号分割。对应关系为：","姓名,手机号"]}),r.jsxs("div",{className:"flex justify-between mt-5",children:[r.jsx("img",{className:"w-[200px]",src:vn.importGuestLeft}),r.jsx("img",{className:"w-[200px]",src:vn.importGuestRight})]}),r.jsx(gN,{singleFile:!0,labelClassName:"w-full",style:{width:"100%"},title:"选择本地文件",onSelect:async t=>{const n=t[0];if(!n)return;if(!n.name.endsWith(".txt")&&!n.name.endsWith(".csv")){be.warning("文件格式不对");return}const s=be.loading({content:"解析中..."});try{const a=await $ce(n);if(a.length===0)throw Error("解析到的列表为空，请检查文本格式是否正确");e.onReceiveGuestList(a)}catch(a){a instanceof Error?be.error(a.message):be.error(a)}finally{be.closeMessage(s)}},inputAttribute:{accept:".csv,.txt"}}),r.jsx("div",{className:"text-t4 text-grey3 text-center mt-[-6px]",children:"内容应小于2000行，文件大小不超过3MB；若超过空间限制人数将导入失败"})]}),PT={[m.PermissionRole.EDITOR]:"所有权限",[m.PermissionRole.WRITER]:"可编辑",[m.PermissionRole.COMMENTER]:"可评论",[m.PermissionRole.READER]:"可查看",[m.PermissionRole.NONE]:"无权限"},GN=({isGuest:e,showRight:t,role:n,onChange:s,isSpaceType:a,noRemove:o,isForm:i})=>{const l=ie();let c=[];e||c.push({type:H.TEXT_DESCRIPTION,data:{title:"所有权限",description:"可编辑，可管理协作及分享",selected:n===m.PermissionRole.EDITOR,onClick:()=>s==null?void 0:s(m.PermissionRole.EDITOR)}}),c.push({type:H.TEXT_DESCRIPTION,data:{title:"可编辑",description:"仅可编辑，不可管理协作及分享",selected:n===m.PermissionRole.WRITER,onClick:()=>s==null?void 0:s(m.PermissionRole.WRITER)}}),c.push({type:H.TEXT_DESCRIPTION,data:{title:"可评论",description:"仅可查看及评论，不可编辑",selected:n===m.PermissionRole.COMMENTER,onClick:()=>s==null?void 0:s(m.PermissionRole.COMMENTER)}}),c.push({type:H.TEXT_DESCRIPTION,data:{title:"可查看",description:"仅可查看，不可编辑及评论",selected:n===m.PermissionRole.READER,onClick:()=>s==null?void 0:s(m.PermissionRole.READER)}}),o||(c.push({type:H.LINE}),c.push({type:H.TEXT_DESCRIPTION,data:{title:r.jsx("div",{className:"text-red",children:a?" 无权限":"移除"}),selected:a&&(!n||n===m.PermissionRole.NONE),onClick:()=>s==null?void 0:s(m.PermissionRole.NONE)}})),i&&(c=[{type:H.TEXT_DESCRIPTION,data:{title:r.jsx("div",{className:"text-red",children:"移除"}),onClick:()=>s==null?void 0:s(m.PermissionRole.NONE)}}]);const d=u=>{l.dropdown({placement:"bottom",offset:[0,4],popcorn:u.currentTarget,content:({onCloseModal:f})=>r.jsx(ze,{className:"py-2 w-[270px] next-modal",onItemClick:()=>f(),items:c})})};return r.jsxs("div",{hidden:!s&&!t,className:R("self-center shrink-0 flex items-center text-t4 text-grey3",s?"cursor-pointer":"cursor-not-allowed",s&&"animate-click"),onClick:u=>s&&d(u),children:[i?"可填写":r.jsx(r.Fragment,{children:n?PT[n]:PT[m.PermissionRole.NONE]}),s&&r.jsx(V,{name:"IcArrowDown01",className:"ml-1",size:"xxxsmall"})]})},ap=({filterUserNoInSpace:e,searchText:t="",activeIndex:n,permissions:s,onChange:a,showRight:o,noRemove:i,selectUser:l,isForm:c,style:d})=>{const u=Dt(),f=lE(),h=kd(),p=y.useRef(!1),g=ba(),_=y.useRef(null),x=y.useRef(!1),F=PW(),b=y.useCallback(w=>{var C,k,T,v;const E={index:(C=w.index)!=null?C:0,type:w.type,role:w.role,isGuest:w.isGuest};if(w.type===m.PermissionType.SPACE){if(E.id="space",E.backgroundColor=u.backgroundColor,E.name=u.title,E.usersNum=(T=(k=u.permissions)==null?void 0:k.length)!=null?T:0,E.icon=u.icon,t){const I=Object.entries(f).map(([j,S])=>S);E.userNames=lc(I,t).map(j=>Rn(j.uuid))}}else if(w.type===m.PermissionType.USER&&w.userId){const I=f[w.userId];if(!I||e&&!g[I.uuid]&&!w.isGuest)return null;E.id=I.uuid,E.name=Rn(I.uuid),E.backgroundColor=I.backgroundColor,E.icon={type:"upload",value:I.avatar},E.phone=I.phone||I.email,E.isGuest=w.isGuest||!!t&&!g[I.uuid],E.isGuestInSpace=h.some(j=>j.userId===I.uuid)}else if(w.type===m.PermissionType.GROUP&&w.groupId){const I=(v=u.permissionGroups)==null?void 0:v.find(j=>j.id===w.groupId);if(!I)return null;if(E.id=I.id,E.name=I.name||F3,E.usersNum=I.userIds.length,E.icon=I.icon,t){const j=I.userIds.map(S=>f[S]).filter(S=>!!S);E.userNames=lc(j,t).map(S=>Rn(S.uuid))}}return E},[u,h,g,t,f,e]);return y.useEffect(()=>{const w=k=>{if(k.code==="Enter"){if(k.preventDefault(),k.stopPropagation(),p.current)return;if((n!=null?n:-1)>=0){const T=s.find(v=>v.index===n);if(T){const v=b(T);v&&!v.role&&(l==null||l({...T,name:v.name||v.phone}))}}}},E=()=>{p.current=!0},C=()=>{p.current=!1};return document.addEventListener("keydown",w),document.addEventListener("compositionstart",E),document.addEventListener("compositionend",C),()=>{document.removeEventListener("keydown",w),document.removeEventListener("compositionstart",E),document.removeEventListener("compositionend",C)}},[n,s,b,l]),y.useEffect(()=>{x.current||(x.current=!0,F())},[_.current]),r.jsx("div",{ref:_,className:"max-h-[40vh] overflow-y-auto",style:d,children:_.current&&r.jsx(qs,{customScrollParent:_.current,data:s,overscan:100,increaseViewportBy:100,fixedItemHeight:54,itemContent:(w,E)=>{var I,j,S;const C=b(E);if(!C)return null;const k=(j=(I=C.userNames)==null?void 0:I.length)!=null?j:0,T=E.type===m.PermissionType.USER?"rounded-full":"",v=!C.isGuest&&!!t&&C.role&&C.role!==m.PermissionRole.NONE;return r.jsxs("div",{className:R("relative flex items-center justify-between rounded p-2",!v&&l&&"cursor-pointer animate-click",C.index===n&&"normal-bg"),onClick:()=>!v&&l&&l({...E,name:C.name||C.phone}),children:[v&&r.jsx("div",{className:"absolute inset-0 bg-white1 opacity-70 cursor-not-allowed"}),r.jsxs("div",{className:R("flex items-center w-full",v&&C.role&&"w-60"),children:[r.jsx(ar,{color:C.backgroundColor||Do.grey,name:C.name||(C.isGuest?"客":Po),icon:C.icon,className:"mr-2 w-7 h-7 !text-t1 ".concat(T),imgClassName:T}),r.jsxs("div",{className:"flex flex-col",children:[r.jsxs("div",{className:"flex text-t2",children:[r.jsxs("div",{className:"flex items-center max-w-[240px] text-ellipsis space-x-1",children:[r.jsx("div",{children:C.name||(C.isGuest?C.phone:Po)}),C.isGuest&&r.jsx("div",{className:"rounded px-1 bg-grey6 text-t4 text-grey3",children:"外部"})]}),C.usersNum!==void 0&&r.jsx("div",{className:"flex-shrink-0",children:"（".concat(C.usersNum," 人）")})]}),C.name&&C.phone&&r.jsx("span",{className:"text-grey3 text-t4",children:Cm(C.phone)}),!!k&&r.jsxs("span",{className:"text-t4 text-grey3 line-clamp-1",children:[r.jsx("span",{className:"mr-1",children:"包含:"}),(S=C.userNames)==null?void 0:S.map((D,A)=>r.jsxs("span",{className:R(A!==k-1&&"mr-1"),children:[r.jsx(X1,{text:D,search:t}),A!==k-1&&","]},"".concat(D,"-").concat(A)))]})]})]}),v&&C.role&&r.jsx("div",{className:"text-t4 flex-shrink-0",children:c?"可填写":"已设置".concat(PT[C.role])}),!o&&C.isGuest&&!C.isGuestInSpace&&r.jsx("div",{className:"text-t4 text-grey3 flex-shrink-0",children:"未加入该空间"}),r.jsx(GN,{isForm:c,isGuest:C.isGuest,noRemove:i,isSpaceType:C.type===m.PermissionType.SPACE,role:C.role,onChange:a?D=>a(D,E):void 0,showRight:o})]},C.id)}})})},T8=async e=>{var c;const t=[],n={},s=new Map,a=[];for(const d of e)s.set(d.contact,d.name),a.push(d.contact);const{users:o,relations:i}=await ve.infra.temporaryBatch(a);if(!i)return{userIds:t,markNames:n};const l=o.reduce((d,u)=>(d[u.uuid]=u,d),{});re(Ha.updateSpaceUsers({users:l}));for(const d of i)t.push(d.uuid),n[d.uuid]=(c=s.get(d.phone))!=null?c:"";return{userIds:t,markNames:n}},qce="SynergyInvitation",jA="MultipleImportModal",$_="batch_guest",Gce=()=>{const{uuid:e,backToMainPanel:t,role:n,setRole:s,onConfirm:a,selectUser:o,selectedUsers:i,isForm:l,isAIMember:c,setBatchGuestGroups:d,batchGuestGroups:u}=an(I8),f=v8(),h=ie(),p=Dt(),g=y.useRef(null),[_,x]=y.useState(""),[F,b]=y.useState(0),w=ba(),E=lE(),C=kd(),k=vs(e),{permissions:T}=mt(e),v=l?(k==null?void 0:k.format.formInviteUserPermissions)||[]:T,{userPermissions:I,groupPermissions:j,spacePermission:S}=xI(v),{permissionGroups:D=[]}=p,A=Ip("abandonedGuest"),P=xt.$aiMembers,L=new Set;P.forEach(Q=>L.add(Q.uuid));const O=Object.values(E).map(Q=>I.find(se=>se.userId===Q.uuid)||{type:m.PermissionType.USER,userId:Q.uuid}).slice(0,_?void 0:5).filter(Q=>!i.some(ne=>ne.userId===Q.userId)).filter(Q=>{if(!_)return I.every(se=>se.userId!==Q.userId);if(!Q.userId)return!1;const ne=E[Q.userId];return ne?!!(AT(ne,_)||Gl.Mobile.test(_)&&ne.pinyin.includes(_)):!1}).map((Q,ne)=>({...Q,index:ne})),M=(!_&&S&&S.role!==m.PermissionRole.NONE?[]:[{groupId:"",type:m.PermissionType.SPACE,name:p.title,userIds:Object.keys(w),role:S?S.role:m.PermissionRole.NONE}]).concat(D.map(Q=>{const ne={...Q,groupId:Q.id,type:m.PermissionType.GROUP,name:Q.name,userIds:Q.userIds},se=j.find(ce=>ce.groupId===Q.id);return se?{...ne,role:se.role}:ne})).filter(Q=>!i.some(ne=>ne.groupId===Q.groupId)).filter(Q=>c&&L.has(Q.groupId)?!1:_?Q.name.toLowerCase().includes(_.toLowerCase())||dd(Q.name).includes(_.replace("'",""))?!0:Q.userIds.some(ne=>{const se=w[ne];return se?!!AT(se,_):!1}):j.every(ne=>ne.groupId!==Q.groupId)).map((Q,ne)=>({...Q,index:ne+O.length})),U=Q=>{if(Q.code==="Backspace"){if(!i.length||_.length)return;Q.preventDefault();const ne=An(i);ne&&o(ne)}},z=Q=>{var ne;o(Q),x(""),(ne=g.current)==null||ne.focus()},K=Q=>{h.dropdown({placement:"bottom",offset:[0,8],popcorn:Q.currentTarget,modalId:jA,content:()=>r.jsx(k8,{isGuest:!0,onReceiveGuestList:async ne=>{const{userIds:se,markNames:ce}=await T8(ne),ae="".concat($_).concat(qe());d([...u,{id:ae,name:"批量外部协作者",userIds:se,markNames:ce}]);const de={id:ae,name:"批量外部协作者",index:-1,groupId:ae,type:m.PermissionType.GROUP};z(de),h.closeModal(jA)}})})},W=O.length+M.length;y.useEffect(()=>{setTimeout(()=>{var Q;(Q=g.current)==null||Q.focus()},100)},[]),y.useEffect(()=>{const Q=se=>{if(se.code==="ArrowUp")return b(ce=>ce<=0?W-1:--ce),se.preventDefault(),!0;if(se.code==="ArrowDown")return b(ce=>ce>=W-1?0:++ce),se.preventDefault(),!0};return Ht.addEventListener("keydown",Q,dr+1,!0)},[W]);const Y=O.filter(({userId:Q})=>Q&&Gl.Mobile.test(_)?!w[Q]:C.some(ne=>ne.userId===Q)),G=O.filter(({userId:Q})=>c&&L.has(Q)?!1:Q&&w[Q]),ee=i.some(Q=>{var ne;return((ne=Q.groupId)==null?void 0:ne.startsWith($_))||Q.userId&&!w[Q.userId]}),te=i.length===0||!l&&n===m.PermissionRole.EDITOR&&ee;return r.jsxs(r.Fragment,{children:[!c&&r.jsxs("div",{className:"p-4 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{name:"IcArrowBack",size:"middle",className:"animate-click",onClick:t}),r.jsx("span",{className:"text-t2 ml-1",children:l?"邀请填写者":r.jsx(ul,{popup:"了解协作权限",link:_i.invitePage,children:"邀请协作"})})]}),!A&&r.jsxs("div",{className:"flex space-x-3 text-active_color text-t4",children:[r.jsx("div",{className:"animate-click",onClick:f,children:"通过链接邀请"}),r.jsx("div",{hidden:!1,className:"animate-click",onClick:K,children:"批量导入"})]})]}),r.jsxs("div",{className:"flex flex-wrap px-3 mb-4 space-x-1.5 items-center mx-4 min-h-8 border border-grey6 bg-grey9 focus-within-border rounded text-t2",children:[i.length?i.map(Q=>{let ne=D.find(se=>se.id===Q.groupId);return ne||(ne=u.find(se=>se.id===Q.groupId)),r.jsxs("div",{className:"flex h-5 bg-grey6 rounded-sm items-center px-1.5 my-1.5",children:[r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"max-w-[210px] text-ellipsis",children:Q.name}),ne&&r.jsx("div",{className:"flex-shrink-0",children:"（".concat(ne.userIds.length," 人）")})]}),r.jsx(V,{size:"small",onClick:()=>z(Q),name:"IcToastClose",className:"ml-2 animate-click cursor-pointer"})]},"".concat(Q.userId).concat(Q.groupId))}):r.jsx(V,{name:"IcSearch",size:"small",className:"mr-1 text-grey4"}),r.jsx("input",{ref:g,className:"bg-transparent my-1.5 flex-1",placeholder:c?"搜索成员名/成员组名":"搜索人员、组、手机号、邮箱",onKeyDown:U,onChange:Q=>{const{value:ne}=Q.target;x(ne);const se=Gl.Mobile.test(ne),ce=Gl.Email.test(ne);if(se||ce){const ae=se?ve.infra.findUser(ne):ve.infra.findUser("",ne),de=se?{phone:ne}:{email:ne};ae.then(({user:ke})=>{re(ke?Ha.updateSpaceUsers({users:{[ke.uuid]:{...ke,...de}}}):Ha.updateSpaceUsers({users:{[ne]:{uuid:ne,nickname:"",...de}}}))})}},value:_})]}),r.jsxs("div",{className:"p-4 pt-0 max-h-[60vh] space-y-2 overflow-y-auto",children:[!!G.length&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 text-grey3",children:"选择空间成员"}),r.jsx(ap,{isForm:l,searchText:_,activeIndex:F,selectUser:z,permissions:G,style:{overflow:"hidden",maxHeight:9999999}})]}),!!M.length&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 text-grey3 mt-2",children:"选择空间成员组"}),r.jsx(ap,{isForm:l,searchText:_,activeIndex:F,selectUser:z,permissions:M,style:{overflow:"hidden",maxHeight:9999999}})]}),!!Y.length&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 text-grey3",children:"邀请外部协作者"}),r.jsx(ap,{isForm:l,searchText:_,activeIndex:F,selectUser:Q=>{if(A){be.warning("禁止邀请外部协作者，请联系管理员开通");return}z(Q)},permissions:Y})]}),!O.length&&!M.length&&r.jsx("span",{className:"text-t2 text-grey3",children:"无搜索结果"})]}),r.jsxs("div",{className:"shrink-0 flex items-center justify-between p-4 border-t",children:[!c&&r.jsx("div",{className:"flex items-center",children:!l&&r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"ml-1 text-t2 mr-3",children:"统一设置权限为"}),r.jsx(GN,{noRemove:!0,role:n,onChange:s,isGuest:ee})]})}),r.jsxs("div",{className:"flex items-center ml-auto",children:[r.jsx(De,{onClick:t,className:"mr-4 text-t2-medium",children:"取消"}),r.jsx(Fe,{popup:te&&r.jsx("div",{className:"p-2",children:i.length===0?"请先选择一个成员":"外部协作者不可以设置所有权限"}),children:r.jsx(De,{disable:te,colorType:"active",onClick:a,className:"text-t2-medium text-white",children:"确定"})})]})]})]})},Wce=()=>{const e=lt(),t=cr(e),n=Ut(),s=_r(n.uuid),a=ie(),[o,i]=y.useState(m.PermissionRole.WRITER),[l,c]=y.useState(),d=()=>{const F=new Wp;return a.warning({title:"重置链接",content:"重置链接后之前的链接将失效，确定要重置吗？",confirm:async()=>{F.resolve()},cancel:()=>{F.reject(new Error("cancel"))}}),F.promise},u=async()=>{const F=await ve.infra.resetDocInvitation(e,{role:o});c(F),be.success("链接重置成功")},f=async()=>{await d(),await u()},h=async F=>{await d(),i(F),u()};y.useEffect(()=>{(async()=>{const F=await ve.infra.getDocInvitation(e,m.PermissionRole.WRITER);c(F),F.role&&i(F.role)})()},[e]);const p="".concat(_n()).concat(Nt.login,"?").concat(dn.page,"=").concat(e,"&").concat(dn.cooperate,"=").concat(l==null?void 0:l.uuid),_=[[s,"邀请你加入",oI(t==null?void 0:t.type,t==null?void 0:t.data.segments),"的协作"].join(" "),p,"通过邀请链接加入，或复制这段内容打开 ".concat(Na," APP 快捷加入")].join("\n"),x=()=>{Xt(_)};return r.jsxs("div",{className:"next-modal flex flex-col w-125 px-7 pb-5",children:[r.jsx("div",{className:"text-h2 py-7",children:"链接邀请外部协作者"}),r.jsxs("div",{className:"mb-5 text-grey3 text-t4",children:[ue(l==null?void 0:l.expirationAt).format("YYYY年MM月DD日"),"前，任何通过此链接邀请的人都可以加入页面协作，到达页面协作人数上限后将无法加入"]}),r.jsx(Ct,{readonly:!0,value:l?p:"请点击重置链接",placeholder:"https://".concat(dw,"/XXXXXXXXX"),addonAfter:r.jsxs("div",{className:"flex",children:[r.jsx(De,{className:"rounded-none border-y-transparent",onClick:f,children:"重置链接"}),r.jsx(De,{className:"rounded-none border-y-transparent border-x-transparent",onClick:x,children:"复制邀请链接"})]})}),r.jsxs("div",{className:"flex mt-5 items-end",children:[r.jsx("span",{className:"text-t2 mr-2 链接权限设置",children:"设置链接权限为"}),r.jsx(GN,{noRemove:!0,isGuest:!0,role:o,onChange:h})]})]})},v8=()=>{const e=ie();return y.useCallback(t=>{e.dropdown({popcorn:t.currentTarget,modalId:qce,placement:"bottom",offset:[0,8],content:()=>r.jsx(Wce,{})})},[e])},Kce=e=>{const{backToMainPanel:t,searchType:n,uuid:s}=e,a=n==="form",o=n==="aiMember",[i,l]=y.useState([]),[c,d]=y.useState(m.PermissionRole.EDITOR),[u,f]=y.useState([]),h=Dt(),p=ba(),g=lE(),_=ya(),x=ie(),F=_o(),b=Ur(),w=y.useMemo(()=>{const k=[];return i.forEach(T=>{var v;if(T.type===m.PermissionType.GROUP&&((v=T.groupId)!=null&&v.startsWith($_))){const I=u.find(j=>j.id===T.groupId);I==null||I.userIds.forEach(j=>{k.push({userId:j,type:m.PermissionType.USER,role:c})})}else k.push({...T,role:c})}),k},[u,c,i]),E=(k,T)=>{l(v=>T?v.map(I=>k.type===m.PermissionType.SPACE&&I.type===k.type||k.type===m.PermissionType.USER&&I.userId===k.userId||k.type===m.PermissionType.GROUP&&I.groupId===k.groupId?{...I,role:T}:I):k.type===m.PermissionType.SPACE&&v.some(I=>I.type===m.PermissionType.SPACE)?v.filter(I=>I.type!==m.PermissionType.SPACE):k.type===m.PermissionType.USER&&v.some(I=>I.userId===k.userId)?v.filter(I=>I.userId!==k.userId):k.type===m.PermissionType.GROUP&&v.some(I=>I.groupId===k.groupId)?v.filter(I=>I.groupId!==k.groupId):v.concat({...k,role:m.PermissionRole.EDITOR}))},C=y.useCallback(async()=>{var v;if(o){const I=xt.$aiMembers,j=[];i.forEach(S=>{if(S.type==="user"||S.type==="group"||S.type==="space"){const D=S.type==="user"?S.userId:S.type==="group"?S.groupId:h.uuid;D&&j.push({type:S.type,uuid:D})}}),ve.infra.postSpaceAiMembers(h.uuid,{members:j}),st({$aiMembers:I.concat(j)}),t();return}if(a){const I=(v=pe().collectionViews)==null?void 0:v[s];if(!I)return;Rt(s,{formInviteUserPermissions:[...I.format.formInviteUserPermissions||[],...w]}),t();return}const k=w.filter(I=>I.type===m.PermissionType.USER&&I.userId&&!p[I.userId]);let T={};if(i.forEach(I=>{var j;if(I.type===m.PermissionType.GROUP&&((j=I.groupId)!=null&&j.startsWith($_))){const S=u.find(D=>D.id===I.groupId);if(!S)return;T={...T,...S.markNames}}}),Object.entries(T).length>0){await ve.infra.addSpaceUserRemark(Pn().uuid,T);const I=Object.entries(T).map(([j,S])=>({userId:j,markName:S}));re(kw({uuid:Pn().uuid,patch:I}))}if(k.length>0){if(!b){const{results:I}=await ve.infra.getSpaceGuests(h.uuid),j=new Set(k.map(D=>D.userId));I.forEach(({userId:D})=>j.add(D));const{mindMapMaxLimit:S}=T0();if(j.size>S){x.warning({title:"邀请失败",content:"外部协作者数量已达上限".concat(S,"人，若需继续邀请， 可尝试升级空间"),confirmText:"升级空间",colorType:"active",confirm:()=>{h.planType===St.freePersonal?F({defaultMenuType:Kt.upgrade,from:Mt.extMember}):_(Mt.extMember)}});return}}for(const I of k){I.isGuest=!0;const j=g[I.userId],S=Gl.Mobile.test((j==null?void 0:j.phone)||"");if(j&&!Wc(j==null?void 0:j.uuid)&&S){const D=await ve.infra.temporary({phone:j.phone,email:j.email});I.userId=D.user.uuid,re(Ha.updateSpaceUsers({users:{[D.user.uuid]:{...j,...D}}}))}}}t(),w.forEach(I=>mu(s,I)),re(Sa()),me.event("invite_space_member")},[g,t,u,h.planType,h.uuid,o,a,b,x,F,_,w,i,p,s]);return y.useEffect(()=>{i.some(T=>{var v;return((v=T.groupId)==null?void 0:v.startsWith($_))||T.userId&&!p[T.userId]})&&c===m.PermissionRole.EDITOR&&d(m.PermissionRole.WRITER)},[c,i,p]),y.useEffect(()=>{const k=()=>{i.length&&x.warning({title:r.jsx("div",{className:"w-80",children:"是否发送协作邀请？"}),content:"若取消，则当前邀请不会生效",confirmText:"发送邀请",colorType:"active",confirm:()=>{C()}})};return xn.on("inviteConfirmModal",k),()=>{xn.off("inviteConfirmModal",k)}},[t,C,x,i.length]),{uuid:s,selectUser:E,selectedUsers:i,backToMainPanel:t,onConfirm:C,role:c,setRole:d,isForm:a,isAIMember:o,setBatchGuestGroups:f,batchGuestGroups:u}},I8=vl(Kce),N8=({backToMainPanel:e,uuid:t,searchType:n})=>r.jsx(I8,{backToMainPanel:e,uuid:t,searchType:n,children:r.jsx(Gce,{})}),LT=e=>{const{noMessage:t,id:n,track:s}=e||{},a=y.useRef(n!=null?n:"copy-".concat(qe()));return y.useEffect(()=>{const o=new LW("#".concat(a.current));return o.on("success",()=>{t||be.success("复制成功"),s==null||s()}),o.on("error",()=>{t||be.error("复制失败")}),()=>{o.destroy()}},[t,s]),a.current},gE={title:"文字颜色",items:[{color:cs(Ze.white),desc:"默认",isBgColor:!0,colorkey:""},{color:tr(Ze.black),desc:"黑色",colorkey:Ze.black},{color:tr(Ze.grey),desc:"灰色",colorkey:Ze.grey},{color:tr(Ze.brown),desc:"棕色",colorkey:Ze.brown},{color:tr(Ze.orange),desc:"橘色",colorkey:Ze.orange},{color:tr(Ze.pink),desc:"粉色",colorkey:Ze.pink},{color:tr(Ze.yellow),desc:"黄色",colorkey:Ze.yellow},{color:tr(Ze.green),desc:"绿色",colorkey:Ze.green},{color:tr(Ze.blue),desc:"蓝色",colorkey:Ze.blue},{color:tr(Ze.purple),desc:"紫色",colorkey:Ze.purple},{color:tr(Ze.red),desc:"红色",colorkey:Ze.red}]},F1={title:"背景颜色",items:[{color:cs(Ze.white),desc:"默认",isBgColor:!0,colorkey:""},{color:cs(Ze.grey),desc:"灰色",isBgColor:!0,colorkey:Ze.grey},{color:cs(Ze.brown),desc:"棕色",isBgColor:!0,colorkey:Ze.brown},{color:cs(Ze.orange),desc:"橘色",isBgColor:!0,colorkey:Ze.orange},{color:cs(Ze.pink),desc:"粉色",isBgColor:!0,colorkey:Ze.pink},{color:cs(Ze.yellow),desc:"黄色",isBgColor:!0,colorkey:Ze.yellow},{color:cs(Ze.green),desc:"绿色",isBgColor:!0,colorkey:Ze.green},{color:cs(Ze.blue),desc:"蓝色",isBgColor:!0,colorkey:Ze.blue},{color:cs(Ze.purple),desc:"紫色",isBgColor:!0,colorkey:Ze.purple},{color:cs(Ze.red),desc:"红色",isBgColor:!0,colorkey:Ze.red}]},Yce=[{color:cs(Ze.yellow_green),desc:"黄至绿",isBgColor:!0,colorkey:Ze.yellow_green},{color:cs(Ze.green_blue),desc:"绿至蓝",isBgColor:!0,colorkey:Ze.green_blue},{color:cs(Ze.blue_purple),desc:"蓝至紫",isBgColor:!0,colorkey:Ze.blue_purple},{color:cs(Ze.purple_red),desc:"紫至红",isBgColor:!0,colorkey:Ze.purple_red},{color:cs(Ze.red_orange),desc:"红至橘",isBgColor:!0,colorkey:Ze.red_orange}],j8=[{color:cs(Ze.light_yellow),desc:"荧光黄",isBgColor:!0,colorkey:Ze.light_yellow},{color:cs(Ze.light_green),desc:"荧光绿",isBgColor:!0,colorkey:Ze.light_green},{color:cs(Ze.light_blue),desc:"荧光蓝",isBgColor:!0,colorkey:Ze.light_blue},{color:cs(Ze.light_purple),desc:"荧光紫",isBgColor:!0,colorkey:Ze.light_purple},{color:cs(Ze.light_red),desc:"荧光红",isBgColor:!0,colorkey:Ze.light_red}],Xce={...F1,items:[...F1.items,...j8]},Qce={...F1,items:[...F1.items,...j8,...Yce]},H0=[gE,Xce],Jce=[gE,Qce],Zce=qe(),WN="aiBitableEntry",w1="aiMindMapEntry",S8="aiBitableEdit",cC=-1/0;var it=(e=>(e.PageEmpty="PageEmpty",e.PageHasContent="PageHasContent",e.PageContentWroteByAI="PageContentWroteWithAi",e.TextSelected="TextSelected",e.TextSelectedAndWroteByAI="TextSelectedWithWrote",e.BlockSelected="BlockSelected",e.BlockSelectedAndWroteByAI="BlockSelectedAndWroteByAI",e))(it||{}),ho=(e=>(e.BlockMenu="block_menu",e.ContextMenu="context_menu",e.RtfMenu="rtf_menu",e.EmptyAi="empty_ai",e.bitable="bitable",e.mindMap="mindMap",e))(ho||{}),we=(e=>(e.Brainstorm="Brainstorm",e.Blog="Blog",e.Outline="Outline",e.Story="Story",e.DailyNotes="DailyNotes",e.ProsAndConsList="ProsAndConsList",e.ActionItems="ActionItems",e.Explain="explain",e.Bitable="bitTable",e.Bitable_Plan="plan",e.Bitable_List="list",e.Bitable_Task_Manage="task",e.Bitable_Other="other",e.MindMap="mindMap",e.MindMap_Outline="mindOutline",e.MindMap_Plan="mindPlan",e.MindMap_Other="mindOther",e.Chinese="simplified chinese",e.ClassicalChinese="classical chinese",e.English="english",e.Korean="korean",e.Japanese="japanese",e.French="french",e.German="german",e.OtherLanguage="OtherLanguage",e.ContinueWrite="ContinueWrite",e.Summarize="Summarize",e.TryAgain="TryAgain",e.Close="Close",e.Improve="Improve",e.Insert="Insert",e.InsertToBitableDesc="InsertToBitableDesc",e.Replace="Replace",e.Discard="Discard",e.Summary="keySummary",e.Simpler="makeShorter",e.Longer="makeLonger",e.Professional="professional",e.Casual="casual",e.Straightforward="straightforward",e.Confident="confident",e.Friendly="friendly",e.Comment="commenting",e.BugFix="bugFix",e.CPlus="C++",e.Java="Java",e.JavaScript="JavaScript",e.TypeScript="TypeScript",e.Python="Python",e.OtherCodeLanguage="OtherCodeLanguage",e.Custom="Custom",e))(we||{});const ede=new Set(["ContinueWrite","Summarize","simplified chinese","classical chinese","english","korean","japanese","french","german"]),dC=new Set(["plan","list","task","other"]),H_=new Set(["mindPlan","mindOutline","mindOther"]),D8=e=>{const t=rr(()=>localStorage.getItem(w1));return r.jsx(ze,{className:Ra,items:ade.map(n=>({type:H.BLOCK_ITEM,data:{...n,textClassName:t?void 0:"text-red",rightText:t?void 0:"NEW"}})),keyDownPriority:dr+2,onItemClick:n=>{localStorage.setItem(w1,JSON.stringify(!0)),e.onItemClick(n)}})},tde={editPrompts:[],emptyWithPrompts:[],records:{},hasUpdate:!1},ls=qp(()=>tde),nde=[we.Blog,we.Brainstorm,we.Outline,we.Story,we.DailyNotes,we.ProsAndConsList,we.OtherLanguage],SA={[we.Blog]:{prompt:"写文章，关于",type:"blog"},[we.Brainstorm]:{prompt:"头脑风暴，关于",type:"brainstorm"},[we.Outline]:{prompt:"写大纲，关于",type:"outline"},[we.Story]:{prompt:"写故事，关于",type:"story"},[we.DailyNotes]:{prompt:"日常小记，关于",type:"daily"},[we.ProsAndConsList]:{prompt:"分析优缺点，关于",type:"prosConsList"},[we.ActionItems]:{prompt:"列出执行步骤，关于"},[we.Explain]:{prompt:"解释一下，关于"},[we.OtherLanguage]:{prompt:"把当前语言翻译成："},[we.MindMap_Outline]:{prompt:"写大纲，关于",type:we.MindMap_Outline}},sde={plan:"5f4bf941-d35e-4d1e-96c3-976a4f8ab1d1",list:"c9f301a3-35ec-4ab9-8b2d-ef74340a4701",task:"6485520b-3dbc-469a-99b6-c7ecf4217a56",other:"b177392a-b4c8-45cf-b834-1378d317aa94"},$h=e=>{const t={plan:{prompt:"写一份计划，关于"},list:{prompt:"写一份清单，关于"},task:{prompt:"写一份任务管理，关于"},other:{prompt:""},[we.MindMap_Outline]:{prompt:"写一份大纲，关于"},[we.MindMap_Plan]:{prompt:"写一份计划，关于"},[we.MindMap_Other]:{prompt:""}};xt.$aiCommands.forEach(n=>{var s,a;for(const o of["plan","list","task","other"])if(n.parentId===sde[o]){const i=t[o];if(!i)return;let l=(s=t[o])==null?void 0:s.promptList;l||(l=[],i.promptList=l),l.push({title:n.name,placeholder:(a=n.placeholder)!=null?a:""});break}});for(const n of["plan","list","task","other","mindOutline","mindPlan","mindOther"])SA[n]=t[n];return SA[e]},KN=[{editType:we.Chinese,title:"中文（简体）",en:"simplified chinese"},{editType:we.ClassicalChinese,title:"中文（文言文）",en:"classical chinese"},{editType:we.English,title:"英语",en:"english"},{editType:we.Korean,title:"韩语",en:"korean"},{editType:we.Japanese,title:"日语",en:"japanese"},{editType:we.French,title:"法语",en:"french"},{editType:we.German,title:"德语",en:"german"},{editType:we.OtherLanguage,title:"翻译成...",en:"other"}],rde=[{icon:"IcTable",title:"写计划",iconClassName:"text-[#A34DD9]",editType:we.Bitable_Plan,uuid:"788f06ec-1ed2-47f9-be37-a9a908ca8c7e"},{icon:"IcTable",title:"写清单",iconClassName:"text-[#A34DD9]",editType:we.Bitable_List,uuid:"788f06ec-1ed2-47f9-be37-a9a908ca8c7e"},{icon:"IcTable",title:"任务管理",iconClassName:"text-[#A34DD9]",editType:we.Bitable_Task_Manage,uuid:"788f06ec-1ed2-47f9-be37-a9a908ca8c7e"},{icon:"IcTable",title:"其他",iconClassName:"text-[#A34DD9]",editType:we.Bitable_Other,uuid:"788f06ec-1ed2-47f9-be37-a9a908ca8c7e"}],ade=[{icon:"IcMindmap",title:"写大纲",iconClassName:"text-[#A34DD9]",editType:we.MindMap_Outline,uuid:"0f74c3ef-efbc-41ae-b6fb-04dd8e429d3d"},{icon:"IcMindmap",title:"写计划",iconClassName:"text-[#A34DD9]",editType:we.MindMap_Plan,uuid:"6d5d4666-94f8-471e-84e9-ae80acb50b39"},{icon:"IcMindmap",title:"其他",iconClassName:"text-[#A34DD9]",editType:we.MindMap_Other,uuid:"6d5d4666-94f8-471e-84e9-ae80acb50b39"}],A8=e=>{const t=ls.getState();return t.emptyWithPrompts.map(s=>{const a=t.records[s];return{type:H.OPERATION,isHidden:a==null?void 0:a.hidden,data:{icon:(a==null?void 0:a.icon)||"IcEdit",title:(a==null?void 0:a.name)||(a!=null&&a.subNodes?"未命名指令目录":"未命名指令"),uuid:s,hasArrow:!!(a!=null&&a.subNodes),prompt:a==null?void 0:a.minimax,editType:a==null?void 0:a.type,renderSubMenu:a!=null&&a.subNodes?()=>{var o;return r.jsx(ode,{subNodes:(o=a==null?void 0:a.subNodes)!=null?o:[],onItemClick:e})}:void 0}}})},ode=e=>{const t=ls.getState(),n=e.subNodes.map(s=>{const a=t.records[s];return{type:H.OPERATION,isHidden:a==null?void 0:a.hidden,data:{icon:(a==null?void 0:a.icon)||"IcEdit",title:(a==null?void 0:a.name)||(a!=null&&a.subNodes?"未命名指令目录":"未命名指令"),uuid:s,editType:a==null?void 0:a.type,hasArrow:!!(a!=null&&a.subNodes),placeHolder:a==null?void 0:a.placeholder,prompt:a==null?void 0:a.minimax}}});return r.jsx(ze,{className:Ra,keyDownPriority:dr+1,items:n,onItemClick:e.onItemClick})},ide=[{icon:"IcEdit",title:"头脑风暴...",editType:we.Brainstorm,uuid:"bc56080a-edb8-46e2-8584-7be4c4cc5d05"},{icon:"IcEdit",title:"写文章",editType:we.Blog,uuid:"1ee4dcf6-b00d-49b3-b4d5-ec55d102fd40"},{icon:"IcEdit",title:"写大纲",editType:we.Outline,uuid:"0fcb00ae-f47b-426f-9045-25798361ccc4"},{icon:"IcEdit",title:"写故事",editType:we.Story,uuid:"a15c829b-8861-47d8-a085-10e7b36d1841"},{icon:"IcEdit",title:"日常小记",editType:we.DailyNotes,uuid:"b3d48333-ead2-4692-ab51-1f16019500cd"},{icon:"IcEdit",title:"分析优缺点",editType:we.ProsAndConsList,uuid:"e7e1df60-bd16-47d9-a2fa-e4fec4c114cf"},{icon:"IcEdit",title:"列出执行步骤",editType:we.ActionItems,uuid:"f2eb1bda-7e1f-4ece-91d1-4c2c2d1f06cf"},{icon:"IcEdit",title:"解释一下",editType:we.Explain,uuid:"788f06ec-1ed2-47f9-be37-a9a908ca8c7e"},{icon:"IcTable",title:"用多维表起草",hasArrow:!0,editType:we.Bitable,uuid:"788f06ec-1ed2-47f9-be37-a9a908ca8c71"}];ide.push({icon:"IcMindmap",title:"用思维导图起草",hasArrow:!0,editType:we.MindMap,uuid:"788f06ec-1ed2-47f9-be37-a9a908ca8c72"});const wh=[{type:H.BLOCK_TEXT,data:{title:"按页面的内容"}},{type:H.OPERATION,data:{icon:"IcEdit",title:"继续写作",editType:we.ContinueWrite,uuid:"9aab88e9-ba1b-4201-a9f3-483e814493db"}},{type:H.LINE},{type:H.OPERATION,data:{icon:"IcSummarize",title:"总结",editType:we.Summarize,uuid:"7aec37fa-f6be-4b6e-a870-6a54b430131a"}},{type:H.OPERATION,data:{icon:"IcAbstract",title:"摘要",editType:we.Summary,uuid:"c0e29509-ca71-4bc0-9a96-fa338a2b05ce"}},{type:H.OPERATION,data:{icon:"IcQuestion",title:"解释",editType:we.Explain,uuid:"5e936d14-2331-468b-af24-31433992451d"}},{type:"Translate",data:{uuid:"4767a567-da89-4781-92ab-8a8d5faf8e0e"}}],lde=[{type:H.BLOCK_TEXT,data:{title:"按页面的内容"}},{type:H.LINE},{type:H.OPERATION,data:{icon:"IcSummarize",title:"总结",editType:we.Summarize,uuid:"7aec37fa-f6be-4b6e-a870-6a54b430131a"}},{type:H.OPERATION,data:{icon:"IcQuestion",title:"解释",editType:we.Explain,uuid:"5e936d14-2331-468b-af24-31433992451d"}}],uC=[{type:H.OPERATION,data:{icon:"IcCheck02",title:"完成",editType:we.Close}},{type:H.OPERATION,data:{icon:"IcEdit",title:"继续写作",editType:we.ContinueWrite}},{type:H.LINE},{type:H.OPERATION,data:{icon:"IcClose",title:"关闭",editType:we.Close}}],DA=[{type:H.BLOCK_TEXT,data:{title:"按选择的内容"}},{type:H.OPERATION,data:{icon:"IcEdit",title:"继续写作",editType:we.ContinueWrite,uuid:"9aab88e9-ba1b-4201-a9f3-483e814493db"}},{type:H.LINE},{type:H.OPERATION,data:{icon:"IcSummarize",title:"总结",editType:we.Summarize,uuid:"7aec37fa-f6be-4b6e-a870-6a54b430131a"}},{type:H.OPERATION,data:{icon:"IcAbstract",title:"摘要",editType:we.Summary,uuid:"c0e29509-ca71-4bc0-9a96-fa338a2b05ce"}},{type:H.OPERATION,data:{icon:"IcQuestion",title:"解释",editType:we.Explain,uuid:"5e936d14-2331-468b-af24-31433992451d"}},{type:"Translate"},{type:"Code"},{type:H.LINE},{type:H.OPERATION,data:{icon:"IcChangeWriting",title:"改进写作",editType:we.Improve,uuid:"7edcb487-2041-4ade-8483-71b9e1caba35"}},{type:H.OPERATION,data:{icon:"IcSimpler",title:"更简短",editType:we.Simpler,uuid:"1a8812df-9395-4eed-84be-59b5e148e7c1"}},{type:H.OPERATION,data:{icon:"IcMoreDetail",title:"更详细",editType:we.Longer,uuid:"63c58833-d02c-4a15-8039-949c78bcc9f2"}},{type:"AiStyle",data:{uuid:"7613737d-eb65-4464-a596-167d1e3f0c00"}}],Kx=[{type:H.OPERATION,data:{icon:"IcTurnInto",title:"替换",editType:we.Replace}},{type:H.OPERATION,data:{icon:"IcBtnNew",title:"插入",editType:we.Insert}},{type:H.OPERATION,data:{icon:"IcEdit",title:"继续写作",editType:we.ContinueWrite}},{type:H.LINE},{type:H.OPERATION,data:{icon:"IcTryAgain",title:"重试",editType:we.TryAgain}},{type:H.OPERATION,data:{icon:"IcTrash",title:"放弃",editType:we.Discard}}],cde=({onItemClick:e})=>{const t=KN.map(n=>({type:H.BLOCK_ITEM,data:n}));return r.jsx(ze,{className:Ra,items:t,keyDownPriority:dr+1,onItemClick:e})},dde=[{title:"更专业的",editType:we.Professional,uuid:"32faf939-cb35-479f-95e8-3a234791a75d"},{title:"非正式的",editType:we.Casual,uuid:"68dc99f8-ebda-440e-bd9d-b1d431b24e0a"},{title:"更直接的",editType:we.Straightforward,uuid:"f57e6b90-d5c3-453a-87ab-e6ed9d2c175f"},{title:"更自信的",editType:we.Confident,uuid:"06d15689-21c4-446d-89b0-fa5cc33c3d96"},{title:"更友好的",editType:we.Friendly,uuid:"6a8e29b8-e6ee-4af1-87da-212f01b7925a"}],ude=({onItemClick:e})=>{const t=dde.map(n=>({type:H.BLOCK_ITEM,data:n}));return r.jsx(ze,{className:Ra,items:t,keyDownPriority:dr+1,onItemClick:e})},fde=[{title:"C++",editType:we.CPlus,uuid:"1d408267-b814-4a47-9202-8e7e3e3fe228"},{title:"Java",editType:we.Java,uuid:"69adc1be-750b-4770-a543-c505e3673c07"},{title:"JavaScript",editType:we.JavaScript,uuid:"059f0231-2c1b-499c-91fd-75bacafe756e"},{title:"TypeScript",editType:we.TypeScript,uuid:"f402a9c0-d0af-4cd6-8d5d-1d68e90e27ad"},{title:"Python",editType:we.Python,uuid:"9d2d1638-becc-4b74-9f08-26dd5d873c23"},{title:"改写成",editType:we.OtherCodeLanguage,uuid:"2ed3ed7c-6867-437d-8da5-4f36300b44d2"}],mde=({onItemClick:e})=>{const t=fde.map(n=>({type:H.BLOCK_ITEM,data:n}));return r.jsx(ze,{className:Ra,items:t,keyDownPriority:dr+1,onItemClick:e})},Yx=e=>{const{$aiCommands:t}=xt,n=new Set(t.map(s=>s.uuid));return e.filter(s=>{var a;return s.type==="line"?!0:n.has((a=s==null?void 0:s.data)==null?void 0:a.uuid)})},hde=e=>{var f,h,p,g,_,x;const{scene:t,onItemClick:n,selectedBlockIds:s,isBitable:a=!1,isBitablePage:o=!1,isMindMap:i=!1,isDescription:l=!1,editTypeRef:c}=e,d={type:H.OPERATION,data:{icon:"IcTranslate",title:"翻译",uuid:"4767a567-da89-4781-92ab-8a8d5faf8e0e",hasArrow:!0,renderSubMenu:()=>r.jsx(cde,{onItemClick:n})}},u={type:H.OPERATION,data:{icon:"IcAiStyle",title:"切换风格",uuid:"7613737d-eb65-4464-a596-167d1e3f0c00",hasArrow:!0,renderSubMenu:()=>r.jsx(ude,{onItemClick:n})}};switch(t){case it.PageEmpty:{const F=localStorage.getItem(WN),b=localStorage.getItem(w1),E=A8(n).map(C=>{const k=C.data;let T={};return k.editType===we.Bitable?T={textClassName:F?void 0:"text-red",rightText:F?void 0:"NEW",renderSubMenu:()=>r.jsx(R8,{onItemClick:n})}:k.editType===we.MindMap&&(T={textClassName:b?void 0:"text-red",rightText:b?void 0:"NEW",renderSubMenu:()=>r.jsx(D8,{onItemClick:n})}),{type:H.OPERATION,data:{...k,...T}}});return E.unshift({type:H.BLOCK_TEXT,data:{title:"".concat(pm," 助手")}}),Yx(E)}case it.PageHasContent:{if(J.ui.selectedBlocks.length===1||i){const F=(h=(f=J.ui.selectedBlocks[0])==null?void 0:f.blockId)!=null?h:"",{isInMindMap:b,isMindMapPage:w}=V_(F);if(b)return wh.map(E=>E.type==="Translate"?d:E).filter(E=>{var C,k;return((C=E.data)==null?void 0:C.editType)===we.ContinueWrite||((k=E.data)==null?void 0:k.icon)==="IcTranslate"});if(w||i)return wh.filter(E=>{var C;return((C=E.data)==null?void 0:C.editType)===we.ContinueWrite})}return Yx(wh.map(F=>F.type==="Translate"?d:F))}case it.PageContentWroteByAI:return c.current&&H_.has(c.current)?uC.filter(F=>{var b;return((b=F.data)==null?void 0:b.editType)!==we.ContinueWrite}):i?uC.filter(F=>{var b;return((b=F.data)==null?void 0:b.editType)!==we.ContinueWrite}):uC.slice(0);case it.TextSelected:case it.BlockSelected:{const F=[];if(l&&t===it.BlockSelected)return lde.slice(0);const b=(g=(p=J.ui.selectedBlocks[0])==null?void 0:p.blockId)!=null?g:"",{isInMindMap:w,isMindMapPage:E}=V_(b);if(J.ui.selectedBlocks.length===1&&i){if(w)return wh.map(T=>T.type==="Translate"?d:T).filter(T=>{var v;return((v=T.data)==null?void 0:v.icon)==="IcTranslate"});if(E)return wh.map(T=>T.type==="Translate"?d:T).filter(T=>{var v,I;return((v=T.data)==null?void 0:v.icon)==="IcTranslate"||((I=T.data)==null?void 0:I.editType)===we.ContinueWrite})}if(J.ui.selectedBlocks.length===1&&E)return wh.map(T=>T.type==="Translate"?d:T);if(a&&!l)return DA.slice(3,8).forEach(T=>{var v;if(((v=T.data)==null?void 0:v.editType)!==we.Summary){if(T.type==="Translate")return F.push(d);F.push(T)}}),Yx(F);const{blocks:C}=J,k=s.current.find(T=>{var v;return((v=C[T])==null?void 0:v.type)===m.BlockType.CODE});return DA.forEach(T=>{if(T.type==="AiStyle")return F.push(u);if(T.type==="Translate")return F.push(d);if(T.type==="Code"){k&&F.push({type:H.LINE},{type:H.OPERATION,data:{icon:"IcNote",title:"代码注释",editType:we.Comment,uuid:"67f734b6-020d-47db-b6f1-81d718af72ad"}},{type:H.OPERATION,data:{icon:"IcRepair",title:"程序修复",editType:we.BugFix,uuid:"9c0fa67f-39b7-472c-9114-55736adab50e"}},{type:H.OPERATION,data:{icon:"IcCodeRewriting",title:"代码改写",uuid:"6b4887d4-2f0f-4cbc-a005-3c6ca9a009c5",hasArrow:!0,renderSubMenu:()=>r.jsx(mde,{onItemClick:n})}});return}F.push(T)}),Yx(F)}case it.TextSelectedAndWroteByAI:case it.BlockSelectedAndWroteByAI:{if(a){let C=[];const k=c.current===we.Summarize||c.current===we.Explain;return o?(k||l)&&(C=[{type:H.OPERATION,data:{icon:"IcBtnNew",title:"插入至多维表说明",editType:we.InsertToBitableDesc}},{type:H.OPERATION,data:{icon:"IcEdit",title:"继续写作",editType:we.ContinueWrite}}]):k?C=[{type:H.OPERATION,data:{icon:"IcBtnNew",title:"插入",editType:we.Insert}},{type:H.OPERATION,data:{icon:"IcBtnNew",title:"插入至多维表说明",editType:we.InsertToBitableDesc}},{type:H.OPERATION,data:{icon:"IcEdit",title:"继续写作",editType:we.ContinueWrite}}]:C=[{type:H.OPERATION,data:{icon:"IcBtnNew",title:"插入",editType:we.Insert}}],C.unshift({type:H.OPERATION,data:{icon:"IcTurnInto",title:"替换",editType:we.Replace}}),C.push({type:H.LINE},{type:H.OPERATION,data:{icon:"IcTryAgain",title:"重试",editType:we.TryAgain}},{type:H.OPERATION,data:{icon:"IcTrash",title:"放弃",editType:we.Discard}}),C}const F=(x=(_=J.ui.selectedBlocks[0])==null?void 0:_.blockId)!=null?x:"",{isInMindMap:b,isMindMapPage:w}=V_(F);return b?Kx.filter(C=>{var k;return((k=C.data)==null?void 0:k.editType)!==we.ContinueWrite}):!i&&w?Kx.filter(C=>{var k,T;return((k=C.data)==null?void 0:k.editType)!==we.ContinueWrite&&((T=C.data)==null?void 0:T.editType)!==we.Replace}):w?Kx.filter(C=>{var k,T;return((k=C.data)==null?void 0:k.editType)!==we.ContinueWrite&&((T=C.data)==null?void 0:T.editType)!==we.Insert}):Kx.slice(0)}default:return[]}},My=new Set([we.Chinese,we.ClassicalChinese,we.English,we.Korean,we.Japanese,we.French,we.German,we.OtherLanguage]),R8=e=>{const t=rr(()=>localStorage.getItem(WN));return r.jsx(ze,{className:Ra,items:rde.map(n=>({type:H.BLOCK_ITEM,data:{...n,textClassName:t?void 0:"text-red",rightText:t?void 0:"NEW"}})),keyDownPriority:dr+2,onItemClick:n=>{localStorage.setItem(w1,JSON.stringify(!0)),e.onItemClick(n)}})},P8=Symbol("Editor Model"),_E=new Map,Xa=e=>{var t,n;return(n=_E.get(e))!=null?n:(t=document.querySelector('[data-editor="'.concat(e,'"]')))==null?void 0:t[P8]},fd=(e,t,n)=>{const s=[];return t&&(s.push(t),s.push("::")),n&&(s.push(n),s.push("::")),s.push(e),s.join("")},YN=e=>BW({extensions:[{id:"editable",initialize:n=>{e.forEach(s=>{s.initialize(n)})}}]}),xE=(e,t)=>{_E.set(e,t)},yE=e=>{_E.delete(e)},L8=y.createContext(void 0),af=e=>{const t=Ks(),n=y.useContext(Vo);return fd(e,n,t)};let XN;const pde=e=>{XN=e},B8=(e=XN,t)=>{var a;const n=YN(e),s=new n(t);for(const o of e)(a=o.postInit)==null||a.call(o,s);return s},Nn=()=>{const e=Ks(),t=y.useContext(Vo);function n(s,a,o=XN){const i=fd(s,t,e);return gde(i,!!a,o)}return y.useCallback(n,[t,e])},gde=(e,t,n)=>{let s=_E.get(e);return!s&&t&&(s=B8(n,e),xE(e,s)),s},Ro=(e,t,n)=>{var i,l;const s=pe().blocks[e];if(!s)return;const a=Pn();if(a.uuid===s.uuid)return;if(re(Sn({uuid:e,patch:{status:n?m.BlockStatus.DELETED_COMPLETE:m.BlockStatus.DELETED,...fu()},ignoreOp:t})),s.isTemplate){const c=s.parentId,d=pe().blocks[c];if(d!=null){const u=(i=d.templatePages)!=null?i:[],f=fL(u,e);re(Sn({uuid:c,patch:{templatePages:f,...fu()},ignoreOp:t}))}}else re(Tr({uuid:e,ignoreOp:t}));((l=a.customTemplates)==null?void 0:l.includes(e))&&TN(e,{parentId:a.uuid,...fu()},t),fm(e,s.parentId)},lr=e=>e.map(t=>t.blockId),Bu=(e,t,n)=>Array.isArray(e)?e.map(s=>({blockId:s,viewId:t,syncId:n})):[{blockId:e,viewId:t,syncId:n}],_de=(e,t)=>H_.has(t)?"".concat(e,',以大纲形式返回数据，第一行需要有标题，去掉非大纲的内容，结尾不需要总结，返回的格式为 """# "${标题}"\n ## "${二级标题}"\n ### "${三级标题}"\n #### "${四级标题}"\n """  '):e,xde=e=>{if(!e)return;const t=ue(ud(e));if(!isNaN(t.toDate().getTime())){if(e.type===m.TextType.DATE)return{dateString:t.format(Et),timestamp:t.valueOf(),textType:m.TextType.DATE};if(e.type===m.TextType.DATETIME)return{dateString:t.format(On),timestamp:t.valueOf(),textType:m.TextType.DATETIME}}},bE=(e,t="ungroup",n=!1)=>{var o;const{groupBy:s,subGroupBy:a}=(o=gn(e))!=null?o:{};return"viewId:".concat(e,";groupProperty:").concat(n?a==null?void 0:a.property:s==null?void 0:s.property,";groupName:").concat(t)},va=(e,t)=>{var s,a;if(!e)return;const n=(a=(s=e.data.collectionProperties)==null?void 0:s[t])==null?void 0:a.find(o=>o.type===m.TextType.DATE||o.type===m.TextType.DATETIME);if(n)return xde(n)},Oi=e=>{const t=e==null?void 0:e.find(n=>n.type===m.TextType.URL);return(t==null?void 0:t.url)||(t==null?void 0:t.text)||fe(e)},$o=()=>Np,Np=(e,t,n,s={needTransaction:!0,ignoreOp:!1})=>{const a=()=>{var f,h,p;const{blocks:o}=pe(),i=o[e];if(!i)return;const c=((f=i.data.schema)!=null?f:{})[t];if(!c)return;const d=[...(p=(h=n.options)!=null?h:c.options)!=null?p:[]],u=new Set(d.map(g=>g.value));(n.type===m.CollectionSchemaType.SELECT||n.type===m.CollectionSchemaType.MULTI_SELECT||n.type===m.CollectionSchemaType.DATE)&&i.subNodes.map(g=>o[g]).forEach(g=>{var F,b;if(!g)return;const _=(b=(F=g.data.collectionProperties)==null?void 0:F[t])!=null?b:[],x=fe(_);if(n.type===m.CollectionSchemaType.DATE){const w=ue(x);if(w.isValid()){const E=w.hour()===0&&w.minute()===0&&w.second()===0;_e(g.uuid,{data:{collectionProperties:{...g.data.collectionProperties,[t]:[{type:E?m.TextType.DATE:m.TextType.DATETIME,enhancer:{},text:x,startDate:w.format(Et),startTime:E?void 0:w.format(co)}]}}},s.ignoreOp)}}else x.split(",").forEach(w=>{var E;w=w.trim(),w&&(u.has(w)||(u.add(w),d.push({id:qe(),color:(E=nm(vr.map(C=>C.key)))!=null?E:vr[0].key,value:w})))})}),EI(e,{[t]:{...c,showAs:s.isUpdateNumberFormat?void 0:c.showAs,...n,options:d}},s)};s!=null&&s.needTransaction?hn(()=>{a()}):a()},FE=[{zh:"数字",en:"number",pingyin:"shuzi",example:"123"},{zh:"整数",en:"integer",pingyin:"zhengshu",example:"123"},{zh:"一位小数",en:"oneDecimal",pingyin:"yiweixiaoshu",example:"1.0"},{zh:"两位小数",en:"twoDecimal",pingyin:"liangweixiaoshu",example:"1.00"},{zh:"千分位",en:"thousandth",pingyin:"qianfenwei",example:"1,000"},{zh:"百分数(一位小数)",en:"percentOneDecimal",pingyin:"baifenshuyiweixiaoshu",example:"1.0%"},{zh:"百分数(两位小数)",en:"percent",pingyin:"baifenshuliangweixiaoshu",example:"1.00%"},{zh:"人民币",en:"rmb",pingyin:"renminbi",symbol:"CN¥",example:"CN¥100.00"},{zh:"美元",en:"dollar",pingyin:"meiyuan",symbol:"US$",example:"US$100.00"},{zh:"日元",en:"yen",pingyin:"riyuan",symbol:"JP¥",example:"JP¥100.00"},{zh:"欧元",en:"euro",pingyin:"ouyuan",symbol:"€",example:"€100.00"},{zh:"卢布",en:"rub",pingyin:"lubu",symbol:"₽",example:"₽100.00"}],yde=()=>{const{readonly:e}=Ne(),t=ie(),n=(s,a)=>{s.stopPropagation(),!e&&t.dropdown({popcorn:s.currentTarget,placement:"bottom",content:({onCloseModal:o})=>r.jsx(O8,{closeModal:o,propertyId:a})})};return y.useCallback(n,[t,e])},O8=e=>{var h,p;const{closeModal:t,propertyId:n}=e,{collectionId:s}=Ne(),[a,o]=y.useState(""),i=y.useRef(null),l=$o(),c=ye(s,["data"],["schema"]),{numberFormat:d}=(p=(h=c==null?void 0:c.data.schema)==null?void 0:h[n])!=null?p:{},u=[],f=new RegExp(a,"i");return FE.forEach((g,_)=>{const x=g.en+g.zh+g.pingyin;_===7&&u.push({type:H.LINE}),x.search(f)>-1&&u.push({type:H.OPERABLE_BLOCK_TEXT,data:{title:g.zh,followTitle:!0,selected:d===g.en,desc:g.example,...g}})}),r.jsxs("div",{className:"w-[220px] py-2 next-modal",children:[r.jsx(Ct,{autoFocus:!0,inputRef:i,placeholder:"搜索格式",className:"h-8 flex-1 border-grey6 rounded-sm m-2",inputClassName:"px-2",onEnter:()=>t==null?void 0:t(),onChange:g=>o(g)}),r.jsx(ze,{className:"overflow-auto max-h-120",items:u,onItemClick:g=>{var F,b,w;t==null||t();const{blocks:_}=pe(),{numberFormat:x}=(w=(b=(F=_[s])==null?void 0:F.data.schema)==null?void 0:b[n])!=null?w:{};x!==g.data.title&&l(s,n,{numberFormat:g.data.en},{needTransaction:!0,isUpdateNumberFormat:!0})}})]})};var Ye=(e=>(e[e.CELL=0]="CELL",e[e.FIELD=1]="FIELD",e[e.CARD=2]="CARD",e[e.LIST=3]="LIST",e[e.CALENDAR=4]="CALENDAR",e))(Ye||{});const BT=({width:e,height:t=3,percent:n=.25,bgColor:s,progressColor:a,className:o})=>r.jsx("div",{className:R("rounded-full overflow-hidden",o),style:{backgroundColor:s,height:t,width:e},children:r.jsx("div",{className:"h-full rounded-full",style:{backgroundColor:a,width:lo(n)}})}),OT=e=>{const{levelSymbol:t="⭐️",totalScore:n=5,score:s=0,className:a}=e,o=[];Array.from({length:n}).forEach((l,c)=>{o.push(r.jsx(fn.Fragment,{children:bde[t]},c))});const i=Math.min(s,n);return r.jsxs("div",{className:R("relative",a),children:[r.jsx("div",{style:{clipPath:"inset(0 ".concat(lo(1-i/n)," 0 0)")},className:"min-w-max flex",children:o}),r.jsx("div",{style:{clipPath:"inset(0 0 0 ".concat(lo(i/n),")")},className:"absolute inset-0 bg-white1 opacity-20 min-w-max flex",children:o})]})},bde={"⭐️":r.jsx("img",{src:"".concat(wo,"/score/1.png"),className:"w-4 h-4",alt:"⭐️"}),"❤️":r.jsx("img",{src:"".concat(wo,"/score/2.png"),className:"w-4 h-4",alt:"❤️"}),"💡":r.jsx("img",{src:"".concat(wo,"/score/3.png"),className:"w-4 h-4",alt:"💡"}),"🔥":r.jsx("img",{src:"".concat(wo,"/score/4.png"),className:"w-4 h-4",alt:"🔥"}),"👍":r.jsx("img",{src:"".concat(wo,"/score/5.png"),className:"w-4 h-4",alt:"👍"}),"😀":r.jsx("img",{src:"".concat(wo,"/score/6.png"),className:"w-4 h-4",alt:"😀"}),"☘️":r.jsx("img",{src:"".concat(wo,"/score/7.png"),className:"w-4 h-4",alt:"☘️"}),"🟡️":r.jsx("img",{src:"".concat(wo,"/score/8.png"),className:"w-4 h-4",alt:"🟡️"}),"🔷":r.jsx("img",{src:"".concat(wo,"/score/9.png"),className:"w-4 h-4",alt:"🔷"}),"⬛":r.jsx("img",{src:"".concat(wo,"/score/10.png"),className:"w-4 h-4",alt:"⬛"})},MT=e=>{const{percent:t,size:n=20,ringWidth:s=3,className:a,ringColorClassName:o,ringColor:i}=e,l=Math.min(1,t);return r.jsx("div",{className:R("relative rounded-full border-solid",a),style:{width:n,height:n,borderWidth:s},children:r.jsxs("div",{className:"absolute inset-0",style:{width:n,height:n,top:-s,left:-s,clipPath:l<.5?"inset(0 0 0 50%)":"unset"},children:[r.jsx("div",{className:R("absolute w-full h-full rounded-full border-solid",o),style:{borderWidth:s,borderColor:i,clipPath:"inset(0 50% 0 0)",transform:"rotate(".concat(l<=.5?l/.5*180:180,"deg)")}}),l>.5&&r.jsx("div",{className:R("absolute w-full h-full rounded-full border-solid",o),style:{borderWidth:s,clipPath:"inset(0 0 0 50%)",transform:"rotate(".concat((l-.5)/.5*180,"deg)"),borderColor:i}})]})})},E1=e=>{const{num:t,showAs:n={},numberFormat:s}=e,{levelSymbol:a,type:o,color:i,maxValue:l}=n;if(!l)return null;const c="".concat(t," / ").concat(l);let d=null;return o===m.NumberShowType.BAR&&i?d=r.jsx(Fe,{popup:c,offset:[0,-3],className:"max-w-[300px] min-w-[80px] w-[60%] flex-shrink-0 ml-2 self-stretch flex items-center cursor-pointer",children:r.jsx(BT,{height:5,className:"w-full",percent:s!=null&&s.includes("percent")?t:t/l,bgColor:Ph(i),progressColor:Hd(i)})}):o===m.NumberShowType.RING&&i?d=r.jsx(Fe,{popup:c,offset:[0,-3],className:"ml-2 flex-shrink-0 cursor-pointer",children:r.jsx(MT,{size:20,percent:s!=null&&s.includes("percent")?t:t/l,bgColor:Ph(i),ringColor:Hd(i)})}):o===m.NumberShowType.LEVEL&&a&&(d=r.jsx(Fe,{popup:c,className:"ml-2 whitespace-nowrap cursor-pointer",children:r.jsx(OT,{levelSymbol:a,totalScore:l,score:s!=null&&s.includes("percent")?l*t:t,className:"flex-shrink-0"})})),d},jp=e=>!e.text||e.text==="undefined"?null:r.jsx("button",{"data-disable-select":!0,className:R("flex w-6 h-6 right-1 space-x-1 group-scope-hover:opacity-100 absolute top-[5px] opacity-0 transition-opacity",e.className),hidden:![Ye.CELL,Ye.FIELD].includes(e.site),children:r.jsx("span",{onClick:t=>{t.stopPropagation(),Xt(e.text)},className:"rounded border bg-white1 p-0.5 animate-hover animate-click",children:r.jsx(Fe,{popup:"复制",children:r.jsx(V,{size:"middle",name:"IcMenuCopy",className:"text-grey3"})})})}),hl=(e,t)=>{var s,a;if(Number.isNaN(e))return;if(!t||t==="number")return dE(e);if(t==="integer")return Math.round(e);if(t==="oneDecimal")return Number(e).toFixed(1);if(t==="twoDecimal")return Number(e).toFixed(2);if(t==="thousandth"){const[o,i]=String(e).split(".");let l=ST(o!=null?o:"");return i&&(l=l.concat(".",i)),l}return t==="percentOneDecimal"?lo(e,1):t==="percent"?lo(e):((a=(s=FE.find(o=>o.en===t))==null?void 0:s.symbol)!=null?a:"").concat("",ST(Number(e).toFixed(2)))},M8=({className:e,site:t,recordId:n,propertyId:s})=>{const{collectionId:a,readonly:o}=Ne(),i=y.useRef(null),l=yde(),[c,d]=y.useState(!0),u=ft(a,x=>{var F;return(F=x==null?void 0:x.data.schema)==null?void 0:F[s]}),{numberFormat:f,showAs:h}=u!=null?u:{},p=Ce(x=>{var k,T,v,I,j,S;const{blocks:F}=x,b=(T=(k=F[a])==null?void 0:k.data.schema)==null?void 0:T[s];if((b==null?void 0:b.type)===m.CollectionSchemaType.FORMULA){const A=$n(a,x).getValue(n,s);return A==null?NaN:A}const w=(I=(v=F[n])==null?void 0:v.data.collectionProperties)==null?void 0:I[s],E=fe(w);let C=parseFloat(E);return Number.isNaN(C)&&(C=parseFloat((S=(j=E.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:j[0])!=null?S:"")),C},[a,n,s]),g=hl(p,f);let _;return p!==void 0&&(_=E1({num:Math.max(0,p),showAs:h,numberFormat:f,from:"num"})),y.useEffect(()=>{var F;const x=(F=i.current)==null?void 0:F.getBoundingClientRect().width;x&&x<80&&d(!1)},[]),r.jsxs("div",{ref:i,className:R("group-scope number-box w-full overflow-hidden p-2 leading-[20px] min-h-[36px]",t!==Ye.FIELD&&"text-right",e),children:[typeof g<"u"?r.jsxs("div",{className:R("items-center flex min-h-[20px]",t!==Ye.FIELD&&"justify-end"),children:[_&&!(h!=null&&h.showNumber)?void 0:g,_]}):t===Ye.FIELD&&r.jsx("span",{className:"text-grey4",children:Wa.isEmpty}),(t===Ye.CELL||t===Ye.FIELD)&&!o&&r.jsx("button",{onClick:x=>l(x,s),className:R("absolute top-1.5 flex items-center justify-center w-6 h-6 rounded cursor-pointer border-grey6 border bg-white1 animate-hover-opaque opacity-0",{"left-1":t===Ye.CELL,"right-8":t===Ye.FIELD}),children:r.jsx(V,{name:"IcMenuNum",size:"middle",className:"text-grey3"})}),c&&r.jsx(jp,{text:"".concat(g),site:t,className:t===Ye.CELL?"left-8":"right-1"})]})};function Tg({className:e,value:t,icon:n,title:s,shortTitle:a,content:o,placeholder:i,onChange:l,readonly:c,Dropdown:d,dropdownProps:u}){const f=ie(),h=ln(),p=rr(qe),g=_=>{c||f.dropdown({modalId:p,popcorn:_.currentTarget,content:d,placement:"bottom-start",contentProps:{...u,value:t,onCloseModal:()=>h(p),onChange:x=>l==null?void 0:l(x)}})};return r.jsxs("div",{className:R("flex h-8 cursor-pointer border-grey5 group hover:border-grey1 border rounded px-2 items-center text-black",e),onClick:_=>{g(_)},children:[r.jsx("div",{className:"flex flex-1 overflow-hidden overflow-ellipsis whitespace-nowrap",children:o||(t!=null?r.jsx(Fe,{popup:a?s:null,children:r.jsxs("div",{className:"flex items-center",children:[n&&r.jsx(V,{size:"middle",className:"mr-1",name:n}),r.jsx("span",{className:"whitespace-nowrap",children:a!=null?a:s})]})}):r.jsx("span",{className:"text-grey4",children:i}))}),r.jsx(V,{size:"xxsmall",className:"text-grey4 group-hover:text-grey1 ml-1",name:"IcArrowDown01"})]})}function U8({className:e,value:t,icon:n,title:s,content:a,placeholder:o,onChange:i,readonly:l,Dropdown:c,dropdownProps:d}){const u=ie(),f=ln(),h=rr(qe),p=g=>{l||u.dropdown({modalId:h,popcorn:g.currentTarget,content:c,placement:"bottom-start",contentProps:{...d,value:t,onCloseModal:f,onChange:_=>{i==null||i(_),f(h)}}})};return r.jsxs("div",{className:R("flex text-t2 px-[6px] h-5 cursor-pointer hover:bg-black_006 rounded-sm items-center text-black",e),onClick:g=>{p(g)},children:[r.jsx("div",{className:"flex flex-1 overflow-hidden overflow-ellipsis",children:a||(t!=null?r.jsxs("div",{className:"flex items-center",children:[n&&r.jsx(V,{size:"middle",className:"mr-1",name:n}),r.jsx("span",{className:"text-grey3 whitespace-nowrap",children:s})]}):r.jsx("span",{className:"text-grey4",children:o}))}),!l&&r.jsx(V,{size:"xxsmall",className:"ml-2 text-grey4",name:"IcArrowDown01"})]})}const Km=(e,t)=>ft(e,n=>{var s;return(s=n==null?void 0:n.data.collectionProperties)==null?void 0:s[t]},[t]),V8=({name:e,icon:t,size:n="default",spaceName:s,className:a,backgroundColor:o})=>r.jsxs("div",{className:R("flex items-center overflow-hidden whitespace-nowrap leading-5",a),title:e,children:[r.jsx(ar,{className:R("!text-t2-medium mr-2 rounded-md text-white",n==="small"&&"!h-5 !w-5",n==="xsmall"&&"!text-t4-medium !h-4 !w-4"),name:s||"未",icon:t,color:o,iconSize:n==="small"?20:24}),r.jsx("span",{className:"text-ellipsis",children:e})]}),$8=({name:e,icon:t,size:n="default",className:s})=>r.jsxs("div",{className:R("flex items-center overflow-hidden whitespace-nowrap leading-5",s),title:e,children:[r.jsx(ar,{className:R("!text-t2-medium mr-2 rounded-md text-white",n==="small"&&"!h-5 !w-5",n==="xsmall"&&"!text-t4-medium !h-4 !w-4"),name:e||"未",icon:t,iconSize:n==="small"?20:24}),r.jsx("span",{className:"text-ellipsis",children:e})]}),si=({userId:e,className:t,size:n="default"})=>{const s=Pi(e),a=_r(e,s==null?void 0:s.nickname);return r.jsxs("div",{className:R("flex items-center overflow-hidden whitespace-nowrap leading-5",t),title:a||(s==null?void 0:s.phone),children:[r.jsx(ar,{className:R("!text-t2-medium mr-2 rounded-full text-white",{"!h-5 !w-5":n==="small"},{"!text-t4-medium h-4 w-4":n==="xsmall"}),imgClassName:"rounded-full",name:a||"客",color:(s==null?void 0:s.backgroundColor)||void 0,icon:s!=null&&s.avatar?{type:"upload",value:s.avatar}:void 0,iconSize:n==="small"?20:24}),r.jsx("span",{className:"text-ellipsis",children:a||(s==null?void 0:s.phone)})]})},Fde=({recordId:e,className:t,site:n})=>{const s=ft(e,a=>a==null?void 0:a.updatedBy);return s==null?null:r.jsx(si,{className:R("my-px",t,(n===Ye.FIELD||n===Ye.CELL)&&"px-2 py-1.5"),size:Hh(n)?"xsmall":"default",userId:s})},wde=({recordId:e,className:t,site:n})=>{const s=ft(e,a=>a==null?void 0:a.createdBy);return s==null?null:r.jsx(si,{className:R(t,"my-px",(n===Ye.FIELD||n===Ye.CELL)&&"px-2 py-1.5"),size:Hh(n)?"xsmall":"default",userId:s})},Hh=e=>e===Ye.CARD||e===Ye.LIST||e===Ye.CALENDAR,wE=({userId:e,showClose:t,onClose:n,site:s,type:a=m.PermissionType.USER})=>{var l;const o=Dt(),i=(l=o.permissionGroups)==null?void 0:l.find(c=>c.id===e);return r.jsxs("div",{className:R("text-t2 flex min-w-0 flex-nowrap items-center",(s===Ye.CARD||s===Ye.LIST||s===Ye.CALENDAR)&&"mr-2"),children:[a===m.PermissionType.USER?r.jsx(si,{userId:e,size:Hh(s)?"xsmall":"default",className:R("my-px",Hh(s)?"":"px-2 py-1.5",(s===Ye.CARD||s===Ye.LIST||s===Ye.CALENDAR)&&"text-t4")}):a===m.PermissionType.GROUP?r.jsx($8,{name:i==null?void 0:i.name,icon:i==null?void 0:i.icon,className:R("my-px",Hh(s)?"":"px-2 py-1.5",(s===Ye.CARD||s===Ye.LIST||s===Ye.CALENDAR)&&"text-t4")}):r.jsx(V8,{name:"全体成员",icon:o.icon,backgroundColor:o.backgroundColor,className:R("my-px",Hh(s)?"":"px-2 py-1.5",(s===Ye.CARD||s===Ye.LIST||s===Ye.CALENDAR)&&"text-t4")}),t&&r.jsx(V,{size:"middle",className:"text-brown ml-[-8px] cursor-pointer opacity-50",onClick:n,name:"IcToastClose"})]})},ru=e=>{if(!e)return[];const t=new Map;return e.forEach(n=>{n.type===m.TextType.USER&&n.uuid&&t.set(n.uuid,n)}),[...t.values()]},Ede=({recordId:e,propertyId:t,site:n,className:s})=>{const a=Km(e,t),o=ru(a);return r.jsx("div",{className:R("flex",n===Ye.LIST||n===Ye.CALENDAR?"":"flex-wrap",n===Ye.FIELD&&Mn({selectors:{":empty:before":{content:"'".concat(Wa.isEmpty,"'"),display:"block",fontSize:"14px",padding:"8px",color:"var(--grey4)",lineHeight:"20px"}}}),s),children:o.map(i=>{var l;return r.jsx(wE,{userId:(l=i.uuid)!=null?l:"",site:n},i.uuid)})})},Cde=({className:e,value:t,onChange:n})=>{const{isLocked:s}=Ne(),a=M0();return r.jsx(Tg,{readonly:s,className:e,value:t,content:t==="me"?"我":t&&r.jsx(si,{className:"!px-0",userId:t}),onChange:n,Dropdown:Tde,dropdownProps:{value:t,users:a}})},kde=({noMe:e=!1,users:t,value:n,onCloseModal:s,onChange:a})=>{const[o,i]=y.useState(""),l=[...e?[]:[{type:H.OPERATION,data:{content:r.jsx("span",{children:"我"}),value:"me",thesaurus:"我 wo",onClick:()=>{a==null||a("me"),s()}}}],...lc(t,o).map(c=>({type:H.OPERATION,data:{content:r.jsx(si,{className:"!px-0",userId:c.uuid}),value:c.uuid,onClick:()=>{a==null||a(c.uuid),s()}}}))];return r.jsxs(r.Fragment,{children:[r.jsx(Ct,{autoFocus:!0,className:"mx-2.5 mt-[2px] mb-[6px] h-8",value:o,onChange:c=>{i(c)}}),r.jsx(ze,{className:"text-t2 max-h-[50vh] overflow-y-auto",defaultActiveIndex:l.findIndex(c=>c.data.value===n),items:l})]})},Tde=({...e})=>r.jsx("div",{className:"next-modal py-2",children:r.jsx(kde,{...e})}),zh=(e,t)=>{if(t)switch(t){case m.GroupLevel.RELATIVE:{const n=ue(ue(e).format(Et)).valueOf(),s=ue(ue(Date.now()).format(Et)).valueOf();return n===s?"today":n===s+Kn?"tomorrow":n===s-Kn?"yesterday":n>s+Kn&&n<=s+7*Kn?"next_7_day":n>s+7*Kn&&n<=s+30*Kn?"next_30_day":n<s-Kn&&n>=s-7*Kn?"last_7_day":n<s-7*Kn&&n>=s-30*Kn?"last_30_day":n>s+30*Kn?"after_next_30_day":n<s-30*Kn?"before_last_30_day":""}case m.GroupLevel.DAY:return ue(e).format(Et);case m.GroupLevel.WEEK:{const n=e-Kn*((ue(e).day()||7)-1);return"".concat(ue(n).format(Et))}case m.GroupLevel.MONTH:return"".concat(ue(e).date(1).format(Et));case m.GroupLevel.YEAR:return"".concat(ue(e).month(0).date(1).format(Et))}},b_=e=>{const t=ue(ue(Date.now()).format(Et)).valueOf();return e==="today"?t:e==="tomorrow"?t+Kn:e==="yesterday"?t-Kn:e==="next_7_day"?t+2*Kn:e==="next_30_day"?t+8*Kn:e==="after_next_30_day"?t+31*Kn:e==="last_7_day"?t-2*Kn:e==="last_30_day"?t-8*Kn:e==="before_last_30_day"?t-31*Kn:ue(e).valueOf()},AA=(e,t,n,s)=>{let a="";if(e>=t&&e<n){const o=new Go(t).plus(new Go(Math.floor((e-t)/s)).multipliedBy(new Go(s)));a="".concat(o,",").concat(Go.sum(o,s).toNumber())}else a="out_of_range";return a},md=({className:e,color:t,label:n,value:s,showClose:a,onClick:o,onDelete:i})=>{Pa();const l=J1(t),c=ow(t);return r.jsxs("span",{className:R("h-5 inline-flex items-center rounded-sm pl-[6px] overflow-hidden text-t2 leading-[20px]",{"pr-[6px]":!a},e),style:{color:c,backgroundColor:l},onClick:o,children:[r.jsx("span",{className:"overflow-ellipsis overflow-x-hidden whitespace-nowrap",children:n!=null?n:s}),a&&r.jsx("button",{className:"opacity-80 flex-shrink-0 w-5 h-5 inline-block",onClick:i,children:r.jsx(V,{name:"IcToastClose",className:"w-full h-full",size:"auto"})})]})},QN=Mr({}),H8=({blocks:e,propertyId:t,schema:n,formulaTool:s,users:a=pe().users})=>{const o=e.map(l=>{var c,d,u,f,h,p,g,_,x,F,b;if(l)switch(n.type){case m.CollectionSchemaType.CREATED_AT:return ue(l.createdAt).format(On);case m.CollectionSchemaType.UPDATED_AT:return ue(l.updatedAt).format(On);case m.CollectionSchemaType.CREATED_BY:return l.createdBy;case m.CollectionSchemaType.UPDATED_BY:return l.updatedBy;case m.CollectionSchemaType.PERSON:return((d=(c=l.data.collectionProperties)==null?void 0:c[t])!=null?d:[]).filter(C=>{var k;return C.type===m.TextType.USER&&a[(k=C.uuid)!=null?k:""]}).map(C=>C.uuid).filter(C=>!!C);case m.CollectionSchemaType.DATE:{const w=va(l,t);return w&&w.dateString}case m.CollectionSchemaType.TITLE:return fe(l.data.segments);case m.CollectionSchemaType.NUMBER:{const w=fe((u=l.data.collectionProperties)==null?void 0:u[t]);let E=parseFloat(w);return Number.isNaN(E)&&(E=parseFloat((h=(f=w.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:f[0])!=null?h:"")),Number.isNaN(E)?void 0:String(E)}case m.CollectionSchemaType.FILE:return((g=(p=l.data.collectionProperties)==null?void 0:p[t])!=null?g:[]).filter(C=>C.type===m.TextType.URL&&C.fileStorageType==="internal").map(C=>C.url).filter(C=>!!C);case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:{const w=(_=l.data.collectionProperties)==null?void 0:_[t];return Oi(w)}case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{const E=fe((x=l.data.collectionProperties)==null?void 0:x[t]).trim().split(/\s*,\s*/g).map(C=>{var k,T;return(T=(k=n.options)==null?void 0:k.find(v=>v.value===C))==null?void 0:T.id}).filter(C=>!!C);return n.type===m.CollectionSchemaType.SELECT?E[0]:E}case m.CollectionSchemaType.FORMULA:{const w=s.getType(t),E=s.getValue(l.uuid,t);return w===et.ValueTool.booleanType?E?"YES":"NO":E==null?void 0:w===et.ValueTool.dateType?ue(E).format(On):w===et.ValueTool.numberType?dE(E):"".concat(E)}case m.CollectionSchemaType.RELATION:return wc(l.uuid,t).relationRecords;case m.CollectionSchemaType.CHECKBOX:{const w=fe((F=l.data.collectionProperties)==null?void 0:F[t]);return us(w)?"YES":"NO"}default:return fe((b=l.data.collectionProperties)==null?void 0:b[t]).trim()}}),i=o.filter(l=>typeof l=="string"&&l!==""||Array.isArray(l)&&l.length>0);return{allCellValues:o,notEmptyCellValues:i}};let z8;const vde=e=>{z8=e},Ide=(...e)=>z8(...e),Rl=void 0,JN=(e,t,n,s,a)=>{var x;const{propertySchema:o,targetPropertySchema:i}=ii(s,t);if(!o)return;const{type:l,aggregation:c}=o,d=i==null?void 0:i.type;let u,f,h,p=[],g=[];const _=l===m.CollectionSchemaType.ROLLUP;if(!fl(n)&&!_){const F=H8({blocks:e,propertyId:t,schema:o,formulaTool:a});p=F.allCellValues,g=F.notEmptyCellValues}switch(_&&(p=e.map(F=>{var C;if(!F)return;const{originValues:b,aggregationValue:w,relationRecords:E=[]}=(C=Ide(F.uuid,t))!=null?C:{};return ni(c)?d===m.CollectionSchemaType.TITLE?E:b:qm(c)?w?String(V0(w)):void 0:w}),g=p.filter(F=>typeof F=="string"&&F!==""||Array.isArray(F)&&F.length>0)),n){case m.AggregationAction.NONE:break;case m.AggregationAction.COUNT_ALL:case m.AggregationAction.COUNT_UNIQUE_VALUE:case m.AggregationAction.COUNT_VALUE:case m.AggregationAction.COUNT_EMPTY:case m.AggregationAction.COUNT_NOT_EMPTY:case m.AggregationAction.PERCENT_EMPTY:case m.AggregationAction.PERCENT_NOT_EMPTY:{switch(n){case m.AggregationAction.COUNT_ALL:u=e.length;break;case m.AggregationAction.COUNT_VALUE:{_?u=g.flat(1/0).filter(F=>!!F).length:u=g.flat(1/0).length;break}case m.AggregationAction.COUNT_UNIQUE_VALUE:u=new Set(g.flat(1/0)).size;break;case m.AggregationAction.COUNT_EMPTY:{u=e.length-g.length;break}case m.AggregationAction.COUNT_NOT_EMPTY:u=g.length;break;case m.AggregationAction.PERCENT_EMPTY:u=e.length===0?Rl:lo(Sx(e.length-g.length,e.length));break;case m.AggregationAction.PERCENT_NOT_EMPTY:u=e.length===0?Rl:lo(Sx(g.length,e.length));break}break}case m.AggregationAction.SUM:case m.AggregationAction.AVERAGE:case m.AggregationAction.MEDIAN:case m.AggregationAction.MIN:case m.AggregationAction.MAX:case m.AggregationAction.RANGE:{const F=g.map(Number).filter(b=>!isNaN(b));if(F.length===0){u=0;break}switch(n){case m.AggregationAction.SUM:if(F.includes(1/0)&&F.includes(-1/0)){u=Rl;break}u=Go.sum(...F).toNumber();break;case m.AggregationAction.AVERAGE:if(F.includes(1/0)&&F.includes(-1/0)){u=Rl;break}u=Go.sum(...F).dividedBy(F.length).toNumber();break;case m.AggregationAction.MIN:u=Go.minimum(...F).toNumber();break;case m.AggregationAction.MAX:u=Go.maximum(...F).toNumber();break;case m.AggregationAction.RANGE:{u=new Go(Math.max(...F)).minus(Math.min(...F)).toNumber();break}case m.AggregationAction.MEDIAN:{const b=F.sort((w,E)=>w-E);if(b.length%2===0){const w=b[b.length/2],E=b[b.length/2-1];if(!w||!E){u=Rl;break}u=Go.sum(w,E).dividedBy(2).toNumber()}else u=(x=b[(b.length-1)/2])!=null?x:0;break}}break}case m.AggregationAction.CHECKED:case m.AggregationAction.UNCHECKED:case m.AggregationAction.PERCENT_CHECKED:case m.AggregationAction.PERCENT_UNCHECKED:{const F=g.filter(b=>typeof b=="string"&&us(b)).length;switch(n){case m.AggregationAction.CHECKED:u=F;break;case m.AggregationAction.UNCHECKED:u=e.length-F;break;case m.AggregationAction.PERCENT_CHECKED:u=e.length===0?Rl:lo(Sx(F,e.length));break;case m.AggregationAction.PERCENT_UNCHECKED:u=e.length===0?Rl:lo(Sx(e.length-F,e.length));break}break}case m.AggregationAction.EARLIEST_DATE:case m.AggregationAction.LATEST_DATE:case m.AggregationAction.DATE_RANGE:{let F=[];if(l===m.CollectionSchemaType.CREATED_AT||l===m.CollectionSchemaType.UPDATED_AT||l===m.CollectionSchemaType.FORMULA){if(l===m.CollectionSchemaType.CREATED_AT)F=e.map(E=>{var C;return(C=E==null?void 0:E.createdAt)!=null?C:0}).sort();else if(l===m.CollectionSchemaType.UPDATED_AT)F=e.map(E=>{var C;return(C=E==null?void 0:E.updatedAt)!=null?C:0}).sort();else if(l===m.CollectionSchemaType.FORMULA){const E=$n(s);F=e.filter(C=>C!=null).map(C=>{const k=E.getBoxedValue(C.uuid,t);return k==null?0:et.ValueTool.typeOf(k)===et.ValueTool.dateType?et.ValueTool.asDate(k).getTime():0}).sort()}const b=F[0],w=An(F);if(!b||!w){u=Rl;break}switch(n){case m.AggregationAction.EARLIEST_DATE:{u=ue(b).format(On),f=u;break}case m.AggregationAction.LATEST_DATE:{u=ue(w).format(On),f=u;break}case m.AggregationAction.DATE_RANGE:{b&&w&&(f=ue(b).format(On),h=ue(w).format(On),u=ue(b).format(On).concat(" - ").concat(ue(w).format(On)));break}}break}if(l===m.CollectionSchemaType.DATE||l){let b=e.map(C=>va(C,t)).filter(C=>C!==void 0);b=wk(b,C=>C.timestamp);const w=b[0],E=An(b);if(!w||!E){u=Rl;break}switch(n){case m.AggregationAction.EARLIEST_DATE:{u=w.dateString,f=u;break}case m.AggregationAction.LATEST_DATE:{u=E.dateString,f=u;break}case m.AggregationAction.DATE_RANGE:{f=w.dateString,h=E.dateString,u=w.dateString.concat(" - ",E.dateString);break}}}if(_){let b=[];c===m.AggregationAction.DATE_RANGE?g.forEach(C=>{typeof C=="string"&&C.split("-").forEach(k=>b.push(k.trim()))}):b=g,b=b.sort();const w=b[0],E=An(b);if(!w||!E){u=Rl;break}switch(n){case m.AggregationAction.EARLIEST_DATE:{f=w,u=w;break}case m.AggregationAction.LATEST_DATE:{f=E,u=E;break}case m.AggregationAction.DATE_RANGE:{f=w,h=E,u=w.concat(" - ",E);break}}}break}}return{result:u,dateStartTimestamp:f,dateEndTimestamp:h}};var q8=(e=>(e.NONE="none",e.COUNT="count",e.PERCENT="percent",e.MORE_OPTION="more_option",e.DATE="date",e))(q8||{});const ZN=[{type:"none",title:pn.none},{type:"count",title:Wa.count},{type:"percent",title:"百分比"}],Nde=[...ZN,{type:"date",title:"日期"}],jde=[...ZN,{type:"more_option",title:"更多选择"}],G8=[{type:m.AggregationAction.COUNT_ALL,title:pn.countAll},{type:m.AggregationAction.COUNT_VALUE,title:pn.countValue},{type:m.AggregationAction.COUNT_UNIQUE_VALUE,title:pn.countUniqueValue},{type:m.AggregationAction.COUNT_EMPTY,title:pn.countEmpty},{type:m.AggregationAction.COUNT_NOT_EMPTY,title:pn.countNotEmpty}],Sde=[G8[0],{type:m.AggregationAction.CHECKED,title:pn.checked},{type:m.AggregationAction.UNCHECKED,title:pn.unchecked}],Dde=[{type:m.AggregationAction.PERCENT_EMPTY,title:pn.percentEmpty},{type:m.AggregationAction.PERCENT_NOT_EMPTY,title:pn.percentNotEmpty}],Ade=[{type:m.AggregationAction.PERCENT_CHECKED,title:pn.percentChecked},{type:m.AggregationAction.PERCENT_UNCHECKED,title:pn.percentUnchecked}],Rde=[{type:m.AggregationAction.SUM,title:pn.sum},{type:m.AggregationAction.AVERAGE,title:pn.average},{type:m.AggregationAction.MEDIAN,title:pn.median},{type:m.AggregationAction.MIN,title:pn.min},{type:m.AggregationAction.MAX,title:pn.max},{type:m.AggregationAction.RANGE,title:pn.range}],Pde=[{type:m.AggregationAction.EARLIEST_DATE,title:pn.earliestDate},{type:m.AggregationAction.LATEST_DATE,title:pn.latestDate},{type:m.AggregationAction.DATE_RANGE,title:pn.dateRange}],Lde=e=>{switch(e){case m.CollectionSchemaType.NUMBER:return[...jde];case m.CollectionSchemaType.DATE:case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:return[...Nde];default:return[...ZN]}},Bde=(e,t)=>{switch(e){case"count":return Ode(t);case"percent":return Mde(t);case"more_option":return Ude(t);case"date":return Vde(t)}},Ode=e=>{switch(e){case m.CollectionSchemaType.CHECKBOX:return Sde;default:return G8}},Mde=e=>{switch(e){case m.CollectionSchemaType.CHECKBOX:return Ade;default:return Dde}},Ude=e=>{switch(e){case m.CollectionSchemaType.NUMBER:return Rde;default:return[]}},Vde=e=>{switch(e){case m.CollectionSchemaType.DATE:case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:return Pde;default:return[]}},$de=e=>{const t=Lde(e);return t.forEach(n=>{var a;const s=(a=Bde(n.type,e))==null?void 0:a.map(o=>({...o,schemas:[]}));s&&(n.subItems=[...s])}),t},EE=(e,t)=>{var u,f,h;const{propertySchema:n,relationPropertySchema:s,targetPropertySchema:a}=ii(e,t);if(!n)return[];const{type:o,targetProperty:i,aggregation:l}=n,c=$n(e);let d=[];if(o===m.CollectionSchemaType.ROLLUP){let p=a==null?void 0:a.type;if(p===m.CollectionSchemaType.FORMULA&&(p=$n((u=s==null?void 0:s.collectionId)!=null?u:"").getTypeAsCollectionSchemaType(i!=null?i:"")),!p)return[];d=lce(p,l)}else if(o===m.CollectionSchemaType.FORMULA){const p=c.getTypeAsCollectionSchemaType(t);d=(f=bA[p])!=null?f:[]}else d=(h=bA[o])!=null?h:[];return[...d]},UT=(e,t)=>{var u;const{propertySchema:n,relationPropertySchema:s,targetPropertySchema:a}=ii(e,t);if(!n)return[];const{type:o,targetProperty:i}=n,l=$n(e);let c=o;if(o===m.CollectionSchemaType.ROLLUP){let f=a==null?void 0:a.type;if(f===m.CollectionSchemaType.FORMULA&&(f=$n((u=s==null?void 0:s.collectionId)!=null?u:"").getTypeAsCollectionSchemaType(i!=null?i:""),c=f),!f)return[]}else o===m.CollectionSchemaType.FORMULA&&(c=l.getTypeAsCollectionSchemaType(t));return $de(c)},Hde=(e,t,n)=>{const s=EE(e,t);return s.shift(),n!==m.CollectionSchemaType.CHECKBOX&&s.unshift({type:m.AggregationAction.SHOW_UNIQUE,title:"显示 唯一值"}),s.unshift({type:m.AggregationAction.SHOW_ORIGIN,title:"显示 原始值"}),s},Ba=vd.create((e,t,n=pe())=>{var T,v,I;const{blocks:s}=n,a=s[e],o=s[(T=a==null?void 0:a.parentId)!=null?T:""],i=(v=o==null?void 0:o.data.schema)==null?void 0:v[t],{relationProperty:l,targetProperty:c,aggregation:d}=i!=null?i:{};if(!l||!c)return;const{relationRecords:u,relationCollection:f}=wc(e,l,n.blocks);if(!f)return;const h=(I=f.data.schema)==null?void 0:I[c];if(!h)return;const p=h.type,g=$n(f.uuid),{allCellValues:_,notEmptyCellValues:x}=H8({blocks:u.map(j=>s[j]),propertyId:c,schema:h,formulaTool:g}),F=x.flat(),b=[...new Set(F)],w=d===m.AggregationAction.SHOW_UNIQUE,E=w?b:F,C=c&&p===m.CollectionSchemaType.FORMULA,k={allCellValues:_,originValues:E,targetProperty:c,targetPropertySchema:h,relationCollection:f,relationRecords:u,isUniqueValue:w,formulaType:C?g.getType(c):void 0,isEmpty:E.length===0,originValueToStringFunc:j=>j};if(p===m.CollectionSchemaType.SELECT||p===m.CollectionSchemaType.MULTI_SELECT?k.originValueToStringFunc=j=>{var S,D,A;return(A=(D=((S=h.options)!=null?S:[]).find(P=>P.id===j))==null?void 0:D.value)!=null?A:""}:p===m.CollectionSchemaType.PERSON||p===m.CollectionSchemaType.CREATED_BY||p===m.CollectionSchemaType.UPDATED_BY?k.originValueToStringFunc=j=>{var S,D;return Rn((D=(S=n.users[j])==null?void 0:S.uuid)!=null?D:"")}:p===m.CollectionSchemaType.RELATION&&(k.originValueToStringFunc=j=>{var S;return fe((S=n.blocks[j])==null?void 0:S.data.segments)}),d&&d!==m.AggregationAction.SHOW_ORIGIN&&d!==m.AggregationAction.SHOW_UNIQUE&&EE(f.uuid,c).find(D=>D.type===d&&D.type!==m.AggregationAction.NONE)){const D=JN(u.map(A=>s[A]),c,d,f.uuid,g);D?(k.dateStartTimestamp=D.dateStartTimestamp,k.dateEndTimestamp=D.dateEndTimestamp,k.aggregationValue=typeof D.result<"u"?String(D.result):void 0,k.isEmpty=!k.aggregationValue):k.isEmpty=!0}return k},(e,t)=>[e,t]);Ice(Ba);vde(Ba);const zde=e=>{const t=(e!=null?e:[]).filter(n=>n.type===m.TextType.URL&&n.fileStorageType==="internal");return t.length>0?t.map(n=>n.text):null},qde=e=>e.data.segments,Gde=e=>e.createdAt,Wde=e=>e.updatedAt,bf=e=>t=>{var n;return(n=t.data.collectionProperties)==null?void 0:n[e]};function Kde(e,t){const n=[],{collectionId:s,schemas:a,ranking:o,formulaTool:i,state:l=pe()}=t,c=f=>h=>{const p=i.getValue(h,f),g=i.getType(f);return g===et.ValueTool.stringType&&p===""?null:g===et.ValueTool.booleanType&&p==null?!1:typeof p=="number"&&isNaN(p)?null:p},d={findSchema(f,h){var p,g;return(g=(p=l.blocks[f])==null?void 0:p.data.schema)==null?void 0:g[h]},findUser(f){return l.users[f]},findRecord(f,h){return l.blocks[h]}},u=({property:f,direction:h})=>{var F,b,w;const p=WM(s,f,d),{type:g,aggregation:_,targetProperty:x}=(F=a==null?void 0:a[f])!=null?F:{};switch(g!=null?g:m.CollectionSchemaType.TEXT){case m.CollectionSchemaType.FORMULA:{const E=i.getType(f),C=E===et.ValueTool.stringType?el:E===et.ValueTool.booleanType?Hr(k=>k?1:0,kf):E===et.ValueTool.numberType?kf:E===et.ValueTool.dateType?Hr(k=>k.getTime(),kf):vm;return Hr(c(f),so(pi(C,h==="desc")))}case m.CollectionSchemaType.ROLLUP:{if(ni(_)){const{relationPropertySchema:C,targetPropertySchema:k}=ii(s,f),T=(b=k==null?void 0:k.type)!=null?b:m.CollectionSchemaType.TEXT;if(T===m.CollectionSchemaType.FORMULA){const j=$n((w=C==null?void 0:C.collectionId)!=null?w:"").getType(x!=null?x:"");return j===et.ValueTool.numberType||j===et.ValueTool.booleanType?Hr((D=>A=>{var O;const{originValues:P=[]}=(O=Ba(A.uuid,D))!=null?O:{};let L=[];return j===et.ValueTool.booleanType?L=P.map($=>typeof $=="string"&&us($)?1:0):L=P.map($=>Number($)),L.length>0?L:null})(f),so(pi(Rx(so(kf)),h==="desc"))):j===et.ValueTool.stringType||j===et.ValueTool.dateType?Hr((D=>A=>{var L;const{originValues:P=[]}=(L=Ba(A,D))!=null?L:{};return P.length>0?P:null})(f),so(pi(Rx(so(Rk)),h==="desc"))):()=>0}else if(T===m.CollectionSchemaType.CHECKBOX||T===m.CollectionSchemaType.NUMBER||T===m.CollectionSchemaType.SELECT||T===m.CollectionSchemaType.MULTI_SELECT){const I=T===m.CollectionSchemaType.NUMBER,j=T===m.CollectionSchemaType.CHECKBOX;return Hr((D=>A=>{var $,M;const{originValues:P=[],targetPropertySchema:L}=($=Ba(A,D))!=null?$:{};let O=[];if(j)O=P.map(U=>typeof U=="string"&&us(U)?1:0);else if(I)O=P.map(U=>Number(U));else{const z=((M=L==null?void 0:L.options)!=null?M:[]).map(K=>K.id);O=P.map(K=>typeof K>"u"?-1:z.indexOf(K)).filter(K=>K!==-1)}return O.length>0?O:null})(f),so(pi(Rx(so(kf)),h==="desc")))}else{if(T===m.CollectionSchemaType.FILE)return Hr((j=>S=>{var L;const{relationRecords:D}=(L=Ba(S,j))!=null?L:{},{blocks:A}=pe(),P=[];return D==null||D.forEach(O=>{var U,z;const $=(z=(U=A[O])==null?void 0:U.data.collectionProperties)==null?void 0:z[x!=null?x:""],M=zde($);M&&P.push(...M)}),P.length>0?P:null})(f),so(pi(pB(el),h==="desc")));if(T===m.CollectionSchemaType.TITLE||T===m.CollectionSchemaType.RELATION)return Hr((j=>S=>{var M;const{originValues:D=[],relationRecords:A=[]}=(M=Ba(S,j))!=null?M:{},P=T===m.CollectionSchemaType.TITLE,{blocks:L}=pe(),$=(P?A:D).map(U=>{var z;return fe((z=L[U])==null?void 0:z.data.segments)||fo}).join("").trim();return $||null})(f),so(pi(el,h==="desc")))}return Hr((I=>j=>{var A;const{originValues:S=[]}=(A=Ba(j,I))!=null?A:{};let D=S;return(T===m.CollectionSchemaType.PERSON||T===m.CollectionSchemaType.CREATED_BY||T===m.CollectionSchemaType.UPDATED_BY)&&(D=S.map(P=>Rn(P)).filter(P=>!!P)),D.length>0?D:null})(f),so(pi(Rx(so(el)),h==="desc")))}return fl(_)?Hr((k=>T=>{var I;const{dateStartTimestamp:v}=(I=Ba(T,k))!=null?I:{};return v||null})(f),so(pi(Rk,h==="desc"))):Hr((C=>k=>{var I;const{aggregationValue:T}=(I=Ba(k,C))!=null?I:{};let v;return qm(_)?v=T?V0(T):null:v=T?Number(T):null,v})(f),so(pi(kf,h==="desc")))}default:return(E,C)=>{const k=FA(s,E,f,p,d),T=FA(s,C,f,p,d);if(!(p instanceof RN)){if(p.isEmpty(k)&&p.isEmpty(T))return 0;if(p.isEmpty(k))return 1;if(p.isEmpty(T))return-1}return(h==="desc"?-1:1)*p.compare(k,T)}}};for(const f of e)n.push(u(f));return n.push(Hr(f=>{var h;return(h=o.get(f))!=null?h:1/0})),n.push(Hr(f=>f)),cJ(...n)}ue.extend(OW),ue.locale("zh-cn");const Ff=e=>[e.startOf("day"),e.endOf("day")],fC=e=>{const t=e.startOf("day").valueOf()-((e.day()||7)-1)*as,n=t+7*as-1e3;return[ue(t),ue(n)]},mC=e=>[e.startOf("month"),e.endOf("month")],hC=e=>[e.startOf("year"),e.endOf("year")],pl={today:{title:"今天",day:!0,fn:()=>Ff(ue())},yesterday:{title:"昨天",day:!0,fn:()=>Ff(ue().add(-1,"day"))},tomorrow:{title:"明天",day:!0,fn:()=>Ff(ue().add(1,"day"))},current_week:{title:"本周",day:!1,fn:()=>fC(ue())},last_week:{title:"上周",day:!1,fn:()=>fC(ue().add(-1,"week"))},next_week:{title:"下周",day:!1,fn:()=>fC(ue().add(1,"week"))},current_month:{title:"本月",day:!1,fn:()=>mC(ue())},last_month:{title:"上月",day:!1,fn:()=>mC(ue().add(-1,"month"))},next_month:{title:"下月",day:!1,fn:()=>mC(ue().add(1,"month"))},current_year:{title:"今年",day:!1,fn:()=>hC(ue())},last_year:{title:"去年",day:!1,fn:()=>hC(ue().add(-1,"year"))},next_year:{title:"明年",day:!1,fn:()=>hC(ue().add(1,"year"))},a_week_ago:{title:"一周前",day:!0,fn:()=>Ff(ue().add(-1,"week"))},a_week_later:{title:"一周后",day:!0,fn:()=>Ff(ue().add(1,"week"))},a_month_ago:{title:"一个月前",day:!0,fn:()=>Ff(ue().add(-1,"month"))},a_month_later:{title:"一个月后",day:!0,fn:()=>Ff(ue().add(1,"month"))},last_7_days:{title:"过去7天",day:!1,fn:()=>[ue().add(-6,"day").startOf("day"),ue().endOf("day")]},next_7_days:{title:"未来7天",day:!1,fn:()=>[ue().add(1,"day").startOf("day"),ue().add(7,"day").endOf("day")]},last_30_days:{title:"过去30天",day:!1,fn:()=>[ue().add(-29,"day").startOf("day"),ue().endOf("day")]},next_30_days:{title:"未来30天",day:!1,fn:()=>[ue().add(1,"day").startOf("day"),ue().add(30,"day").endOf("day")]}},Eh=e=>(t,n)=>zf(pl,n)?e(t,pl[n].fn()[0].format(Et)):e(t,n),VT={string:{in:(e,t)=>(e!=null?e:"").includes(t),nin:(e,t)=>!(e!=null?e:"").includes(t),eq:(e,t)=>(e!=null?e:"")===t,neq:(e,t)=>(e!=null?e:"")!==t,startsWith:(e,t)=>(e!=null?e:"").startsWith(t),endsWith:(e,t)=>(e!=null?e:"").endsWith(t)},tag:{eq:(e,t)=>e===t,neq:(e,t)=>e!==t},tags:{in:(e,t)=>(e!=null?e:[]).includes(t),nin:(e,t)=>!(e!=null?e:[]).includes(t)},number:{eq:(e,t)=>(e!=null?e:NaN)===t,neq:(e,t)=>(e!=null?e:NaN)!==t,gt:(e,t)=>(e!=null?e:NaN)>t,lt:(e,t)=>(e!=null?e:NaN)<t,gte:(e,t)=>(e!=null?e:NaN)>=t,lte:(e,t)=>(e!=null?e:NaN)<=t},date:{eq:Eh((e,t)=>e===t),neq:Eh((e,t)=>e!==t),in:(e,t)=>{if(e==null)return!1;if(zf(pl,t)){const n=pl[t],[s,a]=n.fn();return ue(e,Et).isBetween(s,a,"day","[]")}if(t!=null&&t.includes(",")){const n=t.split(","),s=ue(n[0],Et),a=ue(n[1],Et);return ue(e,Et).isBetween(s,a,"day","[]")}return!1},lt:Eh((e,t)=>e!=null&&e<t),gt:Eh((e,t)=>e!=null&&e>t),lte:Eh((e,t)=>e!=null&&e<=t),gte:Eh((e,t)=>e!=null&&e>=t)},persons:{in:(e,t)=>(e!=null?e:[]).includes(t),nin:(e,t)=>!(e!=null?e:[]).includes(t)},relations:{in:(e,t)=>{if(t==="")return!0;const n=(t!=null?t:"").split(",").filter(Boolean);return(e!=null?e:[]).some(s=>n.includes(s))},nin:(e,t)=>{if(t==="")return!0;const n=(t!=null?t:"").split(",").filter(Boolean);return(e!=null?e:[]).every(s=>!n.includes(s))}},rollupUnique:{in:(e,t)=>(e!=null?e:[]).some(n=>n===t),nin:(e,t)=>(e!=null?e:[]).every(n=>n!==t)},other:{}},pC={eq:{_default:"是",[m.CollectionSchemaType.NUMBER]:"="},neq:{_default:"不是",[m.CollectionSchemaType.NUMBER]:"≠"},lt:{_default:"小于",[m.CollectionSchemaType.NUMBER]:"<",[m.CollectionSchemaType.DATE]:"早于"},lte:{_default:"小于等于",[m.CollectionSchemaType.NUMBER]:"≤",[m.CollectionSchemaType.DATE]:"不晚于"},gt:{_default:"大于",[m.CollectionSchemaType.NUMBER]:">",[m.CollectionSchemaType.DATE]:"晚于"},gte:{_default:"大于等于",[m.CollectionSchemaType.NUMBER]:"≥",[m.CollectionSchemaType.DATE]:"不早于"},in:{_default:"包含",[m.CollectionSchemaType.DATE]:"位于某段时间内"},nin:{_default:"不包含"},startsWith:{_default:"开始为"},endsWith:{_default:"结束为"},isEmpty:{_default:Wa.isEmpty,[m.CollectionSchemaType.CHECKBOX]:"未勾选"},isNotEmpty:{_default:Wa.isNotEmpty,[m.CollectionSchemaType.CHECKBOX]:"已勾选"}};function $T(e,t,n,s){switch(e===m.CollectionSchemaType.FORMULA&&t&&n&&(e=$n(t,s).getTypeAsCollectionSchemaType(n)),e){case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:return"string";case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:return"date";case m.CollectionSchemaType.NUMBER:return"number";case m.CollectionSchemaType.SELECT:return"tag";case m.CollectionSchemaType.MULTI_SELECT:return"tags";case m.CollectionSchemaType.PERSON:case m.CollectionSchemaType.CREATED_BY:case m.CollectionSchemaType.UPDATED_BY:return"persons";case m.CollectionSchemaType.RELATION:return"relations";case m.CollectionSchemaType.ROLLUP:case m.CollectionSchemaType.CHECKBOX:case m.CollectionSchemaType.FILE:return"other";case m.CollectionSchemaType.FORMULA:throw new Error("Assertion failed")}}function vg(e,t){var f,h;const{propertySchema:n,relationPropertySchema:s,targetPropertySchema:a}=ii(e,t),{type:o,aggregation:i,targetProperty:l}=n!=null?n:{};let c=o!=null?o:m.CollectionSchemaType.TEXT;if((o===m.CollectionSchemaType.CREATED_AT||o===m.CollectionSchemaType.UPDATED_AT)&&(c=m.CollectionSchemaType.DATE),c===m.CollectionSchemaType.ROLLUP)if(ni(i)){const p=(f=a==null?void 0:a.type)!=null?f:m.CollectionSchemaType.TEXT;if(p===m.CollectionSchemaType.FORMULA)return c=$n((h=s==null?void 0:s.collectionId)!=null?h:"").getTypeAsCollectionSchemaType(l!=null?l:""),[];c=p}else fl(i)?c=m.CollectionSchemaType.DATE:c=m.CollectionSchemaType.NUMBER;else o===m.CollectionSchemaType.FORMULA&&(c=$n(e).getTypeAsCollectionSchemaType(t));const d=$T(c,e,t),u=VT[d];return[...Object.keys(u),"isNotEmpty","isEmpty"].map(p=>{var x,F,b,w;const g=p,_=(w=(b=(x=pC[g])==null?void 0:x[c])!=null?b:(F=pC[g])==null?void 0:F._default)!=null?w:"?";return{value:g,title:_,shortTitle:_===pC.in[m.CollectionSchemaType.DATE]?"位于":void 0}})}function W8(e,t){const{collectionId:n,schemas:s,userId:a,curpageId:o}=t,i=d=>{var v,I,j;const{propertySchema:u,relationPropertySchema:f,targetPropertySchema:h}=ii(n,d.property),{type:p=m.CollectionSchemaType.TEXT,options:g=[],aggregation:_,targetProperty:x}=u!=null?u:{},F=(v=h==null?void 0:h.type)!=null?v:m.CollectionSchemaType.TEXT,b=S=>{switch(p){case m.CollectionSchemaType.TITLE:return D=>fe(qde(D));case m.CollectionSchemaType.CREATED_AT:return D=>{const A=Gde(D);return ue(A).format(Et)};case m.CollectionSchemaType.UPDATED_AT:return D=>{const A=Wde(D);return ue(A).format(Et)};case m.CollectionSchemaType.DATE:return D=>{const A=bf(S)(D),P=wce(A);return P&&ue(P).format(Et)};case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:return D=>fe(bf(S)(D));case m.CollectionSchemaType.CHECKBOX:return D=>{const A=fe(bf(S)(D));return us(A)?"YES":null};case m.CollectionSchemaType.FILE:return D=>{const A=bf(S)(D);return(A!=null?A:[]).filter(P=>P.type===m.TextType.URL&&P.fileStorageType==="internal").length>0?"<not_null>":null};case m.CollectionSchemaType.NUMBER:return D=>jT(bf(S)(D));case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{const D=A=>{const P=bf(S)(A);return P==null?void 0:fe(P).trim().split(/\s*,\s*/g).map($=>{var M;return(M=g.find(U=>U.value===$))==null?void 0:M.id}).filter($=>!!$)};return p===m.CollectionSchemaType.MULTI_SELECT?D:A=>{var P;return(P=D(A))==null?void 0:P[0]}}case m.CollectionSchemaType.PERSON:return D=>{const A=Ece(bf(S)(D));return A!==void 0?A:[]};case m.CollectionSchemaType.CREATED_BY:return D=>D.createdBy!==void 0?[D.createdBy]:[];case m.CollectionSchemaType.UPDATED_BY:return D=>D.updatedBy!==void 0?[D.updatedBy]:[];case m.CollectionSchemaType.RELATION:return D=>{var A;return wc(D.uuid,S,(A=t.state)==null?void 0:A.blocks).relationRecords};case m.CollectionSchemaType.ROLLUP:return D=>Ba(D.uuid,S,t.state);case m.CollectionSchemaType.FORMULA:return D=>{const A=$n(n,t.state),P=A.getType(S),L=A.getValue(D.uuid,S);return P===et.ValueTool.dateType?L==null?null:ue(L).format(Et):P===et.ValueTool.booleanType?L?"YES":"":L};default:return()=>{}}},w=p===m.CollectionSchemaType.ROLLUP,E=b(d.property);if(d.operator==="isEmpty"||d.operator==="isNotEmpty"){const S=d.operator==="isEmpty";if(w){if(!ni(_))return A=>{const P=Ba(A.uuid,d.property,t.state);return S?(P==null?void 0:P.isEmpty)===!0:(P==null?void 0:P.isEmpty)!==!0};let D;return F===m.CollectionSchemaType.FORMULA?(D=$n((I=f==null?void 0:f.collectionId)!=null?I:"",t.state).getTypeAsCollectionSchemaType(x!=null?x:""),()=>!0):A=>{var O;let{allCellValues:P=[]}=(O=Ba(A.uuid,d.property,t.state))!=null?O:{};const L=_===m.AggregationAction.SHOW_UNIQUE;return P.length===0?!(L||d.mode==="every"||d.mode==="any"):F===m.CollectionSchemaType.CHECKBOX||D===m.CollectionSchemaType.CHECKBOX?L?P.some(S?Xx:F_):d.mode==="every"?P.every(S?Xx:F_):d.mode==="any"?P.some(S?Xx:F_):P.every(S?F_:Xx):((F===m.CollectionSchemaType.DATE||F===m.CollectionSchemaType.CREATED_AT||F===m.CollectionSchemaType.UPDATED_AT||D===m.CollectionSchemaType.DATE)&&(P=P.map($=>typeof $=="string"?ue($).format(Et):void 0)),L?P.some(S?w_:Qx):d.mode==="every"?P.every(S?w_:Qx):d.mode==="any"?P.some(S?w_:Qx):P.every(S?Qx:w_))}}return S?D=>{const A=E(D);return A==null||A===""||Array.isArray(A)&&A.length===0}:D=>{const A=E(D);return!(A==null||A===""||Array.isArray(A)&&A.length===0)}}let C=$T(p,n,d.property,t.state);if(w){let S;const D=F===m.CollectionSchemaType.FORMULA;if(F===m.CollectionSchemaType.FORMULA)return S=$n((j=f==null?void 0:f.collectionId)!=null?j:"",t.state).getTypeAsCollectionSchemaType(x!=null?x:""),()=>!0;if(ni(_))return A=>{var K;const P=Ba(A.uuid,d.property,t.state);let L=(K=P==null?void 0:P.allCellValues)!=null?K:[];const O=_===m.AggregationAction.SHOW_UNIQUE;if(L.length===0)return!(O||d.mode==="every"||d.mode==="any");F===m.CollectionSchemaType.DATE||F===m.CollectionSchemaType.CREATED_AT||F===m.CollectionSchemaType.UPDATED_AT||S===m.CollectionSchemaType.DATE?L=L.map(W=>typeof W=="string"?ue(W).format(Et):void 0):F===m.CollectionSchemaType.NUMBER&&(L=L.map(W=>typeof W=="string"?Number(W):void 0));const $=D?S!=null?S:m.CollectionSchemaType.TEXT:F,M=$T($,void 0,void 0,t.state),U=VT[M][d.operator],z=(()=>{var Y,G,ee;let{value:W}=d;if(M==="number")return Number(W);if(M==="persons"&&W==="me")return a;if($===m.CollectionSchemaType.RELATION){const te=((Y=String(W))!=null?Y:"").split(","),{blocks:Q}=(G=t.state)!=null?G:pe(),ne=Q[(ee=h==null?void 0:h.collectionId)!=null?ee:""],se=new Set(ne==null?void 0:ne.subNodes);W=te.filter(ae=>{var de;return ae&&(se.has(ae)||((de=ne==null?void 0:ne.templatePages)==null?void 0:de.includes(ae)))}).join(",")}return W})();return O?L.some(W=>$===m.CollectionSchemaType.RELATION&&z===""||!U?!0:U(W,z)):d.mode==="every"?L.every(W=>$===m.CollectionSchemaType.RELATION&&z===""||!U?!0:U(W,z)):d.mode==="any"?L.some(W=>$===m.CollectionSchemaType.RELATION&&z===""||!U?!0:U(W,z)):L.every(W=>$===m.CollectionSchemaType.RELATION&&z===""||!U?!0:!U(W,z))};fl(_)?C="date":C="number"}const k=VT[C][d.operator],T=(()=>{const{value:S}=d;return C==="number"?Number(S):C==="persons"&&S==="me"?a:S})();return k==null?()=>!1:S=>{var A,P,L;if(w){const{dateStartTimestamp:O,aggregationValue:$}=(A=Ba(S.uuid,d.property,t.state))!=null?A:{};let M=$;return fl(_)?M=O&&ue(O).format(Et):qm(_)?M=typeof $=="string"?V0($):void 0:M=Number($),k(M,T)}const D=E(S);if((u==null?void 0:u.type)===m.CollectionSchemaType.RELATION){let O=((P=String(T))!=null?P:"").split(",");const{blocks:$}=pe(),M=$[(L=u.collectionId)!=null?L:""],U=new Set(M==null?void 0:M.subNodes),z=new Set(M==null?void 0:M.templatePages);O=O.map(W=>z.has(W)&&o!=null?o:W);const K=O.filter(W=>W&&(U.has(W)||z.has(W)));return k(D,K.join(","))}return k(D,T)}},l=d=>{const u=d.filters.filter(f=>gl(f,s)).filter(f=>f.disable||f.type==="filter"&&!(s!=null&&s[f.property])?!1:f.type==="filter"&&["isEmpty","isNotEmpty"].includes(f.operator)?!0:!(f.type==="filter"&&f.value==="")).map(f=>c(f));if(u.length===0)return()=>!0;switch(d.operator){case"and":return f=>u.every(h=>h(f));case"or":return f=>u.some(h=>h(f))}},c=(d,u=!1)=>{if(d==null||d.disable||!gl(d,s))return()=>u;switch(d.type){case"group":return l(d);case"filter":return i(d);default:return()=>u}};return c(e,!0)}const gl=(e,t)=>{if(e==null)return!1;if(e.type==="filter"){const n=t==null?void 0:t[e.property];return!(n==null||e.propertyType!=null&&n.type!==e.propertyType)}return e.filters.length<=0?!1:!e.filters.every(n=>!gl(n,t))},z0=(e,t)=>!e||e.disable?!1:e.type==="filter"?gl(e,t):e.filters.length<=0?!1:e.filters.some(n=>z0(n,t)),CE=(e,t)=>{if(e.type==="group"){const n=e.filters.filter(s=>gl(s,t)).map(s=>CE(s,t));return{...e,filters:n}}return e},F_=e=>typeof e=="string"&&us(e),Xx=e=>!F_(e),w_=e=>typeof e=="string"&&e===""||Array.isArray(e)&&e.length===0||typeof e>"u",Qx=e=>!w_(e),Yde=(e,t)=>{var n,s;if(t===m.CollectionSchemaType.NUMBER){let a=parseFloat(e);return Number.isNaN(a)&&(a=parseFloat((s=(n=e.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:n[0])!=null?s:"")),isNaN(a)?"":"".concat(a)}else if(t===m.CollectionSchemaType.CREATED_AT||t===m.CollectionSchemaType.UPDATED_AT||t===m.CollectionSchemaType.DATE){const a=ue(e,Et);return a.isValid()?a.format(Et):""}else if(t===m.CollectionSchemaType.CHECKBOX)return us(e)?"YES":e.toUpperCase()==="NO"?"NO":"";return e},Uy=(e,t,n,s)=>{var c,d,u,f,h,p,g,_,x,F,b,w,E;const a=(u=(d=(c=J.blocks[e])==null?void 0:c.data)==null?void 0:d.schema)!=null?u:{};n==="property"&&(((C,k)=>(C===m.CollectionSchemaType.NUMBER||C===m.CollectionSchemaType.TEXT||C===m.CollectionSchemaType.TITLE)&&(k===m.CollectionSchemaType.TEXT||k===m.CollectionSchemaType.TITLE||k===m.CollectionSchemaType.NUMBER))((h=(f=a[t.property])==null?void 0:f.type)!=null?h:m.CollectionSchemaType.TEXT,(g=(p=a[s])==null?void 0:p.type)!=null?g:m.CollectionSchemaType.TEXT)?t.value=Yde(t.value,(x=(_=a[s])==null?void 0:_.type)!=null?x:m.CollectionSchemaType.TEXT):t.value="",((F=a[s])==null?void 0:F.type)===m.CollectionSchemaType.ROLLUP?t.mode="any":t.mode=void 0),n==="operator"&&t.operator!==s&&(t.operator==="in"||s==="in")&&ue(t.value,Et).isValid()&&(t.value=""),t[n]=s;const i=(w=(b=a[t.property])==null?void 0:b.type)!=null?w:m.CollectionSchemaType.TEXT;t.propertyType=i;const l=vg(e,t.property);l.map(C=>C.value).includes(t.operator)||(t.operator=(E=l[0])==null?void 0:E.value,t.value="")},sF=(e,t)=>t.length===0?e:bu(e,t),Jx=(e,t,n,s)=>{var f;const{viewId:a,path:o,collectionId:i,managerReadonly:l}=e,c=(f=pe().collectionViews)==null?void 0:f[a];if(!c)return;const d=Br(c.format.filter),u=sF(d,[...o,"filters",t]);u&&(Uy(i,u,n,s),Rt(a,{filter:d},l))},ej={text:[{type:m.GroupSortType.MANUAL,name:"手动排序"},{type:m.GroupSortType.ASCENDING,name:"升序"},{type:m.GroupSortType.DESCENDING,name:"降序"}],date:[{type:m.GroupSortType.ASCENDING,name:"时间升序"},{type:m.GroupSortType.DESCENDING,name:"时间倒序"}],number:[{type:m.GroupSortType.ASCENDING,name:"升序"},{type:m.GroupSortType.DESCENDING,name:"降序"}]},q0={date:[{type:m.GroupLevel.RELATIVE,name:"相对日期"},{type:m.GroupLevel.DAY,name:"天"},{type:m.GroupLevel.WEEK,name:"周"},{type:m.GroupLevel.MONTH,name:"月"},{type:m.GroupLevel.YEAR,name:"年"}],text:[{type:m.GroupLevel.EXACT,name:"精确"},{type:m.GroupLevel.ALPHABET_PREFIX,name:"模糊前缀"}]},rF=e=>{const t=parseFloat(String(e==null?void 0:e.start))||0,n=parseFloat(String(e==null?void 0:e.end))||1e3,s=parseFloat(String(e==null?void 0:e.size))||100;return{start:t,end:n,size:s}},G0=(e,t)=>((!t||!ej[e].find(n=>n.type===t))&&(t=m.GroupSortType.ASCENDING),t),op=(e,t)=>((!t||!q0[e].find(n=>n.type===t))&&(t=e==="date"?m.GroupLevel.RELATIVE:m.GroupLevel.EXACT),t),W0=(e,t={blocks:pe().blocks})=>{var o;const n=t.blocks[e];if(!n)return[];const s=(o=n.data.schema)!=null?o:{};return Object.keys(s).filter(i=>{const l=s[i],c=l==null?void 0:l.type;return c===m.CollectionSchemaType.FORMULA?MN(e,i,l==null?void 0:l.formula):c!==m.CollectionSchemaType.ROLLUP&&c!==m.CollectionSchemaType.FILE})},bm="028b4b00-f133-4a70-a19e-4df3d5df906f",Xde=(e,t,n)=>e==="out_of_range"?1:t==="out_of_range"||!e?-1:t?n===m.GroupSortType.ASCENDING?Number(e.split(",")[0])-Number(t.split(",")[0]):Number(t.split(",")[0])-Number(e.split(",")[0]):1,Qde=(e,t,n)=>e?t?n===m.GroupSortType.ASCENDING?b_(e)-b_(t):b_(t)-b_(e):1:-1,K8=(e,t,n)=>e?t?n===m.GroupSortType.ASCENDING?e.localeCompare(t):t.localeCompare(e):1:-1,Jde=(e,t)=>{const n=G0("text",t);n!==m.GroupSortType.MANUAL&&e.sort((s,a)=>{var o,i;return K8((o=s.value)!=null?o:"",(i=a.value)!=null?i:"",n)})},Zde=(e,t)=>{const n=G0("number",t);e.sort((s,a)=>{var o,i;return Xde((o=s.value)!=null?o:"",(i=a.value)!=null?i:"",n)})},eue=(e,t)=>{const n=G0("date",t);e.sort((s,a)=>{var o,i;return Qde((o=s.value)!=null?o:"",(i=a.value)!=null?i:"",n)})},tue=(e,t)=>{const{blocks:n}=pe(),s=G0("text",t);s!==m.GroupSortType.MANUAL&&e.sort((a,o)=>{var c,d;if(!a.value)return-1;if(!o.value)return 1;const i=fe((c=n[a.value])==null?void 0:c.data.segments),l=fe((d=n[o.value])==null?void 0:d.data.segments);return K8(i,l,s)})},C1=dc(e=>e.blocks,e=>e.users,e=>e.collectionId,e=>e.recordId,e=>e.groupProperty,e=>e.groupBy,(e,t,n,s,a,o)=>{var f,h,p,g,_,x,F,b,w,E;const i=e[s];if(!i)return[];const l=e[n],c=(f=l==null?void 0:l.data.schema)==null?void 0:f[a];if(!c)return[];const d=c.type;let u=[];switch(d){case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{u=fe((h=i.data.collectionProperties)==null?void 0:h[a]).trim().split(/\s*,\s*/g).map(C=>{var k,T;return(T=(k=c.options)==null?void 0:k.find(v=>v.value===C))==null?void 0:T.value}).filter(C=>!!C),d===m.CollectionSchemaType.SELECT&&(u=u.slice(0,1));break}case m.CollectionSchemaType.CHECKBOX:{const C=(p=i.data.collectionProperties)==null?void 0:p[a];u=[us(fe(C))?"YES":"NO"];break}case m.CollectionSchemaType.CREATED_BY:case m.CollectionSchemaType.UPDATED_BY:case m.CollectionSchemaType.PERSON:{if(d===m.CollectionSchemaType.PERSON)u=((_=(g=i.data.collectionProperties)==null?void 0:g[a])!=null?_:[]).filter(k=>{var T;return k.type===m.TextType.USER&&t[(T=k.uuid)!=null?T:""]}).map(k=>k.uuid).filter(k=>!!k);else{const k=d===m.CollectionSchemaType.CREATED_BY?i.createdBy:i.updatedBy;k&&t[k]&&(u=[k])}break}case m.CollectionSchemaType.RELATION:{const{relationRecords:C}=wc(i.uuid,a,e);u=C;break}case m.CollectionSchemaType.NUMBER:{const{start:C,end:k,size:T}=rF(o),v=fe((x=i.data.collectionProperties)==null?void 0:x[a]);let I=parseFloat(v);Number.isNaN(I)&&(I=parseFloat((b=(F=v.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:F[0])!=null?b:"")),Number.isNaN(I)||(u=[AA(I,C,k,T)]);break}case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:{let C;if(d===m.CollectionSchemaType.DATE){const T=va(i,a);C=T==null?void 0:T.timestamp}else d===m.CollectionSchemaType.CREATED_AT?C=i.createdAt:C=i.updatedAt;if(!C){u=[];break}const k=zh(C,op("date",o==null?void 0:o.groupLevel));k&&(u=[k]);break}case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:{const C=op("text",o==null?void 0:o.groupLevel);let k="";if(d===m.CollectionSchemaType.PHONE||d===m.CollectionSchemaType.URL||d===m.CollectionSchemaType.EMAIL){const T=(w=i.data.collectionProperties)==null?void 0:w[a];k=Oi(T)}else d===m.CollectionSchemaType.TITLE?k=fe(i.data.segments):k=fe((E=i.data.collectionProperties)==null?void 0:E[a]);k=k.trim(),C===m.GroupLevel.ALPHABET_PREFIX&&(k=k.charAt(0).toUpperCase()),k&&(u=[k]);break}case m.CollectionSchemaType.FORMULA:{const C=$n(n),k=C.getTypeAsCollectionSchemaType(a),{start:T,end:v,size:I}=rF(o);let{groupLevel:j}=o;switch((k==="text"||k==="date")&&(j=op(k,j)),k){case m.CollectionSchemaType.CHECKBOX:{u=[C.getValue(i.uuid,a)===!0?"YES":"NO"];break}case m.CollectionSchemaType.TEXT:{let S=C.getValue(i.uuid,a);typeof S=="string"&&S.trim()&&(S=S.trim(),j===m.GroupLevel.ALPHABET_PREFIX&&(S=S.charAt(0).toUpperCase()),u=[S]);break}case m.CollectionSchemaType.NUMBER:{const S=C.getValue(i.uuid,a);typeof S=="number"&&!isNaN(S)&&(u=[AA(S,T,v,I)]);break}case m.CollectionSchemaType.DATE:{const S=C.getValue(i.uuid,a);if(typeof S=="object"&&S!==null){const D=S.getTime(),A=zh(D,j);A&&(u=[A])}break}}break}}return u.length===0&&(u=[bm]),u},{memoizeOptions:{maxSize:200}}),RA=(e,t,n,s,a,o,i)=>{var h,p,g;const l=(h=i.property)!=null?h:"",c=o.type;let d=[...a];(a.length===0||((p=a[0])==null?void 0:p.propertyType)!==c)&&(d=[]);let u;if(c===m.CollectionSchemaType.FORMULA){const x=$n(s).getTypeAsCollectionSchemaType(l),F=(g=d[0])==null?void 0:g.resultType;x!==F&&(d=[]),d=PA(e,t,n,s,a,o,i,d,x),x===m.CollectionSchemaType.TEXT&&(u="text"),x===m.CollectionSchemaType.NUMBER&&(u="number"),x===m.CollectionSchemaType.DATE&&(u="date")}else d=PA(e,t,n,s,a,o,i,d),c===m.CollectionSchemaType.RELATION&&(u="relation"),c===m.CollectionSchemaType.NUMBER&&(u="number"),(c===m.CollectionSchemaType.CREATED_AT||c===m.CollectionSchemaType.UPDATED_AT||c===m.CollectionSchemaType.DATE)&&(u="date"),(c===m.CollectionSchemaType.TITLE||c===m.CollectionSchemaType.TEXT||c===m.CollectionSchemaType.PHONE||c===m.CollectionSchemaType.URL||c===m.CollectionSchemaType.EMAIL)&&(u="text");const f=[...d];return u==="text"?Jde(d,i.sort):u==="number"?Zde(d,i.sort):u==="date"?eue(d,i.sort):u==="relation"&&tue(d,i.sort),{needUpdateGroups:!In(a,f),newViewGroups:d}},PA=(e,t,n,s,a,o,i,l,c)=>{var g,_,x;const d=l.length===0,u=(g=i.property)!=null?g:"",f=o.type;let h=[];f===m.CollectionSchemaType.SELECT||f===m.CollectionSchemaType.MULTI_SELECT?(h=(x=(_=o.options)==null?void 0:_.map(F=>F.value))!=null?x:[],l=l.filter(F=>!F.value||h.includes(F.value))):f===m.CollectionSchemaType.CHECKBOX||f===m.CollectionSchemaType.FORMULA&&c===m.CollectionSchemaType.CHECKBOX?h=["YES","NO"]:e.forEach(F=>{const b=C1({blocks:t,users:n,collectionId:s,recordId:F,groupProperty:u,groupBy:i});h.push(...b)});const p=new Set;return a.forEach(F=>F.value&&p.add(F.value)),new Set(h).forEach(F=>{if(!p.has(F)&&F!==bm){const b={property:u,propertyType:f,visible:!0,value:F};c&&(b.resultType=c),l.push(b)}}),d&&!l.find(F=>!F.value)&&(f===m.CollectionSchemaType.TITLE||f===m.CollectionSchemaType.TEXT||f===m.CollectionSchemaType.PHONE||f===m.CollectionSchemaType.URL||f===m.CollectionSchemaType.EMAIL||f===m.CollectionSchemaType.DATE||f===m.CollectionSchemaType.PERSON||f===m.CollectionSchemaType.SELECT||f===m.CollectionSchemaType.MULTI_SELECT||f===m.CollectionSchemaType.RELATION||f===m.CollectionSchemaType.NUMBER||f===m.CollectionSchemaType.FORMULA&&c!==m.CollectionSchemaType.CHECKBOX)&&l.unshift({property:u,propertyType:f,visible:!0,resultType:c}),l=MW(l.filter(Boolean),F=>{if(F.value)return F.value}),l},kE=dc(e=>e.blocks,e=>e.collectionViews,e=>e.users,e=>e.viewId,e=>e.sortedRecordIds,(e,t,n,s,a)=>{var $,M,U,z;const o=gn(s,e,t);if(!o)return;const{view:i,collection:l,groups:c=[],subGroups:d=[],groupBy:u,subGroupBy:f,timelineShowTable:h,timelineBy:p,timelineByEnd:g}=o,_=($=u==null?void 0:u.property)!=null?$:"",x=(M=f==null?void 0:f.property)!=null?M:"",F=W0(l.uuid);i.type===m.CollectionViewType.TIMELINE&&!h&&(a=a.filter(K=>{if(!p||!g)return!1;const W=e[K],Y=hd(W,p),G=hd(W,g);return!!(Y||G)}));const b=(U=l.data.schema)==null?void 0:U[_],w=(z=l.data.schema)==null?void 0:z[x];if(!b||!F.includes(_)||!u)return{sortedRecordIds:a,visibleGroups:[],hiddenGroups:[],withoutValidGroup:!0};let E=!1;i.type===m.CollectionViewType.BOARD&&F.includes(x)&&(E=!0);const{needUpdateGroups:C,newViewGroups:k}=RA(a,e,n,l.uuid,c,b,u),T=new Map,v=k.map((K,W)=>{const Y=gC(K,_);return T.set(Y.value,{group:Y,index:W}),Y});let I=!1,j=[],S=new Map,D=[];if(E&&w&&f){const K=RA(a,e,n,l.uuid,d,w,f);I=K.needUpdateGroups,j=K.newViewGroups,S=new Map,D=j.map(W=>{const Y={...gC(W,x),groups:k.map(G=>gC(G,_))};return S.set(Y.value,Y),Y})}a.forEach(K=>{if(!e[K])return;const Y=C1({blocks:e,users:n,collectionId:l.uuid,recordId:K,groupProperty:_,groupBy:u}),G=[];Y.forEach(ee=>{const te=T.get(ee);te&&(G.push(te.index),te.group.recordIds.push(K))}),E&&w&&f&&C1({blocks:e,users:n,collectionId:l.uuid,recordId:K,groupProperty:x,groupBy:f}).forEach(te=>{const Q=S.get(te);Q&&G.forEach(ne=>{var se;Q.recordIds.push(K),(se=Q.groups[ne])==null||se.recordIds.push(K)})})});const A=[],P=[];v.forEach(K=>{K.visible?u.hideEmptyGroups&&K.recordIds.length===0&&K.emptyHidden!==!1?(K.visible=!1,P.push(K)):A.push(K):P.push(K)});const L=[],O=[];return D.forEach(K=>{K.groups.forEach((W,Y)=>{var G,ee;W.visible=(ee=(G=v[Y])==null?void 0:G.visible)!=null?ee:W.visible}),K.visible?f!=null&&f.hideEmptyGroups&&K.recordIds.length===0&&K.emptyHidden!==!1?(K.visible=!1,O.push(K)):L.push(K):O.push(K)}),{withoutValidGroup:!1,needUpdateGroups:C,needUpdateSubGroups:I,newViewGroups:k,newViewSubGroups:j,groups:v,visibleGroups:A,hiddenGroups:P,hasValidSubGroup:E,subGroups:D,visibleSubGroups:L,hiddenSubGroups:O,subGroupProperty:x,groupProperty:_,sortedRecordIds:a}},{memoizeOptions:{resultEqualityCheck:In}}),gC=(e,t)=>{var n;return{value:(n=e.value)!=null?n:bm,visible:e.visible,emptyHidden:e.emptyHidden,recordIds:[],groupProperty:t}},tj=(e,t,n=!0)=>{const s=lt(),a=Ce(l=>{var c;return(c=l.collectionViews[e])==null?void 0:c.parentId},[e]),o=og(e),i=Pw();return Ce(l=>X8(e,l,!1,i,s,o,n),[e,a,i,o,...t||[]],{allUser:!0,waitMode:"throttle",wait:200,ignoreOtherData:!1})},LA=(e,t,n,s)=>{var l,c;const a=(c=(l=e.data.format)==null?void 0:l.openSubItem)==null?void 0:c.parentPropertyId,o=new Map,i=new Map;if(a){const d=new Set(n);e.subNodes.forEach(u=>{const{relationRecords:f}=wc(u,a);f.forEach(h=>{var _,x;const p=(_=o.get(h))!=null?_:[];p.push(u),o.set(h,p);const g=(x=i.get(u))!=null?x:[];g.push(h),i.set(u,g)})}),o.forEach((u,f,h)=>{var g,_;const p=nj({collectionId:e.uuid,records:u.filter(x=>d.has(x)),tableSchema:(g=e.data.schema)!=null?g:{},users:s.users,sorters:t.format.sorters,sort:(_=t.pageSort)!=null?_:[],state:s});h.set(f,p)})}return{parent2ChildMap:o,child2ParentMap:i}},Y8=(e,t,n,s=0)=>{if(s>=10)return;const a=e.get(t);a&&a.forEach(o=>{n.has(o)||(n.add(o),Y8(e,o,n,s+1))})},X8=vd.create(dc(e=>e,(e,t)=>t,(e,t,n)=>n,(e,t,n,s)=>s,(e,t,n,s,a)=>a,(e,t,n,s,a,o)=>o,(e,t,n,s,a,o,i)=>i,(e,t,n,s,a,o,i)=>{var j,S,D,A;const{users:l}=t,c=gn(e,t.blocks,t.collectionViews);if(!c)return{sortedRecordIds:[]};const{view:d,collection:u}=c,{role:f}=mn(u.uuid),h=f===m.PermissionRole.READER||f===m.PermissionRole.NONE;if(ot.dataBaseRange==="all")return{sortedRecordIds:u.subNodes};let p=h?DN(e):d.format.filter;h&&(!p||p.filters.length===0)&&(p=d.format.filter);const g=Q8(u.uuid,t,n,o),_=wM(e,t),x=ef(u.uuid)&&i,F=(S=(j=u.data.format)==null?void 0:j.openSubItem)==null?void 0:S.parentPropertyId,b=J8({collectionId:u.uuid,records:g,schemas:u.data.schema,userId:s,filter:p,state:t,pageId:a}),w=b.map(P=>P.uuid),{parent2ChildMap:E,child2ParentMap:C}=LA(u,d,[],t),k=new Set;if(F&&x&&_==="Nested"&&Jb(d.type)){const P=new Set(w);b.forEach(L=>{const O=new Set;Y8(C,L.uuid,O),O.forEach($=>{P.has($)||(P.add($),w.push($),k.add($))})})}const{parent2ChildMap:T,child2ParentMap:v}=LA(u,d,w,t),I=nj({collectionId:u.uuid,records:w,tableSchema:(D=u.data.schema)!=null?D:{},users:l,sorters:d.format.sorters,sort:(A=d.pageSort)!=null?A:[],state:t});if(x&&_!=="Flattenlist"){const P=[];return I.forEach(L=>{var $;(($=v.get(L))!=null?$:[]).length===0&&P.push(L)}),{sortedRecordIds:P,child2ParentMap:v,parent2ChildMap:T,filteredRecordIdSet:k}}return{sortedRecordIds:I,child2ParentMap:v,parent2ChildMap:T,filteredRecordIdSet:k}}),(e,t,n,s,a,o,i)=>[e,n,a,s,o,i],{enable:!1}),Jc=({viewId:e,state:t=pe(),ignoreSearch:n=!1,groupValue:s,pageId:a,openSubItem:o})=>{var g,_;const{sortedRecordIds:i,parent2ChildMap:l,child2ParentMap:c}=X8(e,t,n,yt.uuid,a,xt.$collectionSearch[e],o);if(!s)return{sortedRecordIds:i,parent2ChildMap:l,child2ParentMap:c};const{blocks:d,users:u,collectionViews:f}=t,h=kE({blocks:d,collectionViews:f,users:u,viewId:e,sortedRecordIds:i}),p=(g=h==null?void 0:h.groups)==null?void 0:g.find(x=>x.value===s);return{sortedRecordIds:(_=p==null?void 0:p.recordIds)!=null?_:[],parent2ChildMap:l,child2ParentMap:c}},nue=(e,t,n,s)=>{var o,i,l,c,d,u,f,h,p,g,_;const a=n.split(/\s+/).map(x=>id(x));for(const[x,F]of Object.entries(e)){if(s!=null&&s.onlyTitle&&F.type!==m.CollectionSchemaType.TITLE)continue;let b="";switch(F.type){case m.CollectionSchemaType.TEXT:{const w=(o=t.data.collectionProperties)==null?void 0:o[x];b=fe(w);break}case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:{const w=(i=t.data.collectionProperties)==null?void 0:i[x];b=Oi(w);break}case m.CollectionSchemaType.TITLE:{b=fe(t.data.segments);break}case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{b=fe((l=t.data.collectionProperties)==null?void 0:l[x]).trim().split(/\s*,\s*/g).map(C=>{var k,T;return(T=(k=F.options)==null?void 0:k.find(v=>v.value===C))==null?void 0:T.value}).filter(C=>!!C).join("");break}case m.CollectionSchemaType.NUMBER:{const w=fe((c=t.data.collectionProperties)==null?void 0:c[x]);let E=parseFloat(w);Number.isNaN(E)&&(E=parseFloat((u=(d=w.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:d[0])!=null?u:"")),Number.isNaN(E)||(b=String(E));break}case m.CollectionSchemaType.RELATION:{const w=wc(t.uuid,x).relationRecords,{blocks:E}=pe();b=w.map(k=>{const T=E[k];return T?fe(T.data.segments):""}).join("");break}case m.CollectionSchemaType.CHECKBOX:{const w=fe((f=t.data.collectionProperties)==null?void 0:f[x]);b=us(w)?"yes":"no";break}case m.CollectionSchemaType.FILE:{b=((p=(h=t.data.collectionProperties)==null?void 0:h[x])!=null?p:[]).filter(C=>C.type===m.TextType.URL&&C.fileStorageType==="internal").map(C=>C.text).join("");break}case m.CollectionSchemaType.PERSON:{((_=(g=t.data.collectionProperties)==null?void 0:g[x])!=null?_:[]).forEach(E=>{if(E.type===m.TextType.USER&&E.uuid){const C=Rn(E.uuid);C&&(b+=C)}});break}}if(b=id(b),a.find(w=>b.includes(w)))return!0}return!1},Q8=(e,t=pe(),n=!1,s="",a)=>{const{blocks:o}=t,i=o[e];return i?i.subNodes.reduce((l,c)=>{const d=o[c];if((d==null?void 0:d.type)!==m.BlockType.PAGE||d!=null&&d.hidden)return l;const u=i.data.schema;if(!n&&s&&u&&d&&!nue(u,d,s,a))return l;const{role:f}=mn(c,t);return d&&(pt()||f!==m.PermissionRole.NONE)&&l.push(d),l},[]):[]},nj=dc([({collectionId:e})=>e,({records:e})=>e,({tableSchema:e})=>e,({users:e})=>e,({sorters:e})=>(e!=null?e:[]).filter(t=>!t.disable),({sort:e})=>e,({state:e})=>e],(e,t,n,s,a,o,i)=>{if(a.length===0&&o.length===0)return t;const l=new Map;o.forEach((h,p)=>{l.set(h,p)});let c=o.length;for(const h of t)l.has(h)||(l.set(h,c),c+=1);const d=$n(e),u=Kde(a,{collectionId:e,schemas:n,ranking:l,users:s,formulaTool:d,state:i}),f=t.slice(0);return f.sort(u),f},{memoizeOptions:{resultEqualityCheck:In}}),J8=dc([({records:e})=>e,({schemas:e})=>e,({userId:e})=>e,({filter:e})=>e,({collectionId:e})=>e,({state:e})=>e,({pageId:e})=>e],(e,t,n,s,a,o,i)=>{const l=W8(s,{collectionId:a,schemas:t,userId:n,state:o,curpageId:i});return e.filter(l)},{memoizeOptions:{equalityCheck:In,resultEqualityCheck:In}}),Qo=e=>e!==bm?e:void 0,of=(e,t)=>{const{sortedRecordIds:n,child2ParentMap:s,parent2ChildMap:a,filteredRecordIdSet:o}=tj(e,t);return{tableGroups:Ce(l=>{const{blocks:c,users:d,collectionViews:u}=l;return kE({blocks:c,collectionViews:u,users:d,viewId:e,sortedRecordIds:n})},[e,n],{allUser:!0,wait:100,waitMode:"debounce"}),child2ParentMap:s,parent2ChildMap:a,filteredRecordIdSet:o}},HT=e=>({checkRecord:t=>e(t)!==null,prevRecord:t=>{var o;const n=e(t);if(n==null)return null;const{records:s,index:a}=n;return a<=0?null:(o=s[a-1])!=null?o:null},nextRecord:t=>{var o;const n=e(t);if(n==null)return null;const{records:s,index:a}=n;return a>=s.length-1?null:(o=s[a+1])!=null?o:null}}),sue=(e,t)=>{const n=So(QN);y.useEffect(()=>(n(s=>({...s,[e]:t})),()=>{n(s=>{const{[e]:a,...o}=s;return o})}),[n,e,t])},lf=(e,t=!0)=>{const{tableGroups:n,child2ParentMap:s,parent2ChildMap:a,filteredRecordIdSet:o}=of(e),i=So(QN);return y.useEffect(()=>{if(!t)return;const c=HT(d=>{if(n==null)return null;if(n.withoutValidGroup){const u=n.sortedRecordIds.indexOf(d);return u>=0?{records:n.sortedRecordIds,index:u}:null}for(const u of n.visibleGroups){const f=u.recordIds.indexOf(d);if(f>=0)return{records:u.recordIds,index:f}}return null});return i(d=>({...d,[e]:c})),()=>{i(d=>{const{[e]:u,...f}=d;return f})}},[t,i,n,e]),{tableGroups:n,child2ParentMap:s,parent2ChildMap:a,filteredRecordIdSet:o}},K0=()=>{const e=ba();return y.useCallback(t=>{var d;const{keywords:n="",filterIds:s=[],includeGroup:a,users:o=e}=t,l=Object.values(o).map(u=>u).filter(u=>!s.includes(u.uuid)),c=lc(l,n).map(u=>({...u,type:m.PermissionType.USER}));if(a){const u=(d=Pn().permissionGroups)==null?void 0:d.filter(p=>{const g=dd(p.name);return id("".concat(p.name).concat(g)).includes(id(n))}).map(p=>({uuid:p.id,nickname:p.name,iconData:p.icon,type:m.PermissionType.GROUP}));u&&c.unshift(...u);const{uuid:f,icon:h}=Pn();c.unshift({uuid:f,nickname:"全体成员",iconData:h,type:m.PermissionType.SPACE})}return c},[e])},TE=({value:e=[],onUpdate:t=()=>{},onClose:n=()=>{},onSelect:s,includeGroup:a=!0})=>{const o=K0(),i=We(),l=y.useRef(null),[c,d]=y.useState(""),u=y.useMemo(()=>o({keywords:c,includeGroup:a}).filter(b=>!e.some(w=>w.permissionType===b.type?w.permissionType===m.PermissionType.SPACE?!0:w.uuid===b.uuid:!1)),[a,c,o,e]),f=F=>{t(F)},h=(F,b)=>{if(e.findIndex(w=>w.uuid===F)===-1){const w=Ru(F);w.permissionType=b,f([...e,w])}},p=()=>{if(e.length>0){const[F,...b]=e;f(b)}},g=F=>{const b=e.findIndex(w=>w.uuid===F);if(b>=0){const w=[];e.forEach((E,C)=>{C!==b&&w.push(E)}),f(w)}},_=(F,b)=>{var w;d(""),h(F,b),s==null||s(F,b),(w=l.current)==null||w.focus()},x=F=>{if(Ie("Esc")(F)){n();return}!c&&Ie("Backspace")(F)&&p()};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex min-h-[42px] min-w-[260px] max-w-[480px] flex-wrap items-center px-2",children:[e.map((F,b)=>{var w,E;return r.jsx(wE,{userId:(w=F.uuid)!=null?w:"",showClose:!0,onClose:()=>{F.uuid&&g(F.uuid)},type:(E=e[b])==null?void 0:E.permissionType},F.uuid)}),!i&&r.jsx(oi,{ref:l,autoFocus:!0,singleLine:!0,placeholder:"搜索成员",fontClassName:Mn({lineHeight:"24px",fontSize:14,whiteSpace:"nowrap"}),className:Mn({width:"100%",selectors:{"&::placeholder":{color:"var(--grey4)"}}}),boxClassName:Mn({flexBasis:"auto",flexGrow:1,flexShrink:0,minWidth:120,maxWidth:"100%"}),value:c,onKeyDown:x,onChange:F=>{d(F.target.value)}})]}),r.jsx(Cr,{}),r.jsx(rue,{className:"py-1.5",users:u,onSelectPerson:_})]})},rue=({className:e,users:t,value:n,onSelectPerson:s,customHeader:a})=>{const o=t.map(i=>({type:H.OPERATION,data:{content:i.type===m.PermissionType.GROUP?r.jsx($8,{name:i.nickname,icon:i.iconData}):i.type===m.PermissionType.USER?r.jsx(si,{className:"!px-0",userId:i.uuid}):r.jsx(V8,{backgroundColor:Pn().backgroundColor,spaceName:Pn().title,name:i.nickname,icon:i.iconData}),value:i.uuid,onClick:()=>{s==null||s(i.uuid,i.type)}}}));return r.jsx(ze,{customHeader:a,items:o,customFooter:r.jsx(r.Fragment,{children:o.length<=0&&r.jsx("div",{className:"text-t2 relative flex h-10 items-center justify-center text-grey4",children:"没有找到相关结果"})}),className:R("text-t2 max-h-[50vh] overflow-y-auto",e),defaultActiveIndex:o.findIndex(i=>i.data.value===n)})},aue=()=>{const e=Oe(),t=(n,s,a,o)=>{e(()=>{var E,C,k;const{groups:i=[],subGroups:l=[],groupBy:c,subGroupBy:d,view:u,collection:f}=(E=gn(n))!=null?E:{};if(!u||!f)return;const h=o?d==null?void 0:d.property:c==null?void 0:c.property,p=o?d:c,g=o?l:i;if(!h)return;const _=g.map(T=>({...T,value:T.value===s?a:T.value})),x=u.type===m.CollectionViewType.BOARD&&!o;Rs(n,{format:{[x?"boardGroups":"collectionGroups"]:_}});const F=(C=f.data.schema)==null?void 0:C[h],{blocks:b,users:w}=pe();if(f.subNodes.forEach(T=>{var D,A,P,L;const v=b[T];if(!v)return;const{role:I}=mn(T);if(I===m.PermissionRole.READER)return;if(!F||!p)return null;const j=C1({blocks:b,users:w,collectionId:f.uuid,recordId:T,groupProperty:h,groupBy:p});let S=[];if(j.includes(s)){switch(F.type){case m.CollectionSchemaType.TITLE:{S=ht(a);break}case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:{S=[{type:m.TextType.URL,url:a,text:a,enhancer:{}}];break}case m.CollectionSchemaType.PERSON:{S=((A=(D=v.data.collectionProperties)==null?void 0:D[h])!=null?A:[]).map($=>({...$,uuid:$.uuid===s?a:$.uuid}));break}case m.CollectionSchemaType.MULTI_SELECT:case m.CollectionSchemaType.SELECT:{const O=(L=(P=v.data.collectionProperties)==null?void 0:P[h])!=null?L:[],$=fe(O).split(",").map(M=>M===s?a:M).filter(M=>!!M).join(",");S=ht($);break}default:S=ht(a);break}F.type===m.CollectionSchemaType.TITLE?_e(T,{data:{segments:S}}):_e(T,{data:{collectionProperties:{...v.data.collectionProperties,[h]:S}}})}}),(F==null?void 0:F.type)===m.CollectionSchemaType.MULTI_SELECT||(F==null?void 0:F.type)===m.CollectionSchemaType.SELECT){const T=(k=F.options)==null?void 0:k.map(v=>({...v,value:v.value===s?a:v.value}));_e(f.uuid,{data:{schema:{...f.data.schema,[h]:{...F,options:T}}}})}})};return y.useCallback(t,[e])},oue=()=>{const e=Oe(),t=(n,s,a)=>{e(()=>{var x,F,b,w;const{groups:o=[],subGroups:i=[],subGroupBy:l,groupBy:c,view:d,collection:u}=(x=gn(n))!=null?x:{};if(!d||!u)return;const f=a?l==null?void 0:l.property:c==null?void 0:c.property,h=a?i:o,p=(F=u.data.schema)==null?void 0:F[f!=null?f:""];if(!p||!f)return;const g=h.concat({property:f,propertyType:p.type,value:s,visible:!0}),_=d.type===m.CollectionViewType.BOARD&&!a;if(Rs(n,{format:{[_?"boardGroups":"collectionGroups"]:g}}),p.type===m.CollectionSchemaType.SELECT||p.type===m.CollectionSchemaType.MULTI_SELECT){const E=(b=p.options)!=null?b:[],C=new Set(E.map(I=>I.color));let k=vr.map(I=>I.key);C.size!==k.length&&(k=k.filter(I=>!C.has(I)));const T={id:qe(),color:(w=nm(k))!=null?w:vr[0].key,value:s},v=E.concat(T);_e(u.uuid,{data:{schema:{...u.data.schema,[f]:{...p,options:v}}}})}})};return y.useCallback(t,[e])},Ou=({isSubGroup:e=!1})=>{const{viewId:t,viewType:n,readonly:s,managerReadonly:a,isLocked:o,collectionId:i,embed:l}=Ne(),c=ie(),d=Bi(t),u=Li(t),f=sf(t,e),h=rf(t,e);if(s||a||o||ot.print)return null;const p=Pu(i,h==null?void 0:h.property);if(iue(f==null?void 0:f.type)||p==="text"&&(h==null?void 0:h.groupLevel)===m.GroupLevel.ALPHABET_PREFIX)return null;if(n===m.CollectionViewType.BOARD&&!e){const _=ji(d,u);return r.jsx("div",{className:"flex-shrink-0 bg-white1",style:{width:_},children:r.jsx("div",{className:R("bg-grey/5 rounded-md p-[5px]"),children:r.jsxs("button",{className:"animate-hover-black3 flex h-[38px] w-full items-center rounded-md",onClick:x=>{c.dropdown({popcorn:x.currentTarget,placement:"bottom",content:({onCloseModal:F})=>r.jsx(BA,{isSubGroup:e,width:_,closeModal:F})})},children:[r.jsx(V,{size:"middle",name:"IcAddBoard",className:"text-grey3 mx-[5px]"}),r.jsx("span",{className:"text-t2 text-grey4",children:"创建分组"})]})})})}return r.jsx("div",{children:r.jsxs("button",{className:R("animate-hover-black3 sticky flex h-[38px] items-center rounded-md pr-2 pl-1",l?"left-0":"left-24"),onClick:_=>{c.dropdown({popcorn:_.currentTarget,placement:"bottom-start",content:({onCloseModal:x})=>r.jsx(BA,{isSubGroup:e,width:270,closeModal:x})})},children:[r.jsx(V,{size:"middle",name:"IcAddBoard",className:"text-grey4 mr-[5px]"}),r.jsx("span",{className:"text-t2 text-grey4",children:"创建分组"})]})})},BA=({closeModal:e,isSubGroup:t=!1})=>{const{viewId:n}=Ne(),s=ie(),a=oue(),o=y.useRef(""),i=y.useRef(null),l=sf(n,t),c=()=>{const u=o.current.replace(/,/g,"").trim();if(!u){e();return}if(aF(n,u,t)){s.warning({title:r.jsx(r.Fragment,{children:"已存在同名分组"}),noCancel:!0,confirm(){var f;(f=i.current)==null||f.focus()}});return}a(n,u,t),e()},d=u=>{if(aF(n,u)){s.warning({title:r.jsx(r.Fragment,{children:"已存在同名分组"}),noCancel:!0});return}a(n,u,t),e()};return(l==null?void 0:l.type)===m.CollectionSchemaType.PERSON?r.jsx("div",{className:"next-modal",children:r.jsx(TE,{onSelect:d})}):(l==null?void 0:l.type)===m.CollectionSchemaType.RELATION?r.jsx(oc,{onSelect:({uuid:u})=>d(u),searchType:"page",source:"relationMenu",canSearchWithEmpty:!0,parentId:l.collectionId}):r.jsxs("div",{className:"next-modal box-border flex w-[320px] py-2 pr-3",children:[r.jsx(Ct,{autoFocus:!0,inputRef:i,showBorder:!1,className:"text-t2 h-8 flex-1 rounded-sm border-none !bg-transparent",onEnter:c,onChange:u=>o.current=u}),r.jsx(De,{onClick:c,colorType:"active",className:"text-t4 flex h-[32px] w-[62px] items-center border-none text-white",children:"完成"})]})},iue=e=>e===m.CollectionSchemaType.CHECKBOX||e===m.CollectionSchemaType.NUMBER||e===m.CollectionSchemaType.DATE||e===m.CollectionSchemaType.FORMULA||e===m.CollectionSchemaType.CREATED_AT||e===m.CollectionSchemaType.CREATED_BY||e===m.CollectionSchemaType.UPDATED_AT||e===m.CollectionSchemaType.UPDATED_BY,aF=(e,t,n)=>{var i;const{groups:s=[],subGroups:a=[]}=(i=gn(e))!=null?i:{};return!!(n?a:s).find(l=>l.value===t)},lue=e=>{const{closeModal:t,isSubGroup:n=!1,groupName:s}=e,{viewId:a}=Ne(),o=aue(),i=ie(),l=y.useRef(""),c=y.useRef(null),d=sf(a,n),u=()=>{const h=l.current.replace(/,/g,"").trim();if(!h){t();return}if(aF(a,h,n)){i.warning({title:r.jsx(r.Fragment,{children:"已存在同名分组"}),noCancel:!0,confirm(){var p;(p=c.current)==null||p.focus()}});return}o(a,s,h,n),t()},f=h=>{if(aF(a,h,n)){i.warning({title:r.jsx(r.Fragment,{children:"已存在同名分组"}),noCancel:!0,confirm(){var p;(p=c.current)==null||p.focus()}});return}o(a,s,h,n),t()};return(d==null?void 0:d.type)===m.CollectionSchemaType.PERSON?r.jsx("div",{className:"next-modal",children:r.jsx(TE,{onSelect:f})}):r.jsxs("div",{className:"next-modal box-border flex w-[320px] py-2 pr-3",children:[r.jsx(Ct,{autoFocus:!0,showBorder:!1,className:"text-t2 h-8 flex-1 rounded-sm border-none !bg-transparent",onEnter:u,defaultValue:Qo(s),onChange:h=>l.current=h}),r.jsx(De,{onClick:u,colorType:"active",className:"text-t4 flex h-[32px] w-[62px] items-center border-none text-white",children:"完成"})]})};var Y0=(e=>(e.GROUP_HEADER="group_header",e.GROUP_LIST="group_list",e.HIDDEN_GROUP="hidden_group",e))(Y0||{});const vE=e=>{var E;const{isSubGroup:t,groupName:n,scene:s}=e,{viewId:a,collectionId:o,managerReadonly:i,readonly:l,isLocked:c}=Ne(),d=li(a),u=ys(),f=ie(),h=rf(a,t),p=fE(a,n,t),g=sf(a,t);if(!Qo(n))return r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-t2 mr-0.5",children:"无"}),r.jsx("span",{className:"text-t2-bold text-ellipsis rounded-sm",children:g==null?void 0:g.name})]});let _;const x=g==null?void 0:g.type;switch(x){case m.CollectionSchemaType.CHECKBOX:{const C=us(n);_=r.jsx(_a,{size:"large",checked:C});break}case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{p&&(_=r.jsx(md,{color:p.color,value:p.value,label:p.value}));break}case m.CollectionSchemaType.CREATED_BY:case m.CollectionSchemaType.UPDATED_BY:case m.CollectionSchemaType.PERSON:_=r.jsx(si,{size:"default",userId:n});break;case m.CollectionSchemaType.RELATION:_=r.jsx(Ir,{uuid:n,className:"mr-2 whitespace-nowrap p-0 leading-none"});break;case m.CollectionSchemaType.NUMBER:{if(n==="out_of_range")_="超出范围";else{const C=n.split(",");_="".concat(C[0]," 到 ").concat(C[1])}break}case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:{const C=op("date",h==null?void 0:h.groupLevel);_=qh(n,C);break}case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:{_=n;break}case m.CollectionSchemaType.FORMULA:{const k=$n(o).getTypeAsCollectionSchemaType((E=h==null?void 0:h.property)!=null?E:"");let T=h==null?void 0:h.groupLevel;if((k==="text"||k==="date")&&(T=op(k,T)),k===m.CollectionSchemaType.NUMBER)if(n==="out_of_range")_="超出范围";else{const v=n.split(",");_="".concat(v[0]," 到 ").concat(v[1])}else if(k===m.CollectionSchemaType.DATE)_=qh(n,T);else if(k===m.CollectionSchemaType.CHECKBOX){const v=us(n);_=r.jsx(_a,{size:"large",checked:v})}else _=n;break}}const F=C=>{if(i||l||c||s==="group_list"||(g==null?void 0:g.type)===m.CollectionSchemaType.FORMULA)return;if((g==null?void 0:g.type)===m.CollectionSchemaType.RELATION){u(n,{forceOpenInRight:C.altKey,openWay:d,forceOpenNewTab:C.ctrlKey||C.metaKey});return}const k=Pu(o,h==null?void 0:h.property);(k==="text"&&(h==null?void 0:h.groupLevel)===m.GroupLevel.EXACT||k===m.CollectionSchemaType.SELECT||k===m.CollectionSchemaType.MULTI_SELECT||k===m.CollectionSchemaType.PERSON)&&f.dropdown({popcorn:C.currentTarget,placement:"bottom",content:({onCloseModal:T})=>r.jsx(lue,{isSubGroup:t,closeModal:T,groupName:n})})},w=Pu(o,h==null?void 0:h.property)==="text"&&x!==m.CollectionSchemaType.FORMULA&&(h==null?void 0:h.groupLevel)===m.GroupLevel.EXACT||x===m.CollectionSchemaType.RELATION||x===m.CollectionSchemaType.SELECT||x===m.CollectionSchemaType.MULTI_SELECT||x===m.CollectionSchemaType.PERSON;return x===m.CollectionSchemaType.CHECKBOX?r.jsx(r.Fragment,{children:_}):r.jsx("div",{onClick:F,className:R("text-t2 text-ellipsis",s!=="group_header"&&"w-full",s!=="group_list"&&"p-1",w&&s!=="group_list"&&"animate-hover cursor-pointer"),children:_})},cue={today:"今天",tomorrow:"明天",yesterday:"昨天",next_7_day:"未来 7 天",last_7_day:"过去 7 天",last_30_day:"过去 30 天",next_30_day:"未来 30 天",after_next_30_day:"未来 30 天后",before_last_30_day:"过去 30 天前"},qh=(e,t)=>{var s;let n="";if(t===m.GroupLevel.RELATIVE)n=(s=cue[e])!=null?s:"";else if(t===m.GroupLevel.DAY)n=ue(e).format("YYYY年MM月DD日");else if(t===m.GroupLevel.WEEK){const a=ue(e).valueOf()+6*Kn;n=[ue(e).format("YYYY年MM月DD日"),ue(a).format("YYYY年MM月DD日")].join(" - ")}else t===m.GroupLevel.MONTH?n=ue(e).format("YYYY年MM月"):t===m.GroupLevel.YEAR&&(n=ue(e).format("YYYY年"));return n};function hd(e,t,n){var a,o,i,l,c,d,u,f,h,p;if(!e)return;const{blocks:s}=pe();if(typeof e=="string"){const g=s[e];if(!g)return;e=g}if(!n){const g=s[e.parentId];if(!g)return;n=(a=g.data.schema)==null?void 0:a[t]}if(n)switch(n.type){case m.CollectionSchemaType.CREATED_AT:return e.createdAt;case m.CollectionSchemaType.UPDATED_AT:return e.updatedAt;case m.CollectionSchemaType.CREATED_BY:return e.createdBy;case m.CollectionSchemaType.UPDATED_BY:return e.updatedBy;case m.CollectionSchemaType.DATE:return(o=va(e,t))==null?void 0:o.timestamp;case m.CollectionSchemaType.TITLE:return fe(e.data.segments).trim();case m.CollectionSchemaType.NUMBER:{const g=fe((i=e.data.collectionProperties)==null?void 0:i[t]);let _=parseFloat(g);return Number.isNaN(_)&&(_=parseFloat((c=(l=g.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:l[0])!=null?c:"")),Number.isNaN(_)?void 0:_}case m.CollectionSchemaType.FILE:{const _=((u=(d=e.data.collectionProperties)==null?void 0:d[t])!=null?u:[]).filter(x=>x.type===m.TextType.URL&&x.fileStorageType==="internal").map(x=>x.url).filter(x=>!!x);return _.length>0?_:void 0}case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:return Oi((f=e.data.collectionProperties)==null?void 0:f[t]);case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:return fe((h=e.data.collectionProperties)==null?void 0:h[t]).trim().split(/\s*,\s*/g).filter(x=>{var F;return(F=n==null?void 0:n.options)==null?void 0:F.some(b=>b.value===x)});default:return fe((p=e.data.collectionProperties)==null?void 0:p[t]).trim()}}const due=vd.create((e,t,n=pe())=>{var c,d,u,f,h,p,g;if(!e)return;const{blocks:s}=n;if(typeof e=="string"){const _=s[e];if(!_)return;e=_}const a=s[e.parentId];if(!a)return;const o=e.parentId,i=ii(a.uuid,t).propertySchema;if(!i)return;const l=(c=e.data.collectionProperties)==null?void 0:c[t];switch(i.type){case m.CollectionSchemaType.CREATED_AT:return ue(e.createdAt).format(On);case m.CollectionSchemaType.UPDATED_AT:return ue(e.updatedAt).format(On);case m.CollectionSchemaType.CREATED_BY:return Rn((d=e.createdBy)!=null?d:"");case m.CollectionSchemaType.UPDATED_BY:return Rn((u=e.updatedBy)!=null?u:"");case m.CollectionSchemaType.DATE:{const _=l==null?void 0:l.find(x=>x.type===m.TextType.DATE||x.type===m.TextType.DATETIME);return _?Yp(_,i.dateFormat,_.type===m.TextType.DATETIME,i.timeFormat):""}case m.CollectionSchemaType.PERSON:return ru(l).map(_=>{var x;return Rn((x=_.uuid)!=null?x:"")}).join("");case m.CollectionSchemaType.FILE:return l==null?void 0:l.filter(_=>_.type===m.TextType.URL&&_.fileStorageType==="internal").map(_=>_.text).join(",");case m.CollectionSchemaType.NUMBER:{const _=i.numberFormat,x=fe(l);let F=parseFloat(x);return Number.isNaN(F)&&(F=parseFloat((h=(f=x.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:f[0])!=null?h:"")),hl(F,_)}case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:return Oi(l);case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:return fe((p=e.data.collectionProperties)==null?void 0:p[t]).trim().split(/\s*,\s*/g).filter(F=>{var b;return(b=i==null?void 0:i.options)==null?void 0:b.some(w=>w.value===F)}).join(",");case m.CollectionSchemaType.TITLE:return fe(e.data.segments).trim();case m.CollectionSchemaType.CHECKBOX:{const _=fe(l);return us(_)?"YES":"NO"}case m.CollectionSchemaType.FORMULA:{if(o){const _=$n(o),x=_.getType(t),F=_.getValue(e.uuid,t);if(x===et.ValueTool.numberType)return F;if(x===et.ValueTool.stringType)return F;if(x===et.ValueTool.booleanType)return F?"YES":"NO";if(x===et.ValueTool.dateType)return ue(F).format(On)}return""}default:return fe((g=e.data.collectionProperties)==null?void 0:g[t])}},(e,t)=>[e,t]),sj=(e,t,n,s)=>{const a=uue(e,t,n,s);return a instanceof Array?a.length===0?["空值"]:a:typeof a=="string"?a?[a]:["空值"]:a},uue=(e,t,n=m.GroupLevel.DAY,s=pe())=>{var d,u,f,h,p,g,_,x,F;if(!e)return;const{blocks:a}=s;if(typeof e=="string"){const b=a[e];if(!b)return;e=b}const o=a[e.parentId];if(!o)return;const i=e.parentId,l=ii(o.uuid,t).propertySchema;if(!l)return;const c=(d=e.data.collectionProperties)==null?void 0:d[t];switch(l.type){case m.CollectionSchemaType.CREATED_AT:{if(e.createdAt){const b=zh(e.createdAt,n);if(b)return qh(b,n)}return ue(e.createdAt).format(Et)}case m.CollectionSchemaType.UPDATED_AT:{if(e.updatedAt){const b=zh(e.updatedAt,n);if(b)return qh(b,n)}return ue(e.updatedAt).format(Et)}case m.CollectionSchemaType.CREATED_BY:return Rn((u=e.createdBy)!=null?u:"");case m.CollectionSchemaType.UPDATED_BY:return Rn((f=e.updatedBy)!=null?f:"");case m.CollectionSchemaType.DATE:{const b=c==null?void 0:c.find(C=>C.type===m.TextType.DATE||C.type===m.TextType.DATETIME);if(!b)return"";const w=ud(b),E=zh(w.getTime(),n);return E?qh(E,n):Yp(b,l.dateFormat,b.type===m.TextType.DATETIME,l.timeFormat)}case m.CollectionSchemaType.PERSON:return ru(c).map(b=>{var w;return Rn((w=b.uuid)!=null?w:"")});case m.CollectionSchemaType.FILE:return c==null?void 0:c.filter(b=>b.type===m.TextType.URL&&b.fileStorageType==="internal").map(b=>b.text);case m.CollectionSchemaType.NUMBER:{const b=fe(c);let w=parseFloat(b);return Number.isNaN(w)&&(w=parseFloat((p=(h=b.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:h[0])!=null?p:"")),Number.isNaN(w)&&(w=0),"".concat(w)}case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:return Oi(c);case m.CollectionSchemaType.SELECT:{const b=fe((g=e.data.collectionProperties)==null?void 0:g[t]).trim();return b?b.split(/\s*,\s*/g).filter(E=>{var C;return(C=l==null?void 0:l.options)==null?void 0:C.some(k=>k.value===E)})[0]:""}case m.CollectionSchemaType.MULTI_SELECT:return fe((_=e.data.collectionProperties)==null?void 0:_[t]).trim().split(/\s*,\s*/g).filter(E=>{var C;return(C=l==null?void 0:l.options)==null?void 0:C.some(k=>k.value===E)});case m.CollectionSchemaType.TITLE:return fe(e.data.segments).trim();case m.CollectionSchemaType.CHECKBOX:{const b=fe(c);return us(b)?"YES":"NO"}case m.CollectionSchemaType.FORMULA:{if(i){const b=$n(i),w=b.getType(t),E=b.getValue(e.uuid,t);if(w===et.ValueTool.numberType)return E===null?"0":"".concat(E);if(w===et.ValueTool.stringType)return E;if(w===et.ValueTool.booleanType)return E?"YES":"NO";if(w===et.ValueTool.dateType){const C=E;if(C instanceof Date){const k=zh(C.getTime(),n);if(k)return qh(k,n)}else return"";return ue(C).format(On)}}return""}case m.CollectionSchemaType.RELATION:{let b=(x=e.data.collectionProperties)==null?void 0:x[t];return b=b==null?void 0:b.filter(w=>w.type===m.TextType.LINK_PAGE),b==null?void 0:b.map(w=>fe([w],0,!1))}default:return fe((F=e.data.collectionProperties)==null?void 0:F[t])}},aRe=(e,t,n)=>{var a,o,i,l,c,d,u;if(!e)return;const{blocks:s}=pe();if(typeof e=="string"){const f=s[e];if(!f)return;e=f}if(!n){const f=s[e.parentId];if(!f)return;n=(a=f.data.schema)==null?void 0:a[t]}if(n)switch(n.type){case m.CollectionSchemaType.CREATED_AT:return[Gn({from:new Date((o=e.createdAt)!=null?o:""),includeTime:!0})];case m.CollectionSchemaType.UPDATED_AT:return[Gn({from:new Date((i=e.updatedAt)!=null?i:""),includeTime:!0})];case m.CollectionSchemaType.CREATED_BY:return[Ru((l=e.createdBy)!=null?l:"")];case m.CollectionSchemaType.UPDATED_BY:return[Ru((c=e.updatedBy)!=null?c:"")];case m.CollectionSchemaType.FILE:case m.CollectionSchemaType.DATE:case m.CollectionSchemaType.NUMBER:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:case m.CollectionSchemaType.URL:return(d=e.data.collectionProperties)==null?void 0:d[t];case m.CollectionSchemaType.TITLE:return e.data.segments;case m.CollectionSchemaType.FORMULA:{const f=due(e,t);return ht(f)}default:return(u=e.data.collectionProperties)==null?void 0:u[t]}},fue=e=>{switch(e){case"bold":return"**";case"code":return"`";case"italic":return"*";case"lineThrough":return"~~";default:return""}},Dc=e=>{const t=[];let n={type:m.TextType.TEXT,enhancer:{},text:""};const s=e.concat(n),a=["code","lineThrough","italic","bold"];for(const o of s){const{type:i,enhancer:l}=o,c={head:[],tail:[],pre:new Set,text:""};switch(a.forEach(d=>{if(!n.enhancer[d]&&l[d]&&c.pre.add(d),n.enhancer[d]&&!l[d])for(let u=t.length-1;u>=0;u--){const f=t[u];if(f&&f.pre.has(d)){const h=fue(d);f.pre.delete(d),f.head.unshift(h),c.tail.push(h);break}}}),i){case m.TextType.DATE:c.text="@".concat(o.startDate);break;case m.TextType.USER:o.uuid&&(c.text="@".concat(Rn(o.uuid)));break;case m.TextType.DATETIME:c.text="@".concat(o.startDate," ").concat(o.startTime);break;case m.TextType.EQUATION:c.text="$".concat(o.text,"$");break;case m.TextType.URL:c.text="[".concat(o.text,"](").concat(o.url,")");break;case m.TextType.LINK_PAGE:if(o.uuid){const d=J.blocks[o.uuid],u=fe(d==null?void 0:d.data.segments);c.text="[".concat(u,"](").concat(_n(),"/").concat(o.uuid,")")}break;default:c.text=o.text}t.push(c),n=o}return t.reduce((o,i)=>{var l;return o="".concat(o.replace(/(\s*)$/,(c,d)=>"".concat(i.tail.join("")).concat(d))),o+="".concat((l=i.text)==null?void 0:l.replace(/^(\s*)/,(c,d)=>"".concat(d).concat(i.head.join("")))),o},"")},Z8=(e,t=0)=>{const{blocks:n}=J;let s=1;return e.reduce((a,o)=>{var T,v,I,j;const i=n[o];if(!i)return a;const{type:l,data:c,uuid:d,parentId:u,subNodes:f}=i,{segments:h=[],link:p,checked:g,format:_,level:x,display:F,caption:b,ref:w,collectionProperties:E,linkInfo:C}=c;t&&l!==m.BlockType.TABLE_ROW&&(a+="".concat(Array(t*2).fill(" ").join("")));const k=_n();switch(l){case m.BlockType.PAGE:case m.BlockType.FOLDER:case m.BlockType.COLLECTION_VIEW:case m.BlockType.COLLECTION_VIEW_PAGE:a+="[".concat(fe(h),"](").concat(k,"/").concat(d,")");break;case m.BlockType.TEXTAREA:case m.BlockType.MARK:a+=Dc(h);break;case m.BlockType.BOOKMARK:a+="[".concat(fe(C)||qB(p!=null?p:""),"](").concat(p,")");break;case m.BlockType.EMBED:a+="[".concat(p,"](").concat(p,")");break;case m.BlockType.TODO:a+="- [".concat(g?"x":" ","] ").concat(Dc(h));break;case m.BlockType.CODE:a+="```".concat((T=_==null?void 0:_.language)!=null?T:"","\n").concat(fe(h),"\n```\n");break;case m.BlockType.DIVIDER:a+="---";break;case m.BlockType.MIND_MAPPING:case m.BlockType.HEADER:a+="".concat(Array(x).fill("#").join("")," ").concat(Dc(h));break;case m.BlockType.QUOTE:a+="> ".concat(Dc(h));break;case m.BlockType.TOGGLE_HEADER:case m.BlockType.FOLD_LIST:case m.BlockType.LIST:a+="- ".concat(Dc(h));break;case m.BlockType.ORDER_LIST:a+="".concat(s,". ").concat(Dc(h)),s++;break;case m.BlockType.EQUATION:a+="$".concat(fe(h),"$");break;case m.BlockType.REFERENCE:case m.BlockType.REFERENCE_COLLECTION:case m.BlockType.REFERENCE_COLLECTION_PAGE:{if(w!=null&&w.uuid){const S=n[w.uuid];if(!S)break;a+="[".concat(fe(S.data.segments),"](").concat(k,"/").concat(w.uuid,")")}break}case m.BlockType.EXTERNAL_FILE:case m.BlockType.FILE:{const S=fe(h);if(F==="folder")a+="[".concat(S,"](").concat(k,"/").concat(d,")");else{const D=F==="image",A=b?"".concat(fe(b)):D&&p||S,P=D?"!":"";if(p)a+="".concat(P,"[").concat(A,"](").concat(p,")");else{const L=document.querySelector('[data-block-id="'.concat(d,'"]'));if(L){const O=L.querySelector("img");if(O){a+="".concat(P,"[").concat(A,"](").concat(O.src,")");break}}a+="".concat(P,"[").concat(A,"](").concat(k,"/preview/").concat(d,")")}}break}case m.BlockType.TABLE_ROW:{const S=n[u];if(!S)break;const D=(v=S.data.format)==null?void 0:v.tableBlockRowHeader,A=(j=(I=S.data.format)==null?void 0:I.tableBlockColumnOrder)!=null?j:[],P=o===(S==null?void 0:S.subNodes[0]),L=o===(S==null?void 0:S.subNodes[(S==null?void 0:S.subNodes.length)-1]);P&&!D&&(a+="".concat(Array.from(Array(A.length+1)).fill("|").join(""),"\n").concat(Array.from(Array(A.length)).fill("|-").join(""),"|\n")),a+=A.reduce((O,$)=>{const M=E==null?void 0:E[$];return M&&(O+=Dc(M)),"".concat(O,"|")},"|"),P&&D&&(a+="\n".concat(Array.from(Array(A.length)).fill("|-").join(""),"|")),a+=L?"\n\n":"\n";break}default:s=1}if(b&&(a+="\n".concat(Dc(b))),l!==m.BlockType.TABLE&&l!==m.BlockType.TABLE_ROW&&(a+="\n\n"),!tn(l)&&f.length){const S=l===m.BlockType.COLUMN_LIST||l===m.BlockType.COLUMN;S||++t,a+=Z8(f,t),S||--t}return a},"")},oF=(e,t=1)=>{var o;const{blocks:n}=J,s=n[e];if(!s||t===5||!B0(e))return"";let a="".concat(Array(t).fill("#").join("")," ").concat(Dc((o=s.data.segments)!=null?o:[]),"\n");return s.subNodes.forEach(i=>{a+=oF(i,t+1)}),a},IE=new Set([m.BlockType.TEXTAREA,m.BlockType.HEADER,m.BlockType.TODO,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST,m.BlockType.MARK,m.BlockType.QUOTE,m.BlockType.COLUMN_LIST,m.BlockType.COLUMN,m.BlockType.TABLE,m.BlockType.CODE,m.BlockType.EQUATION,m.BlockType.DIVIDER]);IE.add(m.BlockType.MIND_MAPPING);const bo=e=>{var s,a,o;const{blocks:t}=pe(),n=e.filter(i=>{const l=t[i];return l?IE.has(l.type):!1});return n.length===1&&ir((a=t[(s=e[0])!=null?s:""])==null?void 0:a.type)?oF((o=e[0])!=null?o:""):Z8(n)},zT=e=>{var u,f,h;const{blocks:t}=J,n=J.blocks[e];if(!n)return"";const s=(u=localStorage.getItem("viewId:".concat(n.uuid)))!=null?u:"",{view:a,properties:o}=(f=gn(s))!=null?f:{};if(!a||!o)return"";let i="",l="";const c=(h=n.data.schema)!=null?h:{};o.forEach(({property:p},g)=>{var _;g===0&&(i+="\n| ",l+="\n| "),i+="".concat((_=c[p])==null?void 0:_.name," |"),l+="--- |"}),i+=l;const{sortedRecordIds:d}=Jc({viewId:s,pageId:e});return d.forEach(p=>{const g=t[p];g!=null&&g.data.collectionProperties&&o.forEach((x,F)=>{var E;if(!((E=c[x.property])==null?void 0:E.type))return;const w=sj(g,x.property,void 0,J);if(w){let C=w.join("");F===0&&(i+="\n| "),C=C.startsWith("@")?C.slice(1):C,i+="".concat(C," |")}else i+="-- |"})}),i.trim()},mue=new Set([m.CollectionSchemaType.CREATED_AT,m.CollectionSchemaType.CREATED_BY,m.CollectionSchemaType.UPDATED_AT,m.CollectionSchemaType.UPDATED_BY,m.CollectionSchemaType.RELATION,m.CollectionSchemaType.FORMULA,m.CollectionSchemaType.ROLLUP,m.CollectionSchemaType.PERSON,m.CollectionSchemaType.CHECKBOX]),NE=(e,t)=>{const n=new Set(t);if(e.length===n.size)return nm(e);const s=e.filter(a=>!n.has(a));return nm(s)},e7=e=>{var D,A,P,L,O,$,M,U,z,K,W,Y,G,ee,te;const{pageId:t,blockId:n,tempPageId:s,allLine:a,archiveResult:o,selectedText:i,selectedBlockIds:l,editTypeRef:c,editType:d,scene:u,fetchAIResult:f,setPlaceHolder:h,getSelectedContent:p,removeTempPage:g,closeSelf:_,selection:x,model:F,isBitable:b,isMindMapPage:w,isDescription:E,prompt:C,setPrompt:k,getEditorModel:T}=e,v=c.current;if(d!==we.TryAgain&&(c.current=d),u===it.PageEmpty){h((D=$h(d))==null?void 0:D.prompt),k==null||k((A=$h(d))==null?void 0:A.prompt),d===we.Custom&&C&&h(C);return}const I=(()=>{let Q="";return E&&(u===it.TextSelected||u===it.TextSelectedAndWroteByAI)?Q=i.current:Q=zT(n),Q})(),{blocks:j}=pe(),S=j[t];if(S)switch(d){case we.Custom:{let Q="";const ne=J.blocks[n];b?Q=I:(ne==null?void 0:ne.type)===m.BlockType.MIND_MAPPING?Q=bo([n]):Q=u===it.PageHasContent?bo(S.subNodes):i.current,f({type:"custom",selectedText:Q});break}case we.ContinueWrite:{let Q="",ne="";if(u===it.PageHasContent){const se=T(n);if(!se)return;if(ir((P=J.blocks[n])==null?void 0:P.type))Q=oF(n);else{const ce=S.subNodes.indexOf(n);Q=bo(S.subNodes.slice(0,ce))+ta(Jr(se.content,0,(L=x==null?void 0:x.start)!=null?L:0)),ne=ta(Jr(se.content,(O=x==null?void 0:x.start)!=null?O:0,se.content.length))+bo(S.subNodes.slice(ce+1))}}if((u===it.PageContentWroteByAI||u===it.BlockSelectedAndWroteByAI||u===it.TextSelectedAndWroteByAI)&&(Q=a.current.join(""),Q.trim()||(Q=o.current.join(""))),u===it.BlockSelected)if(b)Q=I;else if(ir(($=J.blocks[n])==null?void 0:$.type))Q=oF(n);else{const se=S.subNodes.indexOf(n);Q=bo(S.subNodes.slice(0,se+l.current.length)),ne=bo(S.subNodes.slice(se+l.current.length))}if(u===it.TextSelected)if(E){const se=fe((M=j[n])==null?void 0:M.data.description);Q=se.slice(0,(U=x==null?void 0:x.end)!=null?U:0),ne="".concat(se.slice((z=x==null?void 0:x.end)!=null?z:0))}else{const se=S.subNodes.indexOf(n),ce=fe((K=j[n])==null?void 0:K.data.segments);Q=bo(S.subNodes.slice(0,se))+ce.slice(0,(W=x==null?void 0:x.end)!=null?W:0),ne="".concat(ce.slice((Y=x==null?void 0:x.end)!=null?Y:0),"\n\n").concat(bo(S.subNodes.slice(se+1)))}f({type:"continue",previousText:Q,restText:ne});break}case we.Summarize:{let Q="";const ne=J.blocks[n];b?Q=I:(ne==null?void 0:ne.type)===m.BlockType.MIND_MAPPING?Q=bo([n]):Q=u===it.PageHasContent?bo(S.subNodes):i.current,f({type:"summarize",selectedText:Q});break}case we.Improve:{(u===it.BlockSelected||u===it.TextSelected)&&f({type:"improve",selectedText:i.current});break}case we.OtherLanguage:{h("把当前语言翻译成：");break}case we.Comment:case we.BugFix:{f({type:d,selectedText:p()});break}case we.CPlus:case we.Java:case we.TypeScript:case we.Python:case we.JavaScript:{f({type:"rewriting",language:d,selectedText:p()});break}case we.OtherCodeLanguage:{h("把当前代码改写成：");break}case we.Summary:case we.Explain:case we.Chinese:case we.ClassicalChinese:case we.English:case we.Korean:case we.Japanese:case we.French:case we.German:{d===we.Summary||d===we.Explain?f({type:d,selectedText:p()}):f({type:"translate",language:d,selectedText:p()});break}case we.Simpler:case we.Longer:case we.Professional:case we.Casual:case we.Straightforward:case we.Confident:case we.Friendly:{f({type:d,selectedText:i.current});break}case we.Close:{g(),_();break}case we.Replace:{if(u===it.BlockSelectedAndWroteByAI){if(b){const{blocks:Q}=J,ne=Q[n];if(!ne)return;const se=Q[s.current];if(!se)return;if(v&&My.has(v)){const ae=se.subNodes.find(de=>{const ke=Q[de];return(ke==null?void 0:ke.type)===m.BlockType.COLLECTION_VIEW});if(ae){const de=zT(ae).split("\n");de.splice(1,1);const ke="viewId:".concat(n),Te=(G=localStorage.getItem(ke))==null?void 0:G.trim(),he=J.collectionViews[Te!=null?Te:""],Ee=(ee=ne.data.schema)!=null?ee:{};if(he){const ge=he.format.tableProperties;if(ge){const Se=((te=de[0])!=null?te:"").split("|").filter(Ae=>!!Ae.trim()).map(Ae=>Ae.trim()),Re={};hn(()=>{ge.forEach((Me,Ge)=>{var gt;const{property:tt}=Me;Re[tt]=Ge,Np(n,tt,{name:(gt=Se[Ge])!=null?gt:""},{needTransaction:!1})});const Ae=Re.title;ne.subNodes.forEach((Me,Ge)=>{var sn,ms,N,B,X;const tt=Q[Me];if(!tt||tt.hidden)return;const kt=((sn=de[Ge+1])!=null?sn:"").split("|").filter(Z=>!!Z.trim()).map(Z=>Z.trim()),At=(ms=tt.data.collectionProperties)!=null?ms:{},Qt={...At};Object.keys(At).forEach(Z=>{var Le,bt,Ue,He;const oe=Ee[Z];if(!oe||mue.has(oe.type))return;const xe=Re[Z];if(typeof xe>"u")return;let Be=kt[xe];if(Be){if(oe.type===m.CollectionSchemaType.SELECT||oe.type===m.CollectionSchemaType.MULTI_SELECT){const rt=Be.split(",").filter(Boolean).map(Pt=>Pt.trim());Be=rt.join(",");const je=J.blocks[n],le=(Ue=(bt=(Le=je==null?void 0:je.data.schema)==null?void 0:Le[Z])==null?void 0:bt.options)!=null?Ue:[],Qe=(He=le.map(Pt=>Pt.value))!=null?He:[],Tt=rt.filter(Pt=>!Qe.includes(Pt)).map(Pt=>{var Bn,Gt;const cn=vr.map(jr=>jr.key),Lt=(Gt=NE(cn,(Bn=le.map(jr=>jr.color))!=null?Bn:[]))!=null?Gt:vr[0].key;return{id:qe(),value:Pt,color:Lt}});Np(n,Z,{options:le.concat(Tt)},{needTransaction:!1})}Qt[Z]=ht(Be)}});const nn=typeof Ae<"u"?ht((N=kt[Ae])!=null?N:""):(X=(B=tt.data)==null?void 0:B.segments)!=null?X:void 0;_e(Me,{data:{segments:nn,collectionProperties:Qt}})})})}}}g(),_();break}const ce=bo(se.subNodes);hn(()=>{_e(n,{data:{description:ht(ce),isByAI:!0}})}),g(),_();break}else if(v&&My.has(v)&&w&&n===t){const Q=J.blocks[s.current];if(!Q)return;const ne=Q.subNodes[0];if(!ne)return;const se=J.blocks[ne];if(!se)return;hn(()=>{_e(n,{data:se.data})}),_()}hn(()=>{const Q=[];let ne=n;const se=J.blocks[s.current];se&&(se.subNodes.forEach(ce=>{const ae=J.blocks[ce];if(ae){if(ne=ut({type:ae.type,data:ae.data},{parentId:t,after:ne}),ae.subNodes.length>0){let de="";ae.subNodes.forEach(ke=>{const Te=J.blocks[ke];Te&&(de=ut({type:Te.type,data:Te.data},{parentId:ne,after:de}))})}Q.push({blockId:ne})}}),l.current.forEach(ce=>Ro(ce)),g(),re(at.update({selectedBlocks:Q})),_())})}if(u===it.TextSelectedAndWroteByAI){if(!F)return;const Q=J.blocks[s.current];if(!Q)return;const ne=[];let se=n;Q.subNodes.forEach((ce,ae)=>{var ke;const de=J.blocks[ce];if(de){if(ae===0&&de.type===m.BlockType.TEXTAREA){const Te=((ke=de.data.segments)!=null?ke:[]).map(he=>{const Ee=qi(he);try{return ti(he.text,Ee)}catch(ge){return ti("�",Ee)}});F.performChange(he=>{var Ee,ge;he.shadow().select((Ee=x==null?void 0:x.start)!=null?Ee:0,(ge=x==null?void 0:x.end)!=null?ge:0).replace(Wn(Te)).release()}),F.requestFocus();return}if(de.type===m.BlockType.TEXTAREA&&fe(de.data.segments)!==""||de.type!==m.BlockType.TEXTAREA){if(se=ut({type:de.type,data:de.data},{parentId:t,after:se}),de.subNodes.length>0){let Te="";de.subNodes.forEach(he=>{const Ee=J.blocks[he];Ee&&(Te=ut({type:Ee.type,data:Ee.data},{parentId:se,after:Te}))})}ne.push({blockId:se})}}}),g(),ne.length>0&&re(at.update({selectedBlocks:ne})),_()}break}case we.Insert:{hn(()=>{var de,ke,Te,he,Ee,ge;let Q=n;if(!b&&u===it.BlockSelectedAndWroteByAI&&!w){const Se=(ke=(de=J.blocks[t])==null?void 0:de.subNodes)!=null?ke:[];let Re=0;l.current.forEach(Ae=>{Re=Math.max(Se.indexOf(Ae),Re)}),Q=(Te=Se[Re])!=null?Te:n}const ne=J.blocks[s.current];if(!ne)return;const se=w?(he=J.blocks[Q])==null?void 0:he.parentId:t;if(!se)return;const ce=[];if(ne.subNodes.length===1&&J.ui.selectedBlocks.length===1&&v&&My.has(v)){const{isMindMapPage:Se}=V_((ge=(Ee=J.ui.selectedBlocks[0])==null?void 0:Ee.blockId)!=null?ge:""),Re=ne.subNodes[0];Se&&Re&&_e(Re,{type:m.BlockType.MIND_MAPPING},!0)}const ae=(Se,Re,Ae)=>{const Me=J.blocks[Se];if(!Me)return"";const Ge=ut({type:Me.type,data:Me.data},{parentId:Re,after:Ae});ce.push({blockId:Ge});let tt;return Me.subNodes.forEach(gt=>{tt=ae(gt,Ge,tt)}),Ge};ne.subNodes.forEach(Se=>{Q=ae(Se,se,Q)}),g(),re(at.update({selectedBlocks:ce})),_()});break}case we.InsertToBitableDesc:{hn(()=>{var de;const{blocks:Q}=J,ne=Q[n];if(!ne)return;const se=(de=ne.data.description)!=null?de:[],ce=Q[s.current];if(!ce)return;const ae=bo(ce.subNodes);_e(n,{data:{description:[...se,...ht(ae)],isByAI:!0}}),g(),_()});break}case we.Discard:{g(),_();break}case we.TryAgain:{g(),c.current&&e7({...e,editType:c.current});break}}},cc=async(e,t)=>{if(gs.check){du.download({id:qe(),url:e,fileName:t==null?void 0:t.replace("/","-")});return}if(eQ()){t7(e,t);return}const n=document.createElement("a");t&&(n.download=t),n.target="_blank",n.href=e;const s=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});n.dispatchEvent(s)},hue=e=>{const t=e.indexOf("?");if(t>0&&(e=e.substring(0,t)),!e.endsWith("/")){const n=e.lastIndexOf("/")+1;if(n>0)return e.substring(n)}return"未知文件名"},t7=(e,t)=>{if(gs.check){du.download({id:qe(),url:e,fileName:t==null?void 0:t.replace("/","-")});return}const n=document.createElement("a");t&&(n.download=t),n.href=e,n.click()},Ci=(e,t="属性")=>{const n=Object.values(e!=null?e:{}).map(i=>i.name),s=new Set(n);let a=0,o=t;for(;s.has(o);)a+=1,o="".concat(t," ").concat(a);return o},cf=()=>{const e=Oe(),t=({collectionId:n,viewId:s,position:a,propertyType:o=m.CollectionSchemaType.TEXT,isTimelineTable:i=!1,visible:l=!0,width:c,propertyName:d,partialSchema:u,newPropertyId:f=qe()})=>{var w,E;const{blocks:h,collectionViews:p}=J,g=h[n];if(!g)return;const{visibleProperty:_,inVisibleProperty:x}=X0(f);let F={};if(s){const C=p[s];if(!C)return;F=Ni(C.format,pd);const{properties:k=[],timelineTableProperties:T=[]}=gn(C),I=[...i?T:k],j=l&&[m.CollectionViewType.TABLE,m.CollectionViewType.FORM].includes(C.type)?_:x;if(j.width=c,a)if(a.first)I.unshift(j);else{const D=I.findIndex(A=>A.property===a.property);D>-1?I.splice(a.left?D:D+1,0,j):I.push(j)}else I.push(j);const S=i?"timelineTableProperties":"".concat(n7(C.type),"Properties");F[S]=I,pd.forEach(D=>{if(D===S)return;const A=F[D];A&&(l&&["tableProperties","formProperties"].includes(D)?F[D]=a!=null&&a.first?[_,...A]:[...A,_]:F[D]=a!=null&&a.first?[x,...A]:[...A,x])})}let b=[...(w=g.data.collectionPageProperties)!=null?w:[]];return b.length===0&&(b=Object.keys((E=g.data.schema)!=null?E:{}).map(C=>({property:C,visible:!0}))),b.push(l?_:x),e(()=>{_e(n,{data:{collectionPageProperties:b,schema:{[f]:{name:Ci(g.data.schema,d),type:o,...u},...g.data.schema}}}),s&&Rs(s,{format:F}),Qf(g.uuid,[f],s,a,l)}),f};return y.useCallback(t,[e])},jE=()=>[{id:qe(),value:"待处理",color:Ze.red},{id:qe(),value:"进行中",color:Ze.yellow},{id:qe(),value:"已完成",color:Ze.green}],pd=["tableProperties","boardProperties","galleryProperties","listProperties","timelineProperties","timelineTableProperties","calendarProperties","formProperties"],X0=e=>({visibleProperty:{property:e,visible:!0},inVisibleProperty:{property:e,visible:!1}}),Qf=(e,t,n,s,a)=>{var u;const{blocks:o,collectionViews:i}=pe(),l=o[e];if(!l)return;const c=[],d=[];t.forEach(f=>{const{visibleProperty:h,inVisibleProperty:p}=X0(f);c.push(h),d.push(p)}),(u=l.views)==null||u.forEach(f=>{if(f===n)return;const h=i[f];if(!h)return;const p=Ni(h.format,pd);pd.forEach(g=>{const _=p[g];_&&(g==="tableProperties"&&a?p[g]=s!=null&&s.first?[...c,..._]:[..._,...c]:p[g]=s!=null&&s.first?[...d,..._]:[..._,...d])}),Rs(f,{format:p})})},n7=e=>{switch(e){case m.CollectionViewType.BOARD:return m.CollectionViewType.BOARD;case m.CollectionViewType.LIST:return m.CollectionViewType.LIST;case m.CollectionViewType.GALLERY:return m.CollectionViewType.GALLERY;case m.CollectionViewType.TIMELINE:return m.CollectionViewType.TIMELINE;case m.CollectionViewType.CALENDAR:return m.CollectionViewType.CALENDAR;case m.CollectionViewType.FORM:return m.CollectionViewType.FORM;default:return m.CollectionViewType.TABLE}},pue=()=>{const e=Oe(),t=Hm(),{setting:n={}}=Ut(),s=ns();return y.useCallback(async a=>{const{viewId:o,where:i,propertyValues:l,templateId:c,isOpenInRight:d,from:u}=a,f=[],h=e(()=>{const p=gue(o,i,l);p!=null&&c!=null&&s7(p,c,f);const g=xt.$collectionSearch;return st({$collectionSearch:{...g,[o]:void 0}}),p&&(d?n.useRightPageByNew?t(p):s.push("/".concat(p)):st({$newCreatedRecord:{id:p,from:u,viewId:o}})),p},{noThrottle:!0});return mo(async()=>{await Promise.all(f.map(p=>p()))}),h},[e,n.useRightPageByNew,t,s])},gue=(e,t,n)=>{var f,h,p,g,_,x;const s=gn(e);if(!s)return;const{view:a,collection:o}=s,i=qe(),l={type:m.BlockType.PAGE,uuid:i};if(l.data={},n!==void 0){const{title:F,...b}=n;if(l.data.collectionProperties=hL(b,ol),l.data.segments=F,ef(o.uuid)){const E=(f=o.data.format)==null?void 0:f.openSubItem;if(E!=null&&E.childPropertyId&&E.parentPropertyId){const C=(h=b[E.parentPropertyId])==null?void 0:h.map(k=>k.uuid);C==null||C.forEach(k=>{k&&o7(o.uuid,k,i)})}}}let c=!1;if(a.type===m.CollectionViewType.CALENDAR?c=((p=a.format.calendarColorSetting)==null?void 0:p.type)===m.CardColorSource.CUSTOM:a.type===m.CollectionViewType.TIMELINE&&(c=((g=a.format.timelineColorSetting)==null?void 0:g.type)===m.CardColorSource.CUSTOM),c){const F=vr.map(w=>w.key),b=(_=nm(F))!=null?_:vr[0].key;l.data.collectionCardColor=b}ut(l,{parentId:o.uuid,last:!0});const{newPageSort:d,needUpdate:u}=SE(a.pageSort,o.subNodes);return u&&Rs(e,{pageSort:d}),t!=null&&t.first||t!=null&&t.before?re(cm({uuid:i,viewId:e,before:t.before})):re(ld({uuid:i,viewId:e,after:t==null?void 0:t.after})),(x=o.views)==null||x.forEach(F=>{F!==e&&re(ld({uuid:i,viewId:F}))}),i},SE=(e,t)=>{const n=new Set(e),s=new Set(t);let a=!1;for(const o of t)n.has(o)||(a=!0,n.add(o));for(const o of e)s.has(o)||(a=!0,n.delete(o));return{needUpdate:a,newPageSort:[...n]}},s7=(e,t,n=[])=>{var l,c,d,u,f,h;const s=pe().blocks[e];if(s==null){console.warn("找不到记录".concat(e));return}const a=pe().blocks[t];if(a==null){console.warn("找不到模板记录".concat(t));return}const o={},i={...s.data.collectionProperties};for(const[p,g]of Object.entries((l=a.data.collectionProperties)!=null?l:{}))p!=="title"&&(i[p]===void 0||((c=i[p])==null?void 0:c.length)===0)&&(i[p]=g);o.data={collectionProperties:i},o.data.pageFixedWidth=a.data.pageFixedWidth,o.data.directoryMenu=a.data.directoryMenu,s.data.cover==null&&(o.data.cover=a.data.cover),s.data.coverPos==null&&(o.data.coverPos=a.data.coverPos),s.data.icon==null&&(o.data.icon=a.data.icon),s.data.iconUrl==null&&(o.data.iconUrl=a.data.iconUrl),(d=a.data.format)!=null&&d.pageLayout&&(o.data.format||(o.data.format={}),o.data.format.pageLayout=(u=a.data.format)==null?void 0:u.pageLayout),(f=a.data.format)!=null&&f.fontFormat&&(o.data.format||(o.data.format={}),o.data.format.fontFormat=(h=a.data.format)==null?void 0:h.fontFormat),_e(e,o),s.subNodes.length===0&&a.subNodes.length===0&&ut({type:m.BlockType.TEXTAREA},{parentId:e,last:!0}),a.subNodes.length>0&&n.push(async()=>{const p=await ve.editor.copySubNodes.raw({list:[{uuid:a.uuid,targetId:e}]});p.code!==200&&be.error(p.msg)})},Ig=e=>{var p,g,_,x,F,b,w;const t={},{viewId:n,groupValue:s,subGroupValue:a,blockId:o,oldGroupValues:i,isNewRecord:l}=e;if(!s&&!a)return t;const{collection:c,view:d,subGroupBy:u,groupBy:f}=(p=gn(n))!=null?p:{};if(!c||!d)return t;const h=(u==null?void 0:u.property)===(f==null?void 0:f.property);return[{groupValue:s,propertyId:f==null?void 0:f.property,schemaType:(x=(_=c.data.schema)==null?void 0:_[(g=f==null?void 0:f.property)!=null?g:""])==null?void 0:x.type,oldGroupValue:Object.keys(i!=null?i:{}),groupBy:f},{groupValue:a,propertyId:u==null?void 0:u.property,schemaType:(w=(b=c.data.schema)==null?void 0:b[(F=u==null?void 0:u.property)!=null?F:""])==null?void 0:w.type,oldGroupValue:i?[...new Set(Object.values(i).flat().filter(Boolean))]:void 0,groupBy:u}].forEach(({groupValue:E,propertyId:C,schemaType:k,groupBy:T,oldGroupValue:v})=>{var I,j,S,D,A,P;if(!(!E||!C||!k)){if(!Qo(E)){k===m.CollectionSchemaType.TITLE?t.title=(I=t.title)!=null?I:[]:t[C]=(j=t[C])!=null?j:[];return}if(E=Qo(E),!!E)switch(k){case m.CollectionSchemaType.TITLE:{t.title=ht(E);break}case m.CollectionSchemaType.NUMBER:{if(E==="out_of_range")t[C]=ht((S=T==null?void 0:T.end)!=null?S:1e3);else{const L=E.split("->")[0];L&&(t[C]=ht(L))}break}case m.CollectionSchemaType.MULTI_SELECT:{if(l&&h){const $=fe(t[C]);$?$!==E&&(t[C]=ht("".concat($,",").concat(E))):t[C]=ht("".concat(E));break}const{blocks:L}=pe(),O=L[o!=null?o:""];if(O){const $=(D=O.data.collectionProperties)==null?void 0:D[C],M=fe($).split(",").map(z=>v!=null&&v.includes(z)?"":z).filter(z=>!!z);let U="";M.includes(E)?U=M.join(","):U=M.concat(E).join(","),t[C]=ht(U);break}t[C]=ht(E);break}case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.CHECKBOX:case m.CollectionSchemaType.SELECT:{t[C]=ht(E);break}case m.CollectionSchemaType.DATE:{const L=b_(E);t[C]=[Gn({from:ue(L).toDate()})];break}case m.CollectionSchemaType.PERSON:{const{blocks:L}=pe(),O=L[o!=null?o:""];if(O){const $=(P=(A=O.data.collectionProperties)==null?void 0:A[C])!=null?P:[];let M=!1;const U=$.filter(z=>{var K;return z.type===m.TextType.USER?z.uuid===E?(M=!0,!0):!(v!=null&&v.includes((K=z.uuid)!=null?K:"")):!1});M||U.push(Ru(E)),t[C]=U;break}t[C]=[Ru(E)];break}case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:{t[C]=[{type:m.TextType.URL,url:E,text:E,enhancer:{}}];break}case m.CollectionSchemaType.RELATION:{t[C]=[{type:m.TextType.LINK_PAGE,uuid:E,text:"",enhancer:{code:!1}}];break}}}}),t},_ue=()=>{const{collectionId:e,viewId:t}=Ne(),n=vs(t),s=ye(e,["data"],["defaultTemplateId"]);return(n==null?void 0:n.format.defaultTemplateId)||(s==null?void 0:s.data.defaultTemplateId)},xue=(e,t)=>{const n=J.blocks[e],s=J.collectionViews[t];return(s==null?void 0:s.format.defaultTemplateId)||(n==null?void 0:n.data.defaultTemplateId)||"empty"},yue=()=>{const e=ie(),t=lt();return n=>new Promise(s=>{e.warning({title:r.jsx("div",{className:"mb-3",children:"是否禁用排序规则"}),content:r.jsx("div",{className:"text-t2",children:"当前已设置排序规则，这可能导致你找不到插入后的记录，是否将记录顺序调整为当前排序结果并禁用排序规则？"}),confirm:()=>{var l;me.event("bitable_view_sort_manage",{manage_type:"popoff"});const a=gn(n);if(!a){s(!0);return}const{sortedRecordIds:o}=Jc({viewId:n,ignoreSearch:!0,pageId:t}),i=(l=Br(a.view.format.sorters))!=null?l:[];for(const c of i)c.disable=!0;ic(n,{pageSort:o,format:{sorters:i}}),s(!0)},cancel:()=>{s(!1)}})})},bue=(e,t,n)=>{var s,a,o;switch(e.type){case m.CollectionSchemaType.CHECKBOX:return us(t)?ht("YES"):void 0;case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:{const i=ue(t,Et);return i.isValid()?[Gn({from:i.toDate()})]:void 0}case m.CollectionSchemaType.CREATED_BY:case m.CollectionSchemaType.UPDATED_BY:case m.CollectionSchemaType.PERSON:{const i=t==="me"?yt.uuid:t;return[Ru(i)]}case m.CollectionSchemaType.RELATION:{if(t==="")return;let i=new Set;if(e.collectionId){const c=J.blocks[e.collectionId];i=new Set((s=c==null?void 0:c.templatePages)!=null?s:[])}const l=[];return t.split(",").forEach(c=>{if(c){if(n&&i.has(c)){if(n===c)return;c=n}l.push({type:m.TextType.LINK_PAGE,enhancer:{},text:"",uuid:c})}}),l}case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:return ht((o=(a=e.options)==null?void 0:a.find(i=>i.id===t))==null?void 0:o.value);case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.URL:default:return ht(t)}};function r7(e,t,n,s){const a=i=>{const l=pl[i];return l!=null?l.fn()[0].format(Et):i},o=i=>{if(i==null||i.disable)return!0;if(i.type==="group")return i.operator==="and"?i.filters.filter(S=>gl(S,e)).every(S=>o(S)):i.filters.length===0?!0:i.filters.filter(S=>gl(S,e)).some(S=>o(S));const{property:l}=i,c=e[l];if(c==null||hm.includes(c.type)||GI.includes(c.type))return!0;const d=n[l],u=S=>(c.type===m.CollectionSchemaType.DATE&&(S=a(S)),n[l]=bue(c,S,s),!0),f=()=>d===void 0,h=()=>{var S,D;if(d!==void 0)return!0;switch(c.type){case m.CollectionSchemaType.DATE:return u(ue().format(Et));case m.CollectionSchemaType.PERSON:return u("me");case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{const A=(D=(S=c.options)==null?void 0:S[0])==null?void 0:D.id;return A!=null?u(A):!1}case m.CollectionSchemaType.CHECKBOX:return u("YES");default:return!1}},p=S=>{const D=P=>S==="neq"?!P:P,A=P=>S==="eq"?u(P):!0;switch(c.type){case m.CollectionSchemaType.DATE:{const P=ue(a(i.value),Et),L=d==null?void 0:d.find(O=>O.type===m.TextType.DATE||O.type===m.TextType.DATETIME);if(L!=null){const O=ue(ud(L)).startOf("day");return D(O.isSame(P))}return A(i.value)}case m.CollectionSchemaType.NUMBER:{const P=Number(i.value),L=jT(d);return L!==void 0?D(L===P):A(i.value)}default:return d!==void 0?D(fe(d)===i.value):A(i.value)}},g=()=>p("eq"),_=()=>p("neq"),x=S=>{switch(c.type){case m.CollectionSchemaType.NUMBER:{const D=Number(i.value),A=jT(d);if(A!==void 0)switch(S){case"lt":return A<D;case"gt":return A>D;case"lte":return A<=D;case"gte":return A>=D;default:return!1}switch(S){case"lt":return u("".concat(D-1));case"gt":return u("".concat(D+1));default:return u(i.value)}}case m.CollectionSchemaType.DATE:{const D=ue(a(i.value),Et),A=d==null?void 0:d.find(P=>P.type===m.TextType.DATE||P.type===m.TextType.DATETIME);if(A!=null){const P=ue(ud(A)).startOf("day");switch(S){case"lt":return P.isBefore(D);case"gt":return P.isAfter(D);case"lte":return P.isBefore(D)||P.isSame(D);case"gte":return P.isAfter(D)||P.isSame(D);default:return!1}}switch(S){case"lt":return u(D.subtract(1,"day").format(Et));case"gt":return u(D.add(1,"day").format(Et));default:return u(D.format(Et))}}default:return!1}},F=()=>x("lt"),b=()=>x("gt"),w=()=>x("lte"),E=()=>x("gte"),C=S=>{const D=P=>S==="nin"?!P:P,A=P=>S==="in"?u(P):!0;switch(c.type){case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:return d!==void 0?D(fe(d).includes(i.value)):A(i.value);case m.CollectionSchemaType.MULTI_SELECT:return d!==void 0?D(fe(d).split(/\s*,\s*/g).findIndex(P=>P===i.value)!==-1):A(i.value);case m.CollectionSchemaType.PERSON:return d!==void 0?D(d.findIndex(P=>P.type===m.TextType.USER&&P.uuid===i.value)!==-1):A(i.value);case m.CollectionSchemaType.RELATION:return d!==void 0?D(d.findIndex(P=>P.type===m.TextType.LINK_PAGE&&P.uuid===i.value)!==-1):A(i.value);case m.CollectionSchemaType.DATE:return d!==void 0?D(d.findIndex(P=>P.type===m.TextType.DATE||P.type===m.TextType.DATETIME)!==-1):A(i.value);default:return!1}},k=()=>C("in"),T=()=>C("nin"),v=S=>{switch(c.type){case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:return d!==void 0?fe(d)[S](i.value):u(i.value);default:return!1}},I=()=>v("startsWith"),j=()=>v("endsWith");switch(i.operator){case"isEmpty":return f();case"isNotEmpty":return h();case"eq":return g();case"neq":return _();case"gt":return b();case"gte":return E();case"lt":return F();case"lte":return w();case"in":return k();case"nin":return T();case"startsWith":return I();case"endsWith":return j();default:return!0}};return o(t)}const Mi=e=>{const t=yue(),n=pue(),s=lt();return y.useCallback(async({viewId:a,where:o,propertyValues:i,from:l,openInRight:c,templateId:d})=>{var b,w,E,C;const u=pe().collectionViews[a];if(!u)return;const f=UN(a);if(!f)return;if(!d){const k=xue(f,a);k!=="empty"&&(d=k)}const h={},p=async k=>{const T=(k==null?void 0:k.openInRight)||c;n({viewId:a,where:o,propertyValues:h,templateId:d,isOpenInRight:T,from:l})};let g=!1;const _=(w=(b=pe().blocks[f])==null?void 0:b.data.schema)!=null?w:{};if(g=r7(_,u.format.filter,h,s),Object.assign(h,i),!g){await p({openInRight:!0});return}const F=((E=u.format.sorters)!=null?E:[]).filter(k=>!k.disable).length>0;if(!((C=e==null?void 0:e.ignoreSorters)!=null&&C)&&F){me.event("bitable_cancel_sort_dialog",{from_scene:"insert_record"});const k=await t(a);await p({openInRight:!k});return}await p()},[t,n,e==null?void 0:e.ignoreSorters,s])};let a7;const Fue=e=>{a7=e},wue=(...e)=>a7(...e),il=(e,t,n)=>{e.reduce((s,a)=>{kue(a,s,{viewId:n,ignoreOp:t.ignoreOp,relationParentId:t.targetRelationParentId});const{parentId:o}=s;return{parentId:o,after:a,groupValue:s.groupValue,subGroupValue:s.subGroupValue}},t)},o7=(e,t,n)=>{var a,o,i,l;const{blocks:s}=pe();if(t){const c=s[e],d=ef(c==null?void 0:c.uuid),u=(o=(a=c==null?void 0:c.data.format)==null?void 0:a.openSubItem)==null?void 0:o.childPropertyId;if(d&&u){const f=s[t],h=[...(l=(i=f==null?void 0:f.data.collectionProperties)==null?void 0:i[u])!=null?l:[]];h.push({type:m.TextType.LINK_PAGE,uuid:n,text:"",enhancer:{code:!1}}),_e(t,{data:{collectionProperties:{...f==null?void 0:f.data.collectionProperties,[u]:h}}})}}},Eue=(e,t,n)=>{var l,c,d,u;const{blocks:s}=pe(),a=s[e],o=ef(a==null?void 0:a.uuid),i=(c=(l=a==null?void 0:a.data.format)==null?void 0:l.openSubItem)==null?void 0:c.childPropertyId;if(o&&i){const f=s[t],h=[...(u=(d=f==null?void 0:f.data.collectionProperties)==null?void 0:d[i])!=null?u:[]],p=h.filter(g=>g.uuid!==n);p.length!==h.length&&_e(t,{data:{collectionProperties:{...f==null?void 0:f.data.collectionProperties,[i]:p}}})}},Cue=(e,t,n,s)=>{var c,d,u,f;const{blocks:a}=pe();if(t===s)return;const o=a[e],i=ef(o==null?void 0:o.uuid),l=(d=(c=o==null?void 0:o.data.format)==null?void 0:c.openSubItem)==null?void 0:d.parentPropertyId;if(i&&l){const h=a[n];let p=[...(f=(u=h==null?void 0:h.data.collectionProperties)==null?void 0:u[l])!=null?f:[]];s&&Eue(e,s,n),p=p.filter(g=>g.uuid!==s),p.push({type:m.TextType.LINK_PAGE,uuid:t,text:"",enhancer:{code:!1}}),_e(n,{data:{collectionProperties:{...h==null?void 0:h.data.collectionProperties,[l]:t?p:[]}}})}},kue=(e,t,n)=>{var u,f,h;if(e===t.parentId)return;const{viewId:s,ignoreOp:a}=n,{blocks:o}=pe(),i=o[e];if(!i)return;const l=o[t.parentId];if(!l)return;Xb(e);let c=!1;if((l.type===m.BlockType.COLLECTION_VIEW||l.type===m.BlockType.COLLECTION_VIEW_PAGE)&&s){if(!iI.includes(i.type))return;const{collectionViews:p}=pe(),g=o[l.uuid],_=p[s];if(!g||!_)return;const{newPageSort:x,needUpdate:F}=SE(_.pageSort,g.subNodes);F&&Rs(s,{pageSort:x}),x.includes(e)&&re(cd({uuid:e,viewId:s})),t.first||t.before?re(cm({uuid:e,viewId:s,before:t.before})):re(ld({uuid:e,viewId:s,after:t.after})),n.relationParentId&&(o7(t.parentId,n.relationParentId,e),Cue(t.parentId,n.relationParentId,e));const b={},w=(f=(u=pe().blocks[g.uuid])==null?void 0:u.data.schema)!=null?f:{},E=Ri();r7(w,_.format.filter,b,E);const C=Ig({viewId:s,groupValue:t.groupValue,subGroupValue:t.subGroupValue,blockId:e}),k=hL(b,ol);if(Object.keys(C).length>0||Object.keys(k).length>0){const T=pe().blocks[e];_e(e,{data:{segments:(h=C.title)!=null?h:T.data.segments,collectionProperties:{...T.data.collectionProperties,...C,...k}}},a)}i.type!==m.BlockType.PAGE&&(c=!0)}l.uuid===i.spaceId&&(i.type===m.BlockType.COLLECTION_VIEW?_e(e,{type:m.BlockType.COLLECTION_VIEW_PAGE},a):i.type===m.BlockType.REFERENCE_COLLECTION?_e(e,{type:m.BlockType.REFERENCE_COLLECTION_PAGE},a):i.type===m.BlockType.MIND_MAPPING&&_e(e,{type:m.BlockType.MIND_MAPPING_PAGE},a)),re(Tr({uuid:e,parentId:t.parentId,ignoreOp:a})),t.first||t.before?re(cl({uuid:e,parentId:t.parentId,before:t.before,ignoreOp:a})):re(ws({uuid:e,parentId:t.parentId,after:t.after,ignoreOp:a})),c&&wue([e],{type:m.BlockType.PAGE});const d=t.before||t.after;if(d){const p=o[d];if(p&&p.parentId===p.spaceId){const{permissions:g}=p;g.some(x=>x.type===m.PermissionType.SPACE)?i.permissions.some(x=>x.type===m.PermissionType.SPACE)||dl(e,{type:m.PermissionType.SPACE,role:m.PermissionRole.EDITOR}):_e(e,{permissions:[{type:m.PermissionType.USER,role:m.PermissionRole.EDITOR,userId:yt.uuid}]},a)}}fm(i.uuid,i.parentId)},Zx=e=>e.trim().length===0,ey={[m.CollectionSchemaType.TEXT]:e=>Zx(e),[m.CollectionSchemaType.NUMBER]:e=>!isNaN(Number(e)),[m.CollectionSchemaType.CHECKBOX]:e=>["yes","no","☑","☐"].includes(e==null?void 0:e.toLocaleLowerCase()),[m.CollectionSchemaType.URL]:e=>Zx(e)||!pb(e)&&Gu(e),[m.CollectionSchemaType.EMAIL]:e=>Zx(e)||pb(e),[m.CollectionSchemaType.DATE]:e=>Zx(e)||e.length>=6&&ue(e).isValid()},Tue=e=>{for(const t of Object.keys(ey))if(e.every(n=>{var s;return(s=ey[t])==null?void 0:s.call(ey,n!=null?n:"")}))return t;return e.some(t=>t==null?void 0:t.includes(","))?m.CollectionSchemaType.MULTI_SELECT:m.CollectionSchemaType.TEXT},vue=(e,t,n)=>{var u,f,h;const s=J.blocks[e];if(!s)return;let a=[];const o=t.length,i=s.subNodes.length;t[o-1]===""?a=t.slice(o-i-1,-1):a=t.slice(o-i);const l=a.map(p=>p.split("|").filter(_=>!!_.trim()).map(_=>_.trim())),c=(f=(u=s.views)==null?void 0:u[0])!=null?f:"",d=J.collectionViews[c];if(d){const p=d.format.tableProperties;if(p){const g={};p.forEach((x,F)=>{if(F===0)return;const b=l.map(E=>E[F]),w=Tue(b);g[x.property]=w});const _=(h=s.data.schema)!=null?h:{};Object.keys(g).forEach(x=>{var F;((F=_[x])==null?void 0:F.type)!==g[x]&&Np(s.uuid,x,{type:g[x]},{needTransaction:!n,ignoreOp:n})})}}},i7=Zi.keyMap,Ym={...i7.default};delete Ym["Ctrl-Z"];delete Ym["Ctrl-Y"];delete Ym["Ctrl-D"];delete Ym["Cmd-Z"];delete Ym["Cmd-Y"];delete Ym["Cmd-D"];i7.modified=Ym;const Iue=async e=>{switch(e){case"apl":return Pe(()=>import("./apl-24930a59.js").then(t=>t.a),["assets/apl-24930a59.js","assets/vendor-2890c4d6.js"]);case"asciiarmor":return Pe(()=>import("./asciiarmor-c8952501.js").then(t=>t.a),["assets/asciiarmor-c8952501.js","assets/vendor-2890c4d6.js"]);case"asn.1":return Pe(()=>import("./asn.1-536e40d9.js").then(t=>t.a),["assets/asn.1-536e40d9.js","assets/vendor-2890c4d6.js"]);case"asterisk":return Pe(()=>import("./asterisk-f0e0d9ec.js").then(t=>t.a),["assets/asterisk-f0e0d9ec.js","assets/vendor-2890c4d6.js"]);case"brainfuck":return Pe(()=>import("./brainfuck-a804cca3.js").then(t=>t.b),["assets/brainfuck-a804cca3.js","assets/vendor-2890c4d6.js"]);case"clike":return Pe(()=>import("./clike-4a4575d2.js").then(t=>t.c),["assets/clike-4a4575d2.js","assets/vendor-2890c4d6.js"]);case"cobol":return Pe(()=>import("./cobol-889a5efc.js").then(t=>t.c),["assets/cobol-889a5efc.js","assets/vendor-2890c4d6.js"]);case"clojure":return Pe(()=>import("./clojure-09e08a1d.js").then(t=>t.c),["assets/clojure-09e08a1d.js","assets/vendor-2890c4d6.js"]);case"css":return Pe(()=>import("./css-350a7ccd.js").then(t=>t.c),["assets/css-350a7ccd.js","assets/vendor-2890c4d6.js"]);case"cmake":return Pe(()=>import("./cmake-eb83f55c.js").then(t=>t.c),["assets/cmake-eb83f55c.js","assets/vendor-2890c4d6.js"]);case"coffeescript":return Pe(()=>import("./coffeescript-b11bbe9b.js").then(t=>t.c),["assets/coffeescript-b11bbe9b.js","assets/vendor-2890c4d6.js"]);case"commonlisp":return Pe(()=>import("./commonlisp-114f7d95.js").then(t=>t.c),["assets/commonlisp-114f7d95.js","assets/vendor-2890c4d6.js"]);case"cypher":return Pe(()=>import("./cypher-fe4c834e.js").then(t=>t.c),["assets/cypher-fe4c834e.js","assets/vendor-2890c4d6.js"]);case"python":return Pe(()=>import("./python-bfc673c3.js").then(t=>t.p),["assets/python-bfc673c3.js","assets/vendor-2890c4d6.js"]);case"crystal":return Pe(()=>import("./crystal-2e5c407a.js").then(t=>t.c),["assets/crystal-2e5c407a.js","assets/vendor-2890c4d6.js"]);case"sql":return Pe(()=>import("./sql-39ed810d.js").then(t=>t.s),["assets/sql-39ed810d.js","assets/vendor-2890c4d6.js"]);case"d":return Pe(()=>import("./d-2c0ebb2f.js").then(t=>t.d),["assets/d-2c0ebb2f.js","assets/vendor-2890c4d6.js"]);case"dart":return Pe(()=>import("./dart-aafb2844.js").then(t=>t.d),["assets/dart-aafb2844.js","assets/vendor-2890c4d6.js","assets/clike-4a4575d2.js"]);case"diff":return Pe(()=>import("./diff-ed6f96b5.js").then(t=>t.d),["assets/diff-ed6f96b5.js","assets/vendor-2890c4d6.js"]);case"django":return Pe(()=>import("./django-69ad0506.js").then(t=>t.d),["assets/django-69ad0506.js","assets/vendor-2890c4d6.js","assets/htmlmixed-fa256571.js","assets/xml-090b57e4.js","assets/javascript-a63629bd.js","assets/css-350a7ccd.js","assets/overlay-56747422.js"]);case"dockerfile":return Pe(()=>import("./dockerfile-2a6b8580.js").then(t=>t.d),["assets/dockerfile-2a6b8580.js","assets/vendor-2890c4d6.js"]);case"dtd":return Pe(()=>import("./dtd-b7b06dbd.js").then(t=>t.d),["assets/dtd-b7b06dbd.js","assets/vendor-2890c4d6.js"]);case"dylan":return Pe(()=>import("./dylan-f45e2edc.js").then(t=>t.d),["assets/dylan-f45e2edc.js","assets/vendor-2890c4d6.js"]);case"ebnf":return Pe(()=>import("./ebnf-48d06441.js").then(t=>t.e),["assets/ebnf-48d06441.js","assets/vendor-2890c4d6.js"]);case"ecl":return Pe(()=>import("./ecl-5fd57124.js").then(t=>t.e),["assets/ecl-5fd57124.js","assets/vendor-2890c4d6.js"]);case"eiffel":return Pe(()=>import("./eiffel-b0110893.js").then(t=>t.e),["assets/eiffel-b0110893.js","assets/vendor-2890c4d6.js"]);case"elm":return Pe(()=>import("./elm-66ca0dd2.js").then(t=>t.e),["assets/elm-66ca0dd2.js","assets/vendor-2890c4d6.js"]);case"htmlembedded":return Pe(()=>import("./htmlembedded-d3ba9457.js").then(t=>t.h),["assets/htmlembedded-d3ba9457.js","assets/vendor-2890c4d6.js","assets/htmlmixed-fa256571.js","assets/xml-090b57e4.js","assets/javascript-a63629bd.js","assets/css-350a7ccd.js","assets/multiplex-2357a410.js"]);case"erlang":return Pe(()=>import("./erlang-c75be33b.js").then(t=>t.e),["assets/erlang-c75be33b.js","assets/vendor-2890c4d6.js"]);case"factor":return Pe(()=>import("./factor-9f382449.js").then(t=>t.f),["assets/factor-9f382449.js","assets/vendor-2890c4d6.js"]);case"fcl":return Pe(()=>import("./fcl-74bb6d22.js").then(t=>t.f),["assets/fcl-74bb6d22.js","assets/vendor-2890c4d6.js"]);case"forth":return Pe(()=>import("./forth-af852275.js").then(t=>t.f),["assets/forth-af852275.js","assets/vendor-2890c4d6.js"]);case"fortran":return Pe(()=>import("./fortran-595eae1d.js").then(t=>t.f),["assets/fortran-595eae1d.js","assets/vendor-2890c4d6.js"]);case"mllike":return Pe(()=>import("./mllike-4ba65372.js").then(t=>t.m),["assets/mllike-4ba65372.js","assets/vendor-2890c4d6.js"]);case"gas":return Pe(()=>import("./gas-59470adb.js").then(t=>t.g),["assets/gas-59470adb.js","assets/vendor-2890c4d6.js"]);case"gherkin":return Pe(()=>import("./gherkin-14cd0a1f.js").then(t=>t.g),["assets/gherkin-14cd0a1f.js","assets/vendor-2890c4d6.js"]);case"gfm":return Pe(()=>import("./gfm-7d343873.js").then(t=>t.g),["assets/gfm-7d343873.js","assets/vendor-2890c4d6.js","assets/markdown-c970c476.js","assets/xml-090b57e4.js","assets/overlay-56747422.js"]);case"go":return Pe(()=>import("./go-173cb70e.js").then(t=>t.g),["assets/go-173cb70e.js","assets/vendor-2890c4d6.js"]);case"groovy":return Pe(()=>import("./groovy-926f872c.js").then(t=>t.g),["assets/groovy-926f872c.js","assets/vendor-2890c4d6.js"]);case"haml":return Pe(()=>import("./haml-5bbf2ecb.js").then(t=>t.h),["assets/haml-5bbf2ecb.js","assets/vendor-2890c4d6.js","assets/htmlmixed-fa256571.js","assets/xml-090b57e4.js","assets/javascript-a63629bd.js","assets/css-350a7ccd.js","assets/ruby-9d2245eb.js"]);case"haskell":return Pe(()=>import("./haskell-5ae5aa83.js").then(t=>t.h),["assets/haskell-5ae5aa83.js","assets/vendor-2890c4d6.js"]);case"haskell-literate":return Pe(()=>import("./haskell-literate-38fd1d63.js").then(t=>t.h),["assets/haskell-literate-38fd1d63.js","assets/vendor-2890c4d6.js","assets/haskell-5ae5aa83.js"]);case"haxe":return Pe(()=>import("./haxe-19024bc3.js").then(t=>t.h),["assets/haxe-19024bc3.js","assets/vendor-2890c4d6.js"]);case"htmlmixed":return Pe(()=>import("./htmlmixed-d47277ae.js").then(t=>t.h),["assets/htmlmixed-d47277ae.js","assets/vendor-2890c4d6.js","assets/htmlmixed-fa256571.js","assets/xml-090b57e4.js","assets/javascript-a63629bd.js","assets/css-350a7ccd.js"]);case"http":return Pe(()=>import("./http-9a4ce11d.js").then(t=>t.h),["assets/http-9a4ce11d.js","assets/vendor-2890c4d6.js"]);case"idl":return Pe(()=>import("./idl-e934d006.js").then(t=>t.i),["assets/idl-e934d006.js","assets/vendor-2890c4d6.js"]);case"pug":return Pe(()=>import("./pug-8088ab3e.js").then(t=>t.p),["assets/pug-8088ab3e.js","assets/vendor-2890c4d6.js","assets/javascript-a63629bd.js","assets/css-350a7ccd.js","assets/htmlmixed-fa256571.js","assets/xml-090b57e4.js"]);case"javascript":return Pe(()=>import("./javascript-3e53184e.js").then(t=>t.j),["assets/javascript-3e53184e.js","assets/vendor-2890c4d6.js","assets/javascript-a63629bd.js"]);case"jsx":return Pe(()=>import("./jsx-b5e8848c.js").then(t=>t.j),["assets/jsx-b5e8848c.js","assets/vendor-2890c4d6.js","assets/xml-090b57e4.js","assets/javascript-a63629bd.js"]);case"jinja2":return Pe(()=>import("./jinja2-e3df2abb.js").then(t=>t.j),["assets/jinja2-e3df2abb.js","assets/vendor-2890c4d6.js"]);case"julia":return Pe(()=>import("./julia-d9dba304.js").then(t=>t.j),["assets/julia-d9dba304.js","assets/vendor-2890c4d6.js"]);case"livescript":return Pe(()=>import("./livescript-40744629.js").then(t=>t.l),["assets/livescript-40744629.js","assets/vendor-2890c4d6.js"]);case"lua":return Pe(()=>import("./lua-c3aa683c.js").then(t=>t.l),["assets/lua-c3aa683c.js","assets/vendor-2890c4d6.js"]);case"markdown":return Pe(()=>import("./markdown-d4dc3429.js").then(t=>t.m),["assets/markdown-d4dc3429.js","assets/vendor-2890c4d6.js","assets/markdown-c970c476.js","assets/xml-090b57e4.js"]);case"mirc":return Pe(()=>import("./mirc-ce2816aa.js").then(t=>t.m),["assets/mirc-ce2816aa.js","assets/vendor-2890c4d6.js"]);case"mathematica":return Pe(()=>import("./mathematica-a5f196cd.js").then(t=>t.m),["assets/mathematica-a5f196cd.js","assets/vendor-2890c4d6.js"]);case"modelica":return Pe(()=>import("./modelica-e9686bc6.js").then(t=>t.m),["assets/modelica-e9686bc6.js","assets/vendor-2890c4d6.js"]);case"mumps":return Pe(()=>import("./mumps-0224bc8e.js").then(t=>t.m),["assets/mumps-0224bc8e.js","assets/vendor-2890c4d6.js"]);case"mbox":return Pe(()=>import("./mbox-fc899323.js").then(t=>t.m),["assets/mbox-fc899323.js","assets/vendor-2890c4d6.js"]);case"nginx":return Pe(()=>import("./nginx-b5d8ca1a.js").then(t=>t.n),["assets/nginx-b5d8ca1a.js","assets/vendor-2890c4d6.js"]);case"nsis":return Pe(()=>import("./nsis-2d7ebfc5.js").then(t=>t.n),["assets/nsis-2d7ebfc5.js","assets/vendor-2890c4d6.js"]);case"ntriples":return Pe(()=>import("./ntriples-7ad588c5.js").then(t=>t.n),["assets/ntriples-7ad588c5.js","assets/vendor-2890c4d6.js"]);case"octave":return Pe(()=>import("./octave-b74585ca.js").then(t=>t.o),["assets/octave-b74585ca.js","assets/vendor-2890c4d6.js"]);case"oz":return Pe(()=>import("./oz-7cf7e550.js").then(t=>t.o),["assets/oz-7cf7e550.js","assets/vendor-2890c4d6.js"]);case"pascal":return Pe(()=>import("./pascal-425e9251.js").then(t=>t.p),["assets/pascal-425e9251.js","assets/vendor-2890c4d6.js"]);case"pegjs":return Pe(()=>import("./pegjs-a2757dc4.js").then(t=>t.p),["assets/pegjs-a2757dc4.js","assets/vendor-2890c4d6.js","assets/javascript-a63629bd.js"]);case"perl":return Pe(()=>import("./perl-7e671243.js").then(t=>t.p),["assets/perl-7e671243.js","assets/vendor-2890c4d6.js"]);case"php":return Pe(()=>import("./php-4776b04e.js").then(t=>t.p),["assets/php-4776b04e.js","assets/vendor-2890c4d6.js","assets/htmlmixed-fa256571.js","assets/xml-090b57e4.js","assets/javascript-a63629bd.js","assets/css-350a7ccd.js","assets/clike-4a4575d2.js"]);case"pig":return Pe(()=>import("./pig-b7eaca7c.js").then(t=>t.p),["assets/pig-b7eaca7c.js","assets/vendor-2890c4d6.js"]);case"null":return;case"powershell":return Pe(()=>import("./powershell-b656693e.js").then(t=>t.p),["assets/powershell-b656693e.js","assets/vendor-2890c4d6.js"]);case"ini":case"properties":return Pe(()=>import("./properties-55c2f501.js").then(t=>t.p),["assets/properties-55c2f501.js","assets/vendor-2890c4d6.js"]);case"protobuf":return Pe(()=>import("./protobuf-797d5243.js").then(t=>t.p),["assets/protobuf-797d5243.js","assets/vendor-2890c4d6.js"]);case"puppet":return Pe(()=>import("./puppet-b2df1a46.js").then(t=>t.p),["assets/puppet-b2df1a46.js","assets/vendor-2890c4d6.js"]);case"q":return Pe(()=>import("./q-7bf66586.js").then(t=>t.q),["assets/q-7bf66586.js","assets/vendor-2890c4d6.js"]);case"r":return Pe(()=>import("./r-0fa8b602.js").then(t=>t.r),["assets/r-0fa8b602.js","assets/vendor-2890c4d6.js"]);case"rst":return Pe(()=>import("./rst-78bb0346.js").then(t=>t.r),["assets/rst-78bb0346.js","assets/vendor-2890c4d6.js","assets/python-bfc673c3.js","assets/stex-1409a844.js","assets/overlay-56747422.js"]);case"rpm":return Pe(()=>import("./rpm-37726f23.js").then(t=>t.r),["assets/rpm-37726f23.js","assets/vendor-2890c4d6.js"]);case"ruby":return Pe(()=>import("./ruby-a03f0328.js").then(t=>t.r),["assets/ruby-a03f0328.js","assets/vendor-2890c4d6.js","assets/ruby-9d2245eb.js"]);case"rust":return Pe(()=>import("./rust-b7503ea6.js").then(t=>t.r),["assets/rust-b7503ea6.js","assets/vendor-2890c4d6.js"]);case"sas":return Pe(()=>import("./sas-8eda0cc3.js").then(t=>t.s),["assets/sas-8eda0cc3.js","assets/vendor-2890c4d6.js"]);case"sass":return Pe(()=>import("./sass-3e039d89.js").then(t=>t.s),["assets/sass-3e039d89.js","assets/vendor-2890c4d6.js","assets/css-350a7ccd.js"]);case"scheme":return Pe(()=>import("./scheme-f6db0328.js").then(t=>t.s),["assets/scheme-f6db0328.js","assets/vendor-2890c4d6.js"]);case"shell":return Pe(()=>import("./shell-1b79c516.js").then(t=>t.s),["assets/shell-1b79c516.js","assets/vendor-2890c4d6.js"]);case"sieve":return Pe(()=>import("./sieve-6137ee1f.js").then(t=>t.s),["assets/sieve-6137ee1f.js","assets/vendor-2890c4d6.js"]);case"slim":return Pe(()=>import("./slim-0af97129.js").then(t=>t.s),["assets/slim-0af97129.js","assets/vendor-2890c4d6.js","assets/htmlmixed-fa256571.js","assets/xml-090b57e4.js","assets/javascript-a63629bd.js","assets/css-350a7ccd.js","assets/ruby-9d2245eb.js"]);case"smalltalk":return Pe(()=>import("./smalltalk-f57289eb.js").then(t=>t.s),["assets/smalltalk-f57289eb.js","assets/vendor-2890c4d6.js"]);case"smarty":return Pe(()=>import("./smarty-ed3c1901.js").then(t=>t.s),["assets/smarty-ed3c1901.js","assets/vendor-2890c4d6.js"]);case"solr":return Pe(()=>import("./solr-aed1a6ee.js").then(t=>t.s),["assets/solr-aed1a6ee.js","assets/vendor-2890c4d6.js"]);case"soy":return Pe(()=>import("./soy-09356fc3.js").then(t=>t.s),["assets/soy-09356fc3.js","assets/vendor-2890c4d6.js","assets/htmlmixed-fa256571.js","assets/xml-090b57e4.js","assets/javascript-a63629bd.js","assets/css-350a7ccd.js"]);case"sparql":return Pe(()=>import("./sparql-fe146f0b.js").then(t=>t.s),["assets/sparql-fe146f0b.js","assets/vendor-2890c4d6.js"]);case"spreadsheet":return Pe(()=>import("./spreadsheet-aedc1d2a.js").then(t=>t.s),["assets/spreadsheet-aedc1d2a.js","assets/vendor-2890c4d6.js"]);case"stylus":return Pe(()=>import("./stylus-8b7dc2e4.js").then(t=>t.s),["assets/stylus-8b7dc2e4.js","assets/vendor-2890c4d6.js"]);case"swift":return Pe(()=>import("./swift-3b8788ee.js").then(t=>t.s),["assets/swift-3b8788ee.js","assets/vendor-2890c4d6.js"]);case"stex":return Pe(()=>import("./stex-b2f6a895.js").then(t=>t.s),["assets/stex-b2f6a895.js","assets/vendor-2890c4d6.js","assets/stex-1409a844.js"]);case"verilog":return Pe(()=>import("./verilog-3ba4ad08.js").then(t=>t.v),["assets/verilog-3ba4ad08.js","assets/vendor-2890c4d6.js"]);case"tcl":return Pe(()=>import("./tcl-fc121d71.js").then(t=>t.t),["assets/tcl-fc121d71.js","assets/vendor-2890c4d6.js"]);case"textile":return Pe(()=>import("./textile-7eda4d77.js").then(t=>t.t),["assets/textile-7eda4d77.js","assets/vendor-2890c4d6.js"]);case"tiddlywiki":return Pe(()=>import("./tiddlywiki-201d29d8.js").then(t=>t.t),["assets/tiddlywiki-201d29d8.js","assets/vendor-2890c4d6.js"]);case"tiki":return Pe(()=>import("./tiki-5c8ecd2e.js").then(t=>t.t),["assets/tiki-5c8ecd2e.js","assets/vendor-2890c4d6.js"]);case"toml":return Pe(()=>import("./toml-69be3c2b.js").then(t=>t.t),["assets/toml-69be3c2b.js","assets/vendor-2890c4d6.js"]);case"tornado":return Pe(()=>import("./tornado-bd7e69f5.js").then(t=>t.t),["assets/tornado-bd7e69f5.js","assets/vendor-2890c4d6.js","assets/htmlmixed-fa256571.js","assets/xml-090b57e4.js","assets/javascript-a63629bd.js","assets/css-350a7ccd.js","assets/overlay-56747422.js"]);case"troff":return Pe(()=>import("./troff-9ebc2e13.js").then(t=>t.t),["assets/troff-9ebc2e13.js","assets/vendor-2890c4d6.js"]);case"ttcn":return Pe(()=>import("./ttcn-a652b4be.js").then(t=>t.t),["assets/ttcn-a652b4be.js","assets/vendor-2890c4d6.js"]);case"ttcn-cfg":return Pe(()=>import("./ttcn-cfg-0dc2137c.js").then(t=>t.t),["assets/ttcn-cfg-0dc2137c.js","assets/vendor-2890c4d6.js"]);case"turtle":return Pe(()=>import("./turtle-dbfae442.js").then(t=>t.t),["assets/turtle-dbfae442.js","assets/vendor-2890c4d6.js"]);case"twig":return Pe(()=>import("./twig-3f9974ab.js").then(t=>t.t),["assets/twig-3f9974ab.js","assets/vendor-2890c4d6.js","assets/multiplex-2357a410.js"]);case"webidl":return Pe(()=>import("./webidl-bfd8fbd6.js").then(t=>t.w),["assets/webidl-bfd8fbd6.js","assets/vendor-2890c4d6.js"]);case"vb":return Pe(()=>import("./vb-bf164774.js").then(t=>t.v),["assets/vb-bf164774.js","assets/vendor-2890c4d6.js"]);case"vbscript":return Pe(()=>import("./vbscript-77998f4d.js").then(t=>t.v),["assets/vbscript-77998f4d.js","assets/vendor-2890c4d6.js"]);case"velocity":return Pe(()=>import("./velocity-d6e742c6.js").then(t=>t.v),["assets/velocity-d6e742c6.js","assets/vendor-2890c4d6.js"]);case"vhdl":return Pe(()=>import("./vhdl-b32d1c21.js").then(t=>t.v),["assets/vhdl-b32d1c21.js","assets/vendor-2890c4d6.js"]);case"vue":return Pe(()=>import("./vue-34f65b72.js").then(t=>t.v),["assets/vue-34f65b72.js","assets/vendor-2890c4d6.js","assets/overlay-56747422.js","assets/xml-090b57e4.js","assets/javascript-a63629bd.js","assets/coffeescript-b11bbe9b.js","assets/css-350a7ccd.js","assets/sass-3e039d89.js","assets/stylus-8b7dc2e4.js","assets/pug-8088ab3e.js","assets/htmlmixed-fa256571.js","assets/multiplex-2357a410.js"]);case"xml":return Pe(()=>import("./xml-fc3f6127.js").then(t=>t.x),["assets/xml-fc3f6127.js","assets/vendor-2890c4d6.js","assets/xml-090b57e4.js"]);case"xquery":return Pe(()=>import("./xquery-b303cd2c.js").then(t=>t.x),["assets/xquery-b303cd2c.js","assets/vendor-2890c4d6.js"]);case"yacas":return Pe(()=>import("./yacas-49f61f86.js").then(t=>t.y),["assets/yacas-49f61f86.js","assets/vendor-2890c4d6.js"]);case"yaml":return Pe(()=>import("./yaml-be062af2.js").then(t=>t.y),["assets/yaml-be062af2.js","assets/vendor-2890c4d6.js"]);case"z80":return Pe(()=>import("./z80-ad1c0e97.js").then(t=>t.z),["assets/z80-ad1c0e97.js","assets/vendor-2890c4d6.js"]);case"mscgen":return Pe(()=>import("./mscgen-36f7f26f.js").then(t=>t.m),["assets/mscgen-36f7f26f.js","assets/vendor-2890c4d6.js"]);case"wast":return Pe(()=>import("./wast-87c6e73b.js").then(t=>t.w),["assets/wast-87c6e73b.js","assets/vendor-2890c4d6.js"]);case"makefile":return Pe(()=>import("./clojure-09e08a1d.js").then(t=>t.c),["assets/clojure-09e08a1d.js","assets/vendor-2890c4d6.js"]);case"mermaid":return Pe(()=>import("./ruby-a03f0328.js").then(t=>t.r),["assets/ruby-a03f0328.js","assets/vendor-2890c4d6.js","assets/ruby-9d2245eb.js"]);case"solidity":return Pe(()=>import("./solidity-22b66696.js"),["assets/solidity-22b66696.js","assets/vendor-2890c4d6.js"]);case"elixir":return Pe(()=>import("./elixir-ee87935f.js"),["assets/elixir-ee87935f.js","assets/vendor-2890c4d6.js"]);default:throw new Error}},Nue={path:e=>e,loadMode:(e,t)=>{Iue(e).then(t)}},qT=["C","C#","C++","Clojure","CMake","Closure Stylesheets (GSS)","CoffeeScript","Common Lisp","Crystal","CSS","D","Dart","Django","Dockerfile","diff","EBNF","Elm","Erlang","elixir","Fortran","F#","Gherkin","Go","Ini","Shell","Groovy","HAML","Haskell","Haxe","HTML","HTTP","Java","JavaScript","JSON","Julia","Kotlin","LESS","LiveScript","Lua","Markdown","Mathematica","Matlab","MakeFile","Mermaid","Nginx","NSIS","Objective-C","Objective-C++","OCaml","Pascal","Perl","PHP","Plain Text","PowerShell","Properties files","ProtoBuf","Puppet","Python","Q","R","RPM Spec","Ruby","Rust","React","SAS","Scala","Scheme","SCSS","Smalltalk","Stylus","SQL","Solidity","Swift","LaTeX","sTeX","Tcl","Toml","Twig","TypeScript","VB.NET","VBScript","Verilog","VHDL","Vue","XML","XQuery","YAML"];function rj(e){var s,a;const t=e.toLowerCase().trim();return(a=((s=Zi.modeInfo.filter(o=>qT.includes(o.name)).find(o=>{var i,l;return(l=(i=o.alias)==null?void 0:i.includes(t))!=null?l:!1}))==null?void 0:s.name)||qT.find(o=>o.toLocaleLowerCase()===t))!=null?a:mg()||Lm}const jue=e=>{switch(e){case"React":return Zi.findModeByExtension("tsx");case"TypeScript":return Zi.findModeByExtension("ts");case"Matlab":return Zi.findModeByName("octave");case"MakeFile":return{mime:void 0,mode:"makefile"};case"Mermaid":return{mime:void 0,mode:"ruby"};case"Solidity":return{mime:void 0,mode:"solidity"};case"Ini":return{mime:void 0,mode:"ini"};case"elixir":return{mime:void 0,mode:"elixir"};default:return Zi.findModeByName(e.toLocaleLowerCase())}},OA=e=>{const t=e.replace(/(.)\n!\[/g,"$1\n\n![");return pL().use(VW).use(mL).use($W).parse(t)},Sue=(e,t)=>{var i,l;let n=/StartFragment:\s*0+(\d+?)$/gm.exec(e),s=/EndFragment:\s*0+(\d+?)$/gm.exec(e);t&&(n=/StartHTML:\s*0+(\d+?)$/gm.exec(e),s=/EndHTML:\s*0+(\d+?)$/gm.exec(e));const a=Number((i=n==null?void 0:n[1])!=null?i:0),o=Number((l=s==null?void 0:s[1])!=null?l:e.length);return e.slice(a,o)},Due=e=>{const t=pL().use(zW).parse(Sue(e,!0));qW(t,s=>{s.type==="element"&&s.tagName==="content"&&(s.tagName="div")});const n=GW(t,s=>s.type!=="comment");if(n)return n},oRe=e=>{const t=Due(e);if(t)return HW(t)},Aue=new UW.Converter,iRe=e=>Aue.makeHtml(e),_C=(e,t)=>{var g;const n=OA(e),{spaceId:s="",pageId:a=""}=t!=null?t:{},o={},i={},l=[],c=(_,x,F={})=>{const b=qe(),w={uuid:b,type:_,spaceId:s,parentId:x,textColor:"",backgroundColor:F.backgroundColor||"",permissions:[],subNodes:[],data:F,status:m.BlockStatus.NORMAL,version:0};return o[b]=w,i[x]=(i[x]||[]).concat(b),b},d=(_,x,F=a,b)=>{if(_.type==="paragraph"&&((!b||!x)&&(x=c(m.BlockType.TEXTAREA,F)),_.children.forEach(w=>p(w,x))),_.type==="thematicBreak"&&c(m.BlockType.DIVIDER,F),_.type==="heading"&&(x=c(m.BlockType.HEADER,F,{level:_.depth}),_.children.forEach(w=>p(w,x))),_.type==="html")if(/^<aside>/.test(_.value)){const w=_.value.substring(8,10)||"";x=c(m.BlockType.MARK,F,{backgroundColor:Ze.grey,icon:{type:"emoji",value:w}}),OA(_.value.substring(10)).children.forEach(C=>d(C,x,F))}else c(m.BlockType.TEXTAREA,F,{segments:[{type:m.TextType.TEXT,text:_.value,enhancer:{}}]});if(_.type==="blockquote"){x=c(m.BlockType.QUOTE,F);const[w,...E]=_.children;w&&w.type==="paragraph"?(w.children.forEach(C=>p(C,x)),E.forEach(C=>d(C,x))):_.children.forEach(C=>d(C,x))}if(_.type==="list"&&_.children.forEach(w=>h(w,x||F,_.ordered)),_.type==="code"){const w=mg();c(m.BlockType.CODE,F,{format:{language:rj(_.lang||w||Lm)},segments:[{type:m.TextType.TEXT,text:_.value,enhancer:{}}]})}if(_.type==="table"&&!x){const E=_.children[0].children.map(()=>qe());x=c(m.BlockType.TABLE,F,{format:{tableBlockColumnOrder:E,tableBlockRowHeader:!0}}),_.children.forEach(C=>u(C,x,E))}_.type==="math"&&c(m.BlockType.EQUATION,F,{segments:[{type:m.TextType.TEXT,text:_.value,enhancer:{}}]})},u=(_,x,F)=>{const b=c(m.BlockType.TABLE_ROW,x);_.children.forEach((w,E)=>f(w,b,F[E]))},f=(_,x,F)=>{_.children.forEach(b=>p(b,x,void 0,void 0,F))},h=(_,x,F)=>{let b;F?b=c(m.BlockType.ORDER_LIST,x):_.checked===null?b=c(m.BlockType.LIST,x):b=c(m.BlockType.TODO,x,{checked:_.checked}),_.children.forEach((w,E)=>d(w,b,b,E===0))},p=(_,x,F={},b,w)=>{const E=o[x];if(!E)return;const C=T=>{if(T.text)if(w){const{collectionProperties:v}=E.data;v?v[w]=(v[w]||[]).concat(T):E.data.collectionProperties={[w]:[T]}}else E.data.segments=(E.data.segments||[]).concat(T)},k=()=>{if(w){const{collectionProperties:T}=E.data;if(T)return T[w]}else return E.data.segments};if(_.type==="text"){const T={type:m.TextType.TEXT,text:_.value,enhancer:F};b&&(T.type=m.TextType.URL,T.url=b),C(T)}if(_.type==="break"){const T=An(k());T!=null&&T.text&&(T.text+="\n")}if(_.type==="strong"&&_.children.forEach(T=>p(T,x,{...F,bold:!0},b,w)),_.type==="emphasis"&&_.children.forEach(T=>p(T,x,{...F,italic:!0},b,w)),_.type==="delete"&&_.children.forEach(T=>p(T,x,{...F,lineThrough:!0},b,w)),_.type==="inlineCode"){const T={type:m.TextType.TEXT,text:_.value,enhancer:{...F,code:!0}};b&&(T.type=m.TextType.URL,T.url=b),C(T)}if(_.type==="inlineMath"){const T={type:m.TextType.EQUATION,text:_.value,enhancer:F};C(T)}if(_.type==="link")if(_.children.length)_.children.forEach(T=>p(T,x,F,_.url,w));else{const T={type:m.TextType.URL,text:_.url,url:_.url,enhancer:F};C(T)}if(_.type==="html")if(_.value==="<br />"){const T=An(k());T!=null&&T.text&&(T.text+="\n")}else{const T={type:m.TextType.TEXT,text:_.value,enhancer:{}};C(T)}};Array.isArray(n.children)?n.children.forEach(_=>d(_)):d(n);for(const _ of Object.values(o))if(_.type===m.BlockType.TEXTAREA){const{segments:x}=_.data;if((x==null?void 0:x.length)===1){const[F]=x;if(F){const{type:b,text:w}=F;if(b===m.TextType.TEXT){const E=w.match(/^!\[(.*)\]\((.*)\)$/);E&&(_.type=m.BlockType.FILE,_.data={segments:ht(E[1]),size:0,extName:"png",display:"image"},l.push({parentId:_.parentId,blockId:_.uuid,url:(g=E[2])!=null?g:""}))}}}}return o};let MA=[];const Rue=e=>{var A,P,L,O,$,M,U,z,K,W,Y;const{str:t,allLine:n,pageId:s,scene:a,tempPageId:o,currentBlockId:i,mindNodeTypes:l,popper:c,isInRight:d,resultContainer:u,modalContainer:f,uploadFile:h,useCollection:p=!1,useMindMap:g=!1,isEndWrap:_,codeStartLineNum:x,editTypeRef:F}=e;if(!t)return;if(t==="\n"){const G=n.current.join("");if(G.trim().length===0){n.current=[""];return}if(G.endsWith("\n"))return}n.current.length===0?n.current.push(t):n.current[n.current.length-1]=((A=An(n.current))!=null?A:"")+t;let b=a===it.TextSelected||a===it.BlockSelected||a===it.TextSelectedAndWroteByAI||a===it.BlockSelectedAndWroteByAI;g&&F.current===we.ContinueWrite&&(b=!1);const w=b?o:s,E=(P=An(n.current))!=null?P:"",C=E.trimStart(),k=C.startsWith("|");if((C==="`"||C==="``")&&t!=="\n")return;const T=C.startsWith("```")&&!C.startsWith("```markdown");if(C==="!"&&t!=="\n")return;const v=C.startsWith("!["),I=J.blocks[i.current],j=(I==null?void 0:I.type)===m.BlockType.TABLE||p&&(I==null?void 0:I.type)===m.BlockType.COLLECTION_VIEW,S=(I==null?void 0:I.type)===m.BlockType.CODE;j&&(!k||k&&_)&&(I==null?void 0:I.type)===m.BlockType.COLLECTION_VIEW&&Promise.resolve().then(()=>{vue(I.uuid,[...n.current],b)});const D=()=>{Pue({popper:c,isInRight:d,isShowInTempPage:b,resultContainer:u,editContainerRef:f,currentBlockId:i,useMindMap:g})};if(t==="\n"){if(x.current!==cC){if(n.current.length-1===x.current){const ee=_C(E),te=(L=Object.values(ee)[0])==null?void 0:L.data.format;te&&_e(i.current,{data:{format:te,isByAI:!0}},b),n.current.push("");return}if(T&&n.current.length-1!==x.current){n.current.push(""),x.current=cC,!b&&UA(a,i),i.current=ut({type:m.BlockType.TEXTAREA,data:{segments:[],isByAI:!0}},{parentId:w,after:i.current},b);return}let G="";for(let ee=n.current.length-1;ee>x.current;ee--)G=((O=n.current[ee])!=null?O:"")+G;_e(i.current,{data:{segments:[{text:G,type:m.TextType.TEXT,enhancer:{}}],isByAI:!0}},b),D(),n.current.push("");return}if(k){if(j){const G=E.split("|").filter(Q=>!!Q.trim()).map(Q=>Q.trim()),ee=p?MA:(M=I==null?void 0:I.data.format)==null?void 0:M.tableBlockColumnOrder;if(!ee)return;const te={};ee.forEach((Q,ne)=>{var se;p&&ne===0||(te[Q]=[{text:(se=G[ne])!=null?se:"",type:m.TextType.TEXT,enhancer:{}}])}),p?ut({type:m.BlockType.PAGE,data:{collectionProperties:te,segments:ht(G[0]),isByAI:!0}},{parentId:i.current,last:!0},b):ut({type:m.BlockType.TABLE_ROW,data:{collectionProperties:te,pageFixedWidth:!0,format:{},isByAI:!0}},{parentId:i.current,last:!0},b),D()}else{const G=n.current[n.current.length-2];if(G&&G.trimStart().startsWith("|")){const ee=_C("".concat(G).concat(E)),te=Object.values(ee);let Q,ne;if(te.forEach(se=>{se.type===m.BlockType.TABLE?Q=se:ne=se}),Q){if(p){const{tableBlockColumnOrder:se,tableBlockRowHeader:ce}=($=Q==null?void 0:Q.data.format)!=null?$:{};if(!se)return;MA=se;const ae=ne;if(!ae)return;const de={},ke=[];se.forEach((Te,he)=>{var ge;let Ee="";if(ce){const Se=(ge=ae.data.collectionProperties)==null?void 0:ge[Te];Ee=fe(Se)}he===0?de.title={name:Ee||"标题",type:m.CollectionSchemaType.TITLE}:de[Te]={name:Ci(de,Ee||void 0),type:m.CollectionSchemaType.TEXT},ke.push({property:he===0?"title":Te,visible:!0})}),Io({title:"默认视图",format:{tableProperties:ke,tableWrap:!0},pageSort:[],type:m.CollectionViewType.TABLE},{parentId:i.current},b),_e(i.current,{type:m.BlockType.COLLECTION_VIEW,data:{schema:de,isByAI:!0}},b)}else _e(i.current,{type:m.BlockType.TABLE,data:{...Q.data,isByAI:!0}},b),ne&&ut({type:m.BlockType.TABLE_ROW,data:{...ne.data,isByAI:!0}},{parentId:i.current,first:!0},b);D()}}}n.current.push("");return}if(v){const G=(z=(U=E.match(new RegExp("(?<=\\]\\()https?:\\/\\/.*(?=\\))")))==null?void 0:U[0])!=null?z:"";if(G){_e(i.current,{type:m.BlockType.FILE,data:{segments:[],display:"image"}},b);const ee=i.current;fetch(G).then(te=>te.blob().then(Q=>{const ne=hue(G);VA(h,ee,ne,Q,D,b)}),()=>{aB(G).then(te=>{te&&VA(h,ee,te.fileName,te.blob,D,b)}).catch(te=>{console.log(te)})})}else _e(i.current,{data:{segments:[{type:m.TextType.TEXT,enhancer:{},text:E}],isByAI:!0}},b);i.current=ut({type:m.BlockType.TEXTAREA,data:{segments:[],isByAI:!0}},{parentId:w,after:i.current},b),D(),n.current.push("");return}if(n.current.push(""),!b&&UA(a,i,g),g){i.current=ut({type:m.BlockType.TEXTAREA,hidden:!0,data:{segments:[],isByAI:!0}},{parentId:i.current,last:!0},b);return}i.current=ut({type:m.BlockType.TEXTAREA,data:{segments:[],isByAI:!0}},{parentId:w,after:i.current},b)}else{if(x.current!==cC||k)return;if(j&&!k){T&&(x.current=n.current.length-1),i.current=ut({type:T?m.BlockType.CODE:m.BlockType.TEXTAREA,data:{segments:[{text:T?"":t,type:m.TextType.TEXT,enhancer:{}}],isByAI:!0}},{parentId:w,after:i.current},b);return}if(T){x.current=n.current.length-1,S||_e(i.current,{type:m.BlockType.CODE,data:{segments:[{text:"",type:m.TextType.TEXT,enhancer:{}}],isByAI:!0,format:{language:(K=mg())!=null?K:Lm}}},b);return}if(v)return;let G=E;const ee=E.startsWith("    ");ee&&(G=E.trimStart());const te=ne=>{var de,ke,Te,he,Ee,ge;if(ne.data.level===1)return;const se=l.current.findIndex(Se=>Se===U_(ne)),ce=J.blocks[i.current];let ae=i.current;if(ce!=null&&ce.hidden&&!ir(ce.type)&&(ae=ce.parentId),!ae){console.error("lastBlockId is not found");return}if(se===-1)il([i.current],{parentId:ae,ignoreOp:b}),l.current.push(U_(ne));else if(se===l.current.length-1)il([i.current],{parentId:(ke=(de=J.blocks[ae])==null?void 0:de.parentId)!=null?ke:"",after:ae,ignoreOp:b});else{const Se=l.current.length-1;l.current=l.current.slice(0,se+1);let Re=Se-se;Re===0&&console.error("有错误！！");let Ae=ae,Me=(Te=J.blocks[ae])==null?void 0:Te.parentId;for(;Re>0;){const tt=J.blocks[Me!=null?Me:""];Me=tt==null?void 0:tt.parentId,Re--}const Ge=J.blocks[Me!=null?Me:""];Ae=(he=Ge==null?void 0:Ge.subNodes[(Ge==null?void 0:Ge.subNodes.length)-1])!=null?he:"",il([i.current],{parentId:(ge=(Ee=J.blocks[Ae])==null?void 0:Ee.parentId)!=null?ge:"",after:Ae,ignoreOp:b})}},Q=_C(G);if(Q){const ne=Object.values(Q)[0];ne&&(ir((W=J.blocks[i.current])==null?void 0:W.type)||g&&l.current.length===0?(_e(i.current,{type:m.BlockType.MIND_MAPPING,data:{...ne.data,isByAI:!0}},b),l.current.push(U_(ne))):(g&&te(ne),_e(i.current,{hidden:!1,type:ne.type,data:{...ne.data,isByAI:!0,segments:ee?[{text:new Array(E.length-G.length).fill(" ").join(""),type:m.TextType.TEXT,enhancer:{}},...(Y=ne.data.segments)!=null?Y:[]]:ne.data.segments}},!0)))}}D()},UA=(e,t,n)=>{(e===it.PageEmpty||e===it.PageHasContent||e===it.PageContentWroteByAI||n)&&hn(()=>{const s=J.blocks[t.current];s&&_e(t.current,{type:s.type,data:{...s.data,isByAI:!0}})})},VA=(e,t,n,s,a,o)=>{const i=new File([s],n);e({key:t,userId:yt.uuid,spaceId:Ot(),file:i,type:"file",onComplete:async l=>{if(l.success){const c=await g1(i),{ossName:d}=l;_e(t,{type:m.BlockType.FILE,data:{ossName:d,...c,segments:ht(n),size:s.size,isByAI:!0}},o),a==null||a()}}})},Pue=e=>{const{isInRight:t,isShowInTempPage:n,resultContainer:s,editContainerRef:a,currentBlockId:o,popper:i,useMindMap:l}=e;setTimeout(()=>{var b;if(n){const w=s.current;if(!w)return;w.clientHeight>window.innerHeight*.38?w.style.paddingBottom="200px":w.style.paddingBottom="0",w.scrollHeight-w.scrollTop-200>w.clientHeight&&(w.scrollTop=w.scrollTop+w.clientHeight/2);return}const c=i==null?void 0:i.current;if(!c)return;let d=o.current;l&&(d=(b=ks(o.current))!=null?b:"");const u=bn('[data-block-id="'.concat(d,'"]'),t);if(!u)return;c.state.elements.reference!==u&&(c.state.elements.reference=u);const f=a.current,h=bn(".next-space-page",t);if(!f||!h)return;const{reference:p}=c.state.elements;if(!p)return;const g=f.clientHeight+10,_=p.getBoundingClientRect(),x=h.getBoundingClientRect(),F=_.bottom-x.top;if(h.clientHeight-F<g){const E=F+h.scrollTop-(h.clientHeight-g);h.scrollTo(0,E+h.clientHeight/2)}c.update()})},xC={[we.CPlus]:"Rewriting",[we.Java]:"Rewriting",[we.JavaScript]:"Rewriting",[we.TypeScript]:"Rewriting",[we.Python]:"Rewriting",[we.OtherCodeLanguage]:"Rewriting",[we.Comment]:"commenting",[we.BugFix]:"bugFixer",[we.Professional]:"changeTone",[we.Casual]:"changeTone",[we.Straightforward]:"changeTone",[we.Confident]:"changeTone",[we.Friendly]:"changeTone",[we.Longer]:"longer",[we.Simpler]:"shorter",[we.Improve]:"improve",[we.Chinese]:"translate",[we.ClassicalChinese]:"translate",[we.English]:"translate",[we.Korean]:"translate",[we.Japanese]:"translate",[we.French]:"translate",[we.German]:"translate",[we.OtherLanguage]:"translate",[we.Summary]:"summary",[we.Summarize]:"summarize",[we.ContinueWrite]:"continue",[we.Blog]:"blog",[we.Brainstorm]:"brainstorm",[we.Outline]:"outline",[we.Story]:"story",[we.DailyNotes]:"daily",[we.ProsAndConsList]:"prosConsList",[we.ActionItems]:"findActionItems",[we.Explain]:"explain"},Lue=()=>tK(nK(sK,{activationConstraint:{distance:3}})),br=({items:e,renderItemContent:t,onChange:n,onlyHandleDraggable:s=!1,disabled:a=!1,onDragStart:o,onDragEnd:i,modifiers:l=[H1,e3],strategy:c=JW,className:d,appendChild:u,beforeAppendChild:f,listRef:h,isHorizontalAxis:p,virtual:g,appendTo:_=document.body,customRenderItems:x})=>{var k;const F=y.useRef(null),[b,w]=y.useState(void 0),E=Lue(),C=T=>{F.current=T,h&&(h.current=T)};return r.jsxs(WW,{modifiers:l,sensors:E,collisionDetection:KW,onDragEnd:T=>{i==null||i(T),w(void 0);const{active:v,over:I}=T;if(I&&v.id!==I.id){const j=e.findIndex(A=>A.id===v.id),S=e.findIndex(A=>A.id===I.id),D=Wu(e,j,S);n==null||n(D,T)}},onDragStart:T=>{o==null||o(T);const v=e.find(I=>I.id===T.active.id);w(v)},children:[r.jsxs("div",{className:d,ref:C,children:[f,r.jsx(YW,{items:e,strategy:c,children:x?x():g?r.jsx(XW,{height:Es(e.length*32,0,400),itemCount:e.length,className:"w-full",overscanCount:5,itemSize:32,stickyIndices:b?[e.indexOf(b)]:void 0,renderItem:({index:T,style:v})=>{const I=e[T];return I?r.jsx(iF,{renderItemContent:t,item:I,wrapperStyle:v,disabled:a,onlyHandleDraggable:s},I.id):null}}):r.jsx(r.Fragment,{children:e.map(T=>r.jsx(iF,{renderItemContent:t,item:T,disabled:a,onlyHandleDraggable:s},T.id))})}),u]}),Ls.createPortal(r.jsx(QW,{dropAnimation:null,className:"!z-[8848]",children:b&&r.jsx(Bue,{height:p?(k=F.current)==null?void 0:k.clientHeight:void 0,renderItemContent:t,item:b})}),_)]})},Bue=({item:e,height:t,renderItemContent:n})=>{const s=a=>{var o;return r.jsx("div",{className:a.className,children:r.jsx(V,{name:"IcMenu",size:(o=a.size)!=null?o:"normal"})})};return r.jsx("div",{className:"opacity-[0.9]",style:{height:t},children:n({item:e,isPreview:!0,renderDragHandle:s})})},iF=({item:e,renderItemContent:t,onlyHandleDraggable:n,disabled:s,wrapperStyle:a})=>{const{listeners:o,setNodeRef:i,transform:l,transition:c,active:d,isDragging:u}=ZW({id:e.id,disabled:s}),f={...a,transform:eK.Transform.toString(l),transition:d?c:void 0,opacity:u?0:1},h=p=>r.jsx("div",{...o,onClick:g=>{var _;return(_=p.onClick)==null?void 0:_.call(p,g)},onPointerDownCapture:p.onPointerDownCapture,className:R(p.className,u?"cursor-[grabbing]":"cursor-[grab]"),children:r.jsx(Fe,{popup:p.popup,children:r.jsx(V,{name:"IcMenu",size:"normal"})})});return r.jsx("div",{...n?{}:o,ref:i,style:f,children:t({item:e,isPreview:!1,renderDragHandle:h,listeners:o,active:d,isDragging:u})})},Oue={"9aab88e9-ba1b-4201-a9f3-483e814493db":{icon:"IcEdit",name:"继续写作",id:"9aab88e9-ba1b-4201-a9f3-483e814493db",type:"ContinueWrite",minimax:"我需要你延续这段内容继续写作，生成有逻辑性和连贯性的文本内容，每次续写内容不要过长。"},"7aec37fa-f6be-4b6e-a870-6a54b430131a":{icon:"IcSummarize",name:"总结",id:"7aec37fa-f6be-4b6e-a870-6a54b430131a",type:"Summarize",minimax:"总结文章内容。"},"c0e29509-ca71-4bc0-9a96-fa338a2b05ce":{icon:"IcAbstract",name:"摘要",id:"c0e29509-ca71-4bc0-9a96-fa338a2b05ce",type:"keySummary",minimax:"归纳文章内容，用列表列出重点摘要。"},"5e936d14-2331-468b-af24-31433992451d":{icon:"IcQuestion",name:"解释",id:"5e936d14-2331-468b-af24-31433992451d",type:"explain",minimax:"解释文章内容。"},"5e936d14-2331-468b-af24-31433994451d":{icon:"IcTranslate",name:"翻译",id:"5e936d14-2331-468b-af24-31433994451d",subNodes:["3a36576b-1b95-42c5-b70a-5c36fc9e145d","fb5a9fbd-c969-4bf4-baee-a0d0af4cb880","8846070a-7630-42a0-9042-290ab143d389","6ecd1645-fadb-4f56-bec5-cb1877d16330","069f3964-62a0-4094-96f9-b993dae8cc47","9151b1e0-e57f-45fa-b4b2-3942ed8437e3","459fee87-5cfc-4166-8b49-4060d4c27e2f","459fee87-5cfc-4166-8b49-4060d4c27e22"]},"3a36576b-1b95-42c5-b70a-5c36fc9e145d":{name:"中文（简体）",id:"3a36576b-1b95-42c5-b70a-5c36fc9e145d",type:"simplified chinese",minimax:"将这段单词或内容翻译成简体中文，保留原文 markdown 格式。只需要返回翻译结果，不返回与原文无关内容。"},"fb5a9fbd-c969-4bf4-baee-a0d0af4cb880":{name:"中文（文言文）",id:"fb5a9fbd-c969-4bf4-baee-a0d0af4cb880",type:"classical chinese",minimax:"将这段单词或内容翻译成文言文，保留原文 markdown 格式。只需要返回翻译结果，不返回与原文无关内容。"},"8846070a-7630-42a0-9042-290ab143d389":{name:"英语",id:"8846070a-7630-42a0-9042-290ab143d389",type:"english",minimax:"将这段单词或内容翻译成英语，保留原文 markdown 格式。只需要返回翻译结果，不返回与原文无关内容。"},"6ecd1645-fadb-4f56-bec5-cb1877d16330":{name:"韩语",id:"6ecd1645-fadb-4f56-bec5-cb1877d16330",type:"korean",minimax:"将这段单词或内容翻译成韩语，保留原文 markdown 格式。只需要返回翻译结果，不返回与原文无关内容。"},"069f3964-62a0-4094-96f9-b993dae8cc47":{name:"日语",id:"069f3964-62a0-4094-96f9-b993dae8cc47",type:"japanese",minimax:"将这段单词或内容翻译成日语，保留原文 markdown 格式。只需要返回翻译结果，不返回与原文无关内容。"},"9151b1e0-e57f-45fa-b4b2-3942ed8437e3":{name:"法语",id:"9151b1e0-e57f-45fa-b4b2-3942ed8437e3",type:"french",minimax:"将这段单词或内容翻译成法语，保留原文 markdown 格式。只需要返回翻译结果，不返回与原文无关内容。"},"459fee87-5cfc-4166-8b49-4060d4c27e2f":{name:"德语",id:"459fee87-5cfc-4166-8b49-4060d4c27e2f",type:"german",minimax:"将这段单词或内容翻译成德语，保留原文 markdown 格式。只需要返回翻译结果，不返回与原文无关内容。"},"459fee87-5cfc-4166-8b49-4060d4c27e22":{name:"翻译成",id:"459fee87-5cfc-4166-8b49-4060d4c27e22",type:"OtherLanguage",minimax:"将这段单词或内容翻译成{language}，保留原文 markdown 格式。只需要返回翻译结果，不返回与原文无关内容。"},"7edcb487-2041-4ade-8483-71b9e1caba35":{icon:"IcChangeWriting",name:"改进写作",id:"7edcb487-2041-4ade-8483-71b9e1caba35",type:"Improve",minimax:"改写这段内容，纠正错别字和语法错误，保留原文 markdown 格式。"},"1a8812df-9395-4eed-84be-59b5e148e7c1":{icon:"IcSimpler",name:"更简短",id:"1a8812df-9395-4eed-84be-59b5e148e7c1",type:"makeShorter",minimax:"改写这段内容，纠正错别字和语法错误，用更简短的方式润色，保留原文 markdown 格式。"},"63c58833-d02c-4a15-8039-949c78bcc9f2":{icon:"IcMoreDetail",name:"更详细",id:"63c58833-d02c-4a15-8039-949c78bcc9f2",type:"makeLonger",minimax:"改写这段内容，纠正错别字和语法错误，用更详细的方式润色，不改变原文含义，保留原文 markdown 格式。"},"7613737d-eb65-4464-a596-167d1e3f0c00":{icon:"IcAiStyle",name:"切换风格",id:"7613737d-eb65-4464-a596-167d1e3f0c00",subNodes:["32faf939-cb35-479f-95e8-3a234791a75d","68dc99f8-ebda-440e-bd9d-b1d431b24e0a","f57e6b90-d5c3-453a-87ab-e6ed9d2c175f","06d15689-21c4-446d-89b0-fa5cc33c3d96","6a8e29b8-e6ee-4af1-87da-212f01b7925a"]},"32faf939-cb35-479f-95e8-3a234791a75d":{name:"更专业",id:"32faf939-cb35-479f-95e8-3a234791a75d",type:"professional",minimax:"用更专业的方式，改写这段内容，保留原文 markdown 格式。"},"68dc99f8-ebda-440e-bd9d-b1d431b24e0a":{name:"非正式",id:"68dc99f8-ebda-440e-bd9d-b1d431b24e0a",type:"casual",minimax:"用非正式的方式，改写这段内容，保留原文 markdown 格式。"},"f57e6b90-d5c3-453a-87ab-e6ed9d2c175f":{name:"更直接",id:"f57e6b90-d5c3-453a-87ab-e6ed9d2c175f",type:"straightforward",minimax:"用简明扼要的方式，改写这段内容，保留原文 markdown 格式。"},"06d15689-21c4-446d-89b0-fa5cc33c3d96":{name:"更自信",id:"06d15689-21c4-446d-89b0-fa5cc33c3d96",type:"confident",minimax:"用更自信的方式，改写这段内容，保留原文 markdown 格式。"},"6a8e29b8-e6ee-4af1-87da-212f01b7925a":{name:"更友好",id:"6a8e29b8-e6ee-4af1-87da-212f01b7925a",type:"friendly",minimax:"用更友好的方式，改写这段内容，保留原文 markdown 格式。"},"bc56080a-edb8-46e2-8584-7be4c4cc5d05":{icon:"IcEdit",placeholder:"头脑风暴，关于",name:"头脑风暴",id:"bc56080a-edb8-46e2-8584-7be4c4cc5d05",type:"Brainstorm",minimax:"我需要你结合以下内容头脑风暴，不少于 10 条。"},"1ee4dcf6-b00d-49b3-b4d5-ec55d102fd40":{icon:"IcEdit",placeholder:"写文章，关于",name:"写文章",id:"1ee4dcf6-b00d-49b3-b4d5-ec55d102fd40",type:"Blog",minimax:"我需要你根据以下内容写一篇论文。每段论述配有标题，并为文章起一个名字。文章名字用# 显示，段落标题用### 显示。"},"0fcb00ae-f47b-426f-9045-25798361ccc4":{icon:"IcEdit",placeholder:"写大纲，关于",name:"写大纲",id:"0fcb00ae-f47b-426f-9045-25798361ccc4",type:"Outline",minimax:"我需要你根据以下内容列出大纲，需要从多方面拆解，并为大纲起一个名字，大纲名字写在文章开头。大纲标题用# 显示，段落标题用### 显示，大纲内容用列表显示。如果结尾有总结，总结内容用正文显示，总结标题用### 显示。"},"a15c829b-8861-47d8-a085-10e7b36d1841":{icon:"IcEdit",placeholder:"写故事，关于",name:"写故事",id:"a15c829b-8861-47d8-a085-10e7b36d1841",type:"Story",minimax:"我需要你根据以下内容写一篇故事，不少于100字，并为故事起一个名字，故事名字写在文章开头用# 显示。"},"b3d48333-ead2-4692-ab51-1f16019500cd":{icon:"IcEdit",placeholder:"日常小记，关于",name:"日常小记",id:"b3d48333-ead2-4692-ab51-1f16019500cd",type:"DailyNotes",minimax:"我需要你根据以下内容写一篇日常小记，记录内容不超过100字，语言形式轻松，可以用 emoji 表达情绪。文章结尾另起一行显示 #tag。"},"e7e1df60-bd16-47d9-a2fa-e4fec4c114cf":{icon:"IcEdit",placeholder:"分析优缺点，关于",name:"分析优缺点",id:"e7e1df60-bd16-47d9-a2fa-e4fec4c114cf",type:"ProsAndConsList",minimax:"我需要你综合以下内容分析优缺点，用列表分别列出优点和缺点，不少于5条，如果有段落标题用### 显示。"},"f2eb1bda-7e1f-4ece-91d1-4c2c2d1f06cf":{icon:"IcEdit",placeholder:"列出执行步骤，关于",name:"列出执行步骤",id:"f2eb1bda-7e1f-4ece-91d1-4c2c2d1f06cf",type:"ActionItems",minimax:"我需要你根据以下内容列出执行步骤。"},"f2eb1bda-7e1f-4ece-91d1-4c2c2d1f06cc":{icon:"IcEdit",name:"解释一下",id:"f2eb1bda-7e1f-4ece-91d1-4c2c2d1f06cc",type:"explain",minimax:"解释一下,关于"},"f2eb1bda-7e1f-4ece-91d1-4c2c2daf06cd":{icon:"IcTable",name:"用多维表起草",id:"f2eb1bda-7e1f-4ece-91d1-4c2c2daf06cd",subNodes:["5f4bf941-d35e-4d1e-96c3-976a4f8ab1d1","c9f301a3-35ec-4ab9-8b2d-ef74340a4701","6485520b-3dbc-469a-99b6-c7ecf4217a56","b177392a-b4c8-45cf-b834-1378d317aa94"]},"5f4bf941-d35e-4d1e-96c3-976a4f8ab1d1":{placeholder:"写一份计划，关于",name:"写计划",id:"5f4bf941-d35e-4d1e-96c3-976a4f8ab1d1",type:"plan",minimax:"我需要你结合以下内容制作一份计划，用表格形式列出。"},"c9f301a3-35ec-4ab9-8b2d-ef74340a4701":{placeholder:"写一份清单，关于",name:"写清单",id:"c9f301a3-35ec-4ab9-8b2d-ef74340a4701",type:"list",minimax:"我需要你结合以下内容制作一份清单，用表格形式列出。"},"6485520b-3dbc-469a-99b6-c7ecf4217a56":{placeholder:"写一份任务管理，关于",name:"任务管理",id:"6485520b-3dbc-469a-99b6-c7ecf4217a56",type:"task",minimax:"现在你是任务管理专家，我需要你结合以下内容制作一份任务管理模板，用表格形式列出。"},"b177392a-b4c8-45cf-b834-1378d317aa94":{placeholder:"",name:"其他...",id:"b177392a-b4c8-45cf-b834-1378d317aa94",type:"other",minimax:"现在你是Excel，我需要你结合以下内容，用表格形式制作一份模板，提炼重要线索作为表头，目的是长期跟踪与信息整理。"},"f2eb1bda-7e1f-4ece-9121-4c2c1daf06cd":{icon:"IcMindmap",name:"用思维导图起草",id:"f2eb1bda-7e1f-4ece-9121-4c2c1daf06cd",subNodes:["0f74c3ef-efbc-41ae-b6fb-04dd8e429d3d","6d5d4666-94f8-471e-84e9-ae80acb50b39","bd6048f5-b856-42aa-968e-b93c781679a3"]},"0f74c3ef-efbc-41ae-b6fb-04dd8e429d3d":{name:"写大纲",id:"0f74c3ef-efbc-41ae-b6fb-04dd8e429d3d",type:"mindOutline",minimax:"结合内容写大纲， 需要从多方面拆解，并为大纲起一个名字。大纲标题用# 显示，段落标题用### 显示，大纲用列表显示。\n\n内容：咖啡\n\n# 咖啡\n\n  ### 1. 咖啡的历史与起源\n\n    - 咖啡的发现与传播\n\n    - 咖啡的起源地和种植地区\n\n  ### 2. 咖啡的种类与制作方法\n\n    - 咖啡豆的分类与特点\n\n    - 咖啡的烘焙过程和不同烘焙度的特色\n\n    - 常见的咖啡制作方法：滴滤、浸泡、意式浓缩等\n\n内容："},"6d5d4666-94f8-471e-84e9-ae80acb50b39":{name:"写计划",id:"6d5d4666-94f8-471e-84e9-ae80acb50b39",type:"mindPlan",minimax:"结合内容写计划，并为计划起一个名字。计划标题用# 显示，段落标题用### 显示，步骤用列表显示，示例如下:\n\n======\n内容：考研\n\n# 考研备战计划\n\n  ### 第一阶段：确定备考范围和目标\n\n    - 确定报考的学校和专业\n\n    - 查阅考研招生简章，了解报考要求和考试科目\n\n    - 制定总体备考进度和目标\n\n  ### 第二阶段：学习基础知识\n\n    - 复习本科阶段的核心知识点\n\n    - 构建自己的知识体系，填补知识盲点\n\n    - 认真学习教材，掌握基本概念和理论知识\n\n  ### 第三阶段：刷题和做模拟\n\n    - 针对每个科目制定刷题计划，逐步提高解题能力\n\n    - 定期参加模拟考试，熟悉考试形式和节奏\n\n    - 分析\n===\n\n内容：\n\n"},"bd6048f5-b856-42aa-968e-b93c781679a3":{name:"其他...",id:"bd6048f5-b856-42aa-968e-b93c781679a3",type:"mindOther",minimax:"结合内容写出特定格式的 markdown。标题用# 显示，段落标题用### 显示，详细情况用列表显示，示例如下:\n\n======\n内容：考研\n\n# 考研备战计划\n\n  ### 第一阶段：确定备考范围和目标\n\n    - 确定报考的学校和专业\n\n    - 查阅考研招生简章，了解报考要求和考试科目\n\n    - 制定总体备考进度和目标\n\n  ### 第二阶段：学习基础知识\n\n    - 复习本科阶段的核心知识点\n\n    - 构建自己的知识体系，填补知识盲点\n\n    - 认真学习教材，掌握基本概念和理论知识\n\n  ### 第三阶段：刷题和做模拟\n\n    - 针对每个科目制定刷题计划，逐步提高解题能力\n\n    - 定期参加模拟考试，熟悉考试形式和节奏\n\n    - 分析\n===\n\n内容：\n\n"}},lF={editPrompts:["9aab88e9-ba1b-4201-a9f3-483e814493db","7aec37fa-f6be-4b6e-a870-6a54b430131a","c0e29509-ca71-4bc0-9a96-fa338a2b05ce","5e936d14-2331-468b-af24-31433992451d","5e936d14-2331-468b-af24-31433994451d","7edcb487-2041-4ade-8483-71b9e1caba35","1a8812df-9395-4eed-84be-59b5e148e7c1","63c58833-d02c-4a15-8039-949c78bcc9f2","7613737d-eb65-4464-a596-167d1e3f0c00"],emptyWithPrompts:["bc56080a-edb8-46e2-8584-7be4c4cc5d05","1ee4dcf6-b00d-49b3-b4d5-ec55d102fd40","0fcb00ae-f47b-426f-9045-25798361ccc4","a15c829b-8861-47d8-a085-10e7b36d1841","b3d48333-ead2-4692-ab51-1f16019500cd","e7e1df60-bd16-47d9-a2fa-e4fec4c114cf","f2eb1bda-7e1f-4ece-91d1-4c2c2d1f06cf","f2eb1bda-7e1f-4ece-91d1-4c2c2d1f06cc","f2eb1bda-7e1f-4ece-91d1-4c2c2daf06cd","f2eb1bda-7e1f-4ece-9121-4c2c1daf06cd"],records:Oue},Mue=e=>{if(e)return e==="ic_table_24"&&(e="ic_table_ai"),e.includes("_")?e.split("_").map(s=>Uue(s)).join(""):e},Uue=e=>{if(e.length>0){const t=e.slice(0,1).toUpperCase(),n=e.slice(1);return t+n}return e},Vue=e=>{if(e)return"".concat(e,'\n"""\n{input}\n"""')},$ue=Object.keys(lF.records);for(const e of $ue){const t=lF.records[e];lF.records[e]={...t,icon:Mue(t.icon),minimax:Vue(t.minimax)}}const GT=e=>e?!!lF.records[e]:!1,l7=e=>{const t=ls(f=>f.records[e.promptId]),n=ls(f=>f.curentPromptId),s=ie(),[a,o]=y.useState(!1),[i,l]=y.useState(!1);if(!t)return null;const c=t.subNodes,d=GT(t.id),u=()=>{var g;const f=qe(),h=ls.getState(),p={...t,subNodes:[f,...(g=t.subNodes)!=null?g:[]]};ls.setState({records:{...h.records,[f]:{name:"",id:f,type:"Custom"},[e.promptId]:p},curentPromptId:f,hasUpdate:!0})};return r.jsxs("div",{children:[r.jsxs("div",{className:R("group w-full px-1 animate-hover flex justify-between items-center h-10",{"bg-black_006 ":n===e.promptId}),onClick:()=>{if(c){o(!a);return}e.onChangePrompt(e.promptId)},children:[r.jsxs("div",{className:"flex items-center flex-1 w-0",children:[e.renderHandle(),c&&r.jsx(V,{name:"IcToggleBlack",style:{rotate:a?"90deg":"0deg"},size:"large",onClick:f=>{f.stopPropagation(),c&&o(!a)}}),r.jsx(V,{name:t.icon||"IcEdit",size:"middle"}),i?r.jsx(Ct,{autoFocus:!0,inputClassName:"px-1",className:"h-10",showBorder:!1,placeholder:c?"未命名指令目录":"未命名指令",value:t.name,onBlur:()=>{l(!1)},onChange:f=>{const h=ls.getState(),p={...t,name:f,type:"Custom"};ls.setState({records:{...h.records,[t.id]:p},hasUpdate:!0})}}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"ml-1 text-ellipsis",onClick:()=>{l(!0)},children:t.name||(c?"未命名指令目录":"未命名指令")}),d&&r.jsx(Cs,{popup:"系统预置指令，暂不支持修改",delay:{open:1500},children:r.jsx("div",{className:"ml-2 px-1 bg-red text-white rounded text-t5",children:"预置"})})]})]}),r.jsxs("div",{className:"flex items-center shrink-0 space-x-1",children:[!d&&r.jsx(Cs,{popup:"删除当前指令".concat(c?"目录":""),children:r.jsx(V,{size:"middle",className:"hidden text-grey group-hover:block cursor-pointer",name:"IcTrash",onClick:f=>{f.stopPropagation(),s.warning({title:"确定删除该".concat(c?"指令目录":"指令","?"),confirm:()=>{var _,x;const h=ls.getState(),p=h.records[e.promptId],g={...h.records};if(c&&((_=p==null?void 0:p.subNodes)==null||_.forEach(F=>{delete g[F]})),e.parentId){const F=h.records[e.parentId];if(!F){console.log("parent is not found");return}const b=(x=F==null?void 0:F.subNodes)==null?void 0:x.filter(E=>E!==t.id),w={...F,subNodes:b};ls.setState({records:{...g,[e.parentId]:w},hasUpdate:!0})}else{const F=h[e.categoryType].filter(b=>b!==t.id);ls.setState({[e.categoryType]:F,records:g,hasUpdate:!0})}}})}})}),t.subNodes&&!GT(t.id)&&r.jsx(Cs,{popup:"添加指令",delay:{open:1500},children:r.jsx(V,{size:"middle",name:"IcAdd",className:"hidden group-hover:block",onClick:f=>{f.stopPropagation(),u()}})}),r.jsx(Cs,{popup:t.hidden?"显示":"隐藏当前指令",children:r.jsx(V,{size:"middle",className:R("text-grey group-hover:block cursor-pointer",{hidden:!t.hidden}),name:t.hidden?"IcShow":"IcHide",onClick:f=>{f.stopPropagation();const h=ls.getState();ls.setState({records:{...h.records,[t.id]:{...t,hidden:!t.hidden}},hasUpdate:!0})}})})]})]}),a&&t.subNodes&&r.jsx(Hue,{categoryType:e.categoryType,parentId:t.id,subNodes:t.subNodes,onChangePrompt:e.onChangePrompt}),a&&t.subNodes&&t.subNodes.length===0&&r.jsx("div",{className:"py-2 animate-hover flex justify-center w-full text-grey text-t4",onClick:()=>{u()},children:"添加新的指令"})]})},Hue=e=>{const t=e.subNodes.map(n=>({id:n,value:n}));return r.jsx("div",{className:"ml-6",children:r.jsx(br,{onlyHandleDraggable:!0,onChange:n=>{const s=ls.getState(),a=s.records[e.parentId];if(!a){console.log("it's impossible");return}ls.setState({records:{...s.records,[e.parentId]:{...a,subNodes:n.map(o=>o.id)}},hasUpdate:!0})},items:t,renderItemContent:({item:n,renderDragHandle:s})=>r.jsx(l7,{parentId:e.parentId,categoryType:e.categoryType,promptId:n.id,onChangePrompt:e.onChangePrompt,renderHandle:()=>s({className:"cursor-pointer flex items-center justify-center w-5 h-5 text-grey4",size:"middle"})})})})},zue=e=>{const t=ls(s=>s.editPrompts),n=ls(s=>s.emptyWithPrompts);return r.jsx("div",{className:"flex flex-col text-t2 p-2 w-[30%] ",children:r.jsxs("div",{className:"mt-2 flex-1 overflow-auto space-y-2",children:[r.jsx($A,{categoryType:"editPrompts",title:"编辑/选中块 AI指令",promptIds:t,onChangePrompt:e.onChangePrompt}),r.jsx($A,{categoryType:"emptyWithPrompts",title:"起草 AI指令",promptIds:n,onChangePrompt:e.onChangePrompt})]})})},$A=e=>{const t=ie(),[n,s]=y.useState(!0),a=e.promptIds.map(o=>({id:o,value:o}));return r.jsxs("div",{children:[r.jsxs("div",{className:"group px-2 pb-2 text-t1-medium flex items-center justify-between animate-click",onClick:()=>{s(!n)},children:[r.jsx("div",{children:e.title}),r.jsx(Cs,{popup:"添加指令",children:r.jsx(V,{size:"middle",name:"IcAdd",onClick:o=>{o.stopPropagation();const i=qe(),l=ls.getState();t.warning({colorType:"active",cancelColorType:"active",confirmText:"添加自定义指令",cancelText:"添加自定义指令目录",confirm:()=>{ls.setState({[e.categoryType]:[i,...l[e.categoryType]],records:{...l.records,[i]:{name:"",id:i,type:"Custom"}},curentPromptId:i,hasUpdate:!0})},cancel:()=>{ls.setState({[e.categoryType]:[i,...l[e.categoryType]],records:{...l.records,[i]:{name:"",id:i,subNodes:[]}},hasUpdate:!0})}})}})})]}),n&&r.jsx(br,{onlyHandleDraggable:!0,onChange:o=>{const i=o.map(l=>l.value);ls.setState({[e.categoryType]:i,hasUpdate:!0})},items:a,renderItemContent:({item:o,renderDragHandle:i})=>r.jsx(l7,{categoryType:e.categoryType,promptId:o.id,onChangePrompt:e.onChangePrompt,renderHandle:()=>i({className:"cursor-pointer flex items-center justify-center w-5 h-5 text-grey4",size:"middle"})})})]})},que=e=>{const t=ls(f=>{var h;return f.records[(h=f.curentPromptId)!=null?h:""]}),n=ls(f=>f.curentPromptId),[s,a]=y.useState(!1),[o,i]=y.useState(),l=f=>{const h=ls.getState();if(!h.curentPromptId)return;const g={...h.records[h.curentPromptId],...f};ls.setState({records:{...h.records,[h.curentPromptId]:g}})},c=f=>{i(f),ls.setState({hasUpdate:!0})},d=o||t,u=GT(n);return r.jsxs("div",{className:"w-[70%] p-2",children:[!u&&r.jsx("div",{className:"flex justify-between w-full flex-row-reverse",children:r.jsx("div",{className:"flex items-center space-x-1",children:r.jsx(De,{disable:!o,colorType:"active",onClick:()=>{o&&l(o),be.success("已保存")},children:"保存"})})}),d&&r.jsx("div",{className:"flex flex-col mt-2 rounded bg-grey8 w-full h-[80%] ",children:r.jsxs("div",{className:"h-[90%]",children:[r.jsxs("div",{className:"px-4 flex items-center mt-2 space-x-2",children:[!s||u?r.jsx("div",{className:R("text-t1-medium max-w-[200px] text-ellipsis min-w-[30px] h-[22px] group-hover:opacity-100 transition-opacity",{"animate-hover":!u}),onClick:()=>{a(!0)},children:d.name||"请输入指令名称"}):r.jsx(Ct,{placeholder:"请输入指令名称",inputClassName:"text-t1-medium px-0",showBorder:!1,onBlur:()=>{a(!1)},value:d.name,onChange:f=>{c({...d,name:f})}}),u&&r.jsx("div",{className:"text-t2 p-1 bg-grey6 rounded",children:"系统预置"})]}),r.jsx("div",{className:"w-full mt-2 h-px bg-grey6"}),r.jsx("textarea",{disabled:u,placeholder:"请输入你的AI指令",className:"h-full py-2 px-3 w-full bg-grey9 rounded  focus-within-border text-t2 resize-none",value:d.minimax,onChange:f=>{const{value:h}=f.target;c({...d,minimax:h})}})]})}),r.jsx("div",{className:R("text-t4 mt-2 w-full text-grey3 flex justify-end",{"mt-4":u}),children:"使用 {input} 作为引用文本的占位符"})]})},Gue=()=>{const e=ls(s=>s.curentPromptId),t=_g(),n=Oe();return y.useEffect(()=>()=>{const s=ls.getState();if(!s.hasUpdate)return;const a=Iu();a&&n(()=>{t(a.uuid,{setting:{aiPrompt:{editPrompts:s.editPrompts,emptyWithPrompts:s.emptyWithPrompts,records:s.records}}})})},[n,t]),r.jsxs("div",{className:"next-modal flex w-[900px] h-[420px]",children:[r.jsx(zue,{onChangePrompt:s=>{ls.setState({curentPromptId:s})}}),r.jsx("div",{className:"w-px h-full bg-grey6"}),e&&r.jsx(que,{},e)]})},c7=BO(),Wue=()=>an(c7),Kue=()=>{const{couponId:e,selectCoupon:t,onPay:n,close:s,payMethod:a,setPayMethod:o,planId:i,onSelectPlan:l,planList:c,curCalculateQuote:d,loading:u,lastDate:f,couponList:h}=Wue();return r.jsxs(r.Fragment,{children:[r.jsx(ha.Header,{close:s}),r.jsxs("div",{className:"px-7",children:[r.jsx(sa,{height:54,className:"text-h2",children:"购买 AI 权益套餐"}),r.jsx(sa,{height:36,className:"text-grey3 text-t3",children:"按月计费，仅限在当前空间使用"})]}),r.jsx(ha.SelectPlan,{items:c,loading:u,selectId:i,itemClick:l,itemRender:p=>r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-2.5 text-t4",children:[r.jsx("span",{className:"text-h4",children:p.name}),r.jsx("span",{children:"次/日｜30天"})]}),r.jsxs("div",{className:"text-h3",children:[io(p.currentPriceUnit),p.currentPrice]})]})}),r.jsx(ha.PlanEndTime,{endTime:f}),r.jsx(aN,{onSelectId:t,couponList:h,selectId:e,className:"px-8 my-2.5"}),r.jsx(ha.PayMethod,{payMethod:a,switchPayMethod:o}),r.jsx(ha.PayBar,{price:d==null?void 0:d.amount,priceUnit:d==null?void 0:d.amountUnit,disablePay:u,onPay:n})]})},Q0=()=>{const e=ie();return y.useCallback(t=>e.modal({modalId:Ve.UPGRADE_SUPPORT,className:R("min-h-[400px] max-h-[80vh] next-modal-scroll","w-[600px]"),content:()=>r.jsx(c7,{planId:t==null?void 0:t.planId,isFrom:t==null?void 0:t.isFrom,upgradeType:"ai",children:r.jsx(Kue,{})})}),[e])};let d7;const Yue=e=>{d7=e},Xue=e=>{const{model:t,children:n,...s}=e,a=ie();return r.jsx("div",{...s,className:"mb-1 px-1",children:r.jsxs("div",{className:"w-full py-1 px-3 flex items-center justify-between",onClick:()=>{t==null||t.performChange(o=>{o.select(0,0)}),a.modal({content:()=>r.jsx(Gue,{})})},children:[r.jsx("div",{className:"text-t2 text-grey3",children:"编辑快捷操作"}),r.jsx(V,{className:"animate-click text-grey3",name:"IcSettings",size:"middle"})]})})},Que=e=>{const{closeSelf:t,editorScene:n,editType:s,popper:a,popcorn:o,blockId:i,selection:l,model:c,isInRight:d,from:u,isBitable:f,isMindMap:h,isDescription:p,defaultCustomPrompt:g,showInput:_=!0}=e,[x,F]=y.useState(n);Vw();const b=y.useRef(s?dC.has(s):!1),w=y.useRef(s?H_.has(s):!1),[E,C]=y.useState(()=>{var Ue;return s&&me.event("ai_trigger",{ai_type:xC[s],from:u}),(Ue=$h(s!=null?s:""))==null?void 0:Ue.prompt}),[k,T]=y.useState(s&&ede.has(s)),v=y.useRef(null),I=lt(),j=y.useRef(s),[S,D]=y.useState(_),A=Oe(),P=ja(bn(".next-space-page .page-header .group",d)).width,L=y.useRef(""),O=y.useRef(""),$=y.useRef([]),M=y.useRef(x===it.BlockSelected?lr(J.ui.selectedBlocks):[]),U=y.useRef(),z=ie(),K=y.useRef(null),W=y.useRef(null),Y=y.useRef(),G=Dt(),ee=y.useRef([]),te=y.useRef(-1/0),Q=y.useRef([]),ne=y.useRef(""),[se,ce]=y.useState(!1),ae=Uo(),de=Nn(),[ke,Te]=y.useState(!1),he=y.useRef(g),[Ee,ge]=y.useState(g),Se=Q0();ai(),y.useEffect(()=>{if(x===it.PageEmpty)return;const Ue=K.current;if(!Ue)return;const He=bn(".next-space-page",d);if(!He)return;const rt=a==null?void 0:a.current;if(!rt)return;const je=Ue.clientHeight+10,le=o.getBoundingClientRect(),Qe=He.getBoundingClientRect(),Tt=le.bottom-Qe.top;if(He.clientHeight-Tt>je)return;const cn=Tt+He.scrollTop-(He.clientHeight-je);He.scrollTo(0,cn),rt.update()},[a==null?void 0:a.current]),y.useEffect(()=>{var Ue,He;if(x===it.TextSelected&&c)return Y.current=c.mark((Ue=l==null?void 0:l.start)!=null?Ue:0,(He=l==null?void 0:l.end)!=null?He:0,{className:Mn({backgroundColor:"var(--selection)"})}),()=>{var rt;(rt=Y.current)==null||rt.remove()}},[]);const Re=y.useCallback(()=>{(x===it.PageEmpty||x===it.PageHasContent||x===it.PageContentWroteByAI)&&A(()=>{const Ue=J.blocks[O.current];Ue&&_e(O.current,{type:Ue.type,data:Ue.data})})},[x,A]),Ae=y.useCallback(()=>{const{isMindMapPage:Ue,isInMindMap:He}=V_(i);if(Ue){const rt=SM(i);$.current=gA(i),O.current=rt,w.current=!0}else He&&($.current=gA(i),O.current=i,w.current=!0)},[i,x]);y.useEffect(()=>{Ae()},[Ae]);const Me=y.useCallback(()=>{k||ne.current?z.warning({modalId:Zce,title:"是否放弃当前AI处理结果？",confirm(){var He;B(),k&&Re(),(He=U.current)==null||He.abort(),t(),Te(!1)}}):(t(),Te(!1));const Ue=de(i);Ue==null||Ue.requestFocus()},[i,t,de,k,z,Re]);y.useEffect(()=>{const Ue=He=>{var je;const rt=He.target;(je=K.current)!=null&&je.contains(rt)||rt.closest("[data-list-item]")||Me()};return Ht.addEventListener("mouseup",Ue),()=>{Ht.removeEventListener("mouseup",Ue)}},[t,Me,k,z,A,de,i]),y.useEffect(()=>{var je,le;const{ui:Ue,blocks:He}=pe();let rt="";if(x===it.BlockSelected){const Qe=lr(Ue.selectedBlocks);rt=bo(Qe)}if(x===it.TextSelected){const{description:Qe,segments:Tt}=(le=(je=He[i])==null?void 0:je.data)!=null?le:{};rt=fe(p?Qe:Tt).slice(l==null?void 0:l.start,l==null?void 0:l.end)}L.current=rt},[]),y.useEffect(()=>{if(!s||s===we.OtherLanguage)return;const Ue=new Set(KN.map(He=>He.editType));(s===we.ContinueWrite||s===we.Summarize||s===we.Summary||s===we.Explain||Ue.has(s))&&gt(s)},[]);const Ge=()=>{const Ue=v.current;Ue&&es(0).then(()=>{Ue.setSelectionRange(Ue.value.length,Ue.value.length),Ue.focus()})};y.useEffect(()=>{Ge()},[]);const tt=y.useCallback(()=>{var Ue;(Ue=U.current)==null||Ue.abort(),T(!1),C(""),ge(""),Ge(),ne.current&&(x===it.BlockSelected&&F(it.BlockSelectedAndWroteByAI),x===it.TextSelected&&F(it.TextSelectedAndWroteByAI)),(x===it.PageEmpty||x===it.PageHasContent||x===it.PageContentWroteByAI)&&(F(it.PageContentWroteByAI),Re())},[x,Re]);y.useEffect(()=>{const Ue=He=>{Ie("esc")(He)&&k&&tt()};return document.addEventListener("keydown",Ue),()=>{document.removeEventListener("keydown",Ue)}},[k,tt]);const gt=Ue=>{var He,rt,je;Ue===we.Replace||Ue===we.Insert||Ue===we.Close?me.event("ai_finish",{ai_type:(rt=xC[(He=j.current)!=null?He:""])!=null?rt:Ue,from:u}):me.event("ai_trigger",{ai_type:xC[Ue],from:u}),Ae(),e7({pageId:I,blockId:i,prompt:(je=he.current)!=null?je:"",tempPageId:ne,allLine:ee,archiveResult:Q,selectedText:L,selectedBlockIds:M,editTypeRef:j,editType:Ue,scene:x,fetchAIResult:Be,setPlaceHolder:ge,setPrompt:C,getSelectedContent:N,removeTempPage:B,closeSelf:t,selection:l,model:c,isBitable:f,isMindMapPage:h,isDescription:p,getEditorModel:de})},kt=location.href.includes(i),At=Ue=>{const{data:He}=Ue;He.prompt&&He.editType===we.Custom?he.current=He==null?void 0:He.prompt:he.current=void 0,b.current&&He.editType!==we.ContinueWrite&&(b.current=!1),He.editType===we.Bitable?He.editType=we.Bitable_Other:He.editType===we.MindMap&&(He.editType=we.MindMap_Other),dC.has(He.editType)?b.current=!0:H_.has(He.editType)&&(w.current=!0),!S&&He.editType===we.OtherLanguage?(D(!0),setTimeout(()=>{Ge()},0)):D(_),gt(He.editType)};let Qt=!1;w.current&&x===it.PageContentWroteByAI&&(Qt=!0);let nn;!w.current&&!b.current&&(nn=Jue(x,At)),nn||(nn=hde({scene:x,onItemClick:At,selectedBlockIds:M,isBitable:f,isMindMap:h||Qt,isBitablePage:kt,isDescription:p,editTypeRef:j}));const sn=ls.getState();x===it.PageEmpty&&sn.editPrompts,nn.unshift({type:H.CUSTOM_RENDER,render:()=>r.jsx(Xue,{model:c})});const ms=nn.filter(Ue=>Ue.type!==H.LINE).length;y.useEffect(()=>{const Ue=!Ee&&!E&&!k&&ms>0;es(Ue?100:0).then(()=>{Te(Ue)})},[k,ms,E,Ee]);const N=()=>{var je,le;const{blocks:Ue}=pe(),He=Ue[I];let rt="";if(f)p&&(x===it.TextSelected||x===it.TextSelectedAndWroteByAI)?rt=L.current:rt=zT(i);else if(x===it.PageHasContent||x===it.PageContentWroteByAI)rt=bo((je=He==null?void 0:He.subNodes)!=null?je:[]);else if(x===it.BlockSelected||x===it.BlockSelectedAndWroteByAI||x===it.TextSelected||x===it.TextSelectedAndWroteByAI){if(h&&((le=J.ui.selectedBlocks[0])==null?void 0:le.blockId)===I)return rt=fe(He==null?void 0:He.data.segments),rt;rt=L.current}return rt},B=()=>{ne.current&&(Ro(ne.current,!0),ce(!1),ne.current="")},X=(Ue,He=!1)=>{let rt=[Ue];Ue.length!==1&&Ue.includes("\n")&&(rt=[],Ue.split("\n").forEach((le,Qe)=>{Qe!==0?rt.push("\n",le):rt.push(le)}));let je=!1;w.current&&((j.current&&H_.has(j.current)||j.current===we.ContinueWrite)&&(je=!0),j.current&&My.has(j.current)&&(je=!0));for(const le of rt)Rue({str:le,pageId:I,scene:x,tempPageId:ne.current,currentBlockId:O,allLine:ee,popper:a,isInRight:d,resultContainer:W,modalContainer:K,uploadFile:ae,useCollection:f||b.current,useMindMap:je,isEndWrap:He,codeStartLineNum:te,mindNodeTypes:$,editTypeRef:j})},Z=()=>{var He;const Ue=(He=An(ee.current))!=null?He:"";if(!Ue.endsWith("\n")){const rt=Ue.startsWith("```"),je=Ue.startsWith("|"),le=Ue.startsWith("![");(rt||je||le)&&X("\n",!0)}switch(Re(),T(!1),C(""),ge(""),x){case it.PageEmpty:case it.PageHasContent:F(it.PageContentWroteByAI);break;case it.TextSelected:F(it.TextSelectedAndWroteByAI);break;case it.BlockSelected:w.current&&j.current===we.ContinueWrite?F(it.PageContentWroteByAI):F(it.BlockSelectedAndWroteByAI);break}},oe=(Ue,He)=>ut({type:m.BlockType.TEXTAREA,data:{segments:[]}},{parentId:Ue,after:He.after},He.ignoreOP),xe=()=>{var Ue,He,rt;switch(te.current=-1/0,x){case it.PageEmpty:O.current=i;break;case it.PageHasContent:{if(w.current)break;const{blocks:je}=pe();fe((Ue=je[i])==null?void 0:Ue.data.segments).trim()?O.current=oe(I,{after:i}):O.current=i;break}case it.BlockSelected:case it.TextSelected:case it.BlockSelectedAndWroteByAI:case it.TextSelectedAndWroteByAI:{if(w.current&&j.current===we.ContinueWrite)return;if(!J.blocks[ne.current]){if(ne.current=ut({type:m.BlockType.PAGE,hidden:!0},{parentId:I},!0),ce(!0),w.current){const Tt=J.blocks[i];if(!Tt)return;$.current=[U_(Tt)],O.current=ne.current}O.current=oe(ne.current,{ignoreOP:!0});return}const{blocks:le}=pe();fe((He=le[O.current])==null?void 0:He.data.segments).trim()&&(O.current=oe(ne.current,{after:O.current,ignoreOP:!0}));break}case it.PageContentWroteByAI:{const{blocks:je}=pe();fe((rt=je[O.current])==null?void 0:rt.data.segments).trim()&&(O.current=oe(I,{after:O.current}));break}}},Be=async Ue=>{var He;T(!0);try{const rt={"Content-Type":"application/json"},je=eg();je&&(rt.Authorization="Bearer ".concat(je)),U.current=new AbortController;const le=(Ue==null?void 0:Ue.type)==="custom";let Qe;if(le&&!wu()){const Lt=Ue==null?void 0:Ue.selectedText;if(!Lt)return;const Bn=(He=he.current)==null?void 0:He.replaceAll("{input}",Lt),Gt=Ot();Qe=await fetch("/api/chat/".concat(Gt,"/ask"),{signal:U.current.signal,method:"POST",headers:rt,body:JSON.stringify({prompt:Bn})})}else Qe=await fetch(wu()?"/api/chat/buildin":"/api/completions",{signal:U.current.signal,method:"POST",headers:rt,body:JSON.stringify({...Ue,spaceId:G.uuid,blockId:i})});if(!Qe.ok)return;const Tt=Qe.body;if(!Tt)return;const Pt=Tt.getReader(),cn=new TextDecoder;for(xe(),ee.current.join("").trim()&&(Q.current=ee.current),ee.current=[];;){const{value:Lt,done:Bn}=await Pt.read();if(Bn){Z();break}const Gt=cn.decode(Lt);try{const to=JSON.parse(Gt);if(to.code){T(!1),to.code===1e3?(t(),Se({isFrom:Mt.ai_max})):(Re(),be.warning(Gt));break}}catch(to){}const jr=Hle(Gt);X(jr)}}catch(rt){console.log(rt)}},Le=()=>{var Qe,Tt,Pt,cn,Lt,Bn;if(!E||!E.trim())return;const{blocks:Ue}=pe(),He=Ue[I];if(!He)return;const rt=fe(He.data.segments);let je;const le=j.current===we.OtherLanguage&&E.startsWith("把当前语言翻译成");if(b.current||w.current)je={type:(Qe=j.current)!=null?Qe:"write",topic:_de(E,(Tt=j.current)!=null?Tt:we.Bitable),selectedText:N()};else if(le)je={type:"edit",prompt:E,selectedText:N()};else if(j.current===we.OtherCodeLanguage&&E.startsWith("把当前代码改写成"))je={type:"rewriting",selectedText:N(),language:(cn=(Pt=E.split("把当前代码改写成："))==null?void 0:Pt[1])!=null?cn:""};else if(x===it.BlockSelected||x===it.TextSelected||x===it.BlockSelectedAndWroteByAI||x===it.TextSelectedAndWroteByAI)B(),dC?je={type:"edit",prompt:E,selectedText:N(),pageTitle:rt}:je={type:"edit",prompt:E,selectedText:L.current,pageTitle:rt};else{const Gt=nde.find(jr=>{var or;const to=(or=$h(jr))==null?void 0:or.prompt;return to?E.startsWith(to):!1});Gt?je={type:(Bn=(Lt=$h(Gt))==null?void 0:Lt.type)!=null?Bn:"write",topic:E}:je={type:"write",prompt:E}}he.current&&(je={type:"custom",selectedText:E}),Be(je)},bt=()=>{var He,rt;if(k||!b.current)return;const Ue=(rt=$h((He=j.current)!=null?He:""))==null?void 0:rt.promptList;if(Ue)return r.jsx("div",{className:"pl-8 h-[30px] py-[5px] mb-[5px]",children:Ue.map(je=>r.jsx("span",{className:"px-1.5 bg-[#ECEDED] text-grey text-t2 mr-1.5 cursor-pointer py-0.5 rounded-sm",onClick:()=>{C(je.placeholder),Ge()},children:je.title},je.title))})};return nn=nn.map(Ue=>(Ue.type===H.OPERATION&&(Ue.data.iconClassName="text-[#A34DD9]"),Ue)),r.jsx("div",{className:R("ai-editor",S?"min-w-[400px]":""),style:{width:S?P:void 0},ref:K,children:r.jsxs(Fe,{visible:ke&&!k,interactive:!0,offset:[0,2],placement:"bottom-start",theme:"none",animation:"shift-away",maxWidth:"unset",className:"next-modal w-full block",popupClass:"next-modal",popup:r.jsx(ze,{className:"py-2 w-72 max-w-[calc(100vw-24px)] overflow-y-auto max-h-[56vh]",items:nn,onItemClick:At}),children:[se&&r.jsx("div",{className:"p-2 pb-0 whitespace-pre-wrap text-t2 max-h-[40vh] overflow-auto",ref:W,children:r.jsx(Mo.Provider,{value:wt.PAGE_LITE_PREVIEW,children:r.jsx(Ec.Provider,{value:W,children:r.jsx(d7,{uuid:ne.current,readonly:!0})})})}),S&&r.jsxs("div",{className:"flex border border-[#A34DD9] rounded py-1.5 px-2 items-center",children:[r.jsx(V,{name:"IcAiFill",className:R("mr-2 self-start cursor-pointer text-[#A34DD9]",!k&&"mt-0.5"),size:"middle"}),k&&r.jsxs(r.Fragment,{children:[r.jsxs("span",{className:"text-t2 text-[#A34DD9]",children:[Na," 正在写作..."]}),r.jsx(V,{className:"animate-spin text-grey4",name:"IcNaviLoading",size:"middle"}),r.jsx("span",{className:"text-t2 text-grey4 ml-auto cursor-pointer",onClick:tt,children:"停止 ESC"})]}),!k&&r.jsxs(r.Fragment,{children:[r.jsx(oi,{ref:v,autoFocus:!0,singleLine:!1,placeholder:Ee||"告诉 ".concat(Na," 写什么..."),boxClassName:"flex-grow",fontClassName:"text-t2",onKeyDown:Ue=>{if(Ue.stopPropagation(),Ue.nativeEvent.stopPropagation(),Ie("esc")(Ue)&&Me(),Ie("Space")(Ue)&&E===void 0){Me();const He=de(i);He&&(He.performChange(rt=>{rt.insert(" ")}),setTimeout(()=>{He.performChange(rt=>{rt.select(He.content.length)})},100),He.requestFocus())}Ue.nativeEvent.isComposing||(Ie("enter")(Ue)&&Le(),!E&&Ie("Backspace")(Ue)&&Me())},value:E,onChange:Ue=>{const He=Ue.target;He&&C(He.value)}}),r.jsx(V,{name:"IcSendToAi",onClick:()=>Le(),size:"large",className:R("text-grey4 self-end cursor-pointer justify-end",E&&"text-[#A34DD9]")})]})]}),x===it.PageEmpty&&bt()]})})},Jue=(e,t)=>{const n=ls.getState();switch(e){case it.BlockSelected:case it.TextSelected:return n.editPrompts.map(a=>{const o=n.records[a];return{type:H.OPERATION,isHidden:o==null?void 0:o.hidden,data:{icon:(o==null?void 0:o.icon)||"IcEdit",title:(o==null?void 0:o.name)||(o!=null&&o.subNodes?"未命名指令目录":"未命名指令"),uuid:a,hasArrow:!!(o!=null&&o.subNodes),prompt:o==null?void 0:o.minimax,editType:o==null?void 0:o.type,renderSubMenu:o!=null&&o.subNodes?()=>{var i;return r.jsx(HA,{subNodes:(i=o==null?void 0:o.subNodes)!=null?i:[],onItemClick:t})}:void 0}}});case it.PageEmpty:return n.emptyWithPrompts.map(a=>{const o=n.records[a];return{type:H.OPERATION,isHidden:o==null?void 0:o.hidden,data:{icon:(o==null?void 0:o.icon)||"IcEdit",title:(o==null?void 0:o.name)||(o!=null&&o.subNodes?"未命名指令目录":"未命名指令"),uuid:a,hasArrow:!!(o!=null&&o.subNodes),prompt:o==null?void 0:o.minimax,editType:o==null?void 0:o.type,renderSubMenu:o!=null&&o.subNodes?()=>{var i;return r.jsx(HA,{subNodes:(i=o==null?void 0:o.subNodes)!=null?i:[],onItemClick:t})}:void 0}}})}},HA=e=>{const t=ls.getState(),n=e.subNodes.map(s=>{const a=t.records[s];return{type:H.OPERATION,isHidden:a==null?void 0:a.hidden,data:{icon:(a==null?void 0:a.icon)||"IcEdit",iconClassName:"text-[#A34DD9]",title:(a==null?void 0:a.name)||(a!=null&&a.subNodes?"未命名指令目录":"未命名指令"),uuid:s,editType:a==null?void 0:a.type,hasArrow:!!(a!=null&&a.subNodes),placeHolder:a==null?void 0:a.placeholder,prompt:a==null?void 0:a.minimax}}});return r.jsx(ze,{className:Ra,keyDownPriority:dr+1,items:n,onItemClick:e.onItemClick})},Ui=()=>{const e=ie(),t=Ln(),{enableAI:n}=xr(),s=ai();return y.useCallback(a=>{if(!n)return;if(s){be.warning("只有空间成员可以使用AI功能");return}const{popcorn:o,editorScene:i,blockId:l,model:c,offset:d,editType:u,selection:f,from:h,isBitable:p,isMindMap:g,isDescription:_,showInput:x=!0,defaultCustomPrompt:F,placement:b="bottom-start"}=a;e.dropdown({modalId:Ve.AI_EDITOR,popcorn:o,offset:d!=null?d:[0,2],placement:b,disableEsc:!0,autoClose:!1,blockMaskClick:!1,content({onCloseModal:w,popper:E}){return r.jsx(Que,{defaultCustomPrompt:F,showInput:x,popcorn:o,isInRight:t,model:c,blockId:l,popper:E,closeSelf:w,editorScene:i,editType:u,from:h,selection:f,isBitable:p,isMindMap:g,isDescription:_})}})},[n,s,t,e])},zA=({hasContent:e})=>{const t=_w(),n=Ui(),s=N3(),a=Nn(),o=document.querySelector('[data-block-id="'.concat(t,'"]'));if(!o)return null;const i=c=>{var f;const{editType:d}=c.data;d===we.Bitable?c.data.editType=we.Bitable_Other:d===we.MindMap&&(c.data.editType=we.MindMap_Other);const u=a(t);u==null||u.performChange(h=>{h.shadow().select(s.left,s.right).delete().release()}),n({popcorn:o,blockId:t,from:ho.ContextMenu,editorScene:e?it.PageHasContent:it.PageEmpty,editType:d,defaultCustomPrompt:(f=c.data)==null?void 0:f.prompt})};let l=[];if(e)l=[{type:H.BLOCK_ITEM,data:{editType:we.Summarize,title:"总结",icon:"IcSummarize"}},{type:H.BLOCK_ITEM,data:{editType:we.Summary,icon:"IcAbstract",title:"摘要"}},{type:H.BLOCK_ITEM,data:{editType:we.Explain,icon:"IcQuestion",title:"解释"}}];else{const c=localStorage.getItem(WN),d=localStorage.getItem(w1);l=A8(i).map(f=>{let h={};const p=f.data;return p.editType===we.Bitable?h={textClassName:c?void 0:"text-red",rightText:c?void 0:"NEW",renderSubMenu:()=>r.jsx(R8,{onItemClick:i})}:p.editType===we.MindMap&&(h={textClassName:d?void 0:"text-red",rightText:d?void 0:"NEW",renderSubMenu:()=>r.jsx(D8,{onItemClick:i})}),{type:H.OPERATION,data:{...p,...h}}})}return r.jsx(ze,{keyDownPriority:dr+1,className:Ra,items:l,onItemClick:i})},Zue=()=>{const e=_w(),t=Ui(),n=N3(),s=Nn(),a=document.querySelector('[data-block-id="'.concat(e,'"]'));if(!a)return null;const o=KN.map(i=>({type:H.BLOCK_ITEM,data:i}));return r.jsx(ze,{keyDownPriority:dr+1,className:Ra,items:o,onItemClick:({data:i})=>{const{editType:l}=i,c=s(e);c==null||c.performChange(d=>{d.shadow().select(n.left,n.right).delete().release()}),t({popcorn:a,blockId:e,from:ho.ContextMenu,editorScene:it.PageHasContent,editType:l})}})},efe=()=>[{title:"Figma",placeholder:"https://www.figma.com/...",embedType:$r.figma},{title:"Airtable",placeholder:"https://www.airtable.com/...",embedType:$r.airtable,hidden:!1},{title:"Sketch",placeholder:"https://www.sketch.com/...",embedType:$r.sketch},{title:"墨刀",placeholder:"https://www.modao.cc/...",embedType:$r.modao,hidden:!1},{title:"摹客",placeholder:"https://app.mockplus.cn/...",embedType:$r.mockplus,keywords:["mockplus"],hidden:!1},{title:"Excalidraw",placeholder:"https://www.excalidraw.com/...",embedType:$r.excalidraw},{title:"ProcessOn",placeholder:"https://www.processon.com/...",embedType:$r.processon},{title:"Canva",placeholder:"https://www.canva.cn/...",embedType:$r.canva},{title:"Bilibili",placeholder:"https://www.bilibili.com/...",embedType:$r.bilibili,hidden:!1},{title:"腾讯视频",placeholder:"https://v.qq.com/...",embedType:$r.vqq,keywords:["tencentvideo"],hidden:!1},{title:"优酷视频",placeholder:"https://v.youku.com/...",embedType:$r.youku,keywords:["youku"],hidden:!1},{title:"西瓜视频",placeholder:"https://www.ixigua.com/...",embedType:$r.xigua,keywords:["ixigua"],hidden:!1},{title:"网易云音乐",placeholder:"https://music.163.com/...",embedType:$r.music163,keywords:["neteasemusic"],py:"wangyiyunyinyue",initials:"wyyyy",hidden:!1},{title:"CodeSandbox",placeholder:"https://www.codesandbox.io/...",embedType:$r.codesandbox},{title:"CodePen",placeholder:"https://www.codepen.io/...",embedType:$r.codepen}].filter(e=>!e.hidden),aj=()=>{const e={},t=Xo();return efe().forEach(n=>e[n.embedType]={type:H.BLOCK_ITEM,data:{type:m.BlockType.EMBED,actionType:Xe.CREATE,image:new URL("".concat(wo,"/embeds/").concat(t?"dark":"light","/ic_insert_").concat(n.embedType,".png")).href,title:n.title,placeholder:n.placeholder,py:n.py,initials:n.initials,keywords:n.keywords,params:{data:{embedType:n.embedType},local:!0}}}),e},tfe=()=>{const e=y.useCallback((n,s)=>{var o;let a=(o=J.blocks[n])==null?void 0:o.data;a||(a={}),_e(n,{data:{...a,format:{contentGravity:s}}})},[]),t=y.useCallback((n,s)=>{var o;let a=(o=J.blocks[n])==null?void 0:o.data;a||(a={}),_e(n,{data:{...a,format:{captionGravity:s}}})},[]);return{alignBlock:e,alignBlockCaption:t}},u7="ALIGIN_IMAGE",yC=e=>{localStorage.setItem(u7,e)},nfe=()=>{var e;return(e=localStorage.getItem(u7))!=null?e:m.ContentGravity.CENTER},cF=e=>{var l,c;const t=ye(e.blockIds[0],["data"],["display","format"]),n=Oe(),{alignBlock:s,alignBlockCaption:a}=tfe(),o=(c=(l=t==null?void 0:t.data.format)==null?void 0:l.isShowCaption)!=null?c:!0,i=y.useMemo(()=>{const d=[{type:H.OPERATION,data:{title:"左对齐",rightText:"L",onClick:()=>{var u;me.event(e.isCaption?"caption_align":"block_align",{align_type:"left",block_name:e.isCaption?void 0:No((u=t==null?void 0:t.uuid)!=null?u:"")}),yC(m.ContentGravity.LEFT),n(()=>{e.blockIds.forEach(f=>{e.isCaption||s(f,m.ContentGravity.LEFT),a(f,m.ContentGravity.LEFT)}),e.closeModal()})}}},{type:H.OPERATION,data:{title:"居中对齐",rightText:"C",onClick:()=>{var u;me.event(e.isCaption?"caption_align":"block_align",{align_type:"center",block_name:e.isCaption?void 0:No((u=t==null?void 0:t.uuid)!=null?u:"")}),n(()=>{yC(m.ContentGravity.CENTER),e.blockIds.forEach(f=>{e.isCaption||s(f,m.ContentGravity.CENTER),a(f,m.ContentGravity.CENTER)}),e.closeModal()})}}},{type:H.OPERATION,data:{title:"右对齐",rightText:"R",onClick:()=>{var u;me.event(e.isCaption?"caption_align":"block_align",{align_type:"right",block_name:e.isCaption?void 0:No((u=t==null?void 0:t.uuid)!=null?u:"")}),n(()=>{yC(m.ContentGravity.RIGHT),e.blockIds.forEach(f=>{e.isCaption||s(f,m.ContentGravity.RIGHT),a(f,m.ContentGravity.RIGHT)}),e.closeModal()})}}}];return e.isCaption&&e.blockIds.length===1&&d.unshift({type:H.TEXT_SWITCH,data:{switch:o,title:"显示说明",onSwitch:u=>{n(()=>{var p,g,_;const f=(p=e.blockIds[0])!=null?p:"",h=(g=J.blocks[f])==null?void 0:g.data;me.event("block_caption",{block_name:No((_=t==null?void 0:t.uuid)!=null?_:""),switch:u?1:0}),_e(f,{data:{...h,format:{isShowCaption:u}}})}),e.closeModal()}}},{type:H.LINE,data:{},disableClick:!0}),d},[e,t==null?void 0:t.uuid,n,a,s,o]);return r.jsx(ze,{className:Ra,items:i,keyDownPriority:dr+1})},Wt=e=>{const{title:t,image:n}=e;return r.jsxs("div",{className:"p-2 bg-grey1 dark:bg-grey6 text-t4-medium text-white rounded w-40",children:[n&&r.jsx("img",{src:"".concat(wo,"/block-description/").concat(n,".png"),alt:t,className:"mb-2 w-full bg-white rounded-sm"}),r.jsx("span",{children:t})]})},Vy={textarea:{type:H.BLOCK_ITEM,data:{type:m.BlockType.TEXTAREA,actionType:Xe.CREATE,icon:"MIcInsertBlockText",title:"正文",context:Wt({title:"主要文本撰写",image:"textarea"}),keywords:["text"]}},todo:{type:H.BLOCK_ITEM,data:{type:m.BlockType.TODO,actionType:Xe.CREATE,icon:"MIcInsertBlockTodo",title:"待办列表",context:Wt({title:"管理待办事项",image:"todo"}),keywords:["todo"]}},subPage:{type:H.BLOCK_ITEM,data:{type:m.BlockType.PAGE,actionType:Xe.CREATE,icon:"MIcInsertBlockPage",title:"页面",context:Wt({title:"当前页面中创建子级页面",image:"page"}),keywords:["page"]}},linkPage:{type:H.BLOCK_ITEM,data:{type:m.BlockType.REFERENCE,actionType:Xe.CREATE,icon:"MIcInsertLinktopage",title:"引用页面",keywords:["linkPage"],context:Wt({title:"引用已有页面/多维表/文件夹",image:"link_page"}),params:{data:{display:"linkPage"}}}},h1:{type:H.BLOCK_ITEM,data:{type:m.BlockType.HEADER,actionType:Xe.CREATE,icon:"MIcInsertBlockH1",quick:"h1",title:"标题1",context:Wt({title:"创建一级标题",image:"h1"}),keywords:["h1","heading1"],params:{data:{level:1}}}},h2:{type:H.BLOCK_ITEM,data:{type:m.BlockType.HEADER,actionType:Xe.CREATE,icon:"MIcInsertBlockH2",title:"标题2",quick:"h2",context:Wt({title:"创建二级标题",image:"h2"}),keywords:["h2","heading2"],params:{data:{level:2}}}},h3:{type:H.BLOCK_ITEM,data:{type:m.BlockType.HEADER,actionType:Xe.CREATE,icon:"MIcInsertBlockH3",title:"标题3",quick:"h3",context:Wt({title:"创建三级标题",image:"h3"}),keywords:["h3","heading3"],params:{data:{level:3}}}},h4:{type:H.BLOCK_ITEM,data:{type:m.BlockType.HEADER,actionType:Xe.CREATE,icon:"MIcInsertBlockH4",title:"标题4",quick:"h4",context:Wt({title:"创建四级标题",image:"h4"}),keywords:["h4","heading4"],params:{data:{level:4}}}},table:{type:H.BLOCK_ITEM,data:{type:m.BlockType.TABLE,actionType:Xe.CREATE,icon:"MIcInsertTable",context:Wt({title:"支持纯文本/行内元素",image:"table"}),title:"简单表格",keywords:["simple table","table"]}},list:{type:H.BLOCK_ITEM,data:{type:m.BlockType.LIST,actionType:Xe.CREATE,icon:"MIcInsertBlockBullrted",title:"项目列表",context:Wt({title:"显示项目符号的列表",image:"list"}),keywords:["list","bulleted list"]}},orderList:{type:H.BLOCK_ITEM,data:{type:m.BlockType.ORDER_LIST,actionType:Xe.CREATE,icon:"MIcInsertBlockNum",title:"编号列表",context:Wt({title:"显示编号的列表",image:"order_list"}),keywords:["numbered list"]}},foldList:{type:H.BLOCK_ITEM,data:{type:m.BlockType.FOLD_LIST,actionType:Xe.CREATE,icon:"MIcInsertBlockToggle",title:"折叠列表",context:Wt({title:"可折叠隐藏/展开显示",image:"fold_list"}),keywords:["toggle list"]}},divider:{type:H.BLOCK_ITEM,data:{type:m.BlockType.DIVIDER,actionType:Xe.CREATE,icon:"MIcInsertDivider",title:"分割线",context:Wt({title:"进行区域划分",image:"divider"}),keywords:["divider"]}},quote:{type:H.BLOCK_ITEM,data:{type:m.BlockType.QUOTE,actionType:Xe.CREATE,icon:"MIcInsertQuote",title:"引述文字",context:Wt({title:"可批量移入块",image:"quote"}),keywords:["quote"]}},mark:{type:H.BLOCK_ITEM,data:{type:m.BlockType.MARK,actionType:Xe.CREATE,icon:"MIcInsertCallout",title:"着重文字",py:"zhuozhongwenzi",context:Wt({title:"可更换emoji/批量移入块",image:"mark"}),keywords:["call out mark"]}},code:{type:H.BLOCK_ITEM,data:{type:m.BlockType.CODE,actionType:Xe.CREATE,icon:"MIcInsertBlockCode",title:"代码片段",context:Wt({title:"创建代码片段块",image:"code"}),keywords:["code block"],params:{local:!0,data:{format:{language:mg()||Lm}}}}},equation:{type:H.BLOCK_ITEM,data:{type:m.BlockType.EQUATION,actionType:Xe.CREATE,icon:"MIcInsertEquation",title:"数学公式",context:Wt({title:"LaTex数学公式块",image:"equation"}),keywords:["math equation latex"],params:{local:!0}}},mindMap:{type:H.BLOCK_ITEM,data:{type:m.BlockType.MIND_MAPPING,actionType:Xe.CREATE,icon:"MIcInsertMindMap",title:"思维导图",context:Wt({title:"创建思维导图",image:"mind-map"}),keywords:["embed mindmap brainmap naotu nt"],params:{local:!0}}},mindMapPage:{type:H.BLOCK_ITEM,data:{type:m.BlockType.MIND_MAPPING_PAGE,actionType:Xe.CREATE,icon:"MIcInsertMindMap",title:"思维导图页面",context:Wt({title:"创建思维导图页面",image:"mind-map"}),keywords:["mindmap brainmap naotu nt"],params:{local:!0}}},toggleHeader1:{type:H.BLOCK_ITEM,data:{type:m.BlockType.TOGGLE_HEADER,actionType:Xe.CREATE,icon:"MIcInsertBlockToggleH1",title:"折叠标题1",context:Wt({title:"创建折叠标题1",image:"toggle-h1"}),keywords:["toggle heading h1"],params:{data:{level:1}}}},toggleHeader2:{type:H.BLOCK_ITEM,data:{type:m.BlockType.TOGGLE_HEADER,actionType:Xe.CREATE,icon:"MIcInsertBlockToggleH2",title:"折叠标题2",context:Wt({title:"创建折叠标题2",image:"toggle-h2"}),keywords:["toggle heading h2"],params:{data:{level:2}}}},toggleHeader3:{type:H.BLOCK_ITEM,data:{type:m.BlockType.TOGGLE_HEADER,actionType:Xe.CREATE,icon:"MIcInsertBlockToggleH3",title:"折叠标题3",context:Wt({title:"创建折叠标题3",image:"toggle-h3"}),keywords:["toggle heading h3"],params:{data:{level:3}}}},toggleHeader4:{type:H.BLOCK_ITEM,data:{type:m.BlockType.TOGGLE_HEADER,actionType:Xe.CREATE,icon:"MIcInsertBlockToggleH4",title:"折叠标题4",context:Wt({title:"创建折叠标题4",image:"toggle-h4"}),keywords:["toggle heading h4"],params:{data:{level:4}}}}};Br(Vy);const f7=e=>{const t={writing:{type:H.BLOCK_ITEM,data:{actionType:Xe.AI_EDITOR,icon:"IcAiFill",iconClassName:"text-[#A34DD9]",title:pm,keywords:["Ask AI to write..."]}},brainstorm:{type:H.BLOCK_ITEM,data:{aiEditType:we.Brainstorm,actionType:Xe.AI_EDITOR,icon:"IcEdit",title:"头脑风暴",keywords:["brainstorm ideas"]}},blog:{type:H.BLOCK_ITEM,data:{aiEditType:we.Blog,actionType:Xe.AI_EDITOR,icon:"IcEdit",title:"博客文章",keywords:["blog posts"]}},more:{type:H.OPERATION,data:{actionType:Xe.AI_EDITOR,icon:"IcMore",title:"更多",keywords:["more"],hasArrow:!0,renderSubMenu:()=>r.jsx(zA,{})}}},n={writing:{type:H.BLOCK_ITEM,data:{actionType:Xe.AI_EDITOR,icon:"IcAiFill",iconClassName:"text-[#A34DD9]",title:pm,keywords:["Ask AI to write..."]}},continueWriting:{type:H.BLOCK_ITEM,data:{aiEditType:we.ContinueWrite,actionType:Xe.AI_EDITOR,icon:"IcEdit",title:"继续写作",keywords:["Continue writing"]}},translate:{type:H.OPERATION,data:{actionType:Xe.AI_EDITOR,icon:"IcTranslate",title:"翻译",keywords:["Translate"],hasArrow:!0,renderSubMenu:()=>r.jsx(Zue,{})},attribute:{"data-prevent-event":!0}},more:{type:H.OPERATION,data:{actionType:Xe.AI_EDITOR,icon:"IcMore",title:"更多",keywords:["more"],hasArrow:!0,renderSubMenu:()=>r.jsx(zA,{hasContent:!0})},attribute:{"data-prevent-event":!0}}},s={template:{type:H.BLOCK_ITEM,data:{type:m.BlockType.TEMPLATE,actionType:Xe.CREATE,icon:"MIcInsertBlockTemplateButton",title:"模板按钮",py:"mubananniu",context:Wt({title:"快速创建常用块副本",image:"template"}),keywords:["template button"]}},sync:{type:H.BLOCK_ITEM,data:{type:m.BlockType.SYNC_CONTAINER,actionType:Xe.CREATE,icon:"MIcInsertSyncedBlock",title:"同步块",context:Wt({title:"跨页面同步块内容",image:"sync"}),keywords:["sync"]}},ad:{type:H.BLOCK_ITEM,isHidden:!1,data:{type:m.BlockType.AD,actionType:Xe.CREATE,icon:"MIcInsertSyncedBlock",title:"广告块",keywords:["ad"]}},chart:{type:H.BLOCK_ITEM,isHidden:!Hee,data:{type:m.BlockType.CHART,actionType:Xe.CREATE,icon:"IcChartLine",title:"数据图表",keywords:["chart"],params:{data:{segments:ht("图表")},local:!0}}}},a={};Object.keys(Vy).forEach(d=>{if(!["divider","linkPage","table","mindMapPage"].includes(d)){const u=Vy[d];a[d]={...u,data:{...u.data,actionType:Xe.TURN_INTO}}}});const[o,i]=H0.map(d=>d.items.map(u=>{const f=d.title==="文字颜色";return{type:H.BLOCK_ITEM,data:{actionType:Xe.COLOR,...f?{textColor:u.colorkey||"default"}:{backgroundColor:u.colorkey||"default"},title:u.desc,keywords:[u.colorkey?"".concat(f?"":"bg ").concat(u.colorkey.split("_")[0]):"default",u.colorkey?"".concat(f?"":"background ").concat(u.colorkey.split("_")[0]):"default"],params:{...f?{backgroundColor:"",textColor:u.colorkey||""}:{backgroundColor:u.colorkey||"",textColor:""}}}}})),l={type:H.BLOCK_ITEM,data:{actionType:Xe.COLOR,title:"上次使用颜色"}},c={aiAssistantWithEmptyDoc:t,aiAssistantWithNotEmptyDoc:n,basicBlock:Vy,media:{image:{type:H.BLOCK_ITEM,data:{type:m.BlockType.FILE,actionType:Xe.CREATE,icon:"MIcInsertBlockImage",title:"图片",context:Wt({title:"上传或插入图片链接",image:"image"}),keywords:["image","picture"],params:{data:{display:"image",format:{contentGravity:nfe()}},local:!0}}},bookmark:{type:H.BLOCK_ITEM,data:{type:m.BlockType.BOOKMARK,actionType:Xe.CREATE,icon:"MIcInsertBlockBookmark",title:"网页书签",context:Wt({title:"书签形式插入在线网页",image:"bookmark"}),keywords:["web bookmark"],params:{local:!0}}},video:{type:H.BLOCK_ITEM,data:{type:m.BlockType.FILE,actionType:Xe.CREATE,icon:"MIcInsertBlockVideo",title:"视频",context:Wt({title:"上传或插入视频链接",image:"video"}),keywords:["video"],params:{data:{display:"video"},local:!0}}},audio:{type:H.BLOCK_ITEM,data:{type:m.BlockType.FILE,actionType:Xe.CREATE,icon:"MIcInsertBlockAudio",title:"音频",context:Wt({title:"上传或插入音频链接",image:"audio"}),keywords:["audio"],params:{data:{display:"audio"},local:!0}}},file:{type:H.BLOCK_ITEM,data:{type:m.BlockType.FILE,actionType:Xe.CREATE,icon:"MIcInsertBlockFile",title:"文件",context:Wt({title:"上传或插入文件链接",image:"file"}),keywords:["file"],params:{local:!0,data:{display:"file"}}}},folder:{type:H.BLOCK_ITEM,data:{type:m.BlockType.FOLDER,actionType:Xe.CREATE,icon:"MIcInsertBlockFolder",title:"文件夹",context:Wt({title:"当前页面中创建子级文件夹页面",image:"folder"}),keywords:["folder"],params:{local:!0}}}},inlineElement:{date:{type:H.BLOCK_ITEM,data:{actionType:Xe.CREATE,type:ma.DATE,icon:"MIcInsertBlockDate",title:"行内日期",isInline:!0,context:Wt({title:"插入行内日期",image:"inline_date"}),keywords:["inline date inline time"]}},link_page:{type:H.BLOCK_ITEM,data:{actionType:Xe.CREATE,type:ma.LINK_PAGE,icon:"MIcInsertPageInline",title:"行内引用页面",isInline:!0,context:Wt({title:"行内形式引用已有页面",image:"inline_link_page"}),keywords:["inline linkPage"]}},page:{type:H.BLOCK_ITEM,data:{actionType:Xe.CREATE,type:ma.PAGE,icon:"MIcInsertSubpage",title:"行内页面",isInline:!0,context:Wt({title:"行内形式页面",image:"inline_page"}),keywords:["inline page","hangneiyemian","hnym","hnys hnym","hnys inline Page"]}},equation:{type:H.BLOCK_ITEM,data:{actionType:Xe.CREATE,type:ma.EQUATION,icon:"MIcInlineEquation",title:"行内公式",isInline:!0,context:Wt({title:"行内形式插入公式",image:"inline_equation"}),keywords:["inline equation"]}},person:{type:H.BLOCK_ITEM,data:{actionType:Xe.CREATE,type:ma.PEOPLE,icon:"MIcMentionPerson",title:"人员",isInline:!0,context:Wt({title:"提及空间内成员",image:"inline_person"}),keywords:["inline person"]}},emoji:{type:H.BLOCK_ITEM,data:{actionType:Xe.CREATE,type:ma.EMOJI,image:new URL("".concat(wo,"/embeds/").concat(e?"dark":"light","/ic_insert_emoji.png"),import.meta.url).href,title:"Emoji",isInline:!0,context:Wt({title:"插入行内 Emoji",image:"inline_emoji"}),keywords:["inline emoji"]}}},database:{embedBitable:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Xe.CREATE,icon:"MIcInsertDatabase",title:"表格",context:Wt({title:"嵌入表格视图多维表",image:"embed_bitable"}),keywords:["database","table"],tableType:m.CollectionViewType.TABLE}},bitablePage:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Xe.CREATE,icon:"MIcInsertBlockDatabase",title:"表格页面",context:Wt({title:"插入表格视图多维表子页面",image:"bitable_page"}),keywords:["database page","table page"],tableType:m.CollectionViewType.TABLE}},embedBitableBoard:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Xe.CREATE,icon:"MIcInsertBoard",title:"看板",context:Wt({title:"嵌入看板视图多维表",image:"embed_bitable_board"}),keywords:["database board","database board"],tableType:m.CollectionViewType.BOARD}},bitableBoardPage:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Xe.CREATE,icon:"MIcInsertBlockBoard",title:"看板页面",context:Wt({title:"插入看板视图多维表子页面",image:"bitable_board_page"}),keywords:["database board page","database board page"],tableType:m.CollectionViewType.BOARD}},embedBitableGallery:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Xe.CREATE,icon:"MIcInsertGallery",title:"画廊",context:Wt({title:"嵌入画廊视图多维表",image:"embed_bitable_gallery"}),keywords:["database gallery","database gallery"],tableType:m.CollectionViewType.GALLERY}},bitableGalleryPage:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Xe.CREATE,icon:"MIcInsertBlockGallery",title:"画廊页面",context:Wt({title:"插入画廊视图多维表子页面",image:"bitable_gallery_page"}),keywords:["database gallery page","database gallery page"],tableType:m.CollectionViewType.GALLERY}},embedBitableList:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Xe.CREATE,icon:"MIcInsertList",title:"目录",context:Wt({title:"嵌入目录视图多维表",image:"embed_bitable_list"}),keywords:["database list","database list"],tableType:m.CollectionViewType.LIST}},bitableListPage:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Xe.CREATE,icon:"MIcInsertBlockList",title:"目录页面",context:Wt({title:"插入目录视图多维表子页面",image:"bitable_list_page"}),keywords:["database list page","database list page"],tableType:m.CollectionViewType.LIST}},embedBitableTimeline:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Xe.CREATE,icon:"MIcInsertTimeline",title:"时间轴",context:Wt({title:"嵌入时间轴视图多维表",image:"embed_bitable_timeline"}),keywords:["database timeline","database timeline"],tableType:m.CollectionViewType.TIMELINE}},bitableTimelinePage:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Xe.CREATE,icon:"MIcInsertBlockTimeline",title:"时间轴页面",context:Wt({title:"插入时间轴视图多维表子页面",image:"bitable_timeline_page"}),keywords:["database timeline page","database timeline page"],tableType:m.CollectionViewType.TIMELINE}},embedBitableForm:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Xe.CREATE,icon:"MIcInsertBlockForm",title:"收集表",context:Wt({title:"嵌入收集表视图多维表",image:"embed_bitable_form"}),keywords:["database form","database form"],tableType:m.CollectionViewType.FORM}},bitableFormPage:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Xe.CREATE,icon:"MIcInsertForm",title:"收集表页面",context:Wt({title:"插入收集表视图多维表子页面",image:"bitable_form_page"}),keywords:["database form page","database form page"],tableType:m.CollectionViewType.FORM}},embedBitableCalendar:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Xe.CREATE,icon:"MIcInsertCalendar",title:"日历",context:Wt({title:"嵌入日历视图多维表",image:"embed_bitable_calendar"}),keywords:["database calendar","database calendar"],tableType:m.CollectionViewType.CALENDAR}},bitableCalendarPage:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Xe.CREATE,icon:"MIcInsertBlockCalendar",title:"日历页面",context:Wt({title:"插入日历视图多维表子页面",image:"bitable_calendar_page"}),keywords:["database calendar page","database calendar page"],tableType:m.CollectionViewType.CALENDAR}},linkBitable:{type:H.BLOCK_ITEM,data:{type:m.BlockType.REFERENCE_COLLECTION,actionType:Xe.CREATE,icon:"MIcInsertPageInline",title:"引用多维表",context:Wt({title:"嵌入已有多维表",image:"link_bitable"}),keywords:["linked database","link table"]}}},embed:{webpage:{type:H.BLOCK_ITEM,data:{type:m.BlockType.EMBED,actionType:Xe.CREATE,icon:"MIcInsertBlockWeb",title:"嵌入网页",context:Wt({title:"直接嵌入在线网页",image:"embed_webpage"}),keywords:["embed web iframe"],params:{data:{embedType:$r.webpage},local:!0}}},file:{type:H.BLOCK_ITEM,data:{type:m.BlockType.FILE,actionType:Xe.CREATE,icon:"MIcInsertPdf",title:"嵌入文件",context:Wt({title:"直接嵌入可预览文件",image:"embed_file"}),keywords:["embed file"],params:{data:{display:"file",viewMode:fr.preview},local:!0}}},folder:{type:H.BLOCK_ITEM,data:{type:m.BlockType.FOLDER,actionType:Xe.CREATE,icon:"MIcInsertFolder",title:"嵌入文件夹",context:Wt({title:"直接嵌入可预览文件夹",image:"embed_folder"}),keywords:["embed folder"],params:{data:{viewMode:fr.preview},local:!0}}},...aj()},advanced:s,layout:{leftColumn:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLUMN_LIST,actionType:Xe.CREATE,icon:"MIcInsertBlockLeft",title:"在左侧插入分栏",params:{left:!0}}},rightColumn:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLUMN_LIST,actionType:Xe.CREATE,icon:"MIcInsertBlockRight",title:"在右侧插入分栏",params:{left:!1}}},twoColumn:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLUMN_LIST,actionType:Xe.CREATE,icon:"MIcInsertDownTwo",quick:"2",title:"两列分栏",params:{columnCount:2}}},threeColumn:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLUMN_LIST,actionType:Xe.CREATE,icon:"MIcInsertDownThree",quick:"3",title:"三列分栏",params:{columnCount:3}}},fourColumn:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLUMN_LIST,actionType:Xe.CREATE,icon:"MIcInsertDownFour",quick:"4",title:"四列分栏",params:{columnCount:4}}},fiveColumn:{type:H.BLOCK_ITEM,data:{type:m.BlockType.COLUMN_LIST,actionType:Xe.CREATE,icon:"MIcInsertDownFive",quick:"5",title:"五列分栏",params:{columnCount:5}}}},turninto:a,action:{delete:{type:H.BLOCK_ITEM,data:{actionType:Xe.DELETE,icon:"IcTrash",keywords:["delete"],title:"删除",iconSize:"small"}},copy:{type:H.BLOCK_ITEM,data:{actionType:Xe.COPY,icon:"IcDuplicate",keywords:["copy"],title:"拷贝副本",iconSize:"small"}},moveTo:{type:H.BLOCK_ITEM,data:{actionType:Xe.MOVETO,icon:"IcMove",keywords:["move"],title:"移动到",iconSize:"small"}}},lastUsedColor:{lastUsedColor:l},color:o,colorBackground:i};return kS(c,(d,u)=>{kS(d,f=>{var h,p;f.data.initials=(h=f.data.initials)!=null?h:f0(f.data.title),f.data.py=(p=f.data.py)!=null?p:dd(f.data.title),f.data.category=Qi[u]})}),c},sfe=qv(f7),rfe=qv(e=>{const t=f7(e);return ka(t).forEach(n=>{const s=t[n],a=Qi[n],o=f5[n];ka(s).forEach(i=>{const l=t[n][i];l!=null&&l.data&&(t[n][i].data.keywords=[...new Set([l.data.quick,l.data.initials,...l.data.keywords||[],l.data.py,l.data.title,"".concat(o.initials," ").concat(l.data.initials),...(l.data.keywords||[]).map(c=>"".concat(o.initials," ").concat(c))])].filter(Boolean),t[n][i].data.thesaurus=["".concat(n," ").concat(l.data.title),"".concat(n," ").concat(l.data.quick),n,...l.data.keywords||[],o.pinyin,"".concat(a," ").concat(l.data.title),"".concat(a," ").concat(l.data.quick)].map(c=>id(c)))})}),t}),afe=()=>{const e=Xo();return rfe(e)},oj=()=>{const e=Xo();return sfe(e)},bC={},ij=(e,t)=>{const n="".concat(e,"-").concat(t==null?void 0:t.level,"-").concat(t==null?void 0:t.display);if(bC[n])return bC[n];if(e===void 0)return;let s;const a=oj();return jo(a).some(o=>{o=jo(o);const i=o.findIndex(c=>{var d,u,f,h;return!!(c.data.type===e&&(e!==m.BlockType.HEADER&&e!==m.BlockType.FILE&&e!==m.BlockType.TOGGLE_HEADER||t!=null&&t.level&&t.level===((u=(d=c.data.params)==null?void 0:d.data)==null?void 0:u.level)||t!=null&&t.display&&t.display===((h=(f=c.data.params)==null?void 0:f.data)==null?void 0:h.display)))}),l=o[i];return l?(s=l.data,!0):!1}),bC[n]=s,s},No=e=>{var o,i;const t=pe().blocks[e],n=oj();if(!t)return"";switch(t.type){case m.BlockType.REFERENCE:return t.data.display==="linkPage"?n.basicBlock.linkPage.data.title:"引用块";case m.BlockType.FILE:switch(t.data.display){case"audio":return n.media.audio.data.title;case"video":return n.media.video.data.title;case"image":return n.media.image.data.title;case"file":return t.data.viewMode===fr.preview?n.embed.file.data.title:n.media.file.data.title;default:return""}case m.BlockType.HEADER:return"标题".concat((o=t.data.level)!=null?o:1);case m.BlockType.TOGGLE_HEADER:return"折叠标题".concat((i=t.data.level)!=null?i:1);case m.BlockType.CHART:return"图表"}const s=[n.basicBlock,n.media,n.database,n.embed,n.advanced];let a;for(const l of s)if(a=ofe(t,l),a)return a;return t.type===m.BlockType.SYNC_REFERENCE?"影子同步块":t.type===m.BlockType.COLUMN_LIST||t.type===m.BlockType.COLUMN?"分栏":""},ofe=(e,t)=>{for(const[n,s]of Object.entries(t))if(e.type===s.data.type)return s.data.title;return""},ty=(e,t)=>({type:H.BLOCK_TEXT,data:{title:e,py:dd(e),initials:f0(e),...t}}),WT=e=>{var o;const[t,n]=y.useState(!1),s=y.useMemo(()=>r.jsx("div",{className:R("next-modal min-w-[160px] py-1",e.optionClassName),children:e.options.map((i,l)=>r.jsx(ife,{selected:e.selectedIndex===l,...i,onClick:()=>{n(!1),e.onSelect(i,l)}},i.id))}),[e]),a=y.useCallback(i=>{n(i)},[]);return r.jsxs("div",{className:R("flex h-10 items-center justify-between",e.disable?"opacity-30":"",e.className),children:[r.jsx("span",{className:"text-t2 flex-shrink-0",children:e.name}),r.jsx(h0,{disable:e.disable,visible:t,onChange:a,content:s,children:r.jsxs("div",{className:R("ml-2 flex items-center text-ellipsis",e.disable?"":"cursor-pointer"),children:[r.jsx("span",{className:"text-t2 mr-2 text-ellipsis text-grey3",children:(o=e.options[e.selectedIndex])==null?void 0:o.name}),r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall"})]})})]})},ife=e=>r.jsxs("div",{className:"flex justify-between items-center px-4 h-9 text-t2 cursor-pointer",onClick:e.onClick,children:[r.jsx("div",{children:e.name}),e.selected&&r.jsx(V,{size:"normal",name:"IcCheck02"})]}),lfe=e=>e<10?Number("200".concat(String(e))):e<100&&e>=10?Number("20".concat(String(e))):e,KT=(e,t=Et)=>{if(t===Et){const s=e.replaceAll("-","/").split("/").map(l=>parseInt(l,10)),a=s[0],o=s[1],i=s[2]&&isNaN(s[2])?1:s[2];if(i||i===0){const l=new Date(lfe(a),o-1,i),c=o-1;return isNaN(l.getTime())||l.getDate()!==i||l.getMonth()!==c?void 0:ue(l).format(t)}}return e},qA=e=>!isNaN(new Date(ue().format(Et).concat(" ",e)).getTime()),YT=["h:mm","H:mm","hh:mm","HH:mm"];YT.push(...YT.map(e=>e.concat(" A")));const cfe=e=>{const{includeTime:t,date:n,dateFormat:s,timeFormat:a,autoFocus:o,onChange:i}=e,l=s===m.DateFormat.LL||s===m.DateFormat.RELATIVE,{dateStr:c,timeStr:d}=y.useMemo(()=>{const A=ue(n);return{dateStr:A.format(l?Et:s),timeStr:A.format(a)}},[n,s,l,a]),[u,f]=y.useState(c),[h,p]=y.useState(d),g=y.useRef(!1),_=y.useRef(),x=y.useRef(),F=y.useRef(),b=y.useRef(),w=y.useRef(),[E,C]=y.useState(!1),[k,T]=y.useState(!1),[v,I]=y.useState(!1),j=!k||!v,S=y.useRef();S.current=i,y.useEffect(()=>{f(c)},[n,c]),y.useEffect(()=>{p(d)},[n,d]),y.useEffect(()=>{T(!0),I(!0)},[n]);const D=y.useCallback(()=>{var U,z;const A=l?Et:s;let P=b.current.value.trim();P=P.replaceAll("-","/"),P=(U=KT(P))!=null?U:P;const L=US(P,A);if(T(L),!L)return!1;let O="",$;if(t){const K=w.current.value.trim();for(const Y of YT)if(US(K,Y)){$=Y;break}const W=!!$;if(I(W),O=K,!W)return!1}let M;if(t)M=ue("".concat(P," ").concat(O),"".concat(A," ").concat($)).toDate();else if(M=ue(P,A).toDate(),c===P)return;return(z=S.current)==null||z.call(S,M),!0},[s,c,t,l]);return y.useEffect(()=>()=>{g.current&&D()},[]),y.useEffect(()=>{const A=P=>{if(Ie("enter")(P)&&!D())return!0};return Ht.addEventListener("keydown",A,iw+1,!0),()=>{Ht.removeEventListener("keydown",A,!0)}},[D]),y.useEffect(()=>{if(!o)return;const A=setTimeout(()=>{clearTimeout(A),b.current.focus()})},[o]),y.useEffect(()=>{const A=[];return k||A.push(tu(_.current,x.current,{placement:"left",modifiers:[{name:"offset",options:{offset:[0,6]}}]})),v||A.push(tu(_.current,F.current,{placement:"right",modifiers:[{name:"offset",options:{offset:[0,6]}}]})),()=>{A.forEach(P=>P.destroy())}},[k,v]),r.jsxs("div",{className:"flex flex-col px-2.5",children:[r.jsxs("div",{ref:_,className:R("flex bg-grey9 border-grey6 rounded-sm py-[6px] h-8",{"input-error":j,"input-focus":E&&!j}),children:[r.jsx(Ct,{inputRef:b,showBorder:!1,className:"border-none ".concat(t?"w-1/2":"w-full"),style:{backgroundColor:"transparent"},value:u,onChange:f,onFocus:()=>C(!0),onEnter:D,onBlur:()=>{C(!1),D()}}),t&&r.jsx(Ct,{inputRef:w,showBorder:!1,className:"w-1/2 px-3 border-none rounded-none border-grey6",style:{borderLeft:"1px solid #E5E5E5",backgroundColor:"transparent"},onFocus:()=>C(!0),onEnter:D,onBlur:()=>{C(!1),D()},onChange:A=>{g.current=!0,p(A)},value:h})]}),!k&&r.jsx("div",{ref:x,className:"px-2 py-1 text-white bg-black rounded-sm bg-opacity-70 text-t4",children:r.jsx("span",{children:"无效日期"})}),!v&&r.jsx("div",{ref:F,className:"px-2 py-1 text-white bg-black rounded-sm bg-opacity-70 text-t4",children:r.jsx("span",{children:"无效时间"})})]})},m7=[{name:"无",value:0,time:""},{name:"当天(上午9:00)",value:0,time:"09:00",unit:"day"},{name:"提前1天(上午9:00)",value:1,time:"09:00",unit:"day"},{name:"提前2天(上午9:00)",value:2,time:"09:00",unit:"day"},{name:"提前1周(上午9:00)",value:7,time:"09:00",unit:"day"}],h7=[{name:"无",value:0},{name:"当时",value:0,unit:"minute"},{name:"提前5分钟",value:5,unit:"minute"},{name:"提前10分钟",value:10,unit:"minute"},{name:"提前15分钟",value:15,unit:"minute"},{name:"提前30分钟",value:30,unit:"minute"},{name:"提前1小时",value:1,unit:"hour"},{name:"提前2小时",value:2,unit:"hour"},{name:"提前1天",value:1,unit:"day"},{name:"提前2天",value:2,unit:"day"},{name:"提前1周",value:7,unit:"day"}],dfe=(e,t)=>{if(!e)return 0;const n=t?h7:m7;let s=n.findIndex(a=>a.value===e.value&&a.unit===e.unit);return s!==-1?s:e.unit==="minute"||e.unit==="hour"?1:(s=n.findIndex(a=>e.unit===a.unit&&e.value===a.value),s!==-1?s:0)},ufe=e=>e==="LL"||e==="YYYY/MM/DD"||e==="DD/MM/YYYY"||e==="MM/DD/YYYY"||e==="relative"?e:m.DateFormat.YYYY_MM_DD,GA=[{id:m.DateFormat.LL,name:"完整日期"},{id:m.DateFormat.YYYY_MM_DD,name:"年/月/日"},{id:m.DateFormat.DD_MM_YYYY,name:"日/月/年"},{id:m.DateFormat.MM_DD_YYYY,name:"月/日/年"},{id:m.DateFormat.RELATIVE,name:"相对日期"}],WA=[{id:m.TimeFormat.H_MM_A,name:"12 小时"},{id:m.TimeFormat.H_MM,name:"24 小时"}],ffe=e=>{const t=y.useMemo(()=>GA.findIndex(s=>s.id===e.dateFormat),[e.dateFormat]),n=y.useMemo(()=>WA.findIndex(s=>s.id===e.timeFormat),[e.timeFormat]);return r.jsxs("div",{className:"next-modal px-4 py-1 w-[250px]",children:[r.jsx(WT,{name:"日期格式",selectedIndex:t,options:GA,onSelect:s=>{e.onSelectDateFormat(s.id)}}),r.jsx(WT,{name:"时间格式",disable:e.disableTimeFormat,selectedIndex:n,options:WA,onSelect:s=>{e.onSelectTimeFormat(s.id)}})]})},mfe=e=>{const t=ie(),n=Dt(),s=ai(),a=e.userPermissions.reduce((l,c)=>{var d;if(c.userId&&c.type===m.PermissionType.USER){const u=Rn(c.userId);u&&(l&&(l+=","),l+=u)}else if(c.type===m.PermissionType.GROUP){const u=(d=n.permissionGroups)==null?void 0:d.find(f=>f.id===c.groupId);u&&(l&&(l+=","),l+=u.name)}else l&&(l+=","),l+="全体成员";return l},""),o=e.userPermissions.map(l=>{var d,u,f;const c=l.type===m.PermissionType.USER;return{type:m.TextType.USER,permissionType:l.type,uuid:c?l.userId:l.groupId,text:c?Rn((d=l.userId)!=null?d:""):(f=(u=n.permissionGroups)==null?void 0:u.find(h=>h.id===l.groupId))==null?void 0:f.name,enhancer:{}}}),i=l=>{t.dropdown({popcorn:l.currentTarget,placement:"right",content:c=>r.jsx(hfe,{defaultValue:o,onUpdate:d=>{d||(d=[]);const u=d.map(f=>({type:f.permissionType,userId:f.permissionType===m.PermissionType.USER?f.uuid:"",groupId:f.permissionType===m.PermissionType.GROUP?f.uuid:""}));e.onSelect(u)},onCloseModal:c.onCloseModal})})};return r.jsxs("div",{className:R("flex items-center h-10 my-1 px-4 justify-between",{"opacity-30":s}),children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{name:"IcMenuPerson",size:"middle"}),r.jsx("span",{className:"text-t2 ml-2",children:"提醒成员"})]}),r.jsxs("div",{className:"flex items-center cursor-pointer",onClick:s?void 0:i,children:[r.jsx("span",{className:"text-t2 ml-2 mr-2 text-ellipsis text-grey3 max-w-[136px]",children:a||"无"}),r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall"})]})]})},hfe=({defaultValue:e,onUpdate:t,onCloseModal:n})=>{const[s,a]=y.useState(e);return r.jsx("div",{className:"next-modal",children:r.jsx(TE,{value:s,onClose:()=>n(),onUpdate:o=>{a(o),t(o)}})})};const pfe=({onPreviousClick:e,onNextClick:t})=>r.jsxs("div",{className:"absolute right-4 flex justify-between top-5",children:[r.jsx(Fe,{className:"mr-2 rounded-sm animate-hover",children:r.jsx(V,{name:"IcArrowDateBack",size:"middle",onClick:()=>e()})}),r.jsx(Fe,{className:"rounded-sm animate-hover",children:r.jsx(V,{name:"IcArrowDateNext",size:"middle",onClick:()=>t()})})]}),gfe=({date:e})=>r.jsx("div",{className:"table-caption mt-2.5 h-10",children:r.jsx("span",{className:"flex items-center h-full text-black text-t2-bold",children:ue(e).format("YYYY年MM月")})}),J0=e=>{var j,S,D,A;const{dateInfo:t,onClear:n,closeDatePicker:s,uiOption:a={}}=e,[o,i]=y.useState(!1),l=Js(),{includeTime:c=!0,reminder:d}=t,{hasSwitchTimeOption:u=!0,hasEndTime:f=!1,noShadow:h=!1,hasFormatSetting:p=!0,hasRemind:g=!1}=a,{timeFormat:_=m.TimeFormat.H_MM}=t;let{dateFormat:x=m.DateFormat.YYYY_MM_DD}=t;x=ufe(x);const F=ai(),b=We(),w=X3();y.useEffect(()=>{const P=L=>{Ie("enter")(L)&&(s==null||s())};return Ht.addEventListener("keydown",P,iw,!0),()=>{Ht.removeEventListener("keydown",P,!0)}},[s]);const E=!!d;y.useEffect(()=>{E&&!F&&!b&&O0(Ot())},[E,F,b]);const C=y.useCallback(P=>{e.onChange({...t,...P})},[t,e]),k=P=>{const L=ue(t.from);let O;const $=ue(Date.now());P?O=L.hour($.hour()).minute($.minute()).toDate():O=L.hour(0).minute(0).toDate();let M;if(f){const U=ue(t.to);P?M=U.hour(12).minute(0).toDate():M=U.hour(0).minute(0).toDate()}C({from:O,to:M,reminder:void 0,includeTime:P})},T=y.useCallback((P,L,O)=>{if(L.disabled)return;O.stopPropagation();const $=t.from.getHours(),M=t.from.getMinutes(),U=ue(P).hour($).minute(M).toDate();C({from:U,to:void 0}),c||s==null||s()},[s,t.from,c,C]),v=c?h7:m7,I=y.useMemo(()=>dfe(d,c),[c,d]);return r.jsxs("div",{className:R("w-72 bg-white2 pt-2.5 pb-[5px]",{"next-modal":!h}),children:[r.jsx(cfe,{date:t.from,dateFormat:x,timeFormat:_,includeTime:c,autoFocus:!0,onChange:P=>{var M,U;const L=v[I],O=[{userId:yt.uuid,type:m.PermissionType.USER}],$=(U=(M=t.reminder)==null?void 0:M.userPermissions)!=null?U:O;if(!E){C({from:P});return}if(c){const z=ue(P).format(co);C({from:P,reminder:{...kn(L,"name"),time:z,userPermissions:$}})}}}),r.jsx(gL,{className:"flex justify-center w-full",fixedWeeks:!0,disabledDays:(j=e.uiOption)==null?void 0:j.disabledDays,selectedDays:t.from,firstDayOfWeek:w===m.DaySetting.MON?1:0,navbarElement:pfe,captionElement:gfe,locale:"zh-cn",month:t.from,months:C3,onDayClick:T,weekdaysShort:Cu,weekdaysLong:e9}),u&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mx-4 h-px bg-grey6 my-1.5"}),r.jsx("div",{children:r.jsxs("div",{className:"flex items-center my-1 justify-between h-10 px-4",children:[r.jsx("span",{className:"text-t2",children:"时间点"}),r.jsx(en,{open:c,onSwitch:k})]})})]}),g&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mx-4 h-px bg-grey6 my-1.5"}),r.jsx("div",{children:r.jsxs("div",{className:"flex items-center my-1 justify-between h-10 px-4",children:[r.jsx(V,{name:"IcMenuAlarm",size:"middle"}),r.jsx(WT,{name:"提醒",className:"w-full ml-2",selectedIndex:I,options:v.map(P=>({...P,id:P.name})),onSelect:(P,L)=>{var U,z;if(L===0){C({reminder:void 0});return}l(Je.CREATE_DATE_MENTION,ct.basicList,{step2:!0});const O=v[L],$=[{userId:yt.uuid,type:m.PermissionType.USER}],M=(z=(U=t.reminder)==null?void 0:U.userPermissions)!=null?z:$;if(O)if(c){const K=ue(t.from).format(co);C({reminder:{...kn(O,"name"),time:K,userPermissions:M}})}else C({reminder:{...kn(O,"name"),userPermissions:M}})}})]})})]}),g&&I>0&&r.jsx(mfe,{userPermissions:(D=(S=t.reminder)==null?void 0:S.userPermissions)!=null?D:[],onSelect:P=>{C({reminder:{...t.reminder,userPermissions:P}})}}),p&&r.jsx(r.Fragment,{children:r.jsxs(h0,{visible:o,placement:"right",content:r.jsx(ffe,{disableTimeFormat:!c,dateFormat:x,timeFormat:_,onSelectDateFormat:P=>{i(!1),C({dateFormat:P})},onSelectTimeFormat:P=>{i(!1),C({timeFormat:P})}}),children:[r.jsx("div",{className:"h-px bg-grey6 mx-4"}),r.jsx("div",{className:"cursor-pointer",children:r.jsxs("div",{className:"flex items-center h-10 my-1 px-4",children:[r.jsx(V,{name:"IcSettings",size:"middle"}),r.jsx("span",{className:"text-t2 ml-2",children:"日期格式"})]})})]})}),e.onClear&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-px bg-grey6 my-1 mx-4"}),r.jsx("div",{className:"flex items-center h-10 pl-4 cursor-pointer text-t2",onClick:n,children:"清除"})]}),(A=e.uiOption)==null?void 0:A.footer]})},_fe=e=>{var Ae;const{uuid:t,parentPermission:n,spaceId:s,permissionsState:a,readonly:o,isFreeSpaceLimit:i,setBlockPermission:l,removeBlockPermission:c,trackerEvent:d,checkBreakRole:u,setPermission:f,onError:h,openParentRoleLimit:p}=e,{publicRole:g,permissions:_,shared:x,role:F,isRestricted:b,parentId:w,allowShowSidebar:E,password:C,allowDuplicate:k,allowSeo:T,illegal:v,allowDownload:I,allowSubscribe:j,allowSelectionCopy:S,allowShowBreadcrumb:D,accessFee:A,allowShowAIChat:P,linkValidDate:L,openPreview:O,sharePageDistributionRatio:$=0,previewBlockCount:M,accessFeeValidDays:U,originPrice:z}=a,K=w===s,W=F===m.PermissionRole.EDITOR,Y=!(!W||!b&&w),G=!(C||!Y)&&s,ee=v?!1:x,te=g===m.PermissionRole.COMMENTER,Q=_.find(Me=>Me.type===m.PermissionType.PUBLIC),ne={type:m.PermissionType.PUBLIC,role:(Ae=Q==null?void 0:Q.role)!=null?Ae:m.PermissionRole.READER,allowDownload:I,allowDuplicate:k,allowSeo:T,shareShowSidebar:E,allowSubscribe:j,password:C,accessFee:A,allowShowAIChat:P,linkValidDate:L,allowShowBreadcrumb:D,openPreview:O,sharePageDistributionRatio:$,previewBlockCount:M,accessFeeValidDays:U,originPrice:z,allowSelectionCopy:S},se=()=>{h("继承上级页面的设置，不支持单独关闭","parentRoleLimit")},ce=!W||!b&&!K&&n.shared,ae=async()=>{o||!W||(!b&&x&&w?(await u(),d("share_switch",{is_open:!1}),w&&(_.forEach(Me=>f(t,Me)),await l(t,{type:m.PermissionType.RESTRICTED})),await c(t,{type:m.PermissionType.PUBLIC})):(d("share_switch",{is_open:!x}),x?await c(t,{type:m.PermissionType.PUBLIC}):await l(t,{role:m.PermissionRole.READER,type:m.PermissionType.PUBLIC})))},de=async()=>{ce?se():A&&A>0?h("付费分享不可关闭订阅设置","conflict"):Re().setRole("allowSubscribe")},ke=async Me=>{if(W){if(ce){se();return}Q&&x&&(b||!w)&&await l(t,{...ne,linkValidDate:Me})}},Te=async()=>{if(W){if(ce){se();return}Q&&x&&(b||!w)&&await l(t,{...ne,shareShowSidebar:!E})}},he=async()=>{if(i){h("付费空间专享","proLimit");return}if(!W){h("只有编辑者可以设置","roleLimit");return}if(C){h("设置了密码，不能设置SEO","conflict");return}await Ee("allowSeo").then(Me=>{Me&&d("share_seo",{is_open:!T})})};async function Ee(Me,Ge){if(!W)return;const tt=a[Me];if(ce){se();return}return xfe(Me,!tt,d),_.find(kt=>kt.type===m.PermissionType.PUBLIC)&&x&&(b||!w)&&await l(t,{...ne,[Me]:Ge!=null?Ge:!tt}),!0}const ge=async Me=>{await l(t,{...ne,...Me})},Se=async Me=>{if(!W)return;if(!b&&w){se();return}_.find(tt=>tt.type===m.PermissionType.PUBLIC)&&x&&(b||!w)&&await l(t,{...ne,role:Me})},Re=()=>({switchPublicShare:ae,setShareShowSidebar:Te,setShareSeo:he,setRole:Ee,setCommon:Se,setLinkValidTime:ke,setPartialPermission:ge,setAllowSubscribe:de});return{set:Re,defaultSetPermissionValue:ne,permissionsState:a,roleStatus:{isCommenter:te,isEditor:W,canEditor:Y,canSeo:G,isOpenShare:ee,isRestricted:ce},openParentRoleLimit:p}},xfe=(e,t,n)=>{switch(e){case"allowDuplicate":{n("allow_copy",{is_open:t});break}}},df=()=>{const e=ie();return y.useCallback((t,n)=>{var s;e.warning({title:(s=n==null?void 0:n.title)!=null?s:"升级「专业版」可体验完整功能",confirmText:"立即升级",cancelText:"取消",confirm:t})},[e])},lj=e=>{const t=ie(),n=ye(e,[]),s=mt(e,{wait:50}),a=We(e),o=mt(n==null?void 0:n.parentId),i=po(),l=df(),c=()=>{t.warning({title:"修改后将不再继承上级页面的分享及其相关权限，确认修改？",confirm(){s.permissions.forEach(d=>mu(e,d)),dl(e,{type:m.PermissionType.RESTRICTED}),re(Sa())}})};return _fe({uuid:e,parentPermission:o,permissionsState:s,removeBlockPermission:ju,setBlockPermission:dl,setPermission:mu,trackerEvent:me.event,onError:(d,u)=>{if(u==="parentRoleLimit"){c();return}if(u==="proLimit"){l(()=>{xO({defaultMenuType:Kt.upgrade,from:Mt.share_seo})});return}be.error(d)},openParentRoleLimit:c,isFreeSpaceLimit:i,parentId:n==null?void 0:n.parentId,readonly:a,spaceId:n==null?void 0:n.spaceId,checkBreakRole(){return new Promise(()=>{})}})},_l=e=>{const{spanClass:t,absolute:n=!0,className:s,text:a="Pro"}=e;return r.jsx("div",{className:R("flex items-center justify-center px-1 whitespace-nowrap border border-[#FFECAA]",n&&"absolute right-[-4px] top-[-8px]",s),style:{background:iB.yellow,borderRadius:"10px 10px 10px 2px"},onClick:e.onClick,children:r.jsx("span",{className:R("text-t4 text-[#8F6C28]",t),children:a})})},p7=qe(),KA=new Ai(localStorage,"short-url"),YA=new Ai(localStorage,"mini-program"),yfe=async e=>{const t=KA.get(e);if(t)return t;const n=await ve.infra.createShortUrl({url:e});return KA.put(e,n),n},bfe=async e=>{const n="pages/webview/index",s="release",a="".concat(s,"-").concat(n,"-").concat(e),o=YA.get(a);if(o)return o;const i=await ve.infra.createMiniProgramQr({check_path:!0,env_version:s,page:n,scene:e});return YA.put(a,i),i},Ffe=e=>{const{url:t}=e,[n,s]=y.useState(""),a=ln();y.useEffect(()=>{(async()=>{var c,d;const l=await yfe(t);if(l){const u=await bfe("shortId=".concat((d=(c=Xp(l))==null?void 0:c.pathname.replace("/",""))!=null?d:l));s(u)}})()},[t]);const o=()=>{a(p7)},i=()=>{cc(n,"".concat(Date.now(),".jpeg"))};return y.useEffect(()=>{s("")},[]),r.jsxs("div",{className:"next-modal w-96",children:[r.jsx("div",{className:"h-20 flex items-center px-8",children:"小程序分享"}),r.jsx("div",{className:"flex items-center justify-center px-20",children:n?r.jsx("img",{src:n,className:"w-full p-4 bg-white-base rounded-md",alt:"小程序二维码"}):r.jsx(xs,{className:"w-56 h-56"})}),r.jsxs("div",{className:"flex items-center justify-end h-20 px-8",children:[r.jsx(De,{className:"mr-2.5",onClick:()=>o(),children:"取消"}),r.jsx(De,{colorType:"active",onClick:i,children:"下载图片"})]})]})},wfe=()=>{const e=ie();return y.useCallback(t=>{me.event("click_share_btn",{type:"weapp_qr"}),e.modal({modalId:p7,content:()=>r.jsx(Ffe,{...t})})},[e])},Efe=e=>{const{url:t}=e,[n,s]=y.useState(""),a=Ut();return y.useEffect(()=>{(async()=>{const o=await Z_.toDataURL("".concat(t),{errorCorrectionLevel:"H"});s(o)})()},[a.avatar,a.backgroundColor,a.nickname,t]),r.jsx("div",{className:"next-modal",children:r.jsx("img",{className:"w-[140px] h-[140px]",src:n})})},Cfe=()=>{const e=ie();return y.useCallback((t,n)=>{me.event("click_share_btn",{type:"qr"}),e.dropdown({popcorn:t.currentTarget,placement:"right-end",content:()=>r.jsx(Efe,{...n})})},[e])},kfe=e=>{if(e.createRange){const n=e.createRange();if(n.getBoundingClientRect){const s=e.createElement("boundtest");s.style.height="123px",s.style.display="block",e.body.appendChild(s),n.selectNode(s);const a=n.getBoundingClientRect(),o=Math.round(a.height);if(e.body.removeChild(s),o===123)return!0}}return!1},Tfe=e=>{const t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);const n=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";const s=t.firstChild,a=t3(s.data).map(c=>Dr(c));let o=0,i={};const l=a.every((c,d)=>{n.setStart(s,o),n.setEnd(s,o+c.length);const u=n.getBoundingClientRect();o+=c.length;const f=u.x>i.x||u.y>i.y;return i=u,d===0?!0:f});return e.body.removeChild(t),l},vfe=()=>typeof new Image().crossOrigin<"u",Ife=()=>typeof new XMLHttpRequest().responseType=="string",Nfe=e=>{const t=new Image,n=e.createElement("canvas"),s=n.getContext("2d");if(!s)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{s.drawImage(t,0,0),n.toDataURL()}catch(a){return!1}return!0},XA=e=>e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255,jfe=e=>{const t=e.createElement("canvas"),n=100;t.width=n,t.height=n;const s=t.getContext("2d");if(!s)return Promise.reject(!1);s.fillStyle="rgb(0, 255, 0)",s.fillRect(0,0,n,n);const a=new Image,o=t.toDataURL();a.src=o;const i=XT(n,n,0,0,a);return s.fillStyle="red",s.fillRect(0,0,n,n),QA(i).then(l=>{s.drawImage(l,0,0);const{data:c}=s.getImageData(0,0,n,n);s.fillStyle="red",s.fillRect(0,0,n,n);const d=e.createElement("div");return d.style.backgroundImage="url(".concat(o,")"),d.style.height="".concat(n,"px"),XA(c)?QA(XT(n,n,0,0,d)):Promise.reject(!1)}).then(l=>(s.drawImage(l,0,0),XA(s.getImageData(0,0,n,n).data))).catch(()=>!1)},XT=(e,t,n,s,a)=>{const o="http://www.w3.org/2000/svg",i=document.createElementNS(o,"svg"),l=document.createElementNS(o,"foreignObject");return i.setAttributeNS(null,"width",e.toString()),i.setAttributeNS(null,"height",t.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",n.toString()),l.setAttributeNS(null,"y",s.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),i.appendChild(l),l.appendChild(a),i},QA=e=>new Promise((t,n)=>{const s=new Image;s.onload=()=>t(s),s.onerror=n,s.src="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(new XMLSerializer().serializeToString(e)))}),Ea={get SUPPORT_RANGE_BOUNDS(){const e=kfe(document);return Object.defineProperty(Ea,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){const e=Ea.SUPPORT_RANGE_BOUNDS&&Tfe(document);return Object.defineProperty(Ea,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){const e=Nfe(document);return Object.defineProperty(Ea,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){const e=typeof Array.from=="function"&&typeof window.fetch=="function"?jfe(document):Promise.resolve(!1);return Object.defineProperty(Ea,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){const e=vfe();return Object.defineProperty(Ea,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){const e=Ife();return Object.defineProperty(Ea,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){const e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Ea,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){const e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Ea,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},Ol=class Ol{static getOrigin(t){const n=Ol._link;return n?(n.href=t,n.href=n.href,n.protocol+n.hostname+n.port):"about:blank"}static isSameOrigin(t){return Ol.getOrigin(t)===Ol._origin}static setContext(t){Ol._link=t.document.createElement("a"),Ol._origin=Ol.getOrigin(t.location.href)}};q(Ol,"_link"),q(Ol,"_origin","about:blank");let dF=Ol;class Sfe{constructor(t,n){q(this,"_cache",{});this.context=t,this._options=n}addImage(t){const n=Promise.resolve();return this.has(t)||(wC(t)||Pfe(t))&&(this._cache[t]=this.loadImage(t)).catch(()=>{}),n}match(t){return this._cache[t]}async loadImage(t){const n=dF.isSameOrigin(t),s=!FC(t)&&this._options.useCORS===!0&&Ea.SUPPORT_CORS_IMAGES&&!n,a=!FC(t)&&!n&&!wC(t)&&typeof this._options.proxy=="string"&&Ea.SUPPORT_CORS_XHR&&!s;if(!n&&this._options.allowTaint===!1&&!FC(t)&&!wC(t)&&!a&&!s)return;let o=t;return a&&(o=await this.proxy(o)),this.context.logger.debug("Added image ".concat(t.substring(0,256))),await new Promise((i,l)=>{const c=new Image;c.onload=()=>i(c),c.onerror=l,(Lfe(o)||s)&&(c.crossOrigin="anonymous"),c.src=o,c.complete===!0&&setTimeout(()=>i(c),500),this._options.imageTimeout>0&&setTimeout(()=>l("Timed out (".concat(this._options.imageTimeout,"ms) loading image")),this._options.imageTimeout)})}has(t){return typeof this._cache[t]<"u"}keys(){return Promise.resolve(Object.keys(this._cache))}proxy(t){const{proxy:n}=this._options;if(!n)throw new Error("No proxy defined");const s=t.substring(0,256);return new Promise((a,o)=>{const i=Ea.SUPPORT_RESPONSE_TYPE?"blob":"text",l=new XMLHttpRequest;l.onload=()=>{if(l.status===200)if(i==="text")a(l.response);else{const d=new FileReader;d.addEventListener("load",()=>a(d.result),!1),d.addEventListener("error",u=>o(u),!1),d.readAsDataURL(l.response)}else o("Failed to proxy resource ".concat(s," with status code ").concat(l.status))},l.onerror=o;const c=n.indexOf("?")>-1?"&":"?";if(l.open("GET","".concat(n).concat(c,"url=").concat(encodeURIComponent(t),"&responseType=").concat(i)),i!=="text"&&l instanceof XMLHttpRequest&&(l.responseType=i),this._options.imageTimeout){const d=this._options.imageTimeout;l.timeout=d,l.ontimeout=()=>o("Timed out (".concat(d,"ms) proxying ").concat(s))}l.send()})}}const Dfe=/^data:image\/svg\+xml/i,Afe=/^data:image\/.*;base64,/i,Rfe=/^data:image\/.*/i,Pfe=e=>Ea.SUPPORT_SVG_DRAWING||!Bfe(e),FC=e=>Rfe.test(e),Lfe=e=>Afe.test(e),wC=e=>e.substr(0,4)==="blob",Bfe=e=>e.substr(-3).toLowerCase()==="svg"||Dfe.test(e);class g7{constructor({id:t,enabled:n}){q(this,"id");q(this,"enabled");q(this,"start");this.id=t,this.enabled=n,this.start=Date.now()}debug(...t){this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug(this.id,"".concat(this.getTime(),"ms"),...t):this.info(...t))}getTime(){return Date.now()-this.start}info(...t){this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info(this.id,"".concat(this.getTime(),"ms"),...t)}warn(...t){this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn(this.id,"".concat(this.getTime(),"ms"),...t):this.info(...t))}error(...t){this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error(this.id,"".concat(this.getTime(),"ms"),...t):this.info(...t))}}q(g7,"instances",{});const WF=class WF{constructor(t,n){q(this,"instanceName","#".concat(WF.instanceCount++));q(this,"logger");q(this,"cache");var s;this.windowBounds=n,this.logger=new g7({id:this.instanceName,enabled:t.logging}),this.cache=(s=t.cache)!=null?s:new Sfe(this,t)}};q(WF,"instanceCount",1);let QT=WF;const Jd=class Jd{constructor(t,n,s,a){this.left=t,this.top=n,this.width=s,this.height=a}add(t,n,s,a){return new Jd(this.left+t,this.top+n,this.width+s,this.height+a)}static fromClientRect(t,n){return new Jd(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height)}static fromDOMRectList(t,n){const s=Array.from(n).find(a=>a.width!==0);return s?new Jd(s.left+t.windowBounds.left,s.top+t.windowBounds.top,s.width,s.height):Jd.EMPTY}};q(Jd,"EMPTY",new Jd(0,0,0,0));let xl=Jd;const DE=(e,t)=>xl.fromClientRect(e,t.getBoundingClientRect()),Ofe=e=>{const{body:t}=e,{documentElement:n}=e;if(!t||!n)throw new Error("Unable to get document size");const s=Math.max(Math.max(t.scrollWidth,n.scrollWidth),Math.max(t.offsetWidth,n.offsetWidth),Math.max(t.clientWidth,n.clientWidth)),a=Math.max(Math.max(t.scrollHeight,n.scrollHeight),Math.max(t.offsetHeight,n.offsetHeight),Math.max(t.clientHeight,n.clientHeight));return new xl(0,0,s,a)};var It=(e=>(e[e.STRING_TOKEN=0]="STRING_TOKEN",e[e.BAD_STRING_TOKEN=1]="BAD_STRING_TOKEN",e[e.LEFT_PARENTHESIS_TOKEN=2]="LEFT_PARENTHESIS_TOKEN",e[e.RIGHT_PARENTHESIS_TOKEN=3]="RIGHT_PARENTHESIS_TOKEN",e[e.COMMA_TOKEN=4]="COMMA_TOKEN",e[e.HASH_TOKEN=5]="HASH_TOKEN",e[e.DELIM_TOKEN=6]="DELIM_TOKEN",e[e.AT_KEYWORD_TOKEN=7]="AT_KEYWORD_TOKEN",e[e.PREFIX_MATCH_TOKEN=8]="PREFIX_MATCH_TOKEN",e[e.DASH_MATCH_TOKEN=9]="DASH_MATCH_TOKEN",e[e.INCLUDE_MATCH_TOKEN=10]="INCLUDE_MATCH_TOKEN",e[e.LEFT_CURLY_BRACKET_TOKEN=11]="LEFT_CURLY_BRACKET_TOKEN",e[e.RIGHT_CURLY_BRACKET_TOKEN=12]="RIGHT_CURLY_BRACKET_TOKEN",e[e.SUFFIX_MATCH_TOKEN=13]="SUFFIX_MATCH_TOKEN",e[e.SUBSTRING_MATCH_TOKEN=14]="SUBSTRING_MATCH_TOKEN",e[e.DIMENSION_TOKEN=15]="DIMENSION_TOKEN",e[e.PERCENTAGE_TOKEN=16]="PERCENTAGE_TOKEN",e[e.NUMBER_TOKEN=17]="NUMBER_TOKEN",e[e.FUNCTION=18]="FUNCTION",e[e.FUNCTION_TOKEN=19]="FUNCTION_TOKEN",e[e.IDENT_TOKEN=20]="IDENT_TOKEN",e[e.COLUMN_TOKEN=21]="COLUMN_TOKEN",e[e.URL_TOKEN=22]="URL_TOKEN",e[e.BAD_URL_TOKEN=23]="BAD_URL_TOKEN",e[e.CDC_TOKEN=24]="CDC_TOKEN",e[e.CDO_TOKEN=25]="CDO_TOKEN",e[e.COLON_TOKEN=26]="COLON_TOKEN",e[e.SEMICOLON_TOKEN=27]="SEMICOLON_TOKEN",e[e.LEFT_SQUARE_BRACKET_TOKEN=28]="LEFT_SQUARE_BRACKET_TOKEN",e[e.RIGHT_SQUARE_BRACKET_TOKEN=29]="RIGHT_SQUARE_BRACKET_TOKEN",e[e.UNICODE_RANGE_TOKEN=30]="UNICODE_RANGE_TOKEN",e[e.WHITESPACE_TOKEN=31]="WHITESPACE_TOKEN",e[e.EOF_TOKEN=32]="EOF_TOKEN",e))(It||{});const Mfe=1,Ufe=2,Z0=4,EC=8,uF=10,JA=47,z_=92,Vfe=9,$fe=32,ny=34,r_=61,Hfe=35,zfe=36,qfe=37,sy=39,ry=40,a_=41,Gfe=95,ko=45,Wfe=33,Kfe=60,Yfe=62,Xfe=64,Qfe=91,Jfe=93,Zfe=61,eme=123,ay=63,tme=125,ZA=124,nme=126,sme=128,eR=65533,CC=42,Uf=43,rme=44,ame=58,ome=59,k1=46,ime=0,lme=8,cme=11,dme=14,ume=31,fme=127,Pl=-1,_7=48,x7=97,y7=101,mme=102,hme=117,pme=122,b7=65,F7=69,w7=70,gme=85,_me=90,Ua=e=>e>=_7&&e<=57,xme=e=>e>=55296&&e<=57343,Ch=e=>Ua(e)||e>=b7&&e<=w7||e>=x7&&e<=mme,yme=e=>e>=x7&&e<=pme,bme=e=>e>=b7&&e<=_me,Fme=e=>yme(e)||bme(e),wme=e=>e>=sme,oy=e=>e===uF||e===Vfe||e===$fe,fF=e=>Fme(e)||wme(e)||e===Gfe,tR=e=>fF(e)||Ua(e)||e===ko,Eme=e=>e>=ime&&e<=lme||e===cme||e>=dme&&e<=ume||e===fme,Wd=(e,t)=>e!==z_?!1:t!==uF,iy=(e,t,n)=>e===ko?fF(t)||Wd(t,n):fF(e)?!0:!!(e===z_&&Wd(e,t)),kC=(e,t,n)=>e===Uf||e===ko?Ua(t)?!0:t===k1&&Ua(n):Ua(e===k1?t:e),Cme=e=>{let t=0,n=1;(e[t]===Uf||e[t]===ko)&&(e[t]===ko&&(n=-1),t++);const s=[];for(;Ua(e[t]);)s.push(e[t++]);const a=s.length?parseInt(Dr(...s),10):0;e[t]===k1&&t++;const o=[];for(;Ua(e[t]);)o.push(e[t++]);const i=o.length,l=i?parseInt(Dr(...o),10):0;(e[t]===F7||e[t]===y7)&&t++;let c=1;(e[t]===Uf||e[t]===ko)&&(e[t]===ko&&(c=-1),t++);const d=[];for(;Ua(e[t]);)d.push(e[t++]);const u=d.length?parseInt(Dr(...d),10):0;return n*(a+l*Math.pow(10,-i))*Math.pow(10,c*u)},kme={type:2},Tme={type:3},vme={type:4},Ime={type:13},Nme={type:8},jme={type:21},Sme={type:9},Dme={type:10},Ame={type:11},Rme={type:12},Pme={type:14},ly={type:23},Lme={type:1},Bme={type:25},Ome={type:24},Mme={type:26},Ume={type:27},Vme={type:28},$me={type:29},Hme={type:31},JT={type:32};class E7{constructor(){q(this,"_value");this._value=[]}write(t){this._value=this._value.concat(t3(t))}read(){const t=[];let n=this.consumeToken();for(;n!==JT;)t.push(n),n=this.consumeToken();return t}consumeToken(){const t=this.consumeCodePoint();switch(t){case ny:return this.consumeStringToken(ny);case Hfe:const n=this.peekCodePoint(0),s=this.peekCodePoint(1),a=this.peekCodePoint(2);if(tR(n)||Wd(s,a)){const p=iy(n,s,a)?Ufe:Mfe;return{type:5,value:this.consumeName(),flags:p}}break;case zfe:if(this.peekCodePoint(0)===r_)return this.consumeCodePoint(),Ime;break;case sy:return this.consumeStringToken(sy);case ry:return kme;case a_:return Tme;case CC:if(this.peekCodePoint(0)===r_)return this.consumeCodePoint(),Pme;break;case Uf:if(kC(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case rme:return vme;case ko:const o=t,i=this.peekCodePoint(0),l=this.peekCodePoint(1);if(kC(o,i,l))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(iy(o,i,l))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(i===ko&&l===Yfe)return this.consumeCodePoint(),this.consumeCodePoint(),Ome;break;case k1:if(kC(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case JA:if(this.peekCodePoint(0)===CC)for(this.consumeCodePoint();;){let p=this.consumeCodePoint();if(p===CC&&(p=this.consumeCodePoint(),p===JA))return this.consumeToken();if(p===Pl)return this.consumeToken()}break;case ame:return Mme;case ome:return Ume;case Kfe:if(this.peekCodePoint(0)===Wfe&&this.peekCodePoint(1)===ko&&this.peekCodePoint(2)===ko)return this.consumeCodePoint(),this.consumeCodePoint(),Bme;break;case Xfe:const c=this.peekCodePoint(0),d=this.peekCodePoint(1),u=this.peekCodePoint(2);if(iy(c,d,u))return{type:7,value:this.consumeName()};break;case Qfe:return Vme;case z_:if(Wd(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case Jfe:return $me;case Zfe:if(this.peekCodePoint(0)===r_)return this.consumeCodePoint(),Nme;break;case eme:return Ame;case tme:return Rme;case hme:case gme:const f=this.peekCodePoint(0),h=this.peekCodePoint(1);return f===Uf&&(Ch(h)||h===ay)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case ZA:if(this.peekCodePoint(0)===r_)return this.consumeCodePoint(),Sme;if(this.peekCodePoint(0)===ZA)return this.consumeCodePoint(),jme;break;case nme:if(this.peekCodePoint(0)===r_)return this.consumeCodePoint(),Dme;break;case Pl:return JT}return oy(t)?(this.consumeWhiteSpace(),Hme):Ua(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):fF(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:Dr(t)}}consumeCodePoint(){const t=this._value.shift();return typeof t>"u"?-1:t}reconsumeCodePoint(t){this._value.unshift(t)}peekCodePoint(t){return t>=this._value.length?-1:this._value[t]}consumeUnicodeRangeToken(){const t=[];let n=this.consumeCodePoint();for(;Ch(n)&&t.length<6;)t.push(n),n=this.consumeCodePoint();let s=!1;for(;n===ay&&t.length<6;)t.push(n),n=this.consumeCodePoint(),s=!0;if(s){const o=parseInt(Dr(...t.map(l=>l===ay?_7:l)),16),i=parseInt(Dr(...t.map(l=>l===ay?w7:l)),16);return{type:30,start:o,end:i}}const a=parseInt(Dr(...t),16);if(this.peekCodePoint(0)===ko&&Ch(this.peekCodePoint(1))){this.consumeCodePoint(),n=this.consumeCodePoint();const o=[];for(;Ch(n)&&o.length<6;)o.push(n),n=this.consumeCodePoint();const i=parseInt(Dr(...o),16);return{type:30,start:a,end:i}}return{type:30,start:a,end:a}}consumeIdentLikeToken(){const t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===ry?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===ry?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}}consumeUrlToken(){const t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Pl)return{type:22,value:""};const n=this.peekCodePoint(0);if(n===sy||n===ny){const s=this.consumeStringToken(this.consumeCodePoint());return s.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Pl||this.peekCodePoint(0)===a_)?(this.consumeCodePoint(),{type:22,value:s.value}):(this.consumeBadUrlRemnants(),ly)}for(;;){const s=this.consumeCodePoint();if(s===Pl||s===a_)return{type:22,value:Dr(...t)};if(oy(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Pl||this.peekCodePoint(0)===a_?(this.consumeCodePoint(),{type:22,value:Dr(...t)}):(this.consumeBadUrlRemnants(),ly);if(s===ny||s===sy||s===ry||Eme(s))return this.consumeBadUrlRemnants(),ly;if(s===z_)if(Wd(s,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),ly;else t.push(s)}}consumeWhiteSpace(){for(;oy(this.peekCodePoint(0));)this.consumeCodePoint()}consumeBadUrlRemnants(){for(;;){const t=this.consumeCodePoint();if(t===a_||t===Pl)return;Wd(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}}consumeStringSlice(t){let s="";for(;t>0;){const a=Math.min(5e4,t);s+=Dr(...this._value.splice(0,a)),t-=a}return this._value.shift(),s}consumeStringToken(t){let n="",s=0;do{const a=this._value[s];if(a===Pl||a===void 0||a===t)return n+=this.consumeStringSlice(s),{type:0,value:n};if(a===uF)return this._value.splice(0,s),Lme;if(a===z_){const o=this._value[s+1];o!==Pl&&o!==void 0&&(o===uF?(n+=this.consumeStringSlice(s),s=-1,this._value.shift()):Wd(a,o)&&(n+=this.consumeStringSlice(s),n+=Dr(this.consumeEscapedCodePoint()),s=-1))}s++}while(!0)}consumeNumber(){const t=[];let n=Z0,s=this.peekCodePoint(0);for((s===Uf||s===ko)&&t.push(this.consumeCodePoint());Ua(this.peekCodePoint(0));)t.push(this.consumeCodePoint());s=this.peekCodePoint(0);let a=this.peekCodePoint(1);if(s===k1&&Ua(a))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),n=EC;Ua(this.peekCodePoint(0));)t.push(this.consumeCodePoint());s=this.peekCodePoint(0),a=this.peekCodePoint(1);const o=this.peekCodePoint(2);if((s===F7||s===y7)&&((a===Uf||a===ko)&&Ua(o)||Ua(a)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),n=EC;Ua(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[Cme(t),n]}consumeNumericToken(){const[t=0,n=EC]=this.consumeNumber(),s=this.peekCodePoint(0),a=this.peekCodePoint(1),o=this.peekCodePoint(2);if(iy(s,a,o)){const i=this.consumeName();return{type:15,number:t,flags:n,unit:i}}return s===qfe?(this.consumeCodePoint(),{type:16,number:t,flags:n}):{type:17,number:t,flags:n}}consumeEscapedCodePoint(){const t=this.consumeCodePoint();if(Ch(t)){let n=Dr(t);for(;Ch(this.peekCodePoint(0))&&n.length<6;)n+=Dr(this.consumeCodePoint());oy(this.peekCodePoint(0))&&this.consumeCodePoint();const s=parseInt(n,16);return s===0||xme(s)||s>1114111?eR:s}return t===Pl?eR:t}consumeName(){let t="";for(;;){const n=this.consumeCodePoint();if(tR(n))t+=Dr(n);else if(Wd(n,this.peekCodePoint(0)))t+=Dr(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(n),t}}}class ip{constructor(t){q(this,"_tokens");this._tokens=t}static create(t){const n=new E7;return n.write(t),new ip(n.read())}static parseValue(t){return ip.create(t).parseComponentValue()}static parseValues(t){return ip.create(t).parseComponentValues()}parseComponentValue(){let t=this.consumeToken();for(;t.type===It.WHITESPACE_TOKEN;)t=this.consumeToken();if(t.type===It.EOF_TOKEN)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);const n=this.consumeComponentValue();do t=this.consumeToken();while(t.type===It.WHITESPACE_TOKEN);if(t.type===It.EOF_TOKEN)return n;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")}parseComponentValues(){const t=[];for(;;){const n=this.consumeComponentValue();if(n.type===It.EOF_TOKEN)return t;t.push(n),t.push()}}consumeComponentValue(){const t=this.consumeToken();switch(t.type){case It.LEFT_CURLY_BRACKET_TOKEN:case It.LEFT_SQUARE_BRACKET_TOKEN:case It.LEFT_PARENTHESIS_TOKEN:return this.consumeSimpleBlock(t.type);case It.FUNCTION_TOKEN:return this.consumeFunction(t)}return t}consumeSimpleBlock(t){const n={type:t,values:[]};let s=this.consumeToken();for(;;){if(s.type===It.EOF_TOKEN||qme(s,t))return n;this.reconsumeToken(s),n.values.push(this.consumeComponentValue()),s=this.consumeToken()}}consumeFunction(t){const n={name:t.value,values:[],type:It.FUNCTION};for(;;){const s=this.consumeToken();if(s.type===It.EOF_TOKEN||s.type===It.RIGHT_PARENTHESIS_TOKEN)return n;this.reconsumeToken(s),n.values.push(this.consumeComponentValue())}}consumeToken(){const t=this._tokens.shift();return typeof t>"u"?JT:t}reconsumeToken(t){this._tokens.unshift(t)}}const ex=e=>e.type===It.DIMENSION_TOKEN,Ng=e=>e.type===It.NUMBER_TOKEN,Ms=e=>e.type===It.IDENT_TOKEN,zme=e=>e.type===It.STRING_TOKEN,ZT=(e,t)=>Ms(e)&&e.value===t,C7=e=>e.type!==It.WHITESPACE_TOKEN,Sp=e=>e.type!==It.WHITESPACE_TOKEN&&e.type!==It.COMMA_TOKEN,Cc=e=>{const t=[];let n=[];return e.forEach(s=>{if(s.type===It.COMMA_TOKEN){if(n.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(n),n=[];return}s.type!==It.WHITESPACE_TOKEN&&n.push(s)}),n.length&&t.push(n),t},qme=(e,t)=>t===It.LEFT_CURLY_BRACKET_TOKEN&&e.type===It.RIGHT_CURLY_BRACKET_TOKEN||t===It.LEFT_SQUARE_BRACKET_TOKEN&&e.type===It.RIGHT_SQUARE_BRACKET_TOKEN?!0:t===It.LEFT_PARENTHESIS_TOKEN&&e.type===It.RIGHT_PARENTHESIS_TOKEN,Mu=e=>e.type===It.NUMBER_TOKEN||e.type===It.DIMENSION_TOKEN,Pr=e=>e.type===It.PERCENTAGE_TOKEN||Mu(e),k7=e=>e.length>1?[e[0],e[1]]:[e[0]],Ia={type:It.NUMBER_TOKEN,number:0,flags:Z0},cj={type:It.PERCENTAGE_TOKEN,number:50,flags:Z0},au={type:It.PERCENTAGE_TOKEN,number:100,flags:Z0},E_=(e,t,n)=>{const[s,a]=e;return[zs(s,t),zs(typeof a<"u"?a:s,n)]},zs=(e,t)=>{if(e.type===It.PERCENTAGE_TOKEN)return e.number/100*t;if(ex(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},T7="deg",v7="grad",I7="rad",N7="turn",AE={name:"angle",parse:(e,t)=>{if(t.type===It.DIMENSION_TOKEN)switch(t.unit){case T7:return Math.PI*t.number/180;case v7:return Math.PI/200*t.number;case I7:return t.number;case N7:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},j7=e=>e?e.type===It.DIMENSION_TOKEN&&(e.unit===T7||e.unit===v7||e.unit===I7||e.unit===N7):!1,S7=e=>{switch(e.filter(Ms).map(n=>n.value).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Ia,Ia];case"to top":case"bottom":return vi(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Ia,au];case"to right":case"left":return vi(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[au,au];case"to bottom":case"top":return vi(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[au,Ia];case"to left":case"right":return vi(270)}return 0},vi=e=>Math.PI*e/180,_u={name:"color",parse:(e,t)=>{if(t.type===It.FUNCTION){const n=Gme[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported color function "'.concat(t.name,'"'));return n(e,t.values)}if(t.type===It.HASH_TOKEN){if(t.value.length===3){const n=t.value.substring(0,1),s=t.value.substring(1,2),a=t.value.substring(2,3);return ou(parseInt(n+n,16),parseInt(s+s,16),parseInt(a+a,16),1)}if(t.value.length===4){const n=t.value.substring(0,1),s=t.value.substring(1,2),a=t.value.substring(2,3),o=t.value.substring(3,4);return ou(parseInt(n+n,16),parseInt(s+s,16),parseInt(a+a,16),parseInt(o+o,16)/255)}if(t.value.length===6){const n=t.value.substring(0,2),s=t.value.substring(2,4),a=t.value.substring(4,6);return ou(parseInt(n,16),parseInt(s,16),parseInt(a,16),1)}if(t.value.length===8){const n=t.value.substring(0,2),s=t.value.substring(2,4),a=t.value.substring(4,6),o=t.value.substring(6,8);return ou(parseInt(n,16),parseInt(s,16),parseInt(a,16),parseInt(o,16)/255)}}if(t.type===It.IDENT_TOKEN){const n=Zc[t.value.toUpperCase()];if(typeof n<"u")return n}return Zc.TRANSPARENT}},xu=e=>(255&e)===0,Vr=e=>{const t=255&e,n=255&e>>8,s=255&e>>16,a=255&e>>24;return t<255?"rgba(".concat(a,",").concat(s,",").concat(n,",").concat(t/255,")"):"rgb(".concat(a,",").concat(s,",").concat(n,")")},ou=(e,t,n,s)=>(e<<24|t<<16|n<<8|Math.round(s*255)<<0)>>>0,nR=(e,t)=>{if(e.type===It.NUMBER_TOKEN)return e.number;if(e.type===It.PERCENTAGE_TOKEN){const n=t===3?1:255;return t===3?e.number/100*n:Math.round(e.number/100*n)}return 0},sR=(e,t)=>{const n=t.filter(Sp);if(n.length===3){const[s,a,o]=n.map(nR);return ou(s,a,o,1)}if(n.length===4){const[s,a,o,i]=n.map(nR);return ou(s,a,o,i)}return 0};function TC(e,t,n){return n<0&&(n+=1),n>=1&&(n-=1),n<1/6?(t-e)*n*6+e:n<1/2?t:n<2/3?(t-e)*6*(2/3-n)+e:e}const rR=(e,t)=>{const n=t.filter(Sp),[s,a,o,i]=n,l=((s==null?void 0:s.type)===It.NUMBER_TOKEN?vi(s.number):AE.parse(e,s))/(Math.PI*2),c=Pr(a)?a.number/100:0,d=Pr(o)?o.number/100:0,u=typeof i<"u"&&Pr(i)?zs(i,1):1;if(c===0)return ou(d*255,d*255,d*255,1);const f=d<=.5?d*(c+1):d+c-d*c,h=d*2-f,p=TC(h,f,l+1/3),g=TC(h,f,l),_=TC(h,f,l-1/3);return ou(p*255,g*255,_*255,u)},Gme={hsl:rR,hsla:rR,rgb:sR,rgba:sR},q_=(e,t)=>_u.parse(e,ip.create(t).parseComponentValue()),Zc={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Wme="data-html2canvas-debug";var mF=(e=>(e[e.NONE=0]="NONE",e[e.ALL=1]="ALL",e[e.CLONE=2]="CLONE",e[e.PARSE=3]="PARSE",e[e.RENDER=4]="RENDER",e))(mF||{});const Kme=e=>{switch(e.getAttribute(Wme)){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},ev=(e,t)=>{const n=Kme(e);return n===1||t===n},Kr=(e,t)=>(e&t)!==0;var Yt=(e=>(e[e.VALUE=0]="VALUE",e[e.LIST=1]="LIST",e[e.IDENT_VALUE=2]="IDENT_VALUE",e[e.TYPE_VALUE=3]="TYPE_VALUE",e[e.TOKEN_VALUE=4]="TOKEN_VALUE",e))(Yt||{}),Jf=(e=>(e[e.BORDER_BOX=0]="BORDER_BOX",e[e.PADDING_BOX=1]="PADDING_BOX",e[e.CONTENT_BOX=2]="CONTENT_BOX",e))(Jf||{});const Yme={name:"background-clip",initialValue:"border-box",prefix:!1,type:Yt.LIST,parse:(e,t)=>t.map(n=>{if(Ms(n))switch(n.value){case"padding-box":return 1;case"content-box":return 2}return 0})},Xme={name:"background-color",initialValue:"transparent",prefix:!1,type:Yt.TYPE_VALUE,format:"color"},RE=(e,t)=>{const n=_u.parse(e,t[0]),s=t[1];return s&&Pr(s)?{color:n,stop:s}:{color:n,stop:null}},vC=(e,t)=>{const n=e[0],s=e[e.length-1];n.stop===null&&(n.stop=Ia),s.stop===null&&(s.stop=au);const a=[];let o=0;for(let l=0;l<e.length;l++){const{stop:c}=e[l];if(c!==null){const d=zs(c,t);d>o?a.push(d):a.push(o),o=d}else a.push(null)}let i=null;for(let l=0;l<a.length;l++){const c=a[l];if(c===null)i===null&&(i=l);else if(i!==null){const d=l-i,u=a[i-1],f=(c-u)/(d+1);for(let h=1;h<=d;h++)a[i+h-1]=f*h;i=null}}return e.map(({color:l},c)=>({color:l,stop:Math.max(Math.min(1,a[c]/t),0)}))},Qme=(e,t,n)=>{const s=t/2,a=n/2,o=zs(e[0],t)-s,i=a-zs(e[1],n);return(Math.atan2(i,o)+Math.PI*2)%(Math.PI*2)},aR=(e,t,n)=>{const s=typeof e=="number"?e:Qme(e,t,n),a=Math.abs(t*Math.sin(s))+Math.abs(n*Math.cos(s)),o=t/2,i=n/2,l=a/2,c=Math.sin(s-Math.PI/2)*l,d=Math.cos(s-Math.PI/2)*l;return[a,o-d,o+d,i-c,i+c]},Gi=(e,t)=>Math.sqrt(e*e+t*t),oR=(e,t,n,s,a)=>[[0,0],[0,t],[e,0],[e,t]].reduce((i,l)=>{const[c=0,d=0]=l,u=Gi(n-c,s-d);return(a?u<i.optimumDistance:u>i.optimumDistance)?{optimumCorner:l,optimumDistance:u}:i},{optimumDistance:a?1/0:-1/0,optimumCorner:null}).optimumCorner,Jme=(e,t,n,s,a)=>{let o=0,i=0;switch(e.size){case Va.CLOSEST_SIDE:e.shape===Oa.CIRCLE?o=i=Math.min(Math.abs(t),Math.abs(t-s),Math.abs(n),Math.abs(n-a)):e.shape===Oa.ELLIPSE&&(o=Math.min(Math.abs(t),Math.abs(t-s)),i=Math.min(Math.abs(n),Math.abs(n-a)));break;case Va.CLOSEST_CORNER:if(e.shape===Oa.CIRCLE)o=i=Math.min(Gi(t,n),Gi(t,n-a),Gi(t-s,n),Gi(t-s,n-a));else if(e.shape===Oa.ELLIPSE){const l=Math.min(Math.abs(n),Math.abs(n-a))/Math.min(Math.abs(t),Math.abs(t-s)),[c,d]=oR(s,a,t,n,!0);o=Gi(c-t,(d-n)/l),i=l*o}break;case Va.FARTHEST_SIDE:e.shape===Oa.CIRCLE?o=i=Math.max(Math.abs(t),Math.abs(t-s),Math.abs(n),Math.abs(n-a)):e.shape===Oa.ELLIPSE&&(o=Math.max(Math.abs(t),Math.abs(t-s)),i=Math.max(Math.abs(n),Math.abs(n-a)));break;case Va.FARTHEST_CORNER:if(e.shape===Oa.CIRCLE)o=i=Math.max(Gi(t,n),Gi(t,n-a),Gi(t-s,n),Gi(t-s,n-a));else if(e.shape===Oa.ELLIPSE){const l=Math.max(Math.abs(n),Math.abs(n-a))/Math.max(Math.abs(t),Math.abs(t-s)),[c,d]=oR(s,a,t,n,!1);o=Gi(c-t,(d-n)/l),i=l*o}break}return Array.isArray(e.size)&&(o=zs(e.size[0],s),i=e.size.length===2?zs(e.size[1],a):o),[o,i]},cy=(e,t)=>{let n=vi(180);const s=[];return Cc(t).forEach((a,o)=>{if(o===0){const l=a[0];if((l==null?void 0:l.type)===It.IDENT_TOKEN&&["top","left","right","bottom"].indexOf(l.value)!==-1){n=S7(a);return}else if(j7(l)){n=(AE.parse(e,l)+vi(270))%vi(360);return}}const i=RE(e,a);s.push(i)}),{angle:n,stops:s,type:rl.LINEAR_GRADIENT}},D7="closest-side",A7="farthest-side",R7="closest-corner",P7="farthest-corner",L7="circle",B7="ellipse",O7="cover",M7="contain",Zme=(e,t)=>{let n=Oa.CIRCLE,s=Va.FARTHEST_CORNER;const a=[],o=[];return Cc(t).forEach((i,l)=>{let c=!0;if(l===0){let d=!1;c=i.reduce((f,h)=>{if(d)if(Ms(h))switch(h.value){case"center":return o.push(cj),f;case"top":case"left":return o.push(Ia),f;case"right":case"bottom":return o.push(au),f}else(Pr(h)||Mu(h))&&o.push(h);else if(Ms(h))switch(h.value){case L7:return n=Oa.CIRCLE,!1;case B7:return n=Oa.ELLIPSE,!1;case"at":return d=!0,!1;case D7:return s=Va.CLOSEST_SIDE,!1;case O7:case A7:return s=Va.FARTHEST_SIDE,!1;case M7:case R7:return s=Va.CLOSEST_CORNER,!1;case P7:return s=Va.FARTHEST_CORNER,!1}else if(Mu(h)||Pr(h))return Array.isArray(s)||(s=[]),s.push(h),!1;return f},c)}if(c){const d=RE(e,i);a.push(d)}}),{size:s,shape:n,stops:a,position:o,type:rl.RADIAL_GRADIENT}},dy=(e,t)=>{let n=Oa.CIRCLE,s=Va.FARTHEST_CORNER;const a=[],o=[];return Cc(t).forEach((i,l)=>{let c=!0;if(l===0?c=i.reduce((u,f)=>{if(Ms(f))switch(f.value){case"center":return o.push(cj),!1;case"top":case"left":return o.push(Ia),!1;case"right":case"bottom":return o.push(au),!1}else if(Pr(f)||Mu(f))return o.push(f),!1;return u},c):l===1&&(c=i.reduce((u,f)=>{if(Ms(f))switch(f.value){case L7:return n=Oa.CIRCLE,!1;case B7:return n=Oa.ELLIPSE,!1;case M7:case D7:return s=Va.CLOSEST_SIDE,!1;case A7:return s=Va.FARTHEST_SIDE,!1;case R7:return s=Va.CLOSEST_CORNER,!1;case O7:case P7:return s=Va.FARTHEST_CORNER,!1}else if(Mu(f)||Pr(f))return Array.isArray(s)||(s=[]),s.push(f),!1;return u},c)),c){const d=RE(e,i);a.push(d)}}),{size:s,shape:n,stops:a,position:o,type:rl.RADIAL_GRADIENT}},ehe=(e,t)=>{const n=vi(180),s=[];let a=rl.LINEAR_GRADIENT;const o=Oa.CIRCLE,i=Va.FARTHEST_CORNER,l=[];return Cc(t).forEach((c,d)=>{const u=c[0];if(d===0){if(Ms(u)&&u.value==="linear"){a=rl.LINEAR_GRADIENT;return}else if(Ms(u)&&u.value==="radial"){a=rl.RADIAL_GRADIENT;return}}if(u.type===It.FUNCTION){if(u.name==="from"){const f=_u.parse(e,u.values[0]);s.push({stop:Ia,color:f})}else if(u.name==="to"){const f=_u.parse(e,u.values[0]);s.push({stop:au,color:f})}else if(u.name==="color-stop"){const f=u.values.filter(Sp);if(f.length===2){const h=_u.parse(e,f[1]),p=f[0];Ng(p)&&s.push({stop:{type:It.PERCENTAGE_TOKEN,number:p.number*100,flags:p.flags},color:h})}}}}),a===rl.LINEAR_GRADIENT?{angle:(n+vi(180))%vi(360),stops:s,type:a}:{size:i,shape:o,stops:s,position:l,type:a}},the=(e,t)=>{let n=vi(180);const s=[];return Cc(t).forEach((a,o)=>{if(o===0){const l=a[0];if(l.type===It.IDENT_TOKEN&&l.value==="to"){n=S7(a);return}else if(j7(l)){n=AE.parse(e,l);return}}const i=RE(e,a);s.push(i)}),{angle:n,stops:s,type:rl.LINEAR_GRADIENT}};var rl=(e=>(e[e.URL=0]="URL",e[e.LINEAR_GRADIENT=1]="LINEAR_GRADIENT",e[e.RADIAL_GRADIENT=2]="RADIAL_GRADIENT",e))(rl||{});const nhe=e=>e.type===1,she=e=>e.type===2;var Oa=(e=>(e[e.CIRCLE=0]="CIRCLE",e[e.ELLIPSE=1]="ELLIPSE",e))(Oa||{}),Va=(e=>(e[e.CLOSEST_SIDE=0]="CLOSEST_SIDE",e[e.FARTHEST_SIDE=1]="FARTHEST_SIDE",e[e.CLOSEST_CORNER=2]="CLOSEST_CORNER",e[e.FARTHEST_CORNER=3]="FARTHEST_CORNER",e))(Va||{});const dj={name:"image",parse:(e,t)=>{if(t.type===It.URL_TOKEN){const n={url:t.value,type:0};return e.cache.addImage(t.value),n}if(t.type===It.FUNCTION){const n=U7[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'.concat(t.name,'"'));return n(e,t.values)}throw new Error("Unsupported image type ".concat(t.type))}};function rhe(e){return!(e.type===It.IDENT_TOKEN&&e.value==="none")&&(e.type!==It.FUNCTION||!!U7[e.name])}const U7={"linear-gradient":the,"-moz-linear-gradient":cy,"-ms-linear-gradient":cy,"-o-linear-gradient":cy,"-webkit-linear-gradient":cy,"radial-gradient":Zme,"-moz-radial-gradient":dy,"-ms-radial-gradient":dy,"-o-radial-gradient":dy,"-webkit-radial-gradient":dy,"-webkit-gradient":ehe},ahe={name:"background-image",initialValue:"none",type:Yt.LIST,prefix:!1,parse:(e,t)=>{if(t.length===0)return[];const n=t[0];return(n==null?void 0:n.type)===It.IDENT_TOKEN&&n.value==="none"?[]:t.filter(s=>Sp(s)&&rhe(s)).map(s=>dj.parse(e,s))}};var hF=(e=>(e[e.BORDER_BOX=0]="BORDER_BOX",e[e.PADDING_BOX=1]="PADDING_BOX",e[e.CONTENT_BOX=2]="CONTENT_BOX",e))(hF||{});const ohe={name:"background-origin",initialValue:"border-box",prefix:!1,type:Yt.LIST,parse:(e,t)=>t.map(n=>{if(Ms(n))switch(n.value){case"padding-box":return 1;case"content-box":return 2}return 0})},ihe={name:"background-position",initialValue:"0% 0%",type:Yt.LIST,prefix:!1,parse:(e,t)=>Cc(t).map(n=>n.filter(Pr)).map(k7)};var $y=(e=>(e[e.REPEAT=0]="REPEAT",e[e.NO_REPEAT=1]="NO_REPEAT",e[e.REPEAT_X=2]="REPEAT_X",e[e.REPEAT_Y=3]="REPEAT_Y",e))($y||{});const lhe={name:"background-repeat",initialValue:"repeat",prefix:!1,type:Yt.LIST,parse:(e,t)=>Cc(t).map(n=>n.filter(Ms).map(s=>s.value).join(" ")).map(che)},che=e=>{switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}};var G_=(e=>(e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover",e))(G_||{});const dhe={name:"background-size",initialValue:"0",prefix:!1,type:Yt.LIST,parse:(e,t)=>Cc(t).map(n=>n.filter(uhe))},uhe=e=>Ms(e)||Pr(e),PE=e=>({name:"border-".concat(e,"-color"),initialValue:"transparent",prefix:!1,type:Yt.TYPE_VALUE,format:"color"}),fhe=PE("top"),mhe=PE("right"),hhe=PE("bottom"),phe=PE("left"),LE=e=>({name:"border-radius-".concat(e),initialValue:"0 0",prefix:!1,type:Yt.LIST,parse:(t,n)=>k7(n.filter(Pr))}),ghe=LE("top-left"),_he=LE("top-right"),xhe=LE("bottom-right"),yhe=LE("bottom-left");var Fo=(e=>(e[e.NONE=0]="NONE",e[e.SOLID=1]="SOLID",e[e.DASHED=2]="DASHED",e[e.DOTTED=3]="DOTTED",e[e.DOUBLE=4]="DOUBLE",e))(Fo||{});const BE=e=>({name:"border-".concat(e,"-style"),initialValue:"solid",prefix:!1,type:Yt.IDENT_VALUE,parse:(t,n)=>{switch(n){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}),bhe=BE("top"),Fhe=BE("right"),whe=BE("bottom"),Ehe=BE("left"),OE=e=>({name:"border-".concat(e,"-width"),initialValue:"0",type:Yt.VALUE,prefix:!1,parse:(t,n)=>ex(n)?n.number:0}),Che=OE("top"),khe=OE("right"),The=OE("bottom"),vhe=OE("left"),Ihe={name:"box-shadow",initialValue:"none",type:Yt.LIST,prefix:!1,parse:(e,t)=>t.length===1&&ZT(t[0],"none")?[]:Cc(t).map(n=>{const s={color:255,offsetX:Ia,offsetY:Ia,blur:Ia,spread:Ia,inset:!1};let a=0;for(let o=0;o<n.length;o++){const i=n[o];ZT(i,"inset")?s.inset=!0:Mu(i)?(a===0?s.offsetX=i:a===1?s.offsetY=i:a===2?s.blur=i:s.spread=i,a++):s.color=_u.parse(e,i)}return s})},Nhe={name:"color",initialValue:"transparent",prefix:!1,type:Yt.TYPE_VALUE,format:"color"},jhe={name:"content",initialValue:"none",type:Yt.LIST,prefix:!1,parse:(e,t)=>{if(t.length===0)return[];const n=t[0];return n.type===It.IDENT_TOKEN&&n.value==="none"?[]:t}},She={name:"counter-increment",initialValue:"none",prefix:!0,type:Yt.LIST,parse:(e,t)=>{if(t.length===0)return null;const n=t[0];if(n.type===It.IDENT_TOKEN&&n.value==="none")return null;const s=[],a=t.filter(C7);for(let o=0;o<a.length;o++){const i=a[o],l=a[o+1];if(i.type===It.IDENT_TOKEN){const c=l&&Ng(l)?l.number:1;s.push({counter:i.value,increment:c})}}return s}},Dhe={name:"counter-reset",initialValue:"none",prefix:!0,type:Yt.LIST,parse:(e,t)=>{if(t.length===0)return[];const n=[],s=t.filter(C7);for(let a=0;a<s.length;a++){const o=s[a],i=s[a+1];if(Ms(o)&&o.value!=="none"){const l=i&&Ng(i)?i.number:0;n.push({counter:o.value,reset:l})}}return n}};var V7=(e=>(e[e.LTR=0]="LTR",e[e.RTL=1]="RTL",e))(V7||{});const Ahe={name:"direction",initialValue:"ltr",prefix:!1,type:Yt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"rtl":return 1;case"ltr":default:return 0}}};var Vl=(e=>(e[e.NONE=0]="NONE",e[e.BLOCK=2]="BLOCK",e[e.INLINE=4]="INLINE",e[e.RUN_IN=8]="RUN_IN",e[e.FLOW=16]="FLOW",e[e.FLOW_ROOT=32]="FLOW_ROOT",e[e.TABLE=64]="TABLE",e[e.FLEX=128]="FLEX",e[e.GRID=256]="GRID",e[e.RUBY=512]="RUBY",e[e.SUBGRID=1024]="SUBGRID",e[e.LIST_ITEM=2048]="LIST_ITEM",e[e.TABLE_ROW_GROUP=4096]="TABLE_ROW_GROUP",e[e.TABLE_HEADER_GROUP=8192]="TABLE_HEADER_GROUP",e[e.TABLE_FOOTER_GROUP=16384]="TABLE_FOOTER_GROUP",e[e.TABLE_ROW=32768]="TABLE_ROW",e[e.TABLE_CELL=65536]="TABLE_CELL",e[e.TABLE_COLUMN_GROUP=131072]="TABLE_COLUMN_GROUP",e[e.TABLE_COLUMN=262144]="TABLE_COLUMN",e[e.TABLE_CAPTION=524288]="TABLE_CAPTION",e[e.RUBY_BASE=1048576]="RUBY_BASE",e[e.RUBY_TEXT=2097152]="RUBY_TEXT",e[e.RUBY_BASE_CONTAINER=4194304]="RUBY_BASE_CONTAINER",e[e.RUBY_TEXT_CONTAINER=8388608]="RUBY_TEXT_CONTAINER",e[e.CONTENTS=16777216]="CONTENTS",e[e.INLINE_BLOCK=33554432]="INLINE_BLOCK",e[e.INLINE_LIST_ITEM=67108864]="INLINE_LIST_ITEM",e[e.INLINE_TABLE=134217728]="INLINE_TABLE",e[e.INLINE_FLEX=268435456]="INLINE_FLEX",e[e.INLINE_GRID=536870912]="INLINE_GRID",e))(Vl||{});const Rhe={name:"display",initialValue:"inline-block",prefix:!1,type:Yt.LIST,parse:(e,t)=>t.filter(Ms).reduce((n,s)=>n|Phe(s.value),0)},Phe=e=>{switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},$7={name:"time",parse:(e,t)=>{if(t.type===It.DIMENSION_TOKEN)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},Lhe={name:"duration",initialValue:"0s",prefix:!1,type:Yt.LIST,parse:(e,t)=>t.filter(ex).map(n=>$7.parse(e,n))};var H7=(e=>(e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.INLINE_START=3]="INLINE_START",e[e.INLINE_END=4]="INLINE_END",e))(H7||{});const Bhe={name:"float",initialValue:"none",prefix:!1,type:Yt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Ohe={name:"font-family",initialValue:"",prefix:!1,type:Yt.LIST,parse:(e,t)=>{const n=[],s=[];return t.forEach(a=>{switch(a.type){case It.IDENT_TOKEN:case It.STRING_TOKEN:n.push(a.value);break;case It.NUMBER_TOKEN:n.push(a.number.toString());break;case It.COMMA_TOKEN:s.push(n.join(" ")),n.length=0;break}}),n.length&&s.push(n.join(" ")),s.map(a=>a.indexOf(" ")===-1?a:"'".concat(a,"'"))}},Mhe={name:"font-size",initialValue:"0",prefix:!1,type:Yt.TYPE_VALUE,format:"length"},Uhe={name:"font-style",initialValue:"normal",prefix:!1,type:Yt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Vhe={name:"font-variant",initialValue:"none",type:Yt.LIST,prefix:!1,parse:(e,t)=>t.filter(Ms).map(n=>n.value)},$he={name:"font-weight",initialValue:"normal",type:Yt.VALUE,prefix:!1,parse:(e,t)=>{if(Ng(t))return t.number;if(Ms(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},Hhe={name:"letter-spacing",initialValue:"0",prefix:!1,type:Yt.VALUE,parse:(e,t)=>t.type===It.IDENT_TOKEN&&t.value==="normal"?0:t.type===It.NUMBER_TOKEN||t.type===It.DIMENSION_TOKEN?t.number:0},zhe={name:"line-break",initialValue:"normal",prefix:!1,type:Yt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"strict":return"strict";case"normal":default:return"normal"}}},qhe={name:"line-height",initialValue:"normal",prefix:!1,type:Yt.TOKEN_VALUE},iR=(e,t)=>Ms(e)&&e.value==="normal"?1.2*t:e.type===It.NUMBER_TOKEN?t*e.number:Pr(e)?zs(e,t):t,Ghe={name:"list-style-image",initialValue:"none",type:Yt.VALUE,prefix:!1,parse:(e,t)=>t.type===It.IDENT_TOKEN&&t.value==="none"?null:dj.parse(e,t)},Whe={name:"list-style-position",initialValue:"outside",prefix:!1,type:Yt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"inside":return 0;case"outside":default:return 1}}};var zt=(e=>(e[e.NONE=-1]="NONE",e[e.DISC=0]="DISC",e[e.CIRCLE=1]="CIRCLE",e[e.SQUARE=2]="SQUARE",e[e.DECIMAL=3]="DECIMAL",e[e.CJK_DECIMAL=4]="CJK_DECIMAL",e[e.DECIMAL_LEADING_ZERO=5]="DECIMAL_LEADING_ZERO",e[e.LOWER_ROMAN=6]="LOWER_ROMAN",e[e.UPPER_ROMAN=7]="UPPER_ROMAN",e[e.LOWER_GREEK=8]="LOWER_GREEK",e[e.LOWER_ALPHA=9]="LOWER_ALPHA",e[e.UPPER_ALPHA=10]="UPPER_ALPHA",e[e.ARABIC_INDIC=11]="ARABIC_INDIC",e[e.ARMENIAN=12]="ARMENIAN",e[e.BENGALI=13]="BENGALI",e[e.CAMBODIAN=14]="CAMBODIAN",e[e.CJK_EARTHLY_BRANCH=15]="CJK_EARTHLY_BRANCH",e[e.CJK_HEAVENLY_STEM=16]="CJK_HEAVENLY_STEM",e[e.CJK_IDEOGRAPHIC=17]="CJK_IDEOGRAPHIC",e[e.DEVANAGARI=18]="DEVANAGARI",e[e.ETHIOPIC_NUMERIC=19]="ETHIOPIC_NUMERIC",e[e.GEORGIAN=20]="GEORGIAN",e[e.GUJARATI=21]="GUJARATI",e[e.GURMUKHI=22]="GURMUKHI",e[e.HEBREW=22]="HEBREW",e[e.HIRAGANA=23]="HIRAGANA",e[e.HIRAGANA_IROHA=24]="HIRAGANA_IROHA",e[e.JAPANESE_FORMAL=25]="JAPANESE_FORMAL",e[e.JAPANESE_INFORMAL=26]="JAPANESE_INFORMAL",e[e.KANNADA=27]="KANNADA",e[e.KATAKANA=28]="KATAKANA",e[e.KATAKANA_IROHA=29]="KATAKANA_IROHA",e[e.KHMER=30]="KHMER",e[e.KOREAN_HANGUL_FORMAL=31]="KOREAN_HANGUL_FORMAL",e[e.KOREAN_HANJA_FORMAL=32]="KOREAN_HANJA_FORMAL",e[e.KOREAN_HANJA_INFORMAL=33]="KOREAN_HANJA_INFORMAL",e[e.LAO=34]="LAO",e[e.LOWER_ARMENIAN=35]="LOWER_ARMENIAN",e[e.MALAYALAM=36]="MALAYALAM",e[e.MONGOLIAN=37]="MONGOLIAN",e[e.MYANMAR=38]="MYANMAR",e[e.ORIYA=39]="ORIYA",e[e.PERSIAN=40]="PERSIAN",e[e.SIMP_CHINESE_FORMAL=41]="SIMP_CHINESE_FORMAL",e[e.SIMP_CHINESE_INFORMAL=42]="SIMP_CHINESE_INFORMAL",e[e.TAMIL=43]="TAMIL",e[e.TELUGU=44]="TELUGU",e[e.THAI=45]="THAI",e[e.TIBETAN=46]="TIBETAN",e[e.TRAD_CHINESE_FORMAL=47]="TRAD_CHINESE_FORMAL",e[e.TRAD_CHINESE_INFORMAL=48]="TRAD_CHINESE_INFORMAL",e[e.UPPER_ARMENIAN=49]="UPPER_ARMENIAN",e[e.DISCLOSURE_OPEN=50]="DISCLOSURE_OPEN",e[e.DISCLOSURE_CLOSED=51]="DISCLOSURE_CLOSED",e))(zt||{});const tv={name:"list-style-type",initialValue:"none",prefix:!1,type:Yt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},ME=e=>({name:"margin-".concat(e),initialValue:"0",prefix:!1,type:Yt.TOKEN_VALUE}),Khe=ME("top"),Yhe=ME("right"),Xhe=ME("bottom"),Qhe=ME("left"),Jhe={name:"opacity",initialValue:"1",type:Yt.VALUE,prefix:!1,parse:(e,t)=>Ng(t)?t.number:1};var nv=(e=>(e[e.VISIBLE=0]="VISIBLE",e[e.HIDDEN=1]="HIDDEN",e[e.SCROLL=2]="SCROLL",e[e.CLIP=3]="CLIP",e[e.AUTO=4]="AUTO",e))(nv||{});const Zhe={name:"overflow",initialValue:"visible",prefix:!1,type:Yt.LIST,parse:(e,t)=>t.filter(Ms).map(n=>{switch(n.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})};var z7=(e=>(e.NORMAL="normal",e.BREAK_WORD="break-word",e))(z7||{});const epe={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:Yt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},UE=e=>({name:"padding-".concat(e),initialValue:"0",prefix:!1,type:Yt.TYPE_VALUE,format:"length-percentage"}),tpe=UE("top"),npe=UE("right"),spe=UE("bottom"),rpe=UE("left");var sv=(e=>(e[e.FILL=0]="FILL",e[e.STROKE=1]="STROKE",e[e.MARKERS=2]="MARKERS",e))(sv||{});const ape={name:"paint-order",initialValue:"normal",prefix:!1,type:Yt.LIST,parse:(e,t)=>{const n=[0,1,2],s=[];return t.filter(Ms).forEach(a=>{switch(a.value){case"stroke":s.push(1);break;case"fill":s.push(0);break;case"markers":s.push(2);break}}),n.forEach(a=>{s.indexOf(a)===-1&&s.push(a)}),s}};var Sf=(e=>(e[e.STATIC=0]="STATIC",e[e.RELATIVE=1]="RELATIVE",e[e.ABSOLUTE=2]="ABSOLUTE",e[e.FIXED=3]="FIXED",e[e.STICKY=4]="STICKY",e))(Sf||{});const ope={name:"position",initialValue:"static",prefix:!1,type:Yt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},ipe={name:"quotes",initialValue:"none",prefix:!0,type:Yt.LIST,parse:(e,t)=>{if(t.length===0)return null;const n=t[0];if(n.type===It.IDENT_TOKEN&&n.value==="none")return null;const s=[],a=t.filter(zme);if(a.length%2!==0)return null;for(let o=0;o<a.length;o+=2){const i=a[o].value,l=a[o+1].value;s.push({open:i,close:l})}return s}},lR=(e,t,n)=>{if(!e)return"";const s=e[Math.min(t,e.length-1)];return s?n?s.open:s.close:""};var lp=(e=>(e[e.LEFT=0]="LEFT",e[e.CENTER=1]="CENTER",e[e.RIGHT=2]="RIGHT",e))(lp||{});const lpe={name:"text-align",initialValue:"left",prefix:!1,type:Yt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},cpe={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:Yt.TYPE_VALUE,format:"color"};var Hy=(e=>(e[e.NONE=0]="NONE",e[e.UNDERLINE=1]="UNDERLINE",e[e.OVERLINE=2]="OVERLINE",e[e.LINE_THROUGH=3]="LINE_THROUGH",e[e.BLINK=4]="BLINK",e))(Hy||{});const dpe={name:"text-decoration-line",initialValue:"none",prefix:!1,type:Yt.LIST,parse:(e,t)=>t.filter(Ms).map(n=>{switch(n.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(n=>n!==0)},upe={name:"text-shadow",initialValue:"none",type:Yt.LIST,prefix:!1,parse:(e,t)=>t.length===1&&ZT(t[0],"none")?[]:Cc(t).map(n=>{const s={color:Zc.TRANSPARENT,offsetX:Ia,offsetY:Ia,blur:Ia};let a=0;for(let o=0;o<n.length;o++){const i=n[o];Mu(i)?(a===0?s.offsetX=i:a===1?s.offsetY=i:s.blur=i,a++):s.color=_u.parse(e,i)}return s})};var zy=(e=>(e[e.NONE=0]="NONE",e[e.LOWERCASE=1]="LOWERCASE",e[e.UPPERCASE=2]="UPPERCASE",e[e.CAPITALIZE=3]="CAPITALIZE",e))(zy||{});const fpe={name:"text-transform",initialValue:"none",prefix:!1,type:Yt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},mpe={name:"transform",initialValue:"none",prefix:!0,type:Yt.VALUE,parse:(e,t)=>{if(t.type===It.IDENT_TOKEN&&t.value==="none")return null;if(t.type===It.FUNCTION){const n=gpe[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported transform function "'.concat(t.name,'"'));return n(t.values)}return null}},hpe=e=>{const t=e.filter(n=>n.type===It.NUMBER_TOKEN).map(n=>n.number);return t.length===6?t:null},ppe=e=>{const t=e.filter(c=>c.type===It.NUMBER_TOKEN).map(c=>c.number),[n,s,{},{},a,o,{},{},{},{},{},{},i,l,{},{}]=t;return t.length===16?[n,s,a,o,i,l]:null},gpe={matrix:hpe,matrix3d:ppe},cR={type:It.PERCENTAGE_TOKEN,number:50,flags:Z0},_pe=[cR,cR],xpe={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:Yt.LIST,parse:(e,t)=>{const n=t.filter(Pr);return n.length!==2?_pe:[n[0],n[1]]}};var q7=(e=>(e[e.VISIBLE=0]="VISIBLE",e[e.HIDDEN=1]="HIDDEN",e[e.COLLAPSE=2]="COLLAPSE",e))(q7||{});const ype={name:"visible",initialValue:"none",prefix:!1,type:Yt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},bpe={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:Yt.TYPE_VALUE,format:"color"},Fpe={name:"-webkit-text-stroke-width",initialValue:"0",type:Yt.VALUE,prefix:!1,parse:(e,t)=>ex(t)?t.number:0},wpe={name:"word-break",initialValue:"normal",prefix:!1,type:Yt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"break-all":return"break-all";case"keep-all":return"keep-all";case"normal":default:return"normal"}}},Epe={name:"z-index",initialValue:"auto",prefix:!1,type:Yt.VALUE,parse:(e,t)=>{if(t.type===It.IDENT_TOKEN)return{auto:!0,order:0};if(Ng(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}};class Cpe{constructor(t,n){q(this,"animationDuration");q(this,"backgroundClip");q(this,"backgroundColor");q(this,"backgroundImage");q(this,"backgroundOrigin");q(this,"backgroundPosition");q(this,"backgroundRepeat");q(this,"backgroundSize");q(this,"borderTopColor");q(this,"borderRightColor");q(this,"borderBottomColor");q(this,"borderLeftColor");q(this,"borderTopLeftRadius");q(this,"borderTopRightRadius");q(this,"borderBottomRightRadius");q(this,"borderBottomLeftRadius");q(this,"borderTopStyle");q(this,"borderRightStyle");q(this,"borderBottomStyle");q(this,"borderLeftStyle");q(this,"borderTopWidth");q(this,"borderRightWidth");q(this,"borderBottomWidth");q(this,"borderLeftWidth");q(this,"boxShadow");q(this,"color");q(this,"direction");q(this,"display");q(this,"float");q(this,"fontFamily");q(this,"fontSize");q(this,"fontStyle");q(this,"fontVariant");q(this,"fontWeight");q(this,"letterSpacing");q(this,"lineBreak");q(this,"lineHeight");q(this,"listStyleImage");q(this,"listStylePosition");q(this,"listStyleType");q(this,"marginTop");q(this,"marginRight");q(this,"marginBottom");q(this,"marginLeft");q(this,"opacity");q(this,"overflowX");q(this,"overflowY");q(this,"overflowWrap");q(this,"paddingTop");q(this,"paddingRight");q(this,"paddingBottom");q(this,"paddingLeft");q(this,"paintOrder");q(this,"position");q(this,"textAlign");q(this,"textDecorationColor");q(this,"textDecorationLine");q(this,"textShadow");q(this,"textTransform");q(this,"transform");q(this,"transformOrigin");q(this,"visibility");q(this,"webkitTextStrokeColor");q(this,"webkitTextStrokeWidth");q(this,"wordBreak");q(this,"zIndex");var a,o;this.animationDuration=Bt(t,Lhe,n.animationDuration),this.backgroundClip=Bt(t,Yme,n.backgroundClip),this.backgroundColor=Bt(t,Xme,n.backgroundColor),this.backgroundImage=Bt(t,ahe,n.backgroundImage),this.backgroundOrigin=Bt(t,ohe,n.backgroundOrigin),this.backgroundPosition=Bt(t,ihe,n.backgroundPosition),this.backgroundRepeat=Bt(t,lhe,n.backgroundRepeat),this.backgroundSize=Bt(t,dhe,n.backgroundSize),this.borderTopColor=Bt(t,fhe,n.borderTopColor),this.borderRightColor=Bt(t,mhe,n.borderRightColor),this.borderBottomColor=Bt(t,hhe,n.borderBottomColor),this.borderLeftColor=Bt(t,phe,n.borderLeftColor),this.borderTopLeftRadius=Bt(t,ghe,n.borderTopLeftRadius),this.borderTopRightRadius=Bt(t,_he,n.borderTopRightRadius),this.borderBottomRightRadius=Bt(t,xhe,n.borderBottomRightRadius),this.borderBottomLeftRadius=Bt(t,yhe,n.borderBottomLeftRadius),this.borderTopStyle=Bt(t,bhe,n.borderTopStyle),this.borderRightStyle=Bt(t,Fhe,n.borderRightStyle),this.borderBottomStyle=Bt(t,whe,n.borderBottomStyle),this.borderLeftStyle=Bt(t,Ehe,n.borderLeftStyle),this.borderTopWidth=Bt(t,Che,n.borderTopWidth),this.borderRightWidth=Bt(t,khe,n.borderRightWidth),this.borderBottomWidth=Bt(t,The,n.borderBottomWidth),this.borderLeftWidth=Bt(t,vhe,n.borderLeftWidth),this.boxShadow=Bt(t,Ihe,n.boxShadow),this.color=Bt(t,Nhe,n.color),this.direction=Bt(t,Ahe,n.direction),this.display=Bt(t,Rhe,n.display),this.float=Bt(t,Bhe,n.cssFloat),this.fontFamily=Bt(t,Ohe,n.fontFamily),this.fontSize=Bt(t,Mhe,n.fontSize),this.fontStyle=Bt(t,Uhe,n.fontStyle),this.fontVariant=Bt(t,Vhe,n.fontVariant),this.fontWeight=Bt(t,$he,n.fontWeight),this.letterSpacing=Bt(t,Hhe,n.letterSpacing),this.lineBreak=Bt(t,zhe,n.lineBreak),this.lineHeight=Bt(t,qhe,n.lineHeight),this.listStyleImage=Bt(t,Ghe,n.listStyleImage),this.listStylePosition=Bt(t,Whe,n.listStylePosition),this.listStyleType=Bt(t,tv,n.listStyleType),this.marginTop=Bt(t,Khe,n.marginTop),this.marginRight=Bt(t,Yhe,n.marginRight),this.marginBottom=Bt(t,Xhe,n.marginBottom),this.marginLeft=Bt(t,Qhe,n.marginLeft),this.opacity=Bt(t,Jhe,n.opacity);const s=Bt(t,Zhe,n.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=Bt(t,epe,n.overflowWrap),this.paddingTop=Bt(t,tpe,n.paddingTop),this.paddingRight=Bt(t,npe,n.paddingRight),this.paddingBottom=Bt(t,spe,n.paddingBottom),this.paddingLeft=Bt(t,rpe,n.paddingLeft),this.paintOrder=Bt(t,ape,n.paintOrder),this.position=Bt(t,ope,n.position),this.textAlign=Bt(t,lpe,n.textAlign),this.textDecorationColor=Bt(t,cpe,(a=n.textDecorationColor)!=null?a:n.color),this.textDecorationLine=Bt(t,dpe,(o=n.textDecorationLine)!=null?o:n.textDecoration),this.textShadow=Bt(t,upe,n.textShadow),this.textTransform=Bt(t,fpe,n.textTransform),this.transform=Bt(t,mpe,n.transform),this.transformOrigin=Bt(t,xpe,n.transformOrigin),this.visibility=Bt(t,ype,n.visibility),this.webkitTextStrokeColor=Bt(t,bpe,n.webkitTextStrokeColor),this.webkitTextStrokeWidth=Bt(t,Fpe,n.webkitTextStrokeWidth),this.wordBreak=Bt(t,wpe,n.wordBreak),this.zIndex=Bt(t,Epe,n.zIndex)}isVisible(){return this.display>0&&this.opacity>0&&this.visibility===q7.VISIBLE}isTransparent(){return xu(this.backgroundColor)}isTransformed(){return this.transform!==null}isPositioned(){return this.position!==Sf.STATIC}isPositionedWithZIndex(){return this.isPositioned()&&!this.zIndex.auto}isFloating(){return this.float!==H7.NONE}isInlineLevel(){return Kr(this.display,Vl.INLINE)||Kr(this.display,Vl.INLINE_BLOCK)||Kr(this.display,Vl.INLINE_FLEX)||Kr(this.display,Vl.INLINE_GRID)||Kr(this.display,Vl.INLINE_LIST_ITEM)||Kr(this.display,Vl.INLINE_TABLE)}}class kpe{constructor(t,n){q(this,"content");q(this,"quotes");this.content=Bt(t,jhe,n.content),this.quotes=Bt(t,ipe,n.quotes)}}class dR{constructor(t,n){q(this,"counterIncrement");q(this,"counterReset");this.counterIncrement=Bt(t,She,n.counterIncrement),this.counterReset=Bt(t,Dhe,n.counterReset)}}const Bt=(e,t,n)=>{const s=new E7,a=n!==null&&typeof n<"u"?n.toString():t.initialValue;s.write(a);const o=new ip(s.read());switch(t.type){case Yt.IDENT_VALUE:{const i=o.parseComponentValue();return t.parse(e,Ms(i)?i.value:t.initialValue)}case Yt.VALUE:return t.parse(e,o.parseComponentValue());case Yt.LIST:return t.parse(e,o.parseComponentValues());case Yt.TOKEN_VALUE:return o.parseComponentValue();case Yt.TYPE_VALUE:switch(t.format){case"angle":return AE.parse(e,o.parseComponentValue());case"color":return _u.parse(e,o.parseComponentValue());case"image":return dj.parse(e,o.parseComponentValue());case"length":{const i=o.parseComponentValue();return Mu(i)?i:Ia}case"length-percentage":return Pr(a)?a:Ia;case"time":return $7.parse(e,o.parseComponentValue())}}};class Tpe{constructor(){q(this,"counters",{})}getCounterValue(t){const n=this.counters[t];return n&&n.length?n[n.length-1]:1}getCounterValues(t){const n=this.counters[t];return n||[]}pop(t){t.forEach(n=>this.counters[n].pop())}parse(t){const{counterIncrement:n}=t,{counterReset:s}=t;let a=!0;n!==null&&n.forEach(i=>{const l=this.counters[i.counter];l&&i.increment!==0&&(a=!1,l.length||l.push(1),l[Math.max(0,l.length-1)]+=i.increment)});const o=[];return a&&s.forEach(i=>{let l=this.counters[i.counter];o.push(i.counter),l||(l=this.counters[i.counter]=[]),l.push(i.reset)}),o}}const uR={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},fR={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},vpe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},Ipe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},kh=(e,t,n,s,a,o)=>e<t||e>n?T1(e,a,o.length>0):s.integers.reduce((i,l,c)=>{for(;e>=l;)e-=l,i+=s.values[c];return i},"")+o,G7=(e,t,n,s)=>{let a="";do n||e--,a=s(e)+a,e/=t;while(e*t>=t);return a},wr=(e,t,n,s,a)=>{const o=n-t+1;return(e<0?"-":"")+(G7(Math.abs(e),o,s,i=>Dr(Math.floor(i%o)+t))+a)},wf=(e,t,n=". ")=>{const s=t.length;return G7(Math.abs(e),s,!1,a=>t[Math.floor(a%s)])+n},jh=1,Ud=2,Vd=4,C_=8,Sc=(e,t,n,s,a,o)=>{if(e<-9999||e>9999)return T1(e,zt.CJK_DECIMAL,a.length>0);let i=Math.abs(e),l=a;if(i===0)return t[0]+l;for(let c=0;i>0&&c<=4;c++){const d=i%10;d===0&&Kr(o,jh)&&l!==""?l=t[d]+l:d>1||d===1&&c===0||d===1&&c===1&&Kr(o,Ud)||d===1&&c===1&&Kr(o,Vd)&&e>100||d===1&&c>1&&Kr(o,C_)?l=t[d]+(c>0?n[c-1]:"")+l:d===1&&c>0&&(l=n[c-1]+l),i=Math.floor(i/10)}return(e<0?s:"")+l},mR="十百千萬",hR="拾佰仟萬",pR="マイナス",IC="마이너스",T1=(e,t,n)=>{const s=n?". ":"",a=n?"、":"",o=n?", ":"",i=n?" ":"";switch(t){case zt.DISC:return"•".concat(i);case zt.CIRCLE:return"◦".concat(i);case zt.SQUARE:return"◾".concat(i);case zt.DECIMAL_LEADING_ZERO:{const l=wr(e,48,57,!0,s);return l.length<4?"0".concat(l):l}case zt.CJK_DECIMAL:return wf(e,"〇一二三四五六七八九",a);case zt.LOWER_ROMAN:return kh(e,1,3999,uR,zt.DECIMAL,s).toLowerCase();case zt.UPPER_ROMAN:return kh(e,1,3999,uR,zt.DECIMAL,s);case zt.LOWER_GREEK:return wr(e,945,969,!1,s);case zt.LOWER_ALPHA:return wr(e,97,122,!1,s);case zt.UPPER_ALPHA:return wr(e,65,90,!1,s);case zt.ARABIC_INDIC:return wr(e,1632,1641,!0,s);case zt.ARMENIAN:case zt.UPPER_ARMENIAN:return kh(e,1,9999,fR,zt.DECIMAL,s);case zt.LOWER_ARMENIAN:return kh(e,1,9999,fR,zt.DECIMAL,s).toLowerCase();case zt.BENGALI:return wr(e,2534,2543,!0,s);case zt.CAMBODIAN:case zt.KHMER:return wr(e,6112,6121,!0,s);case zt.CJK_EARTHLY_BRANCH:return wf(e,"子丑寅卯辰巳午未申酉戌亥",a);case zt.CJK_HEAVENLY_STEM:return wf(e,"甲乙丙丁戊己庚辛壬癸",a);case zt.CJK_IDEOGRAPHIC:case zt.TRAD_CHINESE_INFORMAL:return Sc(e,"零一二三四五六七八九",mR,"負",a,Ud|Vd|C_);case zt.TRAD_CHINESE_FORMAL:return Sc(e,"零壹貳參肆伍陸柒捌玖",hR,"負",a,jh|Ud|Vd|C_);case zt.SIMP_CHINESE_INFORMAL:return Sc(e,"零一二三四五六七八九",mR,"负",a,Ud|Vd|C_);case zt.SIMP_CHINESE_FORMAL:return Sc(e,"零壹贰叁肆伍陆柒捌玖",hR,"负",a,jh|Ud|Vd|C_);case zt.JAPANESE_INFORMAL:return Sc(e,"〇一二三四五六七八九","十百千万",pR,a,0);case zt.JAPANESE_FORMAL:return Sc(e,"零壱弐参四伍六七八九","拾百千万",pR,a,jh|Ud|Vd);case zt.KOREAN_HANGUL_FORMAL:return Sc(e,"영일이삼사오육칠팔구","십백천만",IC,o,jh|Ud|Vd);case zt.KOREAN_HANJA_INFORMAL:return Sc(e,"零一二三四五六七八九","十百千萬",IC,o,0);case zt.KOREAN_HANJA_FORMAL:return Sc(e,"零壹貳參四五六七八九","拾百千",IC,o,jh|Ud|Vd);case zt.DEVANAGARI:return wr(e,2406,2415,!0,s);case zt.GEORGIAN:return kh(e,1,19999,Ipe,zt.DECIMAL,s);case zt.GUJARATI:return wr(e,2790,2799,!0,s);case zt.GURMUKHI:return wr(e,2662,2671,!0,s);case zt.HEBREW:return kh(e,1,10999,vpe,zt.DECIMAL,s);case zt.HIRAGANA:return wf(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case zt.HIRAGANA_IROHA:return wf(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case zt.KANNADA:return wr(e,3302,3311,!0,s);case zt.KATAKANA:return wf(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",a);case zt.KATAKANA_IROHA:return wf(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",a);case zt.LAO:return wr(e,3792,3801,!0,s);case zt.MONGOLIAN:return wr(e,6160,6169,!0,s);case zt.MYANMAR:return wr(e,4160,4169,!0,s);case zt.ORIYA:return wr(e,2918,2927,!0,s);case zt.PERSIAN:return wr(e,1776,1785,!0,s);case zt.TAMIL:return wr(e,3046,3055,!0,s);case zt.TELUGU:return wr(e,3174,3183,!0,s);case zt.THAI:return wr(e,3664,3673,!0,s);case zt.TIBETAN:return wr(e,3872,3881,!0,s);case zt.DECIMAL:default:return wr(e,48,57,!0,s)}};var al=(e=>(e[e.CREATES_STACKING_CONTEXT=2]="CREATES_STACKING_CONTEXT",e[e.CREATES_REAL_STACKING_CONTEXT=4]="CREATES_REAL_STACKING_CONTEXT",e[e.IS_LIST_OWNER=8]="IS_LIST_OWNER",e[e.DEBUG_RENDER=16]="DEBUG_RENDER",e))(al||{});class kc{constructor(t,n){q(this,"styles");q(this,"textNodes",[]);q(this,"elements",[]);q(this,"bounds");q(this,"flags",0);if(this.context=t,ev(n,mF.PARSE))debugger;this.styles=new Cpe(t,window.getComputedStyle(n,null)),av(n)&&(this.styles.animationDuration.some(s=>s>0)&&(n.style.animationDuration="0s"),this.styles.transform!==null&&(n.style.transform="none")),this.bounds=DE(this.context,n),ev(n,mF.RENDER)&&(this.flags|=16)}}class W7 extends kc{constructor(n,s){super(n,s);q(this,"value");this.value=s.value}}class rv extends kc{constructor(n,s){super(n,s);q(this,"start");q(this,"reversed");this.start=s.start,this.reversed=typeof s.reversed=="boolean"&&s.reversed===!0}}class K7 extends kc{constructor(n,s){super(n,s);q(this,"value");const a=s.options[s.selectedIndex||0];this.value=a&&a.text||""}}class Y7 extends kc{constructor(n,s){super(n,s);q(this,"value");this.value=s.value}}class X7 extends kc{constructor(n,s){super(n,s);q(this,"canvas");q(this,"intrinsicWidth");q(this,"intrinsicHeight");this.canvas=s,this.intrinsicWidth=s.width,this.intrinsicHeight=s.height}}class Q7 extends kc{constructor(n,s){super(n,s);q(this,"src");q(this,"width");q(this,"height");q(this,"tree");q(this,"backgroundColor");this.src=s.src,this.width=parseInt(s.width,10)||0,this.height=parseInt(s.height,10)||0,this.backgroundColor=this.styles.backgroundColor;try{if(s.contentWindow&&s.contentWindow.document&&s.contentWindow.document.documentElement){this.tree=tU(n,s.contentWindow.document.documentElement);const a=s.contentWindow.document.documentElement?q_(n,getComputedStyle(s.contentWindow.document.documentElement).backgroundColor):Zc.TRANSPARENT,o=s.contentWindow.document.body?q_(n,getComputedStyle(s.contentWindow.document.body).backgroundColor):Zc.TRANSPARENT;this.backgroundColor=xu(a)?xu(o)?this.styles.backgroundColor:o:a}}catch(a){}}}class J7 extends kc{constructor(n,s){super(n,s);q(this,"src");q(this,"intrinsicWidth");q(this,"intrinsicHeight");this.src=s.currentSrc||s.src,this.intrinsicWidth=s.naturalWidth,this.intrinsicHeight=s.naturalHeight,this.context.cache.addImage(this.src)}}const Npe=[{type:It.DIMENSION_TOKEN,flags:0,unit:"px",number:3}],jpe=[{type:It.PERCENTAGE_TOKEN,flags:0,number:50}],Spe=e=>e.width>e.height?new xl(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new xl(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e,Dpe=e=>{const t=e.type===Ape?new Array(e.value.length+1).join("•"):e.value;return t.length===0?e.placeholder||"":t},pF="checkbox",gF="radio",Ape="password",gR=707406591;class uj extends kc{constructor(n,s){super(n,s);q(this,"type");q(this,"checked");q(this,"value");switch(this.type=s.type.toLowerCase(),this.checked=s.checked,this.value=Dpe(s),(this.type===pF||this.type===gF)&&(this.styles.backgroundColor=3739148031,this.styles.borderTopColor=this.styles.borderRightColor=this.styles.borderBottomColor=this.styles.borderLeftColor=2779096575,this.styles.borderTopWidth=this.styles.borderRightWidth=this.styles.borderBottomWidth=this.styles.borderLeftWidth=1,this.styles.borderTopStyle=this.styles.borderRightStyle=this.styles.borderBottomStyle=this.styles.borderLeftStyle=Fo.SOLID,this.styles.backgroundClip=[Jf.BORDER_BOX],this.styles.backgroundOrigin=[hF.BORDER_BOX],this.bounds=Spe(this.bounds)),this.type){case pF:this.styles.borderTopRightRadius=this.styles.borderTopLeftRadius=this.styles.borderBottomRightRadius=this.styles.borderBottomLeftRadius=Npe;break;case gF:this.styles.borderTopRightRadius=this.styles.borderTopLeftRadius=this.styles.borderBottomRightRadius=this.styles.borderBottomLeftRadius=jpe;break}}}class Z7 extends kc{constructor(n,s){super(n,s);q(this,"svg");q(this,"intrinsicWidth");q(this,"intrinsicHeight");const a=new XMLSerializer,o=DE(n,s);s.setAttribute("width","".concat(o.width,"px")),s.setAttribute("height","".concat(o.height,"px")),this.svg="data:image/svg+xml,".concat(encodeURIComponent(a.serializeToString(s))),this.intrinsicWidth=s.width.baseVal.value,this.intrinsicHeight=s.height.baseVal.value,this.context.cache.addImage(this.svg)}}class W_{constructor(t,n){q(this,"text");q(this,"bounds");this.text=t,this.bounds=n}}const Rpe=(e,t,n,s)=>{const a=Bpe(t,n),o=[];let i=0;return a.forEach(l=>{if(n.textDecorationLine.length||l.trim().length>0)if(Ea.SUPPORT_RANGE_BOUNDS){const c=_R(s,i,l.length).getClientRects();if(c.length>1){const d=fj(l);let u=0;d.forEach(f=>{o.push(new W_(f,xl.fromDOMRectList(e,_R(s,u+i,f.length).getClientRects()))),u+=f.length})}else o.push(new W_(l,xl.fromDOMRectList(e,c)))}else{const c=s.splitText(l.length);o.push(new W_(l,Ppe(e,s))),s=c}else Ea.SUPPORT_RANGE_BOUNDS||(s=s.splitText(l.length));i+=l.length}),o},Ppe=(e,t)=>{const{ownerDocument:n}=t;if(n){const s=n.createElement("html2canvaswrapper");s.appendChild(t.cloneNode(!0));const{parentNode:a}=t;if(a){a.replaceChild(s,t);const o=DE(e,s);return s.firstChild&&a.replaceChild(s.firstChild,s),o}}return xl.EMPTY},_R=(e,t,n)=>{const{ownerDocument:s}=e;if(!s)throw new Error("Node has no owner document");const a=s.createRange();return a.setStart(e,t),a.setEnd(e,t+n),a},fj=e=>{if(Ea.SUPPORT_NATIVE_TEXT_SEGMENTATION){const t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(n=>n.segment)}return rK(e)},Lpe=(e,t)=>{if(Ea.SUPPORT_NATIVE_TEXT_SEGMENTATION){const n=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(n.segment(e)).map(s=>s.segment)}return Mpe(e,t)},Bpe=(e,t)=>t.letterSpacing!==0?fj(e):Lpe(e,t),Ope=[32,160,4961,65792,65793,4153,4241],Mpe=(e,t)=>{const n=aK(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap===z7.BREAK_WORD?"break-word":t.wordBreak}),s=[];let a;for(;!(a=n.next()).done;)if(a.value){const o=a.value.slice(),i=t3(o);let l="";i.forEach(c=>{Ope.indexOf(c)===-1?l+=Dr(c):(l.length&&s.push(l),s.push(Dr(c)),l="")}),l.length&&s.push(l)}return s};class Upe{constructor(t,n,s){q(this,"text");q(this,"textBounds");this.text=Vpe(n.data,s.textTransform),this.textBounds=Rpe(t,this.text,s,n)}}const Vpe=(e,t)=>{switch(t){case zy.LOWERCASE:return e.toLowerCase();case zy.CAPITALIZE:return e.replace($pe,Hpe);case zy.UPPERCASE:return e.toUpperCase();default:return e}},$pe=/(^|\s|:|-|\(|\))([a-z])/g,Hpe=(e,t,n)=>e.length>0?t+n.toUpperCase():e,zpe=["OL","UL","MENU"],qy=(e,t,n,s)=>{for(let a=t.firstChild,o;a;a=o)if(o=a.nextSibling,nU(a)&&a.data.trim().length>0)n.textNodes.push(new Upe(e,a,n.styles));else if(Gh(a))if(oU(a)&&a.assignedNodes)a.assignedNodes().forEach(i=>qy(e,i,n,s));else{const i=eU(e,a);i.styles.isVisible()&&(qpe(a,i,s)?i.flags|=al.CREATES_REAL_STACKING_CONTEXT:Gpe(i.styles)&&(i.flags|=al.CREATES_STACKING_CONTEXT),zpe.indexOf(a.tagName)!==-1&&(i.flags|=al.IS_LIST_OWNER),n.elements.push(i),a.slot,a.shadowRoot?qy(e,a.shadowRoot,i,s):!_F(a)&&!sU(a)&&!xF(a)&&qy(e,a,i,s))}},eU=(e,t)=>ov(t)?new J7(e,t):rU(t)?new X7(e,t):sU(t)?new Z7(e,t):Wpe(t)?new W7(e,t):Kpe(t)?new rv(e,t):Ype(t)?new uj(e,t):xF(t)?new K7(e,t):_F(t)?new Y7(e,t):aU(t)?new Q7(e,t):new kc(e,t),tU=(e,t)=>{const n=eU(e,t);return n.flags|=al.CREATES_REAL_STACKING_CONTEXT,qy(e,t,n,n),n},qpe=(e,t,n)=>t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||mj(e)&&n.styles.isTransparent(),Gpe=e=>e.isPositioned()||e.isFloating(),nU=e=>e.nodeType===Node.TEXT_NODE,Gh=e=>e.nodeType===Node.ELEMENT_NODE,av=e=>Gh(e)&&typeof e.style<"u"&&!Gy(e),Gy=e=>typeof e.className=="object",Wpe=e=>e.tagName==="LI",Kpe=e=>e.tagName==="OL",Ype=e=>e.tagName==="INPUT",Xpe=e=>e.tagName==="HTML",sU=e=>e.tagName==="svg",mj=e=>e.tagName==="BODY",rU=e=>e.tagName==="CANVAS",xR=e=>e.tagName==="VIDEO",ov=e=>e.tagName==="IMG",aU=e=>e.tagName==="IFRAME",yR=e=>e.tagName==="STYLE",Qpe=e=>e.tagName==="SCRIPT",_F=e=>e.tagName==="TEXTAREA",xF=e=>e.tagName==="SELECT",oU=e=>e.tagName==="SLOT",bR=e=>e.tagName.indexOf("-")>0,iU="data-html2canvas-ignore";class FR{constructor(t,n,s){q(this,"scrolledElements");q(this,"referenceElement");q(this,"clonedReferenceElement");q(this,"documentElement");q(this,"counters");q(this,"quoteDepth");q(this,"count",0);if(this.context=t,this.options=s,this.scrolledElements=[],this.referenceElement=n,this.counters=new Tpe,this.quoteDepth=0,!n.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(n.ownerDocument.documentElement,!1),this.clonedReferenceElement||(this.clonedReferenceElement=this.cloneNode(this.referenceElement,!0),this.documentElement.appendChild(this.clonedReferenceElement))}toIFrame(t,n){const s=Jpe(t,n);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");const a=t.defaultView.pageXOffset,o=t.defaultView.pageYOffset,i=s.contentWindow,l=i.document,c=tge(s).then(async()=>{this.scrolledElements.forEach(age),i&&(i.scrollTo(n.left,n.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(i.scrollY!==n.top||i.scrollX!==n.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(i.scrollX-n.left,i.scrollY-n.top,0,0)));const{onclone:d}=this.options,u=this.clonedReferenceElement;return typeof u>"u"?Promise.reject("Error finding the ".concat(this.referenceElement.nodeName," in the cloned document")):(l.fonts&&l.fonts.ready&&await l.fonts.ready,/(AppleWebKit)/g.test(navigator.userAgent)&&await ege(l),typeof d=="function"?Promise.resolve().then(()=>d(l,u)).then(()=>s):s)});return l.open(),l.write("".concat(sge(document.doctype),"<html></html>")),rge(this.referenceElement.ownerDocument,a,o),l.replaceChild(l.adoptNode(this.documentElement),l.documentElement),l.close(),c}createElementClone(t){if(ev(t,mF.CLONE))debugger;if(rU(t))return this.createCanvasClone(t);if(xR(t))return this.createVideoClone(t);if(yR(t))return this.createStyleClone(t);const n=t.cloneNode(!1);return ov(n)&&(ov(t)&&t.currentSrc&&t.currentSrc!==t.src&&(n.src=t.currentSrc,n.srcset=""),n.loading==="lazy"&&(n.loading="eager")),bR(n)?this.createCustomElementClone(n):n}createCustomElementClone(t){const n=document.createElement("html2canvascustomelement");return NC(t.style,n),n}createStyleClone(t){try{const n=t.sheet;if(n&&n.cssRules){const s=[].slice.call(n.cssRules,0).reduce((o,i)=>i&&typeof i.cssText=="string"?o+i.cssText:o,""),a=t.cloneNode(!1);return a.textContent=s,a}}catch(n){if(this.context.logger.error("Unable to access cssRules property",n),(n==null?void 0:n.name)!=="SecurityError")throw n}return t.cloneNode(!1)}createCanvasClone(t){var s;if(this.options.inlineImages&&t.ownerDocument){const a=t.ownerDocument.createElement("img");try{return a.src=t.toDataURL(),a}catch(o){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}const n=t.cloneNode(!1);try{n.width=t.width,n.height=t.height;const a=t.getContext("2d"),o=n.getContext("2d");if(o)if(!this.options.allowTaint&&a)o.putImageData(a.getImageData(0,0,t.width,t.height),0,0);else{const i=(s=t.getContext("webgl2"))!=null?s:t.getContext("webgl");if(i){const l=i.getContextAttributes();(l==null?void 0:l.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}o.drawImage(t,0,0)}return n}catch(a){this.context.logger.info("Unable to clone canvas as it is tainted",t)}return n}createVideoClone(t){const n=t.ownerDocument.createElement("canvas");n.width=t.offsetWidth,n.height=t.offsetHeight;const s=n.getContext("2d");try{return s&&(s.drawImage(t,0,0,n.width,n.height),this.options.allowTaint||s.getImageData(0,0,n.width,n.height)),n}catch(o){this.context.logger.info("Unable to clone video as it is tainted",t)}const a=t.ownerDocument.createElement("canvas");return a.width=t.offsetWidth,a.height=t.offsetHeight,a}appendChildNode(t,n,s){(!Gh(n)||!Qpe(n)&&!n.hasAttribute(iU)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(n)))&&(!this.options.copyStyles||!Gh(n)||!yR(n))&&t.appendChild(this.cloneNode(n,s))}cloneChildNodes(t,n,s){for(let a=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;a;a=a.nextSibling)if(Gh(a)&&oU(a)&&typeof a.assignedNodes=="function"){const o=a.assignedNodes();o.length&&o.forEach(i=>this.appendChildNode(n,i,s))}else this.appendChildNode(n,a,s)}cloneNode(t,n){if(this.count++,nU(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);const s=t.ownerDocument.defaultView;if(s&&Gh(t)&&(av(t)||Gy(t))){const a=this.createElementClone(t);a.style.transitionProperty="none";const o=s.getComputedStyle(t),i=s.getComputedStyle(t,":before"),l=s.getComputedStyle(t,":after");this.referenceElement===t&&av(a)&&(this.clonedReferenceElement=a),mj(a)&&lge(a);const c=this.counters.parse(new dR(this.context,o)),d=this.resolvePseudoContent(t,a,i,0);bR(t)&&(n=!0),xR(t)||this.options.isMobile&&this.count>500||this.cloneChildNodes(t,a,n),d&&a.insertBefore(d,a.firstChild);const u=this.resolvePseudoContent(t,a,l,1);return u&&a.appendChild(u),this.counters.pop(c),(o&&(this.options.copyStyles||Gy(t))&&!aU(t)||n)&&NC(o,a),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([a,t.scrollLeft,t.scrollTop]),(_F(t)||xF(t))&&(_F(a)||xF(a))&&(a.value=t.value),a}return t.cloneNode(!1)}resolvePseudoContent(t,n,s,a){if(!s)return;const o=s.content,i=n.ownerDocument;if(!i||!o||o==="none"||o==="-moz-alt-content"||s.display==="none")return;this.counters.parse(new dR(this.context,s));const l=new kpe(this.context,s),c=i.createElement("html2canvaspseudoelement");NC(s,c),l.content.forEach(u=>{if(u.type===It.STRING_TOKEN)c.appendChild(i.createTextNode(u.value));else if(u.type===It.URL_TOKEN){const f=i.createElement("img");f.src=u.value,f.style.opacity="1",c.appendChild(f)}else if(u.type===It.FUNCTION){if(u.name==="attr"){const f=u.values.filter(Ms);f.length&&c.appendChild(i.createTextNode(t.getAttribute(f[0].value)||""))}else if(u.name==="counter"){const[f,h]=u.values.filter(Sp);if(f&&Ms(f)){const p=this.counters.getCounterValue(f.value),g=h&&Ms(h)?tv.parse(this.context,h.value):zt.DECIMAL;c.appendChild(i.createTextNode(T1(p,g,!1)))}}else if(u.name==="counters"){const[f,h,p]=u.values.filter(Sp);if(f&&Ms(f)){const g=this.counters.getCounterValues(f.value),_=p&&Ms(p)?tv.parse(this.context,p.value):zt.DECIMAL,x=h&&h.type===It.STRING_TOKEN?h.value:"",F=g.map(b=>T1(b,_,!1)).join(x);c.appendChild(i.createTextNode(F))}}}else if(u.type===It.IDENT_TOKEN)switch(u.value){case"open-quote":c.appendChild(i.createTextNode(lR(l.quotes,this.quoteDepth++,!0)));break;case"close-quote":c.appendChild(i.createTextNode(lR(l.quotes,--this.quoteDepth,!1)));break;default:c.appendChild(i.createTextNode(u.value))}}),c.className="".concat(iv," ").concat(lv);const d=a===0?" ".concat(iv):" ".concat(lv);return Gy(n)?n.className.baseValue+=d:n.className+=d,c}static destroy(t){var n,s;return t.parentNode?((s=(n=t.parentNode)==null?void 0:n.removeChild)==null||s.call(n,t),!0):!1}}const Jpe=(e,t)=>{const n=e.createElement("iframe");return n.className="html2canvas-container",n.style.visibility="hidden",n.style.position="fixed",n.style.left="-10000px",n.style.top="0px",n.style.border="0",n.width=t.width.toString(),n.height=t.height.toString(),n.scrolling="no",n.setAttribute(iU,"true"),e.body.appendChild(n),n},Zpe=e=>new Promise(t=>{if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t}),ege=e=>Promise.all([].slice.call(e.images,0).map(Zpe)),tge=e=>new Promise((t,n)=>{const s=e.contentWindow;if(!s)return n("No window assigned for iframe");const a=s.document;s.onload=e.onload=()=>{s.onload=e.onload=null;const o=setInterval(()=>{a.body.childNodes.length>0&&a.readyState==="complete"&&(clearInterval(o),t(e))},50)}}),nge=["all","d","content"],NC=(e,t)=>{for(let n=e.length-1;n>=0;n--){const s=e.item(n);nge.indexOf(s)===-1&&t.style.setProperty(s,e.getPropertyValue(s))}return t},sge=e=>{let t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'.concat(e.publicId,'"')),e.systemId&&(t+='"'.concat(e.systemId,'"')),t+=">"),t},rge=(e,t,n)=>{e&&e.defaultView&&(t!==e.defaultView.pageXOffset||n!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,n)},age=([e,t,n])=>{e.scrollLeft=t,e.scrollTop=n},oge=":before",ige=":after",iv="___html2canvas___pseudoelement_before",lv="___html2canvas___pseudoelement_after",wR='{\n    content: "" !important;\n    display: none !important;\n}',lge=e=>{cge(e,".".concat(iv).concat(oge).concat(wR,"\n         .").concat(lv).concat(ige).concat(wR))},cge=(e,t)=>{const n=e.ownerDocument;if(n){const s=n.createElement("style");s.textContent=t,e.appendChild(s)}},lU=e=>{const{bounds:t}=e,{styles:n}=e;return t.add(n.borderLeftWidth,n.borderTopWidth,-(n.borderRightWidth+n.borderLeftWidth),-(n.borderTopWidth+n.borderBottomWidth))},yF=e=>{const{styles:t}=e,{bounds:n}=e,s=zs(t.paddingLeft,n.width),a=zs(t.paddingRight,n.width),o=zs(t.paddingTop,n.width),i=zs(t.paddingBottom,n.width);return n.add(s+t.borderLeftWidth,o+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+s+a),-(t.borderTopWidth+t.borderBottomWidth+o+i))};var VE=(e=>(e[e.VECTOR=0]="VECTOR",e[e.BEZIER_CURVE=1]="BEZIER_CURVE",e))(VE||{});const ER=(e,t)=>e.length===t.length?e.some((n,s)=>n===t[s]):!1,dge=(e,t,n,s,a)=>e.map((o,i)=>{switch(i){case 0:return o.add(t,n);case 1:return o.add(t+s,n);case 2:return o.add(t+s,n+a);case 3:return o.add(t,n+a)}return o});class jt{constructor(t,n){q(this,"type");q(this,"x");q(this,"y");this.type=VE.VECTOR,this.x=t,this.y=n}add(t,n){return new jt(this.x+t,this.y+n)}}const uge=(e,t)=>e===hF.BORDER_BOX?t.bounds:e===hF.CONTENT_BOX?yF(t):lU(t),fge=(e,t)=>e===Jf.BORDER_BOX?t.bounds:e===Jf.CONTENT_BOX?yF(t):lU(t),jC=(e,t,n)=>{const s=uge(Sh(e.styles.backgroundOrigin,t),e),a=fge(Sh(e.styles.backgroundClip,t),e),o=mge(Sh(e.styles.backgroundSize,t),n,s),[i,l]=o,c=E_(Sh(e.styles.backgroundPosition,t),s.width-i,s.height-l),d=hge(Sh(e.styles.backgroundRepeat,t),c,o,s,a),u=Math.round(s.left+c[0]),f=Math.round(s.top+c[1]);return[d,u,f,i,l]},Th=e=>Ms(e)&&e.value===G_.AUTO,uy=e=>typeof e=="number",mge=(e,[t,n,s],a)=>{const[o,i]=e;if(!o)return[0,0];if(Pr(o)&&i&&Pr(i))return[zs(o,a.width),zs(i,a.height)];const l=uy(s);if(Ms(o)&&(o.value===G_.CONTAIN||o.value===G_.COVER))return uy(s)?a.width/a.height<s!=(o.value===G_.COVER)?[a.width,a.width/s]:[a.height*s,a.height]:[a.width,a.height];const c=uy(t),d=uy(n),u=c||d;if(Th(o)&&(!i||Th(i))){if(c&&d)return[t,n];if(!l&&!u)return[a.width,a.height];if(u&&l){const _=c?t:n*s,x=d?n:t/s;return[_,x]}const p=c?t:a.width,g=d?n:a.height;return[p,g]}if(l){let p=0,g=0;return Pr(o)?p=zs(o,a.width):Pr(i)&&(g=zs(i,a.height)),Th(o)?p=g*s:(!i||Th(i))&&(g=p/s),[p,g]}let f=null,h=null;if(Pr(o)?f=zs(o,a.width):i&&Pr(i)&&(h=zs(i,a.height)),f!==null&&(!i||Th(i))&&(h=c&&d?f/t*n:a.height),h!==null&&Th(o)&&(f=c&&d?h/n*t:a.width),f!==null&&h!==null)return[f,h];throw new Error("Unable to calculate background-size for element")},Sh=(e,t)=>{const n=e[t];return typeof n>"u"?e[0]:n},hge=(e,[t,n],[s,a],o,i)=>{switch(e){case $y.REPEAT_X:return[new jt(Math.round(o.left),Math.round(o.top+n)),new jt(Math.round(o.left+o.width),Math.round(o.top+n)),new jt(Math.round(o.left+o.width),Math.round(a+o.top+n)),new jt(Math.round(o.left),Math.round(a+o.top+n))];case $y.REPEAT_Y:return[new jt(Math.round(o.left+t),Math.round(o.top)),new jt(Math.round(o.left+t+s),Math.round(o.top)),new jt(Math.round(o.left+t+s),Math.round(o.height+o.top)),new jt(Math.round(o.left+t),Math.round(o.height+o.top))];case $y.NO_REPEAT:return[new jt(Math.round(o.left+t),Math.round(o.top+n)),new jt(Math.round(o.left+t+s),Math.round(o.top+n)),new jt(Math.round(o.left+t+s),Math.round(o.top+n+a)),new jt(Math.round(o.left+t),Math.round(o.top+n+a))];default:return[new jt(Math.round(i.left),Math.round(i.top)),new jt(Math.round(i.left+i.width),Math.round(i.top)),new jt(Math.round(i.left+i.width),Math.round(i.height+i.top)),new jt(Math.round(i.left),Math.round(i.height+i.top))]}},vh=(e,t,n)=>new jt(e.x+(t.x-e.x)*n,e.y+(t.y-e.y)*n);class Gc{constructor(t,n,s,a){q(this,"type");q(this,"start");q(this,"startControl");q(this,"endControl");q(this,"end");this.type=VE.BEZIER_CURVE,this.start=t,this.startControl=n,this.endControl=s,this.end=a}subdivide(t,n){const s=vh(this.start,this.startControl,t),a=vh(this.startControl,this.endControl,t),o=vh(this.endControl,this.end,t),i=vh(s,a,t),l=vh(a,o,t),c=vh(i,l,t);return n?new Gc(this.start,s,i,c):new Gc(c,l,o,this.end)}add(t,n){return new Gc(this.start.add(t,n),this.startControl.add(t,n),this.endControl.add(t,n),this.end.add(t,n))}reverse(){return new Gc(this.end,this.endControl,this.startControl,this.start)}}const yi=e=>e.type===VE.BEZIER_CURVE,CR=(e,t)=>{switch(t){case 0:return Ii(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return Ii(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return Ii(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return Ii(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},pge=(e,t)=>{switch(t){case 0:return Ii(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return Ii(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return Ii(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return Ii(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},gge=(e,t)=>{switch(t){case 0:return Ii(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return Ii(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return Ii(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return Ii(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},_ge=(e,t)=>{switch(t){case 0:return fy(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return fy(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return fy(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return fy(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},fy=(e,t)=>{const n=[];return yi(e)?n.push(e.subdivide(.5,!1)):n.push(e),yi(t)?n.push(t.subdivide(.5,!0)):n.push(t),n},Ii=(e,t,n,s)=>{const a=[];return yi(e)?a.push(e.subdivide(.5,!1)):a.push(e),yi(n)?a.push(n.subdivide(.5,!0)):a.push(n),yi(s)?a.push(s.subdivide(.5,!0).reverse()):a.push(s),yi(t)?a.push(t.subdivide(.5,!1).reverse()):a.push(t),a};class xge{constructor(t){q(this,"topLeftBorderDoubleOuterBox");q(this,"topRightBorderDoubleOuterBox");q(this,"bottomRightBorderDoubleOuterBox");q(this,"bottomLeftBorderDoubleOuterBox");q(this,"topLeftBorderDoubleInnerBox");q(this,"topRightBorderDoubleInnerBox");q(this,"bottomRightBorderDoubleInnerBox");q(this,"bottomLeftBorderDoubleInnerBox");q(this,"topLeftBorderStroke");q(this,"topRightBorderStroke");q(this,"bottomRightBorderStroke");q(this,"bottomLeftBorderStroke");q(this,"topLeftBorderBox");q(this,"topRightBorderBox");q(this,"bottomRightBorderBox");q(this,"bottomLeftBorderBox");q(this,"topLeftPaddingBox");q(this,"topRightPaddingBox");q(this,"bottomRightPaddingBox");q(this,"bottomLeftPaddingBox");q(this,"topLeftContentBox");q(this,"topRightContentBox");q(this,"bottomRightContentBox");q(this,"bottomLeftContentBox");const{styles:n}=t,{bounds:s}=t;let[a,o]=E_(n.borderTopLeftRadius,s.width,s.height),[i,l]=E_(n.borderTopRightRadius,s.width,s.height),[c,d]=E_(n.borderBottomRightRadius,s.width,s.height),[u,f]=E_(n.borderBottomLeftRadius,s.width,s.height);const h=[];h.push((a+i)/s.width),h.push((u+c)/s.width),h.push((o+f)/s.height),h.push((l+d)/s.height);const p=Math.max(...h);p>1&&(a/=p,o/=p,i/=p,l/=p,c/=p,d/=p,u/=p,f/=p);const g=s.width-i,_=s.height-d,x=s.width-c,F=s.height-f,{borderTopWidth:b}=n,{borderRightWidth:w}=n,{borderBottomWidth:E}=n,{borderLeftWidth:C}=n,k=zs(n.paddingTop,t.bounds.width),T=zs(n.paddingRight,t.bounds.width),v=zs(n.paddingBottom,t.bounds.width),I=zs(n.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=a>0||o>0?er(s.left+C/3,s.top+b/3,a-C/3,o-b/3,0):new jt(s.left+C/3,s.top+b/3),this.topRightBorderDoubleOuterBox=a>0||o>0?er(s.left+g,s.top+b/3,i-w/3,l-b/3,1):new jt(s.left+s.width-w/3,s.top+b/3),this.bottomRightBorderDoubleOuterBox=c>0||d>0?er(s.left+x,s.top+_,c-w/3,d-E/3,2):new jt(s.left+s.width-w/3,s.top+s.height-E/3),this.bottomLeftBorderDoubleOuterBox=u>0||f>0?er(s.left+C/3,s.top+F,u-C/3,f-E/3,3):new jt(s.left+C/3,s.top+s.height-E/3),this.topLeftBorderDoubleInnerBox=a>0||o>0?er(s.left+C*2/3,s.top+b*2/3,a-C*2/3,o-b*2/3,0):new jt(s.left+C*2/3,s.top+b*2/3),this.topRightBorderDoubleInnerBox=a>0||o>0?er(s.left+g,s.top+b*2/3,i-w*2/3,l-b*2/3,1):new jt(s.left+s.width-w*2/3,s.top+b*2/3),this.bottomRightBorderDoubleInnerBox=c>0||d>0?er(s.left+x,s.top+_,c-w*2/3,d-E*2/3,2):new jt(s.left+s.width-w*2/3,s.top+s.height-E*2/3),this.bottomLeftBorderDoubleInnerBox=u>0||f>0?er(s.left+C*2/3,s.top+F,u-C*2/3,f-E*2/3,3):new jt(s.left+C*2/3,s.top+s.height-E*2/3),this.topLeftBorderStroke=a>0||o>0?er(s.left+C/2,s.top+b/2,a-C/2,o-b/2,0):new jt(s.left+C/2,s.top+b/2),this.topRightBorderStroke=a>0||o>0?er(s.left+g,s.top+b/2,i-w/2,l-b/2,1):new jt(s.left+s.width-w/2,s.top+b/2),this.bottomRightBorderStroke=c>0||d>0?er(s.left+x,s.top+_,c-w/2,d-E/2,2):new jt(s.left+s.width-w/2,s.top+s.height-E/2),this.bottomLeftBorderStroke=u>0||f>0?er(s.left+C/2,s.top+F,u-C/2,f-E/2,3):new jt(s.left+C/2,s.top+s.height-E/2),this.topLeftBorderBox=a>0||o>0?er(s.left,s.top,a,o,0):new jt(s.left,s.top),this.topRightBorderBox=i>0||l>0?er(s.left+g,s.top,i,l,1):new jt(s.left+s.width,s.top),this.bottomRightBorderBox=c>0||d>0?er(s.left+x,s.top+_,c,d,2):new jt(s.left+s.width,s.top+s.height),this.bottomLeftBorderBox=u>0||f>0?er(s.left,s.top+F,u,f,3):new jt(s.left,s.top+s.height),this.topLeftPaddingBox=a>0||o>0?er(s.left+C,s.top+b,Math.max(0,a-C),Math.max(0,o-b),0):new jt(s.left+C,s.top+b),this.topRightPaddingBox=i>0||l>0?er(s.left+Math.min(g,s.width-w),s.top+b,g>s.width+w?0:Math.max(0,i-w),Math.max(0,l-b),1):new jt(s.left+s.width-w,s.top+b),this.bottomRightPaddingBox=c>0||d>0?er(s.left+Math.min(x,s.width-C),s.top+Math.min(_,s.height-E),Math.max(0,c-w),Math.max(0,d-E),2):new jt(s.left+s.width-w,s.top+s.height-E),this.bottomLeftPaddingBox=u>0||f>0?er(s.left+C,s.top+Math.min(F,s.height-E),Math.max(0,u-C),Math.max(0,f-E),3):new jt(s.left+C,s.top+s.height-E),this.topLeftContentBox=a>0||o>0?er(s.left+C+I,s.top+b+k,Math.max(0,a-(C+I)),Math.max(0,o-(b+k)),0):new jt(s.left+C+I,s.top+b+k),this.topRightContentBox=i>0||l>0?er(s.left+Math.min(g,s.width+C+I),s.top+b+k,g>s.width+C+I?0:i-C+I,l-(b+k),1):new jt(s.left+s.width-(w+T),s.top+b+k),this.bottomRightContentBox=c>0||d>0?er(s.left+Math.min(x,s.width-(C+I)),s.top+Math.min(_,s.height+b+k),Math.max(0,c-(w+T)),d-(E+v),2):new jt(s.left+s.width-(w+T),s.top+s.height-(E+v)),this.bottomLeftContentBox=u>0||f>0?er(s.left+C+I,s.top+F,Math.max(0,u-(C+I)),f-(E+v),3):new jt(s.left+C+I,s.top+s.height-(E+v))}}const er=(e,t,n,s,a)=>{const o=4*((Math.sqrt(2)-1)/3),i=n*o,l=s*o,c=e+n,d=t+s;switch(a){case 0:return new Gc(new jt(e,d),new jt(e,d-l),new jt(c-i,t),new jt(c,t));case 1:return new Gc(new jt(e,t),new jt(e+i,t),new jt(c,d-l),new jt(c,d));case 2:return new Gc(new jt(c,t),new jt(c,t+l),new jt(e+i,d),new jt(e,d));case 3:default:return new Gc(new jt(c,d),new jt(c-i,d),new jt(e,t+l),new jt(e,t))}},bF=e=>[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox],yge=e=>[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox],FF=e=>[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox];var Oc=(e=>(e[e.BACKGROUND_BORDERS=2]="BACKGROUND_BORDERS",e[e.CONTENT=4]="CONTENT",e))(Oc||{});class bge{constructor(t,n,s){q(this,"type",0);q(this,"target",6);this.offsetX=t,this.offsetY=n,this.matrix=s}}class my{constructor(t,n){q(this,"type",1);this.path=t,this.target=n}}class Fge{constructor(t){q(this,"type",2);q(this,"target",6);this.opacity=t}}const wge=e=>e.type===0,cU=e=>e.type===1,Ege=e=>e.type===2,Cge="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",kR="Hidden Text";class kge{constructor(t){q(this,"_data");q(this,"_document");this._data={},this._document=t}parseMetrics(t,n){const s=this._document.createElement("div"),a=this._document.createElement("img"),o=this._document.createElement("span"),i=this._document.body;s.style.visibility="hidden",s.style.fontFamily=t,s.style.fontSize=n,s.style.margin="0",s.style.padding="0",s.style.whiteSpace="nowrap",i.appendChild(s),a.src=Cge,a.width=1,a.height=1,a.style.margin="0",a.style.padding="0",a.style.verticalAlign="baseline",o.style.fontFamily=t,o.style.fontSize=n,o.style.margin="0",o.style.padding="0",o.appendChild(this._document.createTextNode(kR)),s.appendChild(o),s.appendChild(a);const l=a.offsetTop-o.offsetTop+2;s.removeChild(o),s.appendChild(this._document.createTextNode(kR)),s.style.lineHeight="normal",a.style.verticalAlign="super";const c=a.offsetTop-s.offsetTop+2;return i.removeChild(s),{baseline:l,middle:c}}getMetrics(t,n){const s="".concat(t," ").concat(n);return typeof this._data[s]>"u"&&(this._data[s]=this.parseMetrics(t,n)),this._data[s]}}class dU{constructor(t,n){this.context=t,this.options=n}}class uU{constructor(t){q(this,"element");q(this,"negativeZIndex");q(this,"zeroOrAutoZIndexOrTransformedOrOpacity");q(this,"positiveZIndex");q(this,"nonPositionedFloats");q(this,"nonPositionedInlineLevel");q(this,"inlineLevel");q(this,"nonInlineLevel");this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}}class fU{constructor(t,n){q(this,"effects",[]);q(this,"curves");q(this,"listValue");if(this.container=t,this.parent=n,this.curves=new xge(this.container),this.container.styles.opacity<1&&this.effects.push(new Fge(this.container.styles.opacity)),this.container.styles.transform!==null){const s=this.container.bounds.left+this.container.styles.transformOrigin[0].number,a=this.container.bounds.top+this.container.styles.transformOrigin[1].number,o=this.container.styles.transform;this.effects.push(new bge(s,a,o))}if(this.container.styles.overflowX!==nv.VISIBLE){const s=bF(this.curves),a=FF(this.curves);ER(s,a)?this.effects.push(new my(s,Oc.BACKGROUND_BORDERS|Oc.CONTENT)):(this.effects.push(new my(s,Oc.BACKGROUND_BORDERS)),this.effects.push(new my(a,Oc.CONTENT)))}}getEffects(t){let n=[Sf.ABSOLUTE,Sf.FIXED].indexOf(this.container.styles.position)===-1,{parent:s}=this;const a=this.effects.slice(0);for(;s;){const o=s.effects.filter(i=>!cU(i));if(n||s.container.styles.position!==Sf.STATIC||!s.parent){if(a.unshift(...o),n=[Sf.ABSOLUTE,Sf.FIXED].indexOf(s.container.styles.position)===-1,s.container.styles.overflowX!==nv.VISIBLE){const i=bF(s.curves),l=FF(s.curves);ER(i,l)||a.unshift(new my(l,Oc.BACKGROUND_BORDERS|Oc.CONTENT))}}else a.unshift(...o);s=s.parent}return a.filter(o=>Kr(o.target,t))}}const cv=(e,t,n,s)=>{e.container.elements.forEach(a=>{const o=Kr(a.flags,al.CREATES_REAL_STACKING_CONTEXT),i=Kr(a.flags,al.CREATES_STACKING_CONTEXT),l=new fU(a,e);Kr(a.styles.display,Vl.LIST_ITEM)&&s.push(l);const c=Kr(a.flags,al.IS_LIST_OWNER)?[]:s;if(o||i){const d=o||a.styles.isPositioned()?n:t,u=new uU(l);if(a.styles.isPositioned()||a.styles.opacity<1||a.styles.isTransformed()){const{order:f}=a.styles.zIndex;if(f<0){let h=0;d.negativeZIndex.some((p,g)=>f>p.element.container.styles.zIndex.order?(h=g,!1):h>0),d.negativeZIndex.splice(h,0,u)}else if(f>0){let h=0;d.positiveZIndex.some((p,g)=>f>=p.element.container.styles.zIndex.order?(h=g+1,!1):h>0),d.positiveZIndex.splice(h,0,u)}else d.zeroOrAutoZIndexOrTransformedOrOpacity.push(u)}else a.styles.isFloating()?d.nonPositionedFloats.push(u):d.nonPositionedInlineLevel.push(u);cv(l,u,o?u:n,c)}else a.styles.isInlineLevel()?t.inlineLevel.push(l):t.nonInlineLevel.push(l),cv(l,t,n,c);Kr(a.flags,al.IS_LIST_OWNER)&&mU(a,c)})},mU=(e,t)=>{let n=e instanceof rv?e.start:1;const s=e instanceof rv?e.reversed:!1;for(let a=0;a<t.length;a++){const o=t[a];o.container instanceof W7&&typeof o.container.value=="number"&&o.container.value!==0&&(n=o.container.value),o.listValue=T1(n,o.container.styles.listStyleType,!0),n+=s?-1:1}},Tge=e=>{const t=new fU(e,null),n=new uU(t),s=[];return cv(t,n,n,s),mU(t.container,s),n},vge=1e4;class hj extends dU{constructor(n,s){super(n,s);q(this,"canvas");q(this,"ctx");q(this,"_activeEffects",[]);q(this,"fontMetrics");this.canvas=s.canvas?s.canvas:document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),s.canvas||(this.canvas.width=Math.floor(s.width*s.scale),this.canvas.height=Math.floor(s.height*s.scale),this.canvas.style.width="".concat(s.width,"px"),this.canvas.style.height="".concat(s.height,"px")),this.fontMetrics=new kge(document),this.ctx.scale(this.options.scale,this.options.scale),this.ctx.translate(-s.x,-s.y),this.ctx.textBaseline="bottom",this._activeEffects=[],this.context.logger.debug("Canvas renderer initialized (".concat(s.width,"x").concat(s.height,") with scale ").concat(s.scale))}applyEffects(n){for(;this._activeEffects.length;)this.popEffect();n.forEach(s=>this.applyEffect(s))}applyEffect(n){this.ctx.save(),Ege(n)&&(this.ctx.globalAlpha=n.opacity),wge(n)&&(this.ctx.translate(n.offsetX,n.offsetY),this.ctx.transform(n.matrix[0],n.matrix[1],n.matrix[2],n.matrix[3],n.matrix[4],n.matrix[5]),this.ctx.translate(-n.offsetX,-n.offsetY)),cU(n)&&(this.path(n.path),this.ctx.clip()),this._activeEffects.push(n)}popEffect(){this._activeEffects.pop(),this.ctx.restore()}async renderStack(n){const{styles:s}=n.element.container;s.isVisible()&&await this.renderStackContent(n)}async renderNode(n){if(Kr(n.container.flags,al.DEBUG_RENDER))debugger;n.container.styles.isVisible()&&(await this.renderNodeBackgroundAndBorders(n),await this.renderNodeContent(n))}renderTextWithLetterSpacing(n,s,a){s===0?this.ctx.fillText(n.text,n.bounds.left,n.bounds.top+a):fj(n.text).reduce((i,l)=>(this.ctx.fillText(l,i,n.bounds.top+a),i+this.ctx.measureText(l).width),n.bounds.left)}createFontStyle(n){const s=n.fontVariant.filter(i=>i==="normal"||i==="small-caps").join(""),a=Dge(n.fontFamily).join(", "),o=ex(n.fontSize)?"".concat(n.fontSize.number).concat(n.fontSize.unit):"".concat(n.fontSize.number,"px");return[[n.fontStyle,s,n.fontWeight,o,a].join(" "),a,o]}async renderTextNode(n,s){const[a,o,i]=this.createFontStyle(s);this.ctx.font=a,this.ctx.direction=s.direction===V7.RTL?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic";let{baseline:l,middle:c}=this.fontMetrics.getMetrics(o,i);l=l-8;const{paintOrder:d}=s;n.textBounds.forEach(u=>{d.forEach(f=>{switch(f){case sv.FILL:{this.ctx.fillStyle=Vr(s.color),this.renderTextWithLetterSpacing(u,s.letterSpacing,l);const h=s.textShadow;h.length&&u.text.trim().length&&(h.slice(0).reverse().forEach(p=>{this.ctx.shadowColor=Vr(p.color),this.ctx.shadowOffsetX=p.offsetX.number*this.options.scale,this.ctx.shadowOffsetY=p.offsetY.number*this.options.scale,this.ctx.shadowBlur=p.blur.number,this.renderTextWithLetterSpacing(u,s.letterSpacing,l)}),this.ctx.shadowColor="",this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0,this.ctx.shadowBlur=0),s.textDecorationLine.length&&(this.ctx.fillStyle=Vr(s.textDecorationColor||s.color),s.textDecorationLine.forEach(p=>{switch(p){case Hy.UNDERLINE:this.ctx.fillRect(u.bounds.left,Math.round(u.bounds.top+l),u.bounds.width,1);break;case Hy.OVERLINE:this.ctx.fillRect(u.bounds.left,Math.round(u.bounds.top),u.bounds.width,1);break;case Hy.LINE_THROUGH:this.ctx.fillRect(u.bounds.left,Math.ceil(u.bounds.top+c),u.bounds.width,1);break}}));break}case sv.STROKE:s.webkitTextStrokeWidth&&u.text.trim().length&&(this.ctx.strokeStyle=Vr(s.webkitTextStrokeColor),this.ctx.lineWidth=s.webkitTextStrokeWidth,this.ctx.lineJoin=window.chrome?"miter":"round",this.ctx.strokeText(u.text,u.bounds.left,u.bounds.top+l)),this.ctx.strokeStyle="",this.ctx.lineWidth=0,this.ctx.lineJoin="miter";break}})})}renderReplacedElement(n,s,a){if(a&&n.intrinsicWidth>0&&n.intrinsicHeight>0){const o=yF(n),i=FF(s);this.path(i),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(a,0,0,n.intrinsicWidth,n.intrinsicHeight,o.left,o.top,o.width,o.height),this.ctx.restore()}}async renderNodeContent(n){this.applyEffects(n.getEffects(Oc.CONTENT));const{container:s}=n,{curves:a}=n,{styles:o}=s;for(const i of s.textNodes)await this.renderTextNode(i,o);if(s instanceof J7)try{const i=await this.context.cache.match(s.src);this.renderReplacedElement(s,a,i)}catch(i){this.context.logger.error("Error loading image ".concat(s.src))}if(s instanceof X7&&this.renderReplacedElement(s,a,s.canvas),s instanceof Z7)try{const i=await this.context.cache.match(s.svg);this.renderReplacedElement(s,a,i)}catch(i){this.context.logger.error("Error loading svg ".concat(s.svg.substring(0,255)))}if(s instanceof Q7&&s.tree){const l=await new hj(this.context,{scale:this.options.scale,backgroundColor:s.backgroundColor,x:0,y:0,width:s.width,height:s.height}).render(s.tree);s.width&&s.height&&this.ctx.drawImage(l,0,0,s.width,s.height,s.bounds.left,s.bounds.top,s.bounds.width,s.bounds.height)}if(s instanceof uj){const i=Math.min(s.bounds.width,s.bounds.height);s.type===pF?s.checked&&(this.ctx.save(),this.path([new jt(s.bounds.left+i*.39363,s.bounds.top+i*.79),new jt(s.bounds.left+i*.16,s.bounds.top+i*.5549),new jt(s.bounds.left+i*.27347,s.bounds.top+i*.44071),new jt(s.bounds.left+i*.39694,s.bounds.top+i*.5649),new jt(s.bounds.left+i*.72983,s.bounds.top+i*.23),new jt(s.bounds.left+i*.84,s.bounds.top+i*.34085),new jt(s.bounds.left+i*.39363,s.bounds.top+i*.79)]),this.ctx.fillStyle=Vr(gR),this.ctx.fill(),this.ctx.restore()):s.type===gF&&s.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(s.bounds.left+i/2,s.bounds.top+i/2,i/4,0,Math.PI*2,!0),this.ctx.fillStyle=Vr(gR),this.ctx.fill(),this.ctx.restore())}if(Ige(s)&&s.value.length){const[i,l]=this.createFontStyle(o),{baseline:c}=this.fontMetrics.getMetrics(i,l);this.ctx.font=i,this.ctx.fillStyle=Vr(o.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=jge(s.styles.textAlign);const d=yF(s);let u=0;switch(s.styles.textAlign){case lp.CENTER:u+=d.width/2;break;case lp.RIGHT:u+=d.width;break}const f=d.add(u,0,0,-d.height/2+1);this.ctx.save(),this.path([new jt(d.left,d.top),new jt(d.left+d.width,d.top),new jt(d.left+d.width,d.top+d.height),new jt(d.left,d.top+d.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new W_(s.value,f),o.letterSpacing,c),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(Kr(s.styles.display,Vl.LIST_ITEM)){if(s.styles.listStyleImage!==null){const i=s.styles.listStyleImage;if(i.type===rl.URL){let l;const{url:c}=i;try{l=await this.context.cache.match(c),this.ctx.drawImage(l,s.bounds.left-(l.width+10),s.bounds.top)}catch(d){this.context.logger.error("Error loading list-style-image ".concat(c))}}}else if(n.listValue&&s.styles.listStyleType!==zt.NONE){const[i]=this.createFontStyle(o);this.ctx.font=i,this.ctx.fillStyle=Vr(o.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right";const l=new xl(s.bounds.left,s.bounds.top+zs(s.styles.paddingTop,s.bounds.width),s.bounds.width,iR(o.lineHeight,o.fontSize.number)/2+1);this.renderTextWithLetterSpacing(new W_(n.listValue,l),o.letterSpacing,iR(o.lineHeight,o.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"}}}async renderStackContent(n){if(Kr(n.element.container.flags,al.DEBUG_RENDER))debugger;await this.renderNodeBackgroundAndBorders(n.element);for(const s of n.negativeZIndex)await this.renderStack(s);await this.renderNodeContent(n.element);for(const s of n.nonInlineLevel)await this.renderNode(s);for(const s of n.nonPositionedFloats)await this.renderStack(s);for(const s of n.nonPositionedInlineLevel)await this.renderStack(s);for(const s of n.inlineLevel)await this.renderNode(s);for(const s of n.zeroOrAutoZIndexOrTransformedOrOpacity)await this.renderStack(s);for(const s of n.positiveZIndex)await this.renderStack(s)}mask(n){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(n.slice(0).reverse()),this.ctx.closePath()}path(n){this.ctx.beginPath(),this.formatPath(n),this.ctx.closePath()}formatPath(n){n.forEach((s,a)=>{const o=yi(s)?s.start:s;a===0?this.ctx.moveTo(o.x,o.y):this.ctx.lineTo(o.x,o.y),yi(s)&&this.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})}renderRepeat(n,s,a,o){this.path(n),this.ctx.fillStyle=s,this.ctx.translate(a,o),this.ctx.fill(),this.ctx.translate(-a,-o)}resizeImage(n,s,a){var c;if(n.width===s&&n.height===a)return n;const i=((c=this.canvas.ownerDocument)!=null?c:document).createElement("canvas");return i.width=Math.max(1,s),i.height=Math.max(1,a),i.getContext("2d").drawImage(n,0,0,n.width,n.height,0,0,s,a),i}async renderBackgroundImage(n){let s=n.styles.backgroundImage.length-1;for(const a of n.styles.backgroundImage.slice(0).reverse()){if(a.type===rl.URL){let o;const{url:i}=a;try{o=await this.context.cache.match(i)}catch(l){this.context.logger.error("Error loading background-image ".concat(i))}if(o){const[l,c,d,u,f]=jC(n,s,[o.width,o.height,o.width/o.height]),h=this.ctx.createPattern(this.resizeImage(o,u,f),"repeat");this.renderRepeat(l,h,c,d)}}else if(nhe(a)){const o=n.textNodes.map(i=>i.textBounds);if(o.length>0)o.forEach(i=>{i.forEach((l,c)=>{const d=l.bounds.left,u=l.bounds.top,f=l.bounds.width,h=l.bounds.height,p=document.createElement("canvas");p.width=f,p.height=h;const g=p.getContext("2d"),_=g.createLinearGradient(d,u,d+f,u+h),[x,F,b,w,E]=aR(a.angle,f,h);if(vC(a.stops,x).forEach(C=>_.addColorStop(C.stop,Vr(C.color))),g.fillStyle=_,g.fillRect(0,0,f,h),f>0&&h>0){const C=[new jt(d,u),new jt(d+f,u),new jt(d+f,u+h),new jt(d,u+h)],k=this.ctx.createPattern(p,"repeat");this.renderRepeat(C,k,d,u)}})});else{const[i,l,c,d,u]=jC(n,s,[null,null,null]),[f,h,p,g,_]=aR(a.angle,d,u),x=document.createElement("canvas");x.width=d,x.height=u;const F=x.getContext("2d"),b=F.createLinearGradient(h,g,p,_);if(vC(a.stops,f).forEach(w=>b.addColorStop(w.stop,Vr(w.color))),F.fillStyle=b,F.fillRect(0,0,d,u),d>0&&u>0){const w=this.ctx.createPattern(x,"repeat");this.renderRepeat(i,w,l,c)}}}else if(she(a)){const[o,i,l,c,d]=jC(n,s,[null,null,null]),u=a.position.length===0?[cj]:a.position,f=zs(u[0],c),h=zs(u[u.length-1],d),[p,g]=Jme(a,f,h,c,d);if(p>0&&g>0){const _=this.ctx.createRadialGradient(i+f,l+h,0,i+f,l+h,p);if(vC(a.stops,p*2).forEach(x=>_.addColorStop(x.stop,Vr(x.color))),this.path(o),this.ctx.fillStyle=_,p!==g){const x=n.bounds.left+.5*n.bounds.width,F=n.bounds.top+.5*n.bounds.height,b=g/p,w=1/b;this.ctx.save(),this.ctx.translate(x,F),this.ctx.transform(1,0,0,b,0,0),this.ctx.translate(-x,-F),this.ctx.fillRect(i,w*(l-F)+F,c,d*w),this.ctx.restore()}else this.ctx.fill()}}s--}}async renderSolidBorder(n,s,a){this.path(CR(a,s)),this.ctx.fillStyle=Vr(n),this.ctx.fill()}async renderDoubleBorder(n,s,a,o){if(s<3){await this.renderSolidBorder(n,a,o);return}const i=pge(o,a);this.path(i),this.ctx.fillStyle=Vr(n),this.ctx.fill();const l=gge(o,a);this.path(l),this.ctx.fill()}async renderNodeBackgroundAndBorders(n){this.applyEffects(n.getEffects(Oc.BACKGROUND_BORDERS));const{styles:s}=n.container,a=!xu(s.backgroundColor)||s.backgroundImage.length,o=[{style:s.borderTopStyle,color:s.borderTopColor,width:s.borderTopWidth},{style:s.borderRightStyle,color:s.borderRightColor,width:s.borderRightWidth},{style:s.borderBottomStyle,color:s.borderBottomColor,width:s.borderBottomWidth},{style:s.borderLeftStyle,color:s.borderLeftColor,width:s.borderLeftWidth}],i=Nge(Sh(s.backgroundClip,0),n.curves);if(a||s.boxShadow.length){if(this.ctx.save(),this.path(i),this.ctx.clip(),!xu(s.backgroundColor))if(this.ctx.fillStyle=Vr(s.backgroundColor),s.display===Vl.INLINE)for(const c of n.container.textNodes)for(const d of c.textBounds)this.ctx.fillRect(d.bounds.left,d.bounds.top,d.bounds.width,d.bounds.height);else this.ctx.fill();await this.renderBackgroundImage(n.container),this.ctx.restore(),s.boxShadow.slice(0).reverse().forEach(c=>{this.ctx.save();const d=bF(n.curves),u=c.inset?0:vge,f=dge(d,-u+(c.inset?1:-1)*c.spread.number,(c.inset?1:-1)*c.spread.number,c.spread.number*(c.inset?-2:2),c.spread.number*(c.inset?-2:2));c.inset?(this.path(d),this.ctx.clip(),this.mask(f)):(this.mask(d),this.ctx.clip(),this.path(f)),this.ctx.shadowOffsetX=c.offsetX.number+u,this.ctx.shadowOffsetY=c.offsetY.number,this.ctx.shadowColor=Vr(c.color),this.ctx.shadowBlur=c.blur.number,this.ctx.fillStyle=c.inset?Vr(c.color):"rgba(0,0,0,1)",this.ctx.fill(),this.ctx.restore()})}let l=0;for(const c of o)c.style!==Fo.NONE&&!xu(c.color)&&c.width>0&&(c.style===Fo.DASHED?await this.renderDashedDottedBorder(c.color,c.width,l,n.curves,Fo.DASHED):c.style===Fo.DOTTED?await this.renderDashedDottedBorder(c.color,c.width,l,n.curves,Fo.DOTTED):c.style===Fo.DOUBLE?await this.renderDoubleBorder(c.color,c.width,l,n.curves):await this.renderSolidBorder(c.color,l,n.curves)),l++}async renderDashedDottedBorder(n,s,a,o,i){this.ctx.save();const l=_ge(o,a),c=CR(o,a);i===Fo.DASHED&&(this.path(c),this.ctx.clip());let d,u,f,h;yi(c[0])?(d=c[0].start.x,u=c[0].start.y):(d=c[0].x,u=c[0].y),yi(c[1])?(f=c[1].end.x,h=c[1].end.y):(f=c[1].x,h=c[1].y);let p;a===0||a===2?p=Math.abs(d-f):p=Math.abs(u-h),this.ctx.beginPath(),i===Fo.DOTTED?this.formatPath(l):this.formatPath(c.slice(0,2));let g=s<3?s*3:s*2,_=s<3?s*2:s;i===Fo.DOTTED&&(g=s,_=s);let x=!0;if(p<=g*2)x=!1;else if(p<=g*2+_){const F=p/(2*g+_);g*=F,_*=F}else{const F=Math.floor((p+_)/(g+_)),b=(p-F*g)/(F-1),w=(p-(F+1)*g)/F;_=w<=0||Math.abs(_-b)<Math.abs(_-w)?b:w}if(x&&(i===Fo.DOTTED?this.ctx.setLineDash([0,g+_]):this.ctx.setLineDash([g,_])),i===Fo.DOTTED?(this.ctx.lineCap="round",this.ctx.lineWidth=s):this.ctx.lineWidth=s*2+1.1,this.ctx.strokeStyle=Vr(n),this.ctx.stroke(),this.ctx.setLineDash([]),i===Fo.DASHED){if(yi(c[0])){const F=c[3],b=c[0];this.ctx.beginPath(),this.formatPath([new jt(F.end.x,F.end.y),new jt(b.start.x,b.start.y)]),this.ctx.stroke()}if(yi(c[1])){const F=c[1],b=c[2];this.ctx.beginPath(),this.formatPath([new jt(F.end.x,F.end.y),new jt(b.start.x,b.start.y)]),this.ctx.stroke()}}this.ctx.restore()}async render(n){this.options.backgroundColor&&(this.ctx.fillStyle=Vr(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height));const s=Tge(n);return await this.renderStack(s),this.applyEffects([]),this.canvas}}const Ige=e=>e instanceof Y7||e instanceof K7?!0:e instanceof uj&&e.type!==gF&&e.type!==pF,Nge=(e,t)=>{switch(e){case Jf.BORDER_BOX:return bF(t);case Jf.CONTENT_BOX:return yge(t);case Jf.PADDING_BOX:default:return FF(t)}},jge=e=>{switch(e){case lp.CENTER:return"center";case lp.RIGHT:return"right";case lp.LEFT:default:return"left"}},Sge=["-apple-system","system-ui"],Dge=e=>/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(t=>Sge.indexOf(t)===-1):e;class Age extends dU{constructor(n,s){super(n,s);q(this,"canvas");q(this,"ctx");q(this,"options");this.canvas=s.canvas?s.canvas:document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.options=s,this.canvas.width=Math.floor(s.width*s.scale),this.canvas.height=Math.floor(s.height*s.scale),this.canvas.style.width="".concat(s.width,"px"),this.canvas.style.height="".concat(s.height,"px"),this.ctx.scale(this.options.scale,this.options.scale),this.ctx.translate(-s.x,-s.y),this.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized (".concat(s.width,"x").concat(s.height," at ").concat(s.x,",").concat(s.y,") with scale ").concat(s.scale))}async render(n){const s=XT(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,n),a=await Rge(s);return this.options.backgroundColor&&(this.ctx.fillStyle=Vr(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(a,-this.options.x*this.options.scale,-this.options.y*this.options.scale),this.canvas}}const Rge=e=>new Promise((t,n)=>{const s=new Image;s.onload=()=>{t(s)},s.onerror=n,s.src="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(new XMLSerializer().serializeToString(e)))}),pj=(e,t={})=>Pge(e,t);typeof window<"u"&&dF.setContext(window);const Pge=async(e,t)=>{var C,k,T,v,I,j,S,D,A,P,L,O,$,M,U,z,K;if(!e||typeof e!="object")return Promise.reject("Invalid element provided as first argument");const{ownerDocument:n}=e;if(!n)throw new Error("Element is not attached to a Document");const{defaultView:s}=n;if(!s)throw new Error("Document is not attached to a Window");const a={allowTaint:(C=t.allowTaint)!=null?C:!1,imageTimeout:(k=t.imageTimeout)!=null?k:15e3,proxy:t.proxy,useCORS:(T=t.useCORS)!=null?T:!1},o={logging:(v=t.logging)!=null?v:!1,cache:t.cache,...a},i={windowWidth:(I=t.windowWidth)!=null?I:s.innerWidth,windowHeight:(j=t.windowHeight)!=null?j:s.innerHeight,scrollX:(S=t.scrollX)!=null?S:s.pageXOffset,scrollY:(D=t.scrollY)!=null?D:s.pageYOffset},l=new xl(i.scrollX,i.scrollY,i.windowWidth,i.windowHeight),c=new QT(o,l),d=(A=t.foreignObjectRendering)!=null?A:!1,u={allowTaint:(P=t.allowTaint)!=null?P:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:d,copyStyles:d,isMobile:t.isMobile};c.logger.debug("Starting document clone with size ".concat(l.width,"x").concat(l.height," scrolled to ").concat(-l.left,",").concat(-l.top));const f=new FR(c,e,u),h=f.clonedReferenceElement;if(!h)return Promise.reject("Unable to find element in cloned iframe");const p=await f.toIFrame(n,l),{width:g,height:_,left:x,top:F}=mj(h)||Xpe(h)?Ofe(h.ownerDocument):DE(c,h),b=Lge(c,h,t.backgroundColor),w={canvas:t.canvas,backgroundColor:b,scale:(O=(L=t.scale)!=null?L:s.devicePixelRatio)!=null?O:1,x:(($=t.x)!=null?$:0)+x,y:((M=t.y)!=null?M:0)+F,width:(U=t.width)!=null?U:Math.ceil(g),height:(z=t.height)!=null?z:Math.ceil(_)};let E;if(d)c.logger.debug("Document cloned, using foreign object rendering"),E=await new Age(c,w).render(h);else{c.logger.debug("Document cloned, element located at ".concat(x,",").concat(F," with size ").concat(g,"x").concat(_," using computed rendering")),c.logger.debug("Starting DOM parsing");const W=tU(c,h);b===W.styles.backgroundColor&&(W.styles.backgroundColor=Zc.TRANSPARENT),c.logger.debug("Starting renderer for element at ".concat(w.x,",").concat(w.y," with size ").concat(w.width,"x").concat(w.height)),E=await new hj(c,w).render(W)}return((K=t.removeContainer)==null||K)&&(FR.destroy(p)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),E},Lge=(e,t,n)=>{const{ownerDocument:s}=t,a=s.documentElement?q_(e,getComputedStyle(s.documentElement).backgroundColor):Zc.TRANSPARENT,o=s.body?q_(e,getComputedStyle(s.body).backgroundColor):Zc.TRANSPARENT,i=typeof n=="string"?q_(e,n):n===null?Zc.TRANSPARENT:4294967295;return t===s.documentElement?xu(a)?xu(o)?i:o:a:i},Bge=e=>{const{items:t=[],chunkSize:n=10,maxSize:s=100,renderItem:a,onProgress:o=()=>{}}=e,i=t.length,[l,c]=y.useState(s>=i),[d,u,f]=am(l?i:n),h=y.useRef(!1);return Yv(()=>{const p=()=>{TR(()=>{c(!0),o("end")})};if(!l){if(h.current){p();return}return h.current=!0,i>s?Promise.resolve().then(()=>{o("start");const g=()=>{TR(()=>{u(_=>_+n),f.current+n>=i?p():g()})};if(i>f.current){g();return}p()}):p(),p}},[i,t,l]),r.jsxs(r.Fragment,{children:[r.jsx(r.Fragment,{children:(l?t:[...t].splice(0,d)).map(p=>a==null?void 0:a(p))}),r.jsx(r.Fragment,{children:!l&&r.jsx("div",{className:"text-t2 text-grey3 flex items-center justify-center h-5",children:r.jsx($s,{size:"middle"})})})]})},TR=e=>{es(30).finally(()=>{e()})};var K_=(e=>(e.innerHtml="innerHtml",e.blank="blank",e))(K_||{});const gj=e=>{const{blockId:t,updateByBlock:n,...s}=e,{visible:a,setVisible:o,params:i,ref:l,content:c}=Oge(e);return r.jsxs(r.Fragment,{children:[n&&r.jsx(Mge,{blockId:t,visible:a,setVisible:o}),r.jsx("div",{...kn(s,["children","placeHolder","renderMode","rootMargin","container","delay","trackVisibility"]),...i,ref:l,children:c})]})},Oge=e=>{const{children:t,renderMode:n=K_.innerHtml,rootMargin:s,blockId:a,trackVisibility:o=!0,delay:i=150}=e,l=nf(),c=n===K_.innerHtml,d=n===K_.blank,[u,f]=y.useState(!1),h=y.useRef({visible:!1,html:"",height:34}),{ref:p,inView:g,entry:_}=Xv({root:l==null?void 0:l.current,rootMargin:s||"2000px 0px",fallbackInView:!0,trackVisibility:o,delay:i});y.useEffect(()=>{var b,w;if(_)if(g)h.current={visible:!0,html:"",height:_.boundingClientRect.height,width:_.boundingClientRect.width},f(!0);else{if((w=(b=_.target).contains)!=null&&w.call(b,document.activeElement))return;h.current={visible:!1,html:d?"":_.target.innerHTML,height:_.boundingClientRect.height,width:_.boundingClientRect.width},f(!1)}},[_,g,d]);let x={},F;return u?F=r.jsx(r.Fragment,{children:t}):(d&&(x={style:{height:h.current.height},"data-block-id":a}),c&&(x={dangerouslySetInnerHTML:{__html:h.current.html},...h.current.html?{}:{"data-block-id":a}})),{params:x,content:F,visible:u,setVisible:f,ref:p}},Mge=e=>{const{blockId:t,visible:n,setVisible:s}=e,a=ye(t,["status","subNodes","data"],["segments","format"]);return y.useLayoutEffect(()=>{n||s(!0)},[a]),r.jsx(r.Fragment,{})},hU=new Map,vR=({id:e})=>(ye(e,[]),null),rs=(e,t)=>{hU.set(e,t)},_j=e=>{var t;return e==null?vR:(t=hU.get(e))!=null?t:vR},IR=y.memo(({id:e,root:t=!1,type:n,subNodes:s=[],visibleRender:a})=>{const o=_j(n),i=y.useMemo(()=>{if(s.length)return s.map(l=>r.jsx(Xm,{id:l,visibleRender:a},l))},[s,a]);return r.jsx(yd,{scope:wg,initialValues:[[Eg,e]],children:r.jsx(o,{id:e,root:t,children:i})},"".concat(e,"-").concat(t))},yn),Uge=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.HEADER,m.BlockType.QUOTE,m.BlockType.PAGE,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.LINK_PAGE,m.BlockType.MARK,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE,m.BlockType.TOGGLE_HEADER],Vge=[m.BlockType.MIND_MAPPING,m.BlockType.PAGE],Xm=e=>{const{id:t,visibleRender:n,root:s}=e,a=ye(t,["subNodes"],[],{enableAuditTime:!1}),o=a==null?void 0:a.type,i=a==null?void 0:a.subNodes,l=o&&Vge.includes(o),c=y.useMemo(()=>!s||o===void 0?!1:l?!0:!(!n||pt()||!Uge.includes(o)),[o,l,s,n]);return o===void 0?null:c?r.jsx(gj,{blockId:t,renderMode:n,children:r.jsx(IR,{...e,subNodes:i,type:o})},"visible-".concat(t)):r.jsx(IR,{...e,subNodes:i,type:o},t)},$ge=y.memo(e=>{const t=_8(),{subNodes:n=[],visibleRender:s}=e;return r.jsx(Bge,{maxSize:ot.print?1/0:void 0,items:n,onProgress:a=>{t(a==="start")},renderItem:a=>r.jsx(Xm,{id:a,root:!0,visibleRender:s},a)})},yn),Hge=e=>{const t=ft(e.pageId,a=>a==null?void 0:a.spaceId),n=y.useRef(),s=ie();return r.jsxs("div",{className:"w-[420px] overflow-auto max-h-[90vh] bg-white1 relative",children:[r.jsx(zge,{onDownload:async()=>{var a;if(n.current){const o=s.loading({title:"下载中"}).modalId,i=await pj(n.current,{useCORS:!0,scale:window.devicePixelRatio}),l=fe((a=J.blocks[e.pageId])==null?void 0:a.data.segments),c=i.toDataURL("image/png",1),d=atob(c.split(",")[1]),u=new ArrayBuffer(d.length),f=new Uint8Array(u);for(let p=0;p<d.length;p++)f[p]=d.charCodeAt(p);const h=new Blob([f],{type:"image/png"});cc(URL.createObjectURL(h),"".concat(l,".png")),s.closeModal(o)}}}),r.jsx("div",{className:"mt-14 text-grey3 text-t4-medium w-full text-center",children:"*页面介绍会默认显示第一个「文字块」的内容"}),r.jsxs("div",{ref:a=>{a&&(n.current=a)},className:"w-full px-8 bg-white1 -mb-1 -mr-0.5",children:[r.jsx(qge,{...e}),r.jsx(Gge,{spaceId:t}),r.jsx(Wge,{pageId:e.pageId}),r.jsx(Kge,{url:e.url})]})]})},zge=e=>{const t=ie();return r.jsxs("div",{className:"z-[1] fixed top-0 h-12 w-full grid grid-cols-3 text-center items-center justify-between px-4 border-b border-grey6 bg-white1",children:[r.jsx(V,{name:"IcClose",size:"small",onClick:()=>{t.closeModal(Ve.SHARE_POSTER)}}),r.jsx("span",{className:"text-t1-medium",children:"海报分享"}),r.jsx("div",{className:"text-right text-t2-medium text-active_color shrink-0 animate-click",onClick:()=>{e.onDownload()},children:"下载"})]})},qge=e=>{const t=ft(e.pageId,a=>a==null?void 0:a.data.cover),[n,s]=y.useState();return y.useEffect(()=>{if(n)return;(async()=>{const o=await ve.infra.getKnowledgeCover.raw(e.pageId);let i=t;o.code===200&&o.data.cover&&(i=o.data.cover);const l=i;if(l)if(l.startsWith("http"))s(l);else{const c=await Vs.fetchImageUrl({blockId:e.pageId,ossName:l});s(c)}})()},[t,e.pageId,n]),n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-4"}),r.jsx("img",{src:n})]}):null},Gge=e=>{const t=pc(e.spaceId);return r.jsxs("div",{className:"mt-4 flex items-center",children:[r.jsx(ar,{name:t.title,color:t.backgroundColor,icon:t.icon,iconSize:40,style:{fontSize:"28px"}}),r.jsx("div",{className:"text-normal ml-2 text-h4 font-medium text-ellipsis",children:t.title})]})},Wge=e=>{const t=ft(e.pageId,s=>fe(s==null?void 0:s.data.segments)||qt(s==null?void 0:s.type)),n=Ce(s=>gI(e.pageId,s.blocks),[e.pageId]);return r.jsxs("div",{className:"mt-6",children:[r.jsx("div",{className:"text-h2 text-normal",children:t}),r.jsx(Su.Provider,{value:!0,children:r.jsx("div",{className:"text-grey2 mt-2",children:n&&r.jsx(Xm,{id:n})})})]})},Kge=e=>{const[t,n]=y.useState("");return y.useEffect(()=>{(async()=>{const a=await Z_.toDataURL("".concat(e.url),{errorCorrectionLevel:"H",margin:2});n(a)})()},[e.url]),t?r.jsxs("div",{className:"mt-8",children:[r.jsxs("div",{className:"flex",children:[r.jsx("img",{className:"w-[120px]",src:t}),r.jsxs("div",{className:"ml-3 space-y-2 text-t2-medium flex flex-col justify-center",children:[r.jsx("div",{children:"微信扫码查看专栏"}),r.jsxs("div",{children:["点击右下角",r.jsx("span",{children:r.jsx(V,{name:"IcListMessage2",size:"small"})}),"订阅"]}),r.jsx("div",{children:"订阅后可在微信获得最新推送"})]})]}),r.jsx("div",{className:"w-full mt-8 flex justify-end ",children:r.jsx("img",{className:"h-8",src:vn.logoWithText})}),r.jsx("div",{className:"h-4 w-full"})]}):null},pU=()=>{const e=ie();return y.useCallback(t=>{me.event("click_share_btn",{type:"poster"}),e.modal({modalId:Ve.SHARE_POSTER,containerClassName:"!overflow-hidden",content:()=>r.jsx(Hge,{pageId:t.pageId,url:t.url})})},[e])},Yge=e=>{const t=use(e),{amount:n,payInfo:s}=y.useMemo(()=>!(t!=null&&t.sharePageDistributionRatio)||!(t!=null&&t.accessFee)?{amount:null,payInfo:t}:{amount:Number((t.accessFee*t.sharePageDistributionRatio).toFixed(2)),payInfo:t},[t]);return{payInfo:s,amount:n}},Xge=e=>{const[t,n]=y.useState(""),{amount:s=0,payInfo:a}=Yge(e.pageId),o=Ut(),i=Ow(e.pageId),{url:l,textAndUrl:c}=i({inviteCode:o.inviteCode}),d=y.useCallback(async()=>{me.event("click_share_btn",{type:"embedded"});const h=new URL(l);h.searchParams.set(dn.embed,"true"),await Xt(h.href,{message:"已复制链接"})},[l]),u=y.useCallback(()=>{me.event("click_share_btn",{type:"link"}),Xt(c,{message:"已复制链接"})},[c]),f=pU();return y.useEffect(()=>{(async()=>{const h=await Z_.toDataURL("".concat(l),{errorCorrectionLevel:"medium"});n(h)})()},[l]),r.jsxs("div",{className:"next-modal p-4 space-y-2 w-64",children:[r.jsx("div",{className:"text-center w-full text-t2-medium py-1",children:a!=null&&a.sharePageDistributionRatio&&a.accessFee?r.jsxs("div",{className:"space-y-1.5 text-t3",children:[r.jsx("div",{children:"分享赚取订阅佣金和会员佣金"}),r.jsx("span",{children:"当有人通过你的分享付费购买该专栏，你可获得其支付金额的".concat(a.sharePageDistributionRatio*100,"%:")}),r.jsxs("span",{className:"text-red",children:[s,"元"]})]}):"分享"}),r.jsx("div",{className:"flex justify-center",children:r.jsx("img",{className:"w-[120px] h-[120px]",src:t})}),r.jsx("div",{className:"flex justify-center",children:r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx("div",{className:"bg-grey8 h-px w-8"}),r.jsx("div",{className:"text-grey3 text-t4-medium",children:"其他分享方式"}),r.jsx("div",{className:"bg-grey8 h-px w-8"})]})}),r.jsxs("div",{className:"flex items-center justify-around text-grey3",children:[r.jsxs("div",{className:"flex flex-col items-center  p-1",onClick:u,children:[r.jsx("div",{className:"flex justify-center items-center w-8 h-8 rounded-full bg-grey9 animate-hover",children:r.jsx(V,{name:"IcLinkSmall",size:"middle",className:"text-grey1"})}),r.jsx("div",{className:"mt-1 text-t4",children:"链接分享"})]}),r.jsxs("div",{className:"flex flex-col items-center p-1",onClick:d,children:[r.jsx("div",{className:"flex justify-center items-center w-8 h-8 rounded-full bg-grey9 animate-hover",children:r.jsx(V,{name:"IcEmbeddedLinkSmall",size:"middle",className:"text-grey1"})}),r.jsx("div",{className:"mt-1 text-t4",children:"内嵌分享"})]}),r.jsxs("div",{className:"flex flex-col items-center p-1",onClick:()=>{f({url:l,pageId:e.pageId})},children:[r.jsx("div",{className:"flex  justify-center items-center w-8 h-8 rounded-full bg-grey9  animate-hover",children:r.jsx(V,{name:"IcImageSmall",size:"middle"})}),r.jsx("div",{className:"mt-1 text-t4",children:"生成海报"})]})]})]})},gU=e=>{var f;const{url:t,onCopyLink:n,uuid:s,onCopyEmbedLink:a}=e,o=ye(s,["data"],["segments"]),i=vs(s),l=wfe(),c=Cfe(),d=pU();let u="分享了".concat((f=fe(o==null?void 0:o.data.segments))!=null?f:fo);return(i==null?void 0:i.type)===m.CollectionViewType.FORM&&(u="邀请你填写收集表"),r.jsxs("div",{className:"px-4 border-t border-grey6 text-t2 bg-grey9 flex items-center  h-12",children:[r.jsx("span",{className:"mr-4 text-black",children:"分享方式"}),r.jsx(Fe,{popup:CZ,className:"animate-click mr-4",children:r.jsx(V,{name:"IcLink",size:"middle",onClick:n})}),a&&r.jsx(Fe,{popup:"内嵌模式分享",className:"animate-click mr-4",children:r.jsx(V,{name:"IcGlobeShare",size:"middle",onClick:a})}),r.jsx(Fe,{popup:"小程序分享",onClick:()=>l({url:t}),className:"animate-click mr-4",children:r.jsx(V,{name:"IcMenuMiniProgramQrcode",size:"middle"})}),r.jsx(Fe,{popup:"生成海报，可保存图片",className:"animate-click mr-4",onClick:()=>d({url:t,pageId:s}),children:r.jsx(V,{name:"IcImage",size:"middle"})}),r.jsx(Fe,{popup:"二维码分享",className:"animate-click",onClick:h=>c(h,{url:t,title:u}),children:r.jsx(V,{name:"IcQrCode",size:"middle"})})]})},Qge=e=>{const t=sE(),n=hN(),s=ie();return y.useCallback(async a=>{if(!n){t();return}s.dropdown({popcorn:a==null?void 0:a.currentTarget,placement:"bottom",content:()=>r.jsx(Xge,{pageId:e})})},[n,t,s,e])},SC=[{num:0,title:"不分佣"},{num:.2,title:"20%"},{num:.3,title:"30%"},{num:.4,title:"40%"},{num:.5,title:"50%"}],Jge=e=>{var c;const t=ie(),{sharePageDistributionRatio:n=0,setSharePageDistributionRatio:s,children:a,className:o}=e,i=d=>{t.dropdown({popcorn:d.currentTarget,content:u=>r.jsx(ze,{className:Ra,items:SC.map(f=>({type:H.OPERATION,data:{title:f.title,value:f.num,selected:n===f.num}})),onItemClick:async f=>{s(f.data.value),u.onCloseModal()}})})},l=y.useMemo(()=>SC.find(d=>d.num===n),[n]);return r.jsxs("div",{className:R("animate-click",o),onClick:i,children:[a,r.jsxs("div",{className:"flex items-center space-x-1 text-grey3",children:[r.jsx("span",{children:l!=null&&l.num?l.title:(c=SC[0])==null?void 0:c.title}),r.jsx(V,{size:"xxsmall",name:"IcArrowDown01"})]})]})},Zge=(e,t)=>{const n=Ut(),s=n.nickname,{phone:a}=n,o=wd();y.useEffect(()=>{if(!s)return;const i=s+a.slice(-4),l=FQ(i,{fontSize:vt.watermark_fontsize,font:vt.watermark_font,textAlign:"center",display:"block"});return qS.load({watermark_id:t,watermark_x_space:50,watermark_y_space:50,watermark_angle:20,watermark_width:l,watermark_color:o?"white":"black",watermark_alpha:o?.035:.05,watermark_txt:i}),()=>{qS.remove(t)}},[o,a,s,t])},e_e=()=>y.useCallback(async(e,t)=>{await ve.editor.restoreDocHistory(e,t),Zd({[e]:{tag:"CACHE_EXPIRED",timestamp:Date.now()}})},[]),t_e=20,n_e=["一","二","三","四","五","六","七","八","九","十","十一","十二"];let _U;const s_e=e=>{_U=e},xj=({docId:e,initialSelectedSnapshotId:t})=>{const n=ie(),s=Dt(),a=po(),o=_o(),i=ya(),l=ln(),c=_B(),d=rr(()=>({nextPage:1,selected:t,history:[],initialLoaded:!1,loading:!1,more:!1})),u=e_e(),f=y.useCallback(async()=>{var F,b;if(d.loading)return;d.loading=!0,c();const _=d.nextPage,x=await ve.editor.getDocHistories(e,_,t_e);x.results&&(d.nextPage=_+1,_===1&&t==null&&(d.history=[],d.selected=(F=x.results[0])==null?void 0:F.uuid),d.history.push(...x.results)),d.initialLoaded=!0,d.loading=!1,d.more=(b=x.more)!=null?b:!1,c(),d.selected!=null&&d.history.findIndex(w=>w.uuid===d.selected)===-1&&d.more&&setTimeout(()=>f())},[e,t,c,d]);y.useEffect(()=>{d.nextPage=1,f()},[f,d]);const[h]=_L({loading:d.loading,hasNextPage:d.more,onLoadMore:f}),g=(_=>{var k;const x=[],F=[],b=[],w=new Map,E=ue();for(const T of _){const v=ue(T.createdAt);if(v.isSame(E,"day"))x.push(T);else if(v.isSame(E.subtract(1,"day"),"day"))F.push(T);else if(v.isSame(E,"week"))b.push(T);else{const I=v.startOf("month").toDate().getTime();w.has(I)||w.set(I,[]),(k=w.get(I))==null||k.push(T)}}const C=[];return x.length>=1&&C.push({label:"今天",snapshots:x}),F.length>=1&&C.push({label:"昨天",snapshots:F}),b.length>=1&&C.push({label:"本周",snapshots:b}),C.push(...[...w.entries()].sort(pi(Hr(T=>T[0]))).map(([T,v])=>{const I=ue(T);return{label:I.isSame(E,"month")?"本月":I.isSame(E,"year")?"".concat(n_e[I.month()],"月"):I.format("YYYY年M月"),snapshots:v}})),C})(d.history);return d.initialLoaded?r.jsx("div",{className:"w-[80vw] h-[80vh] rounded-md overflow-hidden",children:r.jsxs("div",{className:"flex h-full",children:[a?r.jsx("div",{className:"flex-1 h-full min-w-0 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{children:r.jsx(V,{size:"normal",name:"IcPageHistory",className:"!w-12 !h-12 text-grey4"})}),r.jsx("h3",{className:"text-t1-bold",children:"升级空间，即刻查看和恢复页面历史"}),r.jsx("div",{className:"flex justify-center mt-2",children:r.jsx(De,{colorType:"active",onClick:()=>{s.planType==="freeTeam"?i(Mt.pageHistory):o({defaultMenuType:Kt.upgrade,from:Mt.pageHistory})},children:"升级空间"})})]})}):g.length<=0?r.jsx("div",{className:"w-[80vw] h-[80vh] flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{children:r.jsx(V,{size:"normal",name:"IcPageHistory",className:"!w-12 !h-12 text-grey4"})}),r.jsx("h3",{className:"text-t1-bold",children:"尚未生成历史页面"}),r.jsxs("p",{className:"text-t2 mt-2",children:["继续编辑，",Na,"会帮助你生成页面历史，",r.jsx("br",{}),"然后你可以选择将页面内容恢复成某个历史时间的内容。"]})]})}):r.jsx("div",{className:"flex-1 h-full flex min-w-0 bg-white1",onContextMenu:_=>{_.stopPropagation()},children:d.selected&&r.jsx(a_e,{docId:e,snapshotId:d.selected},d.selected)}),r.jsxs("div",{className:R("w-[240px] h-full border-l-black_006 border-l flex flex-col",g.length<=0&&"hidden"),children:[r.jsxs("div",{className:"flex-1 py-2 overflow-y-auto",children:[g.map(_=>r.jsxs("div",{className:"mt-2",children:[r.jsx("div",{className:"text-t2 text-grey3 px-3 mb-1",children:_.label}),r.jsx("div",{className:"flex flex-col",children:_.snapshots.map(x=>r.jsx(r_e,{className:"px-3 py-1 my-0.5",snapshot:x,selected:x.uuid!=null&&x.uuid===d.selected,onClick:()=>{d.selected=x.uuid,c()}},x.uuid))})]},_.label)),(d.loading||d.more)&&r.jsx("div",{className:"h-10 overflow-hidden",ref:h,children:r.jsx(xs,{})})]}),r.jsxs("div",{className:"h-[60px] border-t-black_006 border-t flex items-center justify-evenly",children:[r.jsx(De,{colorType:"active",className:R("w-[132px]"),disable:a||!d.selected,onClick:()=>{const _=d.history.find(w=>w.uuid===d.selected),x=ue(),F=ue(_==null?void 0:_.createdAt),b=F.isSame(x,"year")?F.format("M月D日 HH:mm"):F.format("YYYY年M月D日 HH:mm");n.warning({title:r.jsx("div",{className:"w-80",children:"确认恢复页面？"}),content:r.jsxs("p",{children:["页面将恢复为 ",b," 的版本"]}),confirm(){l(Ve.DOC_HISTORY_MODAL_ID),d.selected&&(me.event("page_history"),u(e,d.selected))}})},children:"恢复此版本"}),r.jsx(De,{className:"w-[60px]",onClick:()=>{l(Ve.DOC_HISTORY_MODAL_ID)},children:"取消"})]})]})]})}):r.jsx("div",{className:"w-[80vw] h-[80vh]",children:r.jsx(xs,{})})},r_e=({snapshot:e,selected:t,className:n,onClick:s})=>{var l;const a=ue(),o=ue(e.createdAt),i=o.isSame(a,"year")?o.format("M月D日 HH:mm"):o.format("YYYY年M月D日 HH:mm");return r.jsxs("div",{className:R("animate-hover",{"bg-grey9":t},n),onClick:s,children:[r.jsx("div",{className:"text-t2",children:i}),r.jsx("div",{className:"text-t4 text-grey3",children:(l=e.userList)==null?void 0:l.map(c=>r.jsx("span",{children:Rn(c.uuid)},c.uuid))})]})},a_e=({docId:e,snapshotId:t})=>{const n=yB(async()=>ve.editor.getDocHistoryDetail(e,t),[e,t]);return n[0]==="pending"?r.jsx(xs,{}):r.jsx(xU,{docId:e,snapshot:n[1]})},xU=({docId:e,snapshot:t})=>{const n=y.useMemo(()=>o_e(t),[t]);return r.jsx(z1,{store:n,children:r.jsx(_U,{docId:e,pageScene:wt.PAGE_HISTORY,nameSpace:uc.PAGE_HISTORY})})},o_e=e=>{const t=n3(Iw),{users:n}=pe();return Kv({reducer:t,preloadedState:{users:n,blocks:e.blocks,collectionViews:e.collectionViews,discussions:e.discussions,comments:e.comments}})},i_e=e=>{var o;const{uuid:t,spaceId:n,previewCount:s}=e;Zge(t,"preview-watermark");const[a]=gm({getApi:()=>TI(t,n,s),enable:!!(t&&n)});return a?r.jsxs(r.Fragment,{children:[r.jsx(xU,{docId:t,snapshot:{blocks:(o=a==null?void 0:a.blocks)!=null?o:{},collectionViews:a==null?void 0:a.collectionViews}}),r.jsx(V,{className:"absolute right-4 top-4 rounded-full bg-white1 text-black p-1",onClick:e.onClose,name:"IcBannerClose",size:"large"})]}):r.jsx(xs,{className:"w-full h-full"})},l_e=()=>{const e=ie();return y.useCallback(t=>{e.modal({className:"bg-white1 overflow-hidden",content:({onCloseModal:n})=>r.jsx("div",{className:"relative",children:r.jsx("div",{className:"overflow-scroll h-[90vh] w-[80vw]",children:r.jsx(i_e,{...t,onClose:n})})})})},[e])},NR=1e4,Dp=new Map;Dp.set(0,"不可试读");Dp.set(10,"10个块");Dp.set(30,"30个块");Dp.set(50,"50个块");const c_e=[0,10,30,50],yU=[0,365,180,90,30],yj=new Map;yU.forEach(e=>{yj.set(e,"".concat(e,"天"))});yj.set(0,"永久有效");const d_e=e=>{const{uuid:t,backToMainPanel:n}=e,{set:s,permissionsState:a,roleStatus:o,openParentRoleLimit:i}=lj(t),{allowSubscribe:l,accessFee:c=0,openPreview:d=!1,previewBlockCount:u=0,accessFeeValidDays:f=0,originPrice:h=0}=a,[p,g]=y.useState(a.sharePageDistributionRatio),_=ye(t,[]),[x,F]=y.useState(c),[b,w]=y.useState(!x),E=ie(),[C,k]=y.useState(d===!0&&u===0?10:u),[T,v]=y.useState(f),[I,j]=y.useState(h===0?void 0:h),S=l_e(),D=y.useMemo(()=>b?!0:!(!x||I&&Number(x)>=Number(I)),[x,b,I]),A=async()=>{if(o.isRestricted)return;const M=Number(x),U=()=>{b?me.event("share_pay_cancel"):c!==M&&me.event("share_pay_open"),hn(()=>{s().setPartialPermission({allowSubscribe:M?!0:l,allowSeo:!1,accessFee:b?0:(M<=0?0:M)||0,openPreview:b?!1:C>0,sharePageDistributionRatio:b?0:p,previewBlockCount:C,accessFeeValidDays:T,originPrice:I?Number(I):void 0})}),n()};c&&x&&x!==c?E.warning({title:"修改付费金额后，已购买的帐户仍然可以继续访问，不需要重复付费。",confirm(){U()}}):U()},P=M=>{if(M&&c){E.warning({title:"取消付费设置后，任何人都可以访问分享页面，确认关闭吗？",confirm:()=>{w(M)}});return}F(0),w(M)},L=c_e.map(M=>{const U=Dp.get(M);return{type:H.TEXT_DESCRIPTION,data:{title:U,selected:M===C,onClick:()=>{k(M)}}}}),O=yU.map(M=>{const U=yj.get(M);return{type:H.TEXT_DESCRIPTION,data:{title:U,selected:M===T,onClick:()=>{v(M)}}}}),$=M=>{const U=M.toString().split(".")[1];return U&&U.length>2&&(M=Number(Number(M).toFixed(2))),M>NR&&(M=NR),M};return r.jsxs("div",{className:"select-none",children:[r.jsxs("div",{className:"p-4 flex items-center text-t2",children:[r.jsx(V,{name:"IcArrowBack",className:"mr-2",size:"middle",onClick:n}),"付费订阅",r.jsx(Vb,{placement:"bottom",popup:r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{children:"付费订阅适用于知识付费，您可以对您创作的内容进行收费，通过分享链接或者入驻知识库分享给您的读者。开启了付费订阅的页面，读者通过页面链接无法直接查看，需要支付订阅费后才能浏览页面内容"}),r.jsx("a",{href:ds.subscribeCenter,target:"_blank",className:"text-active_color ml-auto",children:"查看知识库"})]})})]}),o.isRestricted&&r.jsxs("div",{className:"text-t4 bg-grey6 px-4 py-2 animate-click flex justify-between",onClick:i,children:[r.jsx("span",{children:"已继承上级设置，不可单独修改"}),r.jsx("span",{className:"text-active_color mx-1",children:"解除权限继承"})]}),r.jsxs("div",{className:R("text-t2",o.isRestricted&&"pointer-events-none opacity-30"),children:[r.jsxs("div",{className:"flex px-4 items-center justify-between animate-click py-2.5 space-x-1",onClick:()=>P(!b),children:[r.jsx("span",{children:"付费订阅"}),r.jsx(en,{bgClassName:"pointer-events-none",open:!b})]}),b&&r.jsx(Cr,{className:"my-1"}),!b&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"px-4",children:[[{autoFocus:!0,title:"付费金额",readonly:o.isRestricted,value:(x||"").toString(),placeholder:"请输入付费金额，必须大于 0 ",onChange:M=>{M=$(M),F(M),M&&b&&w(!1)}},{title:r.jsxs("div",{children:["划线金额",r.jsx(Vb,{placement:"bottom",popup:"展示划线价可以让专栏价格看起来更优惠。设置后会展示在付款页面，划线价仅作为价格对比使用，不作为最终成交价格。请填写真实有效的价格，不得虚构或夸大，以免误导消费者，具体规定参考《价格法》"})]}),readonly:o.isRestricted,error:x&&I?Number(x)>=Number(I):!1,value:(I||"").toString(),placeholder:"必须高于付费金额",onChange:M=>{M=$(M),j(M)}}].map(M=>r.jsxs("div",{className:"flex items-center py-2.5 justify-between",children:[r.jsx("div",{className:"text-t3 shrink-0",children:M.title}),r.jsx(Ct,{autoFocus:M.autoFocus,type:"number",inputType:"number",disableFloat:!1,readonly:M.readonly,value:M.value,onChange:M.onChange,maxLength:8,className:"h-8 border-none w-4/5 bg-transparent flex-1",inputClassName:R("text-right px-1",M.error&&"text-red"),showBorder:!1,placeholder:M.placeholder,addonAfter:"元"})]},M.placeholder)),r.jsxs("div",{className:"animate-click flex items-center justify-between py-2.5",onClick:M=>{E.dropdown({popcorn:M.currentTarget,content:({onCloseModal:U})=>r.jsx(ze,{className:"py-1 next-modal w-[300px]",items:O,onItemClick:()=>{U()}})})},children:[r.jsx("div",{className:"text-t3",children:"付费周期"}),r.jsxs("div",{className:"space-x-1 text-grey3",children:[r.jsx("span",{children:bU(T)}),r.jsx(V,{size:"xxsmall",name:"IcArrowDown01"})]})]})]}),r.jsx(Cr,{className:"my-1"}),r.jsxs("div",{className:"px-4",children:[r.jsxs("div",{className:"animate-click flex items-center justify-between py-2.5",onClick:M=>{E.dropdown({popcorn:M.currentTarget,content:({onCloseModal:U})=>r.jsx(ze,{className:"py-1 next-modal w-[300px]",items:L,onItemClick:()=>{U()}})})},children:[r.jsx("div",{className:"text-t3",children:"免费试读"}),r.jsxs("div",{className:"space-x-1 text-grey3",children:[r.jsx("span",{children:Dp.get(C)}),r.jsx(V,{size:"xxsmall",name:"IcArrowDown01"})]})]}),r.jsx(Jge,{className:"flex items-center justify-between py-2.5",setSharePageDistributionRatio:g,sharePageDistributionRatio:p,children:r.jsx("div",{className:"text-t3",children:"分佣比例"})})]}),r.jsx(Cr,{className:"my-1"}),r.jsxs("div",{className:"text-grey3 py-1 text-t3 px-4",children:[r.jsx("span",{children:"开启付费分享，即表示你同意并确保遵守"}),r.jsx("a",{href:ds.creator,className:"text-active_color",target:"_blank",children:"《创作者合作协议》"})]})]}),r.jsxs("div",{className:"flex items-center justify-between py-2.5 px-4",children:[r.jsx("div",{children:C>0&&!b&&r.jsx(De,{colorType:"primary",onClick:()=>{var M;return S({accessFee:c,spaceId:(M=_==null?void 0:_.spaceId)!=null?M:"",uuid:t,previewCount:C})},children:"预览"})}),r.jsxs("div",{className:"flex space-x-2.5",children:[r.jsx(De,{colorType:"secondary",onClick:()=>{n()},children:"取消"}),r.jsx(De,{colorType:"active",onClick:A,disable:!D,children:"保存"})]})]})]})]})},bU=e=>e===void 0||e===0?"永久有效":"".concat(e,"天");var zl=(e=>(e[e.SEARCH_USER=0]="SEARCH_USER",e[e.ALL_USERS=1]="ALL_USERS",e[e.PASSWORD=2]="PASSWORD",e[e.PAY=3]="PAY",e))(zl||{});const FU=({uuid:e,onClick:t,className:n=""})=>{const{role:s}=mt(e),a=s===m.PermissionRole.EDITOR;return r.jsx("div",{onClick:a?t:void 0,className:R(n,a&&"animate-click",!a&&"cursor-not-allowed"),children:r.jsx(Ct,{readonly:!0,inputClassName:"h-8 text-grey4 px-0 pointer-events-none",addonBefore:r.jsx(V,{name:"IcSearch",size:"middle",className:"ml-3 mr-1 text-grey4"}),placeholder:"搜索人员、组、手机号、邮箱",addonAfter:r.jsx("span",{className:R("flex justify-center items-center w-8 h-8 rounded-r-sm border-l border-grey6",a?"animate-click":"cursor-not-allowed"),children:r.jsx(V,{name:"IcAddBoard",className:"text-grey3",size:"middle"})})})})},jR={[m.PermissionRole.EDITOR]:"can edit",[m.PermissionRole.WRITER]:"can write",[m.PermissionRole.READER]:"can view",[m.PermissionRole.NONE]:"no access",[m.PermissionRole.COMMENTER]:"can comment"},bj=e=>{var F;const t=ln(),n=Dt(),s=Ut(),a=ye(e,["permissions"]),o=ie(),{permissions:i,role:l,isRestricted:c}=mt(e,{wait:300}),{permissions:d}=mt((F=a==null?void 0:a.parentId)!=null?F:e),u=ai(),{spacePermission:f,groupPermissions:h,userPermissions:p}=xI(i);if(!a)return null;let g=[...h];p.length>1&&(g=[...h,...p]),u||(f?g.unshift(f):g.unshift({type:m.PermissionType.SPACE,role:m.PermissionRole.NONE}));const _=(b,w,E)=>{const C=d.find(T=>Dy(T,w)),k=()=>{if(!E)return;const T=a.permissions.some(v=>v.userId===s.uuid);if(w.role===m.PermissionRole.EDITOR&&!T){dl(e,{type:m.PermissionType.USER,role:m.PermissionRole.EDITOR,userId:s.uuid});return}b===m.PermissionRole.EDITOR&&T&&ju(e,{type:m.PermissionType.USER,role:m.PermissionRole.NONE,userId:s.uuid})};if(!c&&a.parentId!==n.uuid&&C&&C.role&&nu[b]<nu[C.role]){const T=()=>{k(),i.forEach(v=>{Dy(v,w)?mu(e,{...w,role:b}):mu(e,v)}),dl(e,{type:m.PermissionType.RESTRICTED}),re(Sa()),me.event("change_authority",{change_to:jR[b]})};o.warning({title:r.jsxs("div",{className:"px-5 mb-5 w-80",children:[r.jsx("div",{children:"确认进行权限变更？"}),r.jsx("div",{children:"变更后，将不再继承上级页面的协作及分享设置"})]}),confirmText:"确认",confirm:T});return}k(),mu(e,{...w,role:b}),re(Sa()),me.event("change_authority",{change_to:jR[b]})};return{role:l,block:a,onChange:(b,w)=>{var k;const E=i.filter(T=>T.role===m.PermissionRole.EDITOR);if(w.type===m.PermissionType.USER&&E.length===1){const T=E[0];if(T&&Dy(T,w)){o.warning({title:r.jsx("div",{className:"px-5 mb-5 w-80",children:r.jsx("div",{children:"需要至少指定1名成员或成员组为「所有权限」才能进行此操作"})}),noCancel:!0,confirmText:"知道了",colorType:"secondary"});return}}let C=w.type===m.PermissionType.SPACE;if(w.type===m.PermissionType.GROUP){const{groupId:T}=w;if(T){const v=(k=n.permissionGroups)==null?void 0:k.find(I=>I.id===T);v&&(C=v.userIds.includes(s.uuid))}}if(w.userId===s.uuid){const T=()=>{_(b,w,C),t("inviteConfirmModal")};o.warning({title:r.jsx("div",{className:"px-5 mb-5 w-80",children:r.jsx("div",{children:"确认更改自己协作权限？"})}),confirmText:"确认",confirm:T});return}_(b,w,C)},permissions:g}},SR=5,u_e=({uuid:e,onChangeTab:t})=>{const n=kd(),s=Ur(),{isMaxGuests:a,guestMaxLimitDesc:o}=_c(),i=cr(e),l=bj(e),c=v8(),d=Ip("abandonedGuest"),u=Dt(),f=Zo(u.planType),h=_o(),p=Ut(),g=pg(p.uuid).editor,_=mN(),x=async()=>{tn(i==null?void 0:i.type)?Xt("".concat(_n(),"/").concat(e)):Xt("".concat(_n()).concat(Nt.preview).concat(e))};if(!l)return null;const{role:F,permissions:b,onChange:w}=l,E=r.jsxs("div",{className:"p-1 space-y-1",children:[r.jsxs("div",{children:["当前空间计划为",f,"空间，总共可邀请 ",o," 名外部协作者。 外部协作者适用于跨团队项目合作、客户沟通等场景，您可以邀请客户、合作方、甲方等参与查看和编辑特定页面。"]}),r.jsx("div",{className:"text-active_color animate-click text-right",onClick:()=>{h({defaultMenuType:Kt.members,from:Mt.guest_max})},children:"查看我的空间成员"})]});return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mx-4 text-t2",children:[!s&&r.jsxs("div",{className:"flex items-center justify-between w-full pt-2.5 pb-1",children:[r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsxs("span",{children:["空间已邀请外部协作者",r.jsxs("span",{className:R("px-1",a&&"text-red"),children:[n.length,"/",o]}),"人"]}),r.jsx(Cs,{popup:E,children:r.jsx(V,{className:"text-grey3",size:"small",name:"IcQuestion"})})]}),r.jsx("span",{hidden:!g,className:"text-t4 text-active_color animate-click",onClick:()=>{_({type:Yf.maxGuestCount})},children:"升级获取更多席位"})]}),r.jsx(FU,{uuid:e,onClick:()=>t(zl.SEARCH_USER),className:"invite-bar my-2"}),r.jsx(ap,{showRight:!0,filterUserNoInSpace:!0,onChange:F===m.PermissionRole.EDITOR?w:void 0,permissions:b.slice(0,SR)}),b.length>SR&&r.jsxs("div",{onClick:()=>t(zl.ALL_USERS),className:"flex items-center animate-click animate-hover p-1",children:[r.jsx(V,{size:"middle",className:"text-grey4",name:"IcShareAnyone"}),r.jsx("div",{className:"text-t3 text-grey4 pl-4",children:"查看当前页面所有协作者（".concat(b.length," 个）")})]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-1 pb-2.5 px-4 text-t4 text-grey3",children:[r.jsx("div",{}),r.jsxs("div",{className:"flex items-center space-x-2 text-active_color text-t4",children:[Xn(F,m.PermissionRole.EDITOR)&&!d&&r.jsxs("div",{className:"flex space-x-1 items-center animate-click",onClick:c,children:[r.jsx(V,{size:"small",name:"IcMenuPerson"}),r.jsx("span",{children:"链接邀请协作"})]}),r.jsxs("div",{className:"flex space-x-1 items-center animate-click",onClick:x,children:[r.jsx(V,{size:"small",name:"IcLink"}),r.jsx("span",{children:"复制页面链接"})]})]})]})]})},DR=[{title:"公开分享",type:1},{title:"邀请协作",type:0}],f_e=e=>{var u;const t=Ut(),n=lt(),{role:s,permissions:a}=mt(n),o=rM(),[i,l]=y.useState((u=DR[0])==null?void 0:u.type),c=ba(),d=y.useMemo(()=>!pg(t.uuid).editor||Xn(s,m.PermissionRole.EDITOR)?!1:a.every(h=>{var p;return h.type===m.PermissionType.USER&&h.userId&&!c[h.userId]?!0:!Xn((p=h.role)!=null?p:m.PermissionRole.NONE,m.PermissionRole.EDITOR)}),[t.uuid,a,s,c]);return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 flex items-center px-4 space-x-2 py-2 border-b border-grey6",children:DR.map(f=>r.jsx("div",{onClick:()=>l(f.type),className:R("relative animate-hover px-1.5 py-1 mb-px",f.type===i&&"bg-black_006"),children:f.title},f.title))}),r.jsxs("div",{hidden:!d,className:"text-t4 text-red space-x-0.5 py-2 px-4",children:[r.jsx("span",{children:"此页面无管理员，你可"}),r.jsx("span",{className:"animate-click underline underline-offset-2 text-black",onClick:()=>o(n),children:"重置权限"})]}),i===0&&r.jsx(m_e,{...e}),i===1&&r.jsx(h_e,{...e})]})},m_e=e=>{const{onChangeTab:t,uuid:n}=e;return r.jsx(u_e,{onChangeTab:t,uuid:n})},h_e=e=>{var Ge;const{uuid:t,onChangeTab:n}=e,s=ie(),a=Js(),{set:o,permissionsState:i,roleStatus:l}=lj(t),{permissions:c,shared:d,illegal:u,role:f,publicRole:h,allowDuplicate:p,allowShowBreadcrumb:g,isRestricted:_,parentId:x,allowShowSidebar:F,allowShowAIChat:b,allowSeo:w,password:E,allowSubscribe:C,allowDownload:k,linkValidDate:T,accessFee:v,allowSelectionCopy:I}=i,j=Dt();let{abandonedPublicShare:S}=(Ge=j.setting)!=null?Ge:{};h1(j.planType)||(S=!1);const D=ye(t,["data"],["segments"]),A=S&&!d,P=We(t),L=(D==null?void 0:D.type)===m.BlockType.FILE&&fe(D.data.segments).toLowerCase().endsWith(".pdf"),O=po(),$=y.useRef(!1),{url:M,text:U,textAndUrl:z}=Ow(t)(),K=_o(),W=df(),Y=LT({noMessage:!0}),G=E?["".concat(M).concat(U,"\n"),"访问密码".concat(E)].join(""):z,ee=async()=>{await Xt(G,{message:E?"已复制链接和密码":"已复制链接"}),me.event("share_copylink",{is_share:d})},te=async()=>{const tt=new URL(M);tt.searchParams.set(dn.embed,"true"),await Xt(tt.href,{message:"已复制链接"}),me.event("click_share_btn",{type:"embedded"})};if(y.useEffect(()=>()=>{if($.current){const{publicRole:tt}=mn(t);me.event("share_authority",{authority_type:tt===m.PermissionRole.COMMENTER?"can_comment":"can_read"})}},[t]),!D)return null;const Q=f===m.PermissionRole.EDITOR,ne=async()=>{P||!Q||A||v&&d&&!await new Promise(gt=>{s.warning({title:"当前页面正在付费分享。关闭公开分享后，任何人都无法访问分享页面，确认关闭吗？",confirm:()=>{gt(!0)},cancel:()=>{gt(!1)},closeBeforeCallBackForClickOutSide:()=>{gt(!1)}})})||(!_&&d&&x?s.warning({title:r.jsxs("div",{className:"px-5 mb-5 w-80",children:[r.jsx("div",{children:"确定关闭该分享?"}),r.jsx("div",{children:"关闭后将无法从分享的上级页面继续访问此页面"})]}),confirmText:"关闭分享",confirm:()=>{me.event("share_switch",{is_open:!1}),x&&(c.forEach(tt=>mu(t,tt)),dl(t,{type:m.PermissionType.RESTRICTED})),ju(t,{type:m.PermissionType.PUBLIC}),re(Sa())}}):(me.event("share_switch",{is_open:!d}),d?ju(t,{type:m.PermissionType.PUBLIC}):($.current=!0,dl(t,{role:m.PermissionRole.READER,type:m.PermissionType.PUBLIC}),tn(D.type)&&(a(Je.GUIDE_FIRST_TIME_SHARE,ct.advancedList),a(Je.OPEN_SHARE,ct.advancedList))),re(Sa())))},se=()=>{hn(()=>{o().setRole("allowDuplicate")})},ce=()=>{hn(()=>{o().setRole("allowSelectionCopy")})},ae=()=>{hn(()=>{o().setRole("allowDownload")})},de=()=>{hn(()=>{o().setShareShowSidebar()})},ke=()=>{hn(()=>{o().setRole("allowShowBreadcrumb")})},Te=()=>{hn(()=>{o().setRole("allowShowAIChat")})},he=()=>{hn(()=>{o().setAllowSubscribe()})},Ee=()=>{if(O){W(()=>{K({defaultMenuType:Kt.upgrade,from:Mt.share_seo})});return}hn(()=>{o().setShareSeo()})},ge=()=>{me.event("share_pw"),n(zl.PASSWORD)},Se=tt=>{if(Q){if(O){W(()=>{K({defaultMenuType:Kt.upgrade,from:Mt.link_valid})});return}l.isRestricted?be.error("继承上级页面的设置，不支持单独关闭"):s.dropdown({placement:"bottom-end",popcorn:tt.currentTarget,content:gt=>r.jsx(ze,{className:"w-[200px] next-modal py-2",items:[{type:H.OPERATION,data:{title:"永久有效",onClick:()=>{gt.onCloseModal(),hn(()=>{o().setLinkValidTime(void 0)})},selected:!T}},{type:H.LINE,data:{},disableClick:!0},{type:H.OPERATION,data:{title:r.jsxs("div",{children:[r.jsx("div",{children:"自定义失效日期"}),T&&r.jsx("div",{className:"mt-1 text-t4 text-grey3",children:"".concat(ue(T).format(Et))})]}),onClick:kt=>{s.dropdown({popcorn:ra(kt.currentTarget),placement:"top",content:({onCloseModal:At})=>{const Qt=ue(T),nn=new Date;return nn.setDate(nn.getDate()),r.jsx(J0,{uiOption:{hasSwitchTimeOption:!1,hasFormatSetting:!1,disabledDays:{before:nn},footer:r.jsx("div",{className:"px-4 text-t4 text-grey3 text-center",children:"选中日期23:59链接失效，失效后页面公开分享状态自动关闭"})},closeDatePicker:At,dateInfo:{from:Qt.isValid()?Qt.toDate():new Date,includeTime:!1},onChange:({from:sn})=>{gt.onCloseModal(),sn.setHours(23),sn.setMinutes(59),hn(()=>{o().setLinkValidTime(sn.getTime())})}})}})},selected:T}}]})})}},Re=()=>{K({from:Mt.homepage,defaultMenuType:Kt.space})},Ae=!Q||!_&&!!x,Me=tt=>{if(Q){if(!_&&x){be.error("继承上级页面的设置，不支持单独关闭");return}s.dropdown({offset:[0,5],popcorn:tt.currentTarget,placement:"bottom",content:({onCloseModal:gt})=>r.jsx(ze,{className:"next-modal py-1 w-72",items:[{type:H.TEXT_DESCRIPTION,data:{title:r.jsxs(r.Fragment,{children:["任何获得此链接的人都",r.jsx("span",{className:R("ml-1 text-t2-medium"),children:r.jsx("span",{children:"可查看"})})]}),selected:h!==m.PermissionRole.COMMENTER,onClick:()=>{h===m.PermissionRole.COMMENTER&&($.current=!0,hn(()=>{o().setCommon(m.PermissionRole.READER)})),gt()}}},{type:H.TEXT_DESCRIPTION,data:{title:r.jsxs(r.Fragment,{children:["任何获得此链接的人都",r.jsx("span",{className:"ml-1 text-t2-medium",children:"可评论"})]}),selected:h===m.PermissionRole.COMMENTER,onClick:()=>{h!==m.PermissionRole.COMMENTER&&($.current=!0,hn(()=>{o().setCommon(m.PermissionRole.COMMENTER)})),gt()}}}]})})}};return r.jsxs("div",{className:"text-t2 overflow-auto max-h-[80vh]",children:[r.jsx(Fe,{delay:5e3,className:"w-full",disabled:!(Q&&A),popup:"已禁止分享，可到空间设置里打开",children:r.jsxs("div",{className:R("w-full flex items-center justify-between px-4 py-3 animate-click animate-hover rounded-none",(!Q||A)&&"opacity-60 cursor-not-allowed"),onClick:ne,children:[r.jsx("div",{className:"flex",children:E3}),!pt()&&r.jsx(en,{disabled:A,bgClassName:"pointer-events-none",open:u?!1:d})]})}),d&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center h-8 bg-grey9 rounded border-[1px] border-grey6 mx-4 my-1",children:[r.jsxs("div",{className:"relative ml-3 w-full animate-click text-ellipsis pr-8",onClick:Me,children:["任何获得此链接的人都",r.jsx("span",{className:R("ml-1 text-t2-medium",{"opacity-20":Ae,"cursor-not-allowed":Ae}),children:h===m.PermissionRole.COMMENTER?"可评论":"可查看"}),r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall",className:"absolute right-2 top-[5px] text-grey3"})]}),r.jsx("div",{className:"w-[1.5px] h-full bg-grey6"}),r.jsx("div",{onClick:ee,id:Y,"data-clipboard-text":G,className:"flex h-full  flex-shrink-0 items-center px-3 font-medium bg-white2 animate-click",children:r.jsx("div",{className:"text-t2-medium",children:E?"复制链接和密码":"复制链接"})})]}),r.jsxs("div",{hidden:!1,className:"py-2 mx-4 text-t3 text-grey3 space-x-1",children:[r.jsx("span",{children:"自定义你的空间域名"}),r.jsx("span",{className:"animate-click text-active_color",onClick:Re,children:j.domain?j.domain:"设置"})]}),!u&&r.jsx(p_e,{onChangeTab:n,uuid:t}),r.jsxs("div",{onClick:ge,className:"animate-hover rounded-none animate-click w-full flex justify-between items-center px-4 py-3",children:[r.jsx("div",{className:"relative",children:r.jsx("div",{children:E?"已启用密码":"未启用密码"})}),r.jsx("button",{className:"text-grey3 flex items-center",children:E?"修改密码":"设置密码"})]}),r.jsxs("div",{onClick:Se,className:R("w-full flex justify-between items-center px-4 py-3",!E&&!P&&Q&&"animate-hover rounded-none animate-click"),children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{children:"链接有效期"}),O&&r.jsx(_l,{className:"right-[-32px] top-0.5"})]}),r.jsxs("button",{className:"text-grey3 flex items-center",children:[T?"".concat(ue(T).format(Et),"到期"):"永久有效",r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall",className:"ml-1"})]})]}),r.jsxs("div",{hidden:!1,onClick:he,className:R("flex justify-between items-center px-4 py-3",!P&&Q&&"animate-hover rounded-none animate-click",(v&&v>0||l.isRestricted)&&"opacity-60"),children:[r.jsx("div",{children:"允许查看者订阅分享页面"}),r.jsx(en,{bgClassName:"pointer-events-none",open:C})]}),r.jsxs("div",{onClick:se,className:R("flex justify-between items-center px-4 py-3",!P&&Q&&"animate-hover rounded-none animate-click",(!Q||l.isRestricted)&&"opacity-60"),children:[r.jsx("div",{children:"允许查看者拷贝副本"}),r.jsx(en,{bgClassName:"pointer-events-none",open:p})]}),r.jsxs("div",{onClick:ce,className:R("flex justify-between items-center px-4 py-3",!P&&Q&&"animate-hover rounded-none animate-click",(!Q||l.isRestricted)&&"opacity-60"),children:[r.jsx("div",{children:"允许查看者复制内容"}),r.jsx(en,{bgClassName:"pointer-events-none",open:I})]}),r.jsxs("div",{onClick:ae,className:R("flex justify-between items-center px-4 py-3",!P&&Q&&"animate-hover rounded-none animate-click",(!Q||l.isRestricted)&&"opacity-60"),children:[r.jsx("div",{children:"允许查看者下载和打印页面副本"}),r.jsx(en,{bgClassName:"pointer-events-none",open:k})]}),r.jsxs("div",{onClick:de,className:R("flex justify-between items-center px-4 py-3",!P&&Q&&"animate-hover rounded-none animate-click",(!Q||l.isRestricted)&&"opacity-60"),children:[r.jsx("div",{children:"分享页显示侧边导航目录"}),r.jsx(en,{bgClassName:"pointer-events-none",open:F})]}),r.jsxs("div",{onClick:ke,className:R("flex justify-between items-center px-4 py-3",!P&&Q&&"animate-hover rounded-none animate-click",(!Q||l.isRestricted)&&"opacity-60"),children:[r.jsx("div",{children:"分享页显示顶部导航栏"}),r.jsx(en,{bgClassName:"pointer-events-none",open:g})]}),r.jsxs("div",{hidden:!L||!0,onClick:Te,className:R("flex justify-between items-center px-4 py-3",!P&&Q&&"animate-hover rounded-none animate-click",(!Q||l.isRestricted)&&"opacity-60"),children:[r.jsx("div",{children:"分享页显示 AI 会话记录"}),r.jsx(en,{bgClassName:"pointer-events-none",open:b})]}),r.jsx(Fe,{placement:E?void 0:"right",className:"w-full",popup:E?"分享密码已开启,无法进行搜索引擎推广":Wt({title:"开启后，将在百度搜索引擎中进行排名推广，增加页面访问量.",image:"baidu_search"}),children:r.jsxs("div",{onClick:Ee,className:R("w-full flex justify-between items-center px-4 py-3",!E&&!P&&Q&&"animate-hover rounded-none animate-click",(!!E||!Q||l.isRestricted)&&"opacity-60"),children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{children:"搜索引擎推广"}),O&&r.jsx(_l,{className:"right-[-32px] top-0.5"})]}),r.jsx(en,{bgClassName:"pointer-events-none",open:w})]})}),r.jsx(gU,{uuid:t,url:M,onCopyLink:ee,onCopyEmbedLink:te})]}),r.jsx(jie,{uuid:t})]})},p_e=e=>{const{uuid:t,onChangeTab:n}=e,{accessFee:s=0,accessFeeValidDays:a}=mt(t);return r.jsxs("div",{className:"px-4 flex items-center justify-between text-t2 py-3 animate-hover animate-click rounded-none",onClick:o=>{o.stopPropagation(),me.event("share_pay"),n(zl.PAY)},children:[r.jsx("div",{children:"付费订阅"}),r.jsx("div",{className:R("flex items-center",s?"text-active_color":"text-grey3"),children:r.jsx("span",{children:s?"¥".concat(s,",").concat(bU(a)):"未设置"})})]})},g_e=e=>{const{uuid:t,backToMainPanel:n}=e,{url:s,text:a}=Ow(t)(),{set:o,permissionsState:i}=lj(t),{role:l,shared:c,isRestricted:d,parentId:u,password:f,publicRole:h,allowDuplicate:p,allowShowSidebar:g,allowShowAIChat:_,allowSubscribe:x,allowShowBreadcrumb:F,accessFee:b,openPreview:w}=i,E=[m.PermissionRole.EDITOR].includes(l)&&(d||!u),[C,k]=y.useState(!!f),[T,v]=y.useState(f||""),[I,j]=y.useState(""),S=()=>{if(!E)return;const P=gJ();v(P)},D=async()=>{E&&(C&&T&&f!==T&&be.success("设置成功"),f&&!C&&be.success("取消成功"),C?f!==T&&me.event("share_pw_open"):f&&me.event("share_pw_cancel"),hn(()=>{C?o().setPartialPermission({type:m.PermissionType.PUBLIC,allowSeo:!1,password:T}):c&&o().setPartialPermission({type:m.PermissionType.PUBLIC,allowSeo:!1,password:void 0})}),c&&T&&C&&(await Xt(["".concat(s).concat(a,"\n"),"访问密码".concat(T)].join(""),{message:"已复制链接和密码"}),me.event("share_copylink",{is_share:c})),re(Sa()),n())},A=P=>{k(P),!T&&P&&S()};return y.useEffect(()=>{!/^(([A-z]|[0-9]){4})+$/.test(T)&&T?j("仅支持设置4位英文、数字密码"):(T&&k(!0),j(""))},[T]),r.jsxs("div",{className:"select-none",children:[r.jsxs("div",{className:"p-4 flex items-center text-t2",children:[r.jsx(V,{name:"IcArrowBack",className:"mr-2",size:"middle",onClick:n}),"设置分享访问密码"]}),r.jsxs("div",{className:R(!E&&"pointer-events-none opacity-30"),children:[r.jsxs("div",{className:"px-4 py-2.5",children:[r.jsx("div",{className:"w-full rounded border border-grey6",children:r.jsx(Ct,{readonly:!E,value:T,onChange:v,maxLength:4,className:"h-8",showBorder:!1,placeholder:"密码",addonAfter:r.jsxs("div",{className:"h-full items-center flex justify-center bg-white1 px-3 border-l border-grey6 animate-hover rounded-l-none text-t2-medium",onClick:S,children:[r.jsx(V,{name:"IcRefresh",size:"middle",className:"mr-2"}),"随机生成"]})})}),I&&r.jsxs("div",{className:"text-t4 text-red mt-2.5 pointer-events-none px-1",children:[r.jsx(na,{inline:!0,emojiStr:"⚠️"})," 仅支持设置4位英文、数字密码"]})]}),r.jsxs("div",{className:"px-4 border-t border-grey6 mt-2.5 h-14 flex items-center text-t3 justify-between",children:[r.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>A(!C),children:[r.jsx(_a,{checked:C,size:"large"}),r.jsx("span",{className:"ml-0.5",children:"启用密码"})]}),r.jsx(De,{colorType:"active",onClick:D,disable:!!I,children:"确定"})]})]})]})},wU=e=>{const{back:t,permissions:n,role:s,title:a,onChange:o,onlyUserList:i,isForm:l}=e;return i?r.jsx(ap,{showRight:!0,isForm:l,onChange:s===m.PermissionRole.EDITOR?o:void 0,permissions:n}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{onClick:t,className:"p-4 flex items-center animate-click",children:[r.jsx(V,{name:"IcArrowBack",size:"middle"}),r.jsx("span",{className:"text-t2 ml-1",children:a})]}),r.jsx("div",{className:"pl-4 text-t3 text-grey4",children:"共 ".concat(n.length," 个协作者")}),r.jsx("div",{className:"p-4",children:r.jsx(ap,{showRight:!0,isForm:l,onChange:s===m.PermissionRole.EDITOR?o:void 0,permissions:n})})]})},__e=({uuid:e,backToMainPanel:t})=>{const n=bj(e);if(!n)return null;const{role:s,permissions:a,onChange:o}=n;return r.jsx(wU,{back:t,permissions:a,role:s,title:"所有协作者",onChange:o})},EU=({uuid:e,backToMainPanel:t,num:n=0,onlyUserList:s})=>{const a=vs(e),{formInviteUserPermissions:o=[]}=(a==null?void 0:a.format)||{},i=(l,c)=>{var u,f;const d=(u=pe().collectionViews)==null?void 0:u[e];d&&Rt(e,{formInviteUserPermissions:(f=d.format.formInviteUserPermissions)==null?void 0:f.filter(h=>h.groupId!==c.groupId||h.userId!==c.userId)})};return r.jsx(wU,{isForm:!0,onlyUserList:s,back:t,permissions:[...o].splice(0,n),role:m.PermissionRole.EDITOR,title:"所有填写者",onChange:i})},Wy=400,x_e=({uuid:e})=>{const[t,n]=y.useState(0),[s,a]=y.useState(zl.SEARCH_USER),o=i=>{a(i),n(-Wy)};return r.jsx("div",{className:"sm:mx-3 sm:w-[calc(100vw-24px)] next-modal overflow-hidden",style:{width:Wy},children:r.jsxs("div",{className:"flex duration-100 ease-in-out",style:{transform:"translateX(".concat(t,"px)")},children:[r.jsx(AR,{active:t===0,children:r.jsx(f_e,{uuid:e,onChangeTab:o})}),r.jsxs(AR,{active:t===-Wy,className:"flex flex-col",children:[s===zl.SEARCH_USER&&r.jsx(N8,{uuid:e,backToMainPanel:()=>n(0)}),s===zl.ALL_USERS&&r.jsx(__e,{uuid:e,backToMainPanel:()=>n(0)}),s===zl.PASSWORD&&r.jsx(g_e,{uuid:e,backToMainPanel:()=>n(0)}),s===zl.PAY&&r.jsx(d_e,{uuid:e,backToMainPanel:()=>n(0)})]})]})})},AR=({active:e,className:t,children:n})=>r.jsx("div",{className:R("flex-shrink-0",t),style:{width:Wy},children:e&&n}),tx=({uuid:e,color:t,className:n,pos:s,showType:a="icon"})=>{const o=ie(),i=lt(),l=e||i,{shared:c,illegal:d}=mt(l,{wait:200}),u=We(e),f=Dt(),h=ye(l,["permissions"]);if(!h)return null;const p=()=>r.jsx(x_e,{uuid:l}),g=async _=>{_.stopPropagation(),_.preventDefault(),me.event("share",{is_share:u});const x=_m(_);if(f.permissions)O0(f.uuid);else{const{permissions:F}=h,b=F.filter(w=>w.type===m.PermissionType.USER&&w.isGuest&&w.userId).map(w=>({id:w.userId,table:"user"}));if(b.length){const{users:w}=await ve.editor.queryRecords({requests:b});w&&re(Ha.updateSpaceUsers({users:w}))}}o.dropdown({modalId:"inviteConfirmModal",popcorn:_.currentTarget||x,offset:[20,15],closeBeforeCallBack:()=>{xn.emit("inviteConfirmModal")},content:p})};return a==="button"?r.jsx(De,{onClick:g,...Gs(Hs.driveFileShare),colorType:c?"active":"secondary",className:R("relative flex items-center justify-center h-8 rounded flex-shrink-0 whitespace-nowrap px-2 border-none text-t2-medium",n),children:c?"分享中":"分享"}):r.jsxs("div",{...Gs(Hs.driveFileShare),onClick:g,className:R("relative flex items-center justify-center w-5 h-5 mr-5 rounded animate-hover",n),children:[r.jsx(Fe,{popup:"分享",children:r.jsx(V,{size:"middle",name:"IcTitleShare",className:c?"text-active_color":t||""})}),d&&s!=="fileItem"&&r.jsx(V,{name:"IcBadgeDanger",size:"tiny",className:"absolute -right-1 -top-1"})]})},Ys=({children:e,size:t=20,className:n,onClick:s,popup:a,disabled:o})=>r.jsx(Fe,{disabled:o,popup:a,className:R("flex items-center justify-center",n),onClick:s,style:{width:t,height:t},children:e}),$E=FB,y_e=e=>{const{children:t,className:n}=e;return r.jsx("div",{className:R("text-t2 flex items-center justify-between text-white-base py-2 px-6 text-ellipsis",n),children:t})},b_e=e=>{const{setLastCloseTime:t}=e,n=l9();return r.jsx(Ys,{className:"animate-click",onClick:()=>{t(ue(n).format("YYYY-MM-DD HH:mm"))},children:r.jsx(V,{name:"IcClose",size:"middle"})})},RR={Bar:y_e,OnceOneDay:b_e};var Qm=(e=>(e.SPACE_CAPACITY="SPACE_CAPACITY",e.MAIN_LEFT_WIDTH="MAIN_LEFT_WIDTH",e.RIGHT_PAGE_WIDTH="flowus.right.width",e.HEADER_TIPS="HEADER_TIPS",e.SPEED_LIMIT="SPEED_LIMIT",e.COMMENT_TIPS="COMMENT_TIPS",e.FILE_VIEW_LIMIT="FILE_VIEW_LIMIT",e.LINK_RECORD="LINK_RECORD",e.SHARE_TEMPLATE_TOP="SHARE_TEMPLATE_TOP",e.SUBSCRIBE_TIP="SUBSCRIBE_TIP",e.MOVE_SUBSCRIBE_TIPS="MOVE_SUBSCRIBE_TIPS",e.SUBSCRIBE_HIDDEN="SUBSCRIBE_HIDDEN",e))(Qm||{});const Jm=e=>CI(t=>t[e]),HE=e=>{var t;return((t=Jm(e))==null?void 0:t.tag)==="NEED_PAY"},Nl=()=>{const e=(t,n)=>{const s=J.ui.selectedBlocks;re(sr({init(){Co(),re(at.updateSelectBlocks(t))},redo(){Co(),re(at.updateSelectBlocks(t))},undo(){Co(),re(at.updateSelectBlocks(n||s))}}))};return{selectedBlockHistory:y.useCallback(e,[]),selectedBlock:J.ui.selectedBlocks}},F_e=()=>{const e=JSON.parse(localStorage.getItem(cD)||"{}");Object.entries(e).forEach(([t,n])=>{D_.put(t,n)}),localStorage.removeItem(cD)};F_e();const Rd=(e,t={defaultOpen:!1})=>{const n=aee(e),s=(a,o=!0)=>{Vi(e,a,o)};return[n!=null?n:t.defaultOpen,s]},Vi=(e,t,n=!0)=>{var a;const s=Array.isArray(e)?e:[e];if(oee(s,t),!Array.isArray(e)){const o=J.blocks[e],i=(a=ij(o==null?void 0:o.type,{level:o==null?void 0:o.data.level}))==null?void 0:a.title;i&&me.event("block_fold",{block_name:i})}n&&(D_.clear(),D_.batch(()=>{ka(xt.$expandFoldRecord).forEach(o=>{D_.put(o,!!xt.$expandFoldRecord[o])})}))},CU=e=>{var s;if(!e)return!1;const t=J.blocks[e];if(!t)return!1;const n=(s=xt.$expandFoldRecord[e])!=null?s:!1;return nx(t.type)&&n===!1},nx=e=>[m.BlockType.TODO,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER].includes(e),kU=e=>{var s;const t=kn(e,["updatedAt","deletedAt","createdBy","createdAt","subNodes","parentId","spaceId","version","permissions","views"]),n=qe();if(t.uuid=n,e.type===m.BlockType.COLLECTION_VIEW||e.type===m.BlockType.COLLECTION_VIEW_PAGE){const a=(s=t.data.schema)!=null?s:{},o={};Object.entries(a).forEach(([i,l])=>{l.type===m.CollectionSchemaType.RELATION?l.collectionId===e.uuid?o[i]={...l,collectionId:n}:o[i]={...l}:o[i]={...l}}),t.data.schema=o}return t},w_e=(e,t)=>{e.type===m.BlockType.SYNC_CONTAINER&&(e.type=m.BlockType.SYNC_REFERENCE,e.data.ref={uuid:t},e.subNodes=[])},Fj=()=>{const e=Dd(),t=xc();return y.useCallback(async n=>{var o;const s=(o=n.targetSpaceId)!=null?o:Ot();Ju(s);const a=await ve.editor.copySubNodes.raw(n);if(a.code===412){const i=Rm(s),l=await t(s);e({title:"复制失败",maxCapacity:l.maxCapacity,isNovice:l.isNovice,planType:i.planType,spaceId:s})}return a},[t,e])},zE=()=>{const e=Dd(),t=xc();return y.useCallback(async n=>{const{ids:s,spaceId:a,forceAwait:o,addCopyLimit:i,isMoveOtherSpace:l}=n;o?await AD({ids:s,spaceId:a}):AD({ids:s,spaceId:a});const c=gse[a];if(!c)return;const{reachBlockCountLimit:d,reachCapacityLimit:u,reachSingleFileMaxSizeLimit:f,reachCopyLimit:h}=c;if(d||u||f||h&&i){const p=await t(a),g=Rm(a);throw(()=>{if(d){xn.emit("modalId",{modalId:Ve.MAXIMUM_CAPACITY_DIALOG,spaceId:a});return}if(u){e({title:"复制失败",isMoveOtherSpace:l,maxCapacity:p.maxCapacity,isNovice:p.isNovice,planType:g.planType,spaceId:a});return}if(f){e({title:"复制失败",isMoveOtherSpace:l,maxCapacity:p.singleFileMaxSize,isNovice:p.isNovice,planType:g.planType,singleFile:!0,spaceId:a});return}h&&e({title:"复制失败",isMoveOtherSpace:l,maxCapacity:p.maxCapacity,isNovice:p.isNovice,planType:g.planType,spaceId:a,copyLimit:!0})})(),new Error("达到上限")}},[t,e])},jg=()=>{const e=Oe(),t=T_e(),n=Fj(),s=zE(),a=async(o,i)=>{Ju();const{effects:l,afterCopy:c}=i||{},d=[],u=new Set(o);return await s({spaceId:Ot(),ids:[...u]}),!o.length||!t(o)||(e(()=>{Ls.unstable_batchedUpdates(()=>{d.push(...E_e(o,i));const f=new Map,h=[];for(const{uuid:g,block:_}of d)f.set(g,_.uuid),_.type===m.BlockType.TABLE&&h.push(_);h.length&&h.forEach(g=>{var x;const _=(x=g.data.format)==null?void 0:x.tableBlockRanges;if(_){const F=_.map(b=>{const{start:w,end:E}=b;return{start:[f.get(w==null?void 0:w[0]),w==null?void 0:w[1]],end:[f.get(E==null?void 0:E[0]),E==null?void 0:E[1]]}});re(Sn({uuid:g.uuid,patch:{data:{format:{tableBlockRanges:F}}}}))}});const p=d.filter(g=>o.includes(g.uuid)).map(g=>g.block.uuid);l==null||l(Bu(p))})},{noThrottle:!0}),mo(async()=>{const f=d.filter(({block:h})=>h.type!==m.BlockType.COLLECTION_VIEW&&tn(h.type)).map(({uuid:h,block:p})=>({uuid:h,targetId:p.uuid,isDescendant:!u.has(h)}));if(f.length){for(const p of f)re(Sn({uuid:p.targetId,patch:{version:-1}}));const h=await n({list:f});c==null||c(),h.code!==200&&(d.forEach(({block:p})=>Ro(p.uuid)),re(Sa()),be.error(h.msg))}})),d};return y.useCallback(a,[t,s,n,e])},E_e=(e,t)=>{const{after:n,parent:s,prefixName:a=!0}=t||{},{blocks:o,collectionViews:i}=pe(),l=[],c=n||e[e.length-1],d=o[c];return d&&e.reduce((u,f)=>{if(!o[f])return u;const p=k_e(s||d.parentId,f,u,a),g=p[0];return!g||C_e(f,u,g)===u||p.forEach((_,x)=>{var F,b,w;if(x===0&&(u=_.block.uuid),l.push(_),_.block.parentId===_.block.spaceId){const{permissions:E}=_.block;E.some(C=>C.type===m.PermissionType.SPACE)?_.block.permissions=[{type:m.PermissionType.SPACE,role:m.PermissionRole.EDITOR}]:_.block.permissions=[{type:m.PermissionType.USER,role:m.PermissionRole.EDITOR,userId:yt.uuid}]}else _.block.permissions=[];if(_.block.type===m.BlockType.COLLECTION_VIEW||_.block.type===m.BlockType.REFERENCE_COLLECTION){re($a({block:{..._.block,views:[]},local:!1}));const{views:E}=_.block;Array.isArray(E)&&E.forEach(C=>{const k=i[C];if(!k)return;const{pageSort:T,spaceId:v,parentId:I,uuid:j,shareId:S,...D}=k;Io({...D,shareId:S?qe():void 0,pageSort:T.map(A=>{const P=p.find(L=>L.uuid===A);return P==null?void 0:P.block.uuid}).filter(Boolean)},{parentId:_.block.uuid,last:!0})})}else{const{blocks:E}=pe(),C=E[_.uuid],k=E[(F=C==null?void 0:C.parentId)!=null?F:""];if((k==null?void 0:k.type)===m.BlockType.COLLECTION_VIEW){const T=[];Object.entries((b=k.data.schema)!=null?b:{}).forEach(([I,j])=>{j.type===m.CollectionSchemaType.RELATION&&j.collectionId===k.uuid&&T.push(I)});const v={..._.block.data.collectionProperties};T.forEach(I=>{const j=v[I];if(!j)return;const S=[];j.forEach(D=>{var A;D.type===m.TextType.LINK_PAGE&&D.uuid&&k.subNodes.includes(D.uuid)?S.push({...D,uuid:(A=p.find(P=>P.uuid===D.uuid))==null?void 0:A.block.uuid}):S.push(D)}),v[I]=S}),_.block.data.collectionProperties=v}re($a({block:_.block,local:!1}))}if(_.block.isTemplate){const E=pe().blocks[_.block.parentId];if(E!=null){const C=(w=E.templatePages)!=null?w:[],k=_.after?C.indexOf(_.after)+1:C.length,T=C.slice(0);T.splice(k,0,_.block.uuid),re(Sn({uuid:E.uuid,patch:{templatePages:T}}))}}else _.after!=="IS_INLINE_PAGE"&&re(ws({uuid:_.block.uuid,parentId:_.block.parentId,after:_.after}))}),u},c),l},C_e=(e,t,n)=>{var i,l,c;const{blocks:s,collectionViews:a}=J,o=s[e];if(!o)return t;if(!o.isTemplate&&(((i=s[o.parentId])==null?void 0:i.type)===m.BlockType.COLLECTION_VIEW_PAGE||((l=s[o.parentId])==null?void 0:l.type)===m.BlockType.COLLECTION_VIEW)){const u=(c=document.querySelector('[data-block-id="'.concat(e,'"]')).dataset.viewId)!=null?c:"";if(u){const f=s[o.parentId];if(!f)return t;const h=a[u];if(!h)return t;const p=[...h.pageSort],g=h.pageSort.indexOf(t);if(g>-1)p.splice(g+1,0,n.block.uuid);else{const _=new Set(p);for(const x of f.subNodes)if(_.has(x)||p.push(x),x===t){p.push(n.block.uuid);break}}Rs(u,{pageSort:p})}}},k_e=(e,t,n,s)=>{const{blocks:a}=pe(),o=yt,i=[],l={},c=(d,u,f)=>{var E;const h=a[u];if(!h)return;const p=qe();l[u]=p;const g={...h.data};g.segments=wA(g.segments),g.caption=wA(g.caption),typeof(g==null?void 0:g.pageFixedWidth)!="boolean"&&Object.assign(g,{pageFixedWidth:!0});const _=a[h.parentId];if((_==null?void 0:_.type)!==m.BlockType.REFERENCE_COLLECTION&&(_==null?void 0:_.type)!==m.BlockType.REFERENCE_COLLECTION_PAGE&&((_==null?void 0:_.type)!==m.BlockType.COLLECTION_VIEW||h.isTemplate)&&s&&(tn(h.type)||h.type===m.BlockType.FILE)&&g.segments&&g.segments.length>0&&(g.segments=[{text:"副本",type:m.TextType.TEXT,enhancer:{}},...g.segments]),h.type===m.BlockType.COLLECTION_VIEW||h.type===m.BlockType.COLLECTION_VIEW_PAGE){const C=(E=g.schema)!=null?E:{},k={};Object.entries(C).forEach(([T,v])=>{v.type===m.CollectionSchemaType.RELATION?v.collectionId===h.uuid?k[T]={...v,collectionId:p}:k[T]={...v,pairProperty:qe()}:k[T]={...v}}),g.schema=k}const x={uuid:p,parentId:d,version:0,spaceId:h.spaceId,type:h.type,textColor:h.textColor,backgroundColor:h.backgroundColor,data:g,isTemplate:h.isTemplate,templatePages:void 0,status:m.BlockStatus.NORMAL,subNodes:[],createdBy:h.createdBy,createdAt:h.createdAt,updatedBy:h.uuid===t?o.uuid:h.updatedBy,updatedAt:h.uuid===t?Date.now():h.updatedAt,permissions:h.permissions,discussions:void 0};if((h.type===m.BlockType.COLLECTION_VIEW||h.type===m.BlockType.REFERENCE_COLLECTION)&&(x.views=h.views),(h.type===m.BlockType.FOLDER||h.type===m.BlockType.PAGE||h.type===m.BlockType.MIND_MAPPING)&&(x.subNodes=h.subNodes,h.type===m.BlockType.MIND_MAPPING)){const C=h.subNodes.map(k=>{const T=qe(),v=J.blocks[k];return v?(re($a({block:{...v,uuid:T},local:!0})),T):k});x.subNodes=C}if(x.type===m.BlockType.SYNC_CONTAINER&&w_e(x,h.uuid),i.push({block:x,uuid:u,after:f}),xt.$expandFoldRecord[t]!==void 0&&Vi([p],!!xt.$expandFoldRecord[t]),h.type!==m.BlockType.COLLECTION_VIEW&&tn(h.type)||h.type===m.BlockType.SYNC_CONTAINER)return p;if(h.templatePages!=null)for(const C of h.templatePages)c(p,C);const F=v_e(u,g),{subNodes:b}=h;let w;for(const C of b){s=!1,w=c(p,C,w);for(const k of F)if(k.uuid===C&&(k.type==="segments"||k.type==="caption")){const T=x.data[k.type];x.data[k.type]=T==null?void 0:T.map(v=>v.uuid===k.uuid?{...v,uuid:w}:v),F.delete(k)}}return I_e(F,x,i),p};return c(e,t,n),i.forEach(d=>{var u,f;if(d.block.type===m.BlockType.TABLE){const h=(f=(u=d.block.data.format)==null?void 0:u.tableBlockRanges)!=null?f:[];if(h&&h.length>0){const p=[];h.forEach(g=>{var C,k;const{start:_,end:x}=g;if(!_||!x)return;const[F,b]=_,[w,E]=x;!F||!w||!b||!E||p.push({start:[(C=l[F])!=null?C:"",b],end:[(k=l[w])!=null?k:"",E]})}),d.block.data={...d.block.data,format:{...d.block.data.format,tableBlockRanges:p}}}}}),i},T_e=()=>{const e=Dd();return y.useCallback(t=>{const{blocks:n}=pe(),s=t.reduce((a,o)=>{var l;const i=n[o];return i&&i.type===m.BlockType.FILE&&i.data.ossName?a+((l=i.data.size)!=null?l:0):a},0);if(s>0){const a=Zu(Ot());if(a.currentCapacity+s>a.maxCapacity)return e({title:"复制块失败",maxCapacity:a.maxCapacity,isNovice:a.isNovice}),!1}return!0},[e])},v_e=(e,t)=>{var o;const n=new Set,s=new Set,a=(i,l,c)=>{l&&l.forEach((d,u)=>{if(d.type===m.TextType.LINK_PAGE&&d.uuid){const f=J.blocks[d.uuid];if((f==null?void 0:f.parentId)===e){const h={type:i,index:u,uuid:d.uuid,propertyId:c};s.has(h.uuid)||(s.add(h.uuid),n.add(h))}}})};return a("segments",t.segments),a("caption",t.caption),Object.keys((o=t.collectionProperties)!=null?o:{}).forEach(i=>{var l;return a("collectionProperties",(l=t.collectionProperties)==null?void 0:l[i],i)}),n},I_e=(e,t,n)=>{var s;if(e.size>0)for(const a of e){const o=J.blocks[a.uuid];if(o){const i={...o,uuid:qe(),parentId:t.uuid,version:0};if(a.type==="segments"||a.type==="caption"){const l=t.data[a.type];t.data[a.type]=l==null?void 0:l.map(c=>c.uuid===a.uuid?{...c,uuid:i.uuid}:c)}if(a.type==="collectionProperties"&&a.propertyId){const l=t.data[a.type];if(l){const c=l[a.propertyId];l[a.propertyId]=(s=c==null?void 0:c.map(d=>d.uuid===a.uuid?{...d,uuid:i.uuid}:d))!=null?s:[]}}n.push({block:i,uuid:a.uuid,after:"IS_INLINE_PAGE"})}}},N_e=()=>{const e=Dd();return y.useCallback(t=>{const{blocks:n}=pe();let s=0;if(t.forEach(a=>{const o=n[a];o&&jo(o.data.collectionProperties).forEach(i=>{i.forEach(l=>{var c;s=+((c=l==null?void 0:l.size)!=null?c:0)})})},0),s>0){const a=Zu(Ot(),{isDatabase:!0});if(a.currentCapacity+s>a.maxCapacity)return e({title:"复制块失败",maxCapacity:a.maxCapacity,isNovice:a.isNovice}),{status:!1,totalSize:s}}return{status:!0,totalSize:s}},[e])},TU=()=>{const e=N_e(),t=Oe(),n=Fj(),s=(a,o,i)=>{var u;Ju();const l=[];let c=i==null?void 0:i.after;i!=null&&i.after||(c=(u=An(o))==null?void 0:u.blockId),e(lr(o)).status&&(t(()=>{var f;o.reduce((h,p)=>{const g=j_e(a,p,h);return l.push({uuid:p.blockId,targetId:g,syncId:p.syncId}),g},c),(f=i==null?void 0:i.effects)==null||f.call(i,l.map(h=>({blockId:h.targetId,syncId:h.syncId,viewId:a})))},{noThrottle:!0}),mo(()=>n({list:l})))};return y.useCallback(s,[e,n,t])},j_e=(e,t,n)=>{var h;const{blocks:s,collectionViews:a}=pe(),o=s[t.blockId],i=s[(h=o==null?void 0:o.parentId)!=null?h:""],l=a[e];if(!o||!i||!l)return"";const c={...o.data};typeof c.pageFixedWidth!="boolean"&&(c.pageFixedWidth=!0);const d=qe(),u={...o,uuid:d,data:c,version:0,status:m.BlockStatus.NORMAL,subNodes:[],permissions:[],createdBy:o.createdBy,createdAt:o.createdAt,updatedBy:yt.uuid,updatedAt:Date.now()},f=[...l.pageSort];if(n==="head")f.unshift(u.uuid);else if(n==="tail"){const p=new Set(f);for(const g of i.subNodes)p.has(g)||f.push(g);f.push(u.uuid)}else{const p=l.pageSort.indexOf(n!=null?n:"");if(p>-1)f.splice(p+1,0,u.uuid);else{const g=new Set(f);for(const _ of i.subNodes)if(g.has(_)||f.push(_),_===n){f.push(u.uuid);break}}}return re($a({block:u,local:!1})),re(ws({uuid:u.uuid,parentId:o.parentId,after:n})),Rs(e,{pageSort:f}),d},vU=e=>{const t=wj(e.blockId,e.mindMapId);return r.jsx(r.Fragment,{children:t})},wj=(e,t)=>{const n=y.useCallback(s=>Ej(s,e,t),[e,t]);return Ce(n,[e,t])},Ej=dc(e=>e.blocks,(e,t)=>t,(e,t,n)=>n,(e,t,n)=>{let s=-1;const a=o=>{var l;const i=e[o];i&&i.type!==m.BlockType.PDF_ANNOTATION&&(s++,!(tn(i.type)&&n!==o)&&([m.BlockType.TABLE].includes(i.type)||(l=e[o])==null||l.subNodes.forEach(a)))};return a(t),s}),qE=()=>{const e=Ur(),t=ie(),n=ya(),{mindMapMaxLimit:s}=_c();return y.useCallback((a,o="已达到导图节点上限".concat(s,",升级空间立即解锁无限节点"),i=s)=>{if(Ej(J,a,a)>=i&&!e)return t.warning({title:"",content:o,confirmText:"升级空间",cancelText:"我再想想",colorType:"active",confirm:()=>{n(Mt.mind_node_limit)}}),!0},[e,s,t,n])},GE=()=>{const e=TU(),t=jg(),{selectedBlockHistory:n}=Nl(),s=qE(),a=async(o,i,l,c)=>{var h,p,g;Ju();let d,u=[];const f=(h=o[0])==null?void 0:h.blockId;if(f){const _=ks(f);if(_&&ir((p=J.blocks[_])==null?void 0:p.type)&&s(_))return}if(o.every(_=>{const{blocks:x}=J,F=x[_.blockId];if(F){const b=x[F.parentId];if(ga(b==null?void 0:b.type))return d&&d.uuid!==(b==null?void 0:b.uuid)?!1:(d=b,!0)}return!1})){if(d){const _=(g=o[0])==null?void 0:g.viewId;_&&e(_,o,{effects:x=>{var F;n(x),(F=c==null?void 0:c.effects)==null||F.call(c,x),u=x}})}}else await t(lr(o),{effects:_=>{var x;_.forEach(F=>F.syncId=l),n(_),(x=c==null?void 0:c.effects)==null||x.call(c,_),u=_},after:i});return u};return y.useCallback(a,[t,e,s,n])},PR=10,S_e=({onSelect:e})=>{const[t,n]=y.useState(!0),[s,a]=y.useState([]);y.useEffect(()=>{(async()=>{var _;const l=await ve.editor.querySpaceVisitsHistory(Ot(),0);if(n(!1),typeof l!="object")return;const{results:c,recordMap:d}=l;if(!c||!d)return;const{blocks:u}=d;if(!u)return;re(Tn.update({blocks:u}));const f=x=>{if(x){const F=u[x];if(tn(F==null?void 0:F.type))return F}},h=[];let p=0;for(let x=0;p<PR&&x<c.length;x++){const F=(_=c[x])==null?void 0:_.uuid,b=f(F);b&&h.length<PR&&(p++,h.push(b))}const g=h.map(x=>{var F;return{type:H.SEARCH,data:{uuid:x.uuid,title:fe(x.data.segments)||qt(x.type),icon:(F=x.data)==null?void 0:F.icon,type:x.type,backgroundColor:x.backgroundColor}}});a(g)})()},[]);const o=(i,l)=>{const c=s[l];c&&(e==null||e(c.data))};return r.jsx("div",{className:"relative overflow-y-auto h-[300px]",children:r.jsx(ze,{items:s,hasMore:!1,scrollContainerStyle:{top:"52px"},onItemClick:o,customFooter:r.jsxs(r.Fragment,{children:[t&&r.jsxs("div",{className:"relative flex flex-row items-center justify-center h-10",children:[r.jsx($s,{size:"middle"}),r.jsx("div",{className:"flex items-center ml-2 text-center text-t2 text-grey4",children:"正在加载..."})]}),!t&&s.length===0&&r.jsx("div",{className:"text-grey4 text-center mt-[100px]",children:"还没有最近浏览记录"})]})})})},D_e=e=>{const{filterItems:t=[]}=e,{resultList:n,loading:s,hasMore:a,loadMore:o,onInputChange:i,firstTime:l}=oE({defaultList:e.defaultValue,type:e.searchType,source:e.source,parentId:e.parentId,canSearchWithEmpty:e.canSearchWithEmpty,fileType:e.fileType,spaceId:e.spaceId});y.useEffect(()=>{i(e.keyword)},[e.keyword]),y.useEffect(()=>{e.canSearchWithEmpty&&i("")},[e.canSearchWithEmpty]);const c=(u,f)=>{var p;const h=n[f];h&&((p=e.onSelect)==null||p.call(e,h))},d=y.useMemo(()=>n.map(u=>({type:H.SEARCH,data:{uuid:u.uuid,title:fe(u.data.segments)||u.title||qt(u.type),avatarTitle:u.avatarTitle,icon:u.data.icon,navs:u.navs,type:u.type,backgroundColor:u.backgroundColor,...Gs(Hs.moveToItem)}})).filter(u=>!t.includes(u.data.uuid)),[t,n]);return r.jsx("div",{className:"relative h-[365px]",children:r.jsx(ze,{items:d,hasMore:a,loadMore:o,scrollContainerStyle:{top:"8px"},onItemClick:c,loadingView:s&&r.jsx(NN,{}),customFooter:r.jsxs(r.Fragment,{children:[s&&a&&r.jsxs("div",{className:"relative flex flex-row items-center justify-center h-10",children:[r.jsx($s,{size:"middle"}),r.jsx("div",{className:"flex items-center ml-2 text-center text-t2 text-grey4",children:"正在加载..."})]}),!l&&!s&&d.length===0&&r.jsx("div",{className:"relative flex justify-center items-center h-10 text-t2 text-grey4",children:"没有找到相关结果"})]})})})},A_e=e=>{const t=y.useMemo(()=>e.spaceItems.map(s=>({type:H.SEARCH,data:{uuid:s.uuid,title:fe(s.data.segments)||s.title||qt(s.type),avatarTitle:s.avatarTitle,icon:s.data.icon,navs:s.navs,type:s.type,backgroundColor:s.backgroundColor}})),[e.spaceItems]),n=(s,a)=>{var i;const o=e.spaceItems[a];o&&((i=e.onSelect)==null||i.call(e,o))};return t.length===0?null:r.jsx("div",{className:"relative overflow-y-auto h-[300px]",children:r.jsx(ze,{items:t,hasMore:!1,scrollContainerStyle:{top:"52px"},onItemClick:n})})},R_e=e=>{const t=y.useRef(e.onSelect);return t.current=e.onSelect,r.jsx(NU.Provider,{value:t.current,children:r.jsx(Su.Provider,{value:!0,children:r.jsx(IU,{className:"h-[300px] pt-0"})})})};let IU;const lRe=e=>{IU=e},NU=y.createContext(void 0),P_e=()=>y.useContext(NU),L_e=e=>{const t=y.useMemo(()=>J.ui.selectedBlocks.length?lr(J.ui.selectedBlocks):[e.uuid],[e.uuid]),[n,s]=y.useState(""),a=y.useCallback(u=>{s(u)},[]),o=!!n,i=Y3(),l=Dt(),[c,d]=y.useState([]);return y.useLayoutEffect(()=>{var _;const{role:u,isRestricted:f,permissions:h}=mn(t[0]),{spacePermission:p}=xI(h),g=J.blocks[(_=t[0])!=null?_:""];if(g&&t.every(x=>{const F=J.blocks[x];return F?tn(F.type):!1})){const x=[];if(u===m.PermissionRole.EDITOR){const b=[],{spaceId:w}=g;i.forEach(E=>{if(!E.permissions)return;const C=w===E.uuid,k={...E,title:C?"个人页面":E.title,avatarTitle:E.title,type:C?"PRIVATE":"SPACE",data:{icon:E.icon}};C?b.unshift(k):b.push(k)}),x.unshift(...b)}if(p&&p.role!==m.PermissionRole.NONE?u===m.PermissionRole.EDITOR||f&&u===m.PermissionRole.WRITER:u===m.PermissionRole.EDITOR){const b={...l,title:"空间页面",avatarTitle:l.title,type:"SPACE",data:{icon:l.icon}};x.unshift(b)}d(x)}},[l,t,i]),r.jsxs("div",{className:"relative pt-2.5 next-modal w-[360px]",style:{paddingBottom:e.footer?"40px":void 0},children:[r.jsx(Ct,{autoFocus:!0,className:"h-8 mx-2.5",...Gs(Hs.moveToInput),placeholder:e.placeholder||"搜索页面",onChange:a}),o&&r.jsx(D_e,{...e,keyword:n}),!o&&r.jsx("div",{className:"bg-grey6 h-px w-full mt-3.5"}),!o&&r.jsxs(xg,{border:!1,defaultActiveIndex:1,children:[c.length>0&&r.jsx(Zr,{title:"空间",children:r.jsx(A_e,{uuids:t,spaceItems:c,onSelect:u=>{var f;(f=e.onSelect)==null||f.call(e,u)}})}),r.jsx(Zr,{title:"最近使用",children:r.jsx(S_e,{onSelect:u=>{var f;(f=e.onSelect)==null||f.call(e,u)}})}),r.jsx(Zr,{title:"目录",children:r.jsx(R_e,{onSelect:u=>{var f;(f=e.onSelect)==null||f.call(e,u)}})})]}),e.footer]})},dv=qe(),Pd=()=>{const e=ie();return n=>{const{popcorn:s,placement:a="right-start",offset:o=[20,0],mode:i="dropdown"}=n;i==="dropdown"&&s&&e.dropdown({popcorn:s,placement:a,offset:o,modalId:dv,content:()=>r.jsx(LR,{...n})}),i==="modal"&&e.modal({modalId:dv,content:()=>r.jsx(LR,{...n})})}},LR=e=>{const{uuid:t,copyAndMove:n,callback:s,copyToSpace:a,placeholder:o}=e,i=ie(),l=GE(),c=Oe(),d=_I(),u=Dt(),f=lt(),h=ns(),p=zE(),g=async C=>{const k=ut({type:m.BlockType.TEXTAREA},{parentId:C.posBlockId});Ro(k);const T=await l(Bu(C.ids,C.viewId,C.syncId),k,C.syncId,{effects:C.effects});return lr(T!=null?T:[])},_=()=>{i.closeModal(dv)},{blocks:x,ui:F}=J,{selectedBlocks:b}=F,w=x[t];if(!w)return null;const E=b.length?lr(b):[w.uuid];return r.jsx(L_e,{placeholder:o,uuid:t,onSelect:async C=>{if(C.type==="SPACE"&&C.uuid!==u.uuid){_(),i.loading({modalId:"move-to-space",title:"正在移动页面，请稍等... "});try{const v=async I=>{try{await p({spaceId:C.uuid,forceAwait:!0,ids:I,isMoveOtherSpace:!0});const j=await ve.editor.docsMoveToSpace({spaceId:C.uuid,list:I});if(i.closeModal("move-to-space"),t===f){const S=j.moveList[0];S&&h.push("/".concat(S.targetId))}}catch(j){i.closeModal("move-to-space")}};n?d(async()=>{await g({ids:E,posBlockId:w.uuid,syncId:n.syncId,viewId:n.viewId,effects:async I=>{await Ao(500),v(lr(I)),be.success("已完成拷贝副本")}})}):v(E)}catch(v){i.closeModal("move-to-space")}return}if(E.includes(C.uuid)){be.warning("不能移动自己所在页面");return}if(C.navs&&C.navs.some(I=>E.some(j=>j===I.uuid))){be.warning("不能移动自己的子页面");return}const k=J.blocks[C.uuid];if(!k)return;if(ga(k.type)&&E.some(v=>{var I;return((I=J.blocks[v])==null?void 0:I.type)!==m.BlockType.PAGE})){be.warning("无法移动至多维表页面");return}if(k.type===m.BlockType.FOLDER&&E.some(v=>{var j,S;const I=(j=J.blocks[v])==null?void 0:j.type;return I===m.BlockType.FILE?!((S=J.blocks[v])!=null&&S.data.ossName):!tn(I)})){be.warning("无法移动至文件夹页面");return}_(),j3((C.navs||[]).map(v=>v.uuid).concat(C.uuid),!0);const T=v=>{if(a){const I=kU(w);ut(I,{parentId:C.uuid,last:!0})}else C.type==="SPACE"&&v.forEach(I=>{const j=J.blocks[I];j&&!j.permissions.some(S=>S.type===m.PermissionType.SPACE&&S.role!==m.PermissionRole.NONE)&&dl(t,{type:m.PermissionType.SPACE,role:m.PermissionRole.EDITOR,userId:yt.uuid})}),C.type==="PRIVATE"&&v.forEach(I=>{ju(I,{type:m.PermissionType.SPACE}),dl(I,{type:m.PermissionType.USER,role:m.PermissionRole.EDITOR,userId:yt.uuid})}),il(v,{parentId:C.uuid,last:!0});re(Sn({uuid:w.uuid,patch:{updatedAt:Date.now()},ignoreOp:!0}))};n?await g({ids:E,posBlockId:C.uuid,syncId:n.syncId,viewId:n.viewId,effects:v=>{const I=lr(v);T(I),be.success("已完成拷贝副本")}}):c(()=>{T(E)}),s==null||s(C.uuid)},source:"move"})},WE=()=>{const e=tN();return y.useCallback(async(t,n)=>{var a;const s=j0(t);if(!(!s&&!(n!=null&&n.ignorePresence))){if(n!=null&&n.onlyViewed)await ve.infra.completedActivity.raw(t,{viewed:!0});else{if(["abandoned","completed"].includes((s==null?void 0:s.status)||""))return;await ve.infra.completedActivity.raw(t,{completed:(a=n==null?void 0:n.completed)!=null?a:!0,viewed:!0,createdBy:n==null?void 0:n.createdBy})}e()}},[e])},jU=async e=>{var n;return(n=(await ve.editor.queryRecords({requests:[{id:e,table:"user"}]})).users)==null?void 0:n[e||""]},SU=()=>y.useCallback(e=>{const t=!!yt.uuid;if(!t){const n=[{key:dn.callbackPath,value:location.pathname}];e&&(Array.isArray(e)?n.concat(e):n.push(e)),be.warning("请先登录/注册"),es(500).then(()=>{Er(Xf(Nt.login,n))})}return t},[]),v1="copy_to_space_uuid",Sg=()=>{const e=ie(),t=SU(),n=R0(location.search);return y.useCallback((s,a)=>{if(!!!yt.uuid){const l=n(dn.inviteCode),c=n(dn.spaceId);if(l){t([{key:dn.inviteCode,value:l},{key:dn.spaceId,value:c}]);return}const d=J.blocks[s];d!=null&&d.createdBy?jU(d.createdBy).then(u=>{u!=null&&u.inviteCode?t({key:dn.inviteCode,value:u.inviteCode}):t()}):t(),window.sessionStorage.setItem(v1,s);return}const i=document.getElementById("page-header-more")||document.querySelector(".menu_more");i&&e.dropdown({popcorn:i,placement:"bottom-end",offset:[0,16],content:({onCloseModal:l})=>r.jsx(B_e,{addCopyLimit:a==null?void 0:a.addCopyLimit,uuid:s,onSelectSpace:()=>{l()}})})},[t,n,e])},Cj=e=>{const{allowDuplicate:t,illegal:n}=mn(e);return t&&!n},B_e=({uuid:e,onSelectSpace:t,addCopyLimit:n=!1})=>{const s=ie(),a=cr(e),o=Pd(),i=$w(),l=y.useRef(""),c=ns(),d=Qk(),u=Ut(),f=WE(),h=Fj(),p=xc(),g=R0(),_=zE();y.useEffect(()=>{p0().then(()=>{Qk().length===0?(be.warning("请先创建空间"),window.sessionStorage.setItem(v1,e),c.push(Xf(Nt.create,{key:dn.callbackPath,value:location.pathname}))):window.sessionStorage.removeItem(v1)})},[c,e]);const x=y.useMemo(()=>{const F=async(w,E)=>{if(!a||l.current)return;t();const C=a.type===m.BlockType.FILE;if(C||(l.current=s.loading({title:r.jsx(O_e,{runBackground:()=>{s.closeModal(l.current)}})}).modalId),await _({ids:[a.uuid],spaceId:E.uuid,forceAwait:!0,addCopyLimit:n}),ts("".concat(E.uuid,"_template_id"),a.uuid),C){const v=w.currentTarget;i(E.uuid).then(()=>{o({uuid:e,popcorn:v,copyToSpace:E.uuid,callback(I){mo(()=>{DC(E.uuid,m.BlockType.FILE,I),f(Je.LIMITED_TIME_SHARE_COPY,{createdBy:a.createdBy,ignorePresence:!0})})}})})}else{try{await p(E.uuid)}catch(S){be.success("拷贝页面超时[query capacity timeout]"),s.closeModal(l.current);return}re($a({block:{spaceId:E.uuid,type:"SPACE",data:{icon:E.icon},...E},ignoreOp:!0}));const v=kn(kU(a),"discussion");let I=v.type;I===m.BlockType.COLLECTION_VIEW?I=m.BlockType.COLLECTION_VIEW_PAGE:I===m.BlockType.REFERENCE_COLLECTION?I=m.BlockType.REFERENCE_COLLECTION_PAGE:I===m.BlockType.MIND_MAPPING&&(I=m.BlockType.MIND_MAPPING_PAGE);const j=ut({...v,data:{...v.data,pageFixedWidth:!!v.data.pageFixedWidth},type:I},{parentId:E.uuid,last:!0},!1,!1);dl(j,{type:m.PermissionType.USER,userId:u.uuid,role:m.PermissionRole.EDITOR}),re(Sa()),mo(async()=>{try{const S=await h({list:[{uuid:e,targetId:j,isDescendant:!0}],targetSpaceId:E.uuid,addCopyLimit:n});if(S.code!==200)return;if(DC(E.uuid,v.type,j,l.current),f(Je.LIMITED_TIME_SHARE_COPY,{createdBy:a.createdBy,ignorePresence:!0}),S.code===200){DC(E.uuid,v.type,j,l.current);const D=g(dn.inviteCode),A=g(dn.spaceId);D&&A&&await ve.ai.postAiCopyReward({spaceId:A,inviteCode:D,targetId:j}),f(Je.LIMITED_TIME_SHARE_COPY,{createdBy:a.createdBy,ignorePresence:!0})}else S.code===412&&(Ro(j,!1,!0),re(Sa()))}finally{s.closeModal(l.current),l.current=""}})}const k=uw.parse(location.search);k.from==="website"&&k.event==="copy"?me.event("copy_template",{is_from:"home_template",template_id:a.uuid}):me.event("copy_from_share",{page_id:e})},b=dg(d.filter(w=>w.permissions),"uuid");return[{type:H.BLOCK_TEXT,data:{title:"选择一个拷贝到的空间"}},...b.map(w=>({type:H.OPERATION,data:{onClick:E=>F(E,w),content:r.jsxs("div",{className:"flex items-center w-full",children:[r.jsx(ar,{className:"flex-shrink-0 !text-t3-medium w-[26px] h-[26px]",name:w.title,icon:w.icon,color:w.backgroundColor}),r.jsx("div",{className:"ml-2 text-t2 text-ellipsis",children:w.title})]})}}))]},[n,d,a,_,h,u.uuid,p,i,g,o,t,s,f,e]);return r.jsx(ze,{className:"py-2 w-60 max-h-[50vh] overflow-y-auto next-modal",items:x})},DC=(e,t,n,s)=>{const a=window.innerWidth<=640,o=be.success({key:s,duration:1e4,content:r.jsxs("div",{className:"flex items-center justify-between w-52",children:[r.jsx("div",{className:"text-t2",children:"拷贝成功"}),a?r.jsx("div",{onClick:()=>{const i="flowus://NoteActivity?uuid=".concat(n,"&type=").concat(t,"&spaceId=").concat(e);window.open(i,"_blank"),be.closeMessage(o)},className:"text-t4 text-active_color animate-click",children:"App 中查看"}):r.jsx("div",{onClick:()=>{window.open("".concat(r1(),"/").concat(n)),be.closeMessage(o)},className:"text-t4 text-active_color animate-click",children:"跳转查看"})]})})},O_e=e=>{const[t,n]=y.useState(!1);return y.useEffect(()=>{const s=setTimeout(()=>{n(!0)},15e3);return()=>{clearTimeout(s)}},[]),r.jsxs("div",{className:"w-full text-center",children:[r.jsx("div",{children:"正在拷贝"}),t&&r.jsx(De,{className:"w-full mt-2",onClick:()=>{e.runBackground()},children:"后台运行"})]})},DU=()=>{const e=Sg(),t=lt();return y.useCallback(()=>{be.success({key:"file-down-limit",duration:5e3,content:r.jsxs(r.Fragment,{children:["拷贝页面永久保存文件内容、全速下载",r.jsx("span",{className:"text-active_color animate-click mx-1",onClick:()=>e(t),children:"拷贝到空间"})]})})},[e,t])},AU=()=>{const e=lt(),t=$E(Qm.FILE_VIEW_LIMIT,{endDay:1});return y.useCallback(()=>{const n=J.blocks[e],s=n==null?void 0:n.spaceId,a=pt();return!t.showOnce||!a||!Cj(e)?!1:s?!Rw(s):!1},[t.showOnce,e])},sx=()=>{const e=ie(),t=sE(),n=lt(),s=cr(n),a=DU(),o=HE(n),i=pc(s==null?void 0:s.spaceId);return y.useCallback(()=>{const c=new Wp,d=!!xa().uuid;return!pt()||!Cj(n)?(c.resolve(),c.promise):(o?(e.warning({title:"请先付费订阅购买"}),c.reject(new Error("cancel"))):i.planType===St.team?c.resolve():(d||e.warning({colorType:"active",title:"登录 ".concat(Na," 帐户后获取文件"),confirmText:"去登录",cancelText:"取消",confirm:()=>{t()},closeAfterCallBack:()=>c.reject(new Error("cancel"))}),d&&(a(),c.resolve())),c.promise)},[o,a,t,e,n,i.planType])},kj=()=>{const e=lt(),t=ie(),n=$E(Qm.FILE_VIEW_LIMIT,{endDay:1}),s=Sg(),a=AU();return y.useCallback(async()=>{const o=new Wp;return a()?(t.warning({colorType:"active",title:"拷贝页面永久保存文件内容、全速浏览",confirmText:"直接查看",cancelText:"拷贝到空间",closeAfterCallBack:()=>o.resolve(),cancel:()=>{s(e),o.reject(new Error("cancel"))},confirm:()=>{o.resolve()}}),n.close(),o.promise):(o.resolve(),o.promise)},[a,s,n,t,e])},M_e=()=>{const e=pt(),t=DU(),n=y.useRef(Ps(t,30*1e3)),s=y.useRef({timer:setTimeout(()=>{}),start:()=>{e&&(s.current.timer=setTimeout(()=>{n.current()},4*1e3))},stop:()=>{clearTimeout(s.current.timer)}});return s.current},uf=e=>{const t=ft(e,s=>s==null?void 0:s.spaceId),n=Dw(t);return pt()&&(n==null?void 0:n.isOfficialSpace)},U_e=(e="")=>{const t=ft(e,s=>s==null?void 0:s.spaceId),n=Dw(t);return n==null?void 0:n.isOfficialSpace},V_e={isFullscreen:!1,isUpdateReload:!1,isUpdateAvailable:!1},RU=qp(()=>V_e),$_e=Qs(RU),hy=e=>{$_e(Yn(t=>os(t,e)))},rx=()=>RU(e=>e.isFullscreen),ax=J_&&gs.check;q1&&gs.check;const H_e=()=>{const e=rx(),t=ax&&!e,n=yw();return r.jsx("div",{className:"flex-shrink-0 drag-container w-full transition-all",style:{height:t&&!n?"36px":"0px"}})},z_e=()=>{const e=rx(),t=ax&&!e;return r.jsx("div",{className:"flex-shrink-0 drag-container w-full transition-all",style:{width:t?"70px":"0px"}})},q_e={AsideHeaderPlaceholder:H_e,PreviewPDFAsideHeaderPlaceholder:z_e},G_e=({isSidebar:e=!1,showTitle:t=!0})=>{const n=Dt(),s=ns(),a=r9();return r.jsxs(r.Fragment,{children:[r.jsx(q_e.PreviewPDFAsideHeaderPlaceholder,{}),r.jsx(ar,{name:n.title,color:n.backgroundColor,icon:n.icon,onClick:()=>s.push("/"),className:"w-[26px] h-[26px] text-t4 animate-click",style:{fontSize:"18px"}}),t&&r.jsx("span",{className:"text-t2-medium ml-2 animate-click text-ellipsis",onClick:()=>s.push("/"),children:n.title}),r.jsx(Fe,{popup:"收起侧边栏",className:R("flex items-center justify-center animate-hover w-6 h-6 flex-shrink-0 ml-2 cursor-pointer",e&&" ml-auto",!t&&"mr-2"),onClick:()=>{st({$pdfHistorySidebar:!a}),ts(UB,JSON.stringify(!a))},children:r.jsx(V,{name:a?"IcFold":"IcUnfold",size:"middle",className:" text-grey3"})})]})},KE=({uuid:e,style:t,className:n})=>{const s=Js(),a=sI(e),o=Oe();return r.jsx(Fe,{popup:a?"取消快速访问":"添加到快速访问",className:R("p-1 flex items-center justify-center animate-hover flex-shrink-0",n),onClick:()=>{a?me.event("favorite_cancel_pageclick"):me.event("favorite_pageclick"),o(()=>{a?L_(e,{parentId:yt.currentSpaceViewId}):N5(e,{first:!0,parentId:yt.currentSpaceViewId})}),a||s(Je.ADD_TO_FAVORITE,ct.advancedList)},children:r.jsx(V,{name:"IcQuickAccess",size:"middle",style:t,className:R(a&&"text-yellow")})})},W_e=({className:e,application:t})=>{const n=()=>{t.setAIShowSideBar(!xt.$showPDFSidebar),st({$showPDFSidebar:!xt.$showPDFSidebar})};return r.jsx(Fe,{placement:"bottom",className:e,popup:"辅助",children:r.jsx("button",{onClick:n,className:"animate-hover p-1 flex",children:r.jsx(V,{size:"middle",name:"IcAi"})})})};function BR(e){return ue(e).format(On)}function cRe(e){return ue(e).format(vZ)}function K_e(e){return ue(e).format("YYYY.MM.DD")}function PU(e){return ue(e).format("YYYY-M-D H:mm")}function LU(e){if(e<=0)return"刚刚";const n=e*1/1e3,s=Math.floor(n/60);if(s===0)return"刚刚";const a=Math.floor(s/60);if(a===0)return[s.toFixed(0),"分钟前"].join(" ");const o=Math.floor(a/24);if(o===0)return[a.toFixed(0),"小时前"].join(" ");const i=Math.floor(o/30);if(i===0)return[o.toFixed(0),"天前"].join(" ");const l=Math.floor(i/12);return l===0?[i.toFixed(0),"个月前"].join(" "):[l.toFixed(0),"年前"].join(" ")}const Y_e=e=>{if(!e)return null;const t=Date.now();return oK(e)?["今天",e_(e,co)].join(" "):iK(e)?["昨天",e_(e,co)].join(" "):lK(e,t)===-2?["前天",e_(e,co)].join(" "):cK(e,t)===0&&dK(e)?e_(e,"MM月dd日 HH:mm"):e_(e,"yyyy年MM月dd日")},ox=e=>Ce(t=>{const{blocks:n}=t,s=n[e];if(!s)return{wordCount:0,blockCount:0};const a=Ob(s.data.segments),o=s.subNodes.reduce((i,l)=>{if(!n[l])return i;const d=tT(l,n,{});return i.blockCount+=d.blocksNum,i.wordCount+=d.word,i},{wordCount:0,blockCount:0});return{wordCount:a+o.wordCount,blockCount:o.blockCount}},[e],{wait:3e3}),Zm=({className:e,name:t,updatedAt:n,showWordCount:s,showMindNodeCount:a,isByAI:o})=>{const i=lt(),{wordCount:l,blockCount:c}=ox(i);return r.jsxs("div",{className:R("px-4 pt-1 text-t5 text-grey3",e),children:[s&&r.jsxs("div",{children:["字数统计: ",l]}),r.jsxs("div",{children:["块数统计: ",c]}),a&&r.jsxs("div",{children:[r.jsx("span",{children:"节点统计: "}),r.jsx(vU,{blockId:i,mindMapId:i})]}),r.jsxs("div",{className:R("text-ellipsis",{"mt-3":s||a}),children:["最后编辑人"," ",t||Po]}),r.jsxs("div",{children:["最后编辑于"," ",Y_e(n)]}),o&&r.jsx(X_e,{})]})},X_e=()=>r.jsxs("div",{className:"pt-3 flex items-center border-t mt-3",children:[r.jsx(V,{name:"IcNote",size:"middle",className:"mr-1"}),"当前“块”可能含有 AI 生成内容"]}),Q_e=async(e,t,n,s)=>{const a=await fetch(e).then(o=>o.arrayBuffer());try{const o=await uK.load(a),i=o.getPages();Object.values(s).forEach(({pageNumber:c,type:d,pdfRects:u,color:f,path:h})=>{var b;const p=i[Number(c)-1];if(!p)return;const[g,_,x]=Xr(f).rgb().array();if(typeof g>"u"||typeof _>"u"||typeof x>"u")return;const F=fK(g/255,_/255,x/255);if(d===_t.HIGHLIGHT||d===_t.UNDERLINE||d===_t.RECTANGLE||d===_t.STRIKETHROUGH){if(!u)return;Object.keys(u).forEach(w=>{const E=i[Number(w)-1],C=u[w];!E||!C||C.forEach(k=>{E.drawRectangle({x:k.x,y:k.y,width:k.xMax-k.x,height:k.yMax-k.y,color:F,opacity:.4,borderWidth:0,borderOpacity:0})})})}else if(d===_t.ELLIPSE){const w=(b=u==null?void 0:u[c])==null?void 0:b[0];if(!w||(h=[{x:w.x,y:w.y},{x:w.xMax,y:w.yMax}],!h))return;const[E,C]=h;if(!E||!C)return;const k=Math.abs(E.x-C.x),T=Math.abs(E.y-C.y);p.drawEllipse({x:Math.min(E.x,C.x)+k/2,y:Math.min(E.y,C.y)+T/2,xScale:k/2,yScale:T/2,color:F,opacity:.4,borderOpacity:0})}else{if(!h)return;const w=p.getHeight();let E="";h.forEach((C,k)=>{k===0?E+="M ".concat(C.x,",").concat(w-C.y):E+=" L ".concat(C.x,",").concat(w-C.y)}),p.moveTo(0,p.getHeight()),p.drawSvgPath(E,{color:F,opacity:.4})}}),n!==0&&i.forEach(c=>{c.setRotation(mK(n))});const l=await o.save();hK(l,t,"application/pdf")}catch(o){be.warning("下载失败，暂不支持加密文档！")}},ua=new Ai(localStorage,"pdfPreviewStatus",50),J_e=({uuid:e,pdfViewer:t})=>{var c;const n=xM(),s=ie(),a=We(e),o=ye(e,["updatedBy","updatedAt","data"],["isByAI"]),i=_r((c=o==null?void 0:o.updatedBy)!=null?c:""),l=[{type:H.OPERATION,data:{icon:"IcArrowPageFirst",title:"跳转第一页",onClick:()=>t.currentPageNumber=1}},{type:H.OPERATION,data:{icon:"IcArrowPageLast",title:"跳转最后一页",onClick:()=>t.currentPageNumber=t.pagesCount}},{type:H.LINE},{type:H.OPERATION,data:{icon:"IcMenuSinglePage",title:"单页",onClick:()=>{var d;if(t.spreadMode=0,e){const u=(d=ua.get(e!=null?e:""))!=null?d:{};ua.put(e,{...u,spreadMode:qb.SINGLE})}}}},{type:H.OPERATION,data:{icon:"IcMenuDoublePage",title:"双页",onClick:()=>{var d;if(t.spreadMode=1,e){const u=(d=ua.get(e!=null?e:""))!=null?d:{};ua.put(e,{...u,spreadMode:qb.DOUBLE})}}}},{type:H.LINE},{type:H.OPERATION,data:{icon:"IcMenuFlipHorizontal",title:"水平翻页",onClick:()=>{var d;if(t.scrollMode=1,e){const u=(d=ua.get(e!=null?e:""))!=null?d:{};ua.put(e,{...u,scrollMode:zb.HORIZONTAL})}}}},{type:H.OPERATION,data:{icon:"IcMenuFlipVertical",title:"垂直翻页",onClick:()=>{var d;if(t.scrollMode=0,e){const u=(d=ua.get(e!=null?e:""))!=null?d:{};ua.put(e,{...u,scrollMode:zb.VERTICAL})}}}},{type:H.LINE},{type:H.OPERATION,data:{icon:"IcMenuRotateClockwise",title:"顺时针",onClick:()=>{t.pagesRotation+=90,e&&!a&&n(e,{rotation:t.pagesRotation})}}},{type:H.OPERATION,data:{icon:"IcMenuRotateAnti",title:"逆时针",onClick:()=>{t.pagesRotation-=90,e&&!a&&n(e,{rotation:t.pagesRotation})}}},{type:H.LINE,isHidden:!e||a},{type:H.OPERATION,isHidden:!e||a,data:{icon:"IcExportPage",title:"导出标注",label:r.jsx("span",{className:"bg-grey6 text-t4 text-grey3 ml-1 rounded-sm px-1.5 py-0.5",children:"限免"}),onClick:()=>{e&&s.modal({content:({onCloseModal:d})=>r.jsx(AM,{onCloseModal:d,uuid:e})})}}},{type:H.OPERATION,isHidden:!e||a,data:{icon:"IcDownload",title:"下载含标注的 PDF",onClick:async()=>{var _,x,F,b;if(!e)return;me.event("pdf_edited_download",{file_id:e});const{blocks:d}=pe(),u=d[e];if(!u)return;const f={};u.subNodes.forEach(w=>{const E=d[w];if(!E)return;const{pdfAnnotation:C}=E.data;C&&(f[w]={...C,uuid:w})});const h=fe(u.data.segments),p=(F=(x=(_=u.data.format)==null?void 0:_.pdfFormat)==null?void 0:x.rotation)!=null?F:0,g=await Vs.fetchDownloadUrl({blockId:e,ossName:(b=u.data.ossName)!=null?b:""});Q_e(g,h,p,f)}}},{type:H.LINE,isHidden:!e||a}];return r.jsxs("div",{className:"next-modal w-[200px] py-[5px]",children:[r.jsx(ze,{items:l}),!a&&o&&r.jsx(Zm,{name:i,updatedAt:o.updatedAt,isByAI:o.data.isByAI})]})},Z_e=({uuid:e,className:t,pdfViewer:n})=>{const s=ie(),a=o=>{s.dropdown({popcorn:o.currentTarget,placement:"bottom-start",offset:[-10,6],content:({onCloseModal:i})=>r.jsx(J_e,{uuid:e,closeModal:i,pdfViewer:n})})};return r.jsx("button",{className:R("flex items-center animate-hover p-1 justify-center",t),onClick:a,children:r.jsx(V,{size:"middle",name:"IcMore"})})},OR="presentationMode",e1e=({pdfViewer:e,uuid:t,className:n})=>{y.useEffect(()=>{const a=o=>{if(e.presentationModeState!==3)return;if(o.metaKey||o.ctrlKey){switch(o.keyCode){case 38:e.currentPageNumber=1;break;case 40:e.currentPageNumber=e.pagesCount;break}return}let i=0;switch(o.keyCode){case 38:case 33:i=-1;break;case 8:i=-1;break;case 37:i=-1;break;case 40:case 34:i=1;break;case 13:case 32:i=1;break;case 39:i=1;break}i!==0&&(i>0?e.nextPage():e.previousPage())};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[e]);const s=()=>{me.event("presentation_mode",{file_id:t});const a=new pK({container:e.container,pdfViewer:e,eventBus:e.eventBus});e.eventBus.on("presentationmodechanged",({state:o})=>{var i,l;e.presentationModeState=o,o===fie.FULLSCREEN?(i=e.viewer)==null||i.classList.add(OR):(l=e.viewer)==null||l.classList.remove(OR)}),a.request()};return r.jsx(Fe,{placement:"bottom",className:R("ml-4",n),popup:"演示",children:r.jsx("button",{className:"animate-hover p-1 flex justify-center items-center",onClick:s,children:r.jsx(V,{size:"middle",name:"IcMenuPresent"})})})};class t1e{constructor(t,n){q(this,"pdfDocument");q(this,"pagesOverview");q(this,"printContainer",document.createElement("div"));q(this,"canvas",document.createElement("canvas"));q(this,"cancelPrint",!1);q(this,"onProgress");this.pdfDocument=t,this.pagesOverview=n,this.printContainer.id="printContainer",document.body.appendChild(this.printContainer)}async print(){await this.renderAllPages(),this.cancelPrint||window.print()}async renderAllPages(){var s;const t=document.querySelector("body");if(t&&t.setAttribute("data-pdfjs-printing","true"),this.pdfDocument.isPureXfa)return gK(this.printContainer,this.pdfDocument),Promise.resolve();const n=this.pagesOverview.length;for(let a=1;a<=n;a++){if(this.cancelPrint)return;(s=this.onProgress)==null||s.call(this,a,n),await this.renderPage(a),await this.convertPageToImage()}}async renderPage(t){const n=150/e1.PixelsPerInch.PDF,s=this.pagesOverview[t-1];this.canvas.width=Math.floor(s.width*n),this.canvas.height=Math.floor(s.height*n);const a=this.canvas.getContext("2d");if(!a)return;a.save(),a.fillStyle="rgb(255, 255, 255)",a.fillRect(0,0,this.canvas.width,this.canvas.height),a.restore();const o=await this.pdfDocument.getPage(t),i={canvasContext:a,transform:[n,0,0,n,0,0],viewport:o.getViewport({scale:1,rotation:s.rotation}),intent:"print",annotationMode:e1.AnnotationMode.ENABLE_STORAGE,optionalContentConfigPromise:this.pdfDocument.getOptionalContentConfig()};return o.render(i).promise}convertPageToImage(){var s;const t=document.createElement("img");"toBlob"in this.canvas?this.canvas.toBlob(a=>{t.src=URL.createObjectURL(a)}):t.src=this.canvas.toDataURL();const n=document.createElement("div");return n.className="printedPage",n.appendChild(t),(s=this.printContainer)==null||s.appendChild(n),new Promise((a,o)=>{t.onload=a,t.onerror=o})}abort(){this.cancelPrint=!0,this.destroy()}destroy(){var n;(n=this.printContainer)==null||n.remove();const t=document.querySelector("body");t&&t.removeAttribute("data-pdfjs-printing")}}const AC="PDF-PRINT",n1e=({pdfViewer:e,className:t,uuid:n})=>{const s=y.useRef(),a=ie(),o=ln(),i=y.useRef(null),l=y.useRef(null),c=sx();y.useEffect(()=>{const u=()=>{var f;o(AC),(f=s.current)==null||f.destroy()};return window.addEventListener("afterprint",u),()=>{window.removeEventListener("afterprint",u)}},[o]);const d=async()=>{if(me.event("pdf_print",{file_id:n}),!e.pageViewsReady){window.alert("PDF 尚未载入完成！");return}await c(),a.modal({keyboard:!1,modalId:AC,content:({onCloseModal:h})=>r.jsxs("div",{className:"flex flex-col next-modal px-[30px] w-[400px] pb-[30px]",children:[r.jsx("p",{className:"text-t1-medium mt-[30px] text-center",children:"正在准备打印文档..."}),r.jsx("p",{className:"text-t2 text-active_color",ref:i,children:"打印准备中"}),r.jsx("div",{className:"rounded-sm h-1 bg-grey5 mt-2 relative",children:r.jsx("div",{ref:l,className:"rounded-sm h-1 bg-active_color w-0"})}),r.jsx("div",{className:"flex justify-end mt-5",children:r.jsx(De,{onClick:()=>{var p;(p=s.current)==null||p.abort(),h()},children:"取消"})})]})});const u=e.getPagesOverview(),f=s.current=new t1e(e.pdfDocument,u);f.onProgress=(h,p)=>{var x;const g=h/p;if(g>.99){o(AC);return}if(!i.current||!l.current)return;i.current.innerText="打印准备中".concat(lo(Number(g.toFixed(2))));const _=(x=l.current.parentElement)==null?void 0:x.clientWidth;_&&(l.current.style.width="".concat(_*g,"px"))},f.print()};return r.jsx(Fe,{placement:"bottom",className:t,popup:"打印",children:r.jsx("button",{onClick:d,className:"animate-hover p-1 flex",children:r.jsx(V,{size:"middle",name:"IcMenuPrint"})})})},BU=[{name:"自动缩放",value:"auto"},{name:"实际大小",value:"page-actual"},{name:"适合页面",value:"page-fit"},{name:"适合页宽",value:"page-width"},{name:"50%",value:"0.5"},{name:"75%",value:"0.75"},{name:"100%",value:"1"},{name:"125%",value:"1.25"},{name:"150%",value:"1.5"},{name:"200%",value:"2"},{name:"300%",value:"3"},{name:"400%",value:"4"}],s1e=({closeModal:e,pdfViewer:t,scale:n})=>{const s=BU.map(o=>({type:H.OPERATION,data:{title:o.name,value:o.value,arrow:r.jsx(V,{name:"IcCheck02",size:"normal"}),hasArrow:o.value===n}})),a=({data:o})=>{t.currentScaleValue=o.value,e()};return r.jsx(ze,{className:"next-modal w-[160px] py-[5px] bg-white4",items:s,onItemClick:a})},r1e=({className:e,pdfViewer:t})=>{var c,d;const n=ie(),[s,a]=y.useState(t.currentScaleValue),o=y.useRef(s);o.current=s,y.useEffect(()=>{t.eventBus.on("scalechanging",()=>{t.update(),o.current!==t.currentScaleValue&&a(String(t.currentScaleValue))})},[t]);const i=u=>{n.dropdown({popcorn:u.currentTarget,placement:"bottom",offset:[0,10],content:({onCloseModal:f})=>r.jsx(s1e,{pdfViewer:t,closeModal:f,scale:s,setScale:a})})};let l="";return s==="auto"||s==="page-actual"||s==="page-fit"||s==="page-width"?l=(d=(c=BU.find(u=>u.value===s))==null?void 0:c.name)!=null?d:"":l=lo(Number(s),0),r.jsxs("button",{className:R("flex items-center w-20 p-1 animate-hover",e),onClick:i,children:[r.jsx("span",{className:"flex-1 mr-1 text-t2 text-ellipsis",children:l}),r.jsx(V,{size:"xxsmall",name:"IcArrowDown01"})]})},a1e=({pdfViewer:e,uuid:t,className:n})=>{const s=y.useRef(null),a=y.useRef(null),[o,i]=y.useState(!1),[l,c]=y.useState(),[d]=y.useState({highlightAll:!1,caseSensitive:!1,entireWord:!1});y.useEffect(()=>{const g=({matchesCount:x})=>{if(!a.current)return;const{current:F,total:b}=x;a.current.innerHTML="第 ".concat(F," 项，共匹配 ").concat(b," 项")},_=x=>{if(!a.current)return;const{state:F,previous:b,matchesCount:w}=x;if(F===1)a.current.innerHTML="未找到";else if(F===2){const{total:E}=w;a.current.innerHTML="第 ".concat(b?E:1," 项，共匹配 ").concat(E," 项")}else if(F===0){const{current:E,total:C}=w;a.current.innerHTML="第 ".concat(E," 项，共匹配 ").concat(C," 项")}};e.eventBus.on("updatefindmatchescount",g),e.eventBus.on("updatefindcontrolstate",_)},[e.eventBus]);const u=(g,_=!1,x=d)=>{if(!s.current)return;const F=s.current.value.trim();e.eventBus.dispatch("find",{type:g,query:F,caseSensitive:x.caseSensitive,entireWord:x.entireWord,highlightAll:!0,findPrevious:_})},f=()=>{s.current&&u("again",!0)},h=async()=>{s.current&&u("again")},p=g=>{o?e.eventBus.dispatch("findbarclose",{}):me.event("pdf_search",{file_id:t});const _=g.currentTarget.getBoundingClientRect();c({top:_.bottom+10,left:_.left}),i(!o)};return r.jsx(r.Fragment,{children:r.jsxs("div",{className:n,children:[r.jsx(Fe,{placement:"bottom",popup:"搜索",children:r.jsx("button",{className:"animate-hover p-1 flex",onClick:p,children:r.jsx(V,{size:"middle",name:"IcSearch"})})}),o&&r.jsxs("div",{className:"w-[360px] px-1.5 pb-1.5 items-center fixed pt-3 next-modal bg-white4 -translate-x-2/3 z-50",style:{top:l==null?void 0:l.top,left:l==null?void 0:l.left},children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("div",{className:"text-t3 text-grey3",ref:a,children:"搜索"}),r.jsx("button",{className:"flex animate-hover",onClick:p,children:r.jsx(V,{size:"middle",name:"IcToastClose",className:"text-grey4"})})]}),r.jsx("div",{className:"mt-4",children:r.jsxs("div",{className:"flex items-center bg-grey9 border border-grey6 rounded-sm h-7 pl-2",children:[r.jsx(V,{name:"IcSearch",size:"normal",className:"mr-1 w-[18px] h-[18px] text-grey4"}),r.jsx("input",{type:"text",className:"text-t2 text-black bg-transparent flex-1",placeholder:"搜索文本",ref:s,autoFocus:!0,onChange:()=>u(""),onKeyDown:g=>{Ie("enter")(g)&&u("again",g.shiftKey)}}),r.jsxs("div",{className:"px-2.5 flex items-center h-full text-black bg-white4 border-l",children:[r.jsx("button",{onClick:f,className:"flex items-center",children:r.jsx(V,{size:"middle",name:"IcArrowDateBack"})}),r.jsx("span",{className:"w-[1px] mx-2.5 bg-grey6 h-4"}),r.jsx("button",{onClick:h,className:"flex items-center",children:r.jsx(V,{size:"middle",name:"IcArrowDateNext"})})]})]})})]})]})})},OU=[{name:"矩形",value:_t.RECTANGLE,icon:"IcPreviewRectangle"},{name:"圆形",value:_t.ELLIPSE,icon:"IcPreviewEllipse"},{name:"不规则形状",value:_t.POLYGON,icon:"IcPreviewShape"}],o1e=({operatorType:e,closeModal:t,onChangeOperator:n})=>{const s=OU.map(o=>({type:H.OPERATION,data:{icon:o.icon,title:o.name,value:o.value,arrow:r.jsx(V,{name:"IcCheck02",size:"normal"}),hasArrow:o.value===e}})),a=({data:o})=>{n(o.value),t()};return r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:s,onItemClick:a})},i1e=({className:e,operatorType:t,onChangeOperator:n})=>{var i;const s=ie(),a=l=>{s.dropdown({popcorn:l.currentTarget,placement:"bottom",offset:[0,10],content:({onCloseModal:c})=>r.jsx(o1e,{closeModal:c,operatorType:t,onChangeOperator:n})})},o=OU.find(l=>l.value===t);return r.jsx(Fe,{placement:"bottom",popup:"区域高亮",className:e,children:r.jsxs("button",{className:R("flex items-center animate-hover-black3 p-1",o&&"bg-black_006"),onClick:a,children:[r.jsx(V,{size:"middle",name:(i=o==null?void 0:o.icon)!=null?i:"IcPreviewSelection"}),r.jsx(V,{size:"xxsmall",name:"IcArrowDown01",className:"ml-1"})]})})},MR=[{name:"文字目录",type:ao.CATALOGUE},{name:"缩略图目录",type:ao.THUMBNAIL_VIEW},{name:"高亮标注",type:ao.ANNOTATION},{name:"隐藏边栏",type:ao.NONE}],l1e=({uuid:e,closeModal:t,sideBarViews:n})=>{var c,d;const s=(c=ua.get(e!=null?e:""))!=null?c:{},[a,o]=y.useState((d=s==null?void 0:s.sideBarType)!=null?d:ao.NONE),i=n.map(u=>({type:H.OPERATION,data:{title:u.name,type:u.type,arrow:r.jsx(V,{name:"IcCheck02",size:"normal"}),hasArrow:u.type===a}})),l=({data:u})=>{xn.emit("sidebarType",u.type),o(u.type),t()};return r.jsx(ze,{className:"next-modal w-[160px] py-[5px] bg-white4",items:i,onItemClick:l})},UR=e=>e?MR:MR.filter(t=>t.type!==ao.ANNOTATION),c1e=({uuid:e,className:t,pdfViewer:n})=>{const s=ie(),[a,o]=y.useState(UR(e));y.useEffect(()=>{n.pdfDocument&&n.pdfDocument.getOutline().then(l=>{(!l||(l==null?void 0:l.length)===0)&&o(UR(e).slice(1))}).catch(l=>{console.log(l)})},[n.pdfDocument,e]);const i=l=>{s.dropdown({popcorn:l.currentTarget,placement:"bottom-start",offset:[0,10],content:({onCloseModal:c})=>r.jsx(l1e,{sideBarViews:a,uuid:e,closeModal:c})})};return r.jsxs(r.Fragment,{children:[gs.check&&r.jsx(Ys,{size:26,className:"mr-1 animate-hover",popup:"后退",onClick:()=>{Er(Nt.main)},children:r.jsx(V,{size:"xlarge",name:"IcArrowBack"})}),r.jsx(Fe,{placement:"bottom",popup:"侧边栏",children:r.jsxs("button",{className:R("flex items-center animate-hover p-1",t),onClick:i,children:[r.jsx(V,{size:"middle",name:"IcPreviewCatalog"}),r.jsx(V,{size:"xxsmall",name:"IcArrowDown01",className:"ml-1"})]})})]})},d1e=e=>{const{pdfViewer:t,uuid:n,embed:s,application:a,downloadUrl:o}=e,i=rx(),{illegal:l,allowDuplicate:c,allowDownload:d,allowShowAIChat:u}=mt(n),f=ye(n,["data"],["ossName","segments","size"]),h=Qa(),p=pt(),g=Un(),_=sx(),x=r9(),F=l?Ts:fe(f==null?void 0:f.data.segments),b=uf(n!=null?n:""),w=sI(n!=null?n:""),E=ax&&!i,C=c&&!b&&!l,k=d&&!b&&!l,{spaceAiOpen:T,enableAI:v}=xr();let I=g!==wt.PAGE_LITE_PREVIEW&&!s;p?I=I&&u:I=I&&T;const j=async()=>{var D;if(!n||!f)return;if(await _(),o){window.open(o);return}const S=await Vs.fetchDownloadUrl({blockId:n,ossName:(D=f.data.ossName)!=null?D:"",fileName:F});window.open(S)};return r.jsxs("div",{className:"flex items-center justify-between h-[55px] border-grey6 bg-white3 text-black px-4 relative overflow-x-auto next-scrollbar scrollbar-visible",children:[r.jsxs("div",{className:R("flex items-center mr-1",E&&"ml-16"),children:[v&&!x&&r.jsx(G_e,{showTitle:!1}),r.jsx(c1e,{pdfViewer:t,uuid:n}),!s&&f&&r.jsx(Ad,{fileName:F,className:"text-t2 ml-2 max-w-[250px]",addonAfter:h?null:r.jsx("span",{className:"ml-2 text-grey3",children:As(f.data.size)})})]}),r.jsx(u1e,{...e}),r.jsxs("div",{className:"flex h-full items-center",children:[r.jsx(a1e,{uuid:n,pdfViewer:t,className:"ml-2"}),!s&&n&&r.jsxs(r.Fragment,{children:[!p&&!l&&!b&&r.jsx(tx,{showType:"button",className:"ml-2",uuid:n,color:"text-white"}),k&&r.jsx(Fe,{popup:"下载",className:"ml-2",children:r.jsx("button",{className:"animate-hover-black3 p-1 flex justify-center items-center",onClick:j,children:r.jsx(V,{name:"IcDownload",size:"middle"})})}),!p&&!l&&r.jsx(KE,{uuid:n,style:{color:w?Do.yellow:void 0},className:"ml-2"})]}),r.jsx(e1e,{uuid:n,pdfViewer:t,className:"ml-2"}),C&&r.jsx(n1e,{pdfViewer:t,uuid:n,className:"ml-2"}),I&&r.jsx(W_e,{className:"ml-2",application:a}),r.jsx(Z_e,{uuid:n,pdfViewer:t,className:"ml-2"})]})]})},u1e=e=>{const{pdfViewer:t,application:n,embed:s,uuid:a}=e,o=We(a),i=y.useRef(null),[l,c]=y.useState(!1),[d,u]=y.useState(!1),[f,h]=y.useState(t.currentPageNumber),[p,g]=y.useState(_t.NONE);y.useEffect(()=>{n.onHistoryChange=T=>{c(T.redoStack.length>0),u(T.undoStack.length>0)}},[n]),y.useEffect(()=>{t.eventBus.on("pagechanging",()=>{const{pdfThumbnailViewer:T}=t.renderingQueue;T.scrollThumbnailIntoView(t.currentPageNumber),h(t.currentPageNumber)})},[t]);const _=T=>{if(Ie("enter")(T)){const v=Number(f);v&&v<=t.pagesCount&&v>0?t.linkService.goToPage(v):h(t.currentPageNumber)}},x=T=>{xn.emit("pdfCursor",T),g(T),T===_t.MOVE?n.pdfCursorTools.switchTool(n.pdfCursorTools.active===0?1:0):n.pdfCursorTools.switchTool(0)},F=()=>t.increaseScale(),b=()=>t.decreaseScale(),w=()=>t.previousPage(),E=()=>t.nextPage(),C=()=>{re(cg()),n.redo()},k=()=>{re(jm()),n.undo()};return r.jsxs("div",{className:"flex h-full items-center overflow-auto",children:[r.jsxs("div",{className:"flex",children:[r.jsx(Fe,{placement:"bottom",popup:"上一页",children:r.jsx("button",{onClick:w,className:R("animate-hover-black3 p-1 flex justify-center items-center"),children:r.jsx(V,{size:"middle",name:"IcArrowDateBack"})})}),r.jsxs("div",{className:"flex rounded-sm bg-black/5 items-center pr-2 mx-2 text-t4",children:[r.jsx("input",{ref:i,type:"number",className:"w-[30px] mx-0.5 overflow-hidden h-full border-none bg-transparent px-0 text-center focus:border-0",style:{backgroundColor:"transparent"},value:f,onKeyDown:_,onChange:T=>h(T.target.value)}),r.jsx("span",{className:"w-1.5 flex justify-center",children:"/"}),r.jsx("span",{className:"w-[30px] flex justify-center",children:t.pagesCount})]}),r.jsx(Fe,{placement:"bottom",popup:"下一页",children:r.jsx("button",{onClick:E,className:R("animate-hover-black3 p-1 flex justify-center items-center"),children:r.jsx(V,{size:"middle",name:"IcArrowDateNext"})})})]}),r.jsx("span",{className:"min-w-[1px] mx-2 bg-grey6 h-4"}),r.jsxs("div",{className:"flex items-center",children:[r.jsx(Fe,{placement:"bottom",popup:"放大",children:r.jsx("button",{onClick:F,className:R("animate-hover-black3 p-1 flex justify-center items-center"),children:r.jsx(V,{size:"middle",name:"IcPreviewZoomIn"})})}),r.jsx(Fe,{placement:"bottom",className:"ml-2",popup:"缩小",children:r.jsx("button",{onClick:b,className:R("animate-hover-black3 p-1 flex justify-center items-center"),children:r.jsx(V,{size:"middle",name:"IcPreviewZoomOut"})})})]}),r.jsx("span",{className:"min-w-[1px] mx-2 bg-grey6 h-4"}),r.jsx(r1e,{pdfViewer:t}),r.jsx("span",{className:"min-w-[1px] mx-2 bg-grey6 h-4"}),r.jsx(Fe,{placement:"bottom",popup:"文本选择",children:r.jsx("button",{onClick:()=>x(_t.NONE),className:R("animate-hover-black3 p-1 flex justify-center items-center",p===_t.NONE&&"bg-black_006"),children:r.jsx(V,{size:"middle",name:"IcPreviewCursor"})})}),r.jsx(Fe,{placement:"bottom",className:"ml-2",popup:"抓手工具",children:r.jsx("button",{onClick:()=>x(_t.MOVE),className:R("animate-hover-black3 p-1 flex justify-center items-center",p===_t.MOVE&&"bg-black_006"),children:r.jsx(V,{size:"middle",name:"IcPreviewMove"})})}),a&&!o&&!s&&r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"min-w-[1px] mx-2 bg-grey6 h-4"}),r.jsx(Fe,{placement:"bottom",popup:"文字高亮",children:r.jsx("button",{onClick:()=>x(_t.HIGHLIGHT),className:R("animate-hover-black3 p-1 flex justify-center items-center",p===_t.HIGHLIGHT&&"bg-black_006"),children:r.jsx(V,{size:"middle",name:"IcPreviewCursorText"})})}),r.jsx(i1e,{operatorType:p,onChangeOperator:x,className:"ml-2"}),r.jsx(Xle,{pdfViewer:t,className:"ml-2"}),r.jsx(Fe,{placement:"bottom",className:"ml-2",popup:"橡皮擦",children:r.jsx("button",{onClick:()=>x(_t.ERASER),className:R("animate-hover-black3 p-1 flex justify-center items-center",p===_t.ERASER&&"bg-black_006"),children:r.jsx(V,{size:"middle",name:"IcPreviewEraser"})})}),r.jsx("span",{className:"min-w-[1px] mx-2 bg-grey6 h-4"}),r.jsx(Fe,{placement:"bottom",popup:"撤销",children:r.jsx("button",{className:R("animate-hover-black3 p-1 flex justify-center items-center",!d&&"opacity-30 cursor-not-allowed"),disabled:!d,onClick:k,children:r.jsx(V,{size:"middle",name:"IcUndo"})})}),r.jsx(Fe,{placement:"bottom",className:"ml-2",popup:"重做",children:r.jsx("button",{className:R("animate-hover-black3 p-1 flex justify-center items-center",!l&&"opacity-30 cursor-not-allowed"),disabled:!l,onClick:C,children:r.jsx(V,{size:"middle",name:"IcRedo"})})})]})]})},VR=2,$R=3,HR=0,f1e=180;var mp;class Tj{static getCanvas(t,n){const s=B2(this,mp)||O2(this,mp,document.createElement("canvas"));s.width=t,s.height=n;const a=s.getContext("2d",{alpha:!1});return a.save(),a.fillStyle="rgb(255, 255, 255)",a.fillRect(0,0,t,n),a.restore(),[s,s.getContext("2d")]}static destroyCanvas(){const t=B2(this,mp);t&&(t.width=0,t.height=0),O2(this,mp,null)}}mp=new WeakMap,Nx(Tj,mp,null);class m1e{constructor({container:t,id:n,defaultViewport:s,optionalContentConfigPromise:a,linkService:o,renderingQueue:i,checkSetImageDisabled:l,l10n:c}){this.id=n,this.renderingId="thumbnail"+n,this.pageLabel=null,this.pdfPage=null,this.rotation=0,this.viewport=s,this.pdfPageRotate=s.rotation,this._optionalContentConfigPromise=a||null,this.linkService=o,this.renderingQueue=i,this.renderTask=null,this.renderingState=yo.INITIAL,this.resume=null,this._checkSetImageDisabled=l||function(){return!1};const d=this.viewport.width,u=this.viewport.height,f=d/u;this.canvasWidth=f1e,this.canvasHeight=this.canvasWidth/f|0,this.scale=this.canvasWidth/d,this.l10n=c;const h=document.createElement("a");h.href=o.getAnchorUrl("#page="+n),this._thumbPageTitle.then(x=>{h.title=x}),h.onclick=function(){return o.goToPage(n),!1},this.anchor=h;const p=document.createElement("div");p.className="thumbnail",p.setAttribute("data-page-number",this.id),this.div=p;const g=document.createElement("div");g.className="thumbnailSelectionRing";const _=2*HR;g.style.width=this.canvasWidth+_+"px",g.style.height=this.canvasHeight+_+"px",this.ring=g,p.appendChild(g),h.appendChild(p),t.appendChild(h)}setPdfPage(t){this.pdfPage=t,this.pdfPageRotate=t.rotate;const n=(this.rotation+this.pdfPageRotate)%360;this.viewport=t.getViewport({scale:1,rotation:n}),this.reset()}reset(){this.cancelRendering(),this.renderingState=yo.INITIAL;const t=this.viewport.width,n=this.viewport.height,s=t/n;this.canvasHeight=this.canvasWidth/s|0,this.scale=this.canvasWidth/t,this.div.removeAttribute("data-loaded");const a=this.ring;a.textContent="";const o=2*HR;a.style.width=this.canvasWidth+o+"px",a.style.height=this.canvasHeight+o+"px",this.canvas&&(this.canvas.width=0,this.canvas.height=0,delete this.canvas),this.image&&(this.image.removeAttribute("src"),delete this.image)}update({rotation:t=null}){typeof t=="number"&&(this.rotation=t);const n=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:1,rotation:n}),this.reset()}cancelRendering(){this.renderTask&&(this.renderTask.cancel(),this.renderTask=null),this.resume=null}_getPageDrawContext(t=1){const n=document.createElement("canvas"),s=n.getContext("2d",{alpha:!1}),a=new _K;n.width=t*this.canvasWidth*a.sx|0,n.height=t*this.canvasHeight*a.sy|0;const o=a.scaled?[a.sx,0,0,a.sy,0,0]:null;return{ctx:s,canvas:n,transform:o}}_convertCanvasToImage(t){if(this.renderingState!==yo.FINISHED)throw new Error("_convertCanvasToImage: Rendering has not finished.");const n=this._reduceImage(t),s=document.createElement("img");s.className="thumbnailImage",this._thumbPageCanvas.then(a=>{s.setAttribute("aria-label",a)}),s.style.width=this.canvasWidth+"px",s.style.height=this.canvasHeight+"px",s.src=n.toDataURL(),this.image=s,this.div.setAttribute("data-loaded",!0),this.ring.appendChild(s),n.width=0,n.height=0}draw(){if(this.renderingState!==yo.INITIAL)return console.error("Must be in new state before drawing"),Promise.resolve();const{pdfPage:t}=this;if(!t)return this.renderingState=yo.FINISHED,Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=yo.RUNNING;const n=async(f=null)=>{if(d===this.renderTask&&(this.renderTask=null),!(f instanceof e1.RenderingCancelledException)&&(this.renderingState=yo.FINISHED,this._convertCanvasToImage(a),f))throw f},{ctx:s,canvas:a,transform:o}=this._getPageDrawContext(VR),i=this.viewport.clone({scale:VR*this.scale}),l=f=>{if(!this.renderingQueue.isHighestPriority(this)){this.renderingState=yo.PAUSED,this.resume=()=>{this.renderingState=yo.RUNNING,f()};return}f()},c={canvasContext:s,transform:o,viewport:i,optionalContentConfigPromise:this._optionalContentConfigPromise},d=this.renderTask=t.render(c);d.onContinue=l;const u=d.promise.then(function(){return n(null)},function(f){return n(f)});return u.finally(()=>{var h;a.width=0,a.height=0,this.linkService.isPageCached(this.id)||(h=this.pdfPage)==null||h.cleanup()}),u}setImage(t){if(this._checkSetImageDisabled()||this.renderingState!==yo.INITIAL)return;const{canvas:n,pdfPage:s}=t;n&&(this.pdfPage||this.setPdfPage(s),this.renderingState=yo.FINISHED,this._convertCanvasToImage(n))}_reduceImage(t){const{ctx:n,canvas:s}=this._getPageDrawContext();if(t.width<=2*s.width)return n.drawImage(t,0,0,t.width,t.height,0,0,s.width,s.height),s;let a=s.width<<$R,o=s.height<<$R;const[i,l]=Tj.getCanvas(a,o);for(;a>t.width||o>t.height;)a>>=1,o>>=1;for(l.drawImage(t,0,0,t.width,t.height,0,0,a,o);a>2*s.width;)l.drawImage(i,0,0,a,o,0,0,a>>1,o>>1),a>>=1,o>>=1;return n.drawImage(i,0,0,a,o,0,0,s.width,s.height),s}get _thumbPageTitle(){var t;return this.l10n.get("thumb_page_title",{page:(t=this.pageLabel)!=null?t:this.id})}get _thumbPageCanvas(){var t;return this.l10n.get("thumb_page_canvas",{page:(t=this.pageLabel)!=null?t:this.id})}setPageLabel(t){this.pageLabel=typeof t=="string"?t:null,this._thumbPageTitle.then(n=>{this.anchor.title=n}),this.renderingState===yo.FINISHED&&this._thumbPageCanvas.then(n=>{var s;(s=this.image)==null||s.setAttribute("aria-label",n)})}}const h1e=-19,RC="selected";var KF,MU,YF,UU;class p1e{constructor({container:t,eventBus:n,linkService:s,renderingQueue:a,l10n:o}){Nx(this,KF);Nx(this,YF);this.container=t,this.linkService=s,this.renderingQueue=a,this.l10n=o,this.scroll=xK(this.container,this._scrollUpdated.bind(this)),this._resetView(),n._on("optionalcontentconfigchanged",()=>{this._setImageDisabled=!0})}_scrollUpdated(){this.renderingQueue.renderHighestPriority()}getThumbnail(t){return this._thumbnails[t]}_getVisibleThumbs(){return yK({scrollEl:this.container,views:this._thumbnails})}scrollThumbnailIntoView(t){if(!this.pdfDocument)return;const n=this._thumbnails[t-1];if(!n){console.error('scrollThumbnailIntoView: Invalid "pageNumber" parameter.');return}t!==this._currentPageNumber&&(this._thumbnails[this._currentPageNumber-1].div.classList.remove(RC),n.div.classList.add(RC));const{first:s,last:a,views:o}=this._getVisibleThumbs();if(o.length>0){let i=!1;if(t<=s.id||t>=a.id)i=!0;else for(const{id:l,percent:c}of o)if(l===t){i=c<100;break}i&&bK(n.div,{top:h1e})}this._currentPageNumber=t}get pagesRotation(){return this._pagesRotation}set pagesRotation(t){if(!FK(t))throw new Error("Invalid thumbnails rotation angle.");if(!this.pdfDocument||this._pagesRotation===t)return;this._pagesRotation=t;const n={rotation:t};for(const s of this._thumbnails)s.update(n)}cleanup(){for(const t of this._thumbnails)t.renderingState!==yo.FINISHED&&t.reset();Tj.destroyCanvas()}_resetView(){this._thumbnails=[],this._currentPageNumber=1,this._pageLabels=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._setImageDisabled=!1,this.container.textContent=""}setDocument(t){if(this.pdfDocument&&(this._cancelRendering(),this._resetView()),this.pdfDocument=t,!t)return;const n=t.getPage(1),s=t.getOptionalContentConfig();n.then(a=>{this._optionalContentConfigPromise=s;const o=t.numPages,i=a.getViewport({scale:1}),l=()=>this._setImageDisabled;for(let u=1;u<=o;++u){const f=new m1e({container:this.container,id:u,defaultViewport:i.clone(),optionalContentConfigPromise:s,linkService:this.linkService,renderingQueue:this.renderingQueue,checkSetImageDisabled:l,l10n:this.l10n});this._thumbnails.push(f)}const c=this._thumbnails[0];c&&c.setPdfPage(a),this._thumbnails[this._currentPageNumber-1].div.classList.add(RC)}).catch(a=>{console.error("Unable to initialize thumbnail viewer",a)})}_cancelRendering(){for(const t of this._thumbnails)t.cancelRendering()}setPageLabels(t){var n,s;if(this.pdfDocument){t?Array.isArray(t)&&this.pdfDocument.numPages===t.length?this._pageLabels=t:(this._pageLabels=null,console.error("PDFThumbnailViewer_setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let a=0,o=this._thumbnails.length;a<o;a++)this._thumbnails[a].setPageLabel((s=(n=this._pageLabels)==null?void 0:n[a])!=null?s:null)}}forceRendering(){const t=this._getVisibleThumbs(),n=M2(this,YF,UU).call(this,t),s=this.renderingQueue.getHighestPriority(t,this._thumbnails,n);return s?(M2(this,KF,MU).call(this,s).then(()=>{this.renderingQueue.renderView(s)}),!0):!1}}KF=new WeakSet,MU=async function(t){if(t.pdfPage)return t.pdfPage;try{const n=await this.pdfDocument.getPage(t.id);return t.pdfPage||t.setPdfPage(n),n}catch(n){return console.error("Unable to get page for thumb view",n),null}},YF=new WeakSet,UU=function(t){var n,s;return((n=t.first)==null?void 0:n.id)===1?!0:((s=t.last)==null?void 0:s.id)===this._thumbnails.length?!1:this.scroll.down};const Ap=()=>window.devicePixelRatio,wF=e=>{let t=1/0,n=1/0,s=0,a=0;return e.forEach(o=>{o.x<t&&(t=o.x),o.y<n&&(n=o.y),o.x>s&&(s=o.x),o.y>a&&(a=o.y)}),{left:t,top:n,right:s,bottom:a,width:s-t,height:a-n}};var EF=(e=>(e[e.RECTANGLE=0]="RECTANGLE",e[e.POLYGON=1]="POLYGON",e[e.ELLIPSE=2]="ELLIPSE",e))(EF||{});const g1e=async(e,t,n)=>{const s=document.createElement("canvas");s.width=e.width,s.height=e.height;const a=s.getContext("2d");if(!a)return;a.putImageData(e,0,0);const o=s.toDataURL();return t?await _1e(o,t,n):o},_1e=async(e,t,n=1)=>{const s=o=>{const i=new Image,l=()=>{const c=document.createElement("canvas");c.width=i.width,c.height=i.height;const d=c.getContext("2d");if(!d){o(void 0);return}const{left:u,top:f}=wF(t),h=Ap();if(t=t.map(g=>({x:(g.x-u)*h,y:(g.y-f)*h})),d.beginPath(),n===2){const[g,_]=t;if(!g||!_)return;const{x,y:F}=g,{x:b,y:w}=_,E=Math.abs(b-x),C=Math.abs(w-F),k=Math.min(b,x)+E/2,T=Math.min(w,F)+C/2;d.ellipse(k,T,E/2,C/2,0,0,2*Math.PI)}else t.forEach((g,_)=>{_===0?d.moveTo(g.x,g.y):d.lineTo(g.x,g.y)});d.closePath(),d.clip(),d.drawImage(i,0,0);const p=c.toDataURL();o(p)};i.onload=l,i.src=e};return await new Promise(s)},vj=async(e,t,n,s)=>{const a=e.width/e.clientWidth,o=e.getContext("2d");if(!o)return;const{x:i,y:l,width:c,height:d}=t,u=o.getImageData(i*a,l*a,c*a,d*a);return await g1e(u,n,s)},cp=(e,t,n,s)=>{const a=e.getContext("2d");if(!a)return;const{x:o,y:i}=t,{x:l,y:c}=n,d=Math.abs(l-o),u=Math.abs(c-i),f=Math.min(l,o)+d/2,h=Math.min(c,i)+u/2;s!=null&&s.fillStyle&&(a.fillStyle=s.fillStyle),s!=null&&s.lineWidth&&(a.lineWidth=s.lineWidth),a.beginPath(),a.ellipse(f,h,d/2,u/2,0,0,2*Math.PI),a.fill()},Vf=(e,t,n)=>{n&&(n!=null&&n.lineWidth&&(e.lineWidth=n==null?void 0:n.lineWidth),n!=null&&n.strokeStyle&&(e.strokeStyle=n==null?void 0:n.strokeStyle),n!=null&&n.fillStyle&&(e.fillStyle=n==null?void 0:n.fillStyle),n!=null&&n.lineCap&&(e.lineCap=n==null?void 0:n.lineCap),n!=null&&n.lineJoin&&(e.lineJoin=n==null?void 0:n.lineJoin));const s=a=>{e.beginPath(),e.arc(a.x,a.y,5,0,2*Math.PI),e.fill()};(n==null?void 0:n.joinShape)==="round"&&(t.forEach(s),e.lineJoin="round"),e.beginPath(),t.forEach((a,o)=>{o===0?e.moveTo(a.x,a.y):e.lineTo(a.x,a.y)}),n!=null&&n.closePath&&e.closePath(),n!=null&&n.isFill?e.fill():e.stroke()},zR=e=>{const{source:t,onResizeEnd:n,onResizing:s,container:a=document.body}=e,o=document.createElement("div");o.classList.add("resizeContainer"),o.style.cursor="move",o.innerHTML='\n    <div style="position: absolute; user-select: none; width: 100%; height: 10px; top: -5px; left: 0px; cursor: row-resize;"></div>\n    <div style="position: absolute; user-select: none; width: 10px; height: 100%; top: 0px; right: -5px; cursor: col-resize;"></div>\n    <div style="position: absolute; user-select: none; width: 100%; height: 10px; bottom: -5px; left: 0px; cursor: row-resize;"></div>\n    <div style="position: absolute; user-select: none; width: 10px; height: 100%; top: 0px; left: -5px; cursor: col-resize;"></div>\n    <div style="position: absolute; user-select: none; width: 20px; height: 20px; right: -10px; top: -10px; cursor: ne-resize;"></div>\n    <div style="position: absolute; user-select: none; width: 20px; height: 20px; right: -10px; bottom: -10px; cursor: se-resize;"></div>\n    <div style="position: absolute; user-select: none; width: 20px; height: 20px; left: -10px; bottom: -10px; cursor: sw-resize;"></div>\n    <div style="position: absolute; user-select: none; width: 20px; height: 20px; left: -10px; top: -10px; cursor: nw-resize;"></div>\n  ';const i=l=>{if(l.button!==0)return;l.stopPropagation(),l.preventDefault();const c=l.target,{cursor:d}=c.style,u={x:l.clientX,y:l.clientY},f={x:parseInt(t.style.left,10),y:parseInt(t.style.top,10),width:parseInt(t.style.width,10),height:parseInt(t.style.height,10),bottom:parseInt(t.style.height,10)+parseInt(t.style.top,10),right:parseInt(t.style.width,10)+parseInt(t.style.left,10)},h=a.getBoundingClientRect(),p=_=>{const x=Es(_.clientY,h.top,h.bottom),b=Es(_.clientX,h.left,h.right)-u.x,w=x-u.y,E=()=>{const j=Es(f.y+w,0,f.bottom);t.style.top="".concat(j,"px"),t.style.height="".concat(Math.abs(f.height-w),"px")},C=()=>{const j=w<0&&Math.abs(w)>f.height?f.y-(Math.abs(w)-f.height):f.y;t.style.top="".concat(j,"px"),t.style.height="".concat(Math.abs(f.height+w),"px")},k=()=>{const j=Es(f.x+b,0,f.right);t.style.left="".concat(j,"px"),t.style.width="".concat(Math.abs(f.width-b),"px")},T=()=>{const j=b<0&&Math.abs(b)>f.width?f.x-(Math.abs(b)-f.width):f.x;t.style.left="".concat(j,"px"),t.style.width="".concat(Math.abs(f.width+b),"px")},v=()=>{const j=Es(f.y+w,0,h.height-f.height),S=Es(f.x+b,0,h.width-f.width);t.style.top="".concat(j,"px"),t.style.left="".concat(S,"px")};switch(d){case"row-resize":{c.style.top?E():C();break}case"col-resize":{c.style.left?k():T();break}case"ne-resize":{E(),T();break}case"se-resize":{T(),C();break}case"sw-resize":{k(),C();break}case"nw-resize":{E(),k();break}case"move":{v();break}}const I={x:parseInt(t.style.left,10),y:parseInt(t.style.top,10),width:parseInt(t.style.width,10),height:parseInt(t.style.height,10)};s==null||s(I)},g=()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g);const _={x:parseInt(t.style.left,10),y:parseInt(t.style.top,10),width:parseInt(t.style.width,10),height:parseInt(t.style.height,10)};Math.abs(_.x-f.x)<2&&Math.abs(_.y-f.y)<2&&Math.abs(_.width*_.height-f.width*f.height)<4||n==null||n(_)};document.addEventListener("mousemove",p),document.addEventListener("mouseup",g)};o.addEventListener("mousedown",i),t.appendChild(o)};class x1e{constructor(t,n,s,a,o,i){q(this,"containers",{});q(this,"remove",()=>{Object.values(this.containers).forEach(t=>{t.removeEventListener("click",this.handleClick),t.remove()})});q(this,"update",t=>{this.annotation=t,Object.values(this.containers).forEach(n=>{for(;n.firstChild;)n.removeChild(n.firstChild)}),this.renderAnnotation(t)});q(this,"handleClick",()=>{this.getAnnotationType()===_t.ERASER&&(this.onDeleteAnnotation(this.annotation,!1),this.remove())});q(this,"renderAnnotation",t=>{const{type:n}=t;n===_t.RECTANGLE||n===_t.HIGHLIGHT||n===_t.UNDERLINE||n===_t.STRIKETHROUGH?this.renderRect():(n===_t.POLYGON||n===_t.ELLIPSE)&&this.renderShape()});q(this,"renderRect",()=>{const{type:t,pdfRects:n,color:s}=this.annotation;n&&Object.keys(n).forEach(a=>{const{viewport:o,div:i}=this.pdfViewer.getPageView(Number(a)-1),l=n[a];if(!l)return;ZO(l,o).forEach(d=>{var f;const u=document.createElement("div");u.style.cssText="\n          position: absolute;\n          left: ".concat(d.width>0?d.x:d.x-Math.abs(d.width),"px;\n          width: ").concat(Math.abs(d.width),"px;\n          background: ").concat(Xr(s).alpha(.4).toString(),";\n        "),t===_t.UNDERLINE?(u.style.top="".concat(d.y+d.height,"px"),u.style.height="2px"):t===_t.STRIKETHROUGH?(u.style.top="".concat(d.y+d.height/2,"px"),u.style.height="2px"):(u.style.top="".concat(d.height>0?d.y:d.y-Math.abs(d.height),"px"),u.style.height="".concat(Math.abs(d.height),"px"),u.style.background="".concat(Xr(s).alpha(.4).toString()),t===_t.RECTANGLE&&zR({source:u,onResizeEnd:async p=>{const g=await this.getBlobUrl(Number(a),p),_={...this.annotation,url:g,width:p.width,height:p.height,pdfRects:{[a]:yN([p],o)}};this.annotation=_,this.onUpdateAnnotation(_,!1)},container:i})),(f=this.containers[a])==null||f.appendChild(u)})})});q(this,"renderShape",()=>{var C;const{pageNumber:t,pdfRects:n,type:s,color:a}=this.annotation;let{path:o}=this.annotation;const i=s===_t.ELLIPSE,l=s===_t.POLYGON;if(i){const k=(C=n==null?void 0:n[t])==null?void 0:C[0];if(!k)return;o=[{x:k.x,y:k.y},{x:k.xMax,y:k.yMax}]}if(!o)return;const{viewport:c,div:d}=this.pdfViewer.getPageView(t-1),u=document.createElement("canvas"),f=o.map(k=>{const[T,v]=c.convertToViewportPoint(k.x,k.y);return{x:T,y:v}}),h=wF(f),p=Ap();u.width=h.width*p,u.height=h.height*p,u.style.width="".concat(h.width,"px"),u.style.height="".concat(h.height,"px");const g=this.containers[t];if(!g)return;g.style.cssText="\n      position: absolute;\n      left: ".concat(h.left,"px;\n      top: ").concat(h.top,"px;\n      width: ").concat(h.width,"px;\n      height: ").concat(h.height,"px;\n    "),g.appendChild(u);const _=u.getContext("2d");if(!_)return;_.scale(p,p),_.fillStyle=Xr(a).alpha(.4).toString();const x=[],F=f.map(k=>{const T={x:k.x-h.left,y:k.y-h.top};return x.push({x:T.x/h.width,y:T.y/h.height}),T});if(l)Vf(_,F,{closePath:!0,isFill:!0});else{const[k,T]=F;if(!k||!T)return;cp(u,k,T)}const b=f;zR({source:g,onResizeEnd:async k=>{const{pageNumber:T,color:v}=this.annotation,I=Ap(),j=[],S=b.map((O,$)=>{const M=x[$];if(M)return j.push({x:M.x*k.width,y:M.y*k.height}),{x:k.x+M.x*k.width,y:k.y+M.y*k.height}}).filter(O=>!!O),D=u.getContext("2d");if(!D)return;if(D.clearRect(0,0,u.width,u.height),u.width=k.width*I,u.height=k.height*I,u.style.width="".concat(k.width,"px"),u.style.height="".concat(k.height,"px"),D.fillStyle=Xr(v).alpha(.4).toString(),D.scale(I,I),l)Vf(D,j,{closePath:!0,isFill:!0});else{const[O,$]=j;if(!O||!$)return;cp(u,O,$)}const A=await this.getBlobUrl(T,k,S,l?EF.POLYGON:EF.ELLIPSE),P=S.map(O=>{const[$,M]=c.convertToPdfPoint(O.x,O.y);return{x:$,y:M}}),L={...this.annotation,url:A,width:k.width,height:k.height};if(i){const O=P[0],$=P[1];if(!O||!$)return;const M={x:Math.min(O.x,$.x),y:Math.max(O.y,$.y)},U={x:Math.max(O.x,$.x),y:Math.min(O.y,$.y)};L.pdfRects={[String(T)]:[{x:M.x,y:M.y,xMax:U.x,yMax:U.y}]}}else L.path=P;this.annotation=L,this.onUpdateAnnotation(L,!1)},onResizing:k=>{u.width=k.width*p,u.height=k.height*p,u.style.width="".concat(k.width,"px"),u.style.height="".concat(k.height,"px");const T=u.getContext("2d");if(!T)return;T.clearRect(0,0,u.width,u.height),T.scale(p,p),T.fillStyle=Xr(a).alpha(.4).toString();const v=[];if(b.forEach((I,j)=>{const S=x[j];S&&v.push({x:S.x*k.width,y:S.y*k.height})}),l)Vf(T,v,{closePath:!0,isFill:!0});else{const[I,j]=v;if(!I||!j)return;cp(u,I,j)}},container:d})});q(this,"getBlobUrl",async(t,n,s,a)=>{if(!this.pdfViewer)return;const{canvas:o}=this.pdfViewer.getPageView(t-1);return vj(o,n,s,a)});q(this,"getAnnotationLayer",t=>{const{div:n}=this.pdfViewer.getPageView(t-1);let s=n.querySelector(".next-space-annotationLayer");return s||(s=document.createElement("div"),s.className="next-space-annotationLayer",n.appendChild(s)),s});var c;this.pdfViewer=t,this.annotation=n,this.getAnnotationType=s,this.onUpdateAnnotation=a,this.onDeleteAnnotation=o,this.onContextMenu=i;let l=[n.pageNumber];n.type===_t.HIGHLIGHT&&(l=Object.keys((c=n.pdfRects)!=null?c:{}).map(Number)),l.forEach(d=>{const u=document.createElement("div");this.containers[d]=u,u.addEventListener("click",this.handleClick),u.addEventListener("contextmenu",h=>{var p;(p=this.onContextMenu)==null||p.call(this,h,this.annotation)});const f=this.getAnnotationLayer(d);f&&f.appendChild(u)}),this.renderAnnotation(n)}}class y1e{constructor(t){q(this,"delay",1e3);q(this,"maxStack",100);q(this,"userOnly",!1);q(this,"lastRecorded",0);q(this,"redoStack",[]);q(this,"undoStack",[]);this.pdfApplication=t}record(t,n){var a,o;const s=this.inverse(t,n);s&&(this.undoStack.push(s),(o=(a=this.pdfApplication)==null?void 0:a.onHistoryChange)==null||o.call(a,this))}inverse(t,n){switch(t.type){case Wo.ADD:return{type:Wo.DELETE,uuid:t.uuid};case Wo.DELETE:return{type:Wo.ADD,uuid:t.uuid};case Wo.UPDATE:{if(!t.patch)return;const s=Ni(n,Object.keys(t.patch));return{type:Wo.UPDATE,uuid:t.uuid,patch:s}}}}redo(){var s,a;const t=this.redoStack.pop();if(!t)return;const n=this.inverse(t,this.pdfApplication.annotations[t==null?void 0:t.uuid]);n&&(this.undoStack.push(n),this.undoStack.length>this.maxStack&&this.undoStack.shift()),(a=(s=this.pdfApplication)==null?void 0:s.onHistoryChange)==null||a.call(s,this),this.pdfApplication.applyOP(t)}undo(){var s,a,o;const t=this.undoStack.pop();if(!t)return;const n=this.inverse(t,this.pdfApplication.annotations[(s=t==null?void 0:t.uuid)!=null?s:""]);n&&(this.redoStack.push(n),this.redoStack.length>this.maxStack&&this.redoStack.shift()),(o=(a=this.pdfApplication)==null?void 0:a.onHistoryChange)==null||o.call(a,this),this.pdfApplication.applyOP(t)}clear(){this.redoStack=[],this.undoStack=[]}}function b1e(e,t){var n,s;try{const a=(s=(n=t.nodeValue)==null?void 0:n.length)!=null?s:t.childNodes.length;return e.comparePoint(t,0)<=0&&e.comparePoint(t,a)>=0}catch(a){return!1}}function F1e(e,t){if(e.collapsed)return[];let n=e.commonAncestorContainer;if(n.nodeType!==Node.ELEMENT_NODE&&(n=n.parentElement),!n)return[];const{ownerDocument:s}=n;if(!s)return[];const a=[],o=s.createNodeIterator(n,NodeFilter.SHOW_TEXT);let i;for(;i=o.nextNode();){if(!b1e(e,i)||t&&!t.contains(i))continue;const l=i;if(l instanceof Text){if(l===e.startContainer&&e.startOffset>0){l.splitText(e.startOffset);continue}l===e.endContainer&&e.endOffset<l.data.length&&l.splitText(e.endOffset),a.push(l)}}return a}function w1e(e,t){const n=F1e(e,t);let s=[],a=null,o=null;n.forEach(d=>{a&&a.nextSibling===d?o.push(d):(o=[d],s.push(o)),a=d});const i=/^\s*$/;s=s.filter(d=>d.some(u=>!i.test(u.data)));const l=[];s.forEach(d=>{const u=document.createElement("hypothesis-highlight");u.className="hypothesis-highlight";const f=d[0];if(!f)return;const h=f.parentNode;h&&(h.replaceChild(u,f),d.forEach(p=>u.appendChild(p)),l.push(u))});const c=l.map(d=>d.getBoundingClientRect());return C1e(e.commonAncestorContainer),c}function E1e(e,t){const n=e.parentNode;n&&(t.forEach(s=>n.insertBefore(s,e)),e.remove())}function C1e(e){const t=Array.from(e.querySelectorAll("hypothesis-highlight"));k1e(t)}function k1e(e){for(const t of e)if(t.parentNode){const n=Array.from(t.childNodes);E1e(t,n)}}function T1e(e){let t=Number.MAX_VALUE,n=Number.MAX_VALUE,s=Number.MIN_VALUE,a=Number.MIN_VALUE;e.forEach(l=>{t=Math.min(t,l.x),n=Math.min(n,l.y),s=Math.max(s,l.x+l.width),a=Math.max(a,l.y+l.height)});const o=s-t,i=a-n;return{left:t,top:n,width:o,height:i,right:s,bottom:a}}class v1e{constructor(t,n,s){q(this,"getPageView",t=>{if(this.application.pdfViewer)return this.application.pdfViewer.getPageView(t-1)});q(this,"bindEvent",()=>{const t=n=>{if(n.button!==0)return;const s=this.application.getAnnotationType();s===_t.RECTANGLE?this.addAreaAnnotation(this.pageNumber,n):(s===_t.HIGHLIGHT||s===_t.UNDERLINE||s===_t.STRIKETHROUGH||this.application.getAIShowSideBar())&&this.addHighlight(n,this.pageNumber)};this.textDiv.addEventListener("mousedown",t)});q(this,"addHighlight",(t,n)=>{const s=this.getPageView(n);if(!s)return;[n-1,n+1].forEach(d=>{var f,h;const u=this.getPageView(d);u&&((h=(f=u.textLayer)==null?void 0:f.textLayerRenderTask)==null||h.expandTextDivs(!0))});const a={x:t.clientX,y:t.clientY};let o=!1;const{div:i}=s,l=d=>{!o&&(Math.abs(d.clientX-a.x)>5||Math.abs(d.clientY-a.y)>5)&&(o=!0)},c=()=>{var b,w;if(document.removeEventListener("mouseup",c),document.removeEventListener("mousemove",l),!o)return;[n-1,n+1].forEach(E=>{var k,T;const C=this.getPageView(E);C&&((T=(k=C.textLayer)==null?void 0:k.textLayerRenderTask)==null||T.expandTextDivs(!1))});const d=window.getSelection();if(!d||d.isCollapsed)return;const u=d.getRangeAt(0);if(!u)return;const f=d.toString().replace(/\n/g,""),h=i.getBoundingClientRect(),p=xie(w1e(u),h.width),g=(E,C)=>{const k=this.getPageView(C);if(!k)return;const{div:T}=k,v=T.getBoundingClientRect();return E.x>=v.left&&E.x<=v.right&&E.y>=v.top&&E.y<=v.bottom?C:E.y<=v.top||E.x<=v.left?g(E,C-1):g(E,C+1)},_={};p.forEach(E=>{var k;const C=g(E,n);if(typeof C<"u"){const T=this.getPageView(C);if(!T)return;const{viewport:v,div:I}=T,j=I.getBoundingClientRect(),S=ZD(E,j),[D,A]=v.convertToPdfPoint(S.x,S.y),[P,L]=v.convertToPdfPoint(S.x+S.width,S.y+S.height);_[C]=[...(k=_[C])!=null?k:[],{x:D,y:A,xMax:P,yMax:L}]}});const x=this.application.getAnnotationType();if(!x||x===_t.NONE){this.application.getAIShowSideBar()&&(this.application.selectionRange={pdfRects:_,text:f});return}const F={text:f,type:x,pageNumber:n,pdfRects:_,uuid:qe(),color:this.application.getAnnotationColor()};(w=(b=this.application).addAnnotation)==null||w.call(b,F),setTimeout(()=>{var E;(E=window.getSelection())==null||E.removeAllRanges()},0)};document.addEventListener("mouseup",c),document.addEventListener("mousemove",l)});q(this,"addAreaAnnotation",(t,n)=>{n.preventDefault();const s=this.getPageView(t);if(!s)return;const{viewport:a,div:o}=s,i={x:n.clientX,y:n.clientY};let l=!1;const c=document.createElement("div");c.style.position="fixed",c.style.zIndex="99999",c.style.background="".concat(Xr(this.application.getAnnotationColor()).alpha(.4));const d=o.getBoundingClientRect(),f=Ps(p=>{l||(l=!0,document.body.appendChild(c));const g=Es(Math.min(p.clientX,i.x),d.left,d.right),_=Es(Math.min(p.clientY,i.y),d.top,d.bottom),x=Math.abs(Es(p.clientX,d.left,d.right)-i.x),F=Math.abs(Es(p.clientY,d.top,d.bottom)-i.y);c.style.left="".concat(g,"px"),c.style.top="".concat(_,"px"),c.style.width="".concat(x,"px"),c.style.height="".concat(F,"px")},60),h=async()=>{var w,E;document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",h);const p=c.getBoundingClientRect();if(c.remove(),p.width<5||p.height<5)return;const g=o.getBoundingClientRect(),_=ZD(p,g),x=yN([_],a),b={url:await this.getBlobUrl(t,_),width:_.width,height:_.height,type:_t.RECTANGLE,pdfRects:{[t]:x},pageNumber:t,uuid:qe(),color:this.application.getAnnotationColor()};(E=(w=this.application).addAnnotation)==null||E.call(w,b)};document.addEventListener("mousemove",f),document.addEventListener("mouseup",h)});q(this,"getBlobUrl",async(t,n,s,a)=>{const o=this.getPageView(t);if(o)return vj(o.canvas,n,s,a)});this.textDiv=t,this.pageNumber=n,this.application=s,this.bindEvent()}}function qR(e,t,n){const{pdfRects:s,text:a}=e;document.querySelectorAll(".pdf-selection-box").forEach(c=>c.remove());let i=1/0,l=[];Object.keys(s).forEach(c=>{var _;const{viewport:d,div:u}=t.getPageView(Number(c)-1),f=s[c];if(!f)return;const h=ZO(f,d),p=document.createElement("div");p.classList.add("pdf-selection-box"),u.appendChild(p);const g=T1e(h);Number(c)<i&&(i=Number(c),l=yN([{x:g.left,y:g.top,width:g.width,height:g.height}],d)),p.style.cssText="\n      position: absolute;\n      left: ".concat(g.left,"px;\n      top : ").concat(g.top,"px;\n      width: ").concat(g.width,"px;\n      height: ").concat(g.height,"px;\n      border: 2px solid var(--active_color);\n      pointer-events: none;\n    "),p.innerHTML='<div style="position: absolute; bottom: -10px; transform: translateY(100%); right: 20px; border: 1px solid rgba(0, 0, 0, 0.06); box-shadow: 0px 12px 20px rgba(0, 0, 0, 0.16); border-radius: 4px; padding: 12px; background: white; cursor: pointer; pointer-events: auto;">\n      <img src="'.concat(Lo,'assets/pdf_ai_icon.svg" style="width: 20px; height: 20px;">\n    </div>'),(_=p.firstChild)==null||_.addEventListener("click",()=>n==null?void 0:n(i,a,l[0]))})}const py=e=>Ap()*e;class I1e{constructor(t,n,s,a){q(this,"pathStack",{redo:[],undo:[]});q(this,"drawingPoints",[]);q(this,"isPolygonDrawing",!1);q(this,"editorLayer",document.createElement("div"));q(this,"canvas",document.createElement("canvas"));q(this,"ctx");q(this,"color","#000");q(this,"annotationType");q(this,"removeEscEvent");q(this,"onAnnotationLayerRendered",t=>{if(t.pageNumber!==this.pageNumber||(t.source.div.appendChild(this.editorLayer),this.canvas.width=Math.floor(py(this.canvas.clientWidth)),this.canvas.height=Math.floor(py(this.canvas.clientHeight)),this.ctx=this.canvas.getContext("2d"),!this.ctx))return;const s=Ap();this.ctx.scale(s,s),this.ctx.fillStyle=Xr(this.color).alpha(.4).toString(),this.ctx.strokeStyle=this.color});q(this,"getPageView",t=>this.pdfViewer.getPageView(t-1));q(this,"bindEvent",()=>{if(!this.ctx)return;const t=n=>{n.button===0&&(n.preventDefault(),this.annotationType===_t.POLYGON?this.drawPolygon(n):this.annotationType===_t.ELLIPSE?this.drawCircle(n):this.annotationType===_t.PENCIL&&this.drawFreeLine(n))};this.removeEscEvent=this.bindEscEvent(),this.canvas.addEventListener("mousedown",t)});q(this,"bindEscEvent",()=>{const t=n=>{Ie("esc")(n)&&(this.annotationType===_t.POLYGON&&(n.stopPropagation(),this.closePolygonPath()),this.drawingPoints=[])};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}});q(this,"drawPolygon",t=>{if(!this.isPolygonDrawing){this.isPolygonDrawing=!0;const s=o=>{if(!this.isPolygonDrawing){document.removeEventListener("keydown",a,!0),document.removeEventListener("mousemove",s);return}this.drawingPoints=this.drawingPoints.filter(c=>!c.isTemp);const i=this.getPoint(o),l=this.drawingPoints[0];this.drawingPoints.length>=3&&l&&Math.abs(l.x-i.x)<8&&Math.abs(l.y-i.y)<8?this.drawingPoints.push({...l,isTemp:!0}):this.drawingPoints.push({...i,isTemp:!0}),this.clearBoard(),this.ctx&&this.drawingPoints.length!==1&&Vf(this.ctx,this.drawingPoints,{lineCap:"round",joinShape:"round"})},a=o=>{if(this.isPolygonDrawing){if(Ie("mod+z")(o)){o.preventDefault(),o.stopPropagation();const i=this.pathStack.undo.pop();if(i){this.pathStack.redo.push([...this.drawingPoints.filter(c=>!c.isTemp)]);const l=this.drawingPoints.find(c=>c.isTemp);if(this.drawingPoints=l?i.concat(l):i,this.ctx){if(this.clearBoard(),this.drawingPoints.length===1)return;Vf(this.ctx,this.drawingPoints,{lineCap:"round",joinShape:"round"})}}}if(Ie("mod+shift+z")(o)){o.preventDefault(),o.stopPropagation();const i=this.pathStack.redo.pop();if(i){this.pathStack.undo.push([...this.drawingPoints.filter(c=>!c.isTemp)]);const l=this.drawingPoints.find(c=>c.isTemp);if(this.drawingPoints=l?i.concat(l):i,this.ctx){if(this.clearBoard(),this.drawingPoints.length===1)return;Vf(this.ctx,this.drawingPoints,{lineCap:"round",joinShape:"round"})}}}}};document.addEventListener("keydown",a,!0),document.addEventListener("mousemove",s)}if(this.drawingPoints.length>=4){const s=this.drawingPoints[0],a=this.drawingPoints[this.drawingPoints.length-1];if(s&&a&&s.x===a.x&&s.y===a.y){this.closePolygonPath();return}}const n=this.getPoint(t);this.ctx&&(this.ctx.beginPath(),this.ctx.arc(n.x,n.y,5,0,2*Math.PI),this.ctx.fill(),this.pathStack.undo.push([...this.drawingPoints.filter(s=>!s.isTemp)]),this.drawingPoints.push(n))});q(this,"drawCircle",t=>{let n=!1;this.drawingPoints.push(this.getPoint(t));const s=(c,d)=>{const u=d.x-c.x,f=d.y-c.y,h=Math.max(Math.abs(u),Math.abs(f));return{x:u>0?c.x+h:c.x-h,y:f>0?c.y+h:c.y-h}},a=c=>{if(!this.ctx)return;this.drawingPoints.length>1&&this.drawingPoints.pop(),this.drawingPoints.push(this.getPoint(c)),this.clearBoard();const[d,u]=this.drawingPoints;!d||!u||cp(this.canvas,d,n?s(d,u):u)},o=c=>{if(c.shiftKey){n=!0,this.clearBoard();const[d,u]=this.drawingPoints;if(!d||!u)return;cp(this.canvas,d,s(d,u))}},i=()=>{n=!1,this.clearBoard();const[c,d]=this.drawingPoints;!c||!d||cp(this.canvas,c,d)},l=async()=>{if(document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",l),document.removeEventListener("keydown",o),document.removeEventListener("keyup",i),!!this.ctx){if(this.drawingPoints.length>1){if(n){const[w,E]=this.drawingPoints;if(!w||!E)return;this.drawingPoints[1]=s(w,E)}const c=this.drawingPoints,d=wF(c),u=this.getPageView(this.pageNumber),f=c.map(w=>{const[E,C]=u.viewport.convertToPdfPoint(w.x,w.y);return{x:E,y:C}}),h=f[0],p=f[1];if(!h||!p)return;const g={x:Math.min(h.x,p.x),y:Math.max(h.y,p.y)},_={x:Math.max(h.x,p.x),y:Math.min(h.y,p.y)},x={x:g.x,y:g.y,xMax:_.x,yMax:_.y},F={width:d.width,height:d.height,type:_t.ELLIPSE,pdfRects:{[String(this.pageNumber)]:[x]},pageNumber:this.pageNumber,color:this.color,uuid:qe()},b=await this.getBlobUrl(this.pageNumber,{...d,x:d.left,y:d.top},c,EF.ELLIPSE);F.url=b,this.onAddAnnotation(F)}this.clearBoard(),this.drawingPoints=[]}};document.addEventListener("mousemove",a),document.addEventListener("mouseup",l),document.addEventListener("keydown",o),document.addEventListener("keyup",i)});q(this,"drawFreeLine",t=>{let n=this.getPoint(t);const s=o=>{if(!this.ctx)return;const i=this.getPoint(o);Vf(this.ctx,[n,i],{lineCap:"round",lineJoin:"round"}),n=i,this.drawingPoints.push(i)},a=()=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",a)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",a)});q(this,"closePolygonPath",async()=>{if(this.ctx){if(this.isPolygonDrawing=!1,this.pathStack={redo:[],undo:[]},this.drawingPoints.pop(),this.drawingPoints.length>2){const t=this.drawingPoints,n=wF(t),s=this.getPageView(this.pageNumber),a=t.map(l=>{const[c,d]=s.viewport.convertToPdfPoint(l.x,l.y);return{x:c,y:d}}),o={width:n.width,height:n.height,type:_t.POLYGON,path:a,pageNumber:this.pageNumber,color:this.color,uuid:qe()},i=await this.getBlobUrl(this.pageNumber,{...n,x:n.left,y:n.top},t);o.url=i,this.onAddAnnotation(o)}this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawingPoints=[]}});q(this,"getBlobUrl",async(t,n,s,a)=>{const o=this.getPageView(t);return vj(o.canvas,n,s,a)});q(this,"getPoint",t=>{const n=this.canvas.getBoundingClientRect(),s=Es(t.clientX,n.left,n.right),a=Es(t.clientY,n.top,n.bottom);return{x:s-n.x,y:a-n.y}});q(this,"setColor",t=>{this.color!==t&&this.ctx&&(this.color=t,this.ctx.strokeStyle=t,this.ctx.fillStyle=Xr(t).alpha(.4).toString())});q(this,"clearBoard",()=>{this.ctx&&this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)});q(this,"disable",()=>{var t;this.annotationType===_t.POLYGON&&this.closePolygonPath(),this.drawingPoints=[],this.annotationType=_t.NONE,this.isPolygonDrawing=!1,this.clearBoard(),(t=this.removeEscEvent)==null||t.call(this),this.editorLayer.style.pointerEvents="none"});q(this,"enable",(t,n)=>{this.setColor(n),t!==this.annotationType&&(this.annotationType===_t.POLYGON&&this.closePolygonPath(),this.annotationType!==t&&(this.drawingPoints=[]),this.bindEscEvent(),this.annotationType=t,this.editorLayer.style.pointerEvents="auto")});var c;this.pdfViewer=t,this.pageNumber=n,this.onAddAnnotation=s,this.color=(c=a==null?void 0:a.color)!=null?c:"#000",this.annotationType=a==null?void 0:a.annotationType;const i=this.getPageView(n).div;this.editorLayer.className="annotationEditorLayer",i.appendChild(this.editorLayer),this.editorLayer.appendChild(this.canvas),this.canvas.width=Math.floor(py(this.canvas.clientWidth)),this.canvas.height=Math.floor(py(this.canvas.clientHeight)),this.ctx=this.canvas.getContext("2d");const l=Ap();this.ctx&&(this.ctx.scale(l,l),this.ctx.strokeStyle=this.color,this.ctx.fillStyle=Xr(this.color).alpha(.4).toString(),this.bindEvent(),this.pdfViewer.eventBus.on("annotationlayerrendered",this.onAnnotationLayerRendered))}}class N1e{constructor(t,n){q(this,"shapeEditorMap",{});q(this,"getLoadedPage",()=>{if(!this.pdfViewer)return[];const t=[];for(let n=0;n<this.pdfViewer.pagesCount;n++){const s=this.pdfViewer.getPageView(n);s.renderingState===yo.FINISHED&&t.push(s)}return t});q(this,"enableAll",(t,n)=>{const s=this.getLoadedPage(),a=new Set;s.forEach(o=>{a.add(o.id),this.ensureShapeEditor(o,t,n)}),Object.entries(this.shapeEditorMap).forEach(([o,i])=>{a.has(Number(o))||i.enable(t,n)})});q(this,"disableAll",()=>{Object.values(this.shapeEditorMap).forEach(t=>{t.disable()})});q(this,"ensureShapeEditor",(t,n,s)=>{const a=t.id;let o=this.shapeEditorMap[a];if(o)o==null||o.enable(n,s);else{if(!this.pdfViewer)return;o=new I1e(this.pdfViewer,a,this.onAddShape,{annotationType:n,color:s}),this.shapeEditorMap[t.id]=o}});q(this,"setEditorColor",t=>{Object.values(this.shapeEditorMap).forEach(n=>{n.setColor(t)})});this.pdfViewer=t,this.onAddShape=n}}let k_=null;const j1e=()=>{k_&&clearTimeout(k_),k_=setTimeout(()=>{k_=null},1e3)};class S1e{constructor(t,n){q(this,"wheelUnusedTicks",0);q(this,"destroy",()=>{this.container.removeEventListener("wheel",this.webViewerWheel)});q(this,"accumulateWheelTicks",t=>{(this.wheelUnusedTicks>0&&t<0||this.wheelUnusedTicks<0&&t>0)&&(this.wheelUnusedTicks=0),this.wheelUnusedTicks+=t;const n=Math.sign(this.wheelUnusedTicks)*Math.floor(Math.abs(this.wheelUnusedTicks));return this.wheelUnusedTicks-=n,n});q(this,"webViewerWheel",t=>{if(this.pdfViewer&&!this.pdfViewer.isInPresentationMode)if(t.ctrlKey||t.metaKey){if(t.preventDefault(),k_||document.visibilityState==="hidden")return;const{deltaMode:n}=t,s=wK(t),a=this.pdfViewer.currentScale;let o=0;if(n===WheelEvent.DOM_DELTA_LINE||n===WheelEvent.DOM_DELTA_PAGE?Math.abs(s)>=1?o=Math.sign(s):o=this.accumulateWheelTicks(s):o=this.accumulateWheelTicks(s/30),o<0)this.pdfViewer.decreaseScale(-o);else if(o>0){if(this.pdfViewer.currentScale>=4)return;this.pdfViewer.increaseScale(o)}const{currentScale:i}=this.pdfViewer;if(a!==i){const l=i/a-1,c=this.pdfViewer.container.getBoundingClientRect(),d=t.clientX-c.left,u=t.clientY-c.top;this.pdfViewer.container.scrollLeft+=d*l,this.pdfViewer.container.scrollTop+=u*l}}else j1e()});this.pdfViewer=t,this.container=n,this.container.addEventListener("wheel",this.webViewerWheel,{passive:!1})}}e1.GlobalWorkerOptions.workerSrc=wu()?"".concat(Lo,"pdfjs/pdf.worker.min.js"):"".concat(Lo,"assets/pdf/pdf.worker.min.js");const D1e=wu()?"".concat(Lo,"/cmaps/"):"".concat(Lo,"assets/cmaps/");class A1e{constructor(t,n,s,a,o){q(this,"pdfDocument");q(this,"loadingTask");q(this,"pdfViewer");q(this,"pdfThumbnailViewer");q(this,"pdfLinkService");q(this,"findController");q(this,"pdfRenderingQueue");q(this,"eventBus");q(this,"pdfCursorTools");q(this,"isThumbnailViewEnabled",!0);q(this,"shapeEditorManager");q(this,"annotationType",_t.NONE);q(this,"annotationColor","#000");q(this,"annotationLineWidth",1);q(this,"annotations",{});q(this,"annotationRenders",{});q(this,"disposed",!1);q(this,"history");q(this,"wheelUnusedTicks",0);q(this,"webViewerWheel");q(this,"showAISideBar",!1);q(this,"_selectionRange");q(this,"onPassword");q(this,"onProgress");q(this,"onCopyPermission");q(this,"onPagesInit");q(this,"onAddAnnotation");q(this,"onUpdateAnnotation");q(this,"onDeleteAnnotation");q(this,"onAnnotationContextMenu");q(this,"onHistoryChange");q(this,"onAIButtonClick");q(this,"initialize",()=>{const t=new gf.EventBus;this.eventBus=t;const n=new EK;n.onIdle=this.cleanup,n.isThumbnailViewEnabled=this.isThumbnailViewEnabled,this.pdfRenderingQueue=n;const s=new gf.PDFLinkService({eventBus:t});this.pdfLinkService=s;const a=new gf.PDFFindController({eventBus:t,linkService:s});this.findController=a,this.pdfViewer=new gf.PDFViewer({container:this.scrollContainer,viewer:this.pageContainer,l10n:gf.NullL10n,eventBus:t,linkService:s,findController:a,renderingQueue:n,textLayerMode:mie.ENABLE_ENHANCE}),n.setViewer(this.pdfViewer),s.setViewer(this.pdfViewer),this.pdfThumbnailViewer=new p1e({container:this.thumbnailContainer,eventBus:t,renderingQueue:n,linkService:s,l10n:gf.NullL10n}),n.setThumbnailViewer(this.pdfThumbnailViewer);const o=new gf.PDFHistory({linkService:s,eventBus:t});s.setHistory(o);const i=new CK({container:this.scrollContainer,eventBus:t,cursorToolOnLoad:0});this.pdfCursorTools=i});q(this,"loadViewer",()=>{var a,o;const{pdfDocument:t,pdfViewer:n,eventBus:s}=this;!t||!n||!s||(n.setDocument(t),(a=this.pdfLinkService)==null||a.setDocument(t,null),(o=this.pdfThumbnailViewer)==null||o.setDocument(t),n.firstPagePromise.then(()=>{var i;s.on("pagerendered",this.onPageRendered),s.on("textlayerrendered",this.onTextLayerRendered),s.on("rotationchanging",l=>{this.pdfThumbnailViewer&&(this.pdfThumbnailViewer.pagesRotation=l.pagesRotation),this.pdfRenderingQueue.renderHighestPriority(),n.currentPageNumber=l.pageNumber}),s.on("resize",()=>{if(!n)return;n.updateContainerHeightCss();const{currentScaleValue:l}=n;(l==="auto"||l==="page-fit"||l==="page-width")&&(n.currentScaleValue=l),n.update()}),s.on("annotationlayerrendered",l=>{var c;n&&(this.annotationType===_t.PENCIL||this.annotationType===_t.POLYGON||this.annotationType===_t.ELLIPSE)&&((c=this.shapeEditorManager)==null||c.ensureShapeEditor(l.source,this.annotationType,this.annotationColor))}),(i=this.onPagesInit)==null||i.call(this),this.checkPermissions(),window.addEventListener("resize",this.handleResize),this.webViewerWheel=new S1e(n,this.scrollContainer),this.shapeEditorManager=new N1e(n,this.addAnnotation)}).catch(()=>{}).then(()=>{n.update()}))});q(this,"checkPermissions",async()=>{if(!this.pdfDocument)return;const t=await this.pdfDocument.getPermissions();if(t&&!t.includes(uie.COPY)){const n=s=>{var a;if(Ie("mod+a")(s)){s.preventDefault();return}if(Ie("mod+c")(s)){const o=window.getSelection();if(!o)return;const i=o.getRangeAt(0);if(i.collapsed)return;const l=i.commonAncestorContainer,{endContainer:c}=i,{startContainer:d}=i;(this.pageContainer.contains(l)||this.pageContainer.contains(c)||this.pageContainer.contains(d))&&(s.preventDefault(),(a=this.onCopyPermission)==null||a.call(this))}};window.addEventListener("keydown",n)}});q(this,"handleResize",Ps(()=>{var t,n;this.pdfViewer&&((n=(t=this.pdfViewer)==null?void 0:t.eventBus)==null||n.dispatch("resize",{}))},60));q(this,"onPageRendered",t=>{if(!this.pdfViewer)return;const{pageNumber:n}=t,{div:s,textLayer:{textLayerDiv:a}}=this.pdfViewer.getPageView(n-1),o=s.querySelector(".next-space-annotationLayer");o&&(o.style.transform=a.style.transform,o.style.transformOrigin=a.style.transformOrigin)});q(this,"onTextLayerRendered",t=>{const{pageNumber:n,source:s}=t;Object.values(this.annotations).forEach(i=>{i.pageNumber===n&&i.live!==!1&&this.renderAnnotation(i)});const a=s.textLayerDiv;if(!this.pdfViewer)return;this.selectionRange&&qR(this.selectionRange,this.pdfViewer,this.onAIButtonClick);const o=()=>{document.querySelectorAll(".pdf-selection-box").forEach(l=>l.remove()),this.selectionRange=void 0,this.pageContainer.classList.add("disableAnnotation"),document.addEventListener("mouseup",()=>{this.pageContainer.classList.remove("disableAnnotation")})};a.addEventListener("mousedown",o),new v1e(a,n,this),xn.emit("pdfRenderPage",t)});q(this,"renderAnnotation",t=>{this.pdfViewer&&(this.annotationRenders[t.uuid]=new x1e(this.pdfViewer,t,this.getAnnotationType,this.updateAnnotation,this.deleteAnnotation,this.onAnnotationContextMenu))});q(this,"addAnnotation",t=>{var n,s;this.annotations[t.uuid]=t,(n=this.onAddAnnotation)==null||n.call(this,t),this.renderAnnotation(t),(s=this.history)==null||s.record({type:Wo.ADD,uuid:t.uuid})});q(this,"updateAnnotation",(t,n=!0)=>{var s,a,o;(s=this.history)==null||s.record({type:Wo.UPDATE,uuid:t.uuid,patch:t},this.annotations[t.uuid]),this.annotations[t.uuid]=t,(a=this.onUpdateAnnotation)==null||a.call(this,t),n&&((o=this.annotationRenders[t.uuid])==null||o.update(t))});q(this,"deleteAnnotation",(t,n=!0)=>{var a,o,i;const s=this.annotations[t.uuid];s&&(s.live=!1,(a=this.onDeleteAnnotation)==null||a.call(this,t),(o=this.history)==null||o.record({type:Wo.DELETE,uuid:t.uuid}),n&&((i=this.annotationRenders[t.uuid])==null||i.remove(),delete this.annotationRenders[t.uuid]))});q(this,"syncAddAnnotation",t=>{this.annotations[t.uuid]=t,this.renderAnnotation(t)});q(this,"syncUpdateAnnotation",t=>{var n;this.annotations[t.uuid]=t,(n=this.annotationRenders[t.uuid])==null||n.update(t)});q(this,"setAnnotationType",t=>{var n,s;this.annotationType!==t&&(this.annotationType=t,this.pageContainer.classList.remove(_t.ERASER,_t.POLYGON,_t.RECTANGLE,_t.HIGHLIGHT,_t.ELLIPSE),(t===_t.ERASER||t===_t.POLYGON||t===_t.ELLIPSE||t===_t.RECTANGLE||t===_t.HIGHLIGHT)&&this.pageContainer.classList.add(t),t===_t.POLYGON||t===_t.ELLIPSE?(n=this.shapeEditorManager)==null||n.enableAll(t,this.annotationColor):(s=this.shapeEditorManager)==null||s.disableAll())});q(this,"setAnnotationColor",t=>{var n;this.annotationColor=t,(n=this.shapeEditorManager)==null||n.setEditorColor(t)});q(this,"setAIShowSideBar",t=>{this.showAISideBar=t,t||document.querySelectorAll(".pdf-selection-box").forEach(s=>s.remove())});q(this,"getAIShowSideBar",()=>this.showAISideBar);q(this,"getAnnotationType",()=>this.annotationType);q(this,"getAnnotationColor",()=>this.annotationColor);q(this,"getAnnotations",()=>this.annotations);q(this,"redo",()=>{var t;return(t=this.history)==null?void 0:t.redo()});q(this,"undo",()=>{var t;return(t=this.history)==null?void 0:t.undo()});q(this,"applyOP",t=>{var s,a;const n=this.annotations[t.uuid];if(n)switch(t.type){case Wo.ADD:{n.live=!0,this.renderAnnotation(n);break}case Wo.DELETE:{n.live=!1,(s=this.annotationRenders[t.uuid])==null||s.remove(),delete this.annotationRenders[t.uuid];break}case Wo.UPDATE:{if(!t.patch)return;const o={...n,...t.patch};this.annotations[t.uuid]=o,(a=this.annotationRenders[t.uuid])==null||a.update(o);break}}});this.fileUrl=t,this.scrollContainer=n,this.thumbnailContainer=s,this.pageContainer=a,o!=null&&o.annotations&&(this.annotations=o==null?void 0:o.annotations),o!=null&&o.color&&(this.annotationColor=o.color),o!=null&&o.annotationType&&this.setAnnotationType(o.annotationType),o!=null&&o.showAISideBar&&this.setAIShowSideBar(!0),this.history=new y1e(this)}async loadPDF(t){var s;this.initialize();let n;if(typeof this.fileUrl=="string"?n={url:this.fileUrl,cMapUrl:D1e,cMapPacked:!0,rangeChunkSize:65536,disableAutoFetch:!1,disableStream:!0,password:t}:n=this.fileUrl,this.loadingTask=e1.getDocument(n),!!this.loadingTask){if(this.onPassword&&(this.loadingTask.onPassword=this.onPassword),this.loadingTask.onProgress=({loaded:a,total:o})=>{var i;return(i=this.onProgress)==null||i.call(this,a,o),a/o},this.pdfDocument=await this.loadingTask.promise,this.disposed){(s=this.loadingTask)==null||s.destroy(),this.pdfDocument.destroy();return}this.loadViewer()}}cleanup(){var t,n;(t=this.pdfViewer)==null||t.cleanup(),(n=this.pdfThumbnailViewer)==null||n.cleanup()}set selectionRange(t){this._selectionRange=t,this._selectionRange&&qR(this._selectionRange,this.pdfViewer,this.onAIButtonClick)}get selectionRange(){return this._selectionRange}dispose(){var t;window.removeEventListener("resize",this.handleResize),this.disposed=!0,(t=this.webViewerWheel)==null||t.destroy(),this.loadingTask&&this.loadingTask.destroy(),this.pdfDocument&&this.pdfDocument.destroy()}}const GR=e=>e.type===_t.HIGHLIGHT?{pageNumber:e.pageNumber,type:e.type,color:e.color,pdfRects:e.pdfRects,text:e.text}:{pageNumber:e.pageNumber,type:e.type,color:e.color,pdfRects:e.pdfRects,path:e.path,text:e.text,width:e.width,height:e.height},R1e=({uuid:e,recordId:t,propertyId:n,downloadUrl:s,embed:a})=>{var A,P,L,O;const o=s.startsWith("blob:"),i=y.useRef(),l=We(e),c=Un(),d=y.useRef(),u=xM(),f=y.useRef(),h=Oe(),p=_M(),g=Uo(),_=y.useRef(null),x=y.useRef(null),F=y.useRef(null),b=y.useRef(null),w=y.useRef(null),E=y.useRef(null),C=ie(),[k,T]=y.useState("loading"),v=tee(),I=(A=ua.get(e!=null?e:""))!=null?A:{},[j,S]=y.useState((P=I.sideBarType)!=null?P:ao.THUMBNAIL_VIEW);y.useEffect(()=>{if(!a&&e){const{blocks:$}=pe(),M=$[e];if(!M)return;const U=fe(M==null?void 0:M.data.segments),{name:z,extName:K}=rn(U);document.title="".concat(z,".").concat(K)}},[a,e]),y.useEffect(()=>{},[s]),y.useEffect(()=>{var $;j===ao.THUMBNAIL_VIEW&&(($=i.current)==null||$.update())},[j]),y.useEffect(()=>{var W;if(!x.current||!F.current||!_.current||o)return;T("loading");let $;if(e){const Y=pe().blocks[e];$=(W=Y==null?void 0:Y.data.format)==null?void 0:W.pdfFormat}const M={};if(e){const{blocks:Y}=pe(),G=Y[e];f.current=$==null?void 0:$.password,G==null||G.subNodes.forEach(ee=>{const te=Y[ee];if(!te)return;const{pdfAnnotation:Q}=te.data;if(!Q)return;const ne={...Q,uuid:ee};M[ee]=ne})}const U=d.current=new A1e(s,x.current,F.current,_.current,{color:Gd.YELLOW,annotations:M,annotationType:_t.NONE,showAISideBar:v});U.onAIButtonClick=(Y,G,ee)=>{const te=xt.$pdfQuotes;let Q=[];if(ee){const{x:ne,y:se,xMax:ce,yMax:ae}=ee;Q=[ne,ae,ce,se]}te.find(ne=>ne[0]===Y&&ne[1]===G)||st({$pdfQuotes:[...te,[Y,G,Q]]})},U.onPassword=async(Y,G)=>{C.modal({keyboard:!1,closeBeforeCallBackForClickOutSide:()=>{T("fail")},content:({onCloseModal:ee})=>r.jsx(nce,{uuid:e,onCancel:()=>{ee(),T("fail")},onPassword:(te,Q)=>{ee(),Y(te),Q?f.current=te:f.current=void 0},reason:G})})},U.onCopyPermission=()=>{be.warning("用户设置了密码保护，无法复制！")},U.onPagesInit=()=>{if(!U.pdfViewer)return;i.current=U.pdfViewer;const{pdfViewer:Y}=U;$!=null&&$.rotation&&(Y.pagesRotation=$.rotation);const G=new URLSearchParams(location.search).get("annotationPos");if(G){const[ee,te,Q]=G.split(",");if(ee){let ne="page=".concat(ee,"&zoom=page-actual");te&&Q&&(ne+=",".concat(te,",").concat(Number(Q)+10)),Y.linkService.setHash(ne)}else Y.currentScaleValue="page-actual"}else{const ee=ua.get(e!=null?e:"");ee&&(Y.scrollMode=ee.scrollMode===zb.HORIZONTAL?1:0,Y.spreadMode=ee.spreadMode===qb.DOUBLE?1:0),ee!=null&&ee.lastViewPos?Y.linkService.setHash(ee.lastViewPos):Y.currentScaleValue="page-actual"}e&&f.current&&!l&&u(e,{password:f.current}),Y.container.addEventListener("mouseup",()=>{document.querySelectorAll(".".concat(xN)).forEach(te=>te.remove())}),T("success")},U.onAddAnnotation=Y=>{if(e){const G=GR(Y);if(_T(Y.type)){if(me.event("highlight_shape",{file_id:e}),!Y.url)return;const ee=wT(Y.url);if(!ee)return;g({file:new File([ee],"图片标注.png"),type:"file",onComplete:te=>{te.success&&h(()=>{G.ossName=te.ossName,G.size=ee.size,ut({uuid:Y.uuid,type:m.BlockType.PDF_ANNOTATION,data:{pdfAnnotation:G,localUrl:Y.url}},{parentId:e,last:!0});const Q='{"annotationId": "'.concat(Y.uuid,'", "type": "imageBlock"}');Xt(Q)})}})}else me.event("highlight_text",{file_id:e}),h(()=>{ut({uuid:Y.uuid,type:m.BlockType.PDF_ANNOTATION,data:{pdfAnnotation:G}},{parentId:e,last:!0});const ee='{"annotationId": "'.concat(Y.uuid,'"}');Xt(ee)})}},U.onDeleteAnnotation=Y=>{h(()=>{gr(Y.uuid)})},U.onUpdateAnnotation=Y=>{const G=GR(Y);if(_T(Y.type)){if(!Y.url)return;const ee=wT(Y.url);if(!ee)return;g({file:new File([ee],"图片标注.png"),type:"file",onComplete:te=>{te.success&&(G.ossName=te.ossName,G.size=ee.size,p(Y.uuid,G,Y.url))}})}else p(Y.uuid,G)},U.onAnnotationContextMenu=(Y,G)=>{if(!e)return null;Y.preventDefault(),Y.stopPropagation(),C.dropdown({popcorn:_m(Y),placement:"right",content:({onCloseModal:ee})=>r.jsx(sce,{pdfId:e,application:U,annotation:G,closeModal:ee})})},U.loadPDF(f.current),xn.on("pdfCursor",Y=>{(Y===_t.RECTANGLE||Y===_t.ELLIPSE||Y===_t.POLYGON||Y===_t.ERASER||Y===_t.HIGHLIGHT||Y===_t.NONE)&&U.setAnnotationType(Y)}),xn.on("pdfCursorColor",Y=>{U.setAnnotationColor(Y)}),xn.on("sidebarType",Y=>{var G;if(Y){if(e){const ee=(G=ua.get(e!=null?e:""))!=null?G:{};ua.put(e,{...ee,sideBarType:Y})}S(Y)}});const z=Y=>{Ie("mod+z")(Y)&&(re(jm()),U.undo()),Ie("mod+shift+z")(Y)&&(re(cg()),U.redo())};document.addEventListener("keydown",z);const K=()=>{var Y,G;if(e&&U.pdfViewer){const ee=(Y=U.pdfViewer._location)==null?void 0:Y.pdfOpenParams.slice(1);if(ee){const te=(G=ua.get(e!=null?e:""))!=null?G:{};ua.put(e,{...te,lastViewPos:ee})}}};return window.addEventListener("beforeunload",K),()=>{K(),st({$pdfAIContents:[],$pdfQuotes:[]}),document.removeEventListener("keydown",z,!0),window.removeEventListener("beforeunload",K),U.dispose()}},[s]),y.useEffect(()=>{const $=w.current,M=b.current;if(!$||!M)return;const U=z=>{z.preventDefault(),z.stopPropagation();const K=Y=>{M.style.width="".concat(Es(Y.clientX,200,300),"px")},W=()=>{var Y;if(document.removeEventListener("mousemove",K),document.removeEventListener("mouseup",W),$.style.transform="none",e){const G=(Y=ua.get(e!=null?e:""))!=null?Y:{};ua.put(e,{...G,sideBarWidth:M.clientWidth})}};document.addEventListener("mousemove",K),document.addEventListener("mouseup",W)};$.addEventListener("mousedown",U)},[e]),y.useEffect(()=>{const $=E.current,M=x.current;if(!$&&!M)return;const U=z=>{z.preventDefault(),z.stopPropagation();const K=Y=>{if(!$||!M)return;const{parentElement:G}=$;if(!G)return;const ee=Es(window.innerWidth-Y.clientX,250,450);G.style.width="".concat(ee,"px"),M.style.width="calc(100% - ".concat(ee,"px)")},W=()=>{document.removeEventListener("mousemove",K),document.removeEventListener("mouseup",W)};document.addEventListener("mousemove",K),document.addEventListener("mouseup",W)};$==null||$.addEventListener("mousedown",U)},[e]);const D=k==="loading";return r.jsxs("div",{className:"relative h-full w-full text-black flex flex-col",children:[i.current&&e&&d.current&&r.jsx(d1e,{uuid:e,application:d.current,pdfViewer:i.current,embed:a,downloadUrl:o?void 0:s}),r.jsxs("div",{className:"relative flex overflow-auto border-t bg-grey7 flex-1",children:[r.jsxs("div",{className:R("relative",(j===ao.NONE||c===wt.PAGE_LITE_PREVIEW||D)&&"hidden"),ref:b,style:{width:"".concat((O=(L=ua.get(e!=null?e:""))==null?void 0:L.sideBarWidth)!=null?O:220,"px")},children:[r.jsxs("div",{className:R("w-full h-full bg-grey8 overflow-auto py-2 ",j===ao.THUMBNAIL_VIEW&&"hidden"),children:[i.current&&j===ao.CATALOGUE&&r.jsx(ece,{pdfViewer:i.current}),i.current&&j===ao.ANNOTATION&&e&&r.jsx(Jle,{pdfViewer:i.current,uuid:e})]}),r.jsx("div",{id:"thumbnailView",ref:F,className:R("w-full h-full bg-grey8 overflow-auto relative py-4",j!==ao.THUMBNAIL_VIEW&&"hidden")}),r.jsx("div",{className:"absolute w-0.5 animate-hover cursor-col-resize right-0 top-0 h-full z-10",ref:w})]}),r.jsxs("div",{className:R("relative flex-1",!D&&j!==ao.NONE&&"border-l"),children:[r.jsx("div",{ref:x,className:"absolute h-full overflow-auto py-2",style:{width:v?"calc(100% - 360px)":"100%"},children:r.jsx("div",{ref:_,className:R("pdfViewer",a&&"embedPreview")})}),r.jsxs("div",{className:R("absolute top-0 right-0 bottom-0 w-[360px] hidden",v&&d.current&&"block"),children:[r.jsx("div",{className:"absolute w-0.5 left-0 animate-hover cursor-col-resize top-0 h-full z-10",ref:E}),v&&d.current&&!o&&r.jsx(Kle,{uuid:e,recordId:t,propertyId:n,ossName:Y1(new URL(s).pathname.slice(1)),application:d.current})]})]})]}),k==="loading"&&r.jsx("div",{className:"flex h-full w-full items-center justify-center absolute left-0 top-0",children:r.jsx($s,{})}),k==="fail"&&r.jsx("div",{className:"flex h-full w-full items-center justify-center absolute left-0 top-0",children:"预览失败"})]})},Ij=e=>{const t=Ak(e.videoUrl),n=!1,[s,a]=y.useState(!n);return r.jsx(r.Fragment,{children:s?r.jsx(kK,{loading:"lazy",width:"100%",height:"100%",controls:!0,url:e.videoUrl,stopOnUnmount:!0,style:e.style,fallback:r.jsx(xs,{}),config:{file:{attributes:{controlsList:"nodownload"}}}}):r.jsxs("div",{onClick:()=>a(!0),className:"relative flex items-center justify-center cursor-pointer",children:[r.jsx(V,{className:"absolute z-10 text-grey3",name:"IcMenuNext",size:"max"}),r.jsx("img",{src:t})]})})},P1e=({downloadUrl:e,style:t})=>r.jsx(Ij,{videoUrl:e,style:t}),Dg=e=>{const t=Ip("openImageWatermark",e)&&pt(),n=Ip("imageWatermarkText",e);return{openImageWatermark:t,imageWatermarkText:n}},L1e=e=>{var s,a;if(!e)return{openImageWatermark:!1,imageWatermarkText:""};const t=lg.getState()[e];if(t)return{openImageWatermark:(s=t==null?void 0:t.setting)==null?void 0:s.openImageWatermark,imageWatermarkText:(a=t==null?void 0:t.setting)==null?void 0:a.imageWatermarkText};const n=jw.getState()[e];return n?{openImageWatermark:n.openImageWatermark,imageWatermarkText:n.imageWatermarkText}:{openImageWatermark:!1,imageWatermarkText:""}},VU=(e="")=>Jt.image.test(e)?FT:Jt.office.test(e)?jle:Jt.txt.test(e)?Uce:Jt.pdf.test(e)?R1e:Jt.video.test(e)?P1e:Jt.audio.test(e)?mle:Jt.epub.test(e)?hle:gM,eh=(e="")=>Jt.image.test(e)?"image":Jt.office.test(e)?"office":Jt.txt.test(e)?"txt":Jt.pdf.test(e)?"pdf":Jt.video.test(e)?"video":Jt.audio.test(e)?"audio":Jt.epub.test(e)?"epub":null,Nj=({uuid:e,downloadUrl:t,useSimpleImg:n,embed:s,style:a,forceImage:o})=>{var _,x,F,b;const i=ye(e,["data"],["segments","collectionProperties"]),{openImageWatermark:l,imageWatermarkText:c}=Dg(i==null?void 0:i.spaceId),{illegal:d}=mt(e);if(d)return r.jsx(L0,{uuid:e});if(!i||!t)return null;const u=i.type===m.BlockType.PAGE;let f=fe(i.data.segments);u&&ot.propertyId&&i&&(f=(b=(F=((x=(_=i.data.collectionProperties)==null?void 0:_[ot.propertyId])!=null?x:[]).find(E=>E.url===ot.ossName))==null?void 0:F.text)!=null?b:"");const h=i.type===m.BlockType.PDF_ANNOTATION,{extName:p}=rn(f),g=o||h?FT:VU(p);return eh(p)==="image"&&l&&c&&(t=Tm(t,c)),n&&g===FT?r.jsx("img",{style:a,src:t,className:"h-full max-h-full w-full max-w-full object-contain",alt:"图片预览"}):r.jsx(g,{uuid:R_()?void 0:e,recordId:R_()?e:void 0,propertyId:ot.propertyId,downloadUrl:t,embed:s,style:a})},jj=e=>{const{uuid:t,ownerBlockId:n,onCloseOutsideModel:s}=e,a=ft(t,d=>fe(d==null?void 0:d.data.segments)),{extName:o}=rn(a),{url:i}=bc(t),l=y.useMemo(()=>Jo(i,o),[o,i]),c=Ce(d=>ks(t,d),[t]);return y.useEffect(()=>{var u;if(c)return;const d=(u=J.blocks[t])==null?void 0:u.spaceId;d&&ve.editor.getAncestorBlocks({spaceId:d,blockIds:[t]}).then(f=>{re(Tn.update({blocks:f.blocks}))})},[c,t]),!c&&n?null:n?r.jsx(Du,{pageId:c!=null?c:"",isLink:!0,blockId:t,onCloseOutsideModel:s}):r.jsx(Du,{hideOpenRightBtn:!0,pageId:t,onCloseOutsideModel:s,className:"min-h-[300px]",children:r.jsx("div",{className:"overflow-y-auto h-full",children:r.jsx(Mo.Provider,{value:wt.PAGE_LITE_PREVIEW,children:r.jsx(Nj,{uuid:t,downloadUrl:l,useSimpleImg:!0,embed:!0,style:{width:"100%",height:"inherit"}})})})})},yl=({deep:e=0,uuid:t})=>{const{segments:n,isLinkTable:s,blockType:a}=Ce(({blocks:l})=>{var h,p;const c=l[t],d=Yl(c);let u=c==null?void 0:c.data.segments;const f=c==null?void 0:c.type;if(d&&c){const g=l[(p=(h=c.data.ref)==null?void 0:h.uuid)!=null?p:""];u=g==null?void 0:g.data.segments}return{blockType:f,segments:u,isLinkTable:(c==null?void 0:c.type)===m.BlockType.REFERENCE_COLLECTION||(c==null?void 0:c.type)===m.BlockType.REFERENCE_COLLECTION_PAGE}},[t]);if(!fe(n))return r.jsxs(r.Fragment,{children:[qt(a),s&&" 的视图"]});const i=n==null?void 0:n.map((l,c)=>{var d,u,f,h;if(l.type===m.TextType.LINK_PAGE&&l.uuid)return e>Pb?"":r.jsxs("span",{children:["@",r.jsx(yl,{uuid:l.uuid,deep:e+1})]},"".concat(e,"_").concat(c));if([m.TextType.DATETIME,m.TextType.DATE].includes(l.type))return fe([l]);if(l.type===m.TextType.USER&&l.uuid)return"@".concat(Rn((d=l.uuid)!=null?d:"",""));if(l.type===m.TextType.MENTION_BLOCK&&l.uuid){if(e>Pb)return"@块引用";if(l.text)return r.jsxs("span",{children:["@",l.text]},"".concat(e,"_").concat(c));const p=J.blocks[l.uuid];if(!p)return"@块引用";if(p.type===m.BlockType.PDF_ANNOTATION)return r.jsxs("span",{children:["@",(f=(u=p.data.pdfAnnotation)==null?void 0:u.text)!=null?f:""]},"".concat(e,"_").concat(c));const{showPage:g}=wb(p==null?void 0:p.type),_=ks(l.uuid);return _?r.jsxs("span",{children:["@",r.jsx(yl,{uuid:g?_:l.uuid,deep:e+1})]},"".concat(e,"_").concat(c)):"@块引用"}return(h=l.text)==null?void 0:h.replaceAll(/\s+/g," ")});return r.jsxs(r.Fragment,{children:[i,s&&" 的视图"]})},$U=e=>{const{content:t}=e,n=y.useRef(null),s=y.useMemo(()=>typeof t=="string"?t:fe(t),[t]);return y.useEffect(()=>{var a;(a=n.current)==null||a.select()},[]),r.jsxs("div",{className:"w-[524px] px-5 py-5 next-modal",children:[r.jsx("textarea",{ref:n,className:"text-t1 whitespace-pre-wrap h-[112px] w-full bg-transparent outline-none resize-none",defaultValue:s,onChange:a=>{e.onTextChange(a.target.value)},onKeyDown:a=>{Ie("Enter")(a)&&e.onEnter(a)}}),e.tip&&r.jsxs("div",{className:"flex items-center justify-end mt-1",children:[r.jsx(V,{name:"IcShareDanger",size:"small"}),r.jsx("span",{className:"text-t4 text-grey4",children:e.tip})]})]})},Ir=({uuid:e,editIcon:t=!1,isLinkPage:n=!1,interactable:s=!1,className:a,autoIconSize:o=!1,showUnderLine:i=!0,getEditorModal:l=()=>{},blockId:c,format:d,baseOffset:u,aliasText:f,openRight:h})=>{var M,U,z,K,W,Y;const p=lt(),g=ns(),_=ye(e,["data"],["icon","segments"]),x=ye(c,["data","createdBy","status"],["icon","segments","pdfAnnotation","description"]),F=!!(c?x:_),b=X9(),{showPageIcon:w,showPage:E}=y.useMemo(()=>{var G,ee;return(x==null?void 0:x.type)===m.BlockType.PDF_ANNOTATION?((G=x.data.pdfAnnotation)==null?void 0:G.type)===m.PDFAnnotationType.HIGHLIGHT?{showPageIcon:!1,showPage:!1}:{showPageIcon:!0,showPage:!1}:b===m.ShowInLinePageIconType.HIDE?{showPageIcon:!1,showPage:!1}:b===m.ShowInLinePageIconType.SHOW_CUSTOM&&!((ee=_==null?void 0:_.data.icon)!=null&&ee.value)?{showPageIcon:!1,showPage:wb(x==null?void 0:x.type).showPage}:wb(x==null?void 0:x.type)},[(M=x==null?void 0:x.data.pdfAnnotation)==null?void 0:M.type,x==null?void 0:x.type,b,(U=_==null?void 0:_.data.icon)==null?void 0:U.value]),C=y.useRef(null),[k,T]=y.useState(o?void 0:20),{illegal:v,role:I}=mt(c||e),j=ys(),S=y.useRef();let D=!1,A=go(e);c&&(A="".concat(A,"#").concat(c));const P=um();if((x==null?void 0:x.type)===m.BlockType.PDF_ANNOTATION&&(x!=null&&x.parentId)){const G=x.data.pdfAnnotation;if(G){const ee=vp(G);ee&&(D=!0,A="/".concat(P,"/").concat(x==null?void 0:x.parentId,"?annotationPos=").concat(G.pageNumber,",").concat((z=ee.point)==null?void 0:z.x,",").concat((K=ee.point)==null?void 0:K.y,"#").concat(c))}}(_==null?void 0:_.type)===m.BlockType.FILE&&!x&&(D=!0,A="/".concat(P,"/").concat(e));const L=y.useMemo(()=>{var G;return f||(!E&&(x==null?void 0:x.type)===m.BlockType.CODE?fe(x.data.description)||w3:(x==null?void 0:x.type)===m.BlockType.PDF_ANNOTATION?((G=x.data.pdfAnnotation)==null?void 0:G.type)===m.PDFAnnotationType.HIGHLIGHT?x.data.pdfAnnotation.text:"图片标注.png":F?r.jsx(yl,{uuid:E?e:c!=null?c:e}):"无法访问")},[f,x==null?void 0:x.data.pdfAnnotation,x==null?void 0:x.data.description,x==null?void 0:x.type,c,F,E,e]);y.useEffect(()=>{if(!o||!C.current)return;const{fontSize:G}=getComputedStyle(C.current);T(parseFloat(G)*1.25)},[o,k]);let O;((W=_==null?void 0:_.data.icon)==null?void 0:W.type)==="emoji"?O="align-middle":((Y=_==null?void 0:_.data.icon)==null||Y.type,O="align-sub");const $=y.useCallback(G=>{const{defaultIcon:ee,onClick:te}=G;return r.jsxs("div",{ref:C,className:R("inline rounded px-1 py-0.5 space-x-1",v&&"opacity-30",s?"inline-page animate-hover":Mn({cursor:"inherit !important"}),a),contentEditable:!1,onClick:te,children:[w&&r.jsx(Fn,{iconSize:k,className:R("inline-flex !p-0 transition-none",O),trigger:t,hasOverlay:n,blockId:e,offset:[100,0],defaultIcon:ee}),r.jsx("span",{className:R("relative font-medium",{"underline decoration-grey6 underline-offset-4":i,"underline decoration-grey6 underline-offset-4 decoration-dashed":c}),children:v?Ts:L})]})},[c,O,t,k,v,s,n,a,w,i,L,e]);if(I===m.PermissionRole.NONE)return r.jsx(eE,{id:e,inline:!0});if(c){let G=null;return(x==null?void 0:x.type)===m.BlockType.PDF_ANNOTATION?G=r.jsx(V,{name:"MIcPdf",size:"normal"}):G=r.jsx(_s,{uuid:(x==null?void 0:x.type)===m.BlockType.FILE?c:e}),r.jsx(Fe,{lazyLoad:!0,onShow:ee=>{S.current=ee},className:"inline",theme:"none",interactive:!0,popupClass:"next-modal",offset:[0,5],placement:"top",maxWidth:1e4,delay:[500,50],animation:"shift-away",popup:(x==null?void 0:x.status)!==m.BlockStatus.DELETED?(x==null?void 0:x.type)===m.BlockType.PDF_ANNOTATION?r.jsx(jj,{uuid:x==null?void 0:x.parentId,onCloseOutsideModel:()=>{var ee;(ee=S.current)==null||ee.hide()}}):r.jsx(Du,{pageId:e,isLink:n,blockId:c,showMoreBtn:!!c,onCloseOutsideModel:()=>{var ee;(ee=S.current)==null||ee.hide()},mentionBlockMenuProps:{pageId:e,blockId:c,baseOffset:u!=null?u:0,format:d,showPage:E,getEditorModal:l,aliasText:f!=null?f:""}}):r.jsx("div",{className:"next-modal p-2 text-t2 text-center",children:"该引用源已被删除"}),children:$({defaultIcon:G,onClick:ee=>{if(!s){ee.preventDefault();return}if(D){ee.preventDefault(),window.open(_n()+A);return}if((x==null?void 0:x.status)===m.BlockStatus.DELETED&&be.warning("该引用源已被删除"),p===e){g.push(A);return}j(e,{forceOpenInRight:ee.altKey||h,hash:"#".concat(c),forceOpenNewTab:ee.ctrlKey||ee.metaKey})}})})}return r.jsx(Fe,{lazyLoad:!0,className:"inline",theme:"none",onShow:G=>{S.current=G},interactive:!0,popupClass:"next-modal",offset:[0,5],placement:(x==null?void 0:x.status)!==m.BlockStatus.DELETED?"right-end":"top",maxWidth:1e4,delay:[500,50],animation:"shift-away",popup:r.jsx(Du,{showMoreBtn:!!c,pageId:e,isLink:n,blockId:c,onCloseOutsideModel:()=>{var G;(G=S.current)==null||G.hide()}}),children:$({defaultIcon:r.jsx(_s,{uuid:e}),onClick:G=>{if(D){G.preventDefault(),window.open(_n()+A);return}if(!s){G.preventDefault();return}j(e,{forceOpenInRight:G.altKey||h,forceOpenNewTab:G.ctrlKey||G.metaKey})}})})},HU=e=>{var x,F;const{pageId:t,blockId:n,getEditorModal:s,baseOffset:a,format:o,showPage:i,aliasText:l}=e,c=ye(t,["status","data"],["segments","description"]),d=ye(n,["status","data"],["segments","pdfAnnotation"]),u=ie(),f=y.useRef(),h=(d==null?void 0:d.type)===m.BlockType.PDF_ANNOTATION;let p=go(t);const g=p;if(n&&(p="".concat(p,"#").concat(n),h)){const b=d.data.pdfAnnotation,w=vp(b);w&&(p="/".concat(um(),"/").concat(d==null?void 0:d.parentId,"?annotationPos=").concat(b==null?void 0:b.pageNumber,",").concat((x=w.point)==null?void 0:x.x,",").concat((F=w.point)==null?void 0:F.y,"#").concat(n))}const _=[{type:H.BLOCK_TRANSFORM,data:{title:"复制行内块引用链接",icon:"IcLink",onClick:()=>{Xt("".concat(_n()).concat(p))}}},{type:H.BLOCK_TRANSFORM,data:{title:"清除链接",icon:"IcTrash",onClick:()=>{var E,C,k;let b=l;b||((d==null?void 0:d.type)===m.BlockType.PDF_ANNOTATION?b=(k=(C=(E=d.data)==null?void 0:E.pdfAnnotation)==null?void 0:C.text)!=null?k:"":b=fe(i?c==null?void 0:c.data.segments:d==null?void 0:d.data.segments));const w=s();w==null||w.performChange(T=>{T.select(a,a+1).replace(Wn([ti(b,o)]))})}}},{type:H.BLOCK_TRANSFORM,data:{title:"修改引用文字",icon:"IcBtnEdit",onClick:b=>{u.dropdown({placement:"right",popcorn:ra(b.currentTarget),closeBeforeCallBack:()=>{if(f.current===void 0)return;const w=e.getEditorModal();w==null||w.performChange(E=>{E.select(a,a+1).replace(Wn([Is(U0,{pageId:t,blockId:n,text:f.current})]))})},content:w=>{var C,k,T,v,I,j,S;let E=l;if(!E)if(i)E=(C=c==null?void 0:c.data.segments)!=null?C:[];else if((d==null?void 0:d.type)===m.BlockType.CODE)E=(k=c==null?void 0:c.data.description)!=null?k:w3;else if((d==null?void 0:d.type)===m.BlockType.PDF_ANNOTATION){const D=(T=d.data)==null?void 0:T.pdfAnnotation;(D==null?void 0:D.type)===m.PDFAnnotationType.HIGHLIGHT?E=(j=(I=(v=d.data)==null?void 0:v.pdfAnnotation)==null?void 0:I.text)!=null?j:"":E="图片标注.png"}else E=(S=d==null?void 0:d.data.segments)!=null?S:[];return r.jsx($U,{tip:"修改引用文字将仍继续保留引用链接",content:E,onTextChange:D=>{f.current=D},onEnter:D=>{w.onCloseModal(),D.stopPropagation()}})}}),Ik(300).then(()=>{var w;return(w=e.onCloseOutModel)==null?void 0:w.call(e)})}}},{type:H.LINE,data:{},disableClick:!0},{type:H.BLOCK_TRANSFORM,data:{title:"复制页面访问链接",icon:"IcLink",onClick:()=>{Xt("".concat(_n()).concat(g))}}}];return r.jsx(ze,{className:"next-modal py-2 w-52",items:_,keyDownPriority:iw})};sM(HU);const ur=()=>{const e=Oe(),t=B1e(),n=(s,a,o)=>{e(()=>{t(s,a,o)})};return y.useCallback(n,[e,t])},B1e=()=>{const e=Dd(),t=O1e(),n=(s,a,o)=>{s=TK(s)?s:[s];const i=(l,c)=>{let d=[];if(typeof o=="string"){const g=ht(o);d=Array.from({length:c.length},()=>g)}else Array.isArray(o)?Array.isArray(o[0])?d=o:d=Array.from({length:c.length},()=>o):d=Array.from({length:c.length},()=>[]);if(d.length!==c.length)return;const u=pe().blocks[l],f=ks(l);if(!f)return;const h=pe().blocks[f];if(!u||!h)return;const p=c.reduce((g,_,x)=>{var b,w;const F=(w=(b=h.data.schema)==null?void 0:b[_])==null?void 0:w.type;return F===m.CollectionSchemaType.TITLE?(_e(l,{data:{segments:d[x]}}),g):(F&&hm.includes(F)||(g[_]=d[x]),g)},{});if(Object.entries(p).length>0){const g=u.data.collectionProperties,_=t(p),x=Zu(Ot(),{isDatabase:!0});if(_>0&&_*s.length+x.currentCapacity>x.maxCapacity){e({title:"复制块失败",maxCapacity:x.maxCapacity,isNovice:x.isNovice});return}_e(l,{data:{collectionProperties:{...g,...p}}})}};s.forEach(l=>{Array.isArray(a)?i(l,a):i(l,[a])})};return y.useCallback(n,[t,e])},O1e=()=>y.useCallback(e=>{let t=0;return Ek(jo(e)).forEach(n=>{t+=n.size||0}),t},[]),WR=(e,t,n=pe().blocks)=>{var s,a;return(a=(s=n[e])==null?void 0:s.data.collectionProperties)==null?void 0:a[t]},M1e=e=>{const{viewId:t}=Ne(),{disable:n,recordIds:s=[]}=e,a=zN(t),o=a===Tp,i=s.length,[l,c,d]=am(OD),[u,f,h]=am(a),p=y.useCallback(x=>{n||d.current>=i||(x||f(h.current+a),c(d.current+OD))},[n,d,i,c,f,h,a]);Yv(()=>{a!==Tp&&(c(a),f(a))},[a]);const g=mb(()=>{if(n||ot.print)return s;const x=s.slice(0,l),F=xt.$newCreatedRecord;return F&&t===F.viewId&&s.includes(F.id)&&!x.includes(F.id)&&x.push(F.id),x},[n,s,l,t]);return mb(()=>({loadMore:p,showMore:!n&&!o&&l<i&&a<i,recordIds:g,state:l,autoLoad:!!(!n&&(o||l<u)&&l<i)}),[n,o,p,a,g,l,i])},za=vl(M1e),Tc=()=>an(za),ix=e=>{var p,g,_,x,F,b,w;const t=ye(e,["data"],["display","format"]),n=t==null?void 0:t.type,s=t==null?void 0:t.data.display,a=lt(),o=y.useMemo(()=>Xu(e,a),[a,e]),i=n===m.BlockType.EXTERNAL_FILE&&s==="image",l=n===m.BlockType.REFERENCE&&s==="image",c=n===m.BlockType.CHART&&((_=(g=(p=t==null?void 0:t.data.format)==null?void 0:p.chartFormat)==null?void 0:g.ref)==null?void 0:_.uuid),d=l||i||n===m.BlockType.FILE&&s==="image";let u=m.ContentGravity.LEFT;(d||c)&&!o&&(u=m.ContentGravity.CENTER);const f=(F=(x=t==null?void 0:t.data.format)==null?void 0:x.contentGravity)!=null?F:u,h=(w=(b=t==null?void 0:t.data.format)==null?void 0:b.captionGravity)!=null?w:u;return{contentGravity:f,captionGravity:h}},zU=e=>{const{captionGravity:t}=ix(e);return t?{textAlign:GU[t]}:{}},U1e=e=>{const{contentGravity:t}=ix(e);return t?{alignItems:H1e[t]}:{}},qU=(e,t,n)=>{var i,l,c;const{contentGravity:s}=ix(e),a=ye(e,["data"],["format","width"]),o=(c=(l=(i=a==null?void 0:a.data.format)==null?void 0:i.width)!=null?l:a==null?void 0:a.data.width)!=null?c:0;return!n||!s?{}:t<0?{}:o>=t?{}:{alignSelf:$1e[s]}},V1e=e=>{var s;const{contentGravity:t}=ix(e),n=(s=ye(e,[]))==null?void 0:s.type;return!t||n===m.BlockType.FILE?{}:{textAlign:GU[t]}},GU={[m.ContentGravity.LEFT]:"left",[m.ContentGravity.RIGHT]:"right",[m.ContentGravity.CENTER]:"center"},$1e={[m.ContentGravity.LEFT]:"self-start",[m.ContentGravity.RIGHT]:"self-end",[m.ContentGravity.CENTER]:"center"},H1e={[m.ContentGravity.LEFT]:"start",[m.ContentGravity.RIGHT]:"end",[m.ContentGravity.CENTER]:"center"},lx=e=>{const t=Pa(),n=Ce(({blocks:s})=>{const a=s[e];if(!a)return;const o=s[a.parentId];if(!((o==null?void 0:o.type)===m.BlockType.COLLECTION_VIEW||(o==null?void 0:o.type)===m.BlockType.COLLECTION_VIEW_PAGE))return{type:a.type,textColor:a.textColor,backgroundColor:a.backgroundColor}},[e],{wait:500,waitMode:"debounce",ignoreDeep:!0});return y.useMemo(()=>{if(n===void 0)return{};let s=cs(n.backgroundColor);return n.type===m.BlockType.MARK&&(s=dB(n.backgroundColor)),{color:tr(n.textColor),backgroundColor:s}},[n,t])},z1e=()=>{const e=Ks(),t=d9(),n=Ce(s=>e?s.ui.selectedBlocks.findIndex(o=>o.syncId&&e&&o.syncId===e)!==-1?!0:e&&e===t:!1,[e,t],{obsSelectBlocks:[{syncId:e}],enable:!!e});return!(!e||n)},YE=e=>Ce(t=>uv(e,t.blocks),[e],{wait:1e3,waitMode:"debounce",ignoreDeep:!0}),uv=(e,t=J.blocks)=>{var a;const n=t[e];if(!n)return!1;const s=(a=t[n.parentId])==null?void 0:a.type;return s===m.BlockType.COLLECTION_VIEW_PAGE||s===m.BlockType.COLLECTION_VIEW},q1e=e=>Ce(({blocks:t})=>{var a,o;const n=t[e];if(!n)return{isTemplate:!1,collectionId:null,templatePages:[]};const s=t[n.parentId];return{isTemplate:(a=n.isTemplate)!=null?a:!1,collectionId:s==null?void 0:s.uuid,templatePages:((o=s==null?void 0:s.templatePages)!=null?o:[]).filter(i=>{const{role:l}=mn(i);return l!==m.PermissionRole.NONE})}},[e]);let iu;const dRe=e=>{let t=e==null?void 0:e.blockIds;t||(t=iu==null?void 0:iu.blockIds),iu=e,t==null||t.forEach(n=>bs.onlyPatch(N9(n)))},uRe=()=>iu,G1e=e=>Ce(()=>iu==null?void 0:iu.blockIds.includes(e),[e],{onlyCut:!0}),Ho=()=>y5(),th=e=>gc(t=>t?!!t.empty&&t.empty.viewId===e:!1),pa=300;class W1e{constructor(t){q(this,"engine");q(this,"canvasContext",null);q(this,"canvasElement",null);q(this,"dragCanvasElement",null);q(this,"dragCanvasContext",null);q(this,"width",0);q(this,"height",0);q(this,"scale",1);q(this,"getCanvasContext",()=>this.canvasContext);q(this,"getDragCanvasContext",()=>this.dragCanvasContext);q(this,"setCanvas",t=>{this.canvasElement=t,this.canvasContext=t.getContext("2d")});q(this,"setDragCanvas",t=>{var n,s,a;this.dragCanvasElement=t,this.dragCanvasContext=t.getContext("2d"),(n=this.dragCanvasContext)==null||n.scale(this.scale,this.scale),(s=this.dragCanvasElement)==null||s.setAttribute("width",this.width.toString()),(a=this.dragCanvasElement)==null||a.setAttribute("height",this.height.toString()),this.layout()});q(this,"offsetX",pa/2);q(this,"offsetY",pa/2);q(this,"setCanvasSize",(t,n)=>{var s,a,o;this.width=(t+pa)*this.scale,this.height=(n+pa)*this.scale,(s=this.canvasContext)==null||s.scale(this.scale,this.scale),(a=this.canvasElement)==null||a.setAttribute("width",this.width.toString()),(o=this.canvasElement)==null||o.setAttribute("height",this.height.toString()),this.layout()});q(this,"layout",()=>{var t,n,s,a,o,i,l;(t=this.canvasContext)==null||t.save(),(n=this.dragCanvasContext)==null||n.save(),(s=this.canvasContext)==null||s.translate(this.offsetX,this.offsetY),(a=this.dragCanvasContext)==null||a.translate(this.offsetX,this.offsetY),this.clear(),(o=this.canvasContext)==null||o.beginPath(),this.engine.dragLines(),(i=this.canvasContext)==null||i.restore(),(l=this.dragCanvasContext)==null||l.restore()});q(this,"clear",()=>{var t,n;(t=this.canvasContext)==null||t.clearRect(-this.offsetX,-this.offsetY,this.width+this.offsetX,this.height+this.offsetY),(n=this.dragCanvasContext)==null||n.clearRect(-this.offsetX,-this.offsetY,this.width+this.offsetX,this.height+this.offsetY)});q(this,"destroy",()=>{});this.engine=t}}const cx=(e,t)=>e.x<=t.x+t.width&&t.x<=e.x+e.width&&e.y<=t.y+t.height&&t.y<=e.y+e.height;function K1e(e,t,n,s,a,o=5,i=!1,l=!0){const c={tl:o,tr:o,br:o,bl:o};e.beginPath(),e.moveTo(t+c.tl,n),e.lineTo(t+s-c.tr,n),e.quadraticCurveTo(t+s,n,t+s,n+c.tr),e.lineTo(t+s,n+a-c.br),e.quadraticCurveTo(t+s,n+a,t+s-c.br,n+a),e.lineTo(t+c.bl,n+a),e.quadraticCurveTo(t,n+a,t,n+a-c.bl),e.lineTo(t,n+c.tl),e.quadraticCurveTo(t,n,t+c.tl,n),e.closePath(),i&&e.fill(),l&&e.stroke()}const XE=(e,t)=>{const n=e.nodesByLevelMap[t];if(n===void 0)return;const s=e.nodesByLevelOrder[n],a=s==null?void 0:s.indexOf(t);if(!(a===void 0||a===0))return s==null?void 0:s[a-1]},QE=(e,t)=>{const n=e.nodesByLevelMap[t];if(n===void 0)return;const s=e.nodesByLevelOrder[n];if(!s)return;const a=s==null?void 0:s.indexOf(t);if(!(a===void 0||a===(s==null?void 0:s.length)-1))return s==null?void 0:s[a+1]},qa=(e,t,n,s,a,o,i=0,l=0)=>{let c=!1;s&&(c=s(t,n,!!o,i,l));const d=e.getMindNode(t);if(d){if(!c&&d.childrenIds.length>0){const u=i+1;d.childrenIds.forEach((f,h)=>{qa(e,f,t,s,a,!1,u,h)})}a&&a(t,n,!!o,i,l)}};class dx{constructor(t,n){q(this,"engine");q(this,"opt");q(this,"width",0);q(this,"height",0);q(this,"viewportWidth",0);q(this,"viewportHeight",0);q(this,"round",8);q(this,"container");q(this,"scroller");q(this,"fitCenter",()=>{var f;if(this.engine.computeNodesCoordinate(),!this.scroller)return;const t=this.scroller.getBoundingClientRect(),n=this.engine.getState();if(!n.mindNodes[n.rootId])return;const a=this.getMindMapCenterPos();if(!a)return;const[o,i]=a,l=t.left+t.width/2-this.scroller.scrollLeft,c=t.top+t.height/2-this.scroller.scrollTop,d=o-l,u=i-c;(f=this.scroller)==null||f.scrollTo(d,u)});q(this,"updateViewPort",()=>{const t=this.engine.getDraftState(),n=t.mindNodes[t.rootId],s=t.scale*.01;n&&this.container&&(this.viewportWidth=this.width*2+n.regionWidth*s-100,this.viewportHeight=this.height*2+n.regionHeight*s-100,this.container.style.height="".concat(this.viewportHeight,"px"),this.container.style.width="".concat(this.viewportWidth,"px"),this.engine.graph.setCanvasSize(n.regionWidth,n.regionHeight))});q(this,"fixRegionHeight",()=>{const t=this.engine.getDraftState();let n=0;const s=t.mindNodes[t.rootId];if(!s)return;const{regionHeight:a}=s;let o=a;o<0||(qa(this.engine,t.rootId,"",i=>{const l=t.mindNodes[i];if(!l)return!1;l.top<n&&(n=l.top);const c=l.top+l.height;if(c>o&&(o=c),!l.expanded)return!0},i=>{if(n!==0){const l=t.mindNodes[i];if(!l)return!1;l.top+=Math.abs(n)}},!0,0),(n!==0||o!==a)&&(s.regionHeight=s.regionHeight+Math.abs(n)+(o-a),this.updateViewPort()))});q(this,"drawDragNodeRect",()=>{const t=this.engine.graph.getDragCanvasContext();if(!t)return;const{dragInfo:n}=this.engine;if(!n)return;const{ids:s}=n;let a;s.forEach(o=>{if(!this.engine.getMindNode(o))return;t.save(),t.strokeStyle="#18A0FB",t.lineWidth=2,t.lineCap="butt",t.setLineDash([6]);const l=this.getDragNodeRect(o);l&&(a&&cx(a,l)||(a=l,K1e(t,l.x,l.y,l.width,l.height),t.restore()))})});q(this,"drawMindNodes",()=>{const{rootId:t,lineStyle:n}=this.engine.getState(),s=this.computedLines(t),a=this.engine.graph.getCanvasContext();a&&s.forEach(o=>{a.beginPath(),n===m.MindMappingLineStyle.NORMAL?this.drawLine(a,o):this.drawBezierLine(a,o),a.stroke()})});q(this,"updateMindNodeSize",(t,n,s)=>{const o=this.engine.getDraftState().mindNodes[t];o&&(o.width=Math.floor(n),o.height=Math.floor(s))});q(this,"getLineColor",t=>{var i,l,c;const n=this.engine.getState();let s=t,a;for(;s;){const d=n.mindNodes[s];if(!d)break;if(d.themeColor){a=d.themeColor;break}if(n.rootId===s)break;s=d.parentId}let o;return a&&(o=(l=(i=this.engine.option).getLineColor)==null?void 0:l.call(i,a,t)),o||(o=(c=this.engine.option.lineColor)!=null?c:"#000000"),o});q(this,"computeOffset",()=>{const t=this.engine.getDraftState(),n=t.mindNodes[t.rootId];if(!n)return;const s=n.regionWidth*.5,a=n.regionHeight*.5,o=this.viewportWidth*.5,i=this.viewportHeight*.5;t.offsetX=o-s,t.offsetY=i-a});q(this,"drawLines",()=>{this.drawMindNodes(),this.drawDragNodeRect(),this.drawDragLine()});q(this,"drawDragLine",()=>{const t=this.engine.graph.getDragCanvasContext();if(!t)return;const{dragInfo:n}=this.engine;if(!n)return;const{dropInfo:s,lineStyle:a}=this.engine.getState();if(!s)return;const[o,i]=this.engine.option.getCanvasPosition(this.engine,n.left,n.top),l=this.getDragLine(o,i,n.id,s.parentId);l&&(t.beginPath(),a===m.MindMappingLineStyle.NORMAL?this.drawLine(t,l,{strokeStyle:"#18A0FB"}):this.drawBezierLine(t,l,{strokeStyle:"#18A0FB"}),t.stroke())});q(this,"computedLines",t=>{const n=this.engine.getMindNode(t);if(!n)return[];const s=[];return n.left===Wh||n.top===Wh||n.expanded&&n.childrenIds.forEach(a=>{const o=this.engine.getMindNode(a);if(!o||o.left===Wh||o.top===Wh)return;const i=this.getLine(n,o);s.push(i);const l=this.computedLines(a);s.push(...l)}),s});q(this,"setContainer",t=>{this.container=t});q(this,"setScroller",t=>{this.scroller=t});q(this,"setSize",(t,n)=>{this.width=t,this.height=n,this.updateViewPort()});q(this,"getDropPosition",t=>{if(!t)return;const n=this.engine.getState();if(!n.mindNodes[t.id]||!n.mindNodes[n.rootId])return;const o=this.getConnectToWhere(t);if(!(o&&(this.checkDragRecycle(t.ids,o)||!this.engine.option.supportAppendChild(o.parentId))))return o});q(this,"computeNodesCoordinate",()=>{var s,a;const t=this.engine.getDraftState(),n=(a=(s=this.engine.option).getAllElement)==null?void 0:a.call(s);if(n)for(const o of n){const{blockId:i}=o.dataset;if(!i)return;const l=o.getBoundingClientRect(),c=t.mindNodes[i];c&&(c.x=Math.floor(l.x),c.y=Math.floor(l.y))}});q(this,"getParentId",t=>{const n=this.engine.getMindNode(t);return n==null?void 0:n.parentId});q(this,"getMiddleChild",t=>{const n=this.engine.getMindNode(t);if(!n||!n.expanded||n.childrenIds.length===0)return;const s=Math.floor((n.childrenIds.length-1)/2);return n.childrenIds[s]});q(this,"updateNodeRecursive",(t,n,s)=>{const o=this.engine.getDraftState().mindNodes[t];o&&(o[n]+=s,o.childrenIds.forEach(i=>{this.updateNodeRecursive(i,n,s)}))});q(this,"computeFixWidth",()=>{if(!this.engine.alignSiblingNode)return;const t=this.engine.getDraftState(),n={};qa(this.engine,t.rootId,"",void 0,(s,a,o,i)=>{var d,u;const l=(u=(d=n[i])==null?void 0:d.fixWidth)!=null?u:0,c=t.mindNodes[s];c&&c.reallyWidth>l&&(n[i]={id:s,fixWidth:c.reallyWidth})}),t.fixWidthRecord=n});q(this,"computeNodesByLevelOrder",()=>{const t=this.engine.getDraftState(),n={},s={};qa(this.engine,t.rootId,"",void 0,(a,o,i,l)=>{const c=t.mindNodes[a];if(!c||!c.expanded)return;let d=n[l];d||(d=[],n[l]=d),d.push(a),s[a]=l}),this.engine.nodesByLevelMap=s,this.engine.nodesByLevelOrder=n});q(this,"checkDragRecycle",(t,n)=>t.some(s=>{var o,i;let{parentId:a}=n;for(;a;){if(a===s)return!0;a=(i=(o=this.engine.getMindNode(a))==null?void 0:o.parentId)!=null?i:""}return!1}));q(this,"drawBezierLine",(t,n,s)=>{const a=t;a.strokeStyle=n.color,a.lineWidth=2,a.lineCap="butt",s&&Object.assign(a,s),a.moveTo(n.startX,n.startY);const o=n.startX+(n.endX-n.startX)/2,i=n.startY,l=o,c=n.endY;a.bezierCurveTo(o,i,l,c,n.endX,n.endY)});q(this,"scale",1);this.engine=t,this.opt=n}}q(dx,"copyValueToNewProvider",(t,n)=>{t.width=n.width,t.height=n.height,t.viewportWidth=n.viewportWidth,t.viewportHeight=n.viewportHeight,t.round=n.round,t.container=n.container,t.scroller=n.scroller});class fv extends dx{constructor(n,s){super(n,s);q(this,"layout",n=>{try{this.computeNodeRegionValue(n),this.updateViewPort(),this.computedBaseValue(),this.computedTopValue(),this.adjustTopValue(),this.fixRegionHeight(),this.computeOffset(),this.computeFixWidth(),this.computeNodesByLevelOrder()}catch(s){console.warn(s)}});q(this,"computedBaseValue",()=>{const n=this.engine.getDraftState();qa(this.engine,n.rootId,"",(s,a,o)=>{const i=n.mindNodes[s],l=n.mindNodes[a];if(i&&(o?(i.left=0,i.top=-i.height*.5+i.regionHeight*.5):l&&(i.left=l.left+l.width+this.opt.horizontalMargin),!i.expanded))return!0},s=>{const a=n.mindNodes[s];if(!a)return;if(!a.expanded)return a.childrenHeight=0,!0;let o=0;a.childrenHeight=a.childrenIds.reduce((i,l)=>{const c=n.mindNodes[l];return c?(o++,i+c.height):i},0)+(o+1)*this.opt.verticalMargin},!0,0)});q(this,"computedTopValue",()=>{const n=this.engine.getDraftState();qa(this.engine,n.rootId,"",s=>{const a=n.mindNodes[s];if(!a)return!1;if(!a.expanded)return!0;if(a.childrenIds.length===0)return;let i=a.top+a.height/2-a.childrenHeight/2+this.opt.verticalMargin;a.childrenIds.forEach(l=>{const c=n.mindNodes[l];c&&(c.top=i,i+=c.height+this.opt.verticalMargin)})},void 0,!0,0)});q(this,"adjustTopValue",()=>{const n=this.engine.getDraftState();qa(this.engine,n.rootId,"",s=>{const a=n.mindNodes[s];if(!a)return!1;if(!a.expanded)return!0;const o=a.childrenHeight-this.opt.verticalMargin*2-a.height;o>0&&this.updateBrothers(s,o/2)},void 0,!0)});q(this,"updateBrothers",(n,s)=>{const a=this.engine.getDraftState(),o=a.mindNodes[n];if(!o)return;const i=this.engine.getMindNode(o.parentId);if(!i)return;const l=i.childrenIds.findIndex(c=>c===n);i.childrenIds.forEach((c,d)=>{if(c===n||!a.mindNodes[c])return;let f=0;d<l?f=-s:d>l&&(f=s),this.updateNodeRecursive(c,"top",f)}),this.updateBrothers(o.parentId,s)});q(this,"getMindMapCenterPos",()=>{if(!this.scroller)return;const n=this.engine.getRootMindNode(),{scale:s}=this.engine.getState(),a=s*.01,o=this.scroller.getBoundingClientRect();let i=n.x+n.width*a/2;const l=n.y+n.height*a/2;return n.regionWidth*a<o.width&&(i=n.x+n.regionWidth*a/2),[i,l]});q(this,"updateScrollerPos",(n,s)=>{var i;const o=(this.engine.getRootMindNode().regionHeight-s)/2;o!==0&&((i=this.scroller)==null||i.scrollBy(0,o))});q(this,"getConnectToWhere",n=>{const s=this.engine.getState(),a=s.scale*.01;if(!s.mindNodes[n.id])return;const i=s.mindNodes[s.rootId];if(!i)return;const l=n.left,c=n.top;if(l<i.x+i.width*a||l>i.x+(i.regionWidth+pa*.5)*a)return;const d=i.y+(i.height*.5-i.regionHeight*.5)*a;if(c<d-pa*.5*a||c>d+(i.regionHeight+pa*.5)*a)return;let u;const f=Object.entries(s.mindNodes),h=s.mindNodes[n.id];if(!h)return;let p=Number.MAX_VALUE;for(const[g,_]of f){const x={x:_.x,y:_.y+_.height*.5*a-_.regionHeight*.5*a,width:_.width*a,height:_.regionHeight*a};if(cx(x,{x:l,y:c+h.height/2*a,width:1,height:1})){if(_.id===n.id)return{parentId:_.parentId};if(!_.parentId)return;const F=s.mindNodes[_.parentId];return F?this.findPosition(n,F):void 0}if(l>_.x+_.width*a){const F=c+h.height/2*a,b=_.x+_.width*a,w=_.y+_.height/2*a,E=Math.pow(F-w,2)+Math.pow(l-b,2);E<p&&(p=E,u=_)}}if(u&&u.id!==n.id)return!u.expanded||u.childrenIds.length===0?{parentId:u.id,first:!0}:this.findPosition(n,u)});q(this,"findPosition",(n,s)=>{const a=this.engine.getState(),o=n.top;let i;for(let l=0;l<s.childrenIds.length;l++){const c=s.childrenIds[l];if(!c)return;const d=a.mindNodes[c];if(!d)return;if(l===0&&o<d.y)return{parentId:s.id,first:!0};o>d.y&&(i=d.id)}if(i&&i!==n.id)return{parentId:s.id,after:i}});q(this,"computeNodeRegionValue",n=>{const s=this.engine.getDraftState(),a=s.mindNodes[n];if(!a)return;const{height:o,width:i}=a;let l=0,c=0;a.expanded?(a.childrenIds.forEach(d=>{this.computeNodeRegionValue(d);const u=s.mindNodes[d];u&&(l+=u.regionHeight,u.regionWidth>c&&(c=u.regionWidth))}),a.childrenIds.length>0&&(l+=this.opt.verticalMargin*(a.childrenIds.length-1))):l=0,a.regionHeight=Math.max(o,l),a.expanded&&a.childrenIds.length>0?a.regionWidth=i+this.opt.horizontalMargin+c:a.regionWidth=i});q(this,"getDragNodeRect",n=>{const s=this.engine.getMindNode(n!=null?n:"");if(!s)return;const a=s.left,o=s.top+s.height*.5-s.regionHeight*.5;return{x:a,y:o,width:s.regionWidth,height:s.regionHeight}});q(this,"getLine",(n,s)=>{const a=this.getLineColor(s.id);return{startX:(n.left+n.width)/this.scale,startY:(n.top+n.height/2)/this.scale,endX:s.left/this.scale,endY:(s.top+s.height/2)/this.scale,debug:"".concat(n.id," - ").concat(s.id),isRoot:!n.parentId,color:a}});q(this,"getDragLine",(n,s,a,o)=>{const i=this.engine.getMindNode(a);if(!i)return;const l=this.engine.getMindNode(o);if(!l)return;const c=this.getLineColor(a);return{debug:"",startX:(l.left+l.width)/this.scale,startY:(l.top+l.height/2)/this.scale,endX:n/this.scale,endY:s+i.height/2/this.scale,color:c}});q(this,"drawLine",(n,s,a)=>{const o=n;o.lineWidth=2,o.lineCap="butt",o.strokeStyle=s.color,a&&Object.assign(o,a),o.moveTo(s.startX,s.startY);const i=s.startX+(s.endX-s.startX)/2;o.lineTo(i,s.startY);const l=s.endY<s.startY,{round:c}=this;Math.abs(s.endY-s.startY)>c?(o.lineTo(i,l?s.endY+c:s.endY-c),o.arcTo(i,s.endY,i+c,s.endY,c),o.lineTo(s.endX,s.endY)):o.lineTo(s.endX,s.startY)});q(this,"getNextNodeIdByArrowKeyboard",(n,s)=>{switch(n){case"left":return this.getParentId(s);case"right":return this.getMiddleChild(s);case"up":return XE(this.engine,s);case"down":return QE(this.engine,s)}})}}class Y1e extends fv{constructor(n,s){super(n,s);q(this,"computedBaseValue",()=>{const n=this.engine.getDraftState();qa(this.engine,n.rootId,"",(s,a,o)=>{const i=n.mindNodes[s],l=n.mindNodes[a];if(!i||(o?(i.left=i.regionWidth-i.width,i.top=-i.height*.5+i.regionHeight*.5):l&&(i.left=l.left-i.width-this.opt.horizontalMargin),!i.expanded))return!0},s=>{const a=n.mindNodes[s];if(!a)return;if(!a.expanded)return a.childrenHeight=0,!0;let o=0;a.childrenHeight=a.childrenIds.reduce((i,l)=>{const c=n.mindNodes[l];return c?(o++,i+c.height):i},0)+(o+1)*this.opt.verticalMargin},!0,0)});q(this,"updateScrollerPos",(n,s)=>{var l;const a=this.engine.getRootMindNode(),o=(a.regionHeight-s)/2,i=a.regionWidth-n;(o!==0||i!==0)&&((l=this.scroller)==null||l.scrollBy(i,o))});q(this,"getMindMapCenterPos",()=>{if(!this.scroller)return;const n=this.engine.getRootMindNode(),{scale:s}=this.engine.getState(),a=s*.01,o=this.scroller.getBoundingClientRect();let i=n.x+n.width*a/2;const l=n.y+n.height*a/2;return n.regionWidth*a<o.width&&(i=n.x+n.width*a-n.regionWidth*a/2),[i,l]});q(this,"getConnectToWhere",n=>{const s=this.engine.getState(),a=s.scale*.01,o=s.mindNodes[n.id];if(!o)return;const i=s.mindNodes[s.rootId];if(!i)return;const l=n.left,c=n.top,d=s.mindNodes[n.id];if(!d||l+d.width*a<i.x+i.width*a-i.regionWidth*a-pa*.5||l>i.x)return;const u=i.y+(i.height*.5-i.regionHeight*.5)*a;if(c<u-pa*.5*a||c>u+(i.regionHeight+pa*.5)*a)return;let f;const h=Object.entries(s.mindNodes);let p=Number.MAX_VALUE;for(const[g,_]of h){const x={x:_.x+_.width,y:_.y+_.height*.5*a-_.regionHeight*.5*a,width:_.width*a,height:_.regionHeight*a};if(cx(x,{x:l,y:c+o.height/2*a,width:1,height:1})){if(_.id===n.id)return{parentId:_.parentId};if(!_.parentId)return;const b=s.mindNodes[_.parentId];return b?this.findPosition(n,b):void 0}const F=l+d.width*a;if(F<_.x){const b=c+d.height/2*a,w=_.y+_.height/2*a,E=Math.pow(b-w,2)+Math.pow(F-_.x,2);E<p&&(p=E,f=_)}}if(f&&f.id!==n.id)return!f.expanded||f.childrenIds.length===0?{parentId:f.id,first:!0}:this.findPosition(n,f)});q(this,"getDragNodeRect",n=>{const s=this.engine.getMindNode(n!=null?n:"");if(!s)return;const a=s.left+s.width-s.regionWidth,o=s.top+s.height*.5-s.regionHeight*.5;return{x:a,y:o,width:s.regionWidth,height:s.regionHeight}});q(this,"getLine",(n,s)=>{const a=this.getLineColor(s.id);return{startX:n.left/this.scale,startY:(n.top+n.height/2)/this.scale,endX:(s.left+s.width)/this.scale,endY:(s.top+s.height/2)/this.scale,debug:"".concat(n.id," - ").concat(s.id),isRoot:!n.parentId,color:a}});q(this,"getDragLine",(n,s,a,o)=>{const i=this.engine.getMindNode(a);if(!i)return;const l=this.engine.getMindNode(o);if(!l)return;const c=this.getLineColor(a);return{debug:"",startX:l.left/this.scale,startY:(l.top+l.height/2)/this.scale,endX:(n+i.width)/this.scale,endY:s+i.height/2/this.scale,isRoot:!i.parentId,color:c}});q(this,"drawLine",(n,s,a)=>{const o=n;o.strokeStyle=s.color,o.lineWidth=2,o.lineCap="butt",a&&Object.assign(o,a),o.moveTo(s.startX,s.startY);const i=s.startX+(s.endX-s.startX)/2;o.lineTo(i,s.startY);const l=s.endY<s.startY,{round:c}=this;Math.abs(s.endY-s.startY)>c?(o.lineTo(i,l?s.endY+c:s.endY-c),o.arcTo(i,s.endY,i-c,s.endY,c),o.lineTo(s.endX,s.endY)):o.lineTo(s.endX,s.startY)});q(this,"getNextNodeIdByArrowKeyboard",(n,s)=>{switch(n){case"left":return this.getMiddleChild(s);case"right":return this.getParentId(s);case"up":return XE(this.engine,s);case"down":return QE(this.engine,s)}})}}class X1e extends dx{constructor(n,s){super(n,s);q(this,"layout",n=>{try{this.computedDir(),this.computeNodeRegionValue(n),this.updateViewPort(),this.computedBaseValue(),this.computedTopValue(),this.adjustTopValue(),this.fixRegionHeight(),this.computeOffset(),this.computeFixWidth(),this.computeNodesByLevelOrder()}catch(s){console.warn(s)}});q(this,"computedDir",()=>{const n=this.engine.getDraftState();qa(this.engine,n.rootId,"",(s,a,o,i,l)=>{const c=n.mindNodes[s],d=n.mindNodes[a];if(!c)return!0;if(!o&&(d&&(d.dir?c.dir=d.dir:c.dir=l<d.childrenIds.length/2?"right":"left"),!c.expanded))return!0},void 0,!0,0)});q(this,"computedBaseValue",()=>{const n=this.engine.getDraftState();qa(this.engine,n.rootId,"",(s,a,o,i)=>{const l=n.mindNodes[s],c=n.mindNodes[a];if(!l)return!0;if(o)l.left=l.regionWidth-l.rightRegionWidth,l.top=-l.height*.5+l.regionHeight*.5;else if(c){if(c.dir)l.dir=c.dir;else{const u=c.childrenIds.filter(f=>n.mindNodes[f]).indexOf(s);l.dir=u<c.childrenIds.length/2?"right":"left"}l.left=l.dir==="right"?c.left+c.width+this.opt.horizontalMargin:c.left-l.width-this.opt.horizontalMargin}if(!l.expanded)return!0},s=>{const a=n.mindNodes[s];if(!a)return;if(!a.expanded){a.leftChildrenHeight=0,a.rightChildrenHeight=0;return}let o=0,i=0,l=0,c=0;a.childrenIds.forEach(d=>{const u=n.mindNodes[d];u&&(u.dir==="left"?(o++,l+=u.height):u.dir==="right"&&(i++,c+=u.height))}),a.leftChildrenHeight=l+(o+1)*this.opt.verticalMargin,a.rightChildrenHeight=c+(i+1)*this.opt.verticalMargin},!0,0)});q(this,"computedTopValue",()=>{const n=this.engine.getDraftState();qa(this.engine,n.rootId,"",s=>{const a=n.mindNodes[s];if(!a||!a.expanded)return!0;if(a.childrenIds.length===0)return;const o=a.top+a.height/2+this.opt.verticalMargin;let i=o-a.leftChildrenHeight/2,l=o-a.rightChildrenHeight/2;a.childrenIds.forEach(c=>{const d=n.mindNodes[c];d&&(d.dir==="left"?(d.top=i,i+=d.height+this.opt.verticalMargin):d.dir==="right"&&(d.top=l,l+=d.height+this.opt.verticalMargin))})},void 0,!0,0)});q(this,"adjustTopValue",()=>{const n=this.engine.getDraftState();qa(this.engine,n.rootId,"",s=>{const a=n.mindNodes[s];if(!a||!a.expanded)return!0;const o=this.opt.verticalMargin*2+a.height,i=a.leftChildrenHeight-o,l=a.rightChildrenHeight-o;(i>0||l>0)&&this.updateBrothers(s,i/2,l/2)},void 0,!0)});q(this,"updateBrothers",(n,s,a)=>{const o=this.engine.getDraftState(),i=o.mindNodes[n];if(!i)return;const l=this.engine.getMindNode(i.parentId);if(!l)return;const c=l.childrenIds.filter(u=>{const f=o.mindNodes[u];return(f==null?void 0:f.dir)===i.dir}),d=c.indexOf(n);c.forEach((u,f)=>{const h=o.mindNodes[u];if(!h)return;let p=0;const g=h.dir==="left"?s:a;f<d?p=-g:f>d&&(p=g),this.updateNodeRecursive(u,"top",p)}),this.updateBrothers(i.parentId,s,a)});q(this,"updateScrollerPos",(n,s)=>{var l;const a=this.engine.getRootMindNode(),o=(a.regionHeight-s)/2,i=a.regionWidth-n;(o!==0||i!==0)&&((l=this.scroller)==null||l.scrollBy(i,o))});q(this,"getMindMapCenterPos",()=>{if(!this.scroller)return;const n=this.engine.getRootMindNode(),{scale:s}=this.engine.getState(),a=s*.01,o=n.x+n.width*a/2,i=n.y+n.height*a/2;return[o,i]});q(this,"getConnectToWhere",n=>{const s=this.engine.getState(),a=s.scale*.01;if(!s.mindNodes[n.id])return;const i=s.mindNodes[s.rootId];if(!i)return;const l=s.mindNodes[n.id];if(!l)return;const c=n.left,d=n.top;if(c+l.width<i.x+i.width*a-i.leftRegionWidth*a-pa*.5*a||c>i.x+i.rightRegionWidth*a+pa*.5*a)return;const u=i.y+(i.height*.5-i.regionHeight*.5)*a;if(d<u-pa*.5*a||d>u+(i.regionHeight+pa*.5)*a||c>i.x&&c<i.x+i.width*a)return;const f=c>i.x+i.width*a;let h;const p=Object.entries(s.mindNodes);let g=Number.MAX_VALUE;for(const[_,x]of p){if(x.dir==="left"&&f||x.dir==="right"&&!f)continue;let F=0;switch(x.dir){case"left":F=x.leftRegionHeight;break;case"right":F=x.rightRegionHeight;break;default:F=x.regionHeight}const b={x:x.dir==="left"?x.x+x.width:x.x,y:x.y+x.height*.5-F*.5*a,width:x.width*a,height:x.regionHeight*a};if(cx(b,{x:c,y:d+l.height/2*a,width:1,height:1})){if(x.id===n.id)return{parentId:x.parentId};if(!x.parentId)return;const w=s.mindNodes[x.parentId];return w?this.findPosition(n,w,f):void 0}if(f&&c>x.x+x.width*a){const w=d+l.height/2*a,E=x.x+x.width*a,C=x.y+x.height/2*a,k=Math.pow(w-C,2)+Math.pow(c-E,2);k<g&&(g=k,h=x)}else if(!f&&c+l.width*a<x.x){const w=c+l.width*a,E=d+l.height/2*a,C=x.y+x.height/2*a,k=Math.pow(E-C,2)+Math.pow(w-x.x,2);k<g&&(g=k,h=x)}}if(h&&h.id!==n.id)return!h.expanded||h.childrenIds.length===0?{parentId:h.id,first:!0}:this.findPosition(n,h,f)});q(this,"findPosition",(n,s,a)=>{const o=this.engine.getState(),i=n.top;let l;for(let c=0;c<s.childrenIds.length;c++){const d=s.childrenIds[c];if(!d)return;const u=o.mindNodes[d];if(!u)return;if(!(a&&u.dir==="left")){if(c===0&&i<u.y)return{parentId:s.id,first:!0};i>u.y&&(l=u.id)}}if(l&&l!==n.id)return{parentId:s.id,after:l}});q(this,"updateMindNodeSize",(n,s,a)=>{const i=this.engine.getDraftState().mindNodes[n];i&&(i.width=Math.floor(s),i.height=Math.floor(a))});q(this,"computeNodeRegionValue",n=>{const s=this.engine.getDraftState(),a=s.mindNodes[n];if(!a)return;let o=0,i=0,l=0,c=0,d=0,u=0;if(a.expanded&&(a.childrenIds.forEach(f=>{const h=s.mindNodes[f];h&&(this.computeNodeRegionValue(f),h.dir==="left"?(o++,l+=h.regionHeight,h.regionWidth>d&&(d=h.regionWidth)):h.dir==="right"&&(i++,c+=h.regionHeight,h.regionWidth>u&&(u=h.regionWidth)))}),l+=(o-1)*this.opt.verticalMargin,c+=(i-1)*this.opt.verticalMargin),a.regionHeight=Math.max(a.height,Math.max(l,c)),a.leftRegionHeight=Math.max(a.height,l),a.rightRegionHeight=Math.max(a.height,c),a.expanded&&a.childrenIds.length>0){const f=a.parentId?this.opt.horizontalMargin:this.opt.horizontalMargin*2;a.regionWidth=a.width+f+d+u,a.leftRegionWidth=a.width+this.opt.horizontalMargin+d,a.rightRegionWidth=a.width+this.opt.horizontalMargin+u}else a.regionWidth=a.width});q(this,"drawLine",(n,s,a)=>{const o=n;o.strokeStyle=s.color,o.lineWidth=2,o.lineCap="butt",a&&Object.assign(o,a),o.moveTo(s.startX,s.startY);const i=s.startX+(s.endX-s.startX)/2;o.lineTo(i,s.startY);const l=s.endY<s.startY,{round:c}=this;Math.abs(s.endY-s.startY)>c?(o.lineTo(i,l?s.endY+c:s.endY-c),o.arcTo(i,s.endY,i+(s.dir==="left"?-c:c),s.endY,c),o.lineTo(s.endX,s.endY)):o.lineTo(s.endX,s.startY)});q(this,"getLine",(n,s)=>{const a=this.getLineColor(s.id);let o;return s.dir==="left"?o={startX:n.left/this.scale,startY:(n.top+n.height/2)/this.scale,endX:(s.left+s.width)/this.scale,endY:(s.top+s.height/2)/this.scale,debug:"".concat(n.id," - ").concat(s.id),dir:"left",isRoot:!n.parentId,color:a}:o={startX:(n.left+n.width)/this.scale,startY:(n.top+n.height/2)/this.scale,endX:s.left/this.scale,endY:(s.top+s.height/2)/this.scale,debug:"".concat(n.id," - ").concat(s.id),dir:"right",isRoot:!n.parentId,color:a},o});q(this,"getDragLine",(n,s,a,o)=>{const i=this.engine.getMindNode(a);if(!i)return;const l=this.engine.getMindNode(o);if(!l)return;const c=this.getLineColor(a);let d;const u=f=>f==="left"?{debug:"",startX:l.left/this.scale,startY:(l.top+l.height/2)/this.scale,endX:(n+i.width)/this.scale,endY:s+i.height/2/this.scale,dir:"left",color:c}:{debug:"",startX:(l.left+l.width)/this.scale,startY:(l.top+l.height/2)/this.scale,endX:n/this.scale,endY:s+i.height/2/this.scale,dir:"right",color:c};if(l.dir==="right")d=u("right");else if(l.dir==="left")d=u("left");else if(l.dir===void 0){const f=this.engine.getRootMindNode();if(!this.engine.dragInfo)return;const h=this.engine.dragInfo.left;if(!this.engine.getMindNode(this.engine.dragInfo.id))return;h>f.x?d=u("right"):h<f.x&&(d=u("left"))}return d});q(this,"getDragNodeRect",n=>{const s=this.engine.getMindNode(n!=null?n:"");if(!s)return;if(s.dir==="right"||s.dir===void 0){const i=s.left,l=s.top+s.height*.5-s.regionHeight*.5;return{x:i,y:l,width:s.regionWidth,height:s.regionHeight}}const a=s.left+s.width-s.regionWidth,o=s.top+s.height*.5-s.regionHeight*.5;return{x:a,y:o,width:s.regionWidth,height:s.regionHeight}});q(this,"getNextNodeIdByArrowKeyboard",(n,s)=>{const a=this.engine.getMindNode(s);if(a)switch(n){case"left":{if(a.dir===void 0&&a.childrenIds.length>1){const o=Math.round(a.childrenIds.length/2/2);return a.childrenIds[a.childrenIds.length-o]}return a.dir==="right"?this.getParentId(s):this.getMiddleChild(s)}case"right":{if(a.dir===void 0&&a.childrenIds.length>1){const o=Math.floor(a.childrenIds.length/2/2);return a.childrenIds[o]}return a.dir==="right"?this.getMiddleChild(s):this.getParentId(s)}case"up":{const o=XE(this.engine,s);if(!o)return;const i=this.engine.getMindNode(o);if((i==null?void 0:i.dir)===a.dir)return o;break}case"down":{const o=QE(this.engine,s);if(!o)return;const i=this.engine.getMindNode(o);if((i==null?void 0:i.dir)===a.dir)return o;break}}})}}class Q1e extends dx{constructor(n,s){super(n,s);q(this,"layout",n=>{try{this.computeNodeRegionValue(n),this.updateViewPort(),this.computedBaseValue(),this.computedLeftValue(),this.adjustLeftValue(),this.fixRegionHeight(),this.computeOffset(),this.computeFixWidth(),this.computeNodesByLevelOrder()}catch(s){console.warn(s)}});q(this,"fixRegionHeight",()=>{const n=this.engine.getDraftState();let s=0;const a=n.mindNodes[n.rootId];a&&(qa(this.engine,n.rootId,"",o=>{const i=n.mindNodes[o];if(!i)return!1;i.left<s&&(s=i.left)},o=>{if(s!==0){const i=n.mindNodes[o];if(!i)return!1;i.left+=Math.abs(s)}},!0,0),s!==0&&(a.regionWidth=a.regionWidth+Math.abs(s),this.updateViewPort()))});q(this,"computedBaseValue",()=>{const n=this.engine.getDraftState();qa(this.engine,n.rootId,"",(s,a,o)=>{const i=n.mindNodes[s],l=n.mindNodes[a];if(!i||(o?(i.left=0,i.top=0):l&&(i.top=l.top+l.height+this.opt.horizontalMargin),!i.expanded))return!0},s=>{const a=n.mindNodes[s];if(!a)return;if(!a.expanded){a.childrenWidth=0;return}let o=0;a.childrenWidth=a.childrenIds.reduce((i,l)=>{const c=n.mindNodes[l];return c?(o++,i+c.width):i},0)+(o+1)*this.opt.verticalMargin},!0,0)});q(this,"computedLeftValue",()=>{const n=this.engine.getDraftState();qa(this.engine,n.rootId,"",s=>{const a=n.mindNodes[s];if(!a)return!0;if(!a.expanded||a.childrenIds.length===0)return;let i=a.left+a.width*.5-a.childrenWidth*.5+this.opt.verticalMargin;a.childrenIds.forEach(l=>{const c=n.mindNodes[l];c&&(c.left=i,i+=c.width+this.opt.verticalMargin)})},void 0,!0,0)});q(this,"adjustLeftValue",()=>{const n=this.engine.getDraftState();qa(this.engine,n.rootId,"",s=>{const a=n.mindNodes[s];if(!a||!a.expanded)return!0;const o=a.childrenWidth-this.opt.verticalMargin*2-a.width;o>0&&this.updateBrothers(s,o/2)},void 0,!0)});q(this,"updateBrothers",(n,s)=>{const a=this.engine.getDraftState(),o=a.mindNodes[n];if(!o)return;const i=this.engine.getMindNode(o.parentId);if(!i)return;const l=i.childrenIds.indexOf(n);i.childrenIds.forEach((c,d)=>{if(c===n||!a.mindNodes[c])return;let f=0;d<l?f=-s:d>l&&(f=s),this.updateNodeRecursive(c,"left",f)}),this.updateBrothers(o.parentId,s)});q(this,"updateScrollerPos",(n,s)=>{var i;const o=(this.engine.getRootMindNode().regionWidth-n)/2;o!==0&&((i=this.scroller)==null||i.scrollBy(o,0))});q(this,"getMindMapCenterPos",()=>{if(!this.scroller)return;const n=this.engine.getRootMindNode(),{scale:s}=this.engine.getState(),a=s*.01,o=this.scroller.getBoundingClientRect(),i=n.x+n.width*a/2;let l=n.y+n.height*a/2;return n.regionHeight*a<o.height&&(l=n.y+n.regionHeight*a/2),[i,l]});q(this,"getConnectToWhere",n=>{const s=this.engine.getState(),a=s.scale*.01;if(!s.mindNodes[n.id])return;const i=s.mindNodes[s.rootId];if(!i)return;const l=s.mindNodes[n.id];if(!l)return;const c=n.left,d=n.top;if(c+l.width*a<i.x+i.width*.5*a-i.regionWidth*.5*a-pa*.5*a||c+l.width*a>i.x+i.width*.5*a+i.regionWidth*.5*a+pa*.5*a||d<i.y-pa*.5*a||d>i.y+i.regionHeight*a+pa*.5*a)return;let u,f=Number.MAX_VALUE;const h=Object.entries(s.mindNodes);for(const[g,_]of h){const x={x:_.x+_.width*.5*a-_.regionWidth*.5*a,y:_.y+_.height,width:_.regionWidth*a,height:_.height*a};if(cx(x,{x:c,y:d,width:1,height:1}))return _.id===n.id?{parentId:_.parentId}:_.id===n.id?void 0:c>_.x?{parentId:_.parentId,after:_.id}:{parentId:_.parentId,before:_.id};if(d>_.y+_.height*a){const F=c+l.width/2*a,b=_.x+_.width/2*a,w=_.y+_.height*a,E=Math.pow(d-w,2)+Math.pow(F-b,2);E<f&&(f=E,u=_)}}if(!u||u.id===n.id)return;if(!u.expanded||u.childrenIds.length===0)return{parentId:u.id,first:!0};let p;for(const g of u.childrenIds){const _=s.mindNodes[g];if(!_)return;if(c<_.x)return{parentId:u.id,first:!0};c>_.x&&(p=_.id)}if(p&&p!==n.id)return{parentId:u.id,after:p}});q(this,"updateMindNodeSize",(n,s,a)=>{const i=this.engine.getDraftState().mindNodes[n];i&&(i.width=Math.floor(s),i.height=Math.floor(a))});q(this,"computeNodeRegionValue",n=>{const s=this.engine.getDraftState(),a=s.mindNodes[n];if(!a)return;const{height:o,width:i}=a;let l=0,c=0;a.expanded&&(a.childrenIds.forEach(d=>{this.computeNodeRegionValue(d);const u=s.mindNodes[d];u&&(c+=u.regionWidth,u.regionHeight>l&&(l=u.regionHeight))}),a.childrenIds.length>0&&(c+=this.opt.verticalMargin*(a.childrenIds.length-1))),a.regionWidth=Math.max(i,c),a.expanded&&a.childrenIds.length>0?a.regionHeight=o+this.opt.horizontalMargin+l:a.regionHeight=o});q(this,"getLine",(n,s)=>{const a=this.getLineColor(s.id);return{startX:(n.left+n.width/2)/this.scale,startY:(n.top+n.height)/this.scale,endX:(s.left+s.width/2)/this.scale,endY:s.top/this.scale,debug:"".concat(n.id," - ").concat(s.id),isRoot:!n.parentId,color:a}});q(this,"getDragNodeRect",n=>{const s=this.engine.getMindNode(n!=null?n:"");if(!s)return;const a=s.left+s.width/2-s.regionWidth/2,o=s.top;return{x:a,y:o,width:s.regionWidth,height:s.regionHeight}});q(this,"getDragLine",(n,s,a,o)=>{const i=this.engine.getMindNode(a);if(!i)return;const l=this.engine.getMindNode(o);if(!l)return;const c=this.getLineColor(a);return{debug:"",startX:(l.left+l.width*.5)/this.scale,startY:(l.top+l.height)/this.scale,endX:(n+i.width*.5)/this.scale,endY:s/this.scale,color:c}});q(this,"drawBezierLine",(n,s,a)=>{const o=n;o.strokeStyle=s.color,o.lineWidth=2,o.lineCap="butt",a&&Object.assign(o,a);const i=(s.endY-s.startY)/2,l=s.startX,c=s.startY+i,d=s.endX,u=c;o.moveTo(s.startX,s.startY),o.bezierCurveTo(l,c,d,u,s.endX,s.endY)});q(this,"drawLine",(n,s,a)=>{const o=n;o.strokeStyle=s.color,o.lineWidth=2,o.lineCap="butt",a&&Object.assign(o,a),o.moveTo(s.startX,s.startY);const i=s.startY+(s.endY-s.startY)/2;o.lineTo(s.startX,i);const l=s.startX<s.endX,{round:c}=this;if(Math.abs(s.startX-s.endX)>c){const d=l?s.endX-c:s.endX+c;o.lineTo(d,i),o.arcTo(s.endX,i,s.endX,i+c,c),o.lineTo(s.endX,s.endY)}else o.lineTo(s.startX,s.endY)});q(this,"getNextNodeIdByArrowKeyboard",(n,s)=>{switch(n){case"left":return XE(this.engine,s);case"right":return QE(this.engine,s);case"up":return this.getParentId(s);case"down":return this.getMiddleChild(s)}})}}vK();const KR=300,YR=10,o_=8,i_=60,Wh=-9999,J1e=[10,25,50,75,100,120,150,200,300];class WU{constructor(t){q(this,"state",{mindNodes:{},rootId:"",dropInfo:void 0,scale:100,offsetX:0,offsetY:0,hoverId:"",direction:m.MindMappingType.LOGIC_DIAGRAM_LEFT,loading:!0,lineStyle:m.MindMappingLineStyle.NORMAL,fixWidthRecord:{}});q(this,"option");q(this,"dragInfo");q(this,"layoutProvider");q(this,"graph");q(this,"cacheSize",{});q(this,"scaleListeners",[]);q(this,"alignSiblingNode");q(this,"nodesByLevelOrder",{});q(this,"nodesByLevelMap",{});q(this,"setRootId",t=>{this.state.rootId!==t&&this.performChange(n=>{n.rootId=t})});q(this,"performChange",t=>{this.beginDraft(),t(this.getDraftState()),this.endDraft()});q(this,"tmpAddMindNodes");q(this,"tmpUpdateMindNodes");q(this,"addMindNode",(t,n)=>{this.tmpAddMindNodes||(this.tmpAddMindNodes={});const s={id:t,left:Wh,top:Wh,parentId:n!=null?n:"",childrenIds:[],regionHeight:0,regionWidth:0,childrenHeight:0,childrenWidth:0,leftChildrenHeight:0,leftRegionHeight:0,rightRegionHeight:0,rightChildrenHeight:0,leftRegionWidth:0,rightRegionWidth:0,expanded:!0,x:0,y:0,width:n===this.state.rootId?116:100,height:36,reallyWidth:0},a=this.cacheSize[t];a&&(s.width=a.width,s.height=a.height,s.reallyWidth=a.reallyWidth),this.tmpAddMindNodes[t]=s;const o=()=>{this.performChange(l=>{if(this.tmpAddMindNodes){for(const c of Object.keys(this.tmpAddMindNodes)){const d=this.tmpAddMindNodes[c];d&&(l.mindNodes[c]=d)}this.tmpAddMindNodes=void 0,this.layout()}})};this.addMindNodeTimer&&clearTimeout(this.addMindNodeTimer),this.addMindNodeTimer=setTimeout(o,10);const{loading:i}=this.getState();i&&(this.loadingTimer&&clearTimeout(this.loadingTimer),this.loadingTimer=setTimeout(this.setAlreadyDone,200))});q(this,"setAlreadyDone",()=>{this.performChange(t=>{t.loading=!1}),this.loadingTimer=void 0});q(this,"loadingTimer");q(this,"addMindNodeTimer");q(this,"updateMindNodeTimer");q(this,"updateMindNode",t=>{var o,i,l,c,d,u,f,h,p;let n=!1;if(this.tmpAddMindNodes){const g=this.tmpAddMindNodes[t.id];g&&(Object.assign(g,t),n=!0),this.loadingTimer&&(clearTimeout(this.loadingTimer),this.loadingTimer=setTimeout(this.setAlreadyDone,200))}if(!n){const g=()=>{this.performChange(_=>{if(this.tmpUpdateMindNodes){for(const x of Object.keys(this.tmpUpdateMindNodes)){const F=_.mindNodes[x],b=this.tmpUpdateMindNodes[x];F&&b&&Object.assign(F,b)}this.tmpUpdateMindNodes=void 0,this.layout()}})};if(this.tmpUpdateMindNodes||(this.tmpUpdateMindNodes={}),this.tmpUpdateMindNodes){const _=this.tmpUpdateMindNodes[t.id];_?Object.assign(_,t):this.tmpUpdateMindNodes[t.id]=t}this.updateMindNodeTimer&&clearTimeout(this.updateMindNodeTimer),this.updateMindNodeTimer=setTimeout(g,10)}const{loading:s,mindNodes:a}=this.getState();this.cacheSize[t.id]={width:(l=(i=t.width)!=null?i:(o=a[t.id])==null?void 0:o.width)!=null?l:0,height:(u=(d=t.height)!=null?d:(c=a[t.id])==null?void 0:c.width)!=null?u:0,reallyWidth:(p=(h=t.reallyWidth)!=null?h:(f=a[t.id])==null?void 0:f.reallyWidth)!=null?p:0},s&&(this.loadingTimer&&clearTimeout(this.loadingTimer),this.loadingTimer=setTimeout(this.setAlreadyDone,200))});q(this,"setLineColor",t=>{this.option.lineColor=t,this.graph.layout()});q(this,"deleteMindNode",t=>{this.performChange(n=>{delete n.mindNodes[t]})});q(this,"setCanvas",t=>{var n;(n=this.graph)==null||n.setCanvas(t)});q(this,"setDragCanvas",t=>{var n;(n=this.graph)==null||n.setDragCanvas(t)});q(this,"setContainer",t=>{var n;(n=this.layoutProvider)==null||n.setContainer(t)});q(this,"setScroller",t=>{var n;(n=this.layoutProvider)==null||n.setScroller(t)});q(this,"destroy",()=>{});q(this,"setSize",(t,n)=>{this.performChange(()=>{var s;(s=this.layoutProvider)==null||s.setSize(t,n),this.layout()})});q(this,"getSize",()=>{var t,n;return[(t=this.layoutProvider)==null?void 0:t.width,(n=this.layoutProvider)==null?void 0:n.height]});q(this,"updateDragInfo",t=>{this.performChange(n=>{this.computeNodesCoordinate(),this.dragInfo=t,n.dropInfo=this.getDropPosition(t)})});q(this,"setHoverId",t=>{this.state.hoverId!==t&&this.performChange(n=>{n.hoverId=t!=null?t:""})});q(this,"setAlignSiblingNode",t=>{this.alignSiblingNode=t,this.performChange(n=>{n.fixWidthRecord={},this.layout()})});q(this,"clearDropInfo",()=>{this.dragInfo=void 0,this.performChange(t=>{t.dropInfo=void 0})});q(this,"computeNodesCoordinate",()=>{this.performChange(()=>{var t;(t=this.layoutProvider)==null||t.computeNodesCoordinate()})});q(this,"getDropPosition",t=>{var n;return(n=this.layoutProvider)==null?void 0:n.getDropPosition(t)});q(this,"setLineStyle",t=>{this.performChange(n=>{n.lineStyle=t})});q(this,"setDirection",(t,n=!1)=>{var s,a,o,i,l,c,d,u;if(this.state.direction!==t){let f;switch(t){case m.MindMappingType.LOGIC_DIAGRAM_LEFT:f=new fv(this,{verticalMargin:(s=this.option.verticalMargin)!=null?s:o_,horizontalMargin:(a=this.option.horizontalMargin)!=null?a:i_});break;case m.MindMappingType.LOGIC_DIAGRAM_RIGHT:f=new Y1e(this,{verticalMargin:(o=this.option.verticalMargin)!=null?o:o_,horizontalMargin:(i=this.option.horizontalMargin)!=null?i:i_});break;case m.MindMappingType.MIND_MAPPING:f=new X1e(this,{verticalMargin:(l=this.option.verticalMargin)!=null?l:o_,horizontalMargin:(c=this.option.horizontalMargin)!=null?c:i_});break;case m.MindMappingType.ORGANIZATION_STRUCTURE:f=new Q1e(this,{verticalMargin:(d=this.option.verticalMargin)!=null?d:o_,horizontalMargin:(u=this.option.horizontalMargin)!=null?u:i_});break}this.layoutProvider&&f&&dx.copyValueToNewProvider(f,this.layoutProvider),f&&(this.layoutProvider=f,n&&(this.performChange(h=>{h.direction=t,this.layout()}),Promise.resolve().then(()=>{try{this.fitCenter()}catch(h){}})))}});q(this,"getNextNodeIdByArrowKeyboard",(t,n)=>{var s;return(s=this.layoutProvider)==null?void 0:s.getNextNodeIdByArrowKeyboard(t,n)});q(this,"getMindNode",t=>this.draftState?this.draftState.mindNodes[t]:this.state.mindNodes[t]);q(this,"getRootMindNode",()=>{const t=this.draftState?this.draftState.rootId:this.state.rootId,n=this.getMindNode(t);if(!n)throw Error("root not found");return n});q(this,"getDirection",()=>this.draftState?this.draftState.direction:this.state.direction);q(this,"layout",()=>{this.performChange(t=>{var o;let n=0,s=0;const a=t.mindNodes[t.rootId];a&&(n=a.regionWidth,s=a.regionHeight),this._layout(),a&&((o=this.layoutProvider)==null||o.updateScrollerPos(n,s))})});q(this,"updateScale",()=>{this.performChange(t=>{var o,i,l,c;(o=this.layoutProvider)==null||o.updateViewPort(),(i=this.layoutProvider)==null||i.computeOffset();let n=0,s=0;const a=t.mindNodes[t.rootId];a&&(n=a.regionWidth,s=a.regionHeight),(l=this.layoutProvider)==null||l.updateViewPort(),a&&((c=this.layoutProvider)==null||c.updateScrollerPos(n,s))})});q(this,"fitCenter",()=>{var t;(t=this.layoutProvider)==null||t.fitCenter()});q(this,"_layout",()=>{var t;this.computeNodesCoordinate(),(t=this.layoutProvider)==null||t.layout(this.state.rootId)});q(this,"toggleAllMindNode",(t,n)=>{const s=(a,o)=>{const i=a.mindNodes[o];i&&(i.expanded=n,i.childrenIds.forEach(l=>s(a,l)))};this.performChange(a=>{t.forEach(o=>{s(a,o)}),this.layout()})});q(this,"updateMindNodeSize",(t,n,s)=>{var a;this.beginDraft(),(a=this.layoutProvider)==null||a.updateMindNodeSize(t,n,s),this.layout(),this.endDraft()});q(this,"getState",()=>this.state);q(this,"draftState");q(this,"getDraftState",()=>{if(this.draftState)return this.draftState;throw Error("用法不对,请查看getDraftState注释")});q(this,"getLineColor",t=>{var n;return(n=this.layoutProvider)==null?void 0:n.getLineColor(t)});q(this,"callCount",0);q(this,"beginDraft",()=>{if(this.callCount++,this.draftState)return this.draftState;this.draftState=IK(this.state)});q(this,"endDraft",()=>{if(this.callCount--,!this.draftState)throw Error("用法不对,请查看getDraftState注释");let t=[];if(this.callCount===0){if(this.state=NK(this.draftState,n=>{t=n}),this.draftState=void 0,t.length===0||(this.notifyChange(),t.length===1&&t.some(n=>{var s,a;return Z1e.includes((a=(s=n.path[0])==null?void 0:s.toString())!=null?a:"")})))return;this.graph.layout()}});q(this,"findSuitableScale",t=>{const{scale:n}=this.getState();let s=n;for(const a of J1e){if(t){if(a>n)return t?a:s}else if(a>=n)return t?a:s;s=a}return n});q(this,"zoomin",(t=-1)=>{this.performChange(n=>{if(t===-1){const s=this.findSuitableScale(!0);n.scale=s}else n.scale=Math.min(n.scale+t,KR);this.updateScale(),this.notifyScaleListeners(n.scale)})});q(this,"zoomout",(t=-1)=>{this.performChange(n=>{if(t===-1){const s=this.findSuitableScale(!1);n.scale=s}else n.scale=Math.max(Math.round(n.scale)-t,YR);this.updateScale(),this.notifyScaleListeners(n.scale)})});q(this,"zoom",t=>{this.performChange(n=>{n.scale=Math.max(YR,Math.min(Math.round(t),KR)),this.updateScale(),this.notifyScaleListeners(n.scale)})});q(this,"dragLines",()=>{var t;(t=this.layoutProvider)==null||t.drawLines()});q(this,"notifyChange",()=>{Ls.unstable_batchedUpdates(()=>{this.callbacks.forEach(t=>t())})});q(this,"callbacks",new Set);q(this,"subscribe",t=>(this.callbacks.add(t),()=>{this.callbacks.delete(t)}));q(this,"getSnapShot",()=>this.state);q(this,"addScaleListener",t=>(this.scaleListeners.push(t),()=>this.removeScaleListener(t)));q(this,"removeScaleListener",t=>{this.scaleListeners=this.scaleListeners.filter(n=>n!==t)});q(this,"notifyScaleListeners",t=>{this.scaleListeners.forEach(n=>n.onScaleChange(this,t))});var n,s;this.option=t,this.graph=new W1e(this),this.layoutProvider=new fv(this,{verticalMargin:(n=this.option.verticalMargin)!=null?n:o_,horizontalMargin:(s=this.option.horizontalMargin)!=null?s:i_}),this.alignSiblingNode=!1}}const Z1e=["hoverId"],jl=y.createContext(void 0),Fr=()=>{const e=y.useContext(jl);if(!e)throw new Error("mindEngine is undefined");return e},e0e=()=>{const e=Fr();return y.useCallback((t,n)=>{e.addMindNode(t,n)},[e])},t0e=y.version.startsWith("18")?jK.useSyncExternalStoreWithSelector:SK.useSyncExternalStoreWithSelector;function Sl(e,t=Object.is){const n=Fr();return t0e(n.subscribe,n.getSnapShot,n.getSnapShot,y.useCallback(()=>e(n.getSnapShot()),[n,e]),t)}const Sj=()=>Sl(e=>!e.loading),n0e=()=>{const e=Fr();return y.useCallback(t=>{e.deleteMindNode(t)},[e])},$i=()=>Sl(e=>e.rootId);function XR(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function Dj(e,t){if(XR(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(let a=0;a<n.length;a++)if(!Object.prototype.hasOwnProperty.call(t,n[a])||!XR(e[n[a]],t[n[a]]))return!1;return!0}function Ag(e,t){return Sl(n=>{const s=n.mindNodes[e];if(s&&t&&(t==null?void 0:t.length)>0){const a={};return a&&(t==null||t.forEach(o=>{a[o]=s[o]})),a}return s},Dj)}const s0e=()=>Sl(e=>e.mindNodes[e.rootId],Dj),Aj=()=>Sl(e=>e.scale),r0e=()=>Sl(e=>({offsetX:e.offsetX,offsetY:e.offsetY}),Dj),a0e=()=>{const e=Fr();return y.useCallback(()=>{e.fitCenter()},[e])};class o0e{}class JE extends o0e{constructor(n="Draft:"){super();q(this,"unsavedDrafts",new Set);this.prefix=n}hasUnsavedDrafts(){return this.unsavedDrafts.size>0}loadDraft(n){return iQ("".concat(this.prefix).concat(n))}clearUnsavedDrafts(){this.unsavedDrafts.clear()}saveDraft(n,s,a=!1){const o="".concat(this.prefix).concat(n);if(a)return HS(o),fe(s)!==""?this.unsavedDrafts.add(n):this.unsavedDrafts.delete(n),!1;if(s===void 0||fe(s)==="")return HS(o),!0;const i=lQ(o,s,{expiredAt:Date.now()+1e3*60*60*24,safeToPurge:!1});return i||this.unsavedDrafts.add(n),i}}const KU=y.createContext(null),ZE=e=>r.jsx(KU.Provider,{value:e.manager,children:e.children}),i0e=(e,t,n=!1)=>{const s=y.useContext(KU),[a,o]=y.useState(t!=null?t:e==null||n||s==null?void 0:s.loadDraft(e)),i=y.useCallback(l=>{if(l===void 0){o(l),e!=null&&s!=null&&(s==null||s.saveDraft(e,l,n));return}o(c=>{const d=typeof l=="function"?l(c):l;return e!=null&&s!=null&&(s==null||s.saveDraft(e,d,n)),d})},[e,s,n]);return[a,i]};function bl(e,t,n,s){var c,d;const[a,o]=y.useState({width:t==="width"||t==="all"?(c=Ky(e))==null?void 0:c.clientWidth:void 0,height:t==="height"||t==="all"?(d=Ky(e))==null?void 0:d.clientHeight:void 0}),i=y.useRef({}),l=Ky(e);return y.useLayoutEffect(()=>l?Ku.observe(l,f=>{const{clientWidth:h,clientHeight:p,offsetHeight:g,offsetWidth:_}=f.target,x=n?_:h,F=n?g:p;if(!t){(i.current.width!==x||i.current.height!==x)&&o({width:x,height:F}),i.current.width=x,i.current.height=F;return}switch(t){case"width":i.current.width!==x&&o({width:x});break;case"height":i.current.height!==x&&o({height:F});break;case"all":(i.current.width!==x||i.current.height!==F)&&o({width:x,height:F});break}i.current.width=x,i.current.height=F}):void 0,[s,n,t,l]),{...a}}const fRe=(e,t,n)=>Ku.observe(e,a=>{const{clientWidth:o,clientHeight:i,offsetHeight:l,offsetWidth:c}=a.target,d=n?c:o,u=n?l:i;t==null||t({width:d,height:u})});function YU(e,t,n){const s=y.useRef(t),a=y.useRef({}),o=Ky(e);y.useEffect(()=>o?Ku.observe(o,l=>{const{clientWidth:c,clientHeight:d}=l.target;let u=!1;if(!n){(a.current.width!==c||a.current.height!==d)&&(u=!0);return}switch(n){case"width":a.current.width!==c&&(u=!0);break;case"height":a.current.height!==d&&(u=!0);break;case"all":(a.current.width!==c||a.current.height!==d)&&(u=!0);break}a.current.width=c,a.current.height=d,u&&s.current({...a.current})}):void 0,[n,o])}function Ky(e,t){if(!e)return t;let n;return typeof e=="function"?n=e():"current"in e?n=e.current:n=e,n}const Fl=({user:e,className:t,forceNickname:n})=>{var a;const s=_r((a=e==null?void 0:e.uuid)!=null?a:"",e==null?void 0:e.nickname);return r.jsx(ar,{color:(e==null?void 0:e.backgroundColor)||Do.grey,name:n!=null?n:s,icon:{type:"upload",value:e==null?void 0:e.avatar},className:R("text-white1 rounded-full",t),imgClassName:"rounded-full"})},Rj={arrowKey:!0,tabKey:!0,backspaceKey:!0,enterKey:!0,bracketRightKey:!0,minusKey:!0,spaceKey:!0,shortcutKey:!0,slashKey:!0,editorInputKey:!0},l0e={arrowKey:!0},Uu={enterKey:!0,shortcutKey:!0,editorInputKey:!0},c0e={enterKey:!0,shortcutKey:!0,editorInputKey:!1},d0e={arrowKey:!0,enterKey:!0,shortcutKey:!0,backspaceKey:!0,editorInputKey:!0},u0e={editorInputKey:!1,shortcutKey:!0},XU={tabKey:!0,bracketRightKey:!0,minusKey:!0,spaceKey:!0,shortcutKey:!0};let QU;const f0e=e=>{QU=e},m0e=(e,t)=>{const n=e==null?[]:e.slice(0);return n.push({type:m.TextType.USER,uuid:t,enhancer:{},text:""}),n},Pj=e=>{var x,F,b;const t=(x=e.noSaveDraft)!=null?x:!1,n=(F=e.showAvatar)!=null?F:!0,s=lt(),a=ft(s,w=>w==null?void 0:w.type),{roleWithoutPublic:o}=mt(s),i=o!==m.PermissionRole.NONE&&tn(a),l=rr(()=>B8()),c=y.useRef(null),d=bl(c,"height"),[u,f]=i0e(e.draftKey,e.initialText,t);y.useEffect(()=>{if(e.remoteAction==null)return;const w=e.remoteAction.subscribe({next:E=>{switch(E.type){case"focus":{l.requestFocus();break}case"reply":{f(C=>m0e(C,E.payload.to)),setTimeout(()=>{l.performChange(C=>{C.select(l.content.length).collapse("focus")}),l.requestFocus()});break}}}});return()=>w.unsubscribe()},[e.remoteAction,l,f]);const h=Ut(),p=rr(()=>qe()),g=fe(u)==="",_=nd(()=>l.onActiveChange.pipe(sd(()=>l.active)),l.active);return r.jsxs("div",{"data-is-comment":!0,className:"flex items-start text-t2",children:[n&&r.jsx(Fl,{user:h,className:"text-t2 mt-1 w-6 h-6"}),r.jsxs("div",{className:R("relative flex-1 min-w-0 px-1 ml-1",Mn({selectors:{"&:focus-within .biz-btns":{opacity:1}}}),((b=d.height)!=null?b:0)>120&&"pb-2"),children:[r.jsx("div",{ref:c,className:R("max-h-[166px] overflow-y-auto px-1 py-1.5 rounded",Mn({selectors:{"&:hover:not(:focus-within)":{backgroundColor:"rgba(0, 0, 0, 0.03)"}}})),children:r.jsx(QU,{className:R("whitespace-pre-wrap biz-inline-editable",Mn({selectors:{":not(.biz-placeholder-shown)::after":{display:"inline-block",content:'""',width:"100px"}}})),autoFocus:e.autoFocus,autoFocusCaretToEnd:!0,editorModel:l,placeholder:_?"在此发表评论（Enter 发送，Shift+Enter 换行）":"在此发表评论...",uuid:p,toolbar:!0,segments:u,keydownOption:i?Uu:c0e,onChange:f,onKeyDownCapture:w=>{Ie("mod+x")(w)&&w.stopPropagation()},onKeyDown:w=>{var C;let E;Ie("shift+enter")(w)?(E=!0,w.preventDefault(),l.performChange(k=>{k.insert("\n")}),l.scrollCaretIntoViewIfNeeded()):Ie("enter")(w)?(E=!0,fe(u)!==""&&(f(void 0),(C=e.onComment)==null||C.call(e,u))):Ie("mod+v")(w)&&(E=!0,setTimeout(()=>{l.scrollCaretIntoViewIfNeeded()},100)),E&&w.stopPropagation()}})}),r.jsxs("div",{className:"absolute right-1 bottom-2 biz-btns flex opacity-0",children:[i&&r.jsx(Fe,{popup:g?"":"提及日期、页面、或成员",children:r.jsx("button",{onClick:async w=>{w.stopPropagation(),await l.requestFocus(),await es(0),l.inputInsert("@","input")},className:"text-grey3 animate-hover flex",children:r.jsx(V,{size:"normal",name:"IcTitleEmail",className:"w-6 h-6"})})}),r.jsx(Fe,{popup:g?"":"发送评论",children:r.jsx("button",{onClick:()=>{var w;g||(f(void 0),(w=e.onComment)==null||w.call(e,u))},disabled:g,className:R("flex",g?"text-grey4":"text-active_color"),children:r.jsx(V,{size:"normal",name:"IcCommentSend",className:"w-6 h-6"})})})]})]})]})},$f=1e3*60,dp=$f*60,JU=dp*24;function h0e(e,t){const n=t-e;if(n<=$f)return"刚刚";if(n<=dp)return"".concat(Math.floor(n/$f),"分钟前");if(n<=JU)return"".concat(Math.floor(n/dp),"小时前");const s=ue(e);return s.isSame(t,"year")?s.format("M月D日 HH:mm"):s.format("YYYY/M/D HH:mm")}function p0e(e,t,n=200){const s=t-e;return s<=$f?e+$f-t+n:s<=dp?$f-s%$f+n:s<=JU?dp-s%dp+n:null}const Lj=({timestamp:e})=>{const[t,n]=y.useState(0);return y.useEffect(()=>{const s=p0e(e,Date.now());if(s==null)return;const a=setTimeout(()=>{n(o=>o+1)},s);return()=>clearTimeout(a)},[n,t,e]),r.jsx(r.Fragment,{children:h0e(e,Date.now())})},g0e={elementMeta:{tag:"buildin"},initialize(e){e.setInputHook((t,n,s)=>{const a=s3(t.editorKey),o=new CustomEvent("inlinedinput",{bubbles:!0,cancelable:!0,detail:{content:n,type:s}});if(a.dispatchEvent(o),o.defaultPrevented)return!1}),e.overrideTextComponent(t=>({format:s,className:a,...o})=>{Pa();const i=s.backgroundColor!==null?cs(s.backgroundColor):void 0;return r.jsx(t,{...o,format:{...s,bold:!1,color:null,backgroundColor:null,underline:!1},className:R(a,s.bold&&"text-bold",Mn({fontWeight:s.bold?600:void 0,borderBottom:s.underline?"1px solid":void 0,color:s.color!==null?tr(s.color):void 0,background:i,borderRadius:i?"2px":void 0}))})}),e.overrideTextComponent(t=>({content:s,format:a,length:o,baseOffset:i,markers:l=[],className:c})=>{const u=DK({type:"text",content:s,format:a,length:o},i,l);return r.jsx(y.Fragment,{children:u.map(([f,h],p)=>r.jsx(t,{content:f.content,length:f.length,format:f.format,baseOffset:i,className:R(c,h.map(g=>g.data.className))},p))})})}},_0e={elementMeta:{tag:"buildin"},initialize(e){e.setInputHook((t,n,s)=>{const a=s3(t.editorKey),o=new CustomEvent("inlinedinput",{bubbles:!0,cancelable:!0,detail:{content:n,type:s}});if(a.dispatchEvent(o),o.defaultPrevented)return!1}),e.overrideTextComponent(t=>({content:s,length:a,baseOffset:o,className:i})=>r.jsx(t,{content:s,length:a,format:xL,baseOffset:o,className:i}))}},x0e=({children:e,htmlDataProps:t})=>r.jsx("span",{className:"rounded-sm text-[0.8125em] p-1 mx-[2px] code-inline-color code-font-family",...t,children:e});bd(BN);const y0e={elementMeta:BN,initialize(e){e.setElementComponent(this.elementMeta.tag,x0e)}},b0e={elementMeta:BN,initialize(e){e.setElementComponent(this.elementMeta.tag,({children:t,htmlDataProps:n})=>r.jsx("span",{...n,children:t}))}};var To=(e=>(e[e.date=1]="date",e[e.person=2]="person",e[e.page=3]="page",e[e.search=4]="search",e[e.searchPerson=5]="searchPerson",e[e.foldPage=6]="foldPage",e[e.foldUser=7]="foldUser",e))(To||{});const ZU=({left:e,right:t,setFakeFocus:n,blockId:s,symbol:a="@",tip:o="",onCloseModal:i,getEditorModel:l,changeTipWhenComposing:c})=>{const[d,u]=y.useState("");return y.useEffect(()=>{const f=l(s);if(!f)return;const h=f.createCursor(e,"left"),p=f.createCursor(t,"right");if(n){u(ta(Jr(f.content,h.offset,p.offset)));return}f.performChange(F=>{F.select(e,t).replace(Wn([Is(Xi,{tip:o,symbol:a})])).collapse("end")}),a.length>1&&(p.offset=h.offset+1);const g=f.onSelectionChange.subscribe(()=>{if(f.selection){const{focusOffset:F}=f.selection;F<=h.offset&&i()}}),_=f.onComposingChange.subscribe(()=>{if(!c)return;const b=Jr(f.content,h.offset,h.offset+1).items[0];f.isComposing&&b&&b.type==="element"&&b.tag===Xi&&b.props.tip&&f.performChange(w=>{w.shadow().select(e,e+1).replace(Wn([Is(Xi,{tip:"",symbol:a})])).release()})}),x=f.onContentChange.subscribe(()=>{const F=Jr(f.content,h.offset,p.offset),b=ta(F),w=F.items[0];if(w&&w.type==="element"&&w.tag===Xi){const E={tip:o,symbol:a};(b||f.isComposing)&&(E.tip=""),w.props.tip!==E.tip&&f.performChange(C=>{C.shadow().select(h.offset,h.offset+1).replace(Wn([Is(Xi,E)])).release()}),u(b)}});return()=>{const F=Jr(f.content,h.offset,p.offset),b=ta(F),w=F.items[0];w&&w.type==="element"&&w.tag===Xi&&f.performChange(E=>{E.shadow().select(h.offset,p.offset).replace("".concat(a).concat(b)).release()}),h.release(),p.release(),g.unsubscribe(),x.unsubscribe(),_.unsubscribe()}},[s,l,i,e,t,u,a,o,c,n]),d},F0e=3,eV=({onlyDate:e,keyword:t,onChange:n,filterTypes:s})=>{const[a,o]=y.useState(!0),[i,l]=y.useState(!1),c=Ri(),d=Dt(),u=EM(),[f,h]=y.useState([]),p=y.useRef(t),g=b=>{h(s?b.filter(w=>!s.includes(w.data.type)):b),o(!0),l(!1)},_=y.useRef(qn(async()=>{const b=await ve.editor.querySpaceVisitsHistory(d.uuid,0);if(typeof b!="object"||!b.recordMap||!b.results)return;const{blocks:w}=b.recordMap;if(!w)return;re(Tn.update({blocks:w}));const E=T=>{const v=[];let I=w[T];for(;I&&I.spaceId!==I.uuid;)I=w[I.parentId],I&&tn(I.type)&&v.unshift(I);return v},C=[];let k=0;for(const{uuid:T}of b.results){if(k>=F0e)break;if(!T||T===c)continue;const v=J.blocks[T];v&&v.status===m.BlockStatus.NORMAL&&(k++,C.push({type:H.SEARCH,data:{uuid:v.uuid,title:fe(v.data.segments)||qt(v.type),icon:v.data.icon,navs:E(T),type:v.type,backgroundColor:v.backgroundColor,categoryType:3}}))}p.current||g(C)},200)),x=y.useRef(qn(async b=>{const{resultBlocks:w}=await u({spaceId:d.uuid,pageNo:1,perPage:20,search:b}),E=w.map(({block:C,navs:k})=>({type:H.SEARCH,data:{uuid:C.uuid,title:fe(C.data.segments)||qt(C.type),icon:C.data.icon,navs:k,type:C.type,backgroundColor:C.backgroundColor,categoryType:3}}));p.current===b&&g(E)},200));y.useEffect(()=>{e||(l(!0),p.current=t,t?x.current(t):_.current(),o(!0),n==null||n())},[e,t]);const F=y.useMemo(()=>a&&f.length>5?[...f.slice(0,5),{type:H.OPERATION,data:{categoryType:6,title:"查看其他".concat(f.length-5,"个页面")}}]:f,[a,f]);return{setPageFold:o,pageList:F,loading:i}},w0e="CURRENT_DATE",tV="CURRENT_DATETIME",nV="CUSTOM_DATE",mv="InlineDatePickerModal",E0e=()=>{const e=M0();return LM(),y.useCallback(t=>{const{onlyDate:n,keyword:s="",onlyPeoPel:a,fold:o}=t,i=[{type:H.BLOCK_TEXT,data:{title:"日期"}},{type:H.OPERATION,data:{title:ue().format(Et),type:w0e,categoryType:To.date}},{type:H.OPERATION,data:{title:ue().format(On),type:tV,categoryType:To.date}},{type:H.OPERATION,data:{title:"自定义日期",type:nV,categoryType:To.date}}];if(n)return{date:i,hasPeople:!1,users:[]};const l=lc(e,s).map(f=>({type:H.OPERATION,data:{categoryType:To.person,userId:f.uuid,content:r.jsx(si,{userId:f.uuid,className:"text-t2 !mx-0 !px-0"})}})).sort((f,h)=>f.data.userId===yt.uuid||h.data.userId===yt.uuid?-1:1),c=[],d=5;o&&l.length>d&&s?(c.push(...l.slice(0,d)),c.push({type:H.OPERATION,data:{categoryType:To.foldUser,title:"查看其他".concat(l.length-d,"个成员")}})):s||!o?c.push(...l):(c.push(...l.slice(0,3)),l.length>3&&c.push({type:H.OPERATION,data:{categoryType:To.foldUser,title:"查看所有成员"}}));const u=[{type:H.BLOCK_TEXT,isHidden:c.length===0,data:{title:"成员"}},...c];return a?{users:u,hasPeople:c.length>0}:{users:[...i,...u],hasPeople:c.length>0}},[e])},QR=({onCloseModal:e,blockId:t,left:n,right:s,onGlobalCaptureKeydown:a,onlyDate:o,getEditorModel:i})=>{const l=ZU({left:n,right:s,blockId:t,onCloseModal:e,getEditorModel:i}),[c,d]=y.useState(!0),u=Js(),f=E0e(),h=sV(),{pageList:p,setPageFold:g,loading:_}=eV({onlyDate:o,keyword:l,onChange(){d(!0)}}),{users:x,hasPeople:F,date:b}=f({onlyDate:o,onlyPeoPel:!!l,keyword:l,fold:c}),w=y.useMemo(()=>[...b!=null?b:[],...F?x:[],{isHidden:o||!_&&p.length===0,type:H.BLOCK_TEXT,data:{title:"页面",icon:_&&r.jsx($s,{size:"large"})}},...p],[b,F,o,p,_,x]);return!o&&!F&&!p.length&&l?null:r.jsx(ze,{virtualList:!0,autoResetActiveIndex:!1,defaultActiveIndex:1,className:"w-64 py-2 next-modal overflow-y-auto min-h-8",items:w,onItemClick:(E,C,k)=>{const T=i(t);if(!T||!T.selection)return;const{focusOffset:v}=T.selection;if([To.foldPage,To.foldUser].includes(E.data.categoryType)){k.preventDefault(),E.data.categoryType===To.foldPage?(u(Je.CREATE_REF_PAGE,ct.advancedList),g(!1)):d(!1),T.requestFocus();return}e({closeAfterCallBack:()=>{E.data.categoryType===To.person?(T.performChange(I=>{I.shadow().select(n,v).replace(Wn([Is(Gm,{userId:E.data.userId})])).release()}),T.requestFocus()):E.data.categoryType===To.page?(T.performChange(I=>{I.shadow().select(n,v).replace(Wn([Is(ml,{pageId:E.data.uuid})])).release()}),T.requestFocus(),u(Je.GUIDE_FIRST_TIME_LINK_PAGE,ct.advancedList)):(T.performChange(I=>{I.shadow().select(n,v).replace(Wn([Is(Au,{datetime:Date.now(),includeTime:E.data.type===tV})])).release()}),E.data.type===nV&&h(n,s,()=>i(t)),T.requestFocus(),u(Je.CREATE_DATE_MENTION,ct.basicList,{step1:!0}))}})},onGlobalCaptureKeydown:a})},C0e=({getEditorModel:e,cursorLeft:t,cursorRight:n})=>{const s=ln(),[a,o]=y.useState(()=>{const i=e(),c=Jr(i.content,t.offset,t.offset+1).items[0],d=u=>ue(u).hour(12).toDate();return c&&c.type==="element"&&c.tag===Au?{from:new Date(c.props.datetime),includeTime:c.props.includeTime,dateFormat:c.props.dateFormat,timeFormat:c.props.timeFormat,reminder:c.props.reminder}:{from:d(new Date),includeTime:!1}});return r.jsx(J0,{dateInfo:a,uiOption:{hasRemind:!0},onChange:i=>{o(i);const l=e();l&&l.performChange(c=>{c.select(t.offset,t.offset+1).replace(Wn([Is(Au,{datetime:i.from.getTime(),includeTime:!!i.includeTime,dateFormat:i.dateFormat,timeFormat:i.timeFormat,reminder:i.reminder})])).collapse("end")})},onClear:()=>{const i=e();i&&(s(mv),i.performChange(l=>{l.shadow().select(t.offset,n.offset).delete().release()}),i.requestFocus())}})},sV=()=>{const e=ie(),t=ln();return y.useCallback((s,a,o)=>{const i=o();if(!i)return;const{selection:l}=i;if(!l||!l.isCollapsed)return;const c=i.createCursor(s,"left"),d=i.createCursor(a,"left"),u=i.onSelectionChange.subscribe(()=>{if(i.selection){const{focusOffset:f}=i.selection;(f<=c.offset||d.offset<f)&&t(mv)}});e.dropdown({modalId:mv,closeBeforeCallBack:()=>{u.unsubscribe(),c.release(),d.release()},popcorn:{getBoundingClientRect(){return i.getBoundingClientRectOfRange(c.offset,c.offset)}},placement:"bottom-start",offset:[0,15],content(){return r.jsx(C0e,{getEditorModel:o,cursorLeft:c,cursorRight:d})}})},[t,e])},ux=e=>{const t=[];e.overline&&t.push("overline"),e.dashed&&t.push("dashed"),e.lineThrough&&t.push("line-through");const n=e8(e);n.textDecoration!=null&&t.push(n.textDecoration);const s={...n,borderBottom:e.underline?"1px solid":void 0,fontWeight:e.bold?"600":void 0,fontStyle:e.italic?"italic":void 0,color:e.color!=null?tr(e.color):void 0};return t.length>0&&(s.textDecoration=t.join(" ")),e.backgroundColor!=null&&(s.background=cs(e.backgroundColor),s.borderRadius="2px"),s},rV={tag:Au,hasContent:!1,legalize:e=>{var n;const t=ue(e.props.datetime).format((n=e.props.includeTime)!=null&&n?On:Et);return Wn([ti(" ".concat(t," "))])},setFormat:(e,t)=>{e.props.textFormat=Cl(t,e.props.textFormat)}};bd(rV);const k0e=({htmlDataProps:e,datetime:t,includeTime:n,textFormat:s,dateFormat:a,timeFormat:o,reminder:i,baseOffset:l})=>{const c=t,d=n!=null?n:!1,u=a!=null?a:m.DateFormat.YYYY_MM_DD,f=o!=null?o:m.TimeFormat.H_MM,h=i!=null?i:void 0,p=Cl(s),g=ux(p),_=sV(),{readonly:x,interactable:F}=y.useContext(yg),b=d3(c,u,d,f),[w,E]=y.useState(!1);return Nn(),y.useEffect(()=>{const C=KL(c,h);if(!C)return;const k=C-Date.now();if(k>0){E(!1);let T;return k<1*24*60*60*1e3&&(T=setTimeout(()=>{E(!0)},k)),()=>{T&&clearTimeout(T)}}E(!0)},[c,h]),r.jsxs("span",{...e,contentEditable:!1,className:R("flex-inline items-center px-1 h-full py-[3px]",!x&&F&&"cursor-pointer",{"line-through text-red/70":w}),style:g,onClick:x||!F?void 0:C=>{const k=G1(C.target);if(!k)return;const T=k.getAttribute("data-editor");T&&(C.stopPropagation(),_(l,l+1,()=>Xa(T)))},children:[r.jsx("span",{className:R(g.color||"text-grey4",{"text-red":h,"text-red/70":w}),children:"@"}),r.jsx("span",{className:R(g.color||"text-grey3",{"text-red":h,"text-red/70":w}),children:b}),h&&r.jsx(V,{name:"IcMenuAlarm",size:"normal",className:R("text-red ml-[2px]",{"text-red/70":w})})]})},aV={elementMeta:rV,initialize(e){e.setElementComponent(this.elementMeta.tag,k0e)}},oV={tag:xm,hasContent:!1,hasBoundary:!1,legalize:e=>{const t=e.props.text;return Wn([ti("".concat(t))])},setFormat:(e,t)=>{e.props.textFormat=Cl(t,e.props.textFormat)},toString:e=>e.props.text};bd(oV);const T0e=({htmlDataProps:e,textFormat:t,text:n})=>{const s=Cl(t),a=ux(s);return r.jsx("span",{...e,contentEditable:!1,style:a,children:r.jsx(na,{contentEditable:!1,emojiStr:n,disableHover:!0,inline:!0,className:R("inline cursor-default mx-px",{}),style:{top:xre?"-0.1em":void 0}})})},iV={elementMeta:oV,initialize(e){e.setElementComponent(this.elementMeta.tag,T0e)}},Rg=e=>{if(!e)return"";const t=e.split("::");let n=t[t.length-1];return n&&(n=n.slice(0,36)),n!=null?n:""},Ko={activeEditorKey:null,selection:null},lV=(e,t)=>{y.useEffect(()=>{const n=t.onActiveChange.subscribe(()=>{t.active?Ko.activeEditorKey=e:Ko.activeEditorKey===e&&(Ko.activeEditorKey=null)});return()=>{Ko.activeEditorKey===e&&(Ko.selection=t.selection),n.unsubscribe()}},[e,t])},Pg=Symbol("SYNCED_SEGMENTS_REF_SYMBOL"),fx=Symbol("SYNCED_REVISION_REF_SYMBOL"),e2=(e,t,n)=>{const s=e[Pg],a=e[fx];if(s&&!hi(s.current,t)){const{wrapSegments:o,hasNewEmoji:i}=ON(t!=null?t:[]),l=x1(i?o:t);e.performChange(c=>{var d,u;c.load(l),n!==void 0&&c.select((d=n==null?void 0:n.offset)!=null?d:0,(u=n==null?void 0:n.endOffset)!=null?u:0)}),s.current=t,a.current=e.revision}else n!==void 0&&e.performChange(o=>{var i,l;o.select((i=n==null?void 0:n.offset)!=null?i:0,(l=n==null?void 0:n.endOffset)!=null?l:0)})},t2=(e,t,n)=>{if(!e)return;const s=Rg(e);if(Ko.activeEditorKey=e,!pe().blocks[s])return;const o=Date.now();let i=!1;const l=()=>{var h;const c=Xa(e);if(c===void 0){if(i)return;Date.now()-o<=100&&(i=!0,setTimeout(l));return}const d=pe().blocks[s];if(!d)return;const u=c[Pg];if(!u)return;t===-1&&(t=c.content.length);const f=n==="caption"?d.data.caption:(h=d.data)==null?void 0:h.segments;u.current===f?c.performChange(p=>{p.select(t)}):e2(c,f,yL(t,t)),c.requestFocus(),c.scrollCaretIntoViewIfNeeded()};Promise.resolve().then(l)},Nr=()=>{const e=y.useContext(Vo),t=Ks();return y.useCallback((n,s,a,o)=>{var l,c;if(!n)return;let i;o?i=fd(n,(l=o==null?void 0:o.namespace)!=null?l:e,(c=o==null?void 0:o.syncId)!=null?c:t):i=fd(n,e,t),t2(i,s,a)},[e,t])},v0e=()=>{const e=y.useContext(Vo),t=Ks(),n=(s,a,o,i)=>{if(!s)return;let l;i?l=fd(s,i==null?void 0:i.namespace,i==null?void 0:i.syncId):l=fd(s,e,t);let c=a.clientX,d=a.clientY;requestAnimationFrame(async()=>{if(!l)return;const u=Xa(l);if(!u)return;const f=await(async()=>{if(c===0&&d===0)return 0;if(c===1/0&&d===1/0)return u.content.length;await u.scrollCaretIntoViewIfNeeded(),await new Promise(g=>setTimeout(g,0));const h=u.getBoundingClientRectOfRange(0,0),p=u.getBoundingClientRectOfRange(u.content.length,u.content.length);if(!(!h||!p))return c=Es(c,h.left+1,p.right-1),d=Es(d,h.top+1,p.bottom-1),u.hitTest(c,d)})();f!=null&&t2(l,f,o)})};return y.useCallback(n,[e,t])},vc=e=>{const t=y.useRef(null),{text:n,iconProp:s,loading:a,defaultOpenPanel:o,iconElement:i,readonly:l,onClick:c,...d}=e,[u]=y.useState(o);return y.useEffect(()=>{var f;u&&!l&&((f=t.current)==null||f.click())},[u]),pt()?null:r.jsxs("div",{ref:t,onClick:l?void 0:c,...d,className:R("flex items-center w-full h-12.5 py-2.5 pl-3 rounded bg-grey8 cursor-pointer",e.className),children:[i||r.jsx(V,{...s,size:"large",className:R("w-6 h-6 text-grey4",s.className)}),r.jsx("div",{className:R("ml-1.5 text-t2",a?"text-grey3":"text-grey4"),children:n})]})};var hv=(e=>(e.symbols="symbols",e.math="math",e.physical="physical",e.chemistry="chemistry",e))(hv||{}),cV=(e=>(e.math="math",e.func="func",e.arrow="arrow",e.greek="greek",e))(cV||{});const JR=[{icon:"IcMenuSymbol",title:"常用符号",isGroup:!0,type:"symbols",group:[{title:"数学",value:"math"},{title:"函数",value:"func"},{title:"箭头",value:"arrow"},{title:"希腊字母",value:"greek"}]},{icon:"IcMenuMath",title:"数学公式",isGroup:!1,type:"math",group:[]},{icon:"IcMenuPhysics",title:"物理公式",isGroup:!1,type:"physical",group:[]},{icon:"IcMenuChemistry",title:"化学公式",isGroup:!1,type:"chemistry",group:[]}],ZR={symbols:{math:[{symbols:[{cmd:"\\times"},{cmd:"\\div"},{cmd:"\\pm"},{cmd:"\\mp"},{cmd:"\\cdot"},{cmd:"\\star"}]},{symbols:[{cmd:"\\sqrt{ab}"},{cmd:"\\sqrt[n]{ab}"},{cmd:"\\log_{a}{b}"},{cmd:"\\lg{ab}"},{cmd:"a^{b}"},{cmd:"a_{b}"},{cmd:"c_a^b"},{cmd:"\\widetilde{ab}"},{cmd:"\\widehat{ab}"},{cmd:"\\overleftarrow{ab}"},{cmd:"\\overrightarrow{ab}"},{cmd:"\\overbrace{ab}"},{cmd:"\\underbrace{ab}"},{cmd:"\\underline{ab}"},{cmd:"\\overline{ab}"}]},{symbols:[{cmd:"\\neq"},{cmd:"\\leq"},{cmd:"\\geq"},{cmd:"\\sim"},{cmd:"\\approx"},{cmd:"\\cong"},{cmd:"\\equiv"},{cmd:"\\propto"},{cmd:"\\ll"},{cmd:"\\gg"},{cmd:"\\in"},{cmd:"\\subset"},{cmd:"\\subseteq"},{cmd:"\\prec"},{cmd:"\\preceq"},{cmd:"\\simeq"},{cmd:"\\asymp"},{cmd:"\\doteq"},{cmd:"\\succ"},{cmd:"\\succeq"},{cmd:"\\sqsubseteq"},{cmd:"\\sqsupseteq"},{cmd:"\\ni"},{cmd:"\\models"},{cmd:"\\vdash"},{cmd:"\\dashv"},{cmd:"\\perp"},{cmd:"\\mid"},{cmd:"\\parallel"},{cmd:"\\smile"},{cmd:"\\frown"},{cmd:"\\bowtie"},{cmd:"\\unlhd"},{cmd:"\\unrhd"}]},{symbols:[{cmd:"\\hat{a}"},{cmd:"\\check{a}"},{cmd:"\\breve{a}"},{cmd:"\\acute{a}"},{cmd:"\\grave{a}"},{cmd:"\\tilde{a}"},{cmd:"\\bar{a}"},{cmd:"\\vec{a}"},{cmd:"\\dot{a}"},{cmd:"\\ddot{a}"}]}],func:[{symbols:[{cmd:"\\frac{ab}{cd}"},{cmd:"\\frac{\\partial a}{\\partial b}"},{cmd:"\\frac{\\text{d}x}{\\text{d}y}"},{cmd:"\\lim\\limits_{a \\rightarrow b}"},{cmd:"\\int_{a}^{b}"},{cmd:"\\oint_a^b"},{cmd:"\\prod\\limits_a^b"},{cmd:"\\coprod\\limits_a^b"},{cmd:"\\bigcap\\limits_a^b"},{cmd:"\\bigcup\\limits_a^b"},{cmd:"\\bigvee\\limits_a^b"},{cmd:"\\bigwedge\\limits_a^b"},{cmd:"\\bigsqcup\\limits_a^b"},{cmd:"\\sum\\limits_a^b"}]},{symbols:[{cmd:"\\left(\\begin{array}{c}a\\\\ b\\end{array}\\right)"},{cmd:"\\begin{bmatrix}a & b \\\\c & d \\end{bmatrix}"},{cmd:"\\begin{cases}a & x = 0\\\\b & x > 0\\end{cases}"}]},{symbols:[{cmd:"\\arccos"},{cmd:"\\arcsin"},{cmd:"\\arctan"},{cmd:"\\cos"},{cmd:"\\cosh"},{cmd:"\\cot"},{cmd:"\\coth"},{cmd:"\\csc"},{cmd:"\\sec"},{cmd:"\\sin"},{cmd:"\\sinh"},{cmd:"\\tan"},{cmd:"\\tanh"}]},{symbols:[{cmd:"\\exp"},{cmd:"\\log"},{cmd:"\\ln"},{cmd:"\\max"},{cmd:"\\min"},{cmd:"\\sup"},{cmd:"\\inf"}]},{symbols:[{cmd:"\\lim"},{cmd:"\\gcd"},{cmd:"\\hom"},{cmd:"\\ker"},{cmd:"\\det"},{cmd:"\\bmod"}]}],arrow:[{symbols:[{cmd:"()"},{cmd:"[]"},{cmd:"\\{\\}"},{cmd:"\\lfloor"},{cmd:"\\lceil"},{cmd:"\\rfloor"},{cmd:"\\rceil"},{cmd:"\\langle"},{cmd:"\\rangle"},{cmd:"\\backslash"},{cmd:"\\cap"},{cmd:"\\cup"},{cmd:"\\uplus"},{cmd:"\\sqcap"},{cmd:"\\sqcup"},{cmd:"\\vee"},{cmd:"\\wedge"},{cmd:"\\wr"}]},{symbols:[{cmd:"\\leftarrow"},{cmd:"\\Leftarrow"},{cmd:"\\rightarrow"},{cmd:"\\Rightarrow"},{cmd:"\\leftrightarrow"},{cmd:"\\Leftrightarrow"},{cmd:"\\mapsto"},{cmd:"\\leftharpoonup"},{cmd:"\\leftharpoondown"},{cmd:"\\uparrow"},{cmd:"\\downarrow"},{cmd:"\\leftleftarrows"},{cmd:"\\rightrightarrows"},{cmd:"\\leftrightarrows"},{cmd:"\\rightleftarrows"}]}],greek:[{symbols:[{cmd:"\\alpha"},{cmd:"\\beta"},{cmd:"\\gamma"},{cmd:"\\delta"},{cmd:"\\epsilon"},{cmd:"\\zeta"},{cmd:"\\eta"},{cmd:"\\theta"},{cmd:"\\iota"},{cmd:"\\kappa"},{cmd:"\\lambda"},{cmd:"\\mu"},{cmd:"\\nu"},{cmd:"\\xi"},{cmd:"\\pi"},{cmd:"\\rho"},{cmd:"\\sigma"},{cmd:"\\tau"},{cmd:"\\upsilon"},{cmd:"\\phi"},{cmd:"\\chi"},{cmd:"\\psi"},{cmd:"\\omega"}]}]},disciplineFormula:{math:[{title:"傅里叶级数",symbols:[{cmd:"f(x) = {{{a_0}} \\over 2} + \\sum\\limits_{n = 1}^\\infty {({a_n}\\cos {nx} + {b_n}\\sin {nx})}"}]},{title:"泰勒展开式",symbols:[{cmd:"e ^ { x } = 1 + \\frac { x } { 1 ! } + \\frac { x ^ { 2 } } { 2 ! } + \\frac { x ^ { 3 } } { 3 ! } + \\cdots , \\quad - \\infty < x < \\infty"}]},{title:"高斯公式",symbols:[{cmd:"\\iiint _ { \\Omega } \\left( \\frac { \\partial {P} } { \\partial {x} } + \\frac { \\partial {Q} } { \\partial {y} } + \\frac { \\partial {R} }{ \\partial {z} } \\right) \\mathrm { d } V = \\oint _ { \\partial \\Omega } ( P \\cos \\alpha + Q \\cos \\beta + R \\cos \\gamma ) \\mathrm{ d} S"}]},{title:"定积分",symbols:[{cmd:"\\lim\\limits_ { n \\rightarrow + \\infty } \\sum _ { i = 1 } ^ { n } f \\left[ a + \\frac { i } { n } ( b - a ) \\right] \\frac { b - a } { n } = \\int _ { a } ^ { b } f ( x ) dx"}]},{title:"和的展开式",symbols:[{cmd:"( 1 + x ) ^ { n } = 1 + \\frac { n x } { 1 ! } + \\frac { n ( n - 1 ) x ^ { 2 } } { 2 ! } + \\cdots"}]},{title:"三角恒等式1",symbols:[{cmd:"\\sin \\alpha \\pm \\sin \\beta = 2 \\sin \\frac { 1 } { 2 } ( \\alpha \\pm \\beta ) \\cos \\frac { 1 } { 2 } ( \\alpha \\mp \\beta )"}]},{title:"三角恒等式2",symbols:[{cmd:"\\cos \\alpha + \\cos \\beta = 2 \\cos \\frac { 1 } { 2 } ( \\alpha + \\beta ) \\cos \\frac { 1 } { 2 } ( \\alpha - \\beta )"}]},{title:"欧拉公式",symbols:[{cmd:"{e^{ix}} = \\cos {x} + i\\sin {x}"}]},{title:"格林公式",symbols:[{cmd:"\\iint\\limits_D {({{\\partial Q} \\over {\\partial x}} - {{\\partial P} \\over {\\partial y}})dxdy = \\oint\\limits_L {Pdx + Qdy} }"}]},{title:"贝努力方程",symbols:[{cmd:"{{dy} \\over {dx}} + P(x)y = Q(x){y^n}(n \\ne 0,1)"}]},{title:"全微分方程",symbols:[{cmd:"du(x,y) = P(x,y)dx + Q(x,y)dy = 0"}]},{title:"非齐次方程",symbols:[{cmd:"y = (\\int {Q(x){e^{\\int {P(x)dx} }}dx + C){e^{ - \\int {P(x)dx} }}}"}]},{title:"柯西中值定理",symbols:[{cmd:"\\frac{{f(b) - f(a)}}{{F(b) - F(a)}} = \\frac{{f'(\\xi )}}{{F'(\\xi )}}"}]},{title:"拉格朗日中值定理",symbols:[{cmd:"f(b) - f(a) = f'(\\xi )(b - a)"}]},{title:"曲面面积",symbols:[{cmd:"A = \\iint\\limits_D {\\sqrt {1 + {{\\left( {{{\\partial z} \\over {\\partial x}}} \\right)}^2} + {{\\left( {{{\\partial z} \\over {\\partial y}}} \\right)}^2}} dxdy}"}]},{title:"重积分",symbols:[{cmd:"\\iint\\limits_D {f(x,y)dxdy} = \\iint\\limits_{D'} {f(r\\cos \\theta ,r\\sin \\theta )rdrd\\theta}"}]},{title:"导数公式",symbols:[{cmd:"(\\arcsin x)' = \\frac{1}{{\\sqrt {1 - {x^2}} }}"}]},{title:"三角函数积分",symbols:[{cmd:"\\int {tgxdx = - \\ln \\left| {\\cos x} \\right| + C}"}]},{title:"二次曲面",symbols:[{cmd:"\\frac{{{x^2}}}{{{a^2}}} + \\frac{{{y^2}}}{{{b^2}}} - \\frac{{{z^2}}}{{{c^2}}} = 1"}]},{title:"二阶微分",symbols:[{cmd:"{{{d^2}y} \\over {d{x^2}}} + P(x){{dy} \\over {dx}} + Q(x)y = f(x)"}]},{title:"方向导数",symbols:[{cmd:"\\frac{{\\partial f}}{{\\partial l}} = \\frac{{\\partial f}}{{\\partial x}}\\cos \\phi + \\frac{{\\partial f}}{{\\partial y}}\\sin \\phi"}]}],physical:[{title:"牛顿第一运动定律",symbols:[{cmd:"\\sum \\vec{F}_{i}=\\frac{d \\vec{v}}{d t}=0"}]},{title:"牛顿第二运动定律",symbols:[{cmd:"\\vec{F}=m \\vec{a}=m \\frac{d^{2} \\vec{r}}{d t^{2}}"}]},{title:"牛顿第三运动定律",symbols:[{cmd:"\\vec{F}_{12}=-\\vec{F}_{21}"}]},{title:"万有引力势能",symbols:[{cmd:"{E_p} = -\\frac{{GMm}}{r}"}]},{title:"库仑定律",symbols:[{cmd:"\\vec{F}=k \\frac{Q q}{r^{2}} \\hat{r}"}]},{title:"静电场环路定理",symbols:[{cmd:"\\oint_{L} \\vec{E} \\cdot d \\vec{I}=0"}]},{title:"毕奥.萨伐尔定律",symbols:[{cmd:"d \\vec{B}=\\frac{\\mu_{0}}{4 \\pi} \\frac{I d I \\times \\vec{r}}{r^{3}}=\\frac{\\mu_{0}}{4 \\pi} \\frac{I d I \\sin \\theta}{r^{2}}"}]},{title:"安培定理",symbols:[{cmd:"d \\vec{F}= Id \\vec{l} \\times \\vec{B}"}]},{title:"法拉第电磁感应定律",symbols:[{cmd:"E = n{{ \\Delta \\Phi } \\over {\\Delta {t} }}"}]},{title:"高斯定理",symbols:[{cmd:"\\left.\\Phi_{e}=\\oint \\vec{E} \\cdot d \\vec{S}=\\frac{1}{\\varepsilon_{0}}\\right\\rangle q"}]},{title:"电场的环路定理",symbols:[{cmd:"\\oint \\vec{E} \\cdot d \\vec{I}=-\\frac{d \\varphi_{B}}{d t}"}]},{title:"安培环路定理",symbols:[{cmd:"\\oint \\vec{B} \\cdot d \\vec{I}=\\mu_{0} I+\\mu_{0} I_{d}"}]},{title:"焦耳定律",symbols:[{cmd:"Q = I ^ { 2 } R \\mathrm { t }"}]},{title:"万有引力定律",symbols:[{cmd:"F = G{{Mm} \\over {{r^2}}}"}]},{title:"爱因斯坦光电效应方程",symbols:[{cmd:"{E_k} = hv - {W_0}"}]},{title:"德布罗意波波长公式",symbols:[{cmd:"\\lambda = \\frac{{ \\frac{{{c^2}}}{v}}}{{ \\frac{{m{c^2}}}{h}}} = \\frac{h}{{mv}} = \\frac{h}{p}"}]},{title:"海森堡不确定性原理",symbols:[{cmd:"\\Delta {x} \\Delta {p} \\ge \\frac{h}{{4 \\pi }}"}]},{title:"狭义相对论长度",symbols:[{cmd:"l = {l_0} \\sqrt {1 - {{( \\frac{v}{c})}^2}}"}]},{title:"简谐振动",symbols:[{cmd:"{y_0} = A \\cos ( \\omega {t} + { \\varphi _0})"}]},{title:"波形方程",symbols:[{cmd:"y(t) = A \\cos ( \\frac{{2 \\pi {x}}}{ \\lambda } + \\varphi )"}]},{title:"多普勒效应",symbols:[{cmd:"f' = \\left( { \\frac{{v \\pm {v_0}}}{{v \\pm {v_s}}}} \\right)f"}]}],chemistry:[{title:"铝和稀硫酸",symbols:[{cmd:"\\ce{2Al + 3{H_2}S{O_4} = A{l_2}{(S{O_4})_3} + 3{H_2} \\uparrow}"}]},{title:"铝和稀盐酸",symbols:[{cmd:"\\ce{2Al + 6HCl = 2AlC{l_3} + 3{H_2} \\uparrow}"}]},{title:"镁和稀硫酸",symbols:[{cmd:"\\ce{Mg + {H_2}S{O_4} = MgS{O_4} + {H_2} \\uparrow}"}]},{title:"镁和稀盐酸溶液",symbols:[{cmd:"\\ce{Mg + 2HCl = MgC{l_2} + {H_2} \\uparrow}"}]},{title:"铁和硫酸铜溶液",symbols:[{cmd:"\\ce{Fe + CuS{O_4} = FeS{O_4} + Cu}"}]},{title:"铁和稀硫酸",symbols:[{cmd:"\\ce{Fe + {H_2}S{O_4} = FeS{O_4} + {H_2} \\uparrow}"}]},{title:"铁和稀盐酸",symbols:[{cmd:"\\ce{Fe + 2HCl = FeC{l_2} + {H_2} \\uparrow}"}]},{title:"锌和稀硫酸",symbols:[{cmd:"\\ce{Zn + {H_2}S{O_4} = ZnS{O_4} + {H_2} \\uparrow}"}]},{title:"锌和稀盐酸",symbols:[{cmd:"\\ce{Zn + 2HCl = ZnC{l_2} + {H_2} \\uparrow}"}]}]}},I0e=e=>{const{onClick:t}=e,[n,s]=y.useState(JR[0]),[a,o]=y.useState(cV.math),i=u=>{s(u)},l=u=>o(u),c=n.type===hv.symbols,d=n.type===hv.symbols?ZR.symbols[a]:ZR.disciplineFormula[n.type];return r.jsxs("div",{className:"border-t border-grey6 flex",children:[r.jsx("div",{className:"w-36 p-1.5 border-r border-grey6",children:JR.map(u=>r.jsxs("div",{onClick:()=>i(u),className:R("py-2 relative flex animate-hover my-1 text-t2 pl-2 space-x-1",n.type===u.type&&"bg-black_006"),children:[r.jsx(V,{size:"middle",name:u.icon}),r.jsx("span",{children:u.title})]},u.type))}),r.jsxs("div",{className:"w-full h-[192px] overflow-y-auto relative pb-2",children:[n.isGroup&&r.jsx("div",{className:"border-b border-grey6 h-10 flex w-full p-1.5 sticky top-0 z-10 bg-white2 text-t2",children:n.group.map(u=>r.jsx("div",{onClick:()=>l(u.value),className:R("flex items-center flex-1 justify-center animate-hover mx-0.5",a===u.value&&"bg-black_006"),children:u.title},u.value))}),r.jsx("div",{children:d.map((u,f)=>r.jsxs("div",{children:[u.title&&r.jsx("div",{className:"text-t2 text-grey3 py-2 px-4",children:u.title}),r.jsx("div",{className:R("px-3 text-t2",c&&"flex flex-wrap mb-1"),children:u.symbols.map((h,p)=>r.jsx(vB,{onClick:()=>t(h.cmd),text:h.cmd,className:R("animate-hover px-3 overflow-x-auto block",c&&"mt-1 flex items-center min-w-[15px] justify-center")},"".concat(p,"-").concat(u.type)))})]},f))})]},n.type)]})},N0e=e=>{const t=y.useRef(null),[n,s]=y.useState(e.content),[a,o]=y.useState(""),i=y.useRef({left:0,right:0}),l=(u,f)=>{i.current={left:u!=null?u:i.current.left,right:f!=null?f:i.current.right}};y.useEffect(()=>{t.current&&(t.current.setSelectionRange(t.current.value.length,t.current.value.length),l(0,t.current.value.length))},[]),y.useEffect(()=>{const{errorMsg:u}=TB(n);o(u)},[n]);const c=u=>{var p;const f=bee(n,u,i.current.left,i.current.right-i.current.left);s(f),e.onChange(f);const h=i.current.left+u.length;(p=t.current)==null||p.focus(),l(h,h),setTimeout(()=>{var g;(g=t.current)==null||g.setSelectionRange(h,h)},0)},d=r.jsx(De,{disable:!!a,colorType:"active",onClick:()=>e.onSubmit(n),className:R("flex-shrink-0 self-start",a&&"opacity-90"),children:"提交"});return r.jsxs("div",{className:"latex-input-panel flex flex-col width-600 max-h-[450px] next-modal",children:[r.jsxs("div",{className:"flex py-3 px-3.5",children:[r.jsxs("div",{className:"flex w-full flex-col justify-center overflow-y-hidden h-full",children:[r.jsx(oi,{onBlurCapture:u=>{l(u.currentTarget.selectionStart,u.currentTarget.selectionEnd),u.currentTarget.focus(),u.currentTarget.setSelectionRange(i.current.left,i.current.right)},ref:t,autoFocus:!0,autoSelectAll:!0,value:n,shiftEnter:!0,onChange:u=>{s(u.target.value),e.onChange(u.target.value)},placeholder:"使用 LaTeX 语法输入文本，例 E = MC^2",className:"placeholder-grey4 overflow-auto max-h-[200px] pr-1 ",boxClassName:R("w-full",e.singleLine?"":"min-h-[70px]"),fontClassName:"whitespace-pre-wrap ",onKeyDown:u=>{l(u.currentTarget.selectionStart,u.currentTarget.selectionEnd),!Ie("shift+enter")(u)&&(Ie("enter")(u)?(u.preventDefault(),e.onSubmit(n)):(Ie("mod+z")(u)||Ie(["ArrowLeft","shift+ArrowLeft"])(u)||Ie(["ArrowRight","shift+ArrowRight"])(u))&&u.stopPropagation())}}),a&&r.jsx("div",{className:"flex items-center h-9 text-red text-t4",children:a})]}),d]}),r.jsx(I0e,{onClick:c})]})},Bj=e=>{const t=y.useRef(null),n=ie(),[s,a]=y.useState(!1),o=c=>{c.stopPropagation();let d=!1;n.dropdown({popcorn:ra(c.currentTarget),placement:"bottom",offset:e.isInline?[0,8]:[0,0],closeNoAnimate:!0,closeAfterCallBack:()=>{var u;d||(u=e.onCancel)==null||u.call(e)},content:({onCloseModal:u})=>r.jsx(N0e,{singleLine:e.isInline,content:e.content,onChange:f=>{var h;(h=e.onChange)==null||h.call(e,f)},onSubmit:f=>{var h,p;(h=e.onChange)==null||h.call(e,f),(p=e.onSubmit)==null||p.call(e,f),d=!0,u()}})})};y.useEffect(()=>{var c;e.defaultOpenPanel&&((c=t.current)==null||c.click())},[e.defaultOpenPanel]);const i=y.useMemo(()=>e.isInline?r.jsxs("span",{className:"text-t4 text-grey3 bg-grey6 p-1 cursor-pointer rounded inline-flex items-center",children:[r.jsx(V,{name:"IcEquation",size:"small"}),"新公式"]}):r.jsx(vc,{readonly:e.readonly,text:"添加数学公式",className:e.readonly?"cursor-default":"cursor-pointer",iconProp:{name:"IcUploadEquation",size:"normal"}}),[e.isInline,e.readonly]),l=r.jsxs(r.Fragment,{children:[r.jsx(vB,{className:R("w-full leading-[initial]",s&&"hidden",{"overflow-auto":!e.isInline}),inline:e.isInline,text:e.content,onRender:c=>a(!!c)}),s&&r.jsxs("span",{className:R("bg-red/30 w-full text-ellipsis",e.isInline?"bg-red/30":"flex items-center text-t1 overflow-x-auto h-[34px]"),children:["公式解析错误: ",e.content]})]});return e.isInline?r.jsx("span",{ref:t,className:"flex line-default",onMouseDown:c=>{c.stopPropagation()},onClick:e.readonly?void 0:o,children:e.content?l:i}):r.jsxs("div",{ref:t,onClick:e.readonly?void 0:o,className:R("line-default group relative h-full w-full",!e.readonly&&"cursor-pointer"),children:[e.content?r.jsx("div",{className:"overflow-auto",children:l}):i,r.jsx(Fe,{className:"disable-select flex items-center absolute top-0 right-0 z-10 cursor-pointer bg-black/75 opacity-0 group-hover:opacity-100 text-white1 transition-opacity text-t4 rounded-sm animate-click",popup:"复制公式",onClick:c=>{c.stopPropagation(),Xt(e.content,{message:"已复制公式"})},children:r.jsx(V,{name:"IcCopy",size:"middle"})})]})},Oj={tag:Jl,hasContent:!1,legalize:e=>{const t=e.props.text;return Wn([ti("".concat(t))])},setFormat:(e,t)=>{e.props.textFormat=Cl(t,e.props.textFormat)},toString:e=>e.props.text};bd(Oj);const dV=e=>{const{htmlDataProps:t,textFormat:n,open:s,text:a="",baseOffset:o,noStyle:i}=e,l=Nr(),c=y.useRef(null),[d,u]=y.useState(a),f=Cl(n),h=ux(f),{readonly:p,interactable:g}=y.useContext(yg);y.useEffect(()=>u(a),[a]);const _=()=>{const F=G1(c.current);if(!F)return;const b=F.getAttribute("data-editor");if(b)return Xa(b)},x=F=>{const b=_();if(!b)return;const{selection:w}=b;if(!w)return;const E=b.createCursor(o,"left"),C=b.createCursor(o+1,"left"),k=()=>{E.release(),C.release()};id(F)?(b.performChange(T=>{T.select(E.offset,C.offset).replace(Wn([Is(Jl,{text:F,textFormat:n})]))}),l(b.editorKey,C.offset)):b.performChange(T=>{T.shadow().select(E.offset,C.offset).delete().release(),b.requestFocus()}),k()};return r.jsx("span",{className:R("max-w-full inline-block py-0.5",(p||!g)&&"pointer-events-none"),...t,style:i?{}:h,contentEditable:!1,ref:c,children:r.jsx(Bj,{isInline:!0,defaultOpenPanel:!!s,content:d,onChange:F=>{u(F)},onSubmit:x,onCancel:()=>{if(u(a),!id(a))x("");else{const F=_();F&&l(F.editorKey,o+1)}}})})},uV={elementMeta:Oj,initialize(e){e.setElementComponent(this.elementMeta.tag,dV)}},j0e={elementMeta:Oj,initialize(e){e.setElementComponent(this.elementMeta.tag,t=>r.jsx(dV,{...t,noStyle:!0}))}},S0e=({inLink:e,link:t,onLinkChange:n,onSetLink:s,onCloseModal:a,isInternalLink:o,onClearLink:i})=>{const[l,c]=y.useState(o);return r.jsx(r.Fragment,{children:e&&!o&&!l?r.jsx(r.Fragment,{children:r.jsxs("div",{className:"flex items-center w-full justify-between space-x-1",children:[r.jsxs("div",{className:"flex items-center space-x-1 min-w-[140px]",children:[r.jsx(V,{name:"IcGlobeShare",size:"middle"}),r.jsx("span",{className:"text-ellipsis",children:t})]}),r.jsxs("div",{className:"shrink-0 flex items-center space-x-1",children:[r.jsx(Cs,{className:"p-1 animate-hover",popup:"编辑链接",onClick:()=>{c(!0)},children:r.jsx(V,{name:"IcBtnEdit",size:"small"})}),r.jsx(Cs,{className:"p-1 animate-hover",popup:"复制链接",onClick:()=>{Xt(t,{message:"已复制链接"})},children:r.jsx(V,{name:"IcDuplicate",size:"small"})}),r.jsx(Cs,{className:"p-1 animate-hover",popup:"清除链接",onClick:()=>{i==null||i(),a()},children:r.jsx(V,{name:"IcTrash",size:"small"})})]})]})}):r.jsxs("div",{className:"w-full flex items-center justify-between",children:[r.jsx(Ct,{autoFocus:!0,placeholder:"输入网页链接",value:o?"":t,className:"w-full mx-2.5 my-2.5 h-8",onEnter:()=>{s==null||s(o?"":t),a()},onChange:d=>{n==null||n(d)}}),r.jsx(De,{colorType:"active",size:"large",onClick:()=>{s==null||s(o?"":t),a()},children:"确定"})]})})},fV=({isInternalLink:e=!1,...t})=>r.jsx("div",{className:"next-modal w-[360px] p-1 flex items-center text-t2 text-grey3",children:r.jsx(S0e,{...t,isInternalLink:e})}),PC=new Ai(localStorage,"linkInfo",50),Vu=async(e,t=!1)=>{if(t){const s=await g3(e);if(s.link&&(e=s.link,s.isDone))return s}if(e.includes(" ")){const[s]=e.split(" ");s&&(e=s)}const n=PC.get(e);if(n!=null&&n.title)return n;vQ(e)&&(e=encodeURI(e));try{const s=await ve.editor.linkInfo.raw({url:e,headers:["X-Frame-Options"]});if(s.code===200)return s.data.link=Y1(s.data.link),s.data.cover&&s.data.icon?PC.put(e,s.data,Date.now()+MY):PC.put(e,s.data,Date.now()+OY),s.data}catch(s){}},Rp=e=>{if(om(e)||/^\w+:?\/\//.test(e))return e;try{let n=new URL("".concat(gs.check?"https://":location.protocol).concat(e)).toString();return e.endsWith("/")||(n=n.replace(/\/$/g,e.includes("/")?"/":"")),n}catch(t){return e}},mV=e=>!!/mp\.weixin\.qq\.com/.test(e),Mj=(e,t)=>{const n=Nn(),{model:s,setFakeFocus:a}=t||{},o=y.useRef(""),i=ie();return y.useCallback(l=>{var p;const c=s||n(e);if(!c)return;const d=c.active?c.selection:null;if(!d)return;const u=Ah(c.content,d.offset,d.endOffset,(g,_)=>{if(g.type==="element"&&g.tag===Ei){if(d.isCollapsed)return!0;const x=_+Rh(g);return d.endOffset>_&&d.offset<x}return!1}),f=u.length>0?(p=bL(c.content,u))==null?void 0:p.props.url:null;o.current=f!=null?f:"";const h=({onCloseModal:g})=>{const[_,x]=y.useState(f!=null?f:""),F=b=>{x(b),o.current=b};return y.useEffect(()=>{const b=w=>{Ie("esc")(w)&&(o.current="")};return document.addEventListener("keydown",b,{capture:!0}),a==null||a(!0),()=>{a==null||a(!1),document.removeEventListener("keydown",b,{capture:!0})}},[]),r.jsx(fV,{inLink:l===void 0?f!==null:!1,link:_,onLinkChange:F,onClearLink:()=>{F(""),c.performChange(b=>{const w=Ah(c.content,d.offset,d.endOffset,(E,C)=>{if(E.type==="element"&&E.tag===Ei){if(d.isCollapsed)return!0;const k=C+Rh(E);return d.endOffset>C&&d.offset<k}return!1});b.select(d.offset,d.endOffset),w.length>0&&b.unwrap(Ei,w)})},onCloseModal:g})};i.dropdown({popcorn:{getBoundingClientRect:()=>{const g=c.getBoundingClientRectOfRange(d.offset,d.endOffset);return g!=null?g:new DOMRect(-9999,-9999,0,0)}},closeAfterCallBack:()=>{c.requestFocus()},closeBeforeCallBack:()=>{const g=o.current,_=Rp(g);_!==""&&c.performChange(x=>{x.select(d.offset,d.endOffset),x.selection!==null&&(x.selection.isCollapsed?x.insert(Wn([{type:"element",tag:Ei,props:{url:_},content:Wn([ti(_,x.format)])}])):x.wrap(Ei,{url:_}))})},placement:"bottom",offset:[4,4],content:h})},[s,n,i,a,e])},D0e={getRect:null,disableLink:!1,disableEquation:!1,inLink:null,inCode:!1,inEquation:!1,disableAI:!1},n2=e=>{const t=Ks(),[n,s]=y.useState(D0e),a=Nn(),o=y.useRef(null),i=gB(o,()=>new QF(!1)),l=a(e),c=y.useRef(null);y.useEffect(()=>{if(!l)return;const u=()=>{try{if(l.readonly){const x=FL();return x==null||x[0]!==l.editorKey?null:l.selection}return l.active||i.value?l.selection:null}catch(x){return null}},f=TS(l.onContentChange,l.onActiveChange,i.pipe(vS(1)),l.onSelectionChange).pipe(AK(100),RK(()=>l.isContentRendered?PK(0):l.onContentRendered.pipe(Gv())),ZP(()=>!!s3(l.editorKey)),sd(u)),h=x=>{var T;if(x===null||x.isCollapsed){const{$toolbarInfo:v}=xt;return t&&v&&v.showing&&v.syncId===t&&v.uuid===e&&st({$toolbarInfo:{syncId:t,showing:!1,uuid:e}}),{getRect:null,disableLink:!1,inLink:null,inCode:!1,inEquation:!1,disableEquation:!1,disableAI:!1}}const F=Ah(l.content,x.offset,x.endOffset,(v,I)=>{if(v.type==="element"&&v.tag===Ei){if(x.isCollapsed)return!0;const j=I+Rh(v);return x.endOffset>I&&x.offset<j}return!1}),b=Ah(l.content,x.offset,x.endOffset,(v,I)=>{if(v.type==="element"&&v.tag===ml){if(x.isCollapsed)return!0;const j=I+Rh(v);return x.endOffset>I&&x.offset<j}return!1}),w=v=>!!(v.type==="element"&&[ml,U0,Au,Gm].includes(v.tag)),E=Ah(l.content,x.offset,x.endOffset,(v,I)=>{if(w(v)){if(x.isCollapsed)return!0;const j=I+Rh(v);return x.endOffset>I&&x.offset<j}return!1}).length>0,C=r3(l.content,x.offset,x.endOffset,v=>v.type==="element"&&v.tag===fa),k=Ah(l.content,x.offset+1,x.endOffset,(v,I)=>{if(v.type==="element"&&v.tag===Jl){const j=I+Rh(v);return x.endOffset>I&&x.offset<j}return!1});return{getRect:()=>{var v;return(v=l.getBoundingClientRectOfRange(x.offset,x.endOffset))!=null?v:new DOMRect(-9999,-9999,0,0)},disableLink:E||k.length>0,inLink:F.length>0?(T=bL(l.content,F))==null?void 0:T.props.url:null,inCode:C.length>0,inEquation:k.length>0,disableEquation:E,disableAI:b.length>0}};let p=null;const g=f.subscribe(()=>{const x=h(u());s(F=>In(F,x)?F:x),p===null&&x.getRect&&t&&st({$toolbarInfo:{syncId:t,showing:!0,uuid:e}}),p=x.getRect});return u()===null&&(s(h(null)),p=null),()=>{g.unsubscribe(),i.next(!1)}},[l,i,s,t,e]),y.useEffect(()=>{if(!l)return;const u=TS(l.onActiveChange,i.pipe(vS(1))).subscribe(()=>{var h,p,g,_;c.current===null&&(c.current=l.mark(0,0,{className:Mn({backgroundColor:"var(--selection)"})}));const f=c.current;!l.active&&i.value?f.updateRange((p=(h=l.selection)==null?void 0:h.offset)!=null?p:0,(_=(g=l.selection)==null?void 0:g.endOffset)!=null?_:0):f.updateRange(0,0)});return()=>{u.unsubscribe()}},[l,i]);const d=y.useCallback(u=>{i.next(u)},[i]);return{queryResult:n,$fakeFocus:i,setFakeFocus:d}},A0e=e=>{const t=G1(e);if(!t)return;const n=t.getAttribute("data-editor");if(n)return Xa(n)};bd(t8);const R0e=({url:e,fileStorageType:t,children:n,htmlDataProps:s,baseOffset:a})=>{const o=y.useRef(null),i=lt(),l=e,c=t,d=y.useRef(),{interactable:u}=y.useContext(yg),[f,h]=y.useState(ot.print?Rp(l!=null?l:""):""),p=A0e(o.current),{setFakeFocus:g}=n2((p==null?void 0:p.editorKey)||""),_=Mj((p==null?void 0:p.editorKey)||"",{setFakeFocus:g}),x=We(p==null?void 0:p.editorKey);y.useEffect(()=>{(async()=>{let w=l!=null?l:"";c==="internal"?w=await Vs.fetchDownloadUrl({blockId:i,ossName:w}):w=Rp(w),h(w)})()},[c,l,i]);const F=async()=>{f&&Xt(f)},b=w=>{w.preventDefault(),w.stopPropagation();const E=Number(s["data-length"]||0);p&&p.performChange(async C=>{C.select(a,a+E),await p.requestFocus(),_(!0)})};return r.jsx("a",{...s,href:f,ref:o,target:"_blank",rel:"noreferrer",className:R("underline underline-offset-4 text-active_color",u?"cursor-pointer":"cursor-text"),onClick:async w=>{if(w.preventDefault(),!u)return;const E=d.current;if(!E||Math.max(Math.abs(E.upX-E.downX),Math.abs(E.upY-E.downY))>=5)return;const C=document.createElement("a");C.setAttribute("target","_blank"),C.setAttribute("rel","noreferrer"),C.setAttribute("href",f),C.click()},onPointerDown:w=>{d.current={downX:w.clientX,downY:w.clientY,upX:w.clientX,upY:w.clientY}},onPointerUp:w=>{d.current&&(d.current.upX=w.clientX,d.current.upY=w.clientY)},children:r.jsx(Fe,{disabled:x,theme:"none",maxWidth:"none",interactive:!0,className:"inline break-words",placement:"bottom-start",interactiveDebounce:0,popupClass:"next-modal !shadow-light-sm h-7 !flex items-center text-t4 line-clamp-none allow-text-selection",popupClick:w=>{w.preventDefault(),w.stopPropagation()},popup:r.jsxs("div",{className:"flex items-center space-x-1 px-2",children:[r.jsx(V,{name:"IcGlobeShare",size:"small",className:"flex-shrink-0 text-grey3"}),r.jsx("div",{className:"text-ellipsis text-grey3 flex-shrink-0 max-w-[220px]",children:f}),r.jsxs("span",{className:"flex-shrink-0 flex items-center space-x-2",children:[r.jsx(Fe,{popup:"复制链接",children:r.jsx(V,{className:"text-grey3 cursor-pointer disable-select",name:"IcCopy",size:"small",onClick:F})}),r.jsx(Fe,{popup:"编辑",children:r.jsx(V,{className:"text-grey3 cursor-pointer disable-select",name:"IcBtnEdit",size:"small",onClick:b})})]})]}),children:n})})},hV={elementMeta:t8,initialize(e){e.setElementComponent(this.elementMeta.tag,R0e)}},pV={tag:ml,hasContent:!1,setFormat:(e,t)=>{e.props.textFormat=Cl(t,e.props.textFormat)}},gV={tag:U0,hasContent:!1,setFormat:(e,t)=>{e.props.textFormat=Cl(t,e.props.textFormat)}};bd(pV);bd(gV);const _V=e=>{const{pageId:t,blockId:n,htmlDataProps:s,textFormat:a,baseOffset:o,text:i}=e,l=ye(t,[]),c=ye(l==null?void 0:l.parentId,[]),d=ea(Eg,wg),u=ea(XM,YM),f=ea(nE,pr),{interactable:h}=y.useContext(yg),p=Cl(a),g=ux(p),_=y.useRef(null),x=y.useCallback(()=>{const w=G1(_.current);if(!w)return;const E=w.getAttribute("data-editor");if(E)return Xa(E)},[]);if(!l)return r.jsx("span",{className:"mx-[2px]",...s,ref:_,children:r.jsx(eE,{id:t,inline:!0})});let F=d?l.parentId!==d:l.parentId!==f;(c==null?void 0:c.type)===m.BlockType.TABLE_ROW&&(F=l.parentId!==u);const b={...g};return p.lineThrough&&(b.textDecoration!=null?b.textDecoration+=" line-through":b.textDecoration="line-through"),r.jsx("span",{className:"px-1",contentEditable:!1,...s,style:b,ref:_,children:r.jsx(Ir,{uuid:t,blockId:n,isLinkPage:F,interactable:h,autoIconSize:!0,format:a,getEditorModal:x,baseOffset:o,aliasText:i})})},xV={elementMeta:pV,initialize(e){e.setElementComponent(this.elementMeta.tag,_V)}},yV={elementMeta:gV,initialize(e){e.setElementComponent(this.elementMeta.tag,_V)}},bV={tag:Gm,hasContent:!1,legalize:e=>{var s;const t=e.props.userId,n=pe().users[t];return Wn([ti(" ".concat(Rn((s=n==null?void 0:n.uuid)!=null?s:"")," "))])},setFormat:(e,t)=>{e.props.textFormat=Cl(t,e.props.textFormat)}};bd(bV);const P0e=({htmlDataProps:e,textFormat:t,userId:n})=>{var c;const s=n,a=Cl(t),o=Pi(s),i=ux(a),l=_r((c=o==null?void 0:o.uuid)!=null?c:"");return r.jsxs("span",{...e,contentEditable:!1,className:"px-1 py-[3px]",style:i,children:[r.jsx("span",{className:i.color||"text-grey4",children:"@"}),r.jsx("span",{className:i.color||"text-grey3",children:l})]})},FV={elementMeta:bV,initialize(e){e.setElementComponent(this.elementMeta.tag,P0e)}},L0e=({htmlDataProps:e,tip:t,symbol:n})=>r.jsxs("span",{children:[r.jsx("span",{...e,contentEditable:!1,children:n!=null?n:"@"}),r.jsx("span",{"data-tr40owj":"","data-cursor-stop":"",children:"​​"}),t&&r.jsx("span",{className:"text-grey4 ml-[1px] mr-[2px]",children:t})]}),wV={tag:Xi,hasContent:!1,legalize:()=>Wn([ti("@")])};bd(wV);const EV={elementMeta:wV,initialize(e){e.setElementComponent(this.elementMeta.tag,L0e)}},Uj=[g0e,y0e,aV,FV,hV,xV,yV,EV,uV,iV,_ce],oa=[_0e,b0e,aV,FV,hV,xV,EV,uV,iV,yV,j0e];pde(Uj);function fs(e){const{className:t,segments:n,interactable:s=!0,plugins:a=Uj,placeholder:o,placeholderColor:i}=e,l=y.useMemo(()=>YN(a),[a]);let c=x1(n);const d=fe(n);return d||(c=x1(ht(o))),r.jsx("div",{className:R(t,"break-words"),style:{color:d?void 0:i!=null?i:"var(--grey4)"},children:r.jsx(yg.Provider,{value:{readonly:!0,interactable:s},children:r.jsx(LK,{content:c,EditorModel:l})})})}const B0e=(e="",t="")=>{const n=ye(e,["permissions"]),s=U_e(e);return y.useMemo(()=>s&&(n==null?void 0:n.permissions.some(o=>o.type==="user"&&o.userId===t)),[s,n==null?void 0:n.permissions,t])},mx=()=>{const e=VN(),t=$N(),n=Ln(),s=y.useRef(!1),a=y.useRef(null);return y.useCallback(async function o(i,l){var F;const{num:c=0,callback:d,animation:u=!0}=l||{};if(c>5){e&&be.warning("页面尚未加载完成，请稍后重试");return}const f=b=>bn('.next-space-page [data-block-id="'.concat(b,'"]'),n),h=()=>{const b=f(i);return b?b5(b).top:null};let p=!1;if(t.isVirtualListMode&&t.virtualRef&&!f(i)){const b=eT(i),w=t.subNodes.findIndex(C=>b.find(k=>C===k.uuid));if(w===-1)return;d==null||d("animateScrollStart");const E=new P3;(F=t.virtualRef.current)==null||F.scrollIntoView({index:w,align:"start",behavior:"auto",done:()=>{E.resolve()}}),await E.promise,await es(10),p=!0}s.current=!1,a.current&&clearTimeout(a.current);const g=()=>{const b=document.querySelector('[data-block-id="'.concat(i,'"] .block-background')),w=document.querySelector('[data-block-id="'.concat(i,'"]:not([data-toc-type])'));if(b)b.setAttribute("style","opacity: 100"),b.classList.add("animate__flash"),es(1300).then(()=>{b.classList.remove("animate__flash"),b.style.opacity="",d==null||d("animateScrollEnd")}),d==null||d("animateStart");else if(w){const E=document.createElement("div");E.setAttribute("class","absolute inset-0 block-background animate__animated pointer-events-none bg-active_color_10 transition-opacity rounded-sm animate__flash"),es(1300).then(()=>w.removeChild(E)),es(1e3).then(()=>d==null?void 0:d("animateScrollEnd")),w.appendChild(E),d==null||d("animateScrollStart")}},_=h(),x=bn(".next-space-page",n);if(_!==null){const b=async(w,E)=>{if(E>2)return;if(typeof x.scrollTo=="function")if(q1)x.scrollTo({top:w,behavior:"auto"});else if(Math.abs(w-x.scrollTop)>800&&!p){let k=w;x.scrollTop>w?k=k+50:k=k-50,x.scrollTo({top:k,behavior:"auto"}),x.scrollTo({top:w,behavior:"smooth"})}else x.scrollTo({top:w,behavior:p?"auto":"smooth"});else if(x.scrollTop)x.scrollTop=w;else return;if(await es(200),u&&g(),s.current)return;const C=h();C&&Math.abs(C-x.scrollTop)>30&&x.scrollTop!==C&&C>0&&(s.current=!0,b(C-100,E++),a.current=setTimeout(()=>{s.current=!1},1e3))};b(_-100,0)}else{const w=eT(i).filter(E=>[m.BlockType.TEMPLATE].includes(E.type)||CU(E.uuid));w.length!==0&&(Vi(w.map(E=>E.uuid),!0),setTimeout(()=>{o(i,{num:c+1,...l})},500))}},[n,e,t.isVirtualListMode,t.subNodes,t.virtualRef])},CV=y.createContext(!1),Yy=e=>{var _,x,F;const{commentId:t,discussion:n,hideBlockContext:s}=e,a=Ce(b=>b.comments[e.commentId],[e.commentId]),o=Pi(a==null?void 0:a.createdBy),i=_r((_=a==null?void 0:a.createdBy)!=null?_:""),l=y.useContext(CV),c=mx(),d=ye(n.parentId,["data"],["segments"]),u=An(eT(n.parentId).map(b=>b.uuid)),f=B0e(u,a==null?void 0:a.createdBy),h=()=>{l&&c(n.parentId)};if(a==null)return null;const{illegal:p}=a,g=a.createdBy===yt.uuid;return r.jsxs("div",{className:R("flex",e.className),"data-comment-id":t,children:[r.jsx(Fl,{user:o,className:"text-t2 w-6 h-6"}),r.jsxs("div",{className:"flex-1 ml-2",children:[r.jsxs("div",{className:"mb-1.5",children:[r.jsxs(Fe,{popup:f?"空间成员":"",className:"text-t2-medium inline-flex items-center",children:[i,f&&r.jsx(WX,{className:"text-active_color w-3 h-3 ml-0.5"})]}),r.jsxs("span",{className:"ml-1.5 items-center text-t4 text-grey4",children:[r.jsx(Fe,{popup:ue(a.createdAt).format(On),className:"inline",children:r.jsx(Lj,{timestamp:(x=a.createdAt)!=null?x:Date.now()})}),a.updatedAt-a.createdAt>60*1e3?"（编辑过）":null,pt()&&a.ipLocation&&r.jsx("span",{className:"ml-1.5",children:"来自".concat(a.ipLocation)})]})]}),p&&r.jsxs("div",{children:[r.jsx("span",{className:"text-t2 text-grey4",children:"该评论涉嫌违反社区分享协作政策，已屏蔽显示。"}),g&&r.jsx("span",{className:"cursor-pointer text-t2 text-active_color",onClick:()=>{},children:"我要申诉"})]}),r.jsxs(r.Fragment,{children:[n.comments[0]===t&&r.jsx("div",{className:R("my-0.5 border-l-[3px] border-l-yellow pl-2 line-clamp-3 !rounded-none",l&&"animate-hover"),onClick:h,children:r.jsx(fs,{className:"whitespace-pre-wrap opacity-60",segments:s||((F=n.context)==null?void 0:F.length)>0?n.context:d==null?void 0:d.data.segments})}),r.jsx("div",{className:R("comment-text border rounded border-transparent",l&&"animate-hover"),onClick:h,children:r.jsx(fs,{className:"whitespace-pre-wrap",segments:a.text})})]})]})]})},Lg=()=>{const e=$1(),t=Ut();return y.useMemo(()=>{const n=(s,a)=>{var i,l;const o=(l=(i=pe().discussions[s])==null?void 0:i.resolved)!=null?l:!1;e(sr({init(){e(su({uuid:s,patch:{resolved:a}}))},undo(){e(su({uuid:s,patch:{resolved:o}}))},redo(){e(su({uuid:s,patch:{resolved:a}}))}}))};return{addDiscussion(s){var c,d,u;const a=qe(),o=Date.now(),i=(d=(c=pe().blocks[s.blockId])==null?void 0:c.spaceId)!=null?d:"",l={uuid:a,spaceId:i,parentId:s.blockId,status:m.BlockStatus.NORMAL,createdAt:o,updatedAt:o,createdBy:t.uuid,updatedBy:t.uuid,resolved:!1,version:0,comments:[],context:(u=s.context)!=null?u:[]};return e(Fp({discussion:l})),e(o0({uuid:a,parentId:s.blockId})),a},resolveDiscussion(s){n(s.discussionId,!0)},reopenDiscussion(s){n(s.discussionId,!1)},appendComment(s){var c,d,u;const a=qe(),o=Date.now(),i=(d=(c=pe().discussions[s.discussionId])==null?void 0:c.spaceId)!=null?d:"",l={uuid:a,spaceId:i,parentId:s.discussionId,version:0,status:m.BlockStatus.NORMAL,createdAt:o,createdBy:t.uuid,updatedAt:o,updatedBy:t.uuid,text:(u=s.text)!=null?u:[],subNodes:[]};return e(c0({comment:l})),e(d0({uuid:a,parentId:s.discussionId})),a},editComment(s){e(u1({uuid:s.commentId,patch:{text:s.newText,updatedAt:Date.now(),updatedBy:t.uuid}}))},deleteComment(s){var l;const a=pe().comments[s.commentId];if(a==null)return;const o=a.parentId;e(u0({uuid:a.uuid,parentId:a.parentId,spaceId:a.spaceId})),e(u1({uuid:a.uuid,patch:{status:m.BlockStatus.DELETED}}));const i=pe().discussions[o];if(i!=null&&i.comments.length===0){e(i0({uuid:i.uuid,parentId:i.parentId,spaceId:i.spaceId})),e(su({uuid:i.uuid,patch:{status:m.BlockStatus.DELETED}}));const c=pe().blocks[i.parentId];if(c!=null){const d=u=>{const f=vce(bu(c,u),i.uuid);if(f!==c.data.segments){const h={};JP(h,u,f),e(Sn({uuid:c.uuid,patch:h}))}};if(d("data.segments"),d("data.caption"),d("data.description"),c.type===m.BlockType.TABLE_ROW)for(const u of Object.keys((l=c.data.collectionProperties)!=null?l:{}))d("data.collectionProperties.".concat(u))}}}}},[e,t.uuid])},kV=e=>{const t=rr(()=>qe());return r.jsx("div",{className:"next-modal w-[500px] p-1",children:r.jsx(Pj,{autoFocus:!0,draftKey:t,noSaveDraft:!0,showAvatar:!1,initialText:e.initialText,onComment:e.onComment})})},I1=e=>{var x;const t=Ce(F=>F.discussions[e.discussionId],[]),n=(x=t==null?void 0:t.comments)!=null?x:[],s=Oe(),a=Lg(),o=rr(()=>new V1),{role:i}=mt(t==null?void 0:t.uuid),{showReplyEditor:l=!0}=e,[c,d]=y.useState(l),u=F=>{s(()=>{a.appendComment({discussionId:e.discussionId,text:F})})};if(y.useEffect(()=>{const F=o.subscribe(b=>{var w;b.type==="resolve"&&((w=e.onResolve)==null||w.call(e)),b.type==="reply"&&d(!0)});return()=>{F.unsubscribe()}},[o,e]),t==null)return null;if(t.resolved)return r.jsx(TV,{discussionId:e.discussionId,readonly:e.readonly});const f=pt(),h=Xn(i,m.PermissionRole.COMMENTER),p=f&&e.allowCommentInSharePage&&h,_=c&&(p||!f&&h);return r.jsxs("div",{className:R("relative py-2 px-3 group text-t2",e.className),children:[r.jsx("div",{className:"absolute z-10 top-2 right-2.5 border rounded opacity-0 group-hover:opacity-100 flex",children:r.jsx(e6,{editorActions:o,commentId:n[0],readonly:e.readonly})}),r.jsxs("div",{className:"space-y-3",children:[n.map((F,b)=>r.jsxs("div",{className:"relative group-scope",children:[b>=1&&r.jsx("div",{className:"absolute z-10 top-0 right-0 border rounded opacity-0 group-scope-hover:opacity-100 flex",children:r.jsx(e6,{editorActions:o,commentId:F,readonly:e.readonly})}),r.jsx(Yy,{hideBlockContext:e.hideBlockContext,discussion:t,commentId:F})]},F)),_&&r.jsx(Pj,{draftKey:e.draftKey,autoFocus:e.autoFocus,remoteAction:o,onComment:u})]})]})},O0e=e=>{const t=ss(),n=Oe(),s=Lg(),a=Ce(h=>h.comments[e.commentId],[]),o=ie(),{role:i}=mt(e.commentId),l=c5();if(l==null)return null;const c=!(a!=null&&a.illegal)&&Xn(i,m.PermissionRole.COMMENTER)&&(a==null?void 0:a.createdBy)===l.uuid,d=l.spaceRole===m.PermissionRole.EDITOR&&Xn(i,m.PermissionRole.READER)||Xn(i,m.PermissionRole.COMMENTER)&&(a==null?void 0:a.createdBy)===l.uuid,u=()=>{var p;if(e.btnRef.current==null)return;e.onCloseModal();const h=(p=t.getState().comments[e.commentId])==null?void 0:p.text;o.dropdown({popcorn:e.btnRef.current,placement:"bottom-end",content:g=>r.jsx(kV,{initialText:g.text,onComment:_=>{g.onCloseModal(),n(()=>{s.editComment({commentId:e.commentId,newText:_})})}}),contentProps:{text:h}})},f=()=>{o.warning({title:r.jsx(r.Fragment,{children:"确定删除该条评论吗？"}),confirmText:"删除",confirm(){e.onCloseModal(),n(()=>{s.deleteComment({commentId:e.commentId})})}})};return r.jsx(ze,{className:"next-modal w-[180px] py-1",items:[{type:H.OPERATION,isHidden:!c,data:{title:"编辑",icon:"IcEdit02",onClick:u}},{type:H.OPERATION,isHidden:!d,data:{title:"删除",icon:"IcTrash",onClick:f}}]})},e6=e=>{const t=ie(),n=Oe(),s=Lg(),a=y.useRef(null),o=Ce(h=>h.comments[e.commentId],[]),i=pt(),{role:l}=mt(o==null?void 0:o.uuid),c=c5(),d=Ce(h=>{if((o==null?void 0:o.parentId)!=null)return h.discussions[o.parentId]},[o==null?void 0:o.parentId]),u=h=>{t.dropdown({popcorn:h.currentTarget,content:O0e,contentProps:{commentId:e.commentId,btnRef:a}})},f=()=>{d!=null&&(n(()=>{s.resolveDiscussion({discussionId:d.uuid})}),e.editorActions.next({type:"resolve"}))};return e.readonly||c==null||o==null||d==null?null:r.jsxs(r.Fragment,{children:[Xn(l,m.PermissionRole.COMMENTER)&&r.jsx(Fe,{popup:"回复",children:r.jsx("button",{className:"px-1 border-r last:border-r-0 animate-hover rounded-none",onClick:()=>{i&&!xt.$allowCommentInSharePage&&st({$allowCommentInSharePage:!0}),setTimeout(()=>{const h=o==null?void 0:o.createdBy;h!=null&&e.editorActions.next({type:"reply",payload:{to:h}})},10)},children:r.jsx(V,{size:"normal",name:"IcMenuReply",className:"text-grey3"})})}),e.commentId===(d==null?void 0:d.comments[0])&&Xn(l,m.PermissionRole.WRITER)&&r.jsx(Fe,{popup:"解决并隐藏评论",children:r.jsx("button",{className:"px-1 border-r last:border-r-0 animate-hover rounded-none",onClick:f,children:r.jsx(V,{size:"normal",name:"IcResolve",className:"text-grey3"})})}),(c.spaceRole===m.PermissionRole.EDITOR&&Xn(l,m.PermissionRole.READER)||Xn(l,m.PermissionRole.COMMENTER)&&(o==null?void 0:o.createdBy)===c.uuid)&&r.jsx("button",{ref:a,className:"px-1 border-r last:border-r-0 animate-hover rounded-none",onClick:u,children:r.jsx(V,{size:"normal",name:"IcMore",className:"text-grey3"})})]})},TV=e=>{var d;const t=Ce(u=>u.discussions[e.discussionId],[e.discussionId]),n=(d=t==null?void 0:t.comments)!=null?d:[],[s,a]=y.useState(!1),o=Oe(),{role:i}=mt(t==null?void 0:t.uuid),l=Lg(),c=()=>{o(()=>{l.reopenDiscussion({discussionId:e.discussionId})})};return t==null?null:r.jsxs("div",{className:R("relative py-4 group",e.className),children:[r.jsx("div",{className:"absolute z-10 top-4 right-4 flex",children:Xn(i,m.PermissionRole.WRITER)&&!e.readonly&&r.jsx(De,{className:"text-t4 border-none opacity-0 group-hover:opacity-100 p-1",size:"auto",onClick:c,children:"重新打开"})}),r.jsx("div",{className:"space-y-[15px]",children:n.length<=5||s?n.map(u=>r.jsx(Yy,{hideBlockContext:e.hideBlockContext,discussion:t,commentId:u},u)):r.jsxs(r.Fragment,{children:[r.jsx(Yy,{hideBlockContext:e.hideBlockContext,discussion:t,commentId:n[0]}),r.jsx("div",{className:"text-t2 text-grey4 ml-6",onClick:()=>a(!0),children:r.jsxs("span",{className:"inline-block animate-hover py-1 px-2",children:["查看中间",n.length-2,"条评论"]})}),r.jsx(Yy,{hideBlockContext:e.hideBlockContext,discussion:t,commentId:n[n.length-1]})]})})]})},vV=(e="unresolved")=>{const t=ie(),n=rr(()=>new JE),s=lt(),a=We(s,!1,!0);return y.useCallback(o=>{const{editorModel:i,popcorn:l,mask:c=!0,placement:d="bottom",selector:u}=o;u(pe()).length<=0||setTimeout(()=>{if(i!=null&&!i.isContentRendered)return;const h=p=>{const g=y.useRef(p);g.current=p,y.useEffect(()=>{if(i==null)return;const b=i.onChange.subscribe(()=>{g.current.onCloseModal()});return()=>b.unsubscribe()},[]);const _=Ce(u,[]),F=_.filter(b=>e==="unresolved"?!b.resolved:!0).length===0;return y.useEffect(()=>{F&&g.current.onCloseModal()},[F]),r.jsx(ZE,{manager:n,children:r.jsx("div",{className:R("next-modal w-125 max-h-[80vh] overflow-y-auto py-2",_.length===0&&"hidden"),children:_.map(b=>r.jsx(I1,{readonly:a,autoFocus:o.autoFocus||pt(),allowCommentInSharePage:!0,draftKey:b.uuid,discussionId:b.uuid,className:"border-t first:border-t-0"},b.uuid))})})};t.dropdown({modalId:Ve.COMMENTS,mask:c,autoClose:!0,popcorn:l,content:h,placement:d,modifiers:[{name:"preventOverflow",options:{padding:15}}],closeNoAnimate:!0})})},[n,e,t,a])},M0e=()=>{const e=ie(),t=lt(),n=We(t,!1,!0),s=rr(()=>new JE);return y.useCallback(a=>{const{editorModel:o,popcorn:i,mask:l=!0,placement:c="bottom",selector:d}=a;d(pe()).length<=0||setTimeout(()=>{const f=h=>{const p=y.useRef(h);p.current=h,y.useEffect(()=>{if(o==null)return;const b=o.onChange.subscribe(()=>{p.current.onCloseModal()});return()=>b.unsubscribe()},[]);const g=Ce(d,[]),_=g.filter(b=>b.resolved),x=g.filter(b=>!b.resolved),F=x.length===0;return y.useEffect(()=>{F&&p.current.onCloseModal()},[F]),r.jsx(ZE,{manager:s,children:r.jsx("div",{className:R("next-modal w-[500px] max-h-[80vh] overflow-y-auto",g.length===0&&"hidden"),children:r.jsxs(xg,{children:[x.length>0&&r.jsx(Zr,{title:"评论（".concat(x.length,"）"),children:r.jsx("div",{className:"px-4",children:x.map(b=>r.jsx(I1,{readonly:n,autoFocus:a.autoFocus,allowCommentInSharePage:!0,draftKey:b.uuid,discussionId:b.uuid,className:"border-t first:border-t-0"},b.uuid))})}),_.length>0&&r.jsx(Zr,{title:"已解决（".concat(_.length,"）"),children:r.jsx("div",{className:"px-4",children:_.map(b=>r.jsx(I1,{readonly:n,autoFocus:a.autoFocus,discussionId:b.uuid,className:"border-t first:border-t-0"},b.uuid))})})]},"".concat(x.length>0?1:0).concat(_.length>0?1:0))})})};e.dropdown({mask:l,autoClose:!0,popcorn:i,modifiers:[{name:"preventOverflow",options:{padding:15}}],content:f,placement:c,closeNoAnimate:!0})})},[s,e,n])},nh=e=>{const t=!!y.useContext(jl),n=function*(o,i,l=!1){var p,g;const c=o[i],d=tn(c==null?void 0:c.type);if(e.blockId===i||!d){const _=(p=c==null?void 0:c.discussions)!=null?p:[];yield*pf(_)}const u=c&&nx(c==null?void 0:c.type)&&!xt.$expandFoldRecord[c.uuid],f=(c==null?void 0:c.type)===m.BlockType.TABLE;if((l||u||f)&&!d)for(const _ of(g=c==null?void 0:c.subNodes)!=null?g:[])yield*pf(n(o,_,l||u))},s=Ce(o=>{let i=0;for(const l of n(o.blocks,e.blockId)){const c=o.discussions[l];if(c!=null&&!c.resolved)for(const d of c.comments){const u=o.comments[d];u!=null&&u.status===m.BlockStatus.NORMAL&&(i+=1)}}return i},[]),a=M0e();return s<=0?null:r.jsxs("div",{"data-comment-block-id":e.blockId,className:R("whitespace-nowrap text-grey3 text-t4 flex items-center animate-hover px-1",e.className),onClick:o=>{const i=o.currentTarget.closest(".relative");[...n(pe().blocks,e.blockId)].length<=0||a({placement:t?"right":"bottom",popcorn:i,selector:c=>[...n(c.blocks,e.blockId)].map(u=>c.discussions[u]).filter(u=>u!=null)})},children:[r.jsx(V,{size:"normal",name:"IcMenuReply",className:"w-5 h-5 mr-0.5"}),s>9?"9+":s]})},Fm=y.createContext(!0),U0e=y.memo(({position:e,zIndex:t,viewId:n})=>{var s;return n&&e&&((s=pe().collectionViews[n])==null?void 0:s.type)===m.CollectionViewType.GALLERY&&(e==="top"?e="left":e="right"),e==="top"?r.jsx("div",{className:"absolute h-1 bg-black/30 inset-x-0 -top-0.5"}):e==="bottom"?r.jsx("div",{className:R("absolute h-1 inset-x-0 bg-black/30",t===0?"bottom-[-3px]":"-bottom-1"),style:{zIndex:t+10},children:r.jsx("span",{className:"w-0.5 h-1 absolute bg-white1 z-[9999] bottom-0 -left-px"})}):e==="left"?r.jsx("div",{className:"absolute inset-y-0 w-1 bg-black/30 pointer-events-none -left-3"}):e==="right"?r.jsx("div",{className:"absolute inset-y-0 w-1 bg-black/30 pointer-events-none -right-3"}):null}),V0e=(e,t,n,s,a)=>{const o=ye(e,[]);return gc(i=>{if(!i||yne(i.cursorArea))return;const{dropId:l,position:c,cursorArea:d}=i;if(t!=null&&t.current&&bne(d)){const{left:u}=t.current.getBoundingClientRect();if(!Fne(u))return}if(c==="bottom"&&l&&o&&![m.BlockType.COLUMN_LIST,m.BlockType.QUOTE,m.BlockType.MARK,m.BlockType.COLLECTION_VIEW,m.BlockType.TEMPLATE].includes(o.type)&&vne(J.blocks,e).has(l)&&i.viewId===s&&i.groupValue===a)return"bottom";if(l===e&&i.dropInChild===!!n&&i.viewId===s&&i.groupValue===a)return c},In)},wn=y.memo(e=>r.jsx(rne,{uuid:e.id,children:r.jsx($0e,{...e})},e.id),yn),$0e=({id:e,children:t,bindId:n=!0,hideHoverMenu:s=!1,horizontal:a=!1,fullWidth:o=!0,className:i="",dropInChild:l,blockRef:c,viewId:d,groupValue:u,subGroupValue:f,style:h,disableColorStyle:p,TagName:g="section",..._})=>{const x=lx(e),F=ye(e,["discussions"]),b=y.useRef(null),w=c!=null?c:b,E=V1e(e),C=V0e(e,b,l,d,u),k=G1e(e),T=z1e(),v=Ks(),I=y.useContext(Fm)&&n,j=y.useMemo(()=>{let A=!1;const P=ks(e);return[...sc(e)].some(L=>{const O=J.blocks[L];return O?P===L?!0:O.type===m.BlockType.COLUMN?(A=!0,!0):!1:!1}),A},[e]),S=JM(),D=!l&&w0(F)&&S;return r.jsxs(g,{ref:w,className:R("relative cursor-text",o&&"w-full",D&&j&&"pr-10",x.backgroundColor&&"rounded",i,T&&"hide-sync-block-child",k&&"opacity-60"),"data-block-id":I?e:null,"data-drop-in-child":l,"data-horizontal":a||null,"data-hide-hover-menu":s?!0:null,style:{...h,...p?{}:x,...E},"data-sync-id":v,"data-view-id":d,"data-group-value":u,"data-sub-group-value":f,..._,children:[t,r.jsx(U0e,{zIndex:Ri()===(F==null?void 0:F.parentId)?0:sc(e).size,position:C,viewId:d}),D&&r.jsx(H0e,{id:e,inColumn:j}),r.jsx(q0e,{id:e,bindId:I,dropInChild:l,position:C,viewId:d,groupValue:u,subGroupValue:f})]})},H0e=y.memo(({id:e,inColumn:t})=>r.jsx("div",{className:R("absolute top-0 right-0 h-full z-10",t&&"right-10"),children:r.jsx(nh,{className:"absolute left-1 top-[5px]",blockId:e})})),z0e=(e,t,n)=>gc(s=>{const{dropId:a,position:o}=s||{};if(!a)return;const i=J.blocks[e];if(!i||n||o==="middle"&&(tn(i.type)||nx(i.type))&&!t)return;const l=J.blocks[i.parentId],c=Ri();if(!(!l||ga(l.type)||l.type===m.BlockType.COLUMN_LIST||l.uuid===c))return l.uuid===e}),q0e=y.memo(e=>{const{id:t,bindId:n,dropInChild:s,position:a,viewId:o,groupValue:i,subGroupValue:l}=e,c=Sd(t,o,i,l),d=YE(t),u=z0e(t,d,s),f=Ho(),h=y.useMemo(()=>{var x,F;const p=J.blocks[t];if(!p)return!1;const g=(F=(x=Om(t))==null?void 0:x.type)!=null?F:p.type;if(f)return a==="middle"?tn(g)||nx(g):u;const _=p.type===m.BlockType.FILE&&p.data.display==="image"&&(p.data.link||p.data.ossName);return c&&n&&!_},[t,f,c,n,a,u]);return r.jsx("div",{className:R("absolute inset-0 pointer-events-none z-10 block-background animate__animated bg-active_color_10 rounded-sm transition-opacity",!h&&"opacity-0")})},yn),s2=e=>Ce(t=>{let n=t.blocks[e];const s=new Set;for(;n&&!s.has(n.uuid);){if(s.add(n.uuid),n.status===m.BlockStatus.DELETED)return!0;n=t.blocks[n.parentId]}return!1},[e]),r2=(e,t=J.blocks)=>{let n=t[e];for(;n&&n.parentId!==n.spaceId;){if(n.status===m.BlockStatus.DELETED)return!0;n=t[n.parentId]}},IV=e=>{let t="";return e===m.BlockType.FOLDER?t="文件夹":e===m.BlockType.FILE?t="文件":t="页面",t},G0e="video/*,.mpg,.3gp,.asf,.avi,.f4v,.flv,.mkv,.rmvb,.wmv",W0e="audio/*,.ogg,.m4a,.amr,.ac3,.wma,.ape",hx=e=>{const t=ie(),n=Jne(),s=lt(),a=pw(),o=ns();return y.useCallback(i=>{const l=pe().blocks[e];l&&t.warning({title:r.jsxs(r.Fragment,{children:["确定彻底删除该",IV(l.type),"?"]}),confirm:async()=>{await n(l.uuid),be.success("已彻底删除"),i?i():s===l.uuid&&([m.BlockType.PAGE,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.FOLDER].includes(l.type)?a():o.push(Nt.main))}})},[n,t,e,s,o,a])},Vj=y.memo(({uuid:e,onDelete:t})=>{const n=ye(e,["status","moved"]),s=ns(),a=O5(),o=K0e(),i=hx(e),l=pw(),c=k0(e),{role:d,accessFee:u}=mt(e);if(!n||n.status===m.BlockStatus.DELETED_COMPLETE)return null;const f=()=>{i(()=>{[m.BlockType.PAGE,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.FOLDER,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE].includes(n.type)&&l(),me.event("completely_delete",{page_source:"fromDeleteBar"}),t==null||t()})},h=()=>{var _;me.event("recycle_recover",{page_source:"fromDeleteBar"});const{blocks:g}=pe();if(n.type===m.BlockType.FILE){const x=g[n.parentId];(x==null?void 0:x.status)===m.BlockStatus.NORMAL&&(x.type===m.BlockType.FOLDER||x.type===m.BlockType.PAGE)?(s.push("/".concat(x.uuid)),a(n.uuid)):o({uuid:n.uuid});return}if((n.type===m.BlockType.FOLDER||n.type===m.BlockType.COLLECTION_VIEW_PAGE||n.type===m.BlockType.COLLECTION_VIEW||n.type===m.BlockType.MIND_MAPPING||n.type===m.BlockType.MIND_MAPPING_PAGE)&&((_=g[n.parentId])==null?void 0:_.type)===m.BlockType.COLLECTION_VIEW_PAGE){o({uuid:n.uuid});return}a(n.uuid)};let p;if(n.moved){const{movedToSpaceId:g}=n.moved,_=Td[g];_&&(p=r.jsxs("span",{className:"text-t2",children:["已移动到 ",_.title]}))}else{const g=IV(n.type);p=r.jsx("span",{className:"text-t2",children:"当前".concat(g,"已删除")})}return r.jsxs("div",{className:"h-[60px] w-full bg-red flex-shrink-0 text-white flex items-center justify-center sticky cursor-default top-0 left-0 z-20",children:[r.jsx(V,{name:"IcTrash",size:"middle",className:"mr-2"}),p,u!==void 0&&u>0&&r.jsx("span",{className:"text-t2",children:"。该页面正在付费分享，删除后将影响已购买用户体验。"}),c&&(d===m.PermissionRole.EDITOR||d===m.PermissionRole.WRITER)&&r.jsxs("span",{className:"absolute flex items-center right-2",children:[r.jsx(De,{...Gs(Hs.deleteBarRestore),colorType:"white",size:"large",className:"mr-2",onClick:h,children:"恢复"}),!n.moved&&r.jsx(De,{...Gs(Hs.deleteBarDelete),colorType:"white",onClick:f,children:"彻底删除"})]})]})}),K0e=()=>{const e=ie(),t=Pd(),n=ns();return y.useCallback(s=>{e.modal({content:({onCloseModal:a})=>r.jsxs("div",{className:"next-modal w-[400px] h-[288px] py-[30px] flex flex-col justify-center items-center",children:[r.jsx("p",{className:"text-[70px] leading-[80px]",children:"😔"}),r.jsx("p",{className:"mt-2.5 text-t1",children:"当前页面无法恢复至原路径"}),r.jsxs("p",{className:"text-t2 mt-2.5 text-center",children:["因原路径已被彻底删除或无法移入，可尝试将该页面 ",r.jsx("br",{}),"移动至指定页面"]}),r.jsx(De,{onClick:()=>{t({uuid:s.uuid,mode:"modal",callback:o=>{n.push(o)}}),a()},colorType:"active",className:"w-[340px] border-none text-t2 text-white mt-8 py-1.5 flex-shrink-0",children:"尝试移动"}),r.jsx(De,{onClick:()=>{a()},colorType:"white",className:"w-[340px] border-none text-t2 text-white mt-2.5 py-1.5 flex-shrink-0",children:"知道了"})]})})},[n,e,t])},Y0e=e=>[m.BlockType.FOLDER,m.BlockType.PAGE,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION,m.BlockType.REFERENCE_COLLECTION_PAGE,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE].includes(e),px=()=>y.useCallback((e,t,n)=>{const{blocks:s}=pe(),a=sc(e,s,n),o=[];if(s[e])for(const l of a){if(!t&&l===e)continue;const c=s[l];if(!c)break;Y0e(c.type)&&o.unshift(c)}return o},[]),mRe=()=>{const e=px();return y.useCallback((t,n)=>{const s=e(t),a=BK(s.map(({uuid:o})=>o).map(o=>["".concat(Ss.SPACE,"_").concat(o),"".concat(Ss.PRIVATE,"_").concat(o),"".concat(Ss.FAVORITE,"_").concat(o),"".concat(Ss.SHARE,"_").concat(o)]));n!=null&&n.includeItself&&a.push("".concat(Ss.SPACE,"_").concat(t),"".concat(Ss.PRIVATE,"_").concat(t),"".concat(Ss.FAVORITE,"_").concat(t),"".concat(Ss.SHARE,"_").concat(t)),j3(a,!0)},[e])},$j=(e,t)=>{const n=ie(),s=X0e(e,t);return y.useCallback(async()=>{n.warning({title:"举报/申诉",minWidth:350,content:r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{children:"若页面涉嫌诈骗，可通过邮件及时与我们联系"}),r.jsxs("div",{children:["快速举报邮箱：",r.jsx("a",{className:"animate-click underline underline-offset-4",href:"mailto:".concat(LS),children:LS})]})]}),colorType:"active",confirmText:"在线举报/申诉",confirm:s})},[n,s])},X0e=(e,t)=>{const n=ie(),s=lt();return y.useCallback(async()=>{const a={report:"complain",justice:"appeal"};(xa().uuid?await ve.editor.shareCheck(e||s,a.report):!0)===!1?n.modal({content:({onCloseModal:i})=>r.jsx(bN,{success:!1,type:"report",onCloseModal:i})}):n.modal({content:({onCloseModal:i})=>r.jsx(oM,{blockType:t==null?void 0:t.blockType,type:"report",uuid:e||s,onCloseModal:i})})},[n,t==null?void 0:t.blockType,s,e])},Q0e=window.innerWidth<=640,NV=e=>{const t=lt(),n=ye(e,["data","createdBy"],["segments"]),{allowDuplicate:s,shared:a,roleWithoutPublic:o,illegal:i}=mt(e),l=Ut(),c=ug(),d=pt(),u=ln(),f=$j(e),h=Sg(),p=aM(),g=Jm(t),_=R0(location.search),x=Ow(e),F=uf(t),b=p||(g==null?void 0:g.tag)==="NO_PERMISSION"||(g==null?void 0:g.tag)==="NOT_FOUND"||i||F||!1,w=HE(t),E=!!l.uuid;return y.useMemo(()=>{if(!d||!n)return[];const C=!!(o!==m.PermissionRole.NONE&&tn(n.type)),k=[{type:H.CUSTOM_RENDER,render:()=>E?r.jsxs("div",{className:"mx-2 flex h-10 items-center justify-between px-2",children:[r.jsxs("div",{className:"flex w-3/5 items-center",children:[r.jsx(ar,{className:"!text-t4 mr-2 h-5 w-5 flex-shrink-0 rounded-full text-white",name:Rn(l.uuid,l.nickname),color:l.backgroundColor,icon:{type:"upload",value:l.avatar},imgClassName:"rounded-full"}),r.jsx("span",{className:"text-grey3 text-t2 text-ellipsis",children:l.nickname})]}),Q0e?null:r.jsx("div",{className:"text-active_color text-t4-bold flex-shrink-0",onClick:()=>{u(Ve.PAGE_HEADER_MENU_LIST),Er(r1())},children:"回到我的空间"})]}):r.jsxs("div",{className:"mx-2 flex h-10 cursor-pointer items-center px-2",onClick:async()=>{const T=_(dn.inviteCode),v=_(dn.spaceId);if(u(Ve.PAGE_HEADER_MENU_LIST),T&&v){Er(Xf(Nt.login,[{key:dn.callbackPath,value:location.pathname},{key:dn.inviteCode,value:T},{key:dn.spaceId,value:v}]));return}if(n.createdBy){const I=await jU(n.createdBy);Er(Xf(Nt.login,[{key:dn.callbackPath,value:location.pathname},{key:dn.inviteCode,value:"".concat(I==null?void 0:I.inviteCode)}]));return}Er(Xf(Nt.login,[{key:dn.callbackPath,value:location.pathname}]))},children:[r.jsx(V,{size:"middle",name:"MIcSettingsAccount",className:"mr-2"}),r.jsx("span",{className:"text-t2 text-grey3",children:"登录/注册"})]})}];return E&&C&&k.push({type:H.LINE,disableClick:!0},{type:H.OPERATION,data:{icon:"IcEdit",title:"进入空间编辑/查看",onClick:()=>{Er("".concat(r1(),"/").concat(t))}}}),i||(k.push({type:H.LINE,disableClick:!0},{type:H.OPERATION,data:{icon:"IcLink",title:"复制分享链接",onClick:()=>{me.event("share_copylink",{is_share:a});const{textAndUrl:T}=x();Xt(T)}}},{type:H.OPERATION,data:{icon:"IcGlobeShare",title:"复制内嵌模式链接",onClick:()=>{me.event("share_copylink",{is_share:a});const{textAndUrl:T}=x({embed:!0});Xt(T)}}}),Cj(e)&&!w&&k.push({type:H.OPERATION,data:{icon:"IcDuplicate",title:"拷贝到我的空间",onClick:()=>{me.event("copytomyspace",{page_id:e}),h(e,{addCopyLimit:!0})}}}),b||k.push({type:H.LINE,disableClick:!0},{type:H.OPERATION,data:{icon:"IcMenuReport",title:"举报违法信息",onClick:f}})),E&&k.push({type:H.LINE,disableClick:!0},{type:H.OPERATION,data:{icon:"MIcSettingsLogout",title:"退出登录",onClick:()=>{me.logout(),c()}}}),!i&&s&&k.push({type:H.LINE,disableClick:!0},{type:H.CUSTOM_RENDER,disableCustomHoverBg:!0,render(){return r.jsxs("div",{className:"text-grey3 mx-4 my-2 flex items-center",children:[r.jsx(V,{name:"IcShareDanger",size:"small",className:"mr-1"}),r.jsx("span",{className:"text-t4",children:"允许拷贝副本、下载和打印"})]})}}),k},[d,n,o,E,i,s,l.uuid,l.nickname,l.backgroundColor,l.avatar,u,_,t,e,w,b,a,x,h,f,c])},Bg=({logoImage:e,className:t="",description:n,showSpace:s=!0})=>{const a=lt(),o=ye(a,[]),i=pc(o==null?void 0:o.spaceId),l=pt(),c=Ur(o==null?void 0:o.spaceId),d=Pa();e||(e=d?vn.logoWhiteWide:vn.logoBlackWide);const u=y.useMemo(()=>c&&l&&i.uuid&&s?r.jsx("div",{className:"flex text-t2",children:r.jsx(ar,{name:i.title,color:i.backgroundColor,icon:i.icon,iconSize:18})}):r.jsx("img",{src:e,alt:"logo",className:R("h-[18px]",{"h-7":!1,"w-10 h-full":!1})}),[c,l,e,s,i.backgroundColor,i.icon,i.title,i.uuid]);return r.jsxs("a",{href:Cb||gs.check?"javascript:void(0);":_n(),className:R("flex-shrink-0 flex items-center mr-2 animate-click",t),onClick:()=>{gs.check&&Er(Nt.main)},children:[u,n]})},J0e=e=>{const{uuid:t,children:n,className:s}=e,a=y.useRef(null),o=pt(),{illegal:i,allowDuplicate:l}=mt(t),c=uf(t);return o&&l&&!i&&!c?r.jsx("div",{ref:a,className:s,children:n}):null},Z0e=e=>{const t=ye(e,[]),n=px();return t?n(t.uuid):[]},jV=({isPreviewPage:e,uuid:t,downloadUrl:n,pageScene:s,onClose:a})=>{var Q,ne,se,ce;const o=sI(t),i=Pd(),l=We(t),c=ye(t,["data"],["segments","pdfAnnotation","size"]),d=Qa(),{illegal:u,allowDuplicate:f,allowDownload:h}=mt(t),{blocks:p}=pe(),{role:g}=mt((Q=c==null?void 0:c.parentId)!=null?Q:""),_=p[(ne=c==null?void 0:c.parentId)!=null?ne:""],x=sx(),F=cr(t),{openImageWatermark:b,imageWatermarkText:w}=Dg(F==null?void 0:F.spaceId),E=(c==null?void 0:c.type)===m.BlockType.PDF_ANNOTATION,C=ie(),k=y.useRef();let T=u?Ts:fe(c==null?void 0:c.data.segments);E&&(T="图片标注.png");const{extName:v}=rn(T),I=Z0e(t);if(E){const ae=p[(se=c.parentId)!=null?se:""];ae&&I.push(ae)}const j=NV(t),S=hx(t),D=Sg(),A=pt(),P=s===wt.TEMPLATE,L=uf(t)||P,O=rx(),$=ax&&!O,M=Jt.image.test(v),U=y.useCallback(()=>{window.open("/".concat(um(),"/").concat(t))},[t]),z=y.useCallback(()=>{gr(t)},[t]),K=y.useCallback(()=>{e||i({popcorn:k.current,uuid:t})},[e,i,t]),W=y.useCallback(()=>{Xt("".concat(_n(),"/").concat(um(),"/").concat(t))},[t]),Y=async()=>{if(await x(),M){let ae=await Dre(t);ae?(b&&w&&(ae=Tm(ae,w)),cc(ae)):be.error("下载资源失败")}else cc(n)},G=y.useMemo(()=>A?j:u?[{type:H.OPERATION,data:{icon:"IcTrash",title:"彻底删除",onClick:()=>S()}}]:[{type:H.OPERATION,data:{icon:"IcMenuOpenNew",title:"新窗口打开",onClick:U}},{type:H.OPERATION,data:{icon:"IcMenuOpenNew",title:"删除",onClick:z}},{type:H.OPERATION,isHidden:l||g!==m.PermissionRole.EDITOR,data:{icon:"IcLink",title:"拷贝链接",onClick:W}},{type:H.OPERATION,isHidden:l||_&&g!==m.PermissionRole.EDITOR,data:{icon:"IcMove",rightText:"".concat(Ds,"+Shift+P"),title:"移动到",onClick:K}}],[A,j,u,U,z,l,g,W,_,K,S]),ee=y.useCallback(ae=>{k.current=ae.currentTarget,C.dropdown({popcorn:ae.currentTarget,placement:"bottom-end",offset:[0,10],content:({onCloseModal:de})=>r.jsx(ze,{className:"py-2 rounded next-modal w-52",items:G,onItemClick:()=>de()})})},[G,C]),te=A&&f&&!u&&!L&&!0;return c?r.jsxs("div",{className:R("absolute top-0 left-0 z-20 flex justify-between w-screen min-h-[55px] bg-black-base/40 backdrop-blur-sm",I.length===0?"items-center":"items-start"),children:[r.jsxs("div",{className:"flex h-full",children:[A&&r.jsx(Bg,{logoImage:vn.logoWhiteWide,className:"ml-4 h-[18px] self-center border-r pr-2 sm:pr-1"}),r.jsxs("div",{className:R("flex",{"relative top-2":I.length>0,"pl-20":$}),children:[!e&&J.blocks[c.parentId]&&r.jsx(V,{name:"IcArrowBack",className:R("animate-click text-white sm:ml-0",A?"ml-2":"ml-3"),size:"middle",onClick:a}),r.jsxs("div",{className:"flex px-3 text-white sm:ml-1",children:[r.jsx(V,{name:Ya(v),size:"middle",className:"flex-shrink-0 mr-2"}),r.jsxs("div",{className:"flex flex-col justify-between w-[calc(100vw-450px)] sm:w-[calc(100vw-250px)]",children:[r.jsx(Ad,{fileName:T,className:"text-t2",addonAfter:d?null:r.jsx("span",{className:"ml-2 text-grey3",children:As(E?(ce=c.data.pdfAnnotation)==null?void 0:ce.size:c.data.size)})}),r.jsx(x0,{navs:I,className:"text-white",placement:"bottom",untitled:$B})]})]})]})]}),r.jsxs("div",{className:"flex items-center self-center flex-shrink-0 pr-4 space-x-2",children:[te&&r.jsx(J0e,{uuid:t,children:r.jsx(De,{className:"text-t2-medium flex-shrink-0",onClick:()=>{me.event("copytomyspace",{page_id:t}),D(t)},children:"拷贝到"})}),!A&&!u&&!L&&r.jsx(tx,{showType:"button",uuid:t,color:"text-white"}),r.jsx(SV,{extName:v}),h&&!L&&!u&&r.jsx(Fe,{popup:"下载",className:"flex items-center justify-center animate-hover",onClick:()=>{Y()},children:r.jsx(V,{name:"IcDownload",className:"text-white",size:"middle",...Gs(Hs.menuDown)})}),!A&&!u&&!P&&r.jsx(KE,{uuid:t,style:{color:o?Do.yellow:Do.white}}),!location.pathname.includes("preview")&&r.jsx(V,{name:"IcMore",className:"menu_more text-white",size:"middle",...Gs(Hs.menuMore),onClick:ee})]})]}):null},SV=e=>{const{extName:t=""}=e,{officeOptions:n}=pM(),s=Ur();return!n.canEditor||!vle(t)?null:r.jsxs("div",{className:"flex items-center animate-click text-white",onClick:n.openEditor,children:[r.jsx(V,{name:"IcBtnEdit",size:"middle"}),!s&&r.jsx(_l,{absolute:!1})]})},DV=e=>{var x;const{overlayProps:t,previewId:n,hiddenImageToolbar:s}=e,a=Un(),o=t.images[t.index],i=t.images.length>1,l=ye(n,["status"]),{allowDownload:c}=mt(n),d=!!((x=o==null?void 0:o.src)!=null&&x.startsWith("data:"))&&c,u=sx(),f=()=>{if(t.index===0){be.warning("当前为第一张");return}t.onIndexChange(t.index-1)},h=()=>{if(t.index+1===t.images.length){be.warning("当前为最后一张");return}t.onIndexChange(t.index+1)},p=(F,b)=>{const w=b.metaKey||b.ctrlKey?.1:.5;F==="in"?t.onScale(t.scale-w):t.onScale(t.scale+w)},g=F=>{F.metaKey||F.ctrlKey?t.onRotate(t.rotate+45):t.onRotate(t.rotate+90)},_=async()=>{if(!(o!=null&&o.src))return;await u();const F=TQ(o.src),b=URL.createObjectURL(F);cc(b,ue().format("YYYY-MM-DD-HH-mm-ss"))};return r.jsxs(r.Fragment,{children:[l?r.jsx(jV,{onClose:t.onClose,uuid:l.uuid,downloadUrl:"".concat(o==null?void 0:o.src),pageScene:a}):r.jsx("div",{className:"fixed top-4 right-4 z-20 animate-click text-grey3",onClick:t.onClose,children:"关闭"}),n&&r2(n)&&r.jsx("div",{className:"absolute z-50 w-full top-[55px] h-14",children:r.jsx(Vj,{uuid:n,onDelete:t.onClose})}),r.jsxs(r.Fragment,{children:[i&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed z-10 left-0 h-full flex items-center",children:r.jsx(Fe,{popup:"上一张",children:r.jsx(V,{name:"MIcBtnPre",size:"xxxlarge",onClick:f})})}),r.jsx("div",{className:"fixed z-10 right-0 h-full flex items-center",children:r.jsx(Fe,{popup:"下一张",children:r.jsx(V,{name:"MIcBtnNext",size:"xxxlarge",onClick:h})})})]}),r.jsxs("div",{className:"fixed z-10 flex items-center px-1 py-1 -translate-x-1/2 bg-black-base/70 left-1/2 bottom-5 rounded backdrop-blur-sm",children:[!s&&r.jsxs(r.Fragment,{children:[r.jsx(Ys,{onClick:F=>p("in",F),size:40,className:"mr-1 animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(V,{name:"MIcZoomIn",size:"large"})}),r.jsx(Ys,{size:40,onClick:F=>p("out",F),className:"mr-1 animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(V,{name:"MIcZoomOut",size:"large"})}),r.jsx(Ys,{size:40,onClick:g,className:"mr-1 text-grey3-base animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(V,{name:"IcMenuRelink",size:"large",className:"-scale-x-100"})}),d&&r.jsx(Ys,{size:40,onClick:_,className:"mr-1 text-grey3-base animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(V,{name:"IcDownload",size:"large",className:"-scale-x-100"})})]}),r.jsx(Ys,{size:40,onClick:t.onClose,className:"text-grey3-base animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(V,{name:"IcBannerClose",size:"xxlarge"})})]})]})]})},exe=()=>{const[e,t]=y.useState(!1),[n,s]=y.useState(0),[a,o]=y.useState([]),[i,l]=y.useState([]),[c,d]=y.useState([]),u=!!c.length,f=kj(),h=()=>{s(0),t(!1),d([]),o([...i])},p=y.useCallback(F=>{f().then(()=>{const b=a.findIndex(w=>w.key===F.uuid);b>=0?s(b):(d([{key:F.uuid,src:F.src}]),s(0)),t(!0)})},[f,a]),g=(F,b)=>{(u?d:o)(E=>{const C=Br(E),k=C.findIndex(v=>v.key===b),T=C[k];return T&&Object.assign(T,{src:F}),C})};y.useEffect(()=>{e?document.body.classList.add("overscroll-x-contain"):document.body.classList.remove("overscroll-x-contain")},[e]);const _=F=>{u?d(F):(o(F),l(F))},x=y.useMemo(()=>u?c:a,[a,c,u]);return{index:n,visible:e,images:x,setImages:_,onClose:h,setIndex:s,openImagePreview:p,onLoad:g}},sh=()=>_ae(N1,e=>e.openImagePreview),N1=vl(exe),Og=({children:e,uuid:t})=>t?r.jsxs(N1,{children:[r.jsx(nxe,{uuid:t}),e]}):r.jsx(N1,{children:r.jsx(txe,{uuid:t,children:e})}),txe=({children:e})=>r.jsx(UK,{minDragScale:.5,onVisibleChange:t=>{st({$isOpenImagePreview:t})},maskOpacity:.8,speed:()=>200,maskClosable:!0,loop:!1,bannerVisible:!1,photoClosable:!1,loadingElement:r.jsx($s,{}),overlayRender:t=>r.jsx(DV,{overlayProps:t}),children:e}),nxe=y.memo(({uuid:e})=>{const t=a9(),n=o9(),{index:s,visible:a,images:o,setImages:i,onClose:l,setIndex:c}=an(N1),d=o[s],u=hM({uuid:e,pageId:e});OK((h,p,g)=>{if(!In(p==null?void 0:p[0],g==null?void 0:g[0])){const x=u.map(b=>({src:void 0,key:b}));i(x),x[s]||l()}},[u,i]);const f=()=>{if(gs.check)return;[...document.getElementsByClassName("PhotoView__Photo")].forEach(p=>{const{src:g}=p;km(g)||(p.src="",p.referrerPolicy="no-referrer",p.src=g)})};return y.useEffect(()=>{a&&es(200).then(f)},[a]),y.useEffect(()=>{f()},[s]),r.jsx(r.Fragment,{children:r.jsx(MK,{minDragScale:.5,index:s,visible:a,images:o.map(h=>({...h,width:h.src?void 0:t,height:h.src?void 0:n,render:p=>{let g=r.jsx(r.Fragment,{});return(d==null?void 0:d.key)!==h.key&&(g=r.jsx($s,{})),g=r.jsx(sxe,{...p,uuid:h.key}),r.jsx(rxe,{...p,children:g})}})),brokenElement:r.jsx(gM,{}),onClose:l,maskOpacity:.8,speed:()=>200,maskClosable:!0,loop:!1,bannerVisible:!1,onIndexChange:c,loadingElement:r.jsx($s,{}),overlayRender:h=>r.jsx(DV,{hiddenImageToolbar:!(d!=null&&d.src),previewId:d==null?void 0:d.key,overlayProps:h})})})}),sxe=e=>{const{uuid:t}=e,{illegal:n}=mt(t),{imageUrl:s,loading:a}=bc(n?"":t,{isImage:!0});let o=s;const i=cr(t),{openImageWatermark:l,imageWatermarkText:c}=Dg(i==null?void 0:i.spaceId);return l&&c&&(o=Tm(s,c)),n?r.jsx(L0,{className:"p-0",uuid:t}):r.jsxs(r.Fragment,{children:[r.jsx($s,{}),!a&&o&&r.jsx(axe,{item:{uuid:t,src:o}})]})},rxe=e=>{var c,d;const{attrs:t,scale:n,children:s}=e,a=a9(),i=(((d=Number((c=t.style)==null?void 0:c.width))!=null?d:0)-a)/a,l=n===1?n+i:1+i;return r.jsx("div",{...t,children:r.jsx("div",{style:{transform:"scale(".concat(l,")"),width:a,transformOrigin:"0 0"},children:r.jsx("div",{className:"w-screen h-screen flex items-center justify-center",children:s})})})},axe=e=>{const{onLoad:t}=an(N1),{item:n}=e,[s,a]=y.useState(n==null?void 0:n.src),o=km(s);y.useEffect(()=>{const l=Pk.get(s);l?t(l,n.uuid):o&&t(n.src,n.uuid)},[]);const i=()=>{if(!n.src.startsWith("blob")){const l=rB(n.src);oB(l,{callback:c=>{const d=URL.createObjectURL(c.blob);t(d,n.uuid),a(d)},onError:()=>{t(n.src,n.uuid)}})}};return r.jsx("img",{style:{width:0,height:0,opacity:0},src:s,onLoad:()=>{t(n.src,n.uuid)},referrerPolicy:o?"strict-origin-when-cross-origin":"no-referrer",loading:"lazy",onError:i})},oxe=()=>{const e=ur();return y.useCallback(t=>{var c,d,u,f,h;const n=new Set,s=new Set;t.forEach(p=>{n.add(p.recordId),s.add(p.propertyId)});const a=t[0];if(!a)return;const o=ks(a.recordId);if(!o)return;const i=(u=(d=(c=J.blocks[o])==null?void 0:c.data.schema)==null?void 0:d[a.propertyId])==null?void 0:u.type,l=(h=(f=J.blocks[a.recordId])==null?void 0:f.data.collectionProperties)==null?void 0:h[a.propertyId];if(i===m.CollectionSchemaType.CHECKBOX){const p=fe(l);us(p.toUpperCase())&&e([...n],[...s],"NO")}else e([...n],[...s],"")},[e])},ixe=e=>e instanceof DOMException&&e.name==="AbortError",t6=(e,t)=>{try{return JSON.parse(e)}catch(n){return t}},Df=(e,t,n)=>{if(e.has(t))return e.get(t);const s=n();return e.set(t,s),s},n6=(e,t,n)=>{const s=Df(e,t,()=>[]);return s.includes(n)?!1:(s.push(n),!0)},s6=(e,t,n)=>{const s=Df(e,t,()=>[]),a=s.indexOf(n);return a===-1?!1:(s.splice(a,1),s.length===0&&e.delete(t),!0)},lxe={}.VITE_WS_URL||"wss://".concat(location.host,"/ws/webSocket/"),cxe=300,dxe=25e3,uxe=2e4,fxe=3e5,r6=4001,a6=4002;class o6 extends Error{constructor(n){super("WebSocket closed with code: ".concat(n));q(this,"code");this.code=n}}class mxe{constructor(t={}){q(this,"userIdAndTokenReady");q(this,"setUserIdAndTokenReady");q(this,"userId");q(this,"token");q(this,"disposed",!1);q(this,"disposer");q(this,"options");q(this,"pageObservers",new Map);q(this,"spaceViewObservers",new Map);q(this,"collectionViewObservers",new Map);q(this,"spacePageObservers",new Map);q(this,"presencePageObservers",new Map);q(this,"sharedPagesObservers",new Map);q(this,"tabVisibleObservers",new Map);q(this,"notificationsObservers",[]);q(this,"scheduleCommitObservers",Dx);q(this,"scheduleCommitRequest",Dx);q(this,"retryCount",0);q(this,"requestData",[]);q(this,"throttledDispatchRecover",Ps(this.dispatchRecover.bind(this),1500,{leading:!1,trailing:!0}));q(this,"lastPresentData");this.userIdAndTokenReady=new Promise(n=>{this.setUserIdAndTokenReady=(s,a)=>{this.userId=s,this.token=a,n()}}),this.options={...t,heartbeatIntervalInMs:dxe,heartbeatTimeoutInMs:uxe,maxRetryIntervalInMs:fxe},jc.ifvisible.wakeup(),jc.ifvisible.setIdleDuration(cxe),this.lifecycle()}setUserIdAndToken(t,n){this.setUserIdAndTokenReady(t,n)}dispose(){var t;this.disposed=!0,(t=this.disposer)==null||t.call(this),this.disposer=void 0}async lifecycle(){await this.userIdAndTokenReady;const t=async()=>{(!jc.ifvisible.now()||!Ta.online)&&await new Promise(s=>{const a=()=>{jc.ifvisible.now()&&Ta.online&&(o.unsubscribe(),jc.ifvisible.off("wakeup",a),s())},o=Ta.onStatusChange.subscribe(a);jc.ifvisible.on("wakeup",a)})};let n=!1;for(;!this.disposed;){try{await this.startNewSession(n)}catch(s){s instanceof o6&&s.code===a6||console.error(s)}if(n=!0,!jc.ifvisible.now()||!Ta.online)await t();else{const s=Math.min(1e3*Math.pow(2,this.retryCount),this.options.maxRetryIntervalInMs);this.retryCount+=1,await Ao(s),await t()}}}async ping(t){t.send("PING"),await new Promise((n,s)=>{const a=()=>{clearTimeout(i),t.removeEventListener("message",o),t.removeEventListener("close",a)},o=l=>{l.data==="PONG"&&(a(),n())};t.addEventListener("message",o),t.addEventListener("close",a);const i=setTimeout(()=>{a(),s(new Error("Timeout"))},this.options.heartbeatTimeoutInMs)})}async request(t,n,s){const a=qe(),o=JSON.stringify({requestId:a,type:n,data:s});return t.send(o),new Promise((i,l)=>{const c=()=>{t.removeEventListener("message",d),t.removeEventListener("close",c)},d=u=>{const f=t6(u.data);this.isResponsePacket(f)&&f.requestId===a&&(c(),f.status===200?i(f.data):l(new Error("Response with status: ".concat(f.status))))};t.addEventListener("message",d),t.addEventListener("close",c)})}isResponsePacket(t){return typeof t=="object"&&t!==null&&t.type==="response"}isNotificationPacket(t){return typeof t=="object"&&t!==null&&t.type==="notification"}setupObservers(t){const n=new Set,s=new Set,a=new Set,o=new Set,i=new Set;let l=!1;this.scheduleCommitObservers=Ps(async()=>{if(t.readyState!==WebSocket.OPEN)return;const d=[];for(const u of this.spacePageObservers.keys())n.has(u)||(n.add(u),d.push(this.request(t,"/subscribe",{channel:"/spaces/".concat(u)})));for(const u of n)this.spacePageObservers.has(u)||d.push(this.request(t,"/unsubscribe",{channel:"/spaces/".concat(u)}).then(()=>{n.delete(u),this.scheduleCommitObservers()}));for(const u of this.pageObservers.keys())s.has(u)||(s.add(u),d.push(this.request(t,"/subscribe",{channel:"/pages/".concat(u)})));for(const u of s)this.pageObservers.has(u)||d.push(this.request(t,"/unsubscribe",{channel:"/pages/".concat(u)}).then(()=>{s.delete(u),this.scheduleCommitObservers()}));for(const u of this.spaceViewObservers.keys())a.has(u)||(a.add(u),d.push(this.request(t,"/subscribe",{channel:"/spaceViews/".concat(u)})));for(const u of a)this.spaceViewObservers.has(u)||d.push(this.request(t,"/unsubscribe",{channel:"/spaceViews/".concat(u)}).then(()=>{a.delete(u),this.scheduleCommitObservers()}));for(const u of this.presencePageObservers.keys())o.has(u)||(o.add(u),d.push(this.request(t,"/subscribe",{channel:"/presences/".concat(u)})));for(const u of o)this.presencePageObservers.has(u)||d.push(this.request(t,"/unsubscribe",{channel:"/presences/".concat(u)}).then(()=>{o.delete(u),this.scheduleCommitObservers()}));for(const u of this.sharedPagesObservers.keys())i.has(u)||(i.add(u),d.push(this.request(t,"/subscribe",{channel:"/spaces/".concat(u,"/userSharedPages/").concat(this.userId)})));for(const u of i)this.sharedPagesObservers.has(u)||d.push(this.request(t,"/unsubscribe",{channel:"/spaces/".concat(u,"/userSharedPages/").concat(this.userId)}).then(()=>{i.delete(u),this.scheduleCommitObservers()}));this.notificationsObservers.length>0&&(l||(l=!0,d.push(this.request(t,"/subscribe",{channel:"/users/".concat(this.userId,"/notification")})))),this.notificationsObservers.length===0&&l&&d.push(this.request(t,"/unsubscribe",{channel:"/users/".concat(this.userId,"/notification")}).then(()=>{l=!1,this.scheduleCommitObservers()})),await Promise.all(d)},500);const c=d=>{const u=t6(d.data);this.isNotificationPacket(u)&&this.dispatchNotification(u)};return t.addEventListener("message",c),this.scheduleCommitObservers(),()=>{this.scheduleCommitObservers=Dx,t.removeEventListener("message",c)}}setupHeartbeat(t){let n;return n=setInterval(async()=>{try{await this.ping(t)}catch(s){ixe(s)||t.close(r6)}},this.options.heartbeatIntervalInMs),()=>{clearInterval(n),n=void 0}}setupRequestSender(t){return this.scheduleCommitRequest=Ps(async()=>{if(t.readyState!==WebSocket.OPEN)return;const n=[],s=this.requestData.slice(0);this.requestData=[];for(const a of s)n.push(this.request(t,"/send",a));await Promise.all(n)},0),this.scheduleCommitRequest(),()=>{this.scheduleCommitRequest=Dx}}setupRecover(t){let n=!1;const s=()=>{n=!0},a=()=>{n&&this.throttledDispatchRecover()},o=()=>{t.close(a6)};return window.addEventListener("offline",s),window.addEventListener("online",a),jc.ifvisible.on("idle",o),()=>{window.removeEventListener("offline",s),window.removeEventListener("online",a),jc.ifvisible.off("idle",o)}}async startNewSession(t=!1){const n=new WebSocket(lxe+this.token);this.disposer=()=>{n.close()},await new Promise(s=>{const a=()=>{n.removeEventListener("open",a),s()};n.addEventListener("open",a)}),await this.ping(n),this.retryCount=0,t&&this.throttledDispatchRecover(),await new Promise((s,a)=>{const o=[],i=l=>{n.removeEventListener("close",i);let c=o.pop();for(;c;)c(),c=o.pop();l.code===r6?a(new Error("Heartbeat timeout")):a(new o6(l.code))};n.addEventListener("close",i),o.push(this.setupObservers(n)),o.push(this.setupHeartbeat(n)),o.push(this.setupRecover(n)),o.push(this.setupRequestSender(n))})}dispatchRecover(){console.log("dispatchRecover: ");const t=this,n=function*(a){for(const o of a.values())yield*pf(o)},s=function*(){yield*pf(n(t.tabVisibleObservers))};for(const a of s())a()}dispatchNotification(t){var s,a,o,i,l,c,d,u;if({}.VITE_DISABLE_SYNC||!t.data||t.senderId===Uk)return;const n=f=>{for(const h of f)h(t)};if(t.data.action!=="version")if(t.table==="space"){const f=(s=Df(this.spacePageObservers,t.data.id,()=>new Map).get(null))!=null?s:[];n(f)}else if(t.table==="collectionView"){const f=(a=this.collectionViewObservers.get(t.data.id))!=null?a:[];n(f)}else if(t.table==="block"){const f=(o=this.pageObservers.get(t.data.pageId))!=null?o:[];n(f);const h=[...(i=Df(this.spacePageObservers,t.data.spaceId,()=>new Map).get(t.data.pageId))!=null?i:[],...(l=Df(this.spacePageObservers,t.data.spaceId,()=>new Map).get(null))!=null?l:[]];n(h)}else if(t.table==="spaceView"){const f=(c=this.spaceViewObservers.get(t.data.id))!=null?c:[];n(f)}else if(t.channel.endsWith("/notification")){const{notificationsObservers:f}=this;n(f)}else{if(/presences/.test(t.channel)){const h=t.channel.substring(11,t.channel.length),p=(d=this.presencePageObservers.get(h))!=null?d:[];n(p)}const f=t.channel.match(/\/spaces\/([^/]*)\/userSharedPages\//);if(f&&f[1]){const h=f[1],p=(u=this.presencePageObservers.get(h))!=null?u:[];n(p)}}}subscribePageBlocks(t,n){return this.addToObservers(this.pageObservers,t,n),()=>{this.removeFromObservers(this.pageObservers,t,n)}}subscribeSpaceView(t,n){return this.addToObservers(this.spaceViewObservers,t,n),()=>{this.removeFromObservers(this.spaceViewObservers,t,n)}}subscribeCollectionView(t,n){return this.addToObservers(this.collectionViewObservers,t,n),()=>{this.removeFromObservers(this.collectionViewObservers,t,n)}}subscribeChildPages(t,n,s){const a=Df(this.spacePageObservers,t,()=>new Map);return n6(a,n,s),this.scheduleCommitObservers(),()=>{const o=Df(this.spacePageObservers,t,()=>new Map);s6(o,n,s),o.size===0&&this.spacePageObservers.delete(t),this.scheduleCommitObservers()}}subscribePresencePages(t,n){return this.addToObservers(this.presencePageObservers,t,n),()=>{this.removeFromObservers(this.presencePageObservers,t,n)}}sendPresenceData(t,n,s){if(this.lastPresentData&&this.lastPresentData.pageId===n&&this.lastPresentData.body.blockId===s.blockId&&s.activityTime-this.lastPresentData.body.activityTime<5*60*1e3&&s.present===this.lastPresentData.body.present)return;const a={channel:"/presences/".concat(n),userId:t,body:s,senderId:Uk};this.lastPresentData={...a,pageId:n},this.sendRequestData(a)}subscribeSharedPages(t,n){return this.addToObservers(this.sharedPagesObservers,t,n),()=>{this.removeFromObservers(this.sharedPagesObservers,t,n)}}subscribeTabVisible(t,n){return this.addToObservers(this.tabVisibleObservers,t,n),()=>{this.removeFromObservers(this.tabVisibleObservers,t,n)}}subscribeNotifications(t){return this.notificationsObservers.push(t),()=>{const n=this.notificationsObservers.indexOf(t);n>=0&&this.notificationsObservers.splice(n,1)}}sendRequestData(t){this.requestData.push(t),this.scheduleCommitRequest()}addToObservers(t,n,s){n6(t,n,s),this.scheduleCommitObservers()}removeFromObservers(t,n,s){s6(t,n,s),this.scheduleCommitObservers()}}const hxe=y.createRef(),Hj=()=>gB(hxe,()=>{const e=new mxe,t=K3.subscribe(()=>{const n=yt.uuid,s=eg();n&&(s!=null&&s.startsWith("ey"))&&(t(),e.setUserIdAndToken(n,s))});return e}),rh=()=>{const e=Hj();return y.useCallback((t,n,s=!0)=>{if(pt())return;const{planType:a}=Pn();if(a===St.freePersonal||a===St.pro)return;const o=Date.now();if(!s){e.sendPresenceData(yt.uuid,t,{present:!1,blockId:n,activityTime:o});return}if(!n){e.sendPresenceData(yt.uuid,t,{present:!0,blockId:"",activityTime:o});return}J.blocks[n]&&e.sendPresenceData(yt.uuid,t,{present:!0,blockId:n,activityTime:o})},[e])},$u=(e="all")=>{e==="all"&&re(at.update({selectedBlocks:[],selectedCells:[]})),e==="block"&&re(at.update({selectedBlocks:[]})),e==="cell"&&re(at.update({selectedCells:[]}))},AV=100,zj=()=>{const e={id:0};return{rafY:e,autoScrollY:({y:n,container:s,threshold:a=AV,offset:o})=>{var u,f;const i=s.getBoundingClientRect(),l=a+((u=o==null?void 0:o.top)!=null?u:0),c=a+((f=o==null?void 0:o.bottom)!=null?f:0),d=()=>{if(n-i.top<l){const p=(l-(n-i.top))/10;s.scrollTop-=p,e.id=requestAnimationFrame(d)}if(i.bottom-n<c){const p=(a-(i.bottom-n))/10;s.scrollTop+=p,e.id=requestAnimationFrame(d)}};cancelAnimationFrame(e.id),e.id=requestAnimationFrame(d)}}},RV=()=>{const e={id:0};return{raf:e,autoScroll:(n,s,a,o=AV)=>{const i=a.getBoundingClientRect(),l=()=>{let c=!1;if(n-i.left<o){const d=(n-i.left-o)*10/o;a.scrollLeft+=d,c=!0}if(i.right-n<o){const d=(o-(i.right-n))*10/o;a.scrollLeft+=d,c=!0}if(s-i.top<o){const d=(s-i.top-o)*10/o;a.scrollTop+=d,c=!0}if(i.bottom-s<o){const d=(o-(i.bottom-s))*10/o;a.scrollTop+=d,c=!0}c&&(e.id=requestAnimationFrame(l))};cancelAnimationFrame(e==null?void 0:e.id),e.id=requestAnimationFrame(l)}}},Fa=(e,t)=>{const n=Ce(({collectionViews:a})=>{var o;return(o=a[e])==null?void 0:o.type},[e]),{previewType:s}=Wm(e);return Ce(a=>qj(e,t||{},s,a,n),[e,t,n,s],{ignoreOtherData:!1})},qj=vd.create(dc(e=>e,(e,t)=>t,(e,t,n)=>n,(e,t,n,s)=>s,(e,t,n,s,a)=>a,(e,t,n,s,a)=>{const i=(()=>{var E;const d=gn(e,s.blocks,s.collectionViews);if(!d)return;const{view:u,collection:f,properties:h,timelineTableProperties:p=[],timelineShowTable:g}=d,_=u.type===m.CollectionViewType.TABLE,x=u.type===m.CollectionViewType.FORM,F=u.type===m.CollectionViewType.TIMELINE,b=[h];F&&b.push(p);const w=(E=f.data.schema)!=null?E:{};return b.map((C,k)=>{const T=[],v=[],I=new Set;let j=!1;C.forEach(D=>{const A=w==null?void 0:w[D.property];if(!A){j=!0;return}!t.includeIdNumber&&A.type===m.CollectionSchemaType.ID_NUMBER||I.has(D.property)||(T.push({...D}),I.add(D.property),v.push({...D,name:A.name,type:A.type}))}),Object.entries(w).forEach(([D,A])=>{if(I.has(D)||!t.includeIdNumber&&A.type===m.CollectionSchemaType.ID_NUMBER)return;const P={property:D,visible:D==="title"||_||x,width:_||F&&k===1?kp:void 0};j=!0,I.add(D),T.push(P),v.push({...P,name:A.name,type:A.type})});const S=v.filter(D=>D.type===m.CollectionSchemaType.ID_NUMBER&&!t.includeIdNumber?!1:ot.dataBaseRange==="current"?D.visible:ot.print||D.visible);if(k===1&&g&&S.length===0){j=!0;const D=T.find(P=>P.property==="title");D&&(D.visible=!0);const A=v.find(P=>P.property==="title");A&&(A.visible=!0,S.push({...A,visible:!0}))}if(k===0){const D=T.find(A=>A.property==="title");if(D&&(a===m.CollectionViewType.TABLE||a===m.CollectionViewType.LIST||a===m.CollectionViewType.TIMELINE||a===m.CollectionViewType.CALENDAR||(a===m.CollectionViewType.BOARD||a===m.CollectionViewType.GALLERY)&&n===m.CoverType.NONE)&&!D.visible){const P=v.find(L=>L.property==="title");P&&(j=!0,D.visible=!0,P.visible=!0,S.push({...P,visible:!0}))}}return{newProperties:T,needUpdateProperties:j,sorted:v,collectionId:f.uuid,visibleProperties:S}})})(),[l,c]=i!=null?i:[];return[t.visible?l==null?void 0:l.visibleProperties:l==null?void 0:l.sorted,t.visible?c==null?void 0:c.visibleProperties:c==null?void 0:c.sorted,l,c]}),(e,t,n,s,a)=>[e,t,n,a]),PV=(e,t)=>{var A,P,L;let n=e.target;if(!n||t!=null&&t.pointerCaptured&&(n=document.elementFromPoint(e.clientX,e.clientY),!n)||n.closest("[data-disable-select], [data-draggable]"))return;e.type==="mousedown"&&(window.getSelection().removeAllRanges(),document.dispatchEvent(new Event("_clearTextSelection")));const s=J.ui.selectedCells[0];if(!s)return;const{recordId:a,propertyId:o,viewId:i,groupValue:l}=s;let c='[data-view-id="'.concat(i,'"]');l&&(c+='[data-group-value="'.concat(l,'"]'));let d=n.closest("".concat(c," [data-property-id]")),u=d==null?void 0:d.closest("[data-block-id]");if(!d||!u){const O=document.querySelector(".block-list".concat(c)),$=O==null?void 0:O.querySelectorAll("[data-block-id]");if(!$)return;let M=Number.MAX_SAFE_INTEGER;for(const z of $){const{top:K,bottom:W}=z.getBoundingClientRect(),Y=Math.abs(K-e.clientY);if(Y<M&&(M=Y,u=z),e.clientY>=K&&e.clientY<=W){u=z;break}}if(!u)return;M=Number.MAX_SAFE_INTEGER;const U=u.querySelectorAll("[data-property-id]");for(const z of U){const{left:K,right:W}=z.getBoundingClientRect(),Y=Math.abs(K-e.clientX);if(Y<M&&(M=Y,d=z),e.clientX>=K&&e.clientX<=W){d=z;break}}}if(!d||!u)return;let{sortedRecordIds:f}=Jc({viewId:i,groupValue:l,ignoreSearch:!1,pageId:Ri(),openSubItem:!0});const h=(P=(A=J.blocks[s.recordId])==null?void 0:A.parentId)!=null?P:"";f=By(h,i,f);const{collectionViews:p}=pe(),g=p[i],_=(g==null?void 0:g.type)===m.CollectionViewType.TIMELINE,[x,F]=qj(i,{includeIdNumber:!0},m.CoverType.NONE,J,g==null?void 0:g.type),b=(L=_?F:x)==null?void 0:L.filter(O=>O.visible).map(O=>O.property);if(!b)return;const w=b.findIndex(O=>O===o),E=f.findIndex(O=>O===a),C=d.dataset.propertyId,{blockId:k,syncId:T}=u.dataset,v=t!=null&&t.onlyYAxis?w:b.findIndex(O=>O===C),I=f.findIndex(O=>O===k);if(v===-1||I===-1)return;const j=I>E,S=v>w,D=[];for(let O=E;j?O<=I:O>=I;j?O++:O--)for(let $=w;S?$<=v:$>=v;S?$++:$--){const M=b[$],U=f[O];M&&U&&D.push({propertyId:M,recordId:U,viewId:i,syncId:T,groupValue:l})}re(at.update({selectedCells:D}))},LV=fn.createContext(null);var zn=(e=>(e[e.PROPERTY_LIST=0]="PROPERTY_LIST",e[e.PROPERTY_LIST_TIMELINE_TABLE=1]="PROPERTY_LIST_TIMELINE_TABLE",e[e.TABLE_HEADER=2]="TABLE_HEADER",e[e.PAGE_PROPERTIES=3]="PAGE_PROPERTIES",e[e.FORM_PROPERTIES=4]="FORM_PROPERTIES",e))(zn||{}),gx=(e=>(e.TIMELINE_TABLE="TIMELINE_TABLE",e.TIMELINE="TIMELINE",e))(gx||{});const BV=y.memo(({recordId:e,propertyId:t,className:n})=>{const{collectionId:s,readonly:a}=Ne(),o=Ce(i=>{var u,f,h,p;const{blocks:l}=i,c=(f=(u=l[s])==null?void 0:u.data.schema)==null?void 0:f[t];if((c==null?void 0:c.type)===m.CollectionSchemaType.FORMULA)return $n(s,i).getValue(e,t);const d=fe((p=(h=l[e])==null?void 0:h.data.collectionProperties)==null?void 0:p[t]);return us(d)},[s,e,t]);return r.jsx("div",{style:{padding:6},children:r.jsx("button",{disabled:a,className:R("block text-left",n),style:{width:24,height:24},children:r.jsx(_a,{size:"auto",checked:o})})})}),a2=e=>ft(e,t=>t==null?void 0:t.parentId),_x=e=>{const t=y.useRef();t.current=e,y.useEffect(()=>()=>{t.current.onSave(),setTimeout(t.current.onClose)},[]),y.useLayoutEffect(()=>{t.current.onUpdate()},[])},ki=({children:e,className:t,noWrap:n,...s})=>r.jsx("div",{...s,className:R(t,n?"whitespace-nowrap":"break-words"),children:e}),OV=({className:e,recordId:t,propertyId:n})=>{const{collectionId:s}=Ne();let a=!1;const o=Ce(i=>{var u,f,h,p;const{blocks:l}=i,c=(f=(u=l[s])==null?void 0:u.data.schema)==null?void 0:f[n];if((c==null?void 0:c.type)===m.CollectionSchemaType.FORMULA)return a=!0,$n(s,i).getValue(t,n);const d=(p=(h=l[t])==null?void 0:h.data.collectionProperties)==null?void 0:p[n];return fe(d)},[t,n,s]);return o?a&&o&&/^https?/.test(o.trim())?r.jsx("div",{className:R("p-2 leading-5 break-words"),children:r.jsx("a",{target:"_blank",className:"border-b border-grey5",href:o,children:o})}):r.jsx(ki,{className:R("p-2 leading-5",e),children:o}):null},pxe=({className:e,recordId:t,site:n})=>{const s=ft(t,o=>o==null?void 0:o.updatedAt),a=ue(s).format(On);return r.jsxs(ki,{className:R("p-2 leading-5 w-full group-scope",e),children:[a,r.jsx(jp,{text:a,site:n})]})},gxe=({className:e,recordId:t,site:n})=>{const s=ft(t,o=>o==null?void 0:o.createdAt),a=ue(s).format(On);return r.jsxs(ki,{className:R("p-2 leading-5 w-full group-scope",e),children:[a,r.jsx(jp,{text:a,site:n})]})},_xe=({className:e,recordId:t,propertyId:n,site:s})=>{const{collectionId:a}=Ne(),o=Ce(({blocks:d})=>{var u,f,h;return(h=(f=(u=d[t])==null?void 0:u.data.collectionProperties)==null?void 0:f[n])==null?void 0:h.find(p=>p.type===m.TextType.DATE||p.type===m.TextType.DATETIME)},[t,n]),i=Ce(({blocks:d})=>{var h,p,g;const u=(p=(h=d[a])==null?void 0:h.data.schema)==null?void 0:p[n];if(!u)return;const f=va(d[t],n);if(f)return d3((g=f==null?void 0:f.timestamp)!=null?g:0,u.dateFormat,(f==null?void 0:f.textType)===m.TextType.DATETIME,u.timeFormat)},[t,n,a]),[l,c]=y.useState(!1);return y.useEffect(()=>{const d=YL(o);if(!d)return;const u=d-Date.now();if(u>0){c(!1);let f;return u<1*24*60*60*1e3&&(f=setTimeout(()=>{c(!0)},u)),()=>{f&&clearTimeout(f)}}c(!0)},[o]),!i||!o?null:o.reminder?r.jsxs(ki,{className:R("p-2 leading-5 text-red w-full group-scope",{"line-through text-red/70":l},e),children:[r.jsx("div",{className:"inline-flex items-center",children:r.jsxs("span",{children:[i,r.jsx(V,{name:"IcMenuAlarm",size:"normal",className:R("text-red ml-[2px]",{"text-red/70":l})})]})}),r.jsx(jp,{text:i,site:s})]}):r.jsxs(ki,{className:R("p-2 leading-5 w-full group-scope",e),children:[i,r.jsx(jp,{text:i,site:s})]})},xxe=({recordIds:e,recordId:t,propertyId:n,onUpdate:s,onClose:a})=>{var g,_,x;const o=(g=Km(t,n))!=null?g:[],i=a2(t),l=ur(),c=F=>{l(e!=null?e:t,n,F)},d=o.find(F=>F.type===m.TextType.DATE||F.type===m.TextType.DATETIME),u=eo(i!=null?i:"",n),f=$o(),h=d?ud(d):null,p=(d==null?void 0:d.type)===m.TextType.DATETIME;return _x({onUpdate:s,onClose:a,onSave:()=>{}}),i?r.jsx(J0,{uiOption:{noShadow:!0,hasRemind:!0},dateInfo:{from:h!=null?h:new Date,includeTime:p,dateFormat:(_=u.propertySchema)==null?void 0:_.dateFormat,timeFormat:(x=u.propertySchema)==null?void 0:x.timeFormat,reminder:d==null?void 0:d.reminder},onChange:F=>{var C,k;const{dateFormat:b,timeFormat:w,...E}=F;(b!==((C=u.propertySchema)==null?void 0:C.dateFormat)||w!==((k=u.propertySchema)==null?void 0:k.timeFormat))&&f(i,n,{dateFormat:b,timeFormat:w}),c([Gn(E)])},onClear:()=>{c([]),a()}}):null},yxe=e=>{const t=y.useRef(null),n=ss(),s=ur(),a=nf();return y.useEffect(()=>{const o=t.current;if(o==null)return;const{autoScrollY:i,rafY:l}=zj(),c=d=>{if(d.button!==0)return;d.preventDefault(),d.stopPropagation();const{pointerId:u}=d,f=p=>{p.pointerId===u&&(p.preventDefault(),p.stopPropagation(),PV(p,{onlyYAxis:!0,pointerCaptured:!0}),i({y:p.clientY,container:a.current}))},h=p=>{var E;if(p.pointerId!==u)return;cancelAnimationFrame(l.id),p.preventDefault(),p.stopPropagation(),document.removeEventListener("pointermove",f),document.removeEventListener("pointerup",h);const{selectedCells:g}=n.getState().ui;if(g.length<=1)return;const _=g[0],x=g.slice(1).map(C=>C.recordId).filter(C=>{const{role:k}=mn(C);return Xn(k,m.PermissionRole.WRITER)}),{propertyId:F}=_,b=n.getState().blocks[_.recordId];if(b==null)return;const w=F==="title"?b.data.segments:(E=b.data.collectionProperties)==null?void 0:E[F];s(x,F,w),x.length!==g.length&&n.dispatch(at.update({selectedCells:g.filter((C,k)=>k===0||x.includes(C.recordId))}))};document.addEventListener("pointermove",f),document.addEventListener("pointerup",h)};return o.addEventListener("pointerdown",c),()=>{cancelAnimationFrame(l.id),o.removeEventListener("pointerdown",c)}},[a,n,s]),r.jsx("div",{ref:t,className:R("w-2 h-2 border border-blue_cobalt bg-blue cursor-ns-resize",e.className),onClick:o=>{o.stopPropagation()}})},bxe=y.memo(yxe);class Fxe{constructor(){q(this,"errorOssName",new Set);q(this,"doneErrorOssNames",new Set);q(this,"timer",null)}add(t){this.doneErrorOssNames.has(t)||!yt.uuid||(this.errorOssName.add(t),this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{this.errorOssName.size>0&&(ve.editor.filesPreviewOssProcess.raw({ossNames:[...this.errorOssName]}),this.doneErrorOssNames=new Set([...this.errorOssName,...this.doneErrorOssNames]),this.errorOssName.clear())},1e3))}}const wxe=new Fxe,ah=y.memo(e=>{const{defaultIcon:t,uuid:n,ossName:s}=e,a=Jp(s),{illegal:o}=mt(n),{extName:i}=rn(s);return!s||!i||o?r.jsx(r.Fragment,{children:t}):a?r.jsx(Exe,{...e,extName:rn(a).extName,ossName:a,originOssName:s}):r.jsx(r.Fragment,{children:t})}),Exe=y.memo(e=>{var _;const{uuid:t,defaultIcon:n,className:s,options:a,ossName:o,extName:i}=e,l=!Im.test(i),c=Math.floor((_=a==null?void 0:a.resizeWidth)!=null?_:200),[d,u]=yB(()=>Vs.fetchImageUrl({blockId:t,ossName:o}),[t,o]),f=cr(t),{openImageWatermark:h,imageWatermarkText:p}=Dg(f==null?void 0:f.spaceId);let g=u;return h&&p&&(g=Tm(u,p)),y.useEffect(()=>{var x;d==="fulfilled"&&!g&&((x=a==null?void 0:a.onError)==null||x.call(a))},[a,d,g]),d!=="fulfilled"||!g?r.jsx(r.Fragment,{children:n}):Jt.image.test(i)?r.jsx(i6,{...e,url:l?g:Jo(sm(g,c),i),originSrc:g,className:s,defaultIcon:n,options:a,fileType:"image"}):Jt.video.test(i)?r.jsx(i6,{...e,originSrc:Ak(g),url:Ak(g),className:s,defaultIcon:n,fileType:"video",options:a}):r.jsx(r.Fragment,{children:n})}),i6=e=>{var p;const t=y.useRef(!1),{url:n,className:s,defaultIcon:a,fileType:o,options:i,originOssName:l,originSrc:c,...d}=e,{src:u,error:f}=VK({srcList:n,useSuspense:!1});y.useEffect(()=>{var g;if(f&&l){(g=i==null?void 0:i.onError)==null||g.call(i);const{extName:_}=rn(l);kB(_)&&(t.current=!0,wxe.add(l))}},[f,i,l]);const h=r.jsx(hb,{...kn(d,["uuid","extName","ossName"]),src:"".concat(u),loader:r.jsx(r.Fragment,{children:a}),unloader:r.jsx(r.Fragment,{children:a}),className:R("object-contain object-center",s)});switch(o){case"video":return i!=null&&i.hideVideoIcon||f?h:r.jsxs("div",{className:"relative flex items-center justify-center",children:[h,r.jsx(V,{name:"IcMenuNext",size:(p=i==null?void 0:i.videoPlayIconSize)!=null?p:"normal",className:"absolute text-black-base pointer-events-none"})]});case"image":return i!=null&&i.previewImage?r.jsx($K,{src:c,overlay:i!=null&&i.useOverlayId?{uuid:d.uuid}:{},render:()=>h,children:h}):h;default:return h}},xx=20971520,eu={tasks:[],tasksChange$:new V1},MV=()=>{const e=Uo(),t=ur(),n=nN();return y.useCallback(async(s,a,o)=>{var u;if(eu.tasks.find(f=>f.file===s))return;const i=new QF(0),l=(u=a[0])!=null?u:"",c=qe(),d=await e({key:c,file:s,isDatabase:!0,inTransferList:!0,blockId:a[0],onProgress:f=>{i.next(f)},type:"file",onComplete:async f=>{var F,b;if(HK(eu.tasks,w=>w.file===s),eu.tasksChange$.next(),!f.success)return;i.complete();const h=await n(s),p=Zk({name:s.name,size:s.size,ossName:f.ossName,...h}),{blocks:g}=pe(),_=(b=(F=g[l])==null?void 0:F.data.collectionProperties)==null?void 0:b[o],x=(_!=null?_:[]).filter(w=>w.type===m.TextType.URL&&w.fileStorageType==="internal");x.push(p),t(a,o,x)}});d&&(a.forEach(f=>{eu.tasks.push({file:s,abort:()=>{N0.abort(d)},progress$:i,recordId:f,propertyId:o})}),eu.tasksChange$.next())},[n,t,e])},UV=(e,t)=>nd(()=>eu.tasksChange$.pipe(sd(()=>eu.tasks.filter(n=>n.recordId===e&&n.propertyId===t))),eu.tasks.filter(n=>n.recordId===e&&n.propertyId===t),[e,t]),Cxe=({className:e,recordId:t,propertyId:n,site:s})=>{const a=Km(t,n),o=UV(t,n),i=o2();return r.jsxs("div",{className:R("flex items-center",s===Ye.FIELD&&Mn({selectors:{":empty:before":{content:"'".concat(Wa.isEmpty,"'"),display:"block",fontSize:"14px",padding:"3px",color:"var(--grey4)",lineHeight:"20px"}}}),(s===Ye.CELL||s===Ye.FIELD)&&"p-[5px]",(s===Ye.CELL||s===Ye.FIELD||s===Ye.CARD)&&"flex-wrap",e),children:[(a!=null?a:[]).filter(l=>l.type===m.TextType.URL&&l.fileStorageType==="internal").map((l,c)=>{const d=Jp(l.url),u=r.jsx(md,{label:l.text,color:vr[0].key,className:R("align-middle max-w-[calc(100%-6px)]",(s===Ye.CELL||s===Ye.FIELD)&&"m-[3px]",(s===Ye.CARD||s===Ye.LIST)&&"mr-1 my-0.5 text-t4",s===Ye.CALENDAR&&"mr-1 my-[1px] text-t4",d&&"cursor-pointer"),onClick:async f=>{d&&(f.stopPropagation(),i(t,n,l))}},c);if(d&&(!l.size||l.size<=xx)){const f=Jt.image.test(rn(l.text).extName);return r.jsx(ah,{className:R("h-5 w-5 m-[3px] cursor-pointer border border-grey6 rounded-sm overflow-hidden inline-flex",(s===Ye.CELL||s===Ye.FIELD)&&"m-[3px]",s===Ye.CARD||s===Ye.LIST?"mr-1 my-0.5":"m-[3px]",s===Ye.CALENDAR&&"mr-1 my-[1px]"),uuid:t,ossName:l.url,defaultIcon:u,options:{videoPlayIconSize:"small",resizeWidth:40,previewImage:f},onClick:h=>{h.stopPropagation(),!f&&i(t,n,l)}},c)}return u}),o.length>0&&r.jsx($s,{size:"large"})]})},kxe=({task:e})=>{const t=nd(()=>e.progress$,e.progress$.value,[e]);return r.jsxs("div",{className:"flex items-center h-8 py-1 mx-3 cursor-default text-t2",children:[r.jsx(V,{size:"normal",className:"text-xl leading-none text-grey4 animate-spin",name:"IcNaviLoading"}),r.jsx("span",{className:"flex-1 mx-1 overflow-hidden whitespace-nowrap overflow-ellipsis",children:e.file.name}),r.jsxs("span",{className:"mx-1",children:[t.toFixed(1),"%"]}),r.jsx("button",{className:"flex items-center justify-center w-5 h-5 ml-1 animate-hover",onClick:()=>{e.abort()},children:r.jsx(V,{size:"small",name:"IcClose"})})]})},o2=()=>{const e=ie();return(t,n,s)=>{if(!s.url)return;const{extName:a}=rn(s.text),o=Jt.image.test(a);me.event("file_preview",{file_format:a}),e.modal({modalId:Ve.FILE_PREVIEW,noAnimation:!0,content:()=>o?r.jsx(jxe,{recordId:t,propertyId:n,data:s}):r.jsx(VV,{recordId:t,propertyId:n,data:s})})}},Txe=({recordIds:e,recordId:t,propertyId:n,data:s,onCloseModal:a,setShowInput:o})=>{const i=We(t,!1),l=ur(),c=o2(),{allowDownload:d}=mn(t),u=async(f,h)=>{var g;const p=await Vs.fetchDownloadUrl({blockId:f,ossName:(g=h.url)!=null?g:"<never>",fileName:h.text});cc(p,h.text)};return r.jsx("div",{className:"next-modal w-[200px] rounded-sm py-2",children:r.jsx(ze,{items:[{type:H.OPERATION,isHidden:pt()&&!d,data:{title:"下载",onClick:()=>{a(),u(t,s)}}},{type:H.OPERATION,data:{title:"查看",onClick:()=>{a(),c(t,n,s)}}},{type:H.OPERATION,isHidden:i,data:{title:"重命名",onClick:()=>{a(),o(!0)}}},{type:H.OPERATION,isHidden:i,data:{title:"删除",onClick:()=>{var p,g;a();const{blocks:f}=pe(),h=(g=(p=f[t])==null?void 0:p.data.collectionProperties)==null?void 0:g[n];l(e!=null?e:t,n,h==null?void 0:h.filter(_=>_!==s))}}}]})})},vxe={none:"点击上传，或粘贴/拖入文件",dragging:"拖入文件上传",draggingOver:"松手即可上传文件"},Ixe=({recordIds:e,recordId:t,propertyId:n})=>{const s=We(t,!1),a=Km(t,n),o=(a!=null?a:[]).filter(p=>p.type===m.TextType.URL&&p.fileStorageType==="internal"),i=UV(t,n),l=MV(),c=ur(),[d,u]=y.useState("none"),f=y.useRef(null);y.useEffect(()=>{const p=f.current,g=p==null?void 0:p.parentElement;if(!(g==null?void 0:g.parentElement)||!g||!p)return;const x=E=>{E.target instanceof HTMLElement&&(g.contains(E.target)?u("draggingOver"):u("dragging"))},F=E=>{E.clientX===0&&E.clientY===0&&u("none")},b=()=>u("none"),w=E=>{var C;if((C=E.clipboardData)!=null&&C.files.length){const{files:k}=E.clipboardData;[...k].forEach(T=>{l(T,e!=null?e:[t],n)})}};return document.addEventListener("dragenter",x),document.addEventListener("dragleave",F),document.addEventListener("drop",b),document.addEventListener("paste",w),()=>{document.removeEventListener("dragenter",x),document.removeEventListener("dragleave",F),document.removeEventListener("drop",b),document.removeEventListener("paste",w)}},[]);const h=o.length<=0&&i.length<=0;return r.jsxs("div",{className:"pt-1",children:[!s&&r.jsx(Fe,{popup:"支持多选，你也可以拖放文件到这里来上传",className:R(d!=="none"&&"h-[140px]"),children:r.jsxs(pv,{ref:f,className:R("relative flex items-center w-full animate-hover rounded-none",d==="none"?"h-10 px-3 py-2":"m-2.5 flex-col justify-center rounded",d==="draggingOver"&&"bg-active_color_10 border-active_color border border-dashed"),multiple:!0,onSelect:p=>{[...p].forEach(g=>{l(g,e!=null?e:[t],n)})},children:[r.jsx(V,{className:R(d==="none"?"mr-1":"mb-2 text-grey3"),name:d==="none"?"IcAdd":"IcBtnUpload",size:d==="none"?"middle":"large"}),r.jsx("span",{className:"text-t2 text-grey3",children:[vxe[d]]})]})}),h&&r.jsx("div",{className:"text-t2 text-grey3 p-2",children:"无文件"}),r.jsx("div",{className:R("max-h-[438px] overflow-auto py-2 border-b-[1px]",h&&"hidden",d!=="none"&&"hidden"),children:r.jsxs("div",{className:"w-[260px]",children:[r.jsx(Og,{children:r.jsx(br,{disabled:s,items:o.map(p=>{var g;return{id:(g=p.url)!=null?g:"<never>",data:p}}),onChange:p=>{c(t,n,p.map(g=>g.data))},renderItemContent:({item:{data:p},renderDragHandle:g})=>r.jsx(Nxe,{data:p,renderDragHandle:g,recordId:t,recordIds:e,propertyId:n})})}),r.jsx("div",{children:i.map((p,g)=>r.jsx(kxe,{task:p},g))})]})})]})},Nxe=({data:e,renderDragHandle:t,recordIds:n,recordId:s,propertyId:a})=>{const o=Jp(e.url),i=o2(),l=ie(),[c,d]=y.useState(!1),{name:u,extName:f}=rn(e.text),[h,p]=y.useState(u),g=ur(),_=F=>{l.dropdown({popcorn:F.target,placement:"right",content:Txe,contentProps:{recordIds:n,recordId:s,propertyId:a,data:e,setShowInput:d}})},x=()=>{var C,k,T;const{blocks:F}=pe(),E=((T=(k=(C=F[s])==null?void 0:C.data.collectionProperties)==null?void 0:k[a])!=null?T:[]).filter(v=>v.type===m.TextType.URL&&v.fileStorageType==="internal").map(v=>({...v,text:v.url===e.url&&h.trim()?mI(h,f):v.text}));g(s,a,E),d(!1)};return r.jsxs("div",{className:"flex flex-col px-3 bg-white2 cursor-pointer animate-hover-opaque",children:[r.jsxs("div",{className:"flex items-center w-full h-8",children:[t({className:"flex items-center justify-center w-5 h-5 text-grey4"}),c?r.jsx(Ct,{selection:[0,e.text.length],onEnter:x,className:"h-8 w-full max-w-[360px]",autoFocus:!0,value:h,onBlur:x,onChange:F=>p(F)}):r.jsxs(r.Fragment,{children:[r.jsxs("span",{className:"flex items-center flex-1 min-w-0 mx-1",onClick:()=>{Jt.image.test(f)||i(s,a,e)},children:[r.jsx(V,{className:"mr-1",size:"middle",name:"IcTitleFiles"}),r.jsx("span",{title:e.text,className:"flex-1 min-w-0 overflow-hidden text-t2 whitespace-nowrap overflow-ellipsis",children:e.text})]}),r.jsx("button",{className:"flex items-center justify-center w-5 h-5 ml-1 text-grey3 animate-hover",onClick:_,children:r.jsx(V,{size:"normal",className:"w-5 h-5",name:"IcMore"})})]})]}),o&&(!e.size||e.size<=xx)&&r.jsx("div",{className:"w-full cursor-pointer flex justify-center",onClick:F=>{F.stopPropagation(),!Jt.image.test(f)&&i(s,a,e)},children:r.jsx(ah,{className:"max-h-[200px] mb-2",uuid:s,ossName:e.url,defaultIcon:r.jsx(r.Fragment,{}),options:{resizeWidth:300,videoPlayIconSize:"xxlarge",previewImage:Jt.image.test(f)}})})]})},pv=y.forwardRef((e,t)=>{const{multiple:n,accept:s,className:a,children:o,onSelect:i}=e,[l,c]=y.useState(0);return r.jsxs("div",{className:a,children:[o,r.jsx("input",{ref:t,type:"file",multiple:n,accept:s,className:Mn({display:"block",position:"absolute",left:0,top:0,cursor:"pointer",opacity:0,width:"100%",height:"100%",selectors:{"::file-selector-button":{position:"absolute",cursor:"pointer",display:"block",width:"100%",height:"100%"}}}),onChange:d=>{d.target.files&&(i==null||i(d.target.files),c(u=>(u+1)%2))}},l)]})}),jxe=({recordId:e,propertyId:t,data:n})=>{const s=y.useMemo(()=>ks(e),[e]),a=y.useMemo(()=>{var p,g,_;if(!s)return[];const u=[],f=(_=(g=(p=J.blocks[e])==null?void 0:p.data.collectionProperties)==null?void 0:g[t])!=null?_:[],h=f==null?void 0:f.filter(x=>{const{extName:F}=rn(x.text);return Jt.image.test(F)});return u.push(...h),u},[s,t,e]),[o,i]=y.useState(a.findIndex(u=>In(u,n))),l=y.useCallback(()=>{i(u=>u===0?(be.warning("当前为第一张"),u):u-1)},[]),c=y.useCallback(()=>{i(u=>u===a.length-1?(be.warning("当前为最后一张"),u):u+1)},[a.length]);y.useEffect(()=>{const u=h=>{Ie("ArrowLeft")(h)?l():Ie("ArrowRight")(h)&&c()};return Ht.addEventListener("keydown",u)},[c,l]);const d=a[o];return d?r.jsxs("div",{children:[r.jsx(VV,{recordId:e,data:d}),a.length>1&&r.jsxs(r.Fragment,{children:[r.jsx(Fe,{popup:"上一张",className:"cursor-pointer absolute left-0 pl-2 top-[50%]",children:r.jsx(V,{name:"MIcBtnPre",size:"xxxlarge",onClick:u=>{u.stopPropagation(),l()}})}),r.jsx(Fe,{popup:"下一张",className:"cursor-pointer absolute right-0 pr-2 top-[50%]",children:r.jsx(V,{name:"MIcBtnNext",size:"xxxlarge",onClick:u=>{u.stopPropagation(),c()}})})]})]}):null},VV=({recordId:e,propertyId:t,data:n})=>{var f;const[s,a]=y.useState(),{extName:o}=rn(n.text),i=VU(o),{openImageWatermark:l,imageWatermarkText:c}=Dg((f=J.blocks[e])==null?void 0:f.spaceId);let d=s;d&&l&&c&&eh(o)==="image"&&(d=Tm(d,c));const u=ln();return y.useEffect(()=>{n.url&&Vs.fetchDownloadUrl({blockId:e,ossName:n.url,fileName:n.text}).then(h=>{const p=Jo(h,o);a(p)})},[n.text,n.url,o,e]),s?r.jsx(yd,{scope:CN,initialValues:[[kN,{uuid:e,editor:!1}]],children:r.jsxs("div",{className:"fixed top-0 bottom-0 left-0 right-0 bg-black-base/80",children:[r.jsxs("div",{className:"absolute top-0 left-0 z-10 flex items-center justify-end space-x-5 w-screen h-[55px] pr-5",style:{background:"linear-gradient(black, transparent)"},children:[r.jsx(SV,{extName:o}),r.jsx("div",{className:"text-white text-t2 animate-click",onClick:()=>u(Ve.FILE_PREVIEW),children:"关闭"})]}),r.jsx("div",{className:"flex items-center justify-center absolute top-[55px] bottom-0 w-screen",onClick:h=>h.target===h.currentTarget&&u(Ve.FILE_PREVIEW),children:r.jsx(i,{recordId:e,uuid:e,downloadUrl:s,propertyId:t})})]})}):null},Pp=e=>{const{className:t,shortcut:n}=e;return r.jsxs("span",{className:R("text-grey3 text-t4-medium",t),children:[Ds,"+",n]})};const $V=["prop",...Rr.flatMap(AN,e=>e.list).map(e=>e.title)];Zi.defineSimpleMode("formula",{start:[{regex:/"([^\\"]|\\.)*"?/,token:"string"},{regex:/\b(?:pi|e|true|false)\b/,token:"atom"},{regex:/(?:0|[1-9][0-9]*)(?:[.][0-9]+)?(?:[eE][+-]?(?:0|[1-9][0-9]*))?/,token:"number"},{regex:new RegExp("\\b(?:".concat($V.join("|"),")\\b")),token:"builtin"},{regex:/\b(?:[A-Za-z_][A-Za-z0-9_]*)\b/,token:"variable"}]});const HV=e=>{var i,l,c,d;const t=e.getDoc(),n=t.getValue();let s=t.indexFromPos(e.getCursor()),a="";if(/[A-Za-z0-9_]/.test((i=n[s])!=null?i:""))return null;for(;s>0;){const u=(l=n[s-1])!=null?l:"";if(!/[A-Za-z0-9_]/.test(u))break;a=u+a,s-=1}if(a===""||/[0-9]/.test(a.charAt(0)))return null;let o=0;for(;o<s;){const u=n.slice(o).indexOf('"'),f=o+u;if(u===-1||s<=f)break;const h=/^"([^"\\]|\.)*"/.exec(n.slice(f)),p=h==null?n.length:f+h.index+((d=(c=h[0])==null?void 0:c.length)!=null?d:0);if(s<p)return null;o=p}return{cursor:s,word:a}},zV=y.forwardRef((e,t)=>{var l;const n=Pa(),s=y.useRef(null),a=xB(e),o=y.useRef();y.useImperativeHandle(t,()=>({cm(){return o.current}})),y.useEffect(()=>{const c=s.current;if(!c)return;const{initialValue:d,placeholder:u,readOnly:f=!1,autoFocus:h=!1}=a.current,p=Zi(c,{value:d,mode:"formula",autoRefresh:!0,viewportMargin:1/0,autoCloseBrackets:!0,placeholder:u,readOnly:f,lineWrapping:!0,highlightSelectionMatches:{showToken:/\w/,annotateScrollbar:!0},matchTags:{bothTags:!0},matchBrackets:{strict:!0},theme:n?"ayu-dark":"default"});if(o.current=p,h){p.focus();const w=p.getDoc();p.setCursor(w.posFromIndex(1/0))}p.on("beforeChange",(w,E)=>{});const g=document.createElement("span");g.className="widget-autocomplete";let _=null,x=null,F=null;const b=()=>{g.innerText="",x==null||x.clear(),x=null,_=null,F=null};return p.on("change",w=>{w.startOperation(),b(),_=w.getCursor();const E=HV(w),C=E==null?void 0:E.word;if(C){const k=$V.find(T=>T.startsWith(C));k&&k!==C&&(F=k.slice(C.length),x=w.setBookmark(_,{widget:g,insertLeft:!0}),g.innerText=F)}w.endOperation()}),p.on("changes",()=>{var w,E;(E=(w=a.current).onChange)==null||E.call(w)}),p.on("cursorActivity",w=>{const E=w.getCursor();_!=null&&(E.line!==_.line||E.ch!==_.ch)&&b()}),p.on("keydown",(w,E)=>{_!=null&&F!=null&&(Ie("tab")(E)||Ie("right")(E))&&(w.replaceRange(F,_,_,"+input"),E.preventDefault())}),()=>{const w=new Range;w.selectNodeContents(c),w.deleteContents()}},[n,a]);const{className:i}=e;return r.jsx("div",{ref:s,className:R(i,Mn({selectors:{"& div.CodeMirror":{height:"auto",background:"transparent",color:"var(--black)"},".CodeMirror-wrap pre":{wordBreak:"break-word"},"& div.CodeMirror-scroll":{maxHeight:e.maxHeight},"& .widget-autocomplete":{color:"var(--grey3)"},"& .CodeMirror-empty":{color:"var(--grey4)"},"& .CodeMirror-cursor":{borderLeftWidth:"1px !important",display:(l=e.readOnly)!=null&&l?"none !important":void 0},"& .CodeMirror-focused .CodeMirror-selected":{background:"var(--selection) !important"},"& .CodeMirror-line::selection, & .CodeMirror-line > span::selection, & .CodeMirror-line > span > span::selection":{background:"var(--selection) !important"},"& .CodeMirror pre.CodeMirror-line, & .CodeMirror pre.CodeMirror-line-like":{fontFamily:'SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace'},"& .cm-mark-error":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",backgroundImage:'url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAYAAAC09K7GAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sJDw4cOCW1/KIAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAHElEQVQI12NggIL/DAz/GdA5/xkY/qPKMDAwAADLZwf5rvm+LQAAAABJRU5ErkJggg==")'},"& .CodeMirror-matchingbracket":{outline:"1px solid var(--grey4)"}}}))})}),l6=AN,Sxe=({className:e,search:t,recordId:n,propId:s,onComplete:a})=>{var h,p,g,_;const o=(h=a2(n))!=null?h:"",[i,l]=y.useState(null),c=ft(o,x=>x==null?void 0:x.data.schema),d=$n(o),u=y.useMemo(()=>{const x=d.getAvailablePropIds(s),F={groupEn:"Properties",groupCn:"属性",list:Rr.uniqBy(Object.entries(c!=null?c:{}).filter(([w])=>x.has(w)).map(([w,E])=>{const C=(()=>{let{type:T}=E;switch(T===m.CollectionSchemaType.FORMULA&&(T=d.getTypeAsCollectionSchemaType(w)),T){case m.CollectionSchemaType.NUMBER:return"number";case m.CollectionSchemaType.TEXT:return"string";case m.CollectionSchemaType.CHECKBOX:return"boolean";case m.CollectionSchemaType.DATE:case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:return"date";default:return"string"}})(),k=d.getValue(n,w);return{title:E.name,resultType:C,description:"获取当前记录的“".concat(E.name,"”属性"),descriptionEn:"获取当前记录的“".concat(E.name,"”属性"),syntax:"prop(".concat(JSON.stringify(E.name),")"),examples:k==null?"empty(prop(".concat(JSON.stringify(E.name),")) == true"):"prop(".concat(JSON.stringify(E.name),") == ").concat(C==="date"?"fromTimestamp(".concat(k.getTime(),")"):JSON.stringify(k))}}),w=>w.title)};if(t==null)return[F,...l6];const b=t.toLowerCase();return[F,...l6].map(w=>({...w,list:w.groupEn==="Properties"&&b==="prop"?w.list:w.list.filter(E=>E.title.toLowerCase().includes(b))})).filter(w=>w.list.length>0)},[d,s,n,c,t]),f=i?(g=Rr.flatMap(u,x=>x.list).find(x=>x.title===i))!=null?g:(p=u[0])==null?void 0:p.list[0]:(_=u[0])==null?void 0:_.list[0];return r.jsxs("div",{className:R(e,"flex min-h-0 text-t2"),children:[r.jsx("div",{className:"h-full relative overflow-auto w-[180px] border-r border-grey6",children:u.map(x=>r.jsxs("dl",{children:[r.jsx("dt",{className:"h-7 leading-7 mx-1 px-1 text-grey3 sticky top-0 z-10 bg-white1",children:x.groupCn}),x.list.map(F=>r.jsxs("dd",{className:R("mx-1 px-2 h-7 animate-hover flex items-center",F===f&&"bg-black_006"),onPointerEnter:()=>{l(F.title)},onPointerDown:b=>{var w;((w=document.activeElement)==null?void 0:w.closest(".formula-editor"))!=null&&b.preventDefault()},onClick:()=>{const b=x.groupEn==="Properties"?"property":x.groupEn==="Constants"?"constant":"function";a==null||a(b,F.title)},children:[r.jsx(V,{size:"middle",className:"text-grey3",name:F.resultType==="number"?"IcTitleNum":F.resultType==="string"?"IcTitleText":F.resultType==="boolean"?"IcTitleCheckbox":F.resultType==="date"?"IcTitleDate":"IcTitleText"}),r.jsx("div",{className:"ml-2 flex-1 min-w-0 text-ellipsis",children:F.title})]},F.title))]},x.groupEn))}),r.jsx("div",{className:"h-full overflow-auto flex-1 p-3",children:f&&r.jsxs("article",{className:"allow-text-selection",children:[r.jsx("h1",{className:"text-h3 mt-1 mb-3",children:f.title}),r.jsx("p",{className:"text-t3 my-2",children:f.description}),r.jsxs("section",{className:R(!f.syntax&&"hidden"),children:[r.jsx("h2",{className:"text-t3-bold my-2",children:"语法"}),r.jsx("pre",{className:"rounded text-t3 whitespace-pre-wrap break-words text-mono py-1.5 px-2.5 bg-grey6",children:r.jsx("code",{children:f.syntax})})]}),r.jsxs("section",{className:R(!f.examples&&"hidden"),children:[r.jsx("h2",{className:"text-t3-bold my-2",children:"示例"}),r.jsx(zV,{readOnly:!0,className:"rounded text-t3 py-1.5 px-2.5 bg-grey6",initialValue:f.examples},f.title)]})]})})]})},Dxe=({className:e,propertyId:t,recordId:n})=>{const{collectionId:s}=Ne(),a=Ce(o=>$n(s,o).getValue(n,t),[],{equal:hB(lJ(Hr(o=>o.getTime())))});return a==null?null:r.jsx(ki,{className:R("p-2 leading-5",e),children:ue(a).format(On)})},Axe=e=>{const{collectionId:t}=Ne(),{propertyId:n}=e,s=Ce(a=>$n(t,a).getType(n),[t,n]);return s===et.ValueTool.numberType?r.jsx(M8,{...e}):s===et.ValueTool.stringType?r.jsx(OV,{...e}):s===et.ValueTool.booleanType?r.jsx(BV,{...e}):s===et.ValueTool.dateType?r.jsx(Dxe,{...e}):null},Rxe=({propertyId:e,recordId:t,onClose:n,viewId:s})=>{var E,C;const a=(E=a2(t))!=null?E:"",o=$n(a),i=We(a),l=(C=$0(s))!=null?C:a,c=Tl(l),d=i||c,u=ft(a,k=>{var v,I;const T=(I=(v=k==null?void 0:k.data.schema)==null?void 0:v[e])==null?void 0:I.formula;return T==null?"":o.fromServer(T)}),f=y.useRef(),[h,p]=y.useState(null),g=y.useRef(),[_,x]=y.useState(null),F=Oe(),b=()=>{if(f.current==null||(_==null?void 0:_.type)!=="preview")return;const k=f.current.cm().getValue();F(()=>{var S;const{blocks:T}=pe(),v=T[a];if(!v)return;const j=((S=v.data.schema)!=null?S:{})[e];j&&EI(v.uuid,{[e]:{...j,formula:o.toServer(k)}})}),n()},w=fJ(()=>{if(f.current==null)return;const k=f.current.cm(),T=HV(k);p(T);const v=S=>{if(x(S),g.current!=null&&(g.current.clear(),g.current=void 0),S!=null&&S.type==="error"){const D=k.getDoc();g.current=k.markText(D.posFromIndex(S.pos.pmin),D.posFromIndex(S.pos.pmax),{className:"cm-mark-error"})}},I=k.getValue();if(I===""){v(null);return}const j=o.validate(I,t,e);v(j)});return y.useEffect(()=>{w()},[w]),r.jsxs("div",{className:R("bg-white1 flex flex-col",Mn({minWidth:"180px",width:"580px",height:d?"48px":"400px",maxWidth:"calc(100vw - 24px)",maxHeight:"70vh"})),children:[r.jsxs("div",{className:"flex items-start max-h-[180px] formula-editor",onKeyDown:k=>{k.stopPropagation(),Ie("mod+enter")(k)&&(_==null?void 0:_.type)!=="error"&&b()},children:[r.jsx(zV,{ref:f,className:"flex-1 min-w-0 mx-2.5 my-2 text-t2 border border-grey6 bg-grey9 focus-within-border rounded-sm box-border",autoFocus:!0,placeholder:"输入公式",initialValue:u,maxHeight:"162px",readOnly:d,onChange:w}),!d&&r.jsx(De,{colorType:"active",className:"my-2 mr-2.5",onClick:b,disable:(_==null?void 0:_.type)==="error",children:"提交"})]}),!d&&r.jsxs(r.Fragment,{children:[r.jsx(Sxe,{className:"border-t border-grey6 flex-1",search:h==null?void 0:h.word,recordId:t,propId:e,onComplete:(k,T)=>{var D,A;const v=(D=f.current)==null?void 0:D.cm();if(v==null)return;k==="function"?T+="(":k==="property"&&(T="prop(".concat(JSON.stringify(T),")"));const I=v.getDoc(),j=(A=h==null?void 0:h.cursor)!=null?A:I.indexFromPos(I.getCursor()),S=h==null?j:j+h.word.length;v.replaceRange(T,I.posFromIndex(j),I.posFromIndex(S),"+input")}}),r.jsxs("div",{className:"h-8 text-t2 flex items-center border-t border-grey6",children:[r.jsxs("span",{className:"flex-1 mx-3 text-ellipsis",children:[(_==null?void 0:_.type)==="preview"&&r.jsxs("span",{children:["预览结果：",_.preview]}),(_==null?void 0:_.type)==="error"&&r.jsx("span",{className:"text-red flex-1",children:_.message})]}),r.jsx(Pp,{className:"mr-3",shortcut:"Enter可快捷提交"})]})]})]})},Gj=e=>{const t=y.useRef(null);return y.useEffect(()=>{const n=t.current;n&&n.setSelectionRange(n.value.length,n.value.length)},[]),r.jsx(oi,{fontClassName:"whitespace-pre-wrap",ref:t,...e})},Pxe=({value:e,onChange:t})=>r.jsx(Gj,{autoFocus:!0,value:e,onChange:n=>{t(n.target.value)}});function Wj({useValue:e,useSaveValue:t,ValueEditor:n}){return({site:a,recordId:o,recordIds:i,propertyId:l,onUpdate:c,onClose:d})=>{const u=e({recordId:o,propertyId:l}),[f,h]=y.useState(u),p=t({recordId:i!=null?i:o,propertyId:l}),g=y.useRef(!1),_=()=>{g.current&&p(f)};return _x({onUpdate:c,onClose:d,onSave:_}),r.jsx("div",{className:"px-2 text-t2 py-[9px] min-w-full leading-[20px]",onKeyDown:x=>{Ie("shift+enter")(x)||(Ie("enter")(x)?(x.preventDefault(),_(),d()):Ie("esc")(x)&&d())},children:r.jsx(n,{site:a,value:f,onChange:x=>{g.current=!0,h(x)}})})}}const Lxe=Wj({useValue:({recordId:e,propertyId:t})=>Ce(({blocks:s})=>{var o,i;const a=(i=(o=s[e])==null?void 0:o.data.collectionProperties)==null?void 0:i[t];return fe(a)},[e,t]),useSaveValue:({recordId:e,propertyId:t})=>{const n=ur();return s=>{n(e,t,ht(s))}},ValueEditor:Pxe}),Kj=e=>({className:t,recordId:n,propertyId:s,site:a})=>{const{collectionId:o}=Ne(),i=o2(),l=Ce(({blocks:u})=>{var h,p;const f=(p=(h=u[n])==null?void 0:h.data.collectionProperties)==null?void 0:p[s];return Oi(f)},[n,s]),c=Ce(({blocks:u})=>{var f,h,p;return(p=(h=(f=u[o])==null?void 0:f.data.schema)==null?void 0:h[s])==null?void 0:p.fullUrl},[n,s]),d=We(n,!1);return l?r.jsxs("div",{className:R("group-scope w-full overflow-hidden leading-[20px]",a===Ye.LIST&&"flex",(a===Ye.CELL||a===Ye.FIELD)&&"p-2 break-all",(a===Ye.LIST||a===Ye.CALENDAR)&&"overflow-ellipsis",t),children:[ot.print?r.jsx("a",{href:Rp(l),target:"_blank",className:"underline",children:c?l:JS(l)}):r.jsx("span",{className:R("border-grey5 cursor-pointer border-b text-black",(a===Ye.CARD||a===Ye.LIST||a===Ye.CALENDAR)&&"animate-hover hover:rounded-sm"),onClick:u=>{(d||a===Ye.CARD||a===Ye.LIST)&&(u.stopPropagation(),window.open(e.getLinkUrl(l)))},children:c?l:JS(l)}),r.jsxs("div",{className:"flex space-x-1 group-scope-hover:opacity-100 absolute right-[5px] top-[5px] opacity-0 transition-opacity",children:[r.jsx("a",{className:"rounded border bg-white1 p-0.5 animate-hover animate-click",href:e.getLinkUrl(l),target:"_blank",hidden:!((a===Ye.CELL||a===Ye.FIELD)&&e.validate(l)),rel:"noopener noreferrer",onClick:u=>{var g,_;u.stopPropagation();const{blocks:f}=pe(),h=(_=(g=f[n])==null?void 0:g.data.collectionProperties)==null?void 0:_[s],p=h==null?void 0:h.find(x=>x.type===m.TextType.URL);p&&p.fileStorageType==="internal"&&(u.preventDefault(),i(n,s,p))},children:r.jsx(Fe,{popup:e.tooltip,children:r.jsx(V,{size:"middle",name:e.icon,className:"text-grey3"})})}),r.jsx("span",{onClick:u=>{u.stopPropagation(),Xt(l)},className:"rounded border bg-white1 p-0.5 animate-hover animate-click",hidden:![Ye.CELL,Ye.FIELD].includes(a),children:r.jsx(Fe,{popup:"复制",children:r.jsx(V,{size:"middle",name:"IcMenuCopy",className:"text-grey3"})})})]})]}):null},i2=e=>t=>e===m.CollectionSchemaType.EMAIL?"mailto:".concat(t):e===m.CollectionSchemaType.PHONE?"tel:".concat(t):Rp(t),Bxe=Kj({icon:"IcTitleUrl",tooltip:"访问链接",validate:e=>e.trim()!=="",getLinkUrl:i2(m.CollectionSchemaType.URL)}),Oxe=Kj({icon:"IcTitleEmail",tooltip:"发送邮件",validate:e=>pb(e),getLinkUrl:i2(m.CollectionSchemaType.EMAIL)}),Mxe=Kj({icon:"IcTitlePhone",tooltip:"拨打电话",validate:e=>r8(e),getLinkUrl:i2(m.CollectionSchemaType.PHONE)}),LC=Wj({useValue:({recordId:e,propertyId:t})=>Ce(({blocks:s})=>{var o,i;const a=(i=(o=s[e])==null?void 0:o.data.collectionProperties)==null?void 0:i[t];return Oi(a)},[e,t]),useSaveValue:({recordId:e,propertyId:t})=>{const n=ur();return s=>{n(e,t,s?[{type:m.TextType.URL,enhancer:{},text:s,url:s}]:void 0)}},ValueEditor:({value:e,onChange:t})=>r.jsx(Gj,{autoFocus:!0,singleLine:!0,value:e,fontClassName:"whitespace-nowrap",onChange:n=>{t(n.target.value)}})}),c6=e=>{var n,s;let t=parseFloat(e);return Number.isNaN(t)&&(t=parseFloat((s=(n=e.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:n[0])!=null?s:"")),Number.isNaN(t)?"":"".concat(a8(t))},Uxe=Wj({useValue:({recordId:e,propertyId:t})=>Ce(({blocks:s})=>{var o,i;const a=(i=(o=s[e])==null?void 0:o.data.collectionProperties)==null?void 0:i[t];return c6(fe(a))},[e,t]),useSaveValue:({recordId:e,propertyId:t})=>{const n=ur();return s=>{n(e,t,ht(c6(s)))}},ValueEditor:({site:e,value:t,onChange:n})=>r.jsx(Gj,{autoFocus:!0,singleLine:!0,value:t,className:R({"text-right":e!==Ye.FIELD}),fontClassName:"whitespace-nowrap",onChange:s=>{n(s.target.value)}})}),Vxe=({recordIds:e,recordId:t,propertyId:n,onUpdate:s,onClose:a})=>{const o=We(t,!1),i=Km(t,n);LM();const l=y.useRef(null),[c,d]=y.useState(""),u=ur();_x({onUpdate:s,onClose:a,onSave:()=>{}});const f=b=>{u(e!=null?e:t,n,b)},h=b=>{const w=ru(i);w.findIndex(E=>E.uuid===b)===-1&&(w.push(Ru(b)),f(w))},p=()=>{const b=ru(i);b.length>0&&(b.pop(),f(b))},g=b=>{var C;const w=ru(i),E=w.findIndex(k=>k.uuid===b);E>=0&&(w.splice(E,1),f(w),(C=l.current)==null||C.focus())},_=b=>{var w;d(""),h(b),(w=l.current)==null||w.focus()},x=b=>{if(Ie("Esc")(b)){a();return}!c&&Ie("Backspace")(b)&&p()},F=M0();return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex min-h-[42px] min-w-[260px] max-w-[480px] flex-wrap items-center px-2",children:[ru(i).map(b=>{var w;return r.jsx(wE,{userId:(w=b.uuid)!=null?w:"",showClose:!0,onClose:()=>{b.uuid&&g(b.uuid)}},b.uuid)}),!o&&r.jsx(oi,{ref:l,autoFocus:!0,singleLine:!0,placeholder:"搜索成员",fontClassName:Mn({lineHeight:"24px",fontSize:14,whiteSpace:"nowrap"}),className:Mn({width:"100%",selectors:{"&::placeholder":{color:"var(--grey4)"}}}),boxClassName:Mn({flexBasis:"auto",flexGrow:1,flexShrink:0,minWidth:120,maxWidth:"100%"}),value:c,onKeyDown:x,onChange:b=>{d(b.target.value)}})]}),r.jsx(Cr,{}),r.jsx(Yj,{className:"py-1.5",search:c,users:F,onSelectPerson:_})]})},Yj=({className:e,users:t,value:n,search:s,onSelectPerson:a,customHeader:o})=>{const i=y.useMemo(()=>lc(t,s).map(l=>({type:H.OPERATION,data:{content:r.jsx(si,{className:"!px-0",userId:l.uuid}),value:l.uuid,onClick:()=>{a==null||a(l.uuid)}}})),[a,s,t]);return r.jsx(ze,{customHeader:o,customFooter:r.jsx(r.Fragment,{children:i.length<=0&&r.jsx("div",{className:"text-t2 relative flex h-10 items-center justify-center text-grey4",children:"没有找到相关结果"})}),className:R("text-t2 max-h-[50vh] overflow-y-auto",e),defaultActiveIndex:i.findIndex(l=>l.data.value===n),items:i})},$xe=new zK.diff_match_patch;function BC(e,t){return e===void 0?t:t===void 0?e:[...e,...t]}function Xy(e,t){const n=d=>{if(d!==void 0)return d.map(u=>({...u,enhancer:{...u.enhancer,backgroundColor:"var(--active_color-10)",textColor:"var(--active_color-80)"}}))},s=d=>{if(d!==void 0)return d.map(u=>({...u,enhancer:{...u.enhancer,lineThrough:!0,textColor:"#B3B3B3"}}))},a=d=>(d!=null?d:[]).reduce((u,f)=>(f.type===m.TextType.TEXT?u+=f.text:u+=" ",u),""),o=(d,u,f)=>{const h=[];let p=0;const g=f,_=f+d.length;for(const x of u!=null?u:[])if(x.type===m.TextType.TEXT){const F=p,b=p+x.text.length;p=b;const w=Math.max(F,g),E=Math.min(b,_);E-w>0&&h.push({...x,text:d.slice(w-g,E-g)})}else{const F=p,b=p+1;p=b;const w=Math.max(F,g);Math.min(b,_)-w>0&&h.push(x)}return h},i=a(e),l=a(t);let c;try{const d=$xe.diff_main(i,l);let u=0,f=0;for(const h of d){const[p,g]=h;if(p<0){let _=o(g,e,u);_=s(_),c=BC(c,_),u+=g.length}else if(p>0){let _=o(g,t,f);_=n(_),c=BC(c,_),f+=g.length}else{const _=o(g,t,f);c=BC(c,_),u+=g.length,f+=g.length}}}catch(d){}return c}const oh=({className:e,isTitle:t=!1,segmentsA:n,segmentsB:s})=>{const a=Xy(n,s);return r.jsx(fs,{className:R("leading-[20px] text-t2",e),plugins:t?oa:void 0,segments:a,interactable:!1})},Qy=new Map,Hxe=()=>{Qy.clear()},La=(e,t)=>{const n=Nn(),s=Nr(),a=t!=null?t:"segments",o=Oe(),i=y.useCallback(function*(f){yield a==="caption"?f.data.caption:a==="description"?f.data.description:f.data.segments},[a]),l=y.useRef(),c=y.useRef(zc),d=y.useMemo(()=>Ps(f=>{var F,b,w;const h=l.current,p=pe().blocks[e];if(!h||!p)return;if(c.current<zc){c.current=zc;return}const g=(F=p.data[a])!=null?F:[],_=(b=Qy.get(f))!=null?b:h.offset,x=zxe(e,g,(w=h.segments)!=null?w:[]);o(()=>{re(sr({init(){_e(e,{data:{[a]:g}}),x.forEach(E=>{OC(E,m.BlockStatus.DELETED)}),lu(e,i)},redo(){_e(e,{data:{[a]:g}}),x.forEach(E=>{OC(E,m.BlockStatus.DELETED)}),lu(e,i),s(e,_,t)},undo(){_e(e,{data:{[a]:h.segments}}),x.forEach(E=>{OC(E,m.BlockStatus.NORMAL)}),lu(e,i),s(e,h.offset,t)}}))}),l.current=void 0},500,{leading:!1}),[s,i,a,o,t,e]);return y.useMemo(()=>(f,h)=>{var b,w,E,C,k;const p=a==="segments"&&((b=pe().blocks[e])==null?void 0:b.type)===m.BlockType.CODE,g=n(p?"".concat(e,"_mock"):e,!0),_=JSON.stringify({segments:f,uuid:e,time:Date.now()});if(c.current=zc,!l.current){const T=pe().blocks[e];if(!T)return;if(h){const[v,I]=h;l.current={segments:mr(v),offset:(w=I==null?void 0:I.offset)!=null?w:0}}else{const v=T.data[a];l.current=v?{segments:v,offset:T.data[a]&&(E=Qy.get(_))!=null?E:0}:{segments:void 0,offset:0}}}const F=pe().blocks[e].data.isByAI?{isByAI:fe(f).trim().length!==0}:{};re(Sn({ignoreOp:!0,uuid:e,patch:{data:{[a]:f,...F}}})),lu(e,i,o),Qy.set(_,(k=(C=g.selection)==null?void 0:C.offset)!=null?k:0),d(_)},[n,a,i,d,o,e])},lu=(e,t,n)=>{var d;const s=pe().blocks[e];if(s==null)return;const a=((d=s.discussions)!=null?d:[]).filter(u=>{const f=pe().discussions[u];return fe(f==null?void 0:f.context)!==""}),o=[];for(const u of t(s))o.push(...Tce(u));const i=Fk(a,o),l=Fk(o,a),c=()=>{if(i.length>0)for(const u of i)re(i0({uuid:u,parentId:e,spaceId:s.spaceId}));if(l.length>0)for(const u of l)re(o0({uuid:u,parentId:e}))};(i.length>0||l.length>0)&&(n?n(c):c())},zxe=(e,t,n)=>{const s=l=>new Set(l.map(c=>{if(c.type===m.TextType.LINK_PAGE&&c.uuid){const d=pe().blocks[c.uuid];if(d&&d.parentId===e)return c.uuid}return null}).filter(Boolean)),a=s(n),o=s(t),i=[];for(const l of a)o.has(l)||i.push(l);return i},OC=(e,t)=>{re(Sn({uuid:e,patch:{status:t}}))},qxe=e=>{const{blocks:t}=pe(),n=e[0];if(!n)return;const s=t[n];if(!s)return;const a=t[s.parentId];if(!a)return;const o=a.subNodes.indexOf(n);if(o<1)return;const i=a.subNodes[o-1];if(!i)return;const l=t[i];l&&Ite(l)&&e.forEach(c=>{re(Tr({uuid:c})),re(ws({uuid:c,parentId:i}))})},qV=e=>{const{blocks:t}=pe(),n=e[0],s=An(e);if(!n||!s)return;const a=t[n];if(!a||!t[s])return;const i=t[a.parentId];if(!i||Ri()===i.uuid||i.type===m.BlockType.COLUMN||i.type===m.BlockType.SYNC_CONTAINER)return;const l=i.subNodes.indexOf(s);l>-1&&i.subNodes.slice(l+1).forEach(d=>{re(Tr({uuid:d})),re(ws({uuid:d,parentId:s}))}),e.reduce((c,d)=>(re(Tr({uuid:d})),re(ws({uuid:d,parentId:i.parentId,after:c})),d),i.uuid)},Gxe=e=>{const t=Oe(),n=af(e!=null?e:""),s=Nr(),a=VN(),o=i=>{if(!Ie(["Tab","Shift+Tab"])(i))return;if(a){be.loading({key:"tab-key-page-loading",content:"Tab功能请等待文档加载完毕",duration:3e3});return}const{blocks:l,ui:c}=J,{selectedBlocks:d}=c,u=d.length?lr(d):e?[e]:[],f=d.some(g=>g.mindMapId),h=u[0];if(!h)return;const p=l[h];p&&([m.BlockType.PAGE].includes(p.type)||f||(i.preventDefault(),t(()=>{var g,_;if(i.shiftKey)qV(u);else{qxe(u);const x=J.blocks[p.uuid];if(x){const F=l[x.parentId];((F==null?void 0:F.type)===m.BlockType.FOLD_LIST||(F==null?void 0:F.type)===m.BlockType.TOGGLE_HEADER||CU(F==null?void 0:F.uuid))&&Vi(x.parentId,!0)}}if(e){const x=ks(e);if(!x||ir((g=J.blocks[x])==null?void 0:g.type))return;const F=(_=Xa(n))==null?void 0:_.selection;if(!F)return;const{offset:b}=F;es(50).then(()=>{re(sr({init(){s(e,b)},redo(){s(e,b)},undo(){s(e,b)}}))})}})))};return y.useCallback(o,[n,s,a,t,e])},Wxe=(e,t)=>t?document.querySelector('[data-sync-id="'.concat(t,'"][data-block-id="').concat(e,'"] [contenteditable]')):document.querySelector('[data-block-id="'.concat(e,'"] [contenteditable]')),Kxe=()=>{const e=window.getSelection();if(!(e.rangeCount<1))return e.getRangeAt(0)},Ma=(e,t)=>{const n=t!=null?t:Xa(e);if(!n)return;const{selection:s}=n;if(!s)return;let a=s.offset,{endOffset:o}=s;s.isCollapsed&&n.content.length>0&&(o===n.content.length?a-=1:/^[\r\n]/.test(ta(Jr(n.content,a,a+1)))||(o+=1));const i=n.getBoundingClientRectOfRange(a,o)||(console.warn("editorModel.getBoundingClientRectOfRange returns null"),new DOMRect);if(n.content.length===0)return{caretRect:i,collapsed:s.isCollapsed,isFirstLine:!0,isLastLine:!0,isFirstChar:!0,isLastChar:!0};const l=n.getBoundingClientRectOfRange(0,1),c=n.getBoundingClientRectOfRange(n.content.length-1,n.content.length),d=ta(n.content),u=d.indexOf("\n"),f=d.lastIndexOf("\n"),h=i.top===(l==null?void 0:l.top)&&(a<=u||u===-1),p=i.bottom===(c==null?void 0:c.bottom)&&(o>f||f===-1),g=h&&s.focusOffset<=0,_=p&&s.focusOffset>=n.content.length;return{caretRect:i,collapsed:s.isCollapsed,isFirstLine:h,isLastLine:p,isFirstChar:g,isLastChar:_}},Kh=e=>{const{symbol:t,model:n}=e,s=t.length,{selection:a}=n,{focusOffset:o}=a||{};if(!a||!o)return{};const i=Yxe(n,a.offset-s,t);if(i<=0)return{};const l=i>=s+1&&i!==-1?Jy(n,i-(s+1),i-s):"";try{const c=Jy(n,i,o-s),d=Jy(n,i-s,o),u=d.startsWith(t)&&d.endsWith(t),f=c&&c!==" "&&!c.includes([...new Set(t.split(""))].join(""));return(!l||l===" "||!/^[\x00-\x7F]*$/.test(l))&&u&&f?{hitText:d,lastSameIndex:i}:{lastSameIndex:i}}catch(c){return{}}},Jy=(e,t,n)=>ta(Jr(e.content,t,n)),Yxe=(e,t,n)=>{for(;t>0&&t-n.length>0;){const s=Jy(e,t-n.length,t);if(n===s)break;t--}return t},Xxe=e=>{const t=Nn();return y.useCallback(n=>new Promise(s=>{var i,l;const a=t(e);if(!a){s(!1);return}((l=(i=a.selection)==null?void 0:i.focusOffset)!=null?l:0)<2&&s(!1);const o=a.onAfterInput.subscribe(()=>{if(o.unsubscribe(),n===">"){const{hitText:c}=Kh({model:a,symbol:"<u>"});c&&s("underline")}if(n==="="){const{hitText:c}=Kh({model:a,symbol:"=="});c&&s("highlight")}s(!1)})}),[t,e])},Lr=(e,t,n)=>{requestAnimationFrame(async()=>{if(!e)return;let s=Xa(e);if(s||(s=Xa("".concat(e,"_mock"))),!s)return;const a=await(async()=>{if(t===0&&n===0)return 0;if(n===1/0)return s.content.length;s.performChange(l=>{l.select(n===1/0?s.content.length:0)}),await s.scrollCaretIntoViewIfNeeded(),await new Promise(l=>setTimeout(l,0));const o=s.getBoundingClientRectOfRange(0,0),i=s.getBoundingClientRectOfRange(s.content.length,s.content.length);if(!(!o||!i))return t=Es(t,o.left+1,i.right-1),n=Es(n,o.top+1,i.bottom-1),s.hitTest(t,n)})();a!=null&&(s.performChange(o=>{o.select(a)}),await s.requestFocus())})},j1=(e,t,n)=>{if(!e)return;let s=null;return t?s=bn("[data-block-id='".concat(e,"'][data-sync-id='").concat(t,"'] [data-editor]"),n):s=bn("[data-block-id='".concat(e,"'] [data-editor]"),n),(s==null?void 0:s.getAttribute("data-editor"))||e},GV=e=>{const t=e==null?void 0:e.closest("[data-editor]");return(e==null?void 0:e.getAttribute("data-editor"))||(t==null?void 0:t.getAttribute("data-editor"))},Qxe=e=>{if(!(e!=null&&e.querySelector))return;const t=e.querySelector("[data-editor]");return e.getAttribute("data-editor")||(t==null?void 0:t.getAttribute("data-editor"))},hRe=e=>{const t=e==null?void 0:e.closest("[data-sync-id]"),n=(e==null?void 0:e.getAttribute("data-sync-id"))||(t==null?void 0:t.getAttribute("data-sync-id"));if(n)return n},pRe=e=>{if(!e)return;const t=document.querySelector("[data-block-id] [data-editor='".concat(e,"']"));if(!t)return;const n=t.closest("[data-block-id]");if(n instanceof HTMLElement)return n},gRe=e=>{const t=document.querySelector('[data-editor="'.concat(e,'"]'));if(t){const n=t.closest("[data-table-row-id]");if(n)return n.dataset.tableRowId;const s=t.closest("[data-modal-id]");if(s){const{modalId:a}=s.dataset;if(a!=null&&a.startsWith("cell-"))return a.slice(5,41)}}return e},WV=e=>{const t=rh(),n=Fc(),s=Ln(),a=Ks(),o=i=>{const l=j1(e,a,s);if(!l)return;const c=Ma(l);if(!(c!=null&&c.collapsed)||!c.isFirstLine)return;i.preventDefault();const d=Rg(e),u=J.blocks[d];if(!u)return;const f=ks(u.uuid);if(!f)return;const h=Nu(s),g=h.findIndex(_=>_.blockId===u.uuid&&_.syncId===a)-1;if(g>=0){const _=h[g];if(!_)return;i.preventDefault(),n(),Lr(_.editorKey,c.caretRect.x,0),t(f,_.blockId)}else{const _=j1(f,void 0,s);Lr(_,c.caretRect.x,0)}};return y.useCallback(o,[n,s,t,a,e])},KV=e=>{const t=rh(),n=Fc(),s=Ln(),a=Ks(),o=i=>{const l=j1(e,a,s);if(!l)return;const c=Ma(l);if(!(c!=null&&c.collapsed)||!c.isLastLine)return;const d=Rg(e),u=J.blocks[d];if(!u)return;const f=ks(u.uuid);if(!f)return;const h=Nu(s),g=h.findIndex(_=>_.blockId===u.uuid&&_.syncId===a)+1;if(g<h.length){const _=h[g];if(!_)return;i.preventDefault(),n(),Lr(_.editorKey,c.caretRect.x,0),t(f,_.blockId)}};return y.useCallback(o,[n,s,t,a,e])},Jxe=e=>{const t=rh(),n=Fc(),s=Ln(),a=Ks(),o=af(e),i=l=>{const c=Ma(o);if(!(c!=null&&c.collapsed)||!c.isLastChar)return;const d=Rg(e),u=J.blocks[d];if(!u)return;const f=ks(u.uuid);if(!f)return;const h=Nu(s),g=h.findIndex(_=>_.blockId===u.uuid&&_.syncId===a)+1;if(g<h.length){const _=h[g];if(!_)return;n(),l.preventDefault(),Lr(_.editorKey,0,0),t(f,_.blockId)}};return y.useCallback(i,[n,o,s,t,a,e])},Zxe=e=>{const t=rh(),n=Fc(),s=Ln(),a=Ks(),o=af(e),i=l=>{const c=Ma(o);if(!(c!=null&&c.collapsed)||!c.isFirstChar)return;l.preventDefault();const d=Rg(e),u=J.blocks[d];if(!u)return;const f=ks(u.uuid);if(!f)return;const h=Nu(s),g=h.findIndex(x=>x.blockId===u.uuid&&x.syncId===a)-1;if(g>=0){const x=h[g];if(!x)return;n(),l.preventDefault(),Lr(x.editorKey,1/0,1/0),t(f,x.blockId);return}const _=j1(f,void 0,s);Lr(_,1/0,1/0)};return y.useCallback(i,[n,o,s,t,a,e])};function l2(e){e.icon&&ts("last_mark_info_icon",e.icon),e.textColor?(ts("last_mark_info_text_color",e.textColor),localStorage.removeItem("last_mark_info_background_color")):e.backgroundColor&&(ts("last_mark_info_background_color",e.backgroundColor),localStorage.removeItem("last_mark_info_text_color"))}function eye(){const e={},t=localStorage.getItem("last_mark_info_text_color"),n=localStorage.getItem("last_mark_info_background_color"),s={icon:localStorage.getItem("last_mark_info_icon")};return t?e.textColor=t:n&&(e.backgroundColor=n),s.icon&&(e.data={icon:{value:s.icon,type:"emoji"}}),e}const YV=(e,t)=>{const n=e.clientY,s=e.clientX;return tye(s,n,t)},d6=40,tye=(e,t,n)=>{var i;const s=(n||document.body).querySelectorAll("[data-block-id]:not(.card):not(.hide-sync-block-child):not([data-column-list]), [data-drop-in-child]");let a,o=1/0;for(const l of s){const c=l.getBoundingClientRect(),d=parseInt(getComputedStyle(l).getPropertyValue("margin-top"),10),u=parseInt(getComputedStyle(l).getPropertyValue("margin-bottom"),10);if(t>c.top-d&&t<c.bottom+u&&e>c.left-d6&&e<c.right+d6){const f=(e-c.left)**2,h=(t-(c.top-u))**2,p=f+h;p<o&&(o=p,a=l)}}return{blockId:(i=a==null?void 0:a.closest("[data-block-id]"))==null?void 0:i.dataset.blockId,node:a}},CF=e=>{if(e===m.BlockType.MARK){const t=eye();return!t.textColor&&!t.backgroundColor&&(t.backgroundColor=Ze.grey),t}return{}},Ef={backgroundColor:"",data:{segments:[]},status:m.BlockStatus.NORMAL,subNodes:[],textColor:"",version:0,permissions:[]},kF=(e,t,n)=>{const{blocks:s}=pe(),a=s[t];if(!a)return;if(a.type===m.BlockType.COLUMN){const d=qe();return re($a({block:{...Ef,type:m.BlockType.COLUMN,uuid:d,parentId:t,spaceId:a.spaceId,data:{...Ef.data,columnRatio:1}}})),re(n==="left"?cl({uuid:d,parentId:a.parentId,before:t}):ws({uuid:d,parentId:a.parentId,after:t})),e.forEach(u=>{const f=s[u];f&&(Xb(u),re(Tr({uuid:u,parentId:f.parentId})),re(ws({uuid:u,parentId:d})),fm(f.uuid,f.parentId))}),d}const o=qe();re($a({block:{...Ef,uuid:o,type:m.BlockType.COLUMN_LIST,parentId:a.parentId,spaceId:a.spaceId}})),re(ws({uuid:o,parentId:a.parentId,after:t}));const i=qe();re($a({block:{...Ef,type:m.BlockType.COLUMN,uuid:i,parentId:o,spaceId:a.spaceId,data:{...Ef.data,columnRatio:1}}})),re(ws({uuid:i,parentId:o}));const l=qe();return re($a({block:{...Ef,type:m.BlockType.COLUMN,uuid:l,parentId:o,spaceId:a.spaceId,data:{...Ef.data,columnRatio:1}}})),re(ws({uuid:l,parentId:o,after:i})),e.forEach(c=>{const d=s[c];d&&(Xb(c),re(Tr({uuid:c})),re(Tr({uuid:t})),n==="left"?(re(ws({uuid:c,parentId:i})),re(ws({uuid:t,parentId:l}))):(re(ws({uuid:t,parentId:i})),re(ws({uuid:c,parentId:l}))),fm(d.uuid,d.parentId))}),l},XV=(e,t,n)=>{var p,g;const{blocks:s}=pe(),a=(p=n==null?void 0:n.createEmptyTextBlock)!=null?p:!0,o=(g=n==null?void 0:n.autoTrim)!=null?g:!0,i=n==null?void 0:n.convertBlock,l=s[e];if(!l||!s[l.parentId])return;const d=qK([Ze.grey,Ze.brown,Ze.orange,Ze.yellow,Ze.green,Ze.blue,Ze.purple,Ze.pink,Ze.red],t),u=Ep(l.data),f=Pne(e,[m.BlockType.COLUMN_LIST]);let h=l.uuid;u&&!f&&o?i([h],{type:m.BlockType.COLUMN_LIST,backgroundColor:""}):h=ut({type:m.BlockType.COLUMN_LIST},{parentId:l.parentId,after:l.uuid});for(let _=0;_<t;_++){const x=ut({type:m.BlockType.COLUMN,data:{columnRatio:1}},{parentId:h});a&&ut({type:m.BlockType.TEXTAREA,backgroundColor:d[_]},{parentId:x})}return h},nr=(e,t)=>{var s,a,o;const{blocks:n}=pe();if(t.type===m.BlockType.SYNC_CONTAINER){const i=(a=n[(s=e[0])!=null?s:""])==null?void 0:a.parentId;i&&QV(e,i);return}if(t.type===m.BlockType.COLUMN_LIST&&e.length>1){const i=XV(e[0],e.length,{createEmptyTextBlock:!1,autoTrim:!1,convertBlock:nr});(o=J.blocks[i!=null?i:""])==null||o.subNodes.forEach((l,c)=>{const d=e[c];d&&il([d],{parentId:l})});return}Ls.unstable_batchedUpdates(()=>{e.forEach(async i=>{var f,h,p,g,_,x,F;const{type:l,...c}=t,d=n[i];if(!d)return;const u=d.type===m.BlockType.FILE&&l===m.BlockType.REFERENCE;if(!(!iI.includes(d.type)&&!u)){if(l===d.type){if(l===m.BlockType.HEADER||l===m.BlockType.TOGGLE_HEADER){if(d.data.level===((f=t.data)==null?void 0:f.level))return}else if(l!==m.BlockType.REFERENCE&&l!==m.BlockType.FILE)return}if(l===m.BlockType.MARK&&(d.data.icon||(c.data={...c.data,icon:{type:"emoji",value:"💡"}}),!d.textColor&&!d.backgroundColor)){const b=CF(m.BlockType.MARK),{data:w,...E}=b;Object.assign(c,E),c.data={...c.data,...w}}if(l===m.BlockType.CODE){const b=mg();c.data||(c.data={}),c.data&&(c.data.format={...(h=c.data)==null?void 0:h.format,language:b!=null?b:Lm})}if((l===m.BlockType.MIND_MAPPING||l===m.BlockType.MIND_MAPPING_PAGE)&&(c.data||(c.data={}),c.data.format={...c.data.format,mindMappingFormat:{...(p=c.data.format)==null?void 0:p.mindMappingFormat,oldBlockType:d.type}}),l===m.BlockType.PAGE&&(c.data||(c.data={}),c.data.format||(c.data.format={}),typeof d.data.pageFixedWidth!="boolean"&&Object.assign(c.data,{pageFixedWidth:FI(),directoryMenu:(g=yt.setting)==null?void 0:g.directoryMenu}),Object.assign(c.data.format,{pageLayout:(_=Iu())==null?void 0:_.setting.pageLayout,fontFormat:(x=Iu())==null?void 0:x.setting.fontFormat,commentAlignment:(F=Pn().setting)==null?void 0:F.commentAlignment})),re(Sn({uuid:i,patch:{type:l,...c}})),[m.BlockType.EQUATION,m.BlockType.CODE].includes(l)&&d.subNodes.reduce((b,w)=>(re(Tr({uuid:w})),re(ws({uuid:w,parentId:d.parentId,after:b})),w),i),d.type===m.BlockType.PAGE){const b=await ve.editor.getDoc(d.uuid),w=Object.entries(b.blocks).reduce((E,[C,k])=>(n[C]||(E[C]=k),E),{});re(Tn.update({blocks:w}))}}})})},QV=(e,t)=>{const n=e[0];if(!n)return;const s=ut({type:m.BlockType.SYNC_CONTAINER},{parentId:t,before:n});return il(e,{parentId:s}),s};Fue(nr);const u6=(e,t)=>{var u,f;const{blocks:n}=pe(),s=n[e];if(!s)return;const a=Xk(s);if(s.type!==m.BlockType.TEXTAREA&&!a)return;const o=n[t];if(!o)return;const i=Xk(o)?"caption":"segments",l=a?"caption":"segments",d=((u=o.data[i])!=null?u:[]).concat((f=s.data[l])!=null?f:[]);s.subNodes.reduce((h,p)=>(re(Tr({uuid:p})),re(ws({uuid:p,parentId:s.parentId,after:h})),p),s.uuid),l==="segments"?(re(Sn({uuid:e,patch:{status:m.BlockStatus.DELETED}})),re(Tr({uuid:e}))):re(Sn({uuid:e,patch:{data:{caption:[],showEmptyCaption:!1}}})),re(Sn({uuid:t,patch:{data:{[i]:d}}})),fm(s.uuid,s.parentId)},nye=(e,t)=>{const n=Oe(),s=Ln(),a=Ks(),o=Nr(),i=Nn(),l=y.useContext(jl),c=Fie(),d=u=>{var E;const{blocks:f}=pe();if(!ks(e))return;const p=f[e];if(!p)return;const g=f[p.parentId];if(!g)return;const _=(E=i(e))==null?void 0:E.selection;if(!_||!_.isCollapsed||_.offset!==0)return;if(u.preventDefault(),u.stopPropagation(),p.type!==m.BlockType.TEXTAREA&&p.type!==m.BlockType.CODE&&t==="segments"){n(()=>{nr([p.uuid],{type:m.BlockType.TEXTAREA}),re(sr({init(){},redo(){o(p.uuid,0)},undo(){o(p.uuid,0)}}))});return}const x=[m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER].includes(g.type)&&g.subNodes.length===1&&An(g.subNodes)===e||m.BlockType.TEMPLATE===g.type&&An(g.subNodes)===e;if(g.type!==m.BlockType.PAGE&&g.type!==m.BlockType.COLUMN&&g.type!==m.BlockType.SYNC_CONTAINER&&An(g.subNodes)===e&&!x&&t==="segments"){n(()=>{qV([e]),re(sr({init(){o(e,0)},redo(){o(e,0)},undo(){o(e,0)}}))});return}const F=Nu(s),b=F.findIndex(C=>C.blockId===e&&C.syncId===a),w=F[p.type===m.BlockType.CODE&&t==="caption"?b:b-1];if(w&&!l){const C=fd(w.blockId,c,w.syncId),k=Xa(C);n(()=>{const T=Xk(f[w.blockId])?"caption":"segments";u6(p.uuid,w.blockId),re(sr({init(){o(w.blockId,(k==null?void 0:k.content.length)||0,T,{syncId:w.syncId})},redo(){o(w.blockId,(k==null?void 0:k.content.length)||0,T,{syncId:w.syncId})},undo(){o(e,0,t)}}))});return}if(g.type===m.BlockType.PAGE&&t==="segments"){const C=fe(g.data.segments);n(()=>{u6(p.uuid,g.uuid),re(sr({init(){o(g.uuid,C.length)},redo(){o(g.uuid,C.length)},undo(){o(e,0)}}))})}g.type===m.BlockType.SYNC_CONTAINER&&n(()=>{gr(p.uuid)})};return y.useCallback(d,[l,o,i,s,c,t,a,n,e])},TF=(e,t,n=1/0)=>{if(!e)return[];const s=[];let a=0;for(const o of e){const i=a,l=a+o.text.length;let{text:c}=o;if(a+=c.length,l<=t)continue;if(i>=n)break;let d=0,u=c.length;t>i&&(d=t-i),l>n&&(u=c.length-(l-n)),c=c.slice(d,u),s.push({...o,text:c})}return s},JV=e=>{const t=Oe(),n=Nn(),s=Nr(),a=o=>{var h;const{blocks:i}=pe(),l=i[e];if(!l)return;const c=(h=n(e))==null?void 0:h.selection;if(!c||!c.isCollapsed||c.offset!==1)return;const[d]=TF(l.data.segments,0,1);if(!d)return;const u=d.text;if(u!=="["&&u!=="【")return;o==null||o.preventDefault();const f=TF(l.data.segments,1);o&&_e(l.uuid,{data:{segments:[{...d,text:"".concat(u).concat(o.key)},...f]}},!0),t(()=>{_e(l.uuid,{type:m.BlockType.TODO,data:{segments:f}}),re(sr({init(){s(l.uuid,0)},redo(){s(l.uuid,0)},undo(){s(l.uuid,2)}}))})};return y.useCallback(a,[s,n,t,e])},sye=(e,t)=>{const n=Oe(),s=Fc(),a=Nn(),o=Nr(),i=l=>{l.preventDefault();const{blocks:c}=pe(),d=c[e],u=a(e),f=u==null?void 0:u.selection;if(!d||!u||!f||u.isComposing)return;if(l.shiftKey){u.performChange(I=>{I.replace("\n")});return}if(fe(d.data.segments)===""&&[m.BlockType.TODO,m.BlockType.HEADER,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.MARK,m.BlockType.QUOTE,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER].includes(d.type)){n(()=>{_e(d.uuid,{type:m.BlockType.TEXTAREA}),o(d.uuid,MC(d.uuid))});return}const{content:p}=u,{offset:g,endOffset:_}=f,x=ta(p);if(/(\$\$|￥￥)$/.test(x)){_e(d.uuid,{type:m.BlockType.EQUATION,local:!0,data:{...d.data,segments:[]}});return}if(f.isCollapsed&&g===p.length&&/^(?:(`|·){3,}|~{3,}|～{3,})[A-Za-z#() +.-]*$/.test(x)){const I=rj(x.slice(3).trim()),j=qe();n(()=>{ut({uuid:j,type:m.BlockType.CODE,data:{format:{language:I}}},{parentId:d.parentId,after:d.uuid}),Ro(d.uuid);const S=MC(j);re(sr({init(){setTimeout(()=>{o("".concat(j,"_mock"),S)},150)},undo(){o(d.uuid,g)},redo(){setTimeout(()=>{o("".concat(j,"_mock"),S)},150)}}))});return}const[F]=Ck(p,g),[,b]=Ck(p,_),w=mr(F),E=mr(b);if(g===0){const I=c[d.parentId];if(!I)return;const j=I.subNodes.indexOf(d.uuid),S=I.subNodes[j-1];t==="segments"?(n(()=>{_e(d.uuid,{data:{segments:E}}),ut({},S?{parentId:d.parentId,after:S}:{parentId:d.parentId,first:!0})}),o(d.uuid,0)):n(()=>{_e(d.uuid,{data:{showEmptyCaption:!1,caption:[]}});const D=ut({data:{segments:E}},{parentId:d.parentId,after:d.uuid});o(D,0)}),s();return}let C=m.BlockType.TEXTAREA,k={parentId:d.parentId,after:d.uuid};const T=[m.BlockType.TEXTAREA,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.TODO,m.BlockType.FOLD_LIST],v=xt.$expandFoldRecord[d.uuid];if(nx(d.type)&&!v)T.includes(d.type)&&(C=d.type);else{const[I]=d.subNodes,j=I?c[I]:void 0;(j||[m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER].includes(d.type))&&(k={parentId:d.uuid,first:!0}),j&&T.includes(j.type)&&(C=j.type)}n(()=>{_e(d.uuid,{data:{[t]:w}});const I=ut({type:C,data:{segments:E,level:d.data.level}},k);s();const j=MC(I);re(sr({init(){o(I,j)},undo(){o(d.uuid,g,t)},redo(){o(I,j)}}))})};return y.useCallback(i,[e,a,n,o,t,s])},MC=e=>{var t;return fe((t=J.blocks[e])==null?void 0:t.data.segments).length||0},rye=4,f6=8,aye=({onCloseModal:e,blockId:t,left:n,right:s,symbol:a="",getEditorModel:o,search:i})=>{const[l,c]=y.useState(i),d=GK(l!=null?l:"",{wait:800}),u=ie(),f=y.useRef(void 0),[h,p]=y.useState(0);y.useEffect(()=>{const _=o(t);if(!_)return;const{selection:x}=_;if(!x||!x.isCollapsed)return;const F=_.createCursor(s,"right");f.current=F,i?_.performChange(C=>{C.select(n,s).replace(i).collapse("end")}):a||_.performChange(C=>{C.select(n,s).replace(":").collapse("end")});const b=_.createCursor(n+1-a.length,"left"),w=n,E=_.onContentChange.subscribe(()=>{if(_.selection){const{focusOffset:T}=_.selection;if(T<=w){e();return}}const C=Jr(_.content,b.offset,F.offset),k=ta(C);c(k)});return()=>{E.unsubscribe(),F.release(),b.release()}},[t,o,n,e,s,i,a]);const g=y.useCallback((_,x,F)=>{if(!F&&x&&_.skin)return u.dropdown({popcorn:x.currentTarget,placement:"bottom",content:({onCloseModal:w})=>r.jsx(cT,{emoji:_,onSelect:E=>{w(),e();const C=o(t);C==null||C.performChange(k=>{var T;k.select(n-a.length,(T=f.current)==null?void 0:T.offset).replace(Wn([Is(xm,{text:E.native})])).collapse("end")}),C==null||C.requestFocus()}})}),!0;e();const b=o(t);b==null||b.performChange(w=>{var E;w.select(n-a.length,(E=f.current)==null?void 0:E.offset).replace(Wn([Is(xm,{text:_.native})])).collapse("end")}),b==null||b.requestFocus()},[t,o,n,e,u,a.length]);return y.useEffect(()=>{if(!d)return;const _=Mf.search(d);if(_!=null&&_.length)p(0);else{const x=d.replace(/[^\x00-\xff]/g,"**").length;x>rye&&x<f6?p(x):x>=f6&&e()}},[e,d]),h?null:r.jsx("div",{className:"next-modal w-[418px]",children:r.jsx(lT,{useButton:!0,onSelect:g,keyword:d,hideSearchInput:!0})})},oye=({onCloseModal:e,blockId:t,left:n,right:s,symbol:a="",getEditorModel:o})=>{const i=o(t);return y.useEffect(()=>{if(!i)return;const{selection:l}=i;if(!l)return;const c=i.createCursor(n,"left"),d=i.createCursor(s,"right");i.performChange(u=>{u.shadow().select(n,s).replace(Wn([Is(Jl,{open:!0})])).collapse("end").release()}),e(),c.release(),d.release()},[t,i,n,e,s,a]),null},iye=()=>{const e=Ed(),t=Ln(),n=Hm(),{setting:s={}}=Ut(),a=(o,i)=>{if(o){if(!i&&!t&&!xt.$isMobileSize&&s.useRightPageByNew){n(o);return}e.push("/".concat(o))}};return y.useCallback(a,[e,t,n,s.useRightPageByNew])},ZV=()=>{const e=Oe(),t=iye();return y.useCallback(n=>{const{setFakeFocus:s,left:a,blockId:o,editorModel:i,title:l=""}=n;if(!i.selection)return;const{endOffset:c}=i.selection,d={type:m.BlockType.PAGE};l&&(d.data={segments:ht(l)}),e(()=>{const u=ut(d,{parentId:o,inline:!0});let f=c;!s&&l&&(f=a+l.length+1),i.performChange(h=>{h.shadow().select(a,f).replace(Wn([Is(ml,{pageId:u})])).release(),h.select(f)}),l||mo(()=>{t(u)})},{noThrottle:!0})},[t,e])},m6=[m.BlockType.FOLDER,m.BlockType.FILE],lye=({onCloseModal:e,blockId:t,left:n,title:s,setFakeFocus:a,getEditorModel:o})=>{const i=Js(),l=Oe(),c=y.useMemo(()=>p1({ancestorId:Ot(),filterTypes:m6}),[]);return r.jsx(oc,{defaultValue:c,onSelect:d=>{if(a==null||a(!1),m6.includes(d.type)){be.warning("不能在文件夹内创建页面"),e();return}const u=o(t);if(!u)return;const f={type:m.BlockType.PAGE};s&&(f.data={segments:ht(s)}),l(()=>{const h=ut(f,{parentId:d.uuid});u.performChange(p=>{u.selection&&p.shadow().select(n,u.selection.focusOffset).replace(Wn([Is(ml,{pageId:h})])).release()}),u.requestFocus()},{noThrottle:!0}),e(),i(Je.GUIDE_FIRST_TIME_LINK_PAGE,ct.advancedList),i(Je.CREATE_REF_PAGE,ct.advancedList)}})},e$=e=>{const{onCloseModal:t,blockId:n,left:s,right:a,getEditorModel:o,setFakeFocus:i}=e,l=Js(),c=ZV(),[d,u]=y.useState(!1),f=ZU({...e,symbol:"[[",tip:"输入内容进行搜索或创建",changeTipWhenComposing:!0}),{pageList:h,setPageFold:p,loading:g}=eV({keyword:f}),_=y.useMemo(()=>{const x=f?'"'.concat(f,'"'):"";return[{type:H.BLOCK_TEXT,data:{title:Wa.linkToPage,icon:g&&r.jsx($s,{size:"large"})}},...h,{type:H.LINE,data:{},disableClick:!0},{type:H.CUSTOM_RENDER,render(){return r.jsxs("div",{className:"flex items-center py-2 animate-hover px-4",onClick:F=>{F.stopPropagation();const b=o(n);if(!b)return;let w=n;J.blocks[w]||(w=b.editorElement.dataset.realBlockId),c({setFakeFocus:i,editorModel:b,blockId:w,title:f,left:s,right:a}),t()},children:[r.jsx(V,{name:"IcBtnNew",size:"middle"}),r.jsx("div",{className:"ml-1 text-t2 text-grey3 text-ellipsis",children:"创建行内页面 ".concat(x)})]})}},{type:H.CUSTOM_RENDER,render(){return r.jsxs("div",{className:"flex items-center py-2 animate-hover px-4",onClick:()=>{i==null||i(!0),u(!0),l(Je.CREATE_REF_PAGE,ct.advancedList)},children:[r.jsx(V,{name:"IcTitleRelation",size:"middle"}),r.jsx("div",{className:"ml-1 text-t2 text-grey3 text-ellipsis",children:"创建新的行内引用页面 ".concat(x)})]})}}]},[f,g,h,o,n,c,i,s,a,t,l]);return d?r.jsx(lye,{...e,title:f}):r.jsx(ze,{virtualList:!0,defaultActiveIndex:1,className:"w-60 next-modal py-2 overflow-y-auto",items:_,onItemClick:(x,F,b)=>{const w=o(n);if(!w)return;if(x.data.categoryType===To.page&&l(Je.CREATE_REF_PAGE,ct.advancedList),x.data.categoryType===To.foldPage){b.preventDefault(),p(!1),w.requestFocus();return}if(!w.selection)return;const{focusOffset:E}=w.selection;let C=E;!i&&f&&(C=s+f.length+1),w.performChange(k=>{k.shadow().select(s,C).replace(Wn([Is(ml,{pageId:x.data.uuid})])).release(),k.select(C)}),w.requestFocus(),l(Je.GUIDE_FIRST_TIME_LINK_PAGE,ct.advancedList),t()}})},cye=({onCloseModal:e,blockId:t,left:n,right:s,symbol:a="",getEditorModel:o})=>{const i=M0();y.useEffect(()=>{const d=o(t);if(!d)return;const u=d.createCursor(n,"left"),{selection:f}=d;if(!f||!f.isCollapsed)return;const h=d.createCursor(f.focusOffset,"right");d.performChange(F=>{F.select(n,s).replace(Wn([Is(Xi,{tip:"选择成员"})])).collapse("end")}),h.offset=u.offset+1;const p=d.onSelectionChange.subscribe(()=>{if(d.selection){const{focusOffset:F}=d.selection;(F<=u.offset||h.offset<F)&&e()}}),g=d.onBeforeInput.pipe(Gv()).subscribe(()=>{x(),e()});let _=!1;const x=()=>{if(_)return;_=!0;const b=Jr(d.content,u.offset,h.offset).items[0];b&&b.type==="element"&&b.tag===Xi&&(d.performChange(w=>{w.shadow().select(u.offset,h.offset).replace(a).release()}),d.requestFocus()),u.release(),h.release(),p.unsubscribe(),g.unsubscribe()};return()=>{x()}},[t,n,e,a,s,o]);const[l,c]=y.useState("");return r.jsx("div",{className:"w-[260px] py-2 next-modal",children:r.jsx(Yj,{customHeader:r.jsx(Ct,{autoFocus:!0,className:"h-8 mx-2.5 mb-2.5",placeholder:"搜索成员",onChange:d=>{c(d)}}),className:"py-1.5",search:l,users:i,onSelectPerson:d=>{const u=o(t);u&&(u.performChange(f=>{f.shadow().select(n,n+1).replace(Wn([Is(Gm,{userId:d})])).release()}),u.requestFocus(),e())}})})},dye=({onCloseModal:e,blockId:t,inlineType:n,left:s,right:a,onGlobalCaptureKeydown:o,symbol:i,getEditorModel:l,keyword:c})=>{switch(n){case ma.DATE:return r.jsx(QR,{getEditorModel:l,onlyDate:!i,onCloseModal:e,blockId:t,left:s,right:a,onGlobalCaptureKeydown:o});case ma.LINK_PAGE:return r.jsx(e$,{getEditorModel:l,symbol:i,onCloseModal:e,blockId:t,left:s,right:a});case ma.EQUATION:return r.jsx(oye,{getEditorModel:l,symbol:i,onCloseModal:e,blockId:t,left:s,right:a});case ma.PEOPLE:return r.jsx(cye,{getEditorModel:l,symbol:i,onCloseModal:e,blockId:t,left:s,right:a});case ma.EMOJI:return r.jsx(aye,{getEditorModel:l,symbol:i,onCloseModal:e,blockId:t,left:s,search:c,right:a});default:return r.jsx(QR,{getEditorModel:l,onCloseModal:e,blockId:t,left:s,right:a,onGlobalCaptureKeydown:o})}},t$=()=>{const e=ie(),t=Fc(),n=m0(Ve.INLINE_PANEL),s=ZV(),a=(o,i,l,c,d,u,f)=>{const h=d(l);if(!h)return;const{selection:p}=h;if(p&&p.isCollapsed&&!n){if(t(),c===ma.PAGE){s({editorModel:h,blockId:l,left:o,right:i});return}return st({$ignoreSlash:!0}),h.requestFocus(),e.dropdown({modalId:Ve.INLINE_PANEL,popcorn:{getBoundingClientRect(){return h.getBoundingClientRectOfRange(o,o)}},closeAfterCallBack:()=>{st({$ignoreSlash:!1}),c===ma.EMOJI&&st({$allowEmojiPanel:!1})},placement:"bottom-start",offset:[0,10],content:({onCloseModal:g})=>r.jsx(dye,{symbol:u,getEditorModel:d,onCloseModal:g,blockId:l,inlineType:c,left:o,right:i,keyword:f,onGlobalCaptureKeydown:_=>{(Ie("enter")(_)||Ie("shift+enter")(_))&&(_.stopImmediatePropagation(),g())}})}),!0}};return y.useCallback(a,[t,s,n,e])},uye=e=>{const t=t$(),n=Nn();return y.useCallback((a,o,i,l)=>{const c=n(e);if(!c)return;const{selection:d}=c;if(!d||!d.isCollapsed)return;const u=d.focusOffset-(i.length-1);t(u,d.focusOffset,e,o,n,i,l)&&a.preventDefault()},[n,t,e])},fye=e=>{const t=Nn(),n=s=>{const a=t(e);if(!a)return;const{selection:o}=a;if(!o)return;const{focusOffset:i}=o;if(i<2)return;const l=ta(Jr(a.content,i-2,i-1)),c=d=>{a.performChange(u=>{u.shadow().select(i-2,i).replace(d).release()})};l==="-"&&(s===">"||s==="》")&&c("→"),(l==="<"||l==="《")&&s==="-"&&c("←"),(l==="!"||l==="！")&&s==="="&&c("≠"),(l==="<"||l==="《")&&s==="="&&c("≤"),(l===">"||l==="》")&&s==="="&&c("≥")};return y.useCallback(n,[t,e])},c2=e=>{const{model:t}=e||{},n=Nn();return y.useCallback(s=>{const a=t||n(s);a&&a.performChange(o=>n$(a,{ctx:o,selection:o.selection}))},[t,n])},n$=(e,t)=>{const{ctx:n,selection:s}=t;if(!s)return;const a=Jr(e.content,s.offset,s.endOffset),o=ta(a);a.items.every(l=>{var c;return l.type==="element"&&l.tag===Jl?!0:l.type==="element"&&l.tag===fa?(c=l.content)==null?void 0:c.items.every(d=>d.type==="element"&&d.tag===Jl):!1})?(n.shadow().select(s.offset,s.endOffset).replace(Wn([ti("".concat(o),e.format)])).release(),e.requestFocus()):n.select(s.offset,s.endOffset).replace(Wn([Is(Jl,{text:o,textFormat:e.format})])).collapse("end")},Xj=e=>{const t=Oe(),n=Nn(),s=Nr(),a=(o,i)=>{const{blocks:l}=pe(),c=l[e];if(!c)return;const d=n(e),u=d==null?void 0:d.selection;if(!u||!u.isCollapsed||u.offset!==i)return;const[f]=TF(c.data.segments,0,i);if(!f)return;const h=f.text;if(!["--","**","－－","＊＊"].includes(h))return;o.preventDefault();const p=TF(c.data.segments,i),g=[...new Set(h.split(""))].join();_e(e,{data:{segments:[{...f,text:[...new Array(3)].map(()=>g).join("")},...p]}},!0),t(()=>{_e(c.uuid,{data:{segments:p}}),ut({type:m.BlockType.DIVIDER},{parentId:c.parentId,before:c.uuid}),re(sr({init(){s(e,0)},redo(){s(e,0)},undo(){s(e,3)}}))})};return y.useCallback(a,[s,n,t,e])},mye=(e,t)=>{const n=Oe(),s=Nr(),a=Nn(),o=Xj(e),i=async l=>{var p;const{content:c}=l.detail,d=a(e);if(!d)return;const u=g=>{setTimeout(()=>{d.performChange(_=>{const{selection:x}=d;if(!x)return;const F=x.offset;_.select(F,F).setFormat({[g]:!1})})})},f=g=>{const{redoFocus:_,intFocus:x,undoFocus:F,segments:b}=g;n(()=>{re(Sn({uuid:e,patch:{data:{[t]:b}}})),re(sr({init(){s(e,x)},redo(){s(e,_)},undo(){s(e,F)}}))})};if([">","="].includes(c)){const g=c===">",_=c==="=",F=(p={"=":"==",">":"<u>"}[c])!=null?p:"".concat(c),{hitText:b,lastSameIndex:w}=Kh({symbol:F,model:d}),{selection:E}=d;if(!E)return;const{focusOffset:C}=E;if(!b)return;f({intFocus:C,redoFocus:C,undoFocus:C+F.length,segments:mr(d.content)}),d.performChange(k=>{const T=w,v=E.offset,I=k.shadow().select(T,v),j={...I.format};g&&(I.applyFormat({underline:!j.underline}),k.select(v,v).setFormat({underline:!1}),u("underline")),_&&(I.applyFormat({color:void 0,backgroundColor:j.backgroundColor?void 0:Ze.yellow}),k.select(v,v).setFormat({color:void 0,backgroundColor:Ze.yellow}),u("color")),I.select(v-F.length,v).delete().select(T-F.length,T).delete().release()}),f({intFocus:C-F.length,redoFocus:C-F.length,undoFocus:C+F.length,segments:mr(d.content)});return}const h=d.onAfterInput.subscribe(()=>{h.unsubscribe();const{selection:g}=d;if(!g)return;const{isCollapsed:_,focusOffset:x}=g;if(!_||x<2)return;if(["*","_"].includes(c)){const{hitText:E,lastSameIndex:C}=Kh({symbol:"".concat(c).concat(c),model:d});if(E){const k=mr(d.content);f({intFocus:x-4,redoFocus:x,undoFocus:x-1,segments:k}),d.performChange(T=>{const v=C,I=g.offset,j=T.shadow().select(v,I),S={...j.format};j.applyFormat({bold:!S.bold}),T.select(I,I).setFormat({bold:!1}),u("bold"),j.select(I-2,I).delete().select(v-2,v).delete().release()}),f({intFocus:x-2,redoFocus:x-2,undoFocus:x,segments:mr(d.content)});return}}["*"].includes(c)&&o(l,3);const b=E=>{const{shadowContext:C,left:k,right:T,size:v}=E,I=r3(d.content,k+v,T-v,j=>j.type==="element"&&j.tag===fa);I.length>0?C.unwrap(fa,I):(C.select(k,T-v),C.wrap(fa,{})),C.selection&&(C.shadow().select(C.selection.offset-v,C.selection.offset).delete().release(),C.shadow().select(C.selection.endOffset,C.selection.endOffset+v).delete().release(),C.release())};if(["`","·"].includes(c)){const E=Kh({symbol:"".concat(c).concat(c).concat(c),model:d});if(E.hitText){const C=mr(d.content);f({intFocus:x-3,redoFocus:x-3,undoFocus:x,segments:C}),d.performChange(k=>{const T=E.lastSameIndex,v=g.offset,I=k.shadow().select(T,v);b({shadowContext:I,left:T,right:v,size:3})}),f({intFocus:x-3,redoFocus:x-3,undoFocus:x,segments:mr(d.content)});return}}const w=Kh({symbol:c,model:d});if(w.hitText){const E=mr(d.content);f({intFocus:x-2,redoFocus:x,undoFocus:x-1,segments:E}),d.performChange(T=>{const v=w.lastSameIndex,I=g.offset,j=T.shadow().select(v,I),S={...j.format};switch(c){case"$":{j.select(I-1,I).delete().select(v-1,v).delete().release();const D=T.select(v-1,I-2);n$(d,{ctx:T,selection:D.selection});return}case"*":case"_":{j.applyFormat({italic:!S.italic}),T.select(I,I).setFormat({italic:!1}),u("italic");break}case"~":case"～":{j.applyFormat({lineThrough:!S.lineThrough}),T.select(I,I).setFormat({lineThrough:!1}),u("lineThrough");break}case"`":case"·":{b({shadowContext:j,left:v,right:I,size:1});return}}j.select(I-1,I).delete().select(v-1,v).delete().release()});const C=mr(d.content);let k=2;(c==="`"||c==="·")&&(k=0),f({intFocus:x-k,redoFocus:x-k,undoFocus:x,segments:C})}})};return y.useCallback(i,[s,a,o,t,n,e])},d2=e=>{const{model:t}=e||{},n=Nn();return y.useCallback(s=>{const a=t||n(s);a&&a.performChange(o=>{if(o.selection===null)return;const i=r3(a.content,o.selection.offset,o.selection.endOffset,l=>l.type==="element"&&l.tag===fa);if(i.length>0){o.unwrap(fa,i);return}o.selection.isCollapsed?o.insert(Wn([{type:"element",tag:fa,props:{},content:Wn([])}])).select(o.selection.focusOffset-1):o.wrap(fa,{})})},[t,n])},Qj=y.createContext({recordId:"",tableId:"",spans:{},indexRanges:[]}),u2=()=>y.useContext(Qj),hye=()=>{const e=Ln();return y.useCallback(t=>{const n=bn(".block-content",e);return n==null?void 0:n.querySelector('[data-block-id="'.concat(t,'"]:not([data-toc-type])'))},[e])},ff=()=>{const e=ie(),t=ln(),n=hye(),s=Nn(),a=m0(Ve.CONTEXT_DISCUSSIONS),o=rr(()=>new JE),i=lt(),l=We(i,!1,!0);return y.useCallback(c=>{var x,F,b,w,E,C,k;if(a||l)return;const{blockId:d}=c,u=pe().blocks[d];let f=(x=u==null?void 0:u.data.segments)!=null?x:[],h=null;if(c.withSelection){const T=(u==null?void 0:u.type)===m.BlockType.CODE?"".concat(d,"_mock"):d,v=(F=c.editorModel)!=null?F:s(T);if(v==null||(h=v,f=c.withSelection?mr(Jr(h.content,(w=(b=h.selection)==null?void 0:b.offset)!=null?w:0,(C=(E=h.selection)==null?void 0:E.endOffset)!=null?C:h.content.length)):mr(h.content),fe(f)===""))return}let p=!1;const g=T=>{const v=Oe(),I=Lg();return r.jsx(ZE,{manager:o,children:r.jsx(kV,{onComment:j=>{if(T.onCloseModal(),c.withSelection){const S=v(()=>{const D=I.addDiscussion({blockId:d,context:f});return I.appendComment({discussionId:D,text:j}),D});h==null||h.performChange(D=>{var P,L;(c.withSelection?D.select((P=h==null?void 0:h.selection)==null?void 0:P.offset,(L=h==null?void 0:h.selection)==null?void 0:L.endOffset):D.select()).applyFormat({customs:{...ZM(S)}})})}else v(()=>{const S=I.addDiscussion({blockId:d});return I.appendComment({discussionId:S,text:j}),S})}})})},_=()=>{if(o.hasUnsavedDrafts())return p?void 0:(e.warning({title:"放弃保存这条评论？",confirm:()=>{p=!0,o.clearUnsavedDrafts(),t(Ve.CONTEXT_DISCUSSIONS)}}),"prevent")};if(c.withSelection){if(!h)return;const{selection:T}=h;if(T==null)return;e.dropdown({modalId:Ve.CONTEXT_DISCUSSIONS,popcorn:{getBoundingClientRect(){const v=h==null?void 0:h.getBoundingClientRectOfRange(T.offset,T.endOffset);return v!=null?v:new DOMRect(-9999,-9999,0,0)}},content:g,placement:"bottom",closeBeforeCallBack:_})}else{const T=n(d);if(T==null)return;e.dropdown({modalId:Ve.CONTEXT_DISCUSSIONS,popcorn:(k=c.popcorn)!=null?k:T,content:g,placement:"bottom",closeBeforeCallBack:_})}},[t,o,s,a,e,n,l])},s$=e=>{const{recordId:t}=u2(),n=ff(),s=Nn();return y.useCallback(()=>{var o;const a=s(e);n({blockId:t||e,editorModel:a,withSelection:!((o=a==null?void 0:a.selection)!=null&&o.isCollapsed)})},[s,n,t,e])},f2=()=>{const e=Nn();return y.useCallback((t,n)=>{const s=e(t);if(!s)return;const{format:a}=s;switch(n){case"bold":s.performChange(o=>o.applyFormat({bold:!a.bold}));break;case"italic":s.performChange(o=>o.applyFormat({italic:!a.italic}));break;case"underline":s.performChange(o=>o.applyFormat({underline:!a.underline}));break;case"lineThrough":s.performChange(o=>o.applyFormat({lineThrough:!a.lineThrough}));break}},[e])},r$=e=>{const t=c2(),n=f2(),s=d2(),a=Ui(),{queryResult:o,setFakeFocus:i}=n2(e),l=Mj(e,{setFakeFocus:i}),c=s$(e),{disableEquation:d,disableLink:u}=o,f=Nn(),h=p=>{const g=f(e);if(!g)return;const{selection:_}=g;if(_){if(Ie("mod+a")(p)){_.offset===0&&_.length===g.content.length||p.stopPropagation();return}if(Ie("mod+shift+m")(p)){p.preventDefault(),c();return}if(Ie("mod+b")(p)){p.preventDefault(),n(e,"bold");return}if(Ie("mod+i")(p)){p.preventDefault(),n(e,"italic");return}if(Ie("mod+u")(p)&&(p.preventDefault(),n(e,"underline")),Ie("mod+e")(p)&&(p.preventDefault(),s(e)),Ie("mod+shift+s")(p)&&(p.preventDefault(),n(e,"lineThrough")),Ie("mod+shift+x")(p)&&!d&&(p.preventDefault(),t(e)),Ie("mod+k")(p)&&!u&&(p.preventDefault(),p.stopPropagation(),l()),Ie("mod+j")(p)){p.preventDefault(),p.stopPropagation();const x=f(e);if(!x)return;const F=x.editorElement;if(!F)return;const{selection:b}=x;if(!b)return;const{offset:w,endOffset:E}=b;a({blockId:e,popcorn:F,model:x,selection:{start:w!=null?w:0,end:E!=null?E:0},editorScene:it.TextSelected,from:ho.RtfMenu})}}};return y.useCallback(h,[f,e,d,u,c,n,s,t,l,a])},vF=120,UC=()=>{re(Ns.update({activityTableId:void 0,chosenCells:void 0}))},Kd=(e,t,n)=>{var i;const s=document.querySelector('[data-block-id="'.concat(e,'"')),a=s==null?void 0:s.querySelector('[data-table-row-index="'.concat(t,'"][data-table-column-index="').concat(n,'"]'));return(i=a==null?void 0:a.querySelector("[contenteditable]"))==null?void 0:i.dataset.editor},IF=(e,t)=>n=>{const s=e.slice();n&&s.reverse();let a=0;return s.some((o,i)=>J.ui.selectedCells.some(l=>l[t]===o)?(a=i,!0):!1),n?s.length-1-a:a},a$=e=>{const t=Oe(),n=Ks(),s=Nn();y.useEffect(()=>{let a;const o=l=>{a&&clearTimeout(a),a=setTimeout(l)},i=l=>{var h,p,g,_;const c=J.blocks[e];if(!c)return;const{selectedCells:d}=J.ui;if(!d.length||!d.some(({viewId:x})=>x===e))return;const{recordId:u,propertyId:f}=(h=d[0])!=null?h:{};if(!(!u||!f)&&Ie(["Esc","Tab","Shift+Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter","Shift+ArrowUp","Shift+ArrowDown","Shift+ArrowLeft","Shift+ArrowRight"],l)){const{focus:x}=J.simpleTable,{subNodes:F}=c,b=(g=(p=c.data.format)==null?void 0:p.tableBlockColumnOrder)!=null?g:[],w=F.findIndex(D=>D===u),E=b.findIndex(D=>D===f),C=(_=Kd(e,w,E))!=null?_:"",k=IF(b,"propertyId"),T=IF(F,"recordId"),v=()=>{const D=new Set,A=new Set;return J.ui.selectedCells.forEach(P=>{D.add(P.recordId),A.add(P.propertyId)}),{rowSet:D,columnSet:A}},I=(D,A)=>J.ui.selectedCells.some(P=>P.viewId===e&&P.syncId===n&&P.recordId===D&&P.propertyId===A);if(Ie("Esc")(l)){if(document.querySelector('[data-modal-id="'.concat(Ve.INLINE_PANEL,'"]')))return;l.stopImmediatePropagation(),re(x?Ns.update({focus:!1}):at.updateSelectBlocks([{blockId:e}])),Co(!0);return}if(Ie("Enter")(l)){if(!x){const D=T(),A=F[D],P=k(),L=b[P];A&&L&&(re(at.update({selectedCells:[{recordId:A,propertyId:L,viewId:e,syncId:n}]})),re(Ns.update({focus:!0})),Lr(Kd(e,D,P),1/0,1/0))}return}if(Ie("ArrowUp")(l)){if(x){const $=Ma(C);if(!($!=null&&$.collapsed)||!$.isFirstLine)return}const D=T(),A=k(),P=Math.max(D-1,0),L=F[P],O=b[A];L&&O&&re(at.update({selectedCells:[{recordId:L,propertyId:O,viewId:e,syncId:n}]})),o(()=>{x&&Lr(Kd(e,P,A),1/0,1/0)});return}if(Ie("Shift+ArrowUp")(l)){if(x){const A=Ma(C);if(!(A!=null&&A.isFirstLine))return;l.preventDefault(),re(Ns.update({focus:!1})),Co(!0)}const D=T(!0);if(D>w){const A=F[D];A&&re(at.update({selectedCells:J.ui.selectedCells.filter(P=>P.recordId!==A)}))}else{const A=T(),P=F[Math.max(A-1,0)];if(P&&!I(P,f)){const{columnSet:L}=v();re(at.update({selectedCells:[...J.ui.selectedCells,...[...L].map(O=>({recordId:P,propertyId:O,viewId:e,syncId:n}))]}))}}}if(Ie("ArrowDown")(l)){if(x){const $=Ma(C);if(!($!=null&&$.collapsed)||!$.isLastLine)return}const D=T(!0),A=k(!0),P=Math.min(D+1,F.length-1),L=F[P],O=b[A];L&&O&&re(at.update({selectedCells:[{recordId:L,propertyId:O,viewId:e,syncId:n}]})),o(()=>{x&&Lr(Kd(e,P,A),0,0)});return}if(Ie("Shift+ArrowDown")(l)){if(x){const A=Ma(C);if(!(A!=null&&A.isLastLine))return;l.preventDefault(),re(Ns.update({focus:!1})),Co(!0)}const D=T();if(D<w){const A=F[D];A&&re(at.update({selectedCells:J.ui.selectedCells.filter(P=>P.recordId!==A)}))}else{const A=T(!0),P=F[Math.min(A+1,F.length-1)];if(P&&!I(P,f)){const{columnSet:L}=v();re(at.update({selectedCells:[...J.ui.selectedCells,...[...L].map(O=>({recordId:P,propertyId:O,viewId:e,syncId:n}))]}))}}}const j=D=>{let A=w,P=E;if(E+1>=b.length){if(w+1>=F.length)return;A=w+1;const O=F[A];P=0;const $=b[P];O&&$&&re(at.update({selectedCells:[{recordId:O,propertyId:$,viewId:e,syncId:n}]}))}else{P=E+1;const O=b[P];O&&re(at.update({selectedCells:[{recordId:u,propertyId:O,viewId:e,syncId:n}]}))}const L=Kd(e,A,P);if(D)o(()=>Co(!0)),re(Ns.update({focus:!1}));else{if(!x)return;o(()=>{Lr(L,0,0)})}};if(Ie("Tab")(l)){if(E+1>=b.length&&w+1>=F.length){const D=F[F.length-1];let A="";t(()=>{A=ut({type:m.BlockType.TABLE_ROW},{parentId:e,after:D})});const P=b[0];P&&(l.preventDefault(),re(at.update({selectedCells:[{recordId:A,propertyId:P,viewId:e,syncId:n}]})),re(Ns.update({focus:!1})));return}j(!0)}if(Ie("ArrowRight")(l)){if(x){const D=Ma(C);if(!(D!=null&&D.collapsed)||!D.isLastChar)return}j()}if(Ie("Shift+ArrowRight")(l)){if(x){const A=Ma(C);if(!(A!=null&&A.isLastChar))return;l.preventDefault(),re(Ns.update({focus:!1})),Co(!0)}const D=k();if(D<E){const A=b[D];A&&re(at.update({selectedCells:J.ui.selectedCells.filter(P=>P.propertyId!==A)}))}else{const A=k(!0),P=b[Math.min(A+1,b.length-1)];if(P&&!I(u,P)){const{rowSet:L}=v();re(at.update({selectedCells:[...J.ui.selectedCells,...[...L].map(O=>({recordId:O,propertyId:P,viewId:e,syncId:n}))]}))}}}const S=D=>{let A=w,P=E;if(E-1<0){if(w-1<0)return;A=w-1;const L=F[A];P=b.length-1;const O=b[P];L&&O&&re(at.update({selectedCells:[{recordId:L,propertyId:O,viewId:e,syncId:n}]}))}else{P=E-1;const L=b[P];L&&re(at.update({selectedCells:[{recordId:u,propertyId:L,viewId:e,syncId:n}]}))}if(D)o(()=>Co(!0)),re(Ns.update({focus:!1}));else{if(!x)return;o(()=>{Lr(Kd(e,A,P),1/0,1/0)})}};if(Ie("Shift+Tab")(l)&&S(!0),Ie("ArrowLeft")(l)){if(x){const D=Ma(C);if(!(D!=null&&D.collapsed)||!D.isFirstChar)return}S()}if(Ie("Shift+ArrowLeft")(l)){if(x){const A=Ma(C);if(!(A!=null&&A.isFirstChar))return;l.preventDefault(),re(Ns.update({focus:!1})),Co(!0)}const D=k(!0);if(D>E){const A=b[D];A&&re(at.update({selectedCells:J.ui.selectedCells.filter(P=>P.propertyId!==A)}))}else{const A=k(),P=b[Math.max(A-1,0)];if(P&&!I(u,P)){const{rowSet:L}=v();re(at.update({selectedCells:[...J.ui.selectedCells,...[...L].map(O=>({recordId:O,propertyId:P,viewId:e,syncId:n}))]}))}}}}};return document.addEventListener("keydown",i,!0),()=>{document.removeEventListener("keydown",i,!0)}},[s,n,e,t])},yx=()=>{const e=Oe(),t=Js(),n=(s,a,o=m.CollectionViewType.TABLE)=>{var _,x,F,b,w,E,C,k,T;const{blocks:i}=pe();let l=s;const c=i[s];((c==null?void 0:c.type)===m.BlockType.REFERENCE_COLLECTION||(c==null?void 0:c.type)===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(l=(x=(_=c.data.ref)==null?void 0:_.uuid)!=null?x:"");const d=i[l];if(!d)return;let u={};const f=(F=d.data.schema)!=null?F:{};let h=[];const p=localStorage.getItem("viewId:".concat(s));if(p){const{properties:v=Zf(f,o),view:I}=(b=gn(p))!=null?b:{};h=Br(v),o!==m.CollectionViewType.TABLE?h.forEach(j=>{j.property!=="title"&&(j.visible=!1)}):(I==null?void 0:I.type)!==m.CollectionViewType.TABLE&&h.forEach(j=>j.visible=!0)}let g;if(o===m.CollectionViewType.TABLE&&(u=Hu({tableProperties:h})),o===m.CollectionViewType.GALLERY&&(t(Je.CREATE_GALLERY_VIEW,ct.advancedList,{step1:!0}),u=m2({galleryProperties:h})),o===m.CollectionViewType.LIST&&(u=h2({listProperties:h})),o===m.CollectionViewType.BOARD){const v=Object.keys(f).find(I=>{var j;return((j=f[I])==null?void 0:j.type)===m.CollectionSchemaType.SELECT});if(v)u=Lp({groupProperty:v,boardProperties:h,options:(w=f[v])==null?void 0:w.options});else{const{role:I}=mn(l);if(I===m.PermissionRole.READER){be.warning("当前多维表无分类属性，不支持创建看板视图！");return}g=qe();const j=jE(),{inVisibleProperty:S}=X0(g);return u=Lp({groupProperty:g,boardProperties:h.concat(S),options:j}),e(()=>{_e(l,{data:{schema:{...d.data.schema,[g]:{name:Ci(f,"分类"),type:m.CollectionSchemaType.SELECT,options:j}}}});const D=Io({title:a,format:u,pageSort:d.subNodes,type:o},{parentId:s,last:!0});return Qf(d.uuid,[g],D),D})}}if(o===m.CollectionViewType.TIMELINE){t(Je.CREATE_TIMELINE_VIEW,ct.advancedList);const v=Object.entries(f).filter(([A,P])=>P.type===m.CollectionSchemaType.DATE),{role:I}=mn(l);if(I===m.PermissionRole.READER&&v.length<2){be.warning("当前多维表无日期属性，不支持创建时间轴视图！");return}let j=(E=v[0])==null?void 0:E[0],S=(C=v[1])==null?void 0:C[0];const D=Zf(f,o);if(j&&S)u=Bp({timelineBy:j,timelineByEnd:S,timelineProperties:D});else{const A=[],P={...f};if(!j){j=qe();const L={property:j,visible:!1};A.push(L),D.push(L),P[j]={name:Ci(d.data.schema,"开始时间"),type:m.CollectionSchemaType.DATE}}if(!S){S=qe();const L={property:S,visible:!1};A.push(L),D.push(L),P[S]={name:Ci(d.data.schema,"结束时间"),type:m.CollectionSchemaType.DATE}}return u=Bp({timelineBy:j,timelineByEnd:S,timelineProperties:D}),e(()=>{_e(d.uuid,{data:{schema:P}});const L=Io({title:a,format:u,pageSort:d.subNodes,type:o},{parentId:s,last:!0});return Qf(d.uuid,A.map(O=>O.property),L),L})}}if(o===m.CollectionViewType.CALENDAR){t(Je.CREATE_CALENDAR_VIEW,ct.advancedList);const v=Object.entries(f).filter(([A,P])=>P.type===m.CollectionSchemaType.DATE),{role:I}=mn(l);if(I===m.PermissionRole.READER&&v.length<2){be.warning("当前多维表无日期属性，不支持创建日历视图！");return}let j=(k=v[0])==null?void 0:k[0],S=(T=v[1])==null?void 0:T[0];const D=Zf(f,o);if(j&&S)u=Op({calendarProperties:D,calendarBy:j,calendarByEnd:S});else{const A=[],P={...f};if(!j){j=qe();const L={property:j,visible:!1};A.push(L),D.push(L),P[j]={name:Ci(d.data.schema,"开始时间"),type:m.CollectionSchemaType.DATE}}if(!S){S=qe();const L={property:S,visible:!1};A.push(L),D.push(L),P[S]={name:Ci(d.data.schema,"结束时间"),type:m.CollectionSchemaType.DATE}}return u=Op({calendarProperties:D,calendarBy:j,calendarByEnd:S}),e(()=>{_e(d.uuid,{data:{schema:P}});const L=Io({title:a,format:u,pageSort:d.subNodes,type:o},{parentId:s,last:!0});return Qf(d.uuid,A.map(O=>O.property),L),L})}}return o===m.CollectionViewType.FORM&&(t(Je.CREATE_FORM_VIEW,ct.advancedList),u={formSerialNumber:!0,formShowDescription:!0,formDescription:[]}),e(()=>Io({title:a,format:u,pageSort:d.subNodes,type:o},{parentId:s,last:!0}))};return y.useCallback(n,[e,t])},Hu=({tableProperties:e,oldViewFormat:t={}})=>({...t,tableProperties:e,tableWrap:typeof t.tableWrap<"u"?t.tableWrap:!0}),Jj=({formProperties:e,oldViewFormat:t={}})=>({...t,formProperties:e,formShowDescription:typeof t.formShowDescription<"u"?t.formShowDescription:!0,formSerialNumber:typeof t.formSerialNumber<"u"?t.formSerialNumber:!0}),Lp=({groupProperty:e,boardProperties:t,options:n=[],oldViewFormat:s={}})=>{var o,i,l;const a=n.map(c=>({property:e,propertyType:m.CollectionSchemaType.SELECT,value:c.value,visible:!0}));return a.unshift({property:e,propertyType:m.CollectionSchemaType.SELECT,visible:!0}),{...s,boardGroupBy:{property:e},boardCoverType:(o=s.boardCoverType)!=null?o:m.CoverType.NONE,boardCardSize:(i=s.boardCardSize)!=null?i:m.CardSize.MEDIUM,boardCoverAspect:(l=s.boardCoverAspect)!=null?l:m.CoverAspectType.COVER,boardProperties:t,boardGroups:a}},m2=({galleryProperties:e,oldViewFormat:t={}})=>{var s,a,o;return{...t,galleryProperties:e,galleryCoverType:(s=t.galleryCoverType)!=null?s:m.CoverType.PAGE_CONTENT,galleryCardSize:(a=t.galleryCardSize)!=null?a:m.CardSize.MEDIUM,galleryCoverAspect:(o=t.galleryCoverAspect)!=null?o:m.CoverAspectType.COVER}},h2=({listProperties:e,oldViewFormat:t={}})=>({...t,listProperties:e}),Bp=({timelineProperties:e,oldViewFormat:t={},timelineBy:n,timelineByEnd:s})=>({...t,timelineProperties:e,timelineBy:n,timelineByEnd:s,timelineTableProperties:e,timelineShowTable:!0}),Op=({calendarProperties:e,oldViewFormat:t={},calendarBy:n,calendarByEnd:s})=>({...t,calendarProperties:e,calendarBy:n,calendarByEnd:s}),Zf=(e,t=m.CollectionViewType.TABLE)=>Object.keys(e).map(n=>({property:n,visible:n==="title"||t===m.CollectionViewType.TABLE})),pye=async(e,t)=>{var c,d,u,f,h,p,g;const n=await ve.editor.getDoc.raw(e);if(n.code!==200){(c=t.onError)==null||c.call(t,n);return}const s=n.data.blocks[e];if(!s||!s.data.schema){(d=t.onError)==null||d.call(t,{code:-1,msg:"collection not found"});return}const a=(h=(u=t.getViewId)==null?void 0:u.call(t,s.views))!=null?h:(f=s.views)==null?void 0:f[0];if(!a){(p=t.onError)==null||p.call(t,{code:-1,msg:"viewId not found"});return}(g=t.onDataUpdate)==null||g.call(t,n.data);let o=Zj(n.data,e,a);const i=gye(s);if(t.filter){const{filter:_}=t;o=o.filter(x=>_(x,s,i))}return t.convertToTargets(o,s,i)};function Zj(e,t,n){var l;const s=(l=e.collectionViews)==null?void 0:l[n],a=e.blocks[t];if(!s||!a)return[];const o=[],{newPageSort:i}=SE(s.pageSort,a.subNodes);for(const c of i){const d=e.blocks[c];d&&o.push(d)}return o}const _Re=(e,t,n)=>{var o,i;const s=t[n],a=s==null?void 0:s.id;if(!a)return[];switch(s.schema.type){case m.CollectionSchemaType.FILE:{const l=(o=e.data.collectionProperties)==null?void 0:o[a];return(i=l==null?void 0:l.filter(c=>c.fileStorageType==="internal"&&c.type===m.TextType.URL).map(c=>{var d;return(d=c.url)!=null?d:""}))!=null?i:[]}default:return[]}},l_=(e,t,n)=>{var o,i,l;const s=t[n],a=s==null?void 0:s.id;if(!a)return"";switch(s.schema.type){case m.CollectionSchemaType.TITLE:return fe(e.data.segments);case m.CollectionSchemaType.FILE:case m.CollectionSchemaType.URL:{const c=(o=e.data.collectionProperties)==null?void 0:o[a];return Oi(c)}case m.CollectionSchemaType.CHECKBOX:return us(fe((i=e.data.collectionProperties)==null?void 0:i[a]))?"YES":"NO";default:return fe((l=e.data.collectionProperties)==null?void 0:l[a])}},xRe=(e,t,n)=>{var o;const s=t[n],a=s==null?void 0:s.id;if(!a)return[];switch(s.schema.type){case m.CollectionSchemaType.TITLE:return e.data.segments;default:return(o=e.data.collectionProperties)==null?void 0:o[a]}},gye=e=>{var n;const t={};return Object.entries((n=e.data.schema)!=null?n:{}).forEach(([s,a])=>{t[a.name]={id:s,schema:a}}),t},h6="一级分类",p6="二级分类",g6="三级分类",_ye="模板名称",xye="模板来源",yye="模板来源配图",bye="模板介绍配图",Fye="上线",wye="模板介绍",Eye="模板链接",Cye=()=>y.useCallback(async()=>{var i;const e=await ve.editor.getDoc.raw("6a4efea1-e023-4e99-bb69-d69af5909412");if(e.code!==200){be.error("模板中心加载失败[101]");return}const t=e.data.blocks["6a4efea1-e023-4e99-bb69-d69af5909412"];if(!t||!t.data.schema){be.error("模板中心加载失败[102]");return}const n=(i=t.views)==null?void 0:i[0];if(!n){be.error("模板中心加载失败[103]");return}const{blocks:s,collectionViews:a}=e.data;a&&re(kl.update(a)),re(Tn.update({blocks:s}));const o=Zj(e.data,"6a4efea1-e023-4e99-bb69-d69af5909412",n).filter(l=>us(bi(l,Fye)));return vye(o)},[]),VC="7eb46e2d-2747-4dd7-8e60-491687c92f93",kye="展示广告",Tye="用户id",Zy=new Set,yRe=async()=>{var o;const e=await ve.editor.getDoc.raw(VC);if(e.code!==200){console.warn("广告表格加载失败[101]");return}const{blocks:t}=e.data;re(Tn.update({blocks:t}));const n=e.data.blocks[VC];if(!n||!n.data.schema){console.warn("广告表格加载失败[102]");return}const s=(o=n.views)==null?void 0:o[0];if(!s){console.warn("广告表格加载失败[103]");return}const a=Zj(e.data,VC,s).filter(i=>us(bi(i,kye)));return Zy.clear(),a.forEach(i=>{const l=bi(i,Tye).trim();Zy.add(l)}),Zy},bi=(e,t)=>{var i,l,c;let n;if(typeof e=="string"){const{blocks:d}=pe();n=d[e]}else n=e;if(!n)return"";const a=o$(n.parentId)[t],o=a==null?void 0:a.id;if(!o)return"";switch(a.schema.type){case m.CollectionSchemaType.TITLE:return fe(n.data.segments);case m.CollectionSchemaType.FILE:case m.CollectionSchemaType.URL:{const d=(i=n.data.collectionProperties)==null?void 0:i[o];return Oi(d)}case m.CollectionSchemaType.CHECKBOX:return us(fe((l=n.data.collectionProperties)==null?void 0:l[o]))?"YES":"NO";default:return fe((c=n.data.collectionProperties)==null?void 0:c[o])}},vye=e=>{var f,h,p;const t=[],n={};e.forEach(g=>{var v,I,j,S;const _=bi(g,h6);if(!_)return;const x=bi(g,p6);if(!x)return;const F=bi(g,g6),b=NF(g);if(!b)return;let w=n[_];w||(w={name:_,subGroups:[]},t.push(w),n[_]=w);const E=_+x;let C=n[E];if(C||(C={name:x,subGroups:[]},(v=w.subGroups)==null||v.push(C),n[E]=C),!F){C.templates=[...(I=C.templates)!=null?I:[]].concat(b);return}const k=_+x+F;let T=n[k];T||(T={name:F,templates:[]},(j=C.subGroups)==null||j.push(T),n[k]=T),T.templates=[...(S=T.templates)!=null?S:[]].concat(b)});const{blocks:s}=pe(),a=o$("6a4efea1-e023-4e99-bb69-d69af5909412");if(!s["6a4efea1-e023-4e99-bb69-d69af5909412"])return;const{schema:i}=(f=a[h6])!=null?f:{},{schema:l}=(h=a[p6])!=null?h:{},{schema:c}=(p=a[g6])!=null?p:{};if(!(i!=null&&i.options)||!(l!=null&&l.options)||!(c!=null&&c.options))return;const d={};i.options.forEach(({value:g},_)=>d["1".concat(g)]=_),l.options.forEach(({value:g},_)=>d["2".concat(g)]=_),c.options.forEach(({value:g},_)=>d["3".concat(g)]=_);const u=(g,_=1)=>{g.forEach(x=>{var F;x.subGroups&&u((F=x.subGroups)!=null?F:[],_+1)}),g.sort((x,F)=>{var b,w;return((b=d[_+x.name])!=null?b:0)-((w=d[_+F.name])!=null?w:0)})};return u(t),t},NF=e=>{let t;if(typeof e=="string"){const{blocks:o}=pe();t=o[e]}else t=e;if(!t)return;const n=bi(t,Eye),{pathname:s}=new URL(n);return{id:s.trim().substring(s.lastIndexOf("/")+1),pageId:t.uuid,name:bi(t,_ye),source:bi(t,xye),sourceImage:bi(t,yye),desc:bi(t,wye),image:bi(t,bye)}},o$=e=>{var a;const t={},{blocks:n}=pe(),s=n[e];return s&&Object.entries((a=s.data.schema)!=null?a:{}).forEach(([o,i])=>{t[i.name]={id:o,schema:i}}),t},ih=()=>{const e=qE();return y.useCallback((t,n)=>{const s=J.blocks[t.parentId];if(!(!s||e(n))){if([m.BlockType.TEXTAREA,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.TODO,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE].includes(s.type)){if(s.subNodes.length===0)return ut({type:ir(s.type)||[m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER].includes(s.type)?m.BlockType.TEXTAREA:s.type,local:!0},t);let o=s.subNodes[0];if(t.last?o=s.subNodes[s.subNodes.length-1]:t.before?o=w5(t.before):t.after&&(o=t.after),o){const i=J.blocks[o];if(i&&[m.BlockType.TEXTAREA,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.TODO].includes(i.type))return ut({type:i.type,local:!0},t)}return ut({type:m.BlockType.TEXTAREA,local:!0},t)}return ut({type:m.BlockType.TEXTAREA,local:!0},t)}},[e])},Iye=(e,t)=>{ZB[e]=t},Nye=e=>ZB[e],e4=(e,t,n=pe().blocks)=>{const s=n[e];if(!s||s.subNodes.length>1)return!1;const a=o=>{var i;for(const l of o){const c=n[l];if(!c)continue;const d=c.type;if(IE.has(d))switch(c.type){case m.BlockType.TEXTAREA:case m.BlockType.TODO:case m.BlockType.HEADER:case m.BlockType.MARK:case m.BlockType.QUOTE:case m.BlockType.LIST:case m.BlockType.ORDER_LIST:case m.BlockType.FOLD_LIST:{const u=fe(c.data.segments).trim();if(u){if(l===t&&/^\/\w*/.test(u))continue;return!1}break}case m.BlockType.COLUMN:case m.BlockType.COLUMN_LIST:return a((i=c.subNodes)!=null?i:[])}}return!0};return a(s.subNodes)},wl={[m.CollectionViewType.TABLE]:"表格",[m.CollectionViewType.BOARD]:"看板",[m.CollectionViewType.GALLERY]:"画廊",[m.CollectionViewType.LIST]:"目录",[m.CollectionViewType.TIMELINE]:"时间轴",[m.CollectionViewType.CALENDAR]:"日历",[m.CollectionViewType.FORM]:"收集表",[m.CollectionViewType.SPACE]:""},Ga={[m.CollectionViewType.TABLE]:"IcTable",[m.CollectionViewType.BOARD]:"IcBoard",[m.CollectionViewType.GALLERY]:"IcGallery",[m.CollectionViewType.LIST]:"IcList",[m.CollectionViewType.TIMELINE]:"IcTimeline",[m.CollectionViewType.CALENDAR]:"IcCalendar",[m.CollectionViewType.FORM]:"IcForm",[m.CollectionViewType.SPACE]:null},jF=[{name:"表格",type:m.CollectionViewType.TABLE,helperLink:_i.tableViewLink},{name:"看板",type:m.CollectionViewType.BOARD,helperLink:_i.boardViewLink},{name:"画廊",type:m.CollectionViewType.GALLERY,helperLink:_i.galleryViewLink},{name:"目录",type:m.CollectionViewType.LIST,helperLink:_i.listViewLink},{name:"时间轴",type:m.CollectionViewType.TIMELINE,helperLink:_i.timeViewLink},{name:"日历",type:m.CollectionViewType.CALENDAR,helperLink:_i.calendarViewLink},{name:"收集表",type:m.CollectionViewType.FORM,helperLink:_i.formViewLink}],jye=()=>{const e=ie(),t=Sye();return y.useCallback(async({popcorn:n,collectionId:s,blockId:a,isCopyLink:o})=>{var u;const{blocks:i}=pe(),l=i[s],c=[];((u=l==null?void 0:l.views)!=null?u:[]).forEach(f=>{c.push({id:f,table:"collectionView"})});const{collectionViews:d}=await ve.editor.queryRecords({requests:c});d&&re(kl.update(d)),e.dropdown({popcorn:n,placement:"bottom-start",content:({onCloseModal:f})=>{var F;const{blocks:h,collectionViews:p}=pe(),g=h[s],_=h[a];if(!g||!_)return null;const x=[];return((F=g.views)!=null?F:[]).forEach(b=>{const w=p[b];w&&w.type!==m.CollectionViewType.FORM&&x.push({type:H.OPERATION,data:{viewId:b,title:w.title||wl[w.type],icon:r.jsx(V,{name:Ga[w.type],size:"middle"})}})}),r.jsxs("div",{className:"next-modal w-52 py-1.5",children:[r.jsx("p",{className:"text-t2 h-10 flex items-center pl-4",children:"复制多维表视图"}),r.jsx(ze,{items:x,onItemClick:async b=>{await t({collectionId:s,blockId:a,isCopyLink:o,viewId:b.data.viewId}),f()}})]})}})},[t,e])},Sye=()=>{const e=Oe();return y.useCallback(async({collectionId:t,blockId:n,isCopyLink:s,viewId:a})=>{var f;const o=J.blocks[t],i=[];((f=o==null?void 0:o.views)!=null?f:[]).forEach(h=>{i.push({id:h,table:"collectionView"})});const{collectionViews:l}=await ve.editor.queryRecords({requests:i});l&&re(kl.update(l));const c=J.blocks[n];if(!o||!c)return null;const d={type:m.BlockType.REFERENCE_COLLECTION,data:{ref:{uuid:t}}};let u=Ep(c.data);if(s){re(jm());const{blocks:h}=pe(),p=h[n];p&&(u=Ep(p.data))}u&&c.type===m.BlockType.TEXTAREA?e(()=>{nr([n],d),_6(n,a)}):e(()=>{const h=ut(d,{parentId:c.parentId,after:n});_6(h,a)})},[e])},_6=(e,t)=>{const{collectionViews:n}=pe(),s=n[t];s&&Io({type:s.type,pageSort:s.pageSort,format:{...s.format,formShared:!1},title:s.title,shareId:void 0},{parentId:e,last:!0})},Dye=e=>{const t=Fc(),[n,s]=y.useState(""),{blockId:a,popcorn:o,selectItem:i,slash:l,blockNoText:c,cursorLeft:d,cursorRight:u,syncId:f}=e,h=afe(),{getEditorModel:p,focusEditableAt:g}=e,_=Aye(a,g,f),x=Oe(),F=t$(),b=c9(),w=localStorage.getItem(t0),E=lt(),C=Ce(({blocks:j})=>e4(E,a,j),[E,a]),{enableAI:k}=xr(),T=y.useMemo(()=>{var O;const j=id(B3((O=b[0])!=null?O:"")?b.slice(1):b),S="".concat(j,"-pageIsEmpty-").concat(C,"-enableAI-").concat(k),D=Nye(S);if(D)return D;const A={aiAssistantWithEmptyDoc:[],aiAssistantWithNotEmptyDoc:[],basicBlock:[],media:[],inlineElement:[],database:[],embed:[],advanced:[],layout:[],turninto:[],action:[],lastUsedColor:[],color:[],colorBackground:[]};ka(h).forEach($=>{if(!k&&($==="aiAssistantWithEmptyDoc"||$==="aiAssistantWithNotEmptyDoc")||k&&(C&&$==="aiAssistantWithNotEmptyDoc"||!C&&$==="aiAssistantWithEmptyDoc"))return;h.advanced.ad.isHidden=!Zy.has(yt.uuid);const M=h[$],U=f5[$],z=Qi[$];jo(M).forEach(K=>{var ee;const W=K;if(W.isHidden)return;const Y=f&&W.data.type===m.BlockType.SYNC_CONTAINER;if(((ee=W.data.thesaurus)!=null?ee:[]).some(te=>te.includes(j))&&!Y){switch($){case"aiAssistantWithEmptyDoc":case"aiAssistantWithNotEmptyDoc":A[$].length===0&&A[$].push(ty(Qi[$],{titleSuffix:r.jsx("span",{className:"text-t2 px-1.5 bg-grey/20 rounded-sm ml-2 text-grey2 inline-flex items-center",children:"Beta"})}));break;case"inlineElement":case"basicBlock":case"embed":case"media":case"database":case"advanced":A[$].length===0&&A[$].push(ty(Qi[$]));break;case"layout":case"turninto":case"action":case"color":case"colorBackground":A[$].length===0&&l&&A[$].push(ty(Qi[$]));break;case"lastUsedColor":if(w&&w!=="undefined"){A[$].push(ty(Qi[$]));const Q=JSON.parse(w);W.data={...W.data,...Q.isBgColor?{backgroundColor:Q.colorkey||"default"}:{textColor:Q.colorkey||"default"},title:Q.desc,keywords:[Q.colorkey||"default"],params:{...Q.isBgColor?{backgroundColor:Q.colorkey||"",textColor:""}:{backgroundColor:"",textColor:Q.colorkey||""}}}}else return;break}const te=[...W.data.keywords].filter(Q=>!!Q);W.matchAll=!!(j&&!$.includes(j)&&te.some(Q=>Q.includes(j))),W.matchAll&&[U.pinyin,U.initials,z].join(" ").includes(j)&&(W.matchAll=!1),A[$].push(W)}})}),ka(A).forEach($=>{const M=A[$];M.some(z=>z.matchAll)&&(A[$]=[...M.filter(z=>z.matchAll||z.type==="blockText")])});const P=l?Ek(jo(A).map($=>$)):Ek(jo([...A.aiAssistantWithEmptyDoc,...A.aiAssistantWithNotEmptyDoc,...A.basicBlock,...A.inlineElement,...A.database,...A.media,...A.embed,...A.advanced]).map($=>$)),L=[];return P.forEach(($,M)=>{$.type==="blockText"&&M!==0&&L.push({type:H.LINE}),L.push($)}),Iye(S,L),L},[b,h,l,f,w,k,C]);y.useEffect(()=>{if(T.length===0)if(!n)s(b);else{const j=b.replace(/[^\x00-\xff]/g,"**").length,S=n.replace(/[^\x00-\xff]/g,"**").length;j-S>=5&&t()}else n&&s("")},[t,T.length,b,n]);const v=y.useCallback(j=>{i==null||i(),x(()=>{_({...j,blockNoText:c,popcorn:o,slash:l})})},[_,c,o,i,l,x]),I=y.useCallback(j=>{const{type:S,params:D,isInline:A,actionType:P,tableType:L,title:O,category:$,aiEditType:M}=j.data;j.data.renderSubMenu||(me.event("block_choose",{block_name:O,block_type:S,block_category:$,is_from:l?"slash":"add"}),A?F(d.offset,u.offset,a,S,p):v({type:S,params:D,actionType:P,tableType:L,aiEditType:M}))},[a,d.offset,u.offset,p,F,l,v]);return T.length?r.jsx(ze,{virtualList:!0,className:"py-2 overflow-y-auto w-72 next-modal min-h-6",items:T,onItemClick:I,defaultActiveIndex:T.length>1?1:0}):null},Aye=(e,t,n)=>{const s=Js(),a=ye(e,["backgroundColor","subNodes","textColor"]),o=jd(),i=ie(),l=ln(),c=Lw(),d=Oe(),u=jg(),f=Pd(),h=_w(),p=N3(),g=ih(),_=ys(),x=jye(),F=lt(),b=Ce(({blocks:C})=>e4(F,e,C),[F,e]),w=Ui(),E=async C=>{var P,L,O,$,M;const{type:k,params:T={},popcorn:v,blockNoText:I,actionType:j,slash:S,tableType:D,aiEditType:A}=C;if(a){switch(k){case m.BlockType.PAGE:s(Je.GUIDE_FIRST_TIME_CREATED_PAGE,ct.basicList),s(Je.CREATE_NEW_PAGE,ct.basicList);break;case m.BlockType.TODO:s(Je.CREATE_TODO_BLOCK,ct.basicList);break;case m.BlockType.HEADER:s(Je.CREATE_HEADER_BLOCK,ct.basicList,{step1:!0});break;case m.BlockType.QUOTE:s(Je.CREATE_QUOTE_BLOCK,ct.basicList);break;case m.BlockType.MARK:s(Je.CREATE_MARK_BLOCK,ct.basicList);break;case m.BlockType.FILE:T.data.display==="image"&&s(Je.CREATE_IMAGE_BLOCK,ct.basicList,{step1:!0});break;case m.BlockType.MIND_MAPPING:case m.BlockType.MIND_MAPPING_PAGE:s(Je.CREATE_MIND_MAP,ct.advancedList);break;case m.BlockType.COLLECTION_VIEW:case m.BlockType.COLLECTION_VIEW_PAGE:switch(s(Je.CREATE_BITABLE_EXPLORE,ct.basicList),s(Je.GUIDE_FIRST_TIME_CREATED_COLLECTION,ct.basicList),D){case m.CollectionViewType.GALLERY:s(Je.CREATE_GALLERY_VIEW,ct.advancedList,{step1:!0});break;case m.CollectionViewType.CALENDAR:s(Je.GUIDE_FIRST_TIME_CALENDAR_VIEW,ct.advancedList),s(Je.CREATE_CALENDAR_VIEW,ct.advancedList);break;case m.CollectionViewType.TIMELINE:s(Je.GUIDE_FIRST_TIME_TIMELINE_VIEW,ct.advancedList),s(Je.CREATE_TIMELINE_VIEW,ct.advancedList);break;case m.CollectionViewType.FORM:s(Je.GUIDE_FIRST_TIME_COLLECTION_VIEW,ct.advancedList),s(Je.CREATE_FORM_VIEW,ct.advancedList);break}break;case m.BlockType.FOLDER:s(Je.CREATE_FOLDER_AND_UPLOAD,ct.basicList,{step1:!0}),s(Je.GUIDE_FIRST_TIME_CREATED_FOLDER,ct.basicList);break;case m.BlockType.TABLE:s(Je.CREATE_SIMPLE_TABLE,ct.basicList),s(Je.GUIDE_FIRST_TIME_CREATED_TABLE,ct.basicList);break;case m.BlockType.TEMPLATE:s(Je.GUIDE_FIRST_TIME_CREATED_TEMPLATE,ct.advancedList),s(Je.CREATE_TEMPLATE_BUTTON,ct.advancedList);break;case m.BlockType.SYNC_CONTAINER:s(Je.GUIDE_FIRST_TIME_CREATED_SYNC,ct.advancedList),s(Je.CREATE_SYNC_BLOCK_NEW,ct.advancedList,{step1:!0});break;case m.BlockType.COLUMN_LIST:s(Je.CREATE_COLUMNS_BLOCK,ct.basicList),s(Je.GUIDE_FIRST_TIME_CREATED_COLUMN_LIST,ct.basicList);break}if(S&&s(Je.GUIDE_FIRST_TIME_SHORTCUT_CREATED,ct.advancedList),j===Xe.AI_EDITOR){const U=document.querySelector('[data-block-id="'.concat(e,'"]'));if(!U)return;w({popcorn:U,blockId:e,editorScene:b?it.PageEmpty:it.PageHasContent,editType:A,selection:{start:(P=p.left)!=null?P:0},from:ho.ContextMenu}),l(h);return}if(j===Xe.CREATE)switch(k){case m.BlockType.COLUMN_LIST:{if(!!T.columnCount)XV(e,T.columnCount,{convertBlock:nr});else{const z=[...c(e)],{blocks:K}=pe();let W="";for(const Y of z){if(((L=K[Y])==null?void 0:L.type)===m.BlockType.PAGE)break;((O=K[Y])==null?void 0:O.type)===m.BlockType.COLUMN&&(W=Y)}if(W){const Y=K[W];if(Y){const G=ut({type:m.BlockType.TEXTAREA},{parentId:Y.uuid});G&&kF([G],Y.uuid,T.left?"left":"right")}}else{const Y=ut({type:m.BlockType.TEXTAREA},{parentId:a.parentId,after:e});Y&&kF([Y],e,T.left?"left":"right")}}break}case m.BlockType.REFERENCE:{const U=p1({ancestorId:a.spaceId,filterTypes:[m.BlockType.FILE]});setTimeout(()=>{st({$textareaPlaceHolder:{blockId:e,alwaysShow:!0,placeHolder:"指定引用页面"}})},250),i.dropdown({popcorn:v,placement:"top-start",closeAfterCallBack:()=>{st({$textareaPlaceHolder:void 0})},content:z=>r.jsx(oc,{defaultValue:U,onSelect:K=>{d(()=>{z.onCloseModal(),I&&a.type===m.BlockType.TEXTAREA?nr([e],{type:m.BlockType.REFERENCE,data:{ref:{uuid:K.uuid},...T.data}}):ut({type:m.BlockType.REFERENCE,data:{...T.data,ref:{uuid:K.uuid}}},{parentId:a.parentId,after:e}),s(Je.GUIDE_FIRST_TIME_LINK_PAGE,ct.advancedList)})}})}),l(h);return}case m.BlockType.REFERENCE_COLLECTION:{const U=p1({ancestorId:a.spaceId,findTypes:[m.BlockType.COLLECTION_VIEW,m.BlockType.COLLECTION_VIEW_PAGE]});setTimeout(()=>{st({$textareaPlaceHolder:{blockId:e,alwaysShow:!0,placeHolder:"指定引用多维表"}})},250),i.dropdown({popcorn:v,placement:"top-start",closeAfterCallBack:()=>{st({$textareaPlaceHolder:void 0})},content:({onCloseModal:z})=>r.jsx(oc,{defaultValue:U,placeholder:"搜索多维表",searchType:"collection",source:"collectionSettingsSource",onSelect:K=>{z(),x({popcorn:v,collectionId:K.uuid,blockId:a.uuid})}})}),l(h);return}case m.BlockType.PAGE:{if(I)nr([e],{type:k,local:!0,data:{segments:[]}}),_(e);else{const U=o(m.BlockType.PAGE,{parentId:a.parentId,after:e});if(!U)return;j3([U],!0),_(U)}break}case m.BlockType.COLLECTION_VIEW:{if(me.event("bitable_create",{from_scene:"inline",view_type:k}),I&&a.type===m.BlockType.TEXTAREA&&a.subNodes.length===0)nr([e],{type:k,local:!0,data:{segments:[]}}),Yh(e,D);else{const U=ut({type:k},{parentId:a.parentId,after:e},!1,!0);Yh(U,D)}break}case m.BlockType.COLLECTION_VIEW_PAGE:{if(me.event("bitable_create",{from_scene:"subpage",view_type:k}),I&&a.type===m.BlockType.TEXTAREA&&a.subNodes.length===0)nr([e],{type:k}),Yh(e,D),_(e);else{const U=ut({type:k},{parentId:a.parentId,after:e});Yh(U,D),_(U)}break}case m.BlockType.TEMPLATE:{const U="添加一个待办任务";let z=e;I&&a.type===m.BlockType.TEXTAREA?nr([e],{type:m.BlockType.TEMPLATE,textColor:Ze.blue,data:{segments:ht(U)}}):z=ut({type:m.BlockType.TEMPLATE,textColor:Ze.blue,data:{segments:ht(U)}},{parentId:e}),ut({type:m.BlockType.TODO},{parentId:z}),Vi(z,!0,!1),l(h,{closeAfterCallBack:()=>t(z||z,U.length)});break}case m.BlockType.TABLE:{let U=e;I&&a.type===m.BlockType.TEXTAREA?nr([e],{type:m.BlockType.TABLE}):U=ut({type:m.BlockType.TABLE},{parentId:a.parentId,after:e});const z=qe(),K=qe(),W=()=>ut({type:m.BlockType.TABLE_ROW},{parentId:U}),Y=W(),G=W(),ee=W();_e(U,{subNodes:[Y,G,ee],data:{format:{tableBlockColumnOrder:[z,K],tableBlockRowHeader:!0}}}),re(at.update({selectedCells:[{recordId:Y,propertyId:z,viewId:U,syncId:n}]})),re(Ns.update({activityTableId:U,focus:!0})),l(h),setTimeout(()=>{Lr(Kd(U,0,0),1/0,1/0)});return}case m.BlockType.MIND_MAPPING:case m.BlockType.MIND_MAPPING_PAGE:{let U=e;I&&a.type===m.BlockType.TEXTAREA?nr([e],{...T,type:k}):U=ut({type:k},{...T,parentId:a.parentId,after:e}),(()=>{d(()=>{g({parentId:U,last:!0},U),g({parentId:U,last:!0},U),g({parentId:U,last:!0},U)}),k===m.BlockType.MIND_MAPPING_PAGE&&_(e)})();return}default:if(I&&TZ.includes(a.type)){if(k===m.BlockType.MARK){if(!a.textColor&&!a.backgroundColor){const U=CF(m.BlockType.MARK);Object.assign(T,U)}}else if(k===m.BlockType.SYNC_CONTAINER){const U=QV([a.uuid],a.parentId);l(h,{closeAfterCallBack:()=>{t(a.uuid,0,void 0,{syncId:U||n})}});return}else if(k===m.BlockType.AD&&pI(F,[m.BlockType.AD]).length>2){be.warning("广告块不能多于3个");return}if(nr([e],{...T,type:k}),k===m.BlockType.CODE)l(h,{closeAfterCallBack:()=>{t("".concat(e,"_mock"),0,void 0,{syncId:n})}});else if(k===m.BlockType.DIVIDER){const U=Nu(!1),K=U.findIndex(W=>W.blockId===a.uuid&&W.syncId===n)+1;if(K<U.length){const W=U[K];if(!W)return;l(h,{closeAfterCallBack:()=>{Lr(W.editorKey,0,0)}})}else{const W=ut({},{parentId:a.parentId});l(h,{closeAfterCallBack:()=>{t(W,0,void 0,{syncId:n})}})}return}k===m.BlockType.FOLDER&&_(e)}else{let U;const z=CF(k);let K=ut({...z,...T,type:k,data:{...T.data,...z.data}},{parentId:a.parentId,after:e});k===m.BlockType.SYNC_CONTAINER&&(U=K,K=ut({},{parentId:K})),k===m.BlockType.CODE&&(K="".concat(K,"_mock")),l(h,{closeAfterCallBack:()=>{t(K,0,void 0,{syncId:U!=null?U:n})}}),k===m.BlockType.FOLDER&&_(K);return}}else switch(j){case Xe.COLOR:{_e(e,{type:a.type,...T});const U=!!T.backgroundColor,[z,K]=H0,W=($=U?K:z)==null?void 0:$.items.find(Y=>Y.colorkey===(U?T.backgroundColor:T.textColor));ts(t0,JSON.stringify(W)),a.type===m.BlockType.MARK&&l2(T);break}case Xe.TURN_INTO:{nr([e],{...T,type:k,data:{...T.data}});break}case Xe.DELETE:{gr([e]);break}case Xe.MOVETO:{f({popcorn:v,uuid:e});break}case Xe.COPY:{u([e],{effects:U=>{var K,W;const z=(W=(K=U[0])==null?void 0:K.blockId)!=null?W:"";re(sr({init(){var Y;t(z,(Y=p.left)!=null?Y:1/0)},redo(){var Y;t(z,(Y=p.left)!=null?Y:1/0)},undo(){var Y;t(e,(Y=p.left)!=null?Y:1/0)}}))}});break}}S?t(a.uuid,(M=p.left)!=null?M:0,void 0,{syncId:n}):t(a.uuid,0,void 0,{syncId:n}),l(h)}};return y.useCallback(E,[g,a,e,l,u,h,o,t,c,w,x,i,f,_,F,b,p.left,n,d,s])},bRe=(e,t,n=m.CollectionViewType.TABLE)=>{var i;const{blocks:s}=pe(),a=s[e];if(!a)return;const o=(i=a.data.schema)!=null?i:{};Io({title:"",format:Hu({tableProperties:Zf(o,n)}),pageSort:a.subNodes,type:n},{parentId:t,last:!0})},Yh=(e,t=m.CollectionViewType.TABLE)=>{const n=jE(),s=t===m.CollectionViewType.TIMELINE,a=t===m.CollectionViewType.CALENDAR,o=t===m.CollectionViewType.FORM,i=qe(),l=qe(),c=qe(),d=[],u={title:{name:"标题",type:m.CollectionSchemaType.TITLE},[i]:{name:"分类",type:m.CollectionSchemaType.SELECT,options:n}};d.push({property:"title",visible:!0},{property:i,visible:!0}),(s||a)&&(u[l]={name:"开始时间",type:m.CollectionSchemaType.DATE},u[c]={name:"结束时间",type:m.CollectionSchemaType.DATE},d.push({property:l,visible:!0},{property:c,visible:!0})),_e(e,{local:!0,data:{schema:u,collectionPageProperties:d}});let f=[];!a&&!o&&(f=[5,3,1].map(g=>{const _={[i]:[]};if(s){const x=new Date(Date.now()-g*Kn);_[l]=[Gn({from:x})],_[c]=[Gn({from:new Date(x.getTime()+5*Kn)})]}return ut({type:m.BlockType.PAGE,local:!0,data:{segments:[],collectionProperties:_}},{parentId:e},!1,!0)}));const h=[{property:"title",visible:!0},{property:i,visible:t===m.CollectionViewType.TABLE}];(s||a)&&h.push({property:l,visible:!1},{property:c,visible:!1});let p={};switch(t){case m.CollectionViewType.TABLE:p=Hu({tableProperties:h});break;case m.CollectionViewType.BOARD:p=Lp({groupProperty:i,boardProperties:h,options:n});break;case m.CollectionViewType.GALLERY:p=m2({galleryProperties:h});break;case m.CollectionViewType.LIST:p=h2({listProperties:h});break;case m.CollectionViewType.TIMELINE:p=Bp({timelineProperties:h,timelineBy:l,timelineByEnd:c});break;case m.CollectionViewType.CALENDAR:p=Op({calendarProperties:h,calendarBy:l,calendarByEnd:c});break;case m.CollectionViewType.FORM:p=Jj({formProperties:h});break}Io({title:"默认视图",format:p,pageSort:f,type:t},{parentId:e}),o&&Io({title:"表格",format:Hu({tableProperties:h}),pageSort:[],type:m.CollectionViewType.TABLE},{parentId:e})},Rye=()=>{const e=i$();return y.useCallback((t,n)=>{const{isOpenMenuList:s,syncId:a}=n||{},o=Wxe(t,a);if(o){const i=o.getBoundingClientRect(),l=GV(o);l&&t2(l,0),s&&e({popcorn:{getBoundingClientRect:()=>i},blockId:t,syncId:a})}},[e])},i$=()=>{const e=ie(),t=Fc(),n=vO(),s=Nr(),a=Nn();return y.useCallback(o=>{const{popcorn:i,blockId:l,offset:c=[-4,8],slash:d,syncId:u}=o,f=pe().blocks[l];if(!f||xt.$createBlockMenuListId||!Kxe())return;const p=a(l);if(!p)return;const{selection:g}=p;if(!g||!g.isCollapsed)return;const _=p.createCursor(g.focusOffset,"right"),x=p.createCursor(g.focusOffset,"left"),F=p.onSelectionChange.subscribe(()=>{if(p.selection){const{focusOffset:w}=p.selection;if(w<x.offset||_.offset<w){t();return}st({$slashSelection:{left:x.offset,right:_.offset}})}}),b=p.onContentChange.subscribe(()=>{var E;const{content:w}=p;try{const C=Jr(w,x.offset,_.offset),k=ta(C);d?!k||!B3((E=k[0])!=null?E:"")?t():st({$menuListKeywords:k}):st({$menuListKeywords:k})}catch(C){t()}});e.dropdown({popcorn:i,placement:"bottom-start",mask:!1,modalId:l,offset:c,closeBeforeCallBack:()=>{x.release(),_.release(),b.unsubscribe(),F.unsubscribe(),t()},content:({onCloseModal:w})=>r.jsx(Dye,{focusEditableAt:s,blockNoText:Ep(f.data),slash:d,syncId:u,getEditorModel:a,popcorn:i,blockId:l,cursorLeft:x,cursorRight:_,onCloseModal:w,selectItem:()=>{p.performChange(E=>{E.shadow().select(x.offset,_.offset).delete().release()}),_e(l,{data:{segments:mr(p.content)}})}})}),n(l)},[t,s,a,e,n])},l$=e=>{const t=i$(),n=Nn(),s=Ks(),a=()=>{if(xt.$ignoreSlash)return;const o=n(e);if(!o)return;const{selection:i}=o;if(!i||!i.isCollapsed)return;t({popcorn:{getBoundingClientRect(){return o.getBoundingClientRectOfRange(i.focusOffset,i.focusOffset)}},offset:[4,8],blockId:e,slash:!0,syncId:s})};return y.useCallback(a,[n,t,s,e])};function t4(e,t){const n=E0(e,t,m.BlockType.ORDER_LIST);if(!n)return"1";let s="".concat(n.listNo);const a=n.format||n.defaultFormat;return a==="roman"&&(s=f$(n.listNo)),a==="letters"&&(s=d$(n.listNo-1)),s}function Pye(e,t){const n=E0(e,t,m.BlockType.ORDER_LIST);if(!n)return"2";let s="".concat(n.listNo+1);const a=n.format||n.defaultFormat;return a==="roman"&&(s=f$(n.listNo+1)),a==="letters"&&(s=d$(n.listNo)),s}const c$="abcdefghijklmnopqrstuvwxyz",x6=c$.length,d$=e=>{const t=[];do{const s=e%x6;t.push(s),e=Math.floor(e/x6)}while(e-- >0);const n=[];for(;t.length;){const s=t.pop();typeof s<"u"&&n.push(c$[s])}return n.join("")},u$=["","i","ii","iii","iv","v","vi","vii","viii","ix","","x","xx","xxx","xl","l","lx","lxx","lxxx","xc","","c","cc","ccc","cd","d","dc","dcc","dccc","cm"],f$=e=>{const t=e.toString().split("");let n="";[0,1,2].forEach(o=>{const i=Number(t.pop());if(isNaN(i))return;const l=i+o*10;n=u$[l]+n});const s=Number(t.join(""));return"m".repeat(s)+n},m$=(e,t)=>{const n=Oe(),s=Nn(),a=Nr(),o=Ui(),i=ai(),{enableAI:l}=xr(),c=(d,u)=>{var P,L;const{blocks:f}=pe(),h=f[e];if(!h)return;if(document.querySelector(".ai-editor")){d.preventDefault();return}const g=s(e);if(g===void 0)return;const{content:_,selection:x}=g;if(!x||!x.isCollapsed)return;const{offset:F}=x,[b,w]=Ck(_,F),E=mr(b),C=mr(w),k=ta(b),T=(O,$)=>{if(O===h.type&&(O!==m.BlockType.HEADER||($==null?void 0:$.level)===h.data.level))return;d.preventDefault();const M=An(E);if(!M)return;_e(h.uuid,{data:{segments:[...wL(E),{...M,text:"".concat(M.text).concat(u)},...C]}});let U={};O===m.BlockType.MARK&&!h.textColor&&!h.backgroundColor&&(U=CF(m.BlockType.MARK)),[m.BlockType.EQUATION].includes(O)&&(U.local=!0),n(()=>{nr([h.uuid],{type:O,...U,data:{...U.data,...$,segments:C}}),re(sr({init(){a(h.uuid,0)},undo(){a(h.uuid,F+1)},redo(){a(h.uuid,0)}}))})};if(k.match(/^#{1,4}$/)){const O=k.length;if(h.type!==m.BlockType.HEADER||h.data.level!==O){T(h.type===m.BlockType.FOLD_LIST?m.BlockType.TOGGLE_HEADER:m.BlockType.HEADER,{level:O});return}}if(["-","*"].includes(k)){T(m.BlockType.LIST);return}if(["+"].includes(k)){h.type===m.BlockType.HEADER?T(m.BlockType.TOGGLE_HEADER,{level:h.data.level}):T(m.BlockType.FOLD_LIST);return}if([">","》","｜","|","'",'"',"“"].includes(k)){T(m.BlockType.QUOTE);return}if(["!!","！！"].includes(k)){T(m.BlockType.MARK);return}if(["￥￥","$$"].includes(k)){T(m.BlockType.EQUATION);return}if(/^(```|···)/.test(k)&&!C.length&&!/(\s|\d)/.test(k.slice(3))){const O=rj(k.slice(3).trim()),$=qe();n(()=>{ut({uuid:$,type:m.BlockType.CODE,data:{format:{language:O||mg()||Lm}}},{parentId:h.parentId,after:h.uuid}),Ro(h.uuid),re(sr({init(){setTimeout(()=>a("".concat($,"_mock"),0),200)},undo(){a(h.uuid,F)},redo(){setTimeout(()=>a("".concat($,"_mock"),0),200)}}))});return}const I=!!k.match(/^[\d]+(\.|。)$/),j=!I&&!!k.match(/^[A-Za-z]+(\.|。)$/),S=(k.lastIndexOf(".")||k.lastIndexOf("。"))&&u$.includes(k.substring(0,k.length-1)),D=j?"letters":S?"roman":void 0;if(j||I){if(!f[h.parentId])return;const $=Ine(e);if(($==null?void 0:$.type)===m.BlockType.ORDER_LIST){const U=Pye($.uuid,f);(k==="".concat(U,".")||k==="".concat(U,"。"))&&T(m.BlockType.ORDER_LIST,{format:{orderListFormat:((P=$.data.format)==null?void 0:P.orderListFormat)||D}})}else if(I||k==="a."||k==="a。"||S){if(h.type===m.BlockType.HEADER)return;const U=j?1:parseInt(k,10);T(m.BlockType.ORDER_LIST,{format:{listStartIndex:U,orderListFormat:D}})}return}const A=ta(_);if(l&&!t&&!A.trim()&&A.length===0){const O=e4(h.parentId,e),$=g.editorElement;if(!$||i)return;o({popcorn:$,blockId:e,editorScene:O?it.PageEmpty:it.PageHasContent,selection:{start:(L=x.offset)!=null?L:0},from:ho.ContextMenu})}};return y.useCallback(c,[t,l,a,s,i,o,n,e])},n4=(e,t,n=Rj)=>{const s=Xxe(e),a=uye(e),o=mye(e,t),i=fye(e),l=l$(e),c=m$(e),d=JV(e),u=Xj(e),f=Nn();return y.useCallback(h=>{const{content:p}=h.detail;if(!n.editorInputKey)return;const g=f(e);if(typeof p=="string")switch(p){case"@":return a(h,ma.DATE,"@");case"【":case"[":{if(!g||!g.selection)return;if(g.selection.focusOffset>0){const _=Jr(g.content,g.selection.focusOffset-1,g.selection.focusOffset),x=ta(_);x==="["&&p==="["?a(h,ma.LINK_PAGE,"[["):x==="【"&&p==="【"&&a(h,ma.LINK_PAGE,"【【")}break}case"]":case"】":n.bracketRightKey&&d();break;case"`":case"~":case"～":case"*":case"_":case"$":case"＊":o(h);break;case">":case"》":case"-":case"－":case"=":g&&s(p).then(_=>{if(_){o(h);return}n.minusKey&&u(h,2),i(p)});break;case"/":case"／":n.slashKey&&l();break;case" ":case"　":n.spaceKey&&c(h,p);break;case":":{st({$allowEmojiPanel:!0});break}default:{const _=f(e);if(!_||!_.selection)return;if(n8.exec(p)){h.preventDefault(),_.performChange(x=>{x.insert(Wn([Is(xm,{text:p})])).collapse("focus")});return}if(_.selection.focusOffset>0&&xt.$allowEmojiPanel){const x=Jr(_.content,_.selection.focusOffset-1,_.selection.focusOffset);ta(x)===":"&&a(h,ma.EMOJI,":",p)}}}},[d,f,a,s,n.bracketRightKey,n.editorInputKey,n.minusKey,n.slashKey,n.spaceKey,i,o,u,l,c,e])},s4=(e,t,n=Rj)=>{const s=KV(e),a=Zxe(e),o=Jxe(e),i=WV(e),l=Gxe(e),c=nye(e,t),d=sye(e,t),u=JV(e),f=Xj(e),h=m$(e,!0),p=r$(e),g=l$(e),_=lt(),x=rh(),F=pt(),b=s9(),w=E=>{!xt.$isEditingPage&&!F&&b(!0),x(_,e);const C=E.nativeEvent;switch(!0){case(n.arrowKey&&Ie("ArrowUp")(C)):return i(C);case(n.arrowKey&&Ie("ArrowDown")(C)):return s(C);case(n.arrowKey&&Ie("ArrowLeft")(C)):return a(C);case(n.arrowKey&&Ie("ArrowRight")(C)):return o(C);case(n.tabKey&&Ie(["Tab","Shift+Tab"])(C)):return l(C);case(n.backspaceKey&&Ie("Backspace")(C)):return c(C);case(n.spaceKey&&Ie(["Space","Shift+Space"])(C)):return h(C,C.key);case(n.enterKey&&Ie(["Enter","Shift+Enter"])(C)):return d(C);case(n.bracketRightKey&&Ie(["]","】"],{byKey:!0})(C)):return u(C);case(n.minusKey&&Ie(["-","*","＊","－"],{byKey:!0})(C)):return f(C,2);case(n.slashKey&&(C.code==="Slash"||Ie(zk)(C)||Ie(zk,{byKey:!0})(C))&&!C.shiftKey&&!C.ctrlKey&&!C.metaKey):return g();default:if(n.shortcutKey)return p(C)}};return y.useCallback(w,[F,x,_,e,b,n.arrowKey,n.tabKey,n.backspaceKey,n.spaceKey,n.enterKey,n.bracketRightKey,n.minusKey,n.slashKey,n.shortcutKey,i,s,a,o,l,c,h,d,u,f,g,p])};function Lye(e,t=20){const n=rr(()=>{let s=[],a=[];return{push:(c,d)=>{t!==0&&(s.push([c,d]),s=s.slice(-t),a=[])},undo:()=>{t!==0&&e.performChange(c=>{const d=s.pop();if(d){const u=[e.content,e.selection],[f,h]=d;c.load(f),h&&c.select(h.offset,h.endOffset,h.isBackward),a.push(u)}},"undo")},redo:()=>{t!==0&&e.performChange(c=>{const d=a.pop();if(d){const u=[e.content,e.selection],[f,h]=d;c.load(f),h&&c.select(h.offset,h.endOffset,h.isBackward),s.push(u)}},"undo")}}});return y.useEffect(()=>{let s=!1,a=0;const o=e.onChange.subscribe(({key:i,previousContent:l,previousSelection:c})=>{i!=="undo"&&(s||n.push(l,c),s=!0,window.clearTimeout(a),a=window.setTimeout(()=>{s=!1},500))});return()=>o.unsubscribe()},[e,n]),{undo:n.undo,redo:n.redo}}const r4=({onCloseModal:e,selectItem:t,blockId:n,syncId:s,showBg:a=!0})=>{const o=Js(),i=ye(n,["data"],["level","display"]),l=lt(),c=oj(),d=Oe(),{selectedBlockHistory:u,selectedBlock:f}=Nl(),h=T5(n),p=qE(),{isRestricted:g}=mt(n),_=!!y.useContext(jl),x=async(b,w={})=>{d(()=>{const E=f.length?f:[{blockId:n,syncId:s}];g&&h();const{mindMapMaxLimit:C}=T0();if(_&&p(n,"需要转换的节点数超过".concat(C,",升级空间立即解锁无限节点"),C+1))return;const k=lr(E);nr(k,{type:b,...w,local:void 0}),[m.BlockType.TOGGLE_HEADER,m.BlockType.FOLD_LIST].includes(b)&&Vi(k,!0),u(E),(i==null?void 0:i.type)===m.BlockType.TEXTAREA&&o(Je.CONVERT_TEXT_BLOCK,ct.basicList),(i==null?void 0:i.type)===m.BlockType.HEADER&&o(Je.CREATE_HEADER_BLOCK,ct.basicList,{step1:!0}),b===m.BlockType.TODO&&o(Je.CREATE_TODO_BLOCK,ct.basicList),b===m.BlockType.QUOTE&&o(Je.CREATE_QUOTE_BLOCK,ct.basicList),b===m.BlockType.MARK&&o(Je.CREATE_MARK_BLOCK,ct.basicList),b===m.BlockType.SYNC_CONTAINER&&(o(Je.GUIDE_FIRST_TIME_CREATED_SYNC,ct.advancedList),o(Je.CREATE_SYNC_BLOCK_NEW,ct.advancedList,{step1:!0})),b===m.BlockType.PAGE&&o(Je.GUIDE_FIRST_TIME_CREATED_PAGE,ct.basicList)}),t&&t(),e==null||e()},F=y.useMemo(()=>{var E;if(!i)return[];const b=_?cI:lI,w=Object.values(c.basicBlock).filter(C=>b.includes(C.data.type)).map(C=>{var T;const k=ij(i.type,{level:i.data.level,display:i.data.display});return{...C,type:H.BLOCK_TRANSFORM,data:{...C.data,icon:(T=C.data.transformIcon)!=null?T:C.data.icon,selected:(k==null?void 0:k.title)===C.data.title}}});if(!_&&!s&&!E5(n)){const C=c.advanced.sync,k={...C,data:{...C.data,icon:(E=C.data.transformIcon)!=null?E:C.data.icon},type:H.BLOCK_TRANSFORM};w.push(k)}if(!_&&J.ui.selectedBlocks.length>1&&J.ui.selectedBlocks.length<=5&&J.ui.selectedBlocks.some(C=>!Xu(C.blockId,l))){const C={type:H.BLOCK_TRANSFORM,data:{type:m.BlockType.COLUMN_LIST,actionType:Xe.CREATE,icon:r.jsx(V,{name:"MIcInsertColumns",size:"xxlarge",className:"rounded border border-grey6 text-white mr-2"}),title:"分栏",context:Wt({title:"将选中的块转为分栏排版",image:"column"})}};w.push(C)}return w},[c.advanced.sync,c.basicBlock,i,n,_,l,s]);return i?r.jsx(ze,{className:R(a?Ra:L3,"w-[200px]"),items:F,onItemClick:b=>{const{type:w,params:E}=b.data;x(w,E),me.event("blockmenu_turn_choose",{block_name:No(n)})},keyDownPriority:dr+1}):null},Bye=(e,t)=>{const n=Nn(),{model:s,setFakeFocus:a}=t,o=ie();return y.useCallback(()=>{const i=s||n(e);if(!i)return;const l=i.active?i.selection:null;if(!l)return;const c=l.offset,d=l.endOffset;o.dropdown({popcorn:{getBoundingClientRect:()=>{const u=i.getBoundingClientRectOfRange(c,d);return u!=null?u:new DOMRect(-9999,-9999,0,0)}},closeAfterCallBack:()=>{a(!1)},placement:"bottom",offset:[4,4],content:({onCloseModal:u})=>r.jsx(e$,{getEditorModel:n,symbol:"[[",onCloseModal:u,blockId:e,left:c,right:d,setFakeFocus:a})})},[s,n,o,a,e])},y6=()=>document.getElementById(Ka+Or.More),Oye=e=>{var U,z,K;const{uuid:t,model:n,comments:s=!1,segmentType:a,shortcutToolBar:o}=e,i=Un(),{queryResult:l,setFakeFocus:c}=o,d=lt(),{role:u}=mt(d),{enableAI:f}=xr(),h=ie(),p=c2({model:n}),g=f2(),_=d2({model:n}),x=Mj(t,{model:n,setFakeFocus:c}),F=Bye(t,{model:n,setFakeFocus:c}),b=s$(t),w=Nr(),E=Js(),C=!!y.useContext(jl),k=Ui(),T=Ks(),v=d5(),{disableLink:I,inLink:j,disableEquation:S}=l,D=nd(()=>n.onFormatChange.pipe(EL(20),sd(()=>n.format)),n.format,[n]),A=nd(()=>n.onReadonlyChange.pipe(sd(()=>n.readonly)),n.readonly,[n]),P=ij((U=J.blocks[t])==null?void 0:U.type,{display:(z=J.blocks[t])==null?void 0:z.data.display,level:(K=J.blocks[t])==null?void 0:K.data.level}),L=y.useMemo(()=>s&&Xn(u,m.PermissionRole.COMMENTER)&&(i===wt.MAIN||i===wt.SHARE),[s,i,u]),$={disableAI:!y.useMemo(()=>f&&((P==null?void 0:P.type)&&ine.includes(P==null?void 0:P.type)||a==="description")&&!l.disableAI,[P==null?void 0:P.type,f,l.disableAI,a]),disableTurn:!P||P.type===void 0||!(C?cI:lI).includes(P.type),disableLinkPage:!!j||I||a==="description",disableUrl:I,disableEquation:S,disableComment:!L,disableBold:!1,disableItalic:!1,disableUnderline:!1,disableDelete:!1,disableCode:!1,disableColor:!1,disableMore:!1};return{queryResult:l,clickFn:{clickColor:W=>{if($.disableColor){be.error("不可设置颜色");return}const{selection:Y}=n;if(Y===null)return;W.stopPropagation();const G=W.target||y6();me.event("rtf_choose",{rtf_name:"color"}),h.dropdown({popcorn:G,offset:[0,8],placement:"left",closeBeforeCallBack:()=>void n.requestFocus(),content:({onCloseModal:ee})=>r.jsx(Kw,{items:Jce,onColorSelect:({isBgColor:te,colorkey:Q})=>{n.requestFocus(),n.performChange(ne=>{ne.select(Y.offset,Y.endOffset),te?ne.applyFormat({color:void 0,backgroundColor:Q}):ne.applyFormat({backgroundColor:void 0,color:Q})}),ee()}})})},clickUrl:W=>{if($.disableUrl){be.error("不可设置链接");return}const{selection:Y}=n;Y!==null&&(W.stopPropagation(),W.preventDefault(),me.event("rtf_choose",{rtf_name:"链接"}),x(),E(Je.CREATE_LINK,ct.advancedList))},clickAI:W=>{if(W.stopPropagation(),W.preventDefault(),$.disableAI){be.error("不可使用AI功能");return}const Y=n.editorElement;if(!Y)return;const{selection:G}=n;if(!G)return;const{offset:ee,endOffset:te}=G;if(a==="description"){k({popcorn:Y,blockId:d,model:n,from:ho.RtfMenu,selection:{start:ee!=null?ee:0,end:te!=null?te:0},editorScene:it.TextSelected,isDescription:!0,isBitable:!0});return}k({blockId:t,popcorn:Y,model:n,selection:{start:ee!=null?ee:0,end:te!=null?te:0},editorScene:it.TextSelected,from:ho.RtfMenu})},clickBold:W=>{me.event("rtf_choose",{rtf_name:"bold"}),W.stopPropagation(),g(t,"bold")},clickItalic:W=>{me.event("rtf_choose",{rtf_name:"italic"}),W.stopPropagation(),g(t,"italic")},clickUnderline:W=>{me.event("rtf_choose",{rtf_name:"underline"}),W.stopPropagation(),g(t,"underline")},clickDelete:W=>{me.event("rtf_choose",{rtf_name:"deleteline"}),W.stopPropagation(),g(t,"lineThrough")},clickCode:W=>{W.stopPropagation(),me.event("rtf_choose",{rtf_name:"code"}),_(t)},clickEquation:W=>{if($.disableEquation){be.error("不可插入公式");return}const{selection:Y}=n;Y!==null&&(W.stopPropagation(),me.event("rtf_choose",{rtf_name:"equation"}),p(t))},clickComment:W=>{if($.disableComment){be.error("不可评论");return}W.stopPropagation(),W.preventDefault(),b()},clickLinkPage:W=>{if($.disableLinkPage){be.error("不可链接页面");return}const{selection:Y}=n;Y!==null&&(W.stopPropagation(),W.preventDefault(),F())},clickTurn:W=>{if($.disableTurn){be.error("不可转换");return}W.stopPropagation();const{selection:Y}=n;if(Y===null)return;const G=W.target||y6();h.dropdown({popcorn:G,placement:"left",offset:[0,8],content:({onCloseModal:ee})=>r.jsx(r4,{syncId:T,focusEditableAt:w,onCloseModal:ee,blockId:t,selectItem:()=>{w(t,Y.endOffset)}})})},clickCustomPrompt:(W,Y)=>{},clickMore:()=>{}},format:D,disableClick:$,blockMenu:P,readonly:A,userToolbarShortcut:v}},Da=vl(Oye),Mye="h-9",Os=e=>{const{title:t,icon:n,iconClass:s,label:a,labelBorder:o,disabled:i,highlight:l,arrow:c,className:d,boxClassName:u,active:f,onClick:h,id:p}=e;return r.jsxs(Uye,{id:p,title:t,disabled:i,className:R((a||c)&&"px-[7px] !w-auto",d),boxClassName:u,active:f,onClick:g=>{i||h==null||h(g)},children:[n&&r.jsx(V,{name:n,size:"small",className:R("w-4",l?"text-active_color":"text-black",s)}),a&&r.jsx("span",{className:R("text-t3 border-grey4 leading-[14px]",o&&"border-b",l?"text-active_color":"text-black"),children:a}),c&&r.jsx(V,{size:"auto",name:"IcArrowDown01",className:"ml-[6.75px] w-[9px] h-[9px]"})]})},Uye=y.memo(e=>{const{title:t,more:n,children:s,disabled:a,boxClassName:o,active:i,...l}=e;return r.jsx(Fe,{className:R(o),popup:t,children:r.jsxs("span",{...l,className:R(Mye,"flex items-center justify-center w-[30px] whitespace-nowrap rounded-none",a?"cursor-not-allowed opacity-40":"animate-hover animate-click",{"bg-black_006":i},e.className),children:[s,n&&r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall",className:"ml-1.5"})]})})}),vo=(e,t)=>r.jsxs("div",{className:"flex flex-col justify-center items-center",children:[r.jsx("div",{children:e}),r.jsx(Pp,{className:"text-center",shortcut:t})]}),h$=e=>Object.values(e).sort((t,n)=>t.index-n.index),Vye=e=>WK(e,(n,s,a)=>(s.index=a,n[s.id]=p$(s),n),{}),p$=e=>Ni(e,["type","id","fixed","title","index"]),T_={info:{id:Or.AI,icon:"IcAiFill",title:Qi.aiAssistantWithEmptyDoc,border:!0},Render:e=>{const{showBorder:t=!0}=e,{clickFn:n,disableClick:s}=an(Da);return s.disableAI?null:r.jsx(Os,{disabled:s.disableAI,id:Ka+T_.info.id,title:T_.info.title,label:T_.info.title,icon:T_.info.icon,iconClass:"mr-1",boxClassName:t?"border-r border-grey6":"",onClick:n.clickAI})}},g$={info:{id:Or.Turn,icon:"IcTurnInto",title:"转换为",border:!0},Render:e=>{const{showBorder:t=!0}=e,{blockMenu:n,clickFn:s,disableClick:a}=an(Da);return r.jsx(Os,{arrow:!0,disabled:a.disableTurn,id:Ka+g$.info.id,title:n==null?void 0:n.title,label:n==null?void 0:n.title,boxClassName:t?"border-r border-grey6":"",onClick:s.clickTurn})}},gv={info:{id:Or.LinkPage,icon:"IcMenuSubpage",title:"创建或引用页面",border:!0},Render:e=>{const{showBorder:t}=e,{disableClick:n,clickFn:s}=an(Da);return r.jsx(Os,{id:Ka+gv.info.id,title:gv.info.title,icon:"IcMenuSubpage",disabled:n.disableLinkPage,boxClassName:t?"border-r border-grey6":"",onClick:s.clickLinkPage})}},eb={info:{id:Or.Comment,icon:"IcComment",title:"评论",border:!0},Render:e=>{const{showBorder:t}=e,{clickFn:n,disableClick:s,readonly:a}=an(Da);return r.jsx(Os,{id:Ka+eb.info.id,disabled:s.disableComment,title:vo(eb.info.title,"Shift+M"),boxClassName:a?"":t?"border-r border-grey6":"",icon:eb.info.icon,onClick:n.clickComment})}},tb={info:{id:Or.Bold,icon:"IcBold",title:"加粗",border:!1},Render:()=>{const{format:e,clickFn:t}=an(Da);return r.jsx(Os,{id:Ka+tb.info.id,title:vo(tb.info.title,"B"),icon:tb.info.icon,highlight:e.bold,onClick:t.clickBold})}},nb={info:{id:Or.Italic,icon:"IcItalic",title:"斜体",border:!1},Render:()=>{const{format:e,clickFn:t}=an(Da);return r.jsx(Os,{id:Ka+nb.info.id,title:vo(nb.info.title,"I"),icon:nb.info.icon,highlight:e.italic,onClick:t.clickItalic})}},sb={info:{id:Or.Underline,icon:"IcUnderline",title:"下划线",border:!1},Render:()=>{const{format:e,clickFn:t}=an(Da);return r.jsx(Os,{id:Ka+sb.info.id,title:vo(sb.info.title,"U"),icon:sb.info.icon,highlight:e.underline,onClick:t.clickUnderline})}},rb={info:{id:Or.Delete,icon:"IcDelete",title:"中划线",border:!1},Render:()=>{const{format:e,clickFn:t}=an(Da);return r.jsx(Os,{id:Ka+rb.info.id,title:vo(rb.info.title,"Shift+S"),icon:rb.info.icon,highlight:e.lineThrough,onClick:t.clickDelete})}},ab={info:{id:Or.Code,icon:"IcCode",title:"代码",border:!1},Render:()=>{const{queryResult:e,clickFn:t}=an(Da),{inCode:n}=e;return r.jsx(Os,{id:Ka+ab.info.id,title:vo(ab.info.title,"E"),icon:ab.info.icon,highlight:n,onClick:t.clickCode})}},ob={info:{id:Or.Equation,icon:"IcEquation",title:"公式",border:!1},Render:()=>{const{queryResult:e,clickFn:t,disableClick:n}=an(Da),{inEquation:s}=e;return r.jsx(Os,{id:Ka+ob.info.id,title:vo(ob.info.title,"Shift+X"),disabled:n.disableEquation,icon:ob.info.icon,highlight:s,onClick:t.clickEquation})}},ib={info:{id:Or.Url,icon:"IcLink",title:"链接",border:!1},Render:()=>{const{queryResult:e,clickFn:t,disableClick:n}=an(Da),{inLink:s}=e;return r.jsx(Os,{id:Ka+ib.info.id,title:vo(ib.info.title,"K"),boxClassName:"border-r border-grey6",icon:ib.info.icon,disabled:n.disableUrl,labelBorder:!0,highlight:s!==null,onClick:t.clickUrl})}},lb={info:{id:Or.Color,icon:"IcText",title:"着色",border:!1},Render:()=>{var n,s;const{clickFn:e,format:t}=an(Da);return r.jsx(Os,{arrow:!0,id:Ka+lb.info.id,title:lb.info.title,icon:lb.info.icon,onClick:e.clickColor,iconClass:Qv("rounded-full w-5 h-5 p-1",KK({color:"".concat(tr((n=t.color)!=null?n:void 0),"!important"),background:cs((s=t.backgroundColor)!=null?s:void 0)}))})}},cb={info:{id:Or.More,icon:"IcMore",title:"更多",border:!0},Render:e=>{const{showBorder:t}=e,{clickFn:n}=an(Da),s=(a,o)=>{if(!Or[o]){n.clickCustomPrompt(o,a);return}const i=Ka+o,l=document.getElementById(i);if(l)l.click();else{const c=n["click".concat(o)];c(a)}};return r.jsx(Fe,{id:Ka+cb.info.id,interactive:!0,popupClass:"next-modal",theme:"none",placement:"bottom",maxWidth:"none",offset:[0,4],animation:"shift-away",popup:r.jsx(_$,{onClickItem:s}),delay:[0,300],children:r.jsx(Os,{title:cb.info.title,boxClassName:t?"border-l border-grey6":"",icon:cb.info.icon})})}},Yd={AI:T_,Turn:g$,LinkPage:gv,Comment:eb,Bold:tb,Italic:nb,Underline:sb,Delete:rb,Code:ab,Equation:ob,Url:ib,Color:lb,More:cb};jo(Yd);const $ye=e=>{const{id:t}=e,{userToolbarShortcut:n}=an(Da),{clickFn:s}=an(Da);if(!t)return null;const a=n[t];return a?r.jsx(Os,{id:Ka+t,title:a==null?void 0:a.title,onClick:o=>s.clickCustomPrompt(a.id,o)}):null},_$=e=>{const{openSetting:t=!0,className:n,onClickItem:s}=e,a=d5(),o=Pm(),i=ie(),{enableAI:l}=xr(),c=_=>{const x=Br(a[_]);if(x){x.fixed=!x.fixed;const F={...a,[_]:x};o({setting:{toolbarShortcut:F}})}},d=(_,x)=>{s==null||s(x,_)},u=()=>{i.modal({modalId:Ve.TOOLBAR_ID,content:()=>r.jsx(Hye,{})})},f=y.useMemo(()=>h$(a).filter(_=>!(_.id===Or.AI&&!l)).map(_=>{const x=Yd[_.id];return{title:x==null?void 0:x.info.title,icon:x==null?void 0:x.info.icon,..._}}),[l,a]),h=_=>{const x=_.map(b=>p$(b)),F=Vye(x);o({setting:{toolbarShortcut:F}})},p=_=>r.jsxs("div",{className:"flex px-2 py-1.5 animate-hover justify-between animate-click",onClick:x=>d(_.id,x),children:[r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx(V,{name:_.icon,size:"small",className:"mr-1.5"}),r.jsx("span",{children:_.title})]}),r.jsx(Fe,{className:"ml-2",onClick:x=>x.stopPropagation(),children:r.jsx(Ys,{size:20,className:"animate-click animate-hover",onClick:()=>c(_.id),children:r.jsx(V,{size:"small",name:"IcQuickAccess",className:_.fixed?"text-yellow":"text-grey3"})})})]},_.id),g=_=>r.jsxs("div",{className:"text-grey3 flex items-center justify-between px-1.5 py-2 sticky top-0 bg-white2",children:[r.jsx("span",{children:_}),r.jsx(V,{onClick:u,name:"IcSettings",size:"small"})]});return r.jsxs("div",{className:Qv("px-1.5 pb-1.5 text-t3 overflow-y-auto max-h-[40vh] w-48 select-none",n),children:[t&&g("快捷工具栏"),r.jsx(br,{disabled:t,items:f,onChange:h,modifiers:[H1],renderItemContent:({item:_})=>p(_)})]})},Hye=()=>{const[e]=y.useState(""),t=r.jsx("div",{className:"text-grey3 py-3",children:"可拖拽排序，点击右侧按钮固定常用的工具栏按钮"}),n=r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex justify-between py-2",children:[r.jsx("input",{placeholder:"未命名 Prompt",type:"text",className:"text-t2-bold w-full bg-transparent pr-2"}),r.jsx(De,{colorType:"active",children:"保存"})]}),r.jsx("textarea",{placeholder:"编辑 Prompt ，使用 {input} 作为引用内容的占位符",className:"flex-1 bg-transparent resize-none"})]});return r.jsx(r.Fragment,{children:r.jsxs("div",{className:"flex",children:[r.jsx(_$,{className:"py-2",openSetting:!1}),r.jsx("form",{className:"w-96 bg-grey9 px-3 text-t2 flex flex-col pb-3",children:e?n:t})]})})},zye=y.memo(()=>{var a;const{readonly:e,userToolbarShortcut:t}=an(Da),n=y.useMemo(()=>{const o=[];return e?(o.push({id:Yd.Comment.info.id,border:!1,render:Yd.Comment.Render}),o):(h$(t).filter(l=>l.fixed).forEach(l=>{const c=Yd[l.id];c?o.push({id:c.info.id,border:c.info.border,render:c.Render}):o.push({id:l.id,render:$ye})}),o.push({id:Yd.More.info.id,border:Yd.More.info.border,render:Yd.More.Render}),o)},[e,t]),s=n.length>1&&((a=n[n.length-2])==null?void 0:a.border);return r.jsx(r.Fragment,{children:n.map(o=>r.jsx(o.render,{id:o.id,showBorder:s&&o.id===Or.More},o.id))})},yn),qye=e=>{const{uuid:t,model:n,containerRef:s,comments:a=!1}=e,o=lt(),i=Un(),l=y.useContext(jI),{role:c}=mt(o),d=n2(t),{queryResult:u}=d,{getRect:f}=u,h=nd(()=>n.onReadonlyChange.pipe(sd(()=>n.readonly)),n.readonly,[n]);if(!f)return null;const p=a&&Xn(c,m.PermissionRole.COMMENTER)&&(i===wt.MAIN||i===wt.SHARE);return h&&!p||l?null:r.jsx(Gye,{getRect:f,containerRef:s,children:r.jsx("div",{className:"flex items-center transition-all",id:F9,onPointerDown:g=>g.preventDefault(),children:r.jsx(Da,{...e,shortcutToolBar:d,children:r.jsx(zye,{})})})})},Gye=y.memo(e=>{const{getRect:t,containerRef:n,children:s}=e,a=y.useRef(null),o=y.useRef(),i=y.useRef(t);return i.current=t,y.useEffect(()=>{o.current?o.current.update():n.current&&a.current&&(o.current=tu({getBoundingClientRect:()=>i.current(),contextElement:n.current},a.current,{strategy:"fixed",placement:"top-start",modifiers:[{name:"offset",enabled:!0,options:{offset:[0,10]}},{name:"eventListeners",enabled:!0},{name:"computeStyles",options:{gpuAcceleration:!1}},{name:"preventOverflow",options:{tether:!1,altAxis:!0}}]}))},[t,n]),y.useEffect(()=>()=>{var l;(l=o.current)==null||l.destroy()},[]),eL.createPortal(r.jsx("div",{ref:a,className:"next-modal border-none overflow-hidden animate__animated animate__fadeIn__pinter z-[8848] transition-all duration-100",style:{animationDuration:"0.1s",animationDelay:"0.2s"},children:s}),document.body)},yn),ci=y.memo(e=>{const{uuid:t,realBlockId:n,editorModel:s,className:a,plugins:o,placeholder:i,placeholderColor:l,alwaysShowPlaceholder:c=!0,onKeyDown:d,onKeyDownCapture:u,readonly:f=!1,interactable:h=!0,segments:p,onChange:g,toolbar:_=!0,comments:x=!1,autoFocus:F=!1,autoFocusCaretToEnd:b=!1,segmentType:w="segments",keydownOption:E=Rj,onBlur:C,onFocus:k,onClick:T,onCompositionStart:v,history:I={count:20},disabledKeydownOption:j,...S}=e,D=pt(),A=Nn(),P=lt(),L=n4(t,w,E),O=s!=null?s:A(t,!0,o),$=rh(),{undo:M,redo:U}=Lye(O,!f&&I?I.count:0),z=af(t),K=s4(t,w,E),W=vV(),Y=Nm(),G=y.useRef(null);y.useEffect(()=>{O.setReadonly(f)},[O,f]);const ee=y.useRef(),te=y.useRef(NaN);y.useEffect(()=>(O[Pg]=ee,O[fx]=te,xE(z,O),()=>{yE(z)}),[z,O]),lV(z,O);const Q=y.useRef({autoFocus:F,autoFocusCaretToEnd:b});y.useEffect(()=>{e2(O,p)},[t,O,p]),y.useEffect(()=>{if(O.readonly)return;const ae=O.onChange.subscribe(({previousContent:de,previousSelection:ke})=>{var Re;const{content:Te}=O;if(Te===de)return;const{unwrapSegments:he,segments:Ee}=s8(Te,!0),{wrapSegments:ge,hasNewEmoji:Se}=ON(Ee);if(Se){let Ae=(Re=O.selection)==null?void 0:Re.focusOffset;ke&&(Ae=ke.focusOffset),O.performChange(Me=>{Me.load(x1(ge)),Me.select(Ae,Ae)});return}te.current!==O.revision&&(ee.current=he,g==null||g(he,de,ke),te.current=O.revision)});return()=>{ae.unsubscribe()}},[O,g]),y.useEffect(()=>{const ae=G.current;ae&&(ae[P8]=O)},[O]),y.useEffect(()=>{const ae=G.current;if(!ae)return;const de=ke=>{L(ke)};return ae.addEventListener("inlinedinput",de),()=>{ae.removeEventListener("inlinedinput",de)}},[L]),y.useEffect(()=>{const{autoFocus:ae,autoFocusCaretToEnd:de}=Q.current;setTimeout(()=>{ae&&(de&&O.performChange(ke=>{ke.select().collapse("end")}),O.requestFocus())},0)},[O]),y.useEffect(()=>{const ae=O.onSelectionChange.subscribe(()=>{let de=xL;O.selection!=null&&(de={...IS(O.content,O.selection.endOffset),customs:null}),O.performChange(ke=>{ke.setFormat(de)})});return()=>{ae.unsubscribe()}},[O]),y.useEffect(()=>{if(!f)return;const ae=gb(document,"keydown").subscribe(de=>{if(!Ie("mod+shift+m")(de))return;const ke=FL();ke!=null&&ke[0]===O.editorKey&&(de.nativeEvent=de,K(de))});return()=>ae.unsubscribe()},[K,O.editorKey,f]);const ne=YK((ae,de,ke)=>{if(!f&&$(P,t),T==null||T(ke),!x)return;const Te=O.hitTest(ke.clientX,ke.clientY);if(Te==null||O.selection!=null&&!O.selection.isCollapsed)return;const he=IS(O.content,Te),Ee=Pc(he),ge=ae(Eg),Se=LN(ge,{noTable:!0}),Re=[...Ee,...Se];W({editorModel:O,popcorn:{getBoundingClientRect(){const Ae=O.getBoundingClientRectOfRange(Te,Te);return Ae!=null?Ae:new DOMRect(-9999,-9999,0,0)}},selector:Ae=>Re.map(Me=>Ae.discussions[Me]).filter(Me=>Me!=null&&Me.status===m.BlockStatus.NORMAL&&!Me.resolved)})},wg),se=Y&&D&&x,ce=!D&&(!f||x);return r.jsxs(yg.Provider,{value:{readonly:f,interactable:h},children:[r.jsx(a3,{emptyClassName:R("biz-placeholder-shown",Mn({selectors:{[c?"&:after":"&:focus-within:after"]:{content:JSON.stringify(i),pointerEvents:"none",color:l!=null?l:"var(--grey4)"},"& > br":{display:"none"}}})),"data-real-block-id":n!=null?n:t,className:R("break-words whitespace-pre-wrap",a,Mn({outline:"0 !important"})),model:O,ref:G,onBlur:C,onFocus:k,spellCheck:!1,onClick:ne,onCompositionStart:v,onKeyDownCapture:u,onKeyDown:ae=>{f||(d==null||d(ae),!ae.isDefaultPrevented()&&(I&&(Ie("mod+z")(ae)?(M(),ae.preventDefault(),ae.stopPropagation()):Ie("mod+shift+z")(ae)&&(U(),ae.preventDefault(),ae.stopPropagation())),j||K(ae)))},...S}),_&&(se||ce)&&r.jsx(qye,{uuid:t,containerRef:G,model:O,comments:x,segmentType:w})]})},yn),Hi=y.memo(e=>r.jsx(Wye,{...e})),Wye=e=>{const{onKeyDown:t,placeholder:n,uuid:s,className:a,alwaysShowPlaceholder:o=!0,toolbar:i,disabledKeydownOption:l,segmentType:c="segments",keydownOption:d,comments:u=!0}=e,f=ye(s,["data"],[c]),h=We(s),p=La(s,c),g=Fc(),_=Nn(),x=ln(),F=y.useRef(),b=Un(),w=y.useMemo(()=>{if(b===wt.PAGE_FEEDS&&F.current===void 0){const T=YN(Uj);return F.current=new T,F.current}return _(s,!0)},[_,b,s]),E=y.useContext(L8),C=ot.print;y.useEffect(()=>{Ko.activeEditorKey===w.editorKey&&(Ko.selection&&(w.performChange(T=>{Ko.selection&&T.select(Ko.selection.offset,Ko.selection.endOffset)}),Ko.selection=null),w.requestFocus())},[s,w]),Gp(()=>{xt.$createBlockMenuListId===s&&g()});let k=f==null?void 0:f.data[c];return E&&(h?E==="deleted"?k=Xy(k,void 0):E==="created"?k=Xy(void 0,k):k=Xy(E.data[c],k):console.error("diffAgainstTo must company with readonly")),r.jsx(ci,{keydownOption:d,uuid:s,editorModel:w,toolbar:i,comments:u,disabledKeydownOption:l,className:R(a,"break-words"),placeholder:C?"":n,alwaysShowPlaceholder:C?!1:o,onKeyDown:t,readonly:h,segments:k,segmentType:c,onCompositionStart:()=>{x(Ve.COMMENTS)},onChange:(T,v,I)=>{b!==wt.PAGE_LITE_PREVIEW&&p(T,[v,I])},history:!1})};Hi.displayName="Editable";f0e(ci);const _v=({recordId:e,recordIds:t,propertyId:n,onUpdate:s,onClose:a})=>{const o=n==="title",i=rr(qe),l=Nn(),c=ft(e,g=>{var _;return o?g==null?void 0:g.data.segments:(_=g==null?void 0:g.data.collectionProperties)==null?void 0:_[n]},[n]),[d,u]=y.useState(c),f=ur(),h=y.useRef(!1),p=()=>{h.current&&f(t||e,n,d)};return _x({onUpdate:s,onClose:a,onSave:p}),r.jsx("div",{className:"min-w-full p-2.5 leading-[20px] overflow-auto max-h-[80vh]",onKeyDown:g=>{if(Ie("shift+enter")(g)){g.preventDefault();const _=l(i,!1);_==null||_.performChange(x=>{x.delete().insert("\n")});return}Ie("enter")(g)?(g.preventDefault(),p(),a()):Ie("esc")(g)&&a()},children:r.jsx(ci,{uuid:i,realBlockId:e,plugins:o?oa:void 0,toolbar:!o,autoFocus:!0,autoFocusCaretToEnd:!0,className:"text-t2 whitespace-pre-wrap",segments:d,keydownOption:Uu,onChange:g=>{h.current=!0,u(g)}})})},p2=({recordId:e,propertyId:t,multiple:n=!1,editable:s=!1,onChange:a,className:o,itemClassName:i})=>{const{options:l,text:c}=Ce(({blocks:f})=>{var g,_,x,F,b,w,E;const h=(_=(g=f[e])==null?void 0:g.parentId)!=null?_:"",p=(F=(x=f[e])==null?void 0:x.data.collectionProperties)==null?void 0:F[t];return{options:(E=(w=(b=f[h])==null?void 0:b.data.schema)==null?void 0:w[t])==null?void 0:E.options,text:fe(p).trim()}},[e,t]);let d=c.split(/\s*,\s*/g).filter(f=>l==null?void 0:l.some(h=>h.value===f));n||(d=d.slice(0,1));const u=f=>{a==null||a(d.filter(h=>h&&h!==f).join(","))};return d.length===0?null:r.jsx("div",{className:R("relative",o),children:d.map(f=>{const h=l==null?void 0:l.find(g=>g.value===f);if(h==null)return null;const p=()=>{h.value&&u(h.value)};return r.jsx(md,{className:R("flex-shrink-0",i),color:h.color,value:h.value,label:h.value,showClose:s,onDelete:p},h.id)})})},a4=()=>{const{getState:e}=ss(),t=$o(),n=(s,a,o,i=!0)=>{var f,h;const l=e().blocks[s];if(!l)return;const c=(f=l.data.schema)==null?void 0:f[a];if(!c)return;const u=((h=c.options)!=null?h:[]).concat({...o});t(s,a,{options:u},{needTransaction:i})};return y.useCallback(n,[e,t])},x$=()=>{const{getState:e,dispatch:t}=ss(),n=Oe(),s=(a,o,i)=>{var h,p;const{blocks:l}=e(),c=l[a];if(!c)return;const{[o]:d,...u}=(h=c.data.schema)!=null?h:{};if(!d)return;const f=(p=d.options)==null?void 0:p.filter(g=>g.id!==i);n(()=>{t(Sn({uuid:a,patch:{data:{schema:{...u,[o]:{...d,options:f}}}}}))})};return y.useCallback(s,[t,e,n])},o4=()=>{const{getState:e,dispatch:t}=ss(),n=Oe(),s=(a,o,i)=>{n(()=>{var g,_;const{blocks:l}=e(),c=l[a];if(!c)return;const{[o]:d}=(g=c.data.schema)!=null?g:{};if(!d)return;const u=(_=d.options)!=null?_:[],f=u.find(x=>x.id===i.id);if(!f)return;const h={...f,...i};if(In(h,f))return;const p=u.map(x=>x.id===i.id?h:x);t(Sn({uuid:a,path:["data","schema"],patch:{data:{schema:{[o]:{...d,options:p}}}}})),!In(h,f)&&Ls.unstable_batchedUpdates(()=>{c.subNodes.forEach(x=>{var k;const F=l[x];if(!F)return;const{role:b}=mn(x);if(b===m.PermissionRole.READER)return;const w=fe((k=F.data.collectionProperties)==null?void 0:k[o]);if(!w)return;let E=!1;const C=w.split(",").map(T=>T?T===f.value?(E=!0,h.value):T:"").filter(T=>!!T).join(",");E&&t(Sn({uuid:x,path:["data","collectionProperties"],patch:{data:{collectionProperties:{[o]:ht(C)}}}}))})})})};return y.useCallback(s,[t,e,n])},y$=({option:e,propertyId:t,closeModal:n,closeBeforeCallbackRef:s,collectionId:a})=>{const o=y.useRef(null),{getState:i}=ss(),l=o4(),c=x$(),d=ie(),[u,f]=y.useState(e.value),h=()=>{var x,F,b;const p=u.replaceAll(",","").trim();if(!p)return;const{blocks:g}=i(),_=(b=(F=(x=g[a])==null?void 0:x.data.schema)==null?void 0:F[t])==null?void 0:b.options;if(_&&p!==e.value){if(_.some(w=>w.value===p))return d.warning({title:r.jsx(r.Fragment,{children:"此属性已存在同名的选项"}),noCancel:!0,confirm(){var w;(w=o.current)==null||w.focus()}}),"prevent";l(a,t,{id:e.id,value:p})}};return s.current=h,r.jsxs("div",{className:"flex flex-col w-[240px] next-modal",children:[r.jsx("div",{className:"flex flex-row items-center w-full",children:r.jsx(Ct,{inputRef:o,autoFocus:!0,placeholder:"请输入名称",value:u,onChange:f,onEnter:p=>{p.preventDefault(),n()},className:"h-8 mx-2.5 my-2.5 flex-1"})}),r.jsxs("div",{className:"flex flex-col mb-[5px]",children:[r.jsx(ze,{enableKeyDown:!1,items:[{type:H.OPERATION,data:{icon:"IcTrash",title:"删除",onClick:()=>{d.warning({title:r.jsx(r.Fragment,{children:"是否确认删除该选项？"}),confirm:()=>{s.current=void 0,c(a,t,e.id),n()}})}}},{type:H.LINE,data:{},disableClick:!0}]}),r.jsx(Vm,{bgColorFn:J1,value:e.color,onSelect:p=>{l(a,t,{id:e.id,color:p}),n()}})]})]})},Kye=({option:e,active:t,onSelect:n,onMore:s,onMouseOver:a,readonly:o})=>r.jsxs("div",{className:R("w-full flex px-2 h-8 cursor-pointer items-center animate-hover",{"bg-black_006":t}),onMouseOver:a,onClick:n,children:[r.jsxs("div",{className:"flex flex-1 items-center whitespace-nowrap overflow-hidden overflow-ellipsis",children:[r.jsx(V,{className:"mr-1 text-grey4",size:"small",name:"IcMenu"}),r.jsx(md,{value:e.value,label:e.value,color:e.color})]}),!o&&r.jsx("button",{className:"w-5 h-5 text-grey3 animate-hover rounded flex items-center justify-center",onClick:i=>{i.stopPropagation(),s==null||s(i)},children:r.jsx(V,{size:"small",name:"IcMore"})})]}),b$=({readonly:e,options:t,onSelect:n,onMore:s,onSort:a,onFocus:o,selectOption:i})=>{const[l,c]=y.useState(-1);y.useEffect(()=>{const u=t[l];o(u)},[l,o,t]),y.useEffect(()=>{const u=h=>{var g,_;const p=(g=t[h])==null?void 0:g.id;p&&((_=document.querySelector('[data-option-id="'.concat(p,'"]')))==null||_.scrollIntoView({block:"nearest"}))},f=h=>{Ie("ArrowUp")(h)&&(h.stopPropagation(),h.preventDefault(),c(p=>{const g=Math.max(0,p-1);return u(g),i&&(i.current=g),g})),Ie("ArrowDown")(h)&&(h.stopPropagation(),h.preventDefault(),c(p=>{const g=Math.min(t.length-1,p+1);return u(g),i&&(i.current=g),g}))};return document.body.addEventListener("keydown",f),()=>{document.body.removeEventListener("keydown",f)}},[t,i]);const d=({active:u,over:f})=>{f&&a(u.id.toString(),f.id.toString())};return r.jsx(br,{virtual:!0,disabled:e,items:t,onChange:(u,f)=>d(f),renderItemContent:({item:u})=>{var f;return r.jsx(Kye,{readonly:e,active:u.id===((f=t[l])==null?void 0:f.id),onMore:h=>s(u,h),onSelect:h=>n(u,h),option:u})}})},F$=({multiple:e,site:t,recordId:n,viewId:s,recordIds:a,propertyId:o,onUpdate:i,onClose:l})=>{var te,Q,ne,se,ce;const c=(te=a2(n))!=null?te:"",d=y.useRef(),u=We(c),f=(Q=$0(s))!=null?Q:c,h=Tl(f),p=y.useRef(null),{propertySchema:g}=eo(c,o),_=ft(n,ae=>{var ke;const de=(ke=ae==null?void 0:ae.data.collectionProperties)==null?void 0:ke[o];return fe(de).split(",").map(Te=>Te.trim()).filter(Te=>{var he;return(he=g==null?void 0:g.options)==null?void 0:he.some(Ee=>Ee.value===Te)}).join(",")},[o]),x=ie(),F=ur(),b=$o(),w=a4(),[E,C]=y.useState(_),[k,T]=y.useState(""),[v,I]=y.useState(),j=!a||a.length===1,S=y.useMemo(()=>{var de,ke,Te;const ae=vr.map(he=>he.key);return(Te=NE(ae,(ke=(de=g==null?void 0:g.options)==null?void 0:de.map(he=>he.color))!=null?ke:[]))!=null?Te:vr[0].key},[g==null?void 0:g.options]);_x({onUpdate:i,onClose:l,onSave:()=>{}});const D=ae=>{C(ae),F(a!=null?a:n,o,ht(ae))},A=ae=>{if(p.current&&(p.current.value="",p.current.focus()),!ae)return;const de=E.split(/\s*,\s*/g).filter(Te=>Te);if(de.includes(ae)&&j)return;de.push(ae);const ke=de.join(",");D(ke)},P=ae=>{ae===E&&j||D(ae)},L=()=>{const ae=E.split(/\s*,\s*/g).filter(de=>de);ae.pop(),D(ae.join(","))},O=ae=>{var de;ae.value&&(T(""),e?(A(ae.value),(de=p.current)==null||de.focus()):(P(ae.value),l()))},$=ae=>{var de,ke;if(!(h||u)){if(Ie("Esc")(ae)){l();return}if(Ie("Enter")(ae)){if(typeof d.current<"u"){const he=((ke=(de=g==null?void 0:g.options)==null?void 0:de.filter(Ee=>{var ge;return(ge=Ee.value)==null?void 0:ge.includes(k)}))!=null?ke:[])[d.current];if(he){O(he);return}}G?U():v!=null&&v.value&&(e?A(v.value):(P(v.value),l()));return}!k&&Ie("Backspace")(ae)&&L()}},M=(ae,de)=>{if(!(g!=null&&g.options))return;const ke=g.options.findIndex(Ee=>Ee.id===ae),Te=g.options.findIndex(Ee=>Ee.id===de),he=Wu(g.options,ke,Te);b(c,o,{options:he})},U=()=>{var ke;const ae=qe(),de=k.replace(/,/g,"").trim();w(c,o,{id:ae,value:de,color:S}),e?(A(de),T(""),(ke=p.current)==null||ke.focus()):(P(de),l())},z=ae=>{I(ae)},K=y.useRef(),W=(ae,de)=>{x.dropdown({popcorn:de.currentTarget,placement:"right",content({onCloseModal:ke}){return r.jsx(y$,{option:ae,collectionId:c,propertyId:o,closeModal:ke,closeBeforeCallbackRef:K})},closeBeforeCallBack:()=>{var ke;return(ke=K.current)==null?void 0:ke.call(K)}})},Y=(se=(ne=g==null?void 0:g.options)==null?void 0:ne.filter(ae=>{var de;return(de=ae.value)==null?void 0:de.includes(k)}))!=null?se:[],G=k&&((ce=g==null?void 0:g.options)==null?void 0:ce.every(ae=>ae.value!==k.trim())),ee=u||h;return r.jsxs("div",{style:{maxHeight:"80vh",overflow:"auto"},children:[r.jsxs("div",{className:"p-2 items-center flex flex-wrap min-h-[42px]",children:[r.jsx(p2,{site:t,recordId:n,propertyId:o,multiple:e,editable:!0,className:"w-full",itemClassName:"m-[3px] max-w-[calc(100%-6px)]",onChange:ae=>{var de;D(ae),(de=p.current)==null||de.focus()}}),!u&&r.jsx(oi,{ref:p,autoFocus:!0,singleLine:!0,placeholder:"查找或创建选项",fontClassName:Mn({lineHeight:"24px",fontSize:14,whiteSpace:"nowrap"}),className:Mn({width:"100%",selectors:{"&::placeholder":{color:"var(--grey4)"}}}),boxClassName:Mn({flexBasis:"auto",flexGrow:1,flexShrink:0,minWidth:120,maxWidth:"100%"}),value:k,onKeyDown:$,onChange:ae=>{T(ae.target.value)}})]}),r.jsx(Cr,{}),r.jsx("div",{className:"p-2 text-t2 text-grey3",children:!k&&Y.length===0?"暂无选项":"选择或创建一个选项"}),r.jsx(b$,{options:Y,onSelect:O,onMore:W,onSort:M,onFocus:z,readonly:ee,selectOption:d}),G&&!ee&&r.jsxs("div",{onClick:U,className:"p-2 flex items-center cursor-pointer animate-hover",children:[r.jsx("span",{className:"flex-shrink-0 text-grey3 text-t2 mr-2",children:"创建选项"}),r.jsx(md,{color:S,label:k,value:k})]})]})},Yye=({className:e,...t})=>r.jsx(p2,{className:R("p-[5px] w-full",e),...t,itemClassName:"max-w-[calc(100%-6px)] m-[3px]"}),Xye=({className:e,...t})=>r.jsx(p2,{className:R("p-[5px] w-full",e),...t,multiple:!0,itemClassName:"max-w-[calc(100%-6px)] m-[3px]"}),Qye=e=>r.jsx(F$,{...e}),Jye=e=>r.jsx(F$,{multiple:!0,...e});let w$;const Zye=e=>{w$=e},E$=e=>e===m.CollectionSchemaType.SELECT?Qye:e===m.CollectionSchemaType.MULTI_SELECT?Jye:e===m.CollectionSchemaType.DATE?xxe:e===m.CollectionSchemaType.PERSON?Vxe:e===m.CollectionSchemaType.TEXT?_v:e===m.CollectionSchemaType.NUMBER?Uxe:e===m.CollectionSchemaType.TITLE?_v:e===m.CollectionSchemaType.URL||e===m.CollectionSchemaType.EMAIL||e===m.CollectionSchemaType.PHONE?LC:e===m.CollectionSchemaType.FILE?Ixe:e===m.CollectionSchemaType.FORMULA?Rxe:e===m.CollectionSchemaType.RELATION?w$:Lxe,i4=e=>{const t=Ce(({blocks:s})=>{var o,i,l,c;const a=(o=s[e.recordId])==null?void 0:o.parentId;return(c=(l=(i=s[a!=null?a:""])==null?void 0:i.data.schema)==null?void 0:l[e.propertyId])==null?void 0:c.type},[e.recordId,e.propertyId]),n=E$(t);return r.jsx(n,{...e})},ebe=(e,t)=>{const{tableGroups:n}=lf(e);if(!n)return 0;const{withoutValidGroup:s,sortedRecordIds:a,visibleGroups:o,hiddenGroups:i}=n;if(s)return a.indexOf(t);let l=o.find(c=>c.recordIds.indexOf(t)>=0);return l||(l=i.find(c=>c.recordIds.indexOf(t)>=0),l)?l.recordIds.indexOf(t):0},tbe=({className:e,recordId:t,idnumberIndex:n})=>{const{viewId:s}=Ne();let a=ebe(s,t);return n!==void 0&&(a=n),r.jsx(ki,{className:R("w-full cursor-pointer p-2 leading-5 text-grey3",e),children:a+1})},nbe=({className:e,recordId:t,propertyId:n,site:s})=>{const{relationRecords:a}=C$(t,n),{viewId:o}=Ne(),i=li(o);return a.length===0?null:r.jsx("div",{className:R((s===Ye.CELL||s===Ye.FIELD)&&"w-full h-full p-2 flex flex-wrap",(s===Ye.CALENDAR||s===Ye.LIST)&&"inline",s===Ye.CARD&&"flex flex-wrap w-full overflow-hidden",e),children:a.map(l=>r.jsx(Ir,{interactable:!0,openRight:i==="openInRight",uuid:l,autoIconSize:s!==Ye.CELL&&s!==Ye.FIELD,className:R("leading-none p-0 mr-2 whitespace-nowrap text-ellipsis",s===Ye.CARD&&"text-ellipsis")},l))})},C$=(e,t)=>{const n=cr(e);return Ce(({blocks:s})=>wc(e,t,s),[e,t,n==null?void 0:n.data.collectionProperties])},sbe=({className:e,recordId:t,propertyId:n,site:s})=>{var c;const a=We(t),o=n==="title",i=ft(t,d=>{var u;return o?d==null?void 0:d.data.segments:(u=d==null?void 0:d.data.collectionProperties)==null?void 0:u[n]},[n]),l=y.useMemo(()=>fe(i),[i]);return!i||i.length===0||i.length===1&&((c=i[0])==null?void 0:c.type)===m.TextType.TEXT&&i[0].text===""?null:r.jsxs("div",{className:"p-2 w-full group-scope",children:[r.jsx(fs,{className:R("leading-[20px]",e),plugins:o?oa:void 0,segments:i,interactable:a}),r.jsx(jp,{text:l,site:s})]})},rbe=({collectionId:e,propertyId:t,closeSelf:n})=>{const{relationPropertySchema:s}=eo(e,t),a=$o(),i=Ce(({blocks:c})=>{var h,p;const d=c[(h=s==null?void 0:s.collectionId)!=null?h:""],u=[],f={findSchema(g,_){var x,F;return(F=(x=c[g])==null?void 0:x.data.schema)==null?void 0:F[_]}};return Object.entries((p=d==null?void 0:d.data.schema)!=null?p:{}).forEach(([g,_])=>{var x;_.type!==m.CollectionSchemaType.ROLLUP&&!KM(e,t,(x=s==null?void 0:s.collectionId)!=null?x:"",g,f)&&u.push({..._,propertyId:g})}),u},[e,t,s==null?void 0:s.collectionId]).map(c=>({type:H.OPERATION,data:{icon:un[c.type],title:c.name,propertyId:c.propertyId,type:c.type}})),l=(c,d)=>{var h,p,g;const{blocks:u}=pe(),f=(g=((p=(h=u[e])==null?void 0:h.data.schema)!=null?p:{})[t])!=null?g:{};a(e,t,{...f,targetProperty:c,targetPropertyType:d,aggregation:void 0,showAs:void 0}),n()};return r.jsx("div",{className:"flex flex-col w-[300px] next-modal-scroll py-2",children:r.jsx(ze,{items:i,onItemClick:c=>l(c.data.propertyId,c.data.type)})})},abe=({collectionId:e,propertyId:t,closeSelf:n})=>{const s=$o(),o=Ce(({blocks:l})=>{var u;const c=l[e],d=[];return Object.entries((u=c==null?void 0:c.data.schema)!=null?u:{}).forEach(([f,h])=>{h.type===m.CollectionSchemaType.RELATION&&d.push({...h,propertyId:f})}),d},[e]).map(l=>({type:H.OPERATION,data:{icon:un[m.CollectionSchemaType.RELATION],title:l.name,propertyId:l.propertyId}})),i=l=>{var u,f,h;const{blocks:c}=pe(),d=(h=((f=(u=c[e])==null?void 0:u.data.schema)!=null?f:{})[t])!=null?h:{};s(e,t,{...d,relationProperty:l,targetProperty:"title",targetPropertyType:m.CollectionSchemaType.TITLE,aggregation:void 0,showAs:void 0}),n()};return r.jsx("div",{className:"flex flex-col w-[300px] next-modal-scroll py-2",children:o.length?r.jsx(ze,{items:o,onItemClick:l=>i(l.data.propertyId)}):r.jsx("div",{className:"text-t4 px-2 text-grey3",children:"无法进行汇总，请添加关联列"})})},l4=({viewId:e,collectionId:t,propertyId:n})=>{var x,F,b;const s=ie(),a=(x=$0(e))!=null?x:t,o=We(a),i=Tl(a),l=o||i,c=$o(),{propertySchema:d,targetPropertySchema:u,relationPropertySchema:f}=eo(t,n),{targetProperty:h}=d!=null?d:{};if(!d)return null;const p=w=>{l||s.dropdown({popcorn:w.currentTarget,placement:"bottom",content:({onCloseModal:E})=>r.jsx(abe,{collectionId:t,propertyId:n,closeSelf:E})})},g=w=>{l||f&&s.dropdown({popcorn:w.currentTarget,placement:"bottom",content:({onCloseModal:E})=>r.jsx(rbe,{collectionId:t,propertyId:n,closeSelf:E})})},_=w=>{if(l||!(f!=null&&f.collectionId)||!h)return;const C=Hde(f.collectionId,h,u==null?void 0:u.type).map(T=>({type:H.OPERABLE_BLOCK_TEXT,data:T})),k=T=>{c(t,n,{...d,showAs:void 0,aggregation:T})};s.dropdown({popcorn:w.currentTarget,placement:"bottom",content:({onCloseModal:T})=>r.jsx(ze,{className:"w-[200px] py-2 next-modal-scroll",items:C,onItemClick:v=>{k(v.data.type),T()}})})};return r.jsxs("div",{className:"flex flex-col w-[240px] next-modal",children:[r.jsxs("div",{className:"flex flex-col mb-[5px]",children:[r.jsx("div",{className:"text-t2 text-grey3 mb-[4px] mx-4 mt-2.5",children:"关联"}),r.jsxs("div",{onClick:p,className:"flex items-center justify-between h-10 px-2 mx-2 rounded cursor-pointer active-bg animate-hover text-ellipsis",children:[r.jsxs("div",{className:"flex min-w-0 items-center",children:[f&&r.jsx(V,{name:un[f.type],size:"middle"}),r.jsx("span",{className:"flex-1 min-w-0 overflow-hidden text-black whitespace-nowrap overflow-ellipsis text-t2 ml-2",children:(F=f==null?void 0:f.name)!=null?F:"请选择"})]}),!l&&r.jsx(V,{name:"IcMenuNext",size:"middle",className:"text-grey4 rotate-90"})]})]}),r.jsxs("div",{className:"flex flex-col mb-[5px]",children:[r.jsx("div",{className:"text-t2 text-grey3 mb-[4px] mx-4 mt-2.5",children:"汇总属性"}),r.jsxs("div",{onClick:g,className:R("flex items-center justify-between h-10 px-2 mx-2 rounded cursor-pointer text-ellipsis",f?"animate-hover active-bg":"opacity-30"),children:[r.jsxs("div",{className:"flex min-w-0 items-center",children:[u&&r.jsx(V,{name:un[u.type],size:"middle"}),r.jsx("span",{className:"flex-1 min-w-0 overflow-hidden text-black whitespace-nowrap overflow-ellipsis text-t2 ml-2",children:(b=u==null?void 0:u.name)!=null?b:"请选择"})]}),!l&&r.jsx(V,{name:"IcMenuNext",size:"middle",className:"text-grey4 rotate-90"})]})]}),r.jsxs("div",{className:R("flex flex-col mb-[5px]"),children:[r.jsx("div",{className:"text-t2 text-grey3 mb-[4px] mx-4 mt-2.5",children:"汇总方式"}),r.jsxs("div",{onClick:_,className:R("flex items-center justify-between h-10 px-2 mx-2 rounded cursor-pointer text-ellipsis",f?"animate-hover active-bg":"opacity-30"),children:[r.jsx("div",{className:"flex min-w-0 items-center",children:r.jsx("span",{className:"flex-1 min-w-0 overflow-hidden text-black whitespace-nowrap overflow-ellipsis text-t2",children:d.aggregation?pn[d.aggregation]:"显示 原始值"})}),!l&&r.jsx(V,{name:"IcMenuNext",size:"middle",className:"text-grey4 rotate-90"})]})]})]})},k$=e=>{const t=ie(),n=(s,a,o,i)=>{s.stopPropagation(),t.dropdown({popcorn:i!=null?i:s.currentTarget,placement:"bottom",content:()=>r.jsx(l4,{collectionId:e,propertyId:a,viewId:o})})};return y.useCallback(n,[e,t])},obe=y.memo(({className:e,recordId:t,propertyId:n,site:s})=>{const{collectionId:a,viewId:o,tableCellWrap:i}=Ne(),l=k$(a),{propertySchema:c,targetPropertySchema:d}=eo(a,n),{aggregation:u}=c!=null?c:{},f=Ce(x=>Ba(t,n,x),[t,n]),h=y.useMemo(()=>{var F;let x;if(f){const{originValues:b,targetProperty:w,targetPropertySchema:E,aggregationValue:C,relationRecords:k,formulaType:T}=f;if(ni(u)&&(x=ibe({relationRecords:k,propertyId:w,propertySchema:E,rollupSchema:c,blocks:pe().blocks,originValues:b,site:s,formulaType:T,tableCellWrap:i})),typeof C<"u"){const v=E.type===m.CollectionSchemaType.NUMBER&&!!E.numberFormat&&Qc(u);let I=C;if(v){const D=hl(Number(C),E.numberFormat);if(typeof D=="string")I=D;else if(typeof D=="number")I=String(D);else return null}let j=null;if(qm(u))j=E1({num:V0(C),showAs:c==null?void 0:c.showAs,numberFormat:"percent",from:"rollup"});else{const D=Number(C);isNaN(D)||OM(u)==="number"&&(j=E1({num:D,showAs:c==null?void 0:c.showAs,numberFormat:Qc(u)?E.numberFormat:void 0,from:"rollup"}))}const{showNumber:S}=(F=c==null?void 0:c.showAs)!=null?F:{};x=r.jsxs("div",{className:R("w-full",j&&"flex items-center whitespace-nowrap",j&&s===Ye.CELL&&"justify-end",s===Ye.CELL&&!fl(u)?"text-right ":"text-left"),children:[j&&!S?null:I,j]})}}return x},[u,c,f,s,i]),p=d==null?void 0:d.type,_=ni(u)&&(p===m.CollectionSchemaType.PERSON||p===m.CollectionSchemaType.UPDATED_BY||p===m.CollectionSchemaType.CREATED_BY);return r.jsxs("div",{className:R("rollup-box h-full w-full",!_&&(s===Ye.CELL||s===Ye.FIELD)&&"p-2",e),children:[h,!h&&s===Ye.FIELD&&r.jsx("span",{className:"text-grey4",children:Wa.isEmpty}),(s===Ye.CELL||s===Ye.FIELD)&&r.jsx("button",{onClick:x=>l(x,n,o),className:R("animate-hover-opaque border-grey6 absolute top-1.5 right-1 flex h-6 w-6 cursor-pointer items-center justify-center rounded border bg-white1 opacity-0"),children:r.jsx(V,{name:"IcBtnEdit",size:"middle",className:"text-grey3"})})]})},yn),ibe=({propertyId:e,relationRecords:t,blocks:n=pe().blocks,propertySchema:s,rollupSchema:a,originValues:o,site:i,formulaType:l,tableCellWrap:c})=>{if(!s)return null;const d=s.type,u=(f,h)=>{var x;let p=f;if(s.numberFormat){const F=hl(Number(f),s.numberFormat);if(typeof F=="string")p=F;else if(typeof F=="number")p=String(F);else return null}let g=null;const _=Number(f);return isNaN(_)||(g=E1({num:_,showAs:a==null?void 0:a.showAs,numberFormat:s.numberFormat,from:"property-value"})),a!=null&&a.showAs&&(a!=null&&a.showAs.type)?r.jsxs("div",{className:R("flex items-center whitespace-nowrap",i===Ye.CELL&&"justify-end",(i===Ye.LIST||i===Ye.CALENDAR)&&"inline-flex ml-2"),children:[g&&!((x=a==null?void 0:a.showAs)!=null&&x.showNumber)?void 0:p,g]},h):r.jsx(ki,{className:"inline leading-5 ",children:h===o.length-1?p:"".concat(p,", ")},h)};if(d===m.CollectionSchemaType.TITLE)return r.jsx(r.Fragment,{children:t.map(f=>r.jsx(Ir,{uuid:f,className:"mr-2 whitespace-nowrap p-0 leading-none"},f))});if(d===m.CollectionSchemaType.TEXT)return r.jsx(r.Fragment,{children:t.map((f,h)=>{var _;const p=n[f],g=(_=p==null?void 0:p.data.collectionProperties)==null?void 0:_[e];return fe(g)?r.jsxs(fn.Fragment,{children:[r.jsx(fs,{className:"inline leading-[20px]",segments:g,interactable:!1}),h!==o.length-1&&", "]},f):null})});if(d===m.CollectionSchemaType.DATE)return r.jsx(r.Fragment,{children:t.map((f,h)=>{var b,w;const p=n[f],g=(w=(b=p==null?void 0:p.data.collectionProperties)==null?void 0:b[e])==null?void 0:w[0];if(!g)return null;const _=Yp(g,s.dateFormat,g.type===m.TextType.DATETIME,g.timeFormat),x=YL(g),F=Date.now()-(x!=null?x:0)>0;return g.reminder?r.jsxs(ki,{className:R("inline leading-5 text-red",{"line-through text-red/70":F}),children:[_,r.jsx(V,{name:"IcMenuAlarm",size:"normal",className:R("text-red ml-[2px]",{"text-red/70":F})}),h===o.length-1?"":", "]},h):r.jsx(ki,{className:"inline leading-5 ",children:h===o.length-1?_:"".concat(_,", ")},h)})});if(d===m.CollectionSchemaType.NUMBER)return r.jsx(r.Fragment,{children:o.map((f,h)=>typeof f!="string"?null:u(f,h))});if(d===m.CollectionSchemaType.CREATED_AT||d===m.CollectionSchemaType.UPDATED_AT)return r.jsx(r.Fragment,{children:o.map((f,h)=>typeof f!="string"?null:r.jsx(ki,{className:"inline leading-5 ",children:h===o.length-1?f:"".concat(f,", ")},h))});if(d===m.CollectionSchemaType.PHONE||d===m.CollectionSchemaType.EMAIL||d===m.CollectionSchemaType.URL)return r.jsx(r.Fragment,{children:o.map((f,h)=>{if(typeof f!="string")return null;const g=i2(d)(f);return r.jsxs(fn.Fragment,{children:[r.jsx("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"animate-hover border-grey5 my-px inline cursor-pointer rounded-none border-b leading-5 text-black/95 hover:rounded-sm",children:f}),h!==o.length-1&&", "]},h)})});if(d===m.CollectionSchemaType.CHECKBOX)return r.jsx(r.Fragment,{children:o.map((f,h)=>{const p=typeof f=="string"&&us(f),g=i===Ye.CELL||i===Ye.FIELD;let _="";return p?_=g?"IcCheckboxCheck":"IcCheckbox2Check":_=g?"IcCheckbox":"icCheckbox2",r.jsx(_a,{size:g?"large":"small",className:"mr-2",name:_,checked:p},h)})});if(d===m.CollectionSchemaType.CREATED_BY||d===m.CollectionSchemaType.UPDATED_BY||d===m.CollectionSchemaType.PERSON)return r.jsx("div",{className:R("flex",i===Ye.LIST||i===Ye.CALENDAR?"text-ellipsis whitespace-nowrap":"flex-wrap"),children:o.map((f,h)=>typeof f!="string"?null:r.jsx(si,{className:"my-px px-2 py-1.5",userId:f},h))});if(d===m.CollectionSchemaType.SELECT||d===m.CollectionSchemaType.MULTI_SELECT){const{options:f}=s;return f?r.jsx("div",{className:R("flex",i===Ye.LIST||i===Ye.CALENDAR||!c?"text-ellipsis whitespace-nowrap":"flex-wrap"),children:o.map((h,p)=>{if(typeof h!="string")return null;const g=f.find(_=>_.id===h);return g?r.jsx(md,{color:g.color,value:g.value,label:g.value,className:R("flex-shrink-0",i!==Ye.CELL&&i!==Ye.FIELD?"text-t4 mr-1":"m-[3px]",i===Ye.CALENDAR?"my-[1px]":"my-0.5")},p):null})}):null}else if(d===m.CollectionSchemaType.FILE){const f=[];return t.forEach(h=>{var _,x;const p=n[h];if(!p)return;((x=(_=p.data.collectionProperties)==null?void 0:_[e])!=null?x:[]).forEach(F=>{F.type===m.TextType.URL&&F.fileStorageType==="internal"&&f.push({...F,blockId:h})})}),r.jsx("div",{className:R("flex",i===Ye.LIST||i===Ye.CALENDAR?"text-ellipsis whitespace-nowrap py-px":"flex-wrap"),children:f.map((h,p)=>{const g=Jp(h.url),_=r.jsx(md,{label:h.text,color:vr[0].key,className:R("max-w-[calc(100%-6px)] align-middle",i===Ye.CELL||i===Ye.FIELD?"m-[3px]":"mr-1")},p);return g&&h.uuid&&(!h.size||h.size<=xx)?r.jsx(ah,{uuid:h.uuid,ossName:h.url,defaultIcon:_,className:R("h-5 min-h-[20px] min-w-[20px] cursor-pointer overflow-hidden rounded-sm",i===Ye.CELL||i===Ye.FIELD?"m-[3px]":"mr-1")},p):_})})}else{if(d===m.CollectionSchemaType.RELATION)return r.jsx(r.Fragment,{children:o.map((f,h)=>typeof f!="string"?null:r.jsx(Ir,{uuid:f,className:"mr-2 whitespace-nowrap p-0 leading-none"},h))});if(d===m.CollectionSchemaType.FORMULA)return r.jsx(r.Fragment,{children:o.map((f,h)=>{if(typeof f!="string")return null;if(l===et.ValueTool.booleanType){const p=us(f);return r.jsx(_a,{size:"large",checked:p},h)}return l===et.ValueTool.numberType?u(f,h):r.jsx(ki,{className:"inline leading-5 ",children:h===o.length-1?f:"".concat(f,", ")},h)})})}return null};const wm=y.createContext({child2ParentMap:new Map,parent2ChildMap:new Map,filteredRecordIdSet:new Set}),Mg=()=>y.useContext(wm),c4=e=>{var i;const{viewId:t}=Ne(),{recordId:n}=e,{parent2ChildMap:s}=Mg(),a=(i=s==null?void 0:s.get(n))!=null?i:[],o=Il(t);return a.length===0?null:o==="ParentOnly"?r.jsxs("div",{className:R("text-grey4 flex items-center text-t4-medium px-2",e.className),children:[r.jsx(V,{name:"IcMove",size:"xsmall",style:{transform:"translateY(-1px) scaleY(-1)"}}),r.jsx("div",{className:"ml-0.5",children:a.length})]}):null},d4=e=>{var l;const{viewId:t}=Ne(),{child2ParentMap:n}=Mg(),s=(l=n==null?void 0:n.get(e.recordId))!=null?l:[],a=Il(t),o=ys(),i=li(t);return s.length===0?null:a==="Flattenlist"?r.jsx(Cs,{popup:"按住Alt点击可右侧打开",delay:{open:1e3},flexCenter:!1,className:R("px-2 mx-1",e.className),children:r.jsx("div",{className:"text-grey4 flex items-center text-t4-medium animate-hover",onClick:c=>{c.stopPropagation(),o(s[0],{forceOpenInRight:c.altKey,openWay:i,forceOpenNewTab:c.ctrlKey||c.metaKey})},children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{name:"IcMove",size:"xxsmall",style:{transform:"rotate(-90deg)"}}),r.jsx(yl,{uuid:s[0]})]})})}):null},lbe=y.memo(({className:e,recordId:t})=>{const{illegal:n}=mt(t),{relationEditor:s,viewId:a}=Ne(),{segments:o,showIcon:i,icon:l}=ft(t,h=>{var p,g;return{segments:h==null?void 0:h.data.segments,showIcon:((p=h==null?void 0:h.subNodes)!=null?p:[]).length>0||((g=h==null?void 0:h.data.icon)==null?void 0:g.type),icon:h==null?void 0:h.data.icon}}),c=li(a),d=ys(),u=pw(),f=Cg(a);return r.jsxs("div",{className:R("p-2 leading-none flex",{"opacity-30":n},e),children:[i&&f&&r.jsx(Fn,{className:R("mr-1 inline-block h-5 w-5 p-0",{"!align-middle":(l==null?void 0:l.type)!=="emoji"}),blockId:t,iconSize:20,defaultIcon:r.jsx(_s,{uuid:t,size:"middle"})}),n?r.jsx("span",{className:"border-b border-grey6 align-middle leading-[19px]",children:Ts}):ot.print?r.jsx("a",{href:"/".concat(t),className:"underline",children:r.jsx(fs,{className:"text-t2 inline align-middle",plugins:oa,segments:o,interactable:!1})}):r.jsx(fs,{className:"text-t2 inline align-middle",plugins:oa,segments:o,interactable:!1}),r.jsx(c4,{recordId:t}),r.jsx(d4,{recordId:t,className:"mt-0.5"}),r.jsx(nh,{className:"inline-flex align-middle pointer-events-none",blockId:t}),!s&&r.jsx("div",{className:"animate-hover-opaque absolute top-[5px] right-[5px] rounded border border-grey6 bg-white1 opacity-0 transition-opacity group-hover:opacity-100 py-0.5 px-1",onClick:h=>{h.stopPropagation(),Cd(location.search)===t?u():d(t,{illegal:n,forceOpenInRight:h.altKey,openWay:c,forceOpenNewTab:h.ctrlKey||h.metaKey})},children:r.jsx(Fe,{popup:c==="openInRight"?"右侧边栏打开":"打开此页面",children:r.jsxs("div",{className:"flex items-center text-t4 space-x-1",children:[r.jsx(V,{size:"middle",name:c==="openInRight"?"IcBlockRightSidebarOpen":"IcBlockFullPageOpen",className:"text-grey3"}),r.jsx("div",{className:"text-grey1",children:"打开"})]})})})]})},yn),b6=5,$C=y.memo(e=>{const{recordId:t,propertyId:n,groupValue:s,style:a,isLastCell:o,propertyIndex:i,expandNode:l,idnumberIndex:c}=e,{collectionId:d,viewId:u,relationEditor:f,tableCellWrap:h,viewType:p}=Ne(),{illegal:g,pageId:_,readonly:x,index:F}=y.useContext(LV),b=nf(),w=y.useRef(null),E=y.useRef(!1),[C,k]=y.useState(!1),T=ie(),v=ln(),[I]=y.useState(Date.now()),j=p===m.CollectionViewType.TIMELINE,S=Ks(),D=ft(d,Te=>{var he,Ee;return(Ee=(he=Te==null?void 0:Te.data.schema)==null?void 0:he[n])==null?void 0:Ee.type}),A=Af(D),P=ur(),L=oxe(),O=rh(),$=!D||hm.includes(D)||GI.includes(D),{isSelectedCell:M,isFocused:U}=Ce(({ui:{selectedCells:Te}})=>{const Ee=!!Te.find(Re=>Re.recordId===t&&Re.propertyId===n&&Re.viewId===u&&Re.groupValue===s),ge=Te[0],Se=ge?ge.recordId===t&&ge.propertyId===n&&ge.viewId===u&&ge.groupValue===s:!1;return{isSelectedCell:Ee,isFocused:Se}},[t,n,u,s],{obsSelectCell:[{recordId:t,propertyId:n,viewId:u}],wait:50,waitMode:"throttle",ignoreDeep:!0}),z="cell-".concat(t,"-").concat(n,"-").concat(u,"-").concat(s);y.useEffect(()=>()=>v(z),[z,v]);const K=y.useRef(null);y.useEffect(()=>{if(!w.current||!C)return;let Te;const he=3,Ee=w.current.getBoundingClientRect(),ge={};(D===m.CollectionSchemaType.TEXT||D===m.CollectionSchemaType.TITLE||D===m.CollectionSchemaType.NUMBER||D===m.CollectionSchemaType.EMAIL||D===m.CollectionSchemaType.URL||D===m.CollectionSchemaType.PHONE)&&(Te="fadeIn",ge.overflow="auto",h?(ge.width=Ee.width+he,ge.minHeight=Math.min(Ee.height+he,window.innerHeight*.8)):(ge.minWidth=Ee.width+he,ge.maxWidth=320)),(D===m.CollectionSchemaType.SELECT||D===m.CollectionSchemaType.MULTI_SELECT)&&(ge.minWidth=Ee.width+he,ge.maxWidth=320),D===m.CollectionSchemaType.FILE&&(ge.minWidth=262,ge.maxWidth=320);const Se=D===m.CollectionSchemaType.DATE?Ee.height:0;O(_,t),T.dropdown({modalId:z,animation:Te,placement:"bottom-start",offset:[-he/2,-Ee.height-he/2+Se],popcorn:{getBoundingClientRect:()=>Ee},closeBeforeCallBack(){var Re;if(k(!1),window.event&&window.event.type==="keydown"&&Ie("Enter")(window.event)){let{sortedRecordIds:Ae}=Jc({viewId:u,groupValue:s,pageId:_,openSubItem:!0});Ae=By(d,u,Ae);let Me=Ae.findIndex(tt=>tt===t);Me+=1,Me=Es(Me,0,Ae.length-1);const Ge=(Re=Ae[Me])!=null?Re:t;re(at.update({selectedCells:[{propertyId:n,recordId:Ge,viewId:u,groupValue:s}]}))}else re(at.update({selectedCells:[{propertyId:n,recordId:t,viewId:u,syncId:S,groupValue:s}]}))},content({onCloseModal:Re}){return r.jsx("div",{className:"next-modal max-h-[80vh]",style:ge,ref:K,onKeyDown:Ae=>{Ie("Tab")(Ae)&&(Re(),G(Ae))},children:r.jsx(Qp.Provider,{value:K,children:r.jsx(i4,{site:Ye.CELL,viewId:u,recordId:t,propertyId:n,onUpdate:()=>{},onClose:Re})})})}})},[D,C,s,F,z,T,_,n,t,O,S,h,u]),y.useEffect(()=>{U&&!C&&w.current&&(Date.now()-I>1e3||D===m.CollectionSchemaType.CHECKBOX)&&w.current.focus()},[M,C,U,I,D]),y.useEffect(()=>{const Te=xt.$newCreatedRecord;t===(Te==null?void 0:Te.id)&&u===Te.viewId&&D===m.CollectionSchemaType.TITLE&&(!Te.from||Te.from===gx.TIMELINE_TABLE)&&(k(!0),st({$newCreatedRecord:void 0}))},[]);const W=y.useRef(!1),Y=Te=>{var he,Ee;if(D&&!E.current){if(D===m.CollectionSchemaType.ID_NUMBER&&!x){if(IO({blocks:J.blocks,selectedBlocks:J.ui.selectedBlocks,uuid:t,groupValue:s,syncId:S,viewId:u}))return;Te.shiftKey?re(at.addSelectBlock({blockId:t,syncId:S,viewId:u})):re(at.updateSelectBlocks([{blockId:t,syncId:S,viewId:u}]));return}if(!(x&&D!==m.CollectionSchemaType.FILE&&D!==m.CollectionSchemaType.RELATION)&&!xt.$isSelecting&&!W.current&&!g){if(D===m.CollectionSchemaType.CHECKBOX){const{blocks:ge}=pe(),Se=(Ee=(he=ge[t])==null?void 0:he.data.collectionProperties)==null?void 0:Ee[n],Re=fe(Se);P(t,n,us(Re)?"NO":"YES");return}if(C){k(!1);const ge=setTimeout(()=>{clearTimeout(ge),k(!0)})}else{if($&&D!==m.CollectionSchemaType.FORMULA)return;k(!0)}}}},G=Te=>{var Me,Ge,tt,gt;if(g||!D||xt.$isOpenImagePreview)return;const{ui:he,blocks:Ee,collectionViews:ge}=pe(),Se=he.selectedCells[0],Re=he.selectedCells[he.selectedCells.length-1];if(!Re||!Se)return;if(Ie(["ArrowUp","shift+ArrowUp","ArrowDown","shift+ArrowDown","ArrowLeft","shift+ArrowLeft","ArrowRight","shift+ArrowRight","Tab"])(Te)){Te.preventDefault();const{selectedCells:kt}=he;if(kt.length===0)return;const At=Te.shiftKey;let{sortedRecordIds:Qt}=Jc({viewId:u,groupValue:s,pageId:_,openSubItem:!0});Qt=By(d,u,Qt);const nn=ge[u],[sn,ms]=qj(u,{includeIdNumber:!0},m.CoverType.NONE,J,nn==null?void 0:nn.type),N=(Me=j?ms:sn)==null?void 0:Me.filter(Le=>Le.visible).map(Le=>Le.property);if(!N)return;let B=N.findIndex(Le=>Le===(At?Re.propertyId:Se.propertyId)),X=Qt.findIndex(Le=>Le===(At?Re.recordId:Se.recordId));if(B===-1||X===-1){$u("cell");return}if(Ie(["ArrowUp","shift+ArrowUp"])(Te)?X-=1:Ie(["ArrowDown","shift+ArrowDown"])(Te)?X+=1:Ie(["ArrowLeft","shift+ArrowLeft"])(Te)?B-=1:Ie(["ArrowRight","shift+ArrowRight","Tab"])(Te)&&(B+=1),At&&(B<0||B>=N.length||X<0||X>=Qt.length))return;B<0&&(X-=1,B=N.length-1),B>N.length-1&&(B=0,X+=1),X=Es(X,0,Qt.length-1);const Z=N.findIndex(Le=>Le===Se.propertyId),oe=Qt.findIndex(Le=>Le===Se.recordId),xe=N[B],Be=Qt[X];if(xe&&Be)if(At){const Le=X>oe,bt=B>Z,Ue=[];for(let He=oe;Le?He<=X:He>=X;Le?He++:He--)for(let rt=Z;bt?rt<=B:rt>=B;bt?rt++:rt--){const je=N[rt],le=Qt[He];je&&le&&Ue.push({propertyId:je,recordId:le,viewId:u,syncId:S,groupValue:s})}re(at.update({selectedCells:Ue}))}else re(at.update({selectedCells:[{propertyId:xe,recordId:Be,viewId:u,syncId:S,groupValue:s}]}));else re(at.update({selectedCells:[]}));return}if(x)return;const Ae=(tt=(Ge=Ee[t])==null?void 0:Ge.data.collectionProperties)==null?void 0:tt[n];if(Ie("Enter")(Te)){if(D===m.CollectionSchemaType.CHECKBOX||D===m.CollectionSchemaType.ROLLUP||hm.includes(D)){if(D===m.CollectionSchemaType.CHECKBOX){const nn=fe(Ae),sn=J.ui.selectedCells.filter(ms=>ms.propertyId===n).flatMap(ms=>ms.recordId);if(P(sn,n,us(nn)?"NO":"YES"),sn.length>1)return}let{sortedRecordIds:kt}=Jc({viewId:u,groupValue:s,pageId:_,openSubItem:!0});kt=By(d,u,kt);let At=kt.findIndex(nn=>nn===t);At+=1,At=Es(At,0,kt.length-1);const Qt=(gt=kt[At])!=null?gt:t;re(at.update({selectedCells:[{propertyId:n,recordId:Qt,viewId:u,syncId:S,groupValue:s}]}))}else $u("cell"),k(!0);Te.preventDefault();return}Ie(["Backspace","Delete"],{byKey:!0})(Te)&&L(J.ui.selectedCells)},ee=Te=>{if(Te.button===2||Te.target instanceof Element&&Te.target.closest("[data-disable-select], [data-draggable]"))return;Te.preventDefault(),!M&&D!==m.CollectionSchemaType.CHECKBOX&&(W.current=!0);const{autoScrollY:he,rafY:Ee}=zj(),ge=b==null?void 0:b.current;if(!ge)return;const Se={x:Te.clientX,y:Te.clientY};let Re=!1;const Ae=Ps(Ge=>{if(!Re){if(Math.abs(Se.x-Ge.clientX)<b6&&Math.abs(Se.y-Ge.clientY)<b6)return;Re=!0}J.ui.selectedCells.length===0&&(E.current=!0,st({$isSelecting:!0}),re(at.update({selectedCells:[{recordId:t,propertyId:n,viewId:u,syncId:S,groupValue:s}]}))),he({y:Ge.clientY,container:ge}),PV(Ge)},60),Me=()=>{cancelAnimationFrame(Ee.id),!E.current&&!Te.shiftKey&&D!==m.CollectionSchemaType.ID_NUMBER&&re(at.update({selectedCells:[{recordId:t,propertyId:n,viewId:u,syncId:S,groupValue:s}]})),document.removeEventListener("mousemove",Ae),document.removeEventListener("mouseup",Me),setTimeout(()=>{W.current=!1,E.current=!1,st({$isSelecting:!1})},0)};document.addEventListener("mousemove",Ae),document.addEventListener("mouseup",Me)},te=MV(),[Q,ne]=y.useState(!1),se=Te=>{D===m.CollectionSchemaType.FILE&&[...Te.dataTransfer.items].some(he=>he.kind==="file")&&ne(!0)},ce=Te=>{Te.preventDefault(),Te.stopPropagation(),ne(!1),Lb(),D===m.CollectionSchemaType.FILE&&[...Te.dataTransfer.items].filter(he=>he.kind==="file").map(he=>he.getAsFile()).forEach(he=>{te(he,[t],n)})},ae=D===m.CollectionSchemaType.SELECT||D===m.CollectionSchemaType.FILE||D===m.CollectionSchemaType.MULTI_SELECT||D===m.CollectionSchemaType.RELATION||D===m.CollectionSchemaType.FORMULA,de=D===m.CollectionSchemaType.FILE?"IcBtnNew":D===m.CollectionSchemaType.FORMULA?"IcFormula":"IcNaviUnfold",ke={};return D===m.CollectionSchemaType.ID_NUMBER&&os(ke,{"data-no-cancel-selected":""}),r.jsxs("div",{...ke,"data-property-id":n,ref:w,tabIndex:-1,style:a,className:R("min-h-full flex relative outline-none transition-all ease-out",{"selected-cell":M,"focused-cell":U,"h-9":!h,"bg-black_006":Q,"pointer-events-none":f,"border-r":!(j&&o&&!ot.print)}),onClick:Y,onKeyDown:G,onMouseDown:ee,onDragOver:se,onDragLeave:()=>ne(!1),onDragEnd:()=>ne(!1),onDrop:ce,children:[g&&D!==m.CollectionSchemaType.TITLE?null:r.jsxs("div",{className:R("w-full flex flex-shrink-0 relative overflow-hidden text-t2",{"break-words whitespace-pre-wrap min-h-full":h,"whitespace-nowrap flex overflow-ellipsis h-full":!h,"hover-box":ae},Mn({selectors:{"& > *":{flexShrink:h?void 0:0}}})),children:[i===0&&r.jsx("div",{className:"mt-[7px]",style:{alignSelf:"normal"},children:l}),r.jsx(Og,{children:r.jsx(A,{site:Ye.CELL,recordId:t,propertyId:n,idnumberIndex:c})}),ae&&!x&&r.jsx("button",{onClick:()=>k(!0),className:R("animate-hover-opaque border-grey6 absolute top-1.5 right-1 flex h-6 w-6 cursor-pointer items-center justify-center rounded border bg-white1 opacity-0"),children:r.jsx(V,{name:de,size:"middle",className:"text-grey3"})})]}),!x&&U&&!$&&r.jsx(bxe,{className:"absolute z-[9] -right-0 -bottom-0"})]})},yn),Af=e=>{switch(e){case m.CollectionSchemaType.TITLE:return lbe;case m.CollectionSchemaType.NUMBER:return M8;case m.CollectionSchemaType.CHECKBOX:return BV;case m.CollectionSchemaType.SELECT:return Yye;case m.CollectionSchemaType.MULTI_SELECT:return Xye;case m.CollectionSchemaType.DATE:return _xe;case m.CollectionSchemaType.PERSON:return Ede;case m.CollectionSchemaType.UPDATED_AT:return pxe;case m.CollectionSchemaType.CREATED_AT:return gxe;case m.CollectionSchemaType.UPDATED_BY:return Fde;case m.CollectionSchemaType.CREATED_BY:return wde;case m.CollectionSchemaType.TEXT:return sbe;case m.CollectionSchemaType.URL:return Bxe;case m.CollectionSchemaType.EMAIL:return Oxe;case m.CollectionSchemaType.PHONE:return Mxe;case m.CollectionSchemaType.FILE:return Cxe;case m.CollectionSchemaType.FORMULA:return Axe;case m.CollectionSchemaType.RELATION:return nbe;case m.CollectionSchemaType.ROLLUP:return obe;case m.CollectionSchemaType.ID_NUMBER:return tbe;default:return OV}};const up=30,cbe=e=>{const{uuid:t,viewId:n,groupValue:s}=e,a=We(t,!1),o=Sd(t,n,s),i=Ks();return r.jsx(T$,{...e,checked:!!o,readonly:a,onCheck:l=>{const c=l?at.addSelectBlock:at.removeSelectBlock;re(c({blockId:t,syncId:i,viewId:n}))}})},T$=e=>{const{readonly:t,checked:n}=e;return pt()?null:r.jsx("div",{className:R("",{"border-r":!e.isGroup}),style:{padding:6,width:up},children:r.jsx(Cs,{popup:t?"该记录无编辑权限":"",children:r.jsxs("button",{disabled:t,className:R("flex items-center cursor-default",e.className,{hiddenCheckBox:!n&&!e.alwaysShow}),style:{width:24,height:24},children:[r.jsx("div",{className:"hidden h-5"}),r.jsx(_a,{onClick:()=>{e.onCheck(!n)},className:"opacity-90",size:"middle",checked:n})]})})})},v$=e=>{const{expand:t,level:n,onExpand:s,childrenLen:a}=e,{readonly:o,viewType:i}=Ne(),l=i===m.CollectionViewType.LIST;return o&&a===0?r.jsx("div",{className:"w-6",style:{marginLeft:n*20}}):r.jsx(V,{"data-no-cancel-selected":!0,"data-disable-select":!0,className:R("animate-hover",!t&&a===0&&"text-grey",a===0&&"".concat(l?"group-scope-hover:opacity-100":"group-hover:opacity-100"," opacity-0 text-grey")),style:{marginLeft:n*20},name:t?"IcToggleBlackUnfold":"IcToggleBlack",size:"xlarge",onClick:c=>{c.stopPropagation(),s(!t)}})},S1=y.memo(e=>{var F;const{level:t}=e,{collectionId:n,viewId:s,readonly:a}=Ne(),{parent2ChildMap:o,filteredRecordIdSet:i}=Mg(),l=(F=o==null?void 0:o.get(e.recordId))!=null?F:[],c=Il(s),d=vN(n,s,e.recordId)||!!ot.print,u=IN(n,s,e.recordId),f=Mi({ignoreSorters:!0}),h=aE(n),p=c==="Nested",g=vs(s),_=(g==null?void 0:g.type)===m.CollectionViewType.TIMELINE;if(t&&t>10)return null;const x=t!==void 0&&p;return r.jsxs(r.Fragment,{children:[r.jsx(dbe,{...e,alpha:i==null?void 0:i.has(e.recordId),expandNode:x&&(a&&l.length===0?r.jsx("div",{className:"w-6",style:{marginLeft:t*20}}):r.jsx(v$,{childrenLen:l.length,expand:d,onExpand:b=>{u(b),_&&xn.emit("timelineExpand",{collectionId:n,recordId:e.recordId,expand:b})},level:t}))}),d&&x&&p&&r.jsxs(r.Fragment,{children:[l.map((b,w)=>r.jsx(S1,{...e,recordId:b,level:t+1,"data-relation-parent-id":e.recordId,idnumberIndex:w},b)),!ot.print&&r.jsxs("div",{onClick:()=>{h&&(h!=null&&h.parentPropertyId)&&f({viewId:s,propertyValues:{[h.parentPropertyId]:[{type:m.TextType.LINK_PAGE,uuid:e.recordId,text:"",enhancer:{code:!1}}]}})},className:R("flex items-center w-full animate-hover h-8 text-grey border-b",{hidden:a}),style:{paddingLeft:40+t*30},children:[r.jsx(V,{name:"IcAdd",size:"small"}),r.jsx("div",{className:"text-t2 ml-1 flex items-center text-ellipsis",children:"创建子记录"})]})]})]})},yn),dbe=y.memo(e=>{const{recordId:t,groupProperty:n,groupValue:s,tableCellWrap:a=!1,properties:o,onClick:i,settingIcon:l,index:c,level:d,expandNode:u,alpha:f,idnumberIndex:h,...p}=e,{viewId:g,viewType:_,relationEditor:x=!1,embed:F,collectionId:b}=Ne(),w=d8(),E=y.useRef(null),C=_===m.CollectionViewType.TIMELINE,{illegal:k}=mt(t),T=We(t,!!F),v=We(b,!1),I=lt(),j=pE(g,o),S=y.useMemo(()=>o.slice(0,j+1),[j,o]),D=y.useMemo(()=>o.slice(j+1),[j,o]),A=y.useMemo(()=>r.jsx(r.Fragment,{children:!C&&!l&&!v&&r.jsx(cbe,{uuid:t,viewId:g,groupValue:s})}),[v,s,C,t,l,g]),P=y.useMemo(()=>({illegal:k,pageId:I,readonly:T||x,index:c}),[k,c,I,T,x]);return r.jsx(wn,{id:t,blockRef:E,groupValue:s,viewId:g,className:R("relative group flex w-full min-w-max print:w-fit border-b",x&&"hover:bg-black_006 cursor-pointer pl-2",f&&"opacity-50"),style:{minHeight:Si,height:a?void 0:Si},onClick:L=>{i==null||i(t,L)},...p,children:r.jsxs(LV.Provider,{value:P,children:[l,S.length===0&&A,a?r.jsxs(r.Fragment,{children:[S.length>0&&r.jsx(r.Fragment,{children:r.jsx(b3.Provider,{value:!0,children:r.jsxs("div",{className:"sticky-column flex sticky left-0 bg-white1 z-[10]",children:[A,S.map((L,O)=>{const $=oo(L);return r.jsx($C,{style:{width:$},site:Ye.CELL,recordId:t,propertyId:L.property,groupProperty:n,groupValue:s,level:d,expandNode:u,propertyIndex:O,idnumberIndex:h},L.property)})]})})}),D.map((L,O)=>{const $=oo(L);return r.jsx($C,{style:{width:$},site:Ye.CELL,recordId:t,propertyId:L.property,groupProperty:n,groupValue:s,level:d,expandNode:u,propertyIndex:S.length+O,idnumberIndex:h},L.property)})]}):r.jsx(Mk,{beforeAppendChild:j===-1?null:A,stickyIndex:j,virtualized:j===-1,direction:"horizontal",bufferSize:1,scrollRef:w,count:o.length,getItemSize:L=>{const O=o[L];return oo(O)},getItemKey:L=>{var O,$;return($=(O=o[L])==null?void 0:O.property)!=null?$:""},renderItem:L=>{const O=o[L];if(!O)return;const $=oo(O);return r.jsx($C,{style:{width:$},site:Ye.CELL,recordId:t,propertyId:O.property,groupProperty:n,groupValue:s,isLastCell:L===o.length-1,level:d,expandNode:u,propertyIndex:L,idnumberIndex:h},O.property)}}),!C&&r.jsx("div",{className:"flex-1 flex-shrink-0 print:hidden",children:r.jsx("div",{className:"w-12"})})]})})},yn),ube=({groupName:e})=>{const{readonly:t,managerReadonly:n,collectionId:s,viewId:a,relationEditor:o,isLocked:i}=Ne(),l=cf(),c=()=>{if(t||n||i)return;me.event("bitable_property_create",{from_scene:"view"});const d=l({collectionId:s,viewId:a});d&&st({$newTableProperty:{propertyId:d,from:zn.TABLE_HEADER,groupInfo:bE(a,e)}})};return r.jsx("div",{className:"flex-1 print:hidden",children:r.jsx("button",{disabled:t,onClick:c,style:{height:Si},className:R("flex flex-1 flex-shrink-0 items-center duration-150 select-none w-12 min-w-full",{"animate-hover rounded-none":!t}),children:t||n||o||i?null:r.jsx(V,{size:"middle",name:"IcAddBoard",className:"text-grey4 w-12"})})})},u4=(e,t)=>{const n=y.useCallback((a,o)=>{var _,x;const i=pe(),{collectionViews:l}=i,c=l[e];if(!c)return;const d=c.type===m.CollectionViewType.TIMELINE,u=d?(_=c.format.timelineTableProperties)!=null?_:[]:(x=c.format.tableProperties)!=null?x:[],f=u.findIndex(F=>F.property===t),h=u[f],p=[...u];p[f]={...h,width:a};const g={};d?g.timelineTableProperties=p:g.tableProperties=p,o?Rs(e,{format:g},!0):Rt(e,g)},[t,e]),s=y.useMemo(()=>qn(a=>{n(a,!1)},500),[n]);return y.useCallback(a=>{n(a,!0),s(a)},[s,n])};function Dl({className:e,dropdownClassName:t,value:n,placeholder:s,options:a,onChange:o,readonly:i,enableSearch:l,SelectView:c=Tg}){var u;const d=a.find(f=>f.value===n);return r.jsx(c,{className:e,value:n,icon:d==null?void 0:d.icon,title:(u=d==null?void 0:d.shortTitle)!=null?u:d==null?void 0:d.title,placeholder:s,onChange:o,readonly:i,Dropdown:fbe,dropdownProps:{className:t,defaultValue:n,options:a,enableSearch:l}})}function fbe({className:e,defaultValue:t,options:n,enableSearch:s,onChange:a,onCloseModal:o}){const[i,l]=y.useState(""),c=i.trim().toLowerCase(),d=n.filter(u=>c?u.title.toLowerCase().includes(c):!0).map(u=>({type:H.OPERATION,data:u}));return r.jsxs("div",{className:R("next-modal py-2",e),children:[s&&r.jsx(Ct,{delayFocus:50,autoFocus:!0,className:"mx-2.5 mt-[2px] mb-[6px] h-8",value:c,onChange:u=>{l(u)}}),r.jsx(ze,{className:"max-h-[50vh] overflow-y-auto",items:d,defaultActiveIndex:d.findIndex(u=>u.data.value===t),onItemClick:u=>{a==null||a(u.data.value),o()}})]})}const c_=(e,t)=>e.concat(" ",t),mbe=({onPreviousClick:e,onNextClick:t})=>r.jsxs("div",{className:"absolute right-4 flex justify-between top-5",children:[r.jsx(Fe,{className:"mr-2 rounded-sm animate-hover",children:r.jsx(V,{name:"IcArrowDateBack",size:"middle",onClick:()=>e()})}),r.jsx(Fe,{className:"rounded-sm animate-hover",children:r.jsx(V,{name:"IcArrowDateNext",size:"middle",onClick:()=>t()})})]}),hbe=({date:e})=>r.jsx("div",{className:"table-caption mt-2.5 h-10",children:r.jsx("span",{className:"flex items-center h-full text-black text-t2-bold",children:ue(e).format("YYYY年MM月")})}),I$=({closeDatePicker:e,selectRangeDate:t=!1,includeTime:n=!0,showTimeSwitch:s=!0,...a})=>{const o=X3(),i=y.useRef(),l=y.useRef(),c=y.useRef(),d=y.useRef(),u=y.useRef(),f=y.useRef(),h=y.useRef(),p=y.useRef(),[g,_]=y.useState(!1),[x,F]=y.useState(!1),[b,w]=y.useState(a.date),[E,C]=y.useState({startDate:ue(b.from).format(Et),startTime:ue(b.from).format(co),validStartDate:!0,validStartTime:!0}),[k,T]=y.useState({startDate:b.to?ue(b.to).format(Et):"",startTime:b.to?ue(b.to).format(co):"",validStartDate:!0,validStartTime:!0}),[v,I]=y.useState(n),j=y.useCallback(U=>{C(z=>({...z,...U}))},[]),S=y.useCallback(U=>T(z=>({...z,...U})),[]);tc(()=>{var U;b.to&&((U=a.onChange)==null||U.call(a,b,v))},[b],{wait:300}),y.useEffect(()=>{const U=setTimeout(()=>{clearTimeout(U),h.current.focus()})},[]),y.useEffect(()=>{const U=z=>{if(Ie("enter")(z)){const K=KT(E.startDate),W=qA(E.startTime);K&&W&&(e==null||e())}};return document.addEventListener("keydown",U,!0),()=>{document.removeEventListener("keydown",U,!0)}},[E.startDate,E.startTime,e]);const D=U=>{var K;const z={from:ue(c_(ue(b.from).format(Et),"12:00"),On).toDate(),to:(K=b.to)!=null?K:ue(c_(ue(b.to).format(Et),"12:00"),On).toDate()};w(z),j({startTime:"12:00",validStartTime:!0}),S({startTime:"12:00",validStartTime:!0}),I(U)},A=y.useCallback((U,z,K)=>{K.stopPropagation(),U=new Date(U);const W=P(b.from,b.to,U);U.setHours(v?12:0,0,0,0);const Y=ue(U).format(Et);W?(w({from:U}),j({startDate:Y,startTime:v?"12:00":"00:00",validStartDate:!0,validStartTime:!0})):(U.setHours(23,59,0,0),w(G=>({...G,to:U})),S({startDate:Y,startTime:v?"12:00":"00:00",validStartDate:!0,validStartTime:!0}))},[b.from,b.to,v,j,S]);y.useEffect(()=>{const U=[];return E.validStartDate||U.push(tu(i.current,c.current,{placement:"left",modifiers:[{name:"offset",options:{offset:[0,6]}}]})),k.validStartDate||U.push(tu(l.current,d.current,{placement:"left",modifiers:[{name:"offset",options:{offset:[0,6]}}]})),E.validStartTime||U.push(tu(i.current,u.current,{placement:"right",modifiers:[{name:"offset",options:{offset:[0,6]}}]})),k.validStartTime||U.push(tu(l.current,f.current,{placement:"right",modifiers:[{name:"offset",options:{offset:[0,6]}}]})),()=>{U.forEach(z=>z.destroy())}},[E.validStartDate,E.validStartTime,k.validStartDate,k.validStartTime]);const P=(U,z,K)=>{const W=U&&XK.DateUtils.isDayBefore(K,U);return!U||W||U&&z},L=(U,z)=>{const K=KT(U?E.startDate:k.startDate);if(z&&(U?j({validStartDate:!!K}):S({validStartDate:!!K})),K){U?j({startDate:K}):S({startDate:K});const W=new Date(c_(K,U?E.startTime:k.startTime));w(Y=>U?{...Y,from:W}:{...Y,to:W})}},O=(U,z)=>{const K=qA(U?E.startTime:k.startTime);z||(U?j({validStartTime:K}):S({validStartTime:K})),K&&w(U?W=>({...W,from:ue(c_(E.startDate,E.startTime),On).toDate()}):W=>({...W,to:ue(c_(k.startDate,k.startTime),On).toDate()}))},$=!E.validStartDate||!E.validStartTime,M=!k.validStartDate||!k.validStartTime;return r.jsxs("div",{className:R("w-[282px] bg-white2 pt-[10px] pb-[5px]",{"next-modal":!a.noShadow}),children:[r.jsxs("div",{className:"flex flex-col px-2.5",children:[r.jsxs("div",{ref:i,className:R("flex bg-grey9 rounded-sm py-1.5 h-8 border border-transparent",{"input-error":$,"input-focus":g&&!$}),children:[r.jsx(Ct,{inputRef:h,showBorder:!1,className:"border-none ".concat(t?"w-1/2":"w-full"),style:{backgroundColor:"transparent"},onChange:U=>j({startDate:U}),value:E.startDate,onFocus:()=>_(!0),onEnter:()=>{L(!0,!0)},onBlur:()=>{_(!1),L(!0,!1)}}),v&&r.jsx(Ct,{showBorder:!1,className:"w-1/2 px-3 rounded-none",style:{borderLeft:"1px solid var(--grey6)",backgroundColor:"transparent"},onChange:U=>j({startTime:U}),onFocus:()=>_(!0),onEnter:()=>{O(!0,!0)},onBlur:()=>{_(!1),O(!0,!1)},value:E.startTime})]}),!E.validStartDate&&r.jsx("div",{ref:c,className:"px-2 py-1 text-white1 bg-black/70 rounded-sm text-t4",children:r.jsx("span",{children:"无效日期"})}),!E.validStartTime&&r.jsx("div",{ref:u,className:"px-2 py-1 text-white1 bg-black/70 rounded-sm text-t4",children:r.jsx("span",{children:"无效时间"})}),r.jsxs("div",{ref:l,className:R("mt-1 flex bg-grey9 rounded-sm py-1.5 h-8 border border-transparent",{"input-error":M,"input-focus":x&&!M}),children:[r.jsx(Ct,{inputRef:p,showBorder:!1,className:"border-none ".concat(t?"w-1/2":"w-full"),style:{backgroundColor:"transparent"},onChange:U=>S({startDate:U}),value:k.startDate,onFocus:()=>F(!0),onEnter:()=>{L(!1,!0)},onBlur:()=>{F(!1),L(!1,!1)}}),v&&r.jsx(Ct,{showBorder:!1,className:"w-1/2 px-3 border-none rounded-none border-grey6",style:{borderLeft:"1px solid var(--grey6)",backgroundColor:"transparent"},onChange:U=>S({startTime:U}),onFocus:()=>F(!0),onEnter:()=>{O(!1,!0)},onBlur:()=>{F(!1),O(!1,!1)},value:k.startTime})]}),!k.validStartDate&&r.jsx("div",{ref:d,className:"px-2 py-1 text-white1 bg-black/70 rounded-sm text-t4",children:r.jsx("span",{children:"无效日期"})}),!k.validStartTime&&r.jsx("div",{ref:f,className:"px-2 py-1 text-white1 bg-black/70 rounded-sm text-t4",children:r.jsx("span",{children:"无效时间"})})]}),r.jsx(gL,{className:"time-picker flex justify-center w-full",fixedWeeks:!0,selectedDays:[b.from,{from:b.from,to:b.to}],firstDayOfWeek:o===m.DaySetting.MON?1:0,navbarElement:mbe,captionElement:hbe,locale:"zh-cn",month:b.from,months:C3,onDayClick:A,weekdaysShort:Cu,weekdaysLong:e9}),s&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-[252px] h-px bg-grey6 my-1 mx-[15px] mt-3"}),r.jsx("div",{children:r.jsxs("div",{className:"flex items-center justify-between h-10 px-4",children:[r.jsx("span",{className:"text-t2",children:"时间点"}),r.jsx(en,{open:v,onSwitch:D})]})})]})]})},pbe=({onChange:e,propertyId:t,path:n})=>{var D,A,P;const{collectionId:s,viewId:a}=Ne(),o=y.useRef(null),[i,l]=y.useState(""),{propertySchema:c,targetPropertySchema:d}=eo(s,t),u=lt(),f=vs(a),h=(c==null?void 0:c.type)===m.CollectionSchemaType.RELATION?(D=c.collectionId)!=null?D:"":(A=d==null?void 0:d.collectionId)!=null?A:"",p=ye(h,["templatePages"]),{resultList:g,onInputChange:_,firstTime:x,loadMore:F,hasMore:b,loading:w}=oE({type:"collection",fileType:void 0,source:"relationMenu",parentId:h,canSearchWithEmpty:!0,getPerPage:()=>20}),E=g.filter(L=>{var O;return!((O=p==null?void 0:p.templatePages)!=null&&O.includes(L.uuid))});(P=p==null?void 0:p.templatePages)==null||P.forEach(L=>{var O;if(L===u){const $=J.blocks[L];$&&E.unshift({type:$.type,parentId:p.uuid,uuid:L,data:$.data,title:fe((O=J.blocks[L])==null?void 0:O.data.segments)})}}),y.useEffect(()=>_(""),[_]);const C=Ce(({blocks:L,collectionViews:O})=>{var ee;const $=O[a],M=bu($==null?void 0:$.format.filter,n);if(!((ee=L[s])==null?void 0:ee.data.schema)||!M)return[];const z=M==null?void 0:M.value,K=L[h],W=new Set(K==null?void 0:K.subNodes),Y=new Set(K==null?void 0:K.templatePages),G=z==null?void 0:z.split(",").filter(te=>L[te]?Y.has(te)||W.has(te):!1).map(te=>Y.has(te)?u:te);return CL(G)},[a,s,u,f==null?void 0:f.format.filter]),k=y.useMemo(()=>E.map(L=>({type:H.SEARCH,data:{uuid:L.uuid,title:L.title||qt(L.type),icon:L.data.icon,type:L.type,renderRight:()=>C.includes(L.uuid)?r.jsx(V,{name:"IcCheck02",size:"middle"}):null}})),[C,E]);y.useEffect(()=>{const L=setTimeout(()=>{var O;clearTimeout(L),(O=o.current)==null||O.focus()},0);return()=>{clearTimeout(L)}},[C]);const T=L=>{const O=C.indexOf(L.data.uuid);O!==-1?C.splice(O,1):C.push(L.data.uuid),e==null||e(C.join(","))},v=L=>{const O=C.indexOf(L);O!==-1&&C.splice(O,1),e==null||e(C.join(","))},I=()=>{C.pop(),e==null||e(C.join(","))},j=L=>{Ie("Esc")(L)||!i&&Ie("Backspace")(L)&&I()},S=()=>{e==null||e(""),_(""),l("")};return h?r.jsxs("div",{className:"relative overflow-hidden next-modal w-60",children:[r.jsxs("div",{className:"relative m-2 border-2 border-black rounded p-[5px] flex justify-between items-start min-h-[32px]",children:[r.jsxs("div",{className:"flex flex-wrap w-[190px] overflow-hidden",children:[C.map(L=>r.jsxs("div",{className:"inline-flex items-center text-t4 ",children:[r.jsx(Ir,{uuid:L,className:"p-0 leading-[22px] my-px"}),r.jsx("button",{className:"opacity-80 flex-shrink-0 w-5 h-5 inline-block",onClick:()=>v(L),children:r.jsx(V,{name:"IcToastClose",className:"w-full h-full",size:"auto"})})]},L)),r.jsx(oi,{ref:o,autoFocus:!0,singleLine:!0,placeholder:"搜索记录",fontClassName:"leading-5 text-[14px] whitespace-nowrap",className:"w-full placeholder:text-grey4",boxClassName:"flex-1 flex-shrink-0 min-w-[120px]",value:i,onKeyDown:j,onChange:L=>{const{value:O}=L.target;_(O),l(O)}})]}),r.jsx(V,{size:"middle",name:"IcUploadCancel",onClick:S,className:"text-grey4 cursor-pointer animate-hover"})]}),r.jsx(ze,{items:k,className:"relative h-60",hasMore:b,loadMore:F,scrollContainerStyle:{top:"0px"},onItemClick:T,loadingView:w&&r.jsx(NN,{}),customFooter:r.jsxs(r.Fragment,{children:[w&&b&&r.jsxs("div",{className:"relative flex flex-row items-center justify-center h-10",children:[r.jsx($s,{size:"middle"}),r.jsx("div",{className:"flex items-center ml-2 text-center text-t2 text-grey4",children:"正在加载..."})]}),!x&&!w&&k.length===0&&r.jsx("div",{className:"relative flex justify-center items-center h-10 text-t2 text-grey4",children:"没有找到相关结果"})]})})]}):null},N$=()=>y.useCallback((e,t,n,s)=>{var p,g,_,x,F;const{viewId:a,collectionId:o}=e,i=(p=pe().collectionViews)==null?void 0:p[a],l=(g=pe().blocks)==null?void 0:g[o];if(!i)return;const c=l==null?void 0:l.data.schema;if(!c)return;let d;if(i.format.filter?d=Br(i.format.filter):d={type:"group",filters:[],operator:"and"},!d)return;d.filters.length===0&&(d.disable=!1);const u=vg(o,t),f={type:"filter",property:t,propertyType:(_=c[t])==null?void 0:_.type,operator:(F=(x=u[0])==null?void 0:x.value)!=null?F:"isNotEmpty",value:""},h=s?{type:"group",operator:"and",filters:[f]}:f;d.filters.push(h),d=CE(d,c),Rt(a,{filter:d},n)},[]),gbe=()=>y.useCallback((e,t,n,s,a)=>{var F,b,w,E,C;const{viewId:o,collectionId:i}=e,l=(F=pe().collectionViews)==null?void 0:F[o],c=(b=pe().blocks)==null?void 0:b[i];if(!l)return;const d=c==null?void 0:c.data.schema;if(!d||!l.format.filter)return;let u=t;const f=B$(l.format.filter.filters,d);if(f.length>0){const k=f[f.length-1];(k==null?void 0:k.type)==="filter"&&gl(k,d)&&(u=k.property)}const h=vg(i,u),p={type:"filter",property:u,propertyType:(w=d[u])==null?void 0:w.type,operator:(C=(E=h[0])==null?void 0:E.value)!=null?C:"isNotEmpty",value:""},g=a?{type:"group",operator:"and",filters:[p]}:p,_=Br(l.format.filter),x=sF(_,s);x==null||x.filters.push(g),_&&Rt(o,{filter:CE(_,d)},n)},[]),Ug=({isFromViewSetting:e})=>{const{viewId:t,collectionId:n,isLocked:s,managerReadonly:a}=Ne(),o=vs(t),i=N$(),{role:l}=mt(n),c=l===m.PermissionRole.READER||l===m.PermissionRole.NONE,d=ft(n,k=>{var T;return(T=k==null?void 0:k.data.schema)!=null?T:{}}),u=Ce(({collectionViews:k})=>{const T=k[t];let v=c?DN(t):T==null?void 0:T.format.filter;return c&&(!v||v.filters.length===0)&&(v=T==null?void 0:T.format.filter),v},[t,c]),f=ie(),h=Object.keys(d)[0];if(!o)return null;const p=k=>{s||h&&(me.event("bitable_view_filter_manage",{manage_type:"create"}),i({collectionId:n,viewId:t},h,a,k==null?void 0:k.group))},g=()=>{p()},_=()=>{p({group:!0})},x=k=>{var v;const T=(v=Br(o.format.filter))!=null?v:{type:"group",filters:[],operator:"and"};T.operator=k,Rt(t,{filter:T},a)},F=k=>{o.format.filter&&Rt(t,{filter:{...o.format.filter,disable:k}},a)},b=()=>{F(!0)},w=()=>{F(!1)},E=z0(u,d),C=u&&u.filters.filter(k=>gl(k,d)).length>0;return r.jsxs("div",{className:R("min-w-[480px]",!e&&"next-modal-scroll"),children:[C&&r.jsxs("div",{className:"flex justify-between px-4 my-2",children:[r.jsxs("div",{className:"flex items-center text-t2",children:[r.jsx(V,{className:"mr-1",name:Ga[o.type],size:"middle"}),r.jsxs("span",{className:"mr-2 font-medium text-t2",children:["筛选符合下方",r.jsx(D$,{className:"inline-flex font-medium !border-0",value:u.operator,onChange:k=>{x(k)}}),"条件的数据"]})]}),r.jsxs("div",{className:"flex items-center text-t2",children:[r.jsx("span",{className:"mr-1",children:E?r.jsx("span",{className:"mr-1 text-active_color",children:"已生效"}):r.jsx("span",{className:"mr-1",children:"未生效"})}),r.jsx(en,{open:E,disabled:s,onSwitch:()=>{s||(E?(me.event("bitable_view_filter_manage",{manage_type:"off"}),b()):(me.event("bitable_view_filter_manage",{manage_type:"on"}),w()))}})]})]}),u&&r.jsx(S$,{path:[],...u}),r.jsxs("button",{className:R("flex items-center w-full h-10 px-4 py-2 animate-hover !rounded-t-none text-grey3",C&&"border-t border-grey6",s&&"cursor-not-allowed"),disabled:!h,onClick:g,children:[r.jsx(V,{className:"mr-1",name:"IcAdd",size:"middle"}),r.jsx("span",{className:"text-t2",children:"创建筛选条件"}),!s&&r.jsx("span",{className:"inline-flex p-1 animate-hover",onClick:k=>{k.stopPropagation(),f.dropdown({popcorn:k.currentTarget.parentElement,content:j$,contentProps:{onCreateFilter:g,onCreateFilterGroup:_},placement:"bottom-start",offset:[-1,0]})},children:r.jsx(V,{name:"IcArrowDown01",className:"text-grey3",size:"tiny"})})]})]})},j$=({onCreateFilter:e,onCreateFilterGroup:t,onCloseModal:n})=>r.jsxs("div",{className:"next-modal p-2",children:[r.jsxs("div",{className:"h-9 px-2 flex items-center animate-hover",onClick:()=>{e==null||e(),n()},children:[r.jsx(V,{name:"IcAdd",className:"mr-2",size:"middle"}),r.jsx("span",{className:"text-t2",children:"创建筛选条件"})]}),r.jsxs("div",{className:"h-9 px-2 flex items-center animate-hover",onClick:()=>{t==null||t(),n()},children:[r.jsx(V,{name:"IcAddGroup",className:"mr-2",size:"middle"}),r.jsx("span",{className:"text-t2",children:"创建筛选条件组"})]})]}),S$=({path:e,operator:t,filters:n})=>{const{viewId:s,collectionId:a,isLocked:o,managerReadonly:i}=Ne(),l=ft(a,w=>{var E;return(E=w==null?void 0:w.data.schema)!=null?E:{}}),c=ie(),d=gbe(),u=B$(n,l),f=Object.keys(l)[0],h=w=>{o||f&&(me.event("bitable_view_filter_manage",{manage_type:"create"}),d({collectionId:a,viewId:s},f,i,e,w==null?void 0:w.group))},p=()=>{h()},g=()=>{h({group:!0})},_=w=>{var T;const E=(T=pe().collectionViews)==null?void 0:T[s];if(!E)return;const C=Br(E.format.filter),k=sF(C,e);k&&k.filters.splice(w,1),C&&Rt(s,{filter:CE(C,l)},i)},x=w=>{var T;const E=(T=pe().collectionViews)==null?void 0:T[s];if(!E)return;const C=Br(E.format.filter),k=sF(C,e);k.operator=w,Rt(s,{filter:C},i)},F=r.jsx(br,{className:"flex-1 min-w-0",items:u,onlyHandleDraggable:!0,renderItemContent:({item:w})=>{const E=e.slice(0);if(E.push("filters",w.id),w.type==="group")return r.jsxs("div",{className:"flex items-start my-2",children:[r.jsx(S$,{...w,path:E}),r.jsx("div",{className:"w-9",children:!o&&r.jsx(V,{size:"large",className:"ml-3 mt-1 cursor-pointer text-grey3 hover:text-grey1",name:"IcToastClose",onClick:()=>{const D=Number(w.id);_(D),me.event("bitable_view_filter_manage",{manage_type:"delete"})}})})]});const C=l[w.property],{type:k,aggregation:T}=C!=null?C:{},v=vg(a,w.property),I=w.operator==="isEmpty"||w.operator==="isNotEmpty",j=v.map(D=>D.value).includes(w.operator)&&!I,S=k===m.CollectionSchemaType.ROLLUP&&ni(T);return r.jsxs("div",{className:"flex items-center my-2 text-t2",children:[r.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[r.jsx(_be,{className:"w-[120px]",value:w.property,onChange:D=>{const A=Number(w.id);Jx({viewId:s,collectionId:a,path:e,managerReadonly:i},A,"property",D)}}),S&&r.jsx(xbe,{className:"ml-2 w-[72px]",property:w.property,value:w.mode,isShowUniqueValue:T===m.AggregationAction.SHOW_UNIQUE,onChange:D=>{const A=Number(w.id);Jx({viewId:s,collectionId:a,path:e,managerReadonly:i},A,"mode",D)}}),r.jsx(A$,{className:R("w-[76px]",j?"mx-2":"ml-2"),property:w.property,value:w.operator,onChange:D=>{const A=Number(w.id);Jx({viewId:s,collectionId:a,path:e,managerReadonly:i},A,"operator",D)}}),j&&r.jsx(R$,{className:"w-[160px]",property:w.property,operator:w.operator,value:w.value,path:E,onChange:D=>{const A=Number(w.id);Jx({viewId:s,collectionId:a,path:e,managerReadonly:i},A,"value",D)},onEffectiveChange:D=>{Number(w.id)}})]}),!o&&r.jsx(V,{size:"large",className:"ml-3 cursor-pointer text-grey3 hover:text-grey1",name:"IcToastClose",onClick:()=>{const D=Number(w.id);_(D),me.event("bitable_view_filter_manage",{manage_type:"delete"})}})]})}}),b=Math.ceil(e.length/2);return b===0?u.length===0?null:r.jsx("div",{className:"px-4 mb-3.5",children:F}):r.jsxs("div",{className:R("flex-1 px-3.5 pt-1.5 rounded-md border border-grey5",Mn({backgroundColor:"rgba(0, 0, 0, 0.02)"})),children:[r.jsx("div",{children:r.jsxs("span",{className:"mr-2 font-medium text-t2",children:["筛选符合下方",r.jsx(D$,{className:"inline-flex font-medium !border-0",value:t,onChange:w=>{x(w)}}),"条件的数据"]})}),F,r.jsxs("div",{className:R("mt-1 mx-[-14px] h-9 px-3 flex items-center animate-hover text-grey3",o&&"cursor-not-allowed"),onClick:p,children:[r.jsx(V,{className:"mr-1",name:"IcAdd",size:"middle"}),r.jsx("span",{className:"text-t2",children:"创建筛选条件"}),b<2&&!o&&r.jsx("span",{className:"inline-flex p-1 animate-hover",onClick:w=>{w.stopPropagation(),c.dropdown({popcorn:w.currentTarget.parentElement,content:j$,contentProps:{onCreateFilter:p,onCreateFilterGroup:g},placement:"bottom-start",offset:[-1,0]})},children:r.jsx(V,{name:"IcArrowDown01",className:"text-grey3",size:"tiny"})})]})]})},_be=({className:e,value:t,onChange:n})=>{const{collectionId:s,isLocked:a}=Ne(),o=ft(s,i=>{var l;return(l=i==null?void 0:i.data.schema)!=null?l:{}});return r.jsx(Dl,{readonly:a,className:e,dropdownClassName:"max-w-[260px]",value:t,onChange:n,options:Object.keys(o).filter(i=>{var l;return((l=o[i])==null?void 0:l.type)!==m.CollectionSchemaType.ID_NUMBER}).map(i=>{var c,d,u;const l=(c=o[i])==null?void 0:c.type;return{value:i,title:(u=(d=o[i])==null?void 0:d.name)!=null?u:"",icon:l&&un[l]}})})},D$=({className:e,value:t,onChange:n})=>{const{isLocked:s}=Ne();return r.jsx(Dl,{readonly:s,className:e,value:t,onChange:n,options:[{value:"and",title:"全部"},{value:"or",title:"任意"}]})},xbe=({isShowUniqueValue:e,className:t,value:n,onChange:s})=>{const{isLocked:a}=Ne(),o=e?[{value:"any",title:"任意"}]:[{value:"any",title:"任意"},{value:"every",title:"全部"},{value:"none",title:"无"}];return r.jsx(Dl,{readonly:a,className:t,value:e?"any":n,onChange:s,options:o})},A$=({className:e,property:t,value:n,onChange:s})=>{const{collectionId:a,isLocked:o}=Ne(),i=vg(a,t);return r.jsx(Dl,{readonly:o,className:e,value:n,onChange:s,options:i})},R$=({className:e,property:t,operator:n,value:s,path:a,onChange:o,onEffectiveChange:i})=>{var S;const{collectionId:l,isLocked:c}=Ne(),{propertySchema:d,relationPropertySchema:u,targetPropertySchema:f}=eo(l,t),{type:h,aggregation:p,targetProperty:g=""}=d!=null?d:{},_=(S=u==null?void 0:u.collectionId)!=null?S:"",x=$n(l),F=$n(_),b=vg(l,t),w=n==="isEmpty"||n==="isNotEmpty",E=b.map(D=>D.value).includes(n)&&!w,C=y.useRef();y.useEffect(()=>()=>{clearTimeout(C.current)},[]);const k=D=>{o(D),clearTimeout(C.current),C.current=window.setTimeout(()=>{i==null||i(D)},500)};let T=h;const v=T===m.CollectionSchemaType.ROLLUP,I=T===m.CollectionSchemaType.FORMULA;if(v){const D=f==null?void 0:f.type;ni(p)?D===m.CollectionSchemaType.FORMULA?T=F.getTypeAsCollectionSchemaType(g):T=D:fl(p)?T=m.CollectionSchemaType.DATE:T=m.CollectionSchemaType.NUMBER}else I&&(T=x.getTypeAsCollectionSchemaType(t));const j=R(e,"h-8");if(!E)return null;switch(T!=null?T:m.CollectionSchemaType.TEXT){case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.NUMBER:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:return r.jsx(Ct,{readonly:c,className:R(j,"border-grey5"),value:s,onChange:k});case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:return n==="in"?r.jsx(Fbe,{className:j,value:s,onChange:k}):r.jsx(wbe,{className:j,value:s,onChange:k});case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:return r.jsx(kbe,{className:j,property:t,value:s,onChange:k});case m.CollectionSchemaType.CHECKBOX:case m.CollectionSchemaType.FILE:return null;case m.CollectionSchemaType.PERSON:case m.CollectionSchemaType.CREATED_BY:case m.CollectionSchemaType.UPDATED_BY:return r.jsx(Cde,{className:j,value:s,onChange:k});case m.CollectionSchemaType.RELATION:return r.jsx(ybe,{propertyId:t,className:j,value:s,path:a,onChange:k})}},ybe=({className:e,value:t,path:n,onChange:s,propertyId:a})=>{var g,_,x;const{isLocked:o,collectionId:i}=Ne(),{propertySchema:l,targetPropertySchema:c}=eo(i,a),d=lt(),u=(l==null?void 0:l.type)===m.CollectionSchemaType.RELATION?(g=l.collectionId)!=null?g:"":(_=c==null?void 0:c.collectionId)!=null?_:"",f=ye(u,["subNodes","templatePages"]),h=(x=f==null?void 0:f.subNodes)!=null?x:[],p=r.jsx("div",{className:"text-t4",children:t==null?void 0:t.split(",").map(F=>{var b;return F&&h.includes(F)?r.jsx(Ir,{uuid:F},F):(b=f==null?void 0:f.templatePages)!=null&&b.includes(F)?r.jsx(Ir,{uuid:d},F):null})});return r.jsx(Tg,{readonly:o,className:e,value:t,content:p,onChange:s,Dropdown:pbe,dropdownProps:{propertyId:a,path:n}})},bbe=e=>{if(!e)return{title:"",shortTitle:void 0};const t=e.split(","),n=ue(t[0],Et),s=ue(t[1],Et);return{title:"".concat(n.format(Et)," → ").concat(s.format(Et)),shortTitle:"".concat(n.format(np)," → ").concat(s.format(np))}},P$=(e,t)=>{if(t==="range"){const s=pl[e];if(s!=null)return!s.day;if(!e)return!1;const a=e.split(",");return ue(a[0],Et).isValid()&&ue(a[1],Et).isValid()}const n=pl[e];return n!=null?n.day:ue(e,Et).isValid()},Fbe=({className:e,value:t,onChange:n})=>{const{isLocked:s}=Ne(),a=P$(t,"range")?t:"",{title:o,shortTitle:i}=bbe(a),l=zf(pl,a)?a:"exact";return r.jsxs(r.Fragment,{children:[r.jsx(Dl,{readonly:s,value:l,className:"mr-2",options:[{title:"具体时间",value:"exact"},...kL(pl).filter(c=>!c[1].day).map(([c,d])=>({title:d.title,value:c}))],onChange:c=>{n(c==="exact"?"":c)}}),l==="exact"&&r.jsx(Tg,{readonly:s,className:e,value:a,title:o,shortTitle:i,onChange:c=>{n(c)},Dropdown:Ebe,dropdownProps:{}})]})},wbe=({className:e,value:t,onChange:n})=>{const{isLocked:s}=Ne(),a=P$(t,"day")?t:"",o=zf(pl,a)?a:"exact";return r.jsxs(r.Fragment,{children:[r.jsx(Dl,{readonly:s,value:o,className:"mr-2",options:[{title:"具体时间",value:"exact"},...kL(pl).filter(i=>i[1].day).map(([i,l])=>({title:l.title,value:i}))],onChange:i=>{n(i==="exact"?"":i)}}),o==="exact"&&r.jsx(Tg,{readonly:s,className:e,value:a,title:a,onChange:n,Dropdown:Cbe,dropdownProps:{}})]})},Ebe=({value:e,onChange:t,onCloseModal:n})=>{const s=e?e.split(","):[],a=ue(s[0],Et),o=ue(s[1],Et);return r.jsx(I$,{includeTime:!1,showTimeSwitch:!1,closeDatePicker:n,date:{from:a.isValid()?a.toDate():new Date,to:o.isValid()?o.toDate():new Date},onChange:({from:i,to:l})=>{t==null||t("".concat(ue(i).format(Et),",").concat(ue(l).format(Et)))},onClear:()=>{t==null||t("")}})},Cbe=({value:e,onChange:t,onCloseModal:n})=>{const s=ue(e,Et);return r.jsx(J0,{uiOption:{hasSwitchTimeOption:!1,hasFormatSetting:!1},closeDatePicker:n,dateInfo:{from:s.isValid()?s.toDate():new Date,includeTime:!1},onChange:({from:a})=>{t==null||t(ue(a).format(Et))},onClear:()=>{t==null||t("")}})},kbe=({className:e,property:t,value:n,onChange:s})=>{const{collectionId:a,isLocked:o}=Ne(),i=Ce(({blocks:c})=>{var f,h,p,g,_,x,F;const d=(f=c[a])==null?void 0:f.data.schema,u=d==null?void 0:d[t];if(!d)return[];if((u==null?void 0:u.type)===m.CollectionSchemaType.ROLLUP){const{targetProperty:b="",relationProperty:w=""}=u,E=(h=d[w])==null?void 0:h.collectionId;return(x=(_=(g=(p=c[E!=null?E:""])==null?void 0:p.data.schema)==null?void 0:g[b])==null?void 0:_.options)!=null?x:[]}return(F=u==null?void 0:u.options)!=null?F:[]},[a]),l=i.find(c=>c.id===n);return r.jsx(Tg,{readonly:o,className:e,value:n,content:l&&r.jsx(md,{color:l.color,value:l.value}),onChange:s,Dropdown:Tbe,dropdownProps:{options:i}})},Tbe=({options:e,onCloseModal:t,onChange:n})=>{const[s,a]=y.useState(""),o=e.filter(i=>i.value.includes(s)).map(i=>({type:H.OPERATION,data:{content:r.jsx(md,{color:i.color,value:i.value}),onClick:()=>{n==null||n(i.id),t()}}}));return r.jsx("div",{className:"max-h-[80vh] w-[190px] overflow-y-auto next-modal py-2",children:r.jsx(ze,{customHeader:r.jsx(Ct,{autoFocus:!0,className:"h-8 mx-2.5 mb-2.5",placeholder:"搜索选项",onChange:i=>a(i)}),items:o})})},L$=(e,t)=>{var n;return t.type!=="filter"||t.propertyType&&((n=e[t.property])==null?void 0:n.type)===t.propertyType||["isEmpty","isNotEmpty"].includes(t.operator)?t:{...t,value:""}},B$=(e,t)=>e.map((n,s)=>({...n,id:"".concat(s)})).filter(n=>!!gl(n,t)).map(n=>L$(t,n)),D1=(e,t,n,s)=>{var d,u,f;const a=pe().collectionViews[t],o=(u=(d=pe().blocks[e])==null?void 0:d.data.schema)!=null?u:{},i=((f=a==null?void 0:a.format.formProperties)!=null?f:[]).map(h=>h.property),l=SF(o,i,s),c=SF(o,n,l);if(c.length<l.length)return c},SF=(e,t,n)=>n.filter(s=>{const a=t.indexOf(s.condition.property),o=t.indexOf(s.gotoProperty);return a===-1||!e[s.condition.property]||s.gotoProperty!==tp&&(o===-1||!e[s.gotoProperty]||o<=a)?!1:gl(s.condition,e)}).map(s=>({condition:L$(e,s.condition),gotoProperty:s.gotoProperty})),O$=(e,t)=>{const n=(s,a)=>{var c;const o=(c=pe().collectionViews)==null?void 0:c[e];if(!o)return;const i=Br(o.format.formProperties),l=i==null?void 0:i.findIndex(d=>d.property===t);if(l!==void 0&&l!==-1&&i){const d=i[l];if(d){const u={...d,[s]:a};i[l]=u}}Rt(e,{formProperties:i})};return y.useCallback(n,[t,e])},vbe=()=>{const e=Oe(),{getState:t}=ss();return y.useCallback((n,s,a,o=!1)=>{var x,F,b,w,E;const{blocks:i,collectionViews:l}=t(),c=i[n];if(!c)return;const d=(x=c.data.schema)==null?void 0:x[a];if(!d)return;const u=qe(),{visibleProperty:f,inVisibleProperty:h}=X0(u);let p={};if(s){const C=l[s];if(!C)return;const k=C.type===m.CollectionViewType.FORM,{properties:T=[],timelineTableProperties:v=[]}=gn(C);let I=T;o&&(I=v),k&&C.format.formProperties&&(I=C.format.formProperties);const j=I.findIndex(P=>P.property===a),S=[...I],D={property:u,visible:(b=(F=I[j])==null?void 0:F.visible)!=null?b:!0};j>-1?S.splice(j+1,0,D):S.push(D);const A=o?"timelineTableProperties":"".concat(n7(C.type),"Properties");p={...C.format},p[A]=S,pd.forEach(P=>{if(P===A)return;const L=p[P];L&&(P==="tableProperties"?p[P]=[...L,f]:p[P]=[...L,h])})}let g=[...(w=c.data.collectionPageProperties)!=null?w:[]];g.length===0&&(g=Object.keys((E=c.data.schema)!=null?E:{}).map(C=>({property:C,visible:!0})));const _=g.findIndex(({property:C})=>C===a);return g.splice(_+1,0,f),e(()=>{_e(c.uuid,{data:{collectionPageProperties:g,schema:{...c.data.schema,[u]:{...d,name:Ci(c.data.schema,"副本 ".concat(d.name))}}}}),s&&Rs(s,{format:p}),Qf(c.uuid,[u],s)}),u},[t,e])},f4=()=>{const{getState:e}=ss(),t=Oe(),n=(s,a)=>{const{blocks:o,collectionViews:i}=e(),l=o[s];l&&t(()=>{var h,p,g,_;const c=(h=l.data.schema)!=null?h:{},d=c[a],u=new Set([a]);(d==null?void 0:d.type)===m.CollectionSchemaType.RELATION&&d.collectionId===s&&d.pairProperty&&((p=c[d.pairProperty])==null?void 0:p.pairProperty)===a&&u.add(d.pairProperty);const f={};Object.entries(c).forEach(([x,F])=>{u.has(x)||(f[x]=F)}),_e(s,{data:{schema:f,collectionPageProperties:(g=l.data.collectionPageProperties)==null?void 0:g.filter(({property:x})=>!u.has(x))}}),(_=l.views)==null||_.forEach(x=>{var E;const F=i[x];if(!F)return;const b=Ni(F.format,pd);b.sorters=(E=F.format.sorters)==null?void 0:E.filter(C=>!u.has(C.property));const w=C=>C&&(C.filters=C.filters.filter(k=>{if(k.type==="filter")return!u.has(k.property);const T=w(k);return!!(T&&T.filters.length>0)}),C);b.filter=w(Br(F.format.filter)),pd.forEach(C=>{const k=b[C];k&&(b[C]=k.filter(T=>!u.has(T.property)))}),Rs(x,{format:b})})})};return y.useCallback(n,[e,t])},M$=()=>{const{getState:e}=ss(),t=Oe(),n=(s,a,o,i,l=!1)=>{var c,d;if(a){const{collectionViews:u}=e(),f=u[a];if(!f)return;const{properties:h=[],timelineTableProperties:p=[],propertiesName:g}=gn(f),_=(l?p:h).map(x=>x.property===o?{...x,visible:i}:x);t(()=>{const x={[l?"timelineTableProperties":g]:_};l&&(x.timelineShowTable=!!_.find(F=>F.visible)),Rs(a,{format:x})})}else{const{blocks:u}=e(),f=u[s];if(!f)return;let h=[...(c=f.data.collectionPageProperties)!=null?c:[]];h.length===0?h=Object.keys((d=f.data.schema)!=null?d:{}).map(p=>({property:p,visible:p===o?i:!0})):h=h.map(p=>p.property===o?{...p,visible:i}:p),t(()=>{_e(s,{data:{collectionPageProperties:h}})})}};return y.useCallback(n,[e,t])},Vg=({isFromViewSetting:e})=>{const{viewId:t,collectionId:n,isLocked:s,managerReadonly:a}=Ne(),o=vs(t),i=ft(n,E=>{var C;return(C=E==null?void 0:E.data.schema)!=null?C:{}}),l=Ce(({collectionViews:E})=>{var k;const C=E[t];return(k=C==null?void 0:C.format.sorters)!=null?k:[]},[t]),c=l.filter(E=>{var C;return((C=i[E.property])==null?void 0:C.type)!==m.CollectionSchemaType.ID_NUMBER}).map(E=>({...E,id:E.property})),d=Object.keys(i).find(E=>l.every(C=>C.property!==E));if(!o)return null;const u=()=>{var C;if(s||!d)return;me.event("bitable_view_sort_manage",{manage_type:"create"});const E=(C=Rr.cloneDeep(o.format.sorters))!=null?C:[];E.push({property:d,direction:"asc",disable:!1}),Rt(t,{sorters:E},a)},f=E=>{Rt(t,{sorters:E.map(C=>({property:C.property,direction:C.direction,disable:C.disable}))},a)},h=(E,C)=>{var v;const k=(v=Rr.cloneDeep(o.format.sorters))!=null?v:[],T=k==null?void 0:k.find(I=>I.property===E);T&&(T.property=C),Rt(t,{sorters:k},a)},p=(E,C)=>{var v;const k=(v=Rr.cloneDeep(o.format.sorters))!=null?v:[],T=k==null?void 0:k.find(I=>I.property===E);T&&(T.direction=C),Rt(t,{sorters:k},a)},g=E=>{var k;const C=(k=Rr.cloneDeep(o.format.sorters))!=null?k:[];Rt(t,{sorters:C.filter(T=>T.property!==E)},a)},_=E=>{var k;const C=(k=Rr.cloneDeep(o.format.sorters))!=null?k:[];if(C)for(const T of C)T.disable=E;Rt(t,{sorters:C},a)},x=()=>{me.event("bitable_view_sort_manage",{manage_type:"on"}),_(!0)},F=()=>{me.event("bitable_view_sort_manage",{manage_type:"off"}),_(!1)},b=l.some(E=>!E.disable),w=l.length>0;return r.jsxs("div",{className:R(e?"w-full":"next-modal-scroll w-[400px]"),children:[w&&r.jsxs("div",{className:"flex justify-between h-8 m-2 mx-4",children:[r.jsxs("div",{className:"flex items-center cursor-default text-t2",children:[r.jsx(V,{className:"mr-1",name:Ga[o.type],size:"middle"}),r.jsx("span",{className:"mr-2 font-medium",children:"排序设置"})]}),r.jsxs("div",{className:"flex items-center text-t2",children:[r.jsx("span",{className:"mr-1",children:b?"已生效":"已停用"}),r.jsx(en,{open:b,disabled:s,onSwitch:()=>{s||(b?x():F())}})]})]}),r.jsx(br,{disabled:s,className:R(c.length>0&&"m-2"),items:c,renderItemContent:({item:E,renderDragHandle:C})=>r.jsxs("div",{className:"flex items-center h-10 px-2 text-t2",children:[C({className:"cursor-pointer flex items-center justify-center w-5 h-5 mr-1 text-grey4"}),r.jsxs("div",{className:"flex items-center flex-1",children:[r.jsx(Ibe,{className:"max-w-[200px]",value:E.property,onChange:k=>{h(E.property,k)}}),r.jsx(Nbe,{className:"ml-2",property:E.property,value:E.direction,onChange:k=>{p(E.property,k)}})]}),!s&&r.jsx(V,{size:"large",className:"cursor-pointer text-grey3 hover:text-grey1",name:"IcToastClose",onClick:()=>{me.event("bitable_view_sort_manage",{manage_type:"delete"}),g(E.property)}})]}),onChange:f}),r.jsxs("button",{className:R("flex items-center w-full h-10 p-2 animate-hover pl-4 text-grey3",w&&"border-t border-grey6",s&&"cursor-not-allowed"),disabled:!d,onClick:u,children:[r.jsx(V,{className:"mr-1",name:"IcAdd",size:"middle"}),r.jsx("span",{className:"text-t2",children:"创建排序条件"})]})]})},Ibe=({className:e,value:t,onChange:n})=>{const{collectionId:s,viewId:a,isLocked:o}=Ne(),i=ft(s,c=>{var d;return(d=c==null?void 0:c.data.schema)!=null?d:{}}),l=Ce(({collectionViews:c})=>{var u;const d=c[a];return(u=d==null?void 0:d.format.sorters)!=null?u:[]},[a]);return r.jsx(Dl,{readonly:o,className:e,dropdownClassName:"max-w-[260px]",value:t,onChange:n,options:Object.keys(i).filter(c=>{var d;return((d=i[c])==null?void 0:d.type)===m.CollectionSchemaType.ID_NUMBER?!1:c===t||l.every(u=>u.property!==c)}).map(c=>{var u,f,h;const d=(u=i[c])==null?void 0:u.type;return{value:c,title:(h=(f=i[c])==null?void 0:f.name)!=null?h:"",icon:d&&un[d]}})})},Nbe=({className:e,value:t,onChange:n,property:s})=>{var c,d;const{isLocked:a,collectionId:o}=Ne(),i=ft(o,u=>{var f;return(f=u==null?void 0:u.data.schema)!=null?f:{}}),l=((c=i[s])==null?void 0:c.type)===m.CollectionSchemaType.SELECT||((d=i[s])==null?void 0:d.type)===m.CollectionSchemaType.MULTI_SELECT;return r.jsx(Dl,{readonly:a,className:e,value:t,onChange:n,options:[{value:"asc",title:l?"选项正序":"升序"},{value:"desc",title:l?"选项倒序":"降序"}]})},jbe=({viewId:e,collectionId:t,propertyId:n,onClose:s})=>{var k,T;const a=We(t),{propertySchema:o}=eo(t,n),i=$o(),l=a4(),c=ie(),d=(k=$0(e))!=null?k:t,u=Tl(d),[f,h]=y.useState(""),p=y.useRef(null),g=y.useMemo(()=>{var I,j,S;const v=vr.map(D=>D.key);return(S=NE(v,(j=(I=o==null?void 0:o.options)==null?void 0:I.map(D=>D.color))!=null?j:[]))!=null?S:vr[0].key},[o==null?void 0:o.options]),_=()=>{var j;const v=qe(),I=f.replace(/,/g,"").trim();if(I){if((j=o==null?void 0:o.options)!=null&&j.find(S=>S.value===I)){c.warning({title:r.jsx(r.Fragment,{children:"此属性已存在同名的选项"}),noCancel:!0,confirm(){var S;(S=p.current)==null||S.focus()}});return}h(""),l(t,n,{id:v,value:I,color:g})}},x=v=>{if(!(u||a)){if(Ie("Esc")(v)){s==null||s();return}Ie("Enter")(v)&&_()}},F=y.useRef(),b=(v,I)=>{c.dropdown({popcorn:I.currentTarget,placement:"right",content({onCloseModal:j}){return r.jsx(y$,{option:v,collectionId:t,propertyId:n,closeModal:j,closeBeforeCallbackRef:F})},closeBeforeCallBack:()=>{var j;return(j=F.current)==null?void 0:j.call(F)},closeAfterCallBack(){var j;(j=p.current)==null||j.focus()}})},w=(v,I)=>{if(!(o!=null&&o.options))return;const j=o.options.findIndex(A=>A.id===v),S=o.options.findIndex(A=>A.id===I),D=Wu(o.options,j,S);i(t,n,{options:D})},E=()=>{},C=a||u;return r.jsxs("div",{className:"next-modal-scroll max-h-80vh w-[240px] pt-1.5",children:[r.jsx(oi,{ref:p,autoFocus:!0,singleLine:!0,placeholder:"创建选项",fontClassName:Mn({lineHeight:"24px",fontSize:14,whiteSpace:"nowrap"}),className:Mn({width:"100%",selectors:{"&::placeholder":{color:"var(--grey4)"}}}),boxClassName:"min-w-[120px] max-w-full flex-grow-1 flex-shrink-0 p-2",value:f,onKeyDown:x,onChange:v=>h(v.target.value)}),r.jsx(Cr,{className:"my-1"}),r.jsx(b$,{options:(T=o==null?void 0:o.options)!=null?T:[],onSelect:()=>{},onMore:b,onSort:w,onFocus:E,readonly:C})]})},Sbe=e=>{var A,P,L,O,$,M,U,z,K,W,Y;const{propertyId:t,onCloseModal:n}=e,{collectionId:s}=Ne(),a=ye(s,["data"],["schema"]),{showAs:o={},numberFormat:i,type:l,aggregation:c}=(P=(A=a==null?void 0:a.data.schema)==null?void 0:A[t])!=null?P:{},[d,u]=y.useState((L=o==null?void 0:o.maxValue)!=null?L:5),[f,h]=y.useState((O=o==null?void 0:o.showNumber)!=null?O:!0),p=vr.map(G=>G.key),[g,_]=y.useState((M=($=o==null?void 0:o.color)!=null?$:nm(p))!=null?M:Ze.grey),[x,F]=y.useState((U=o.levelSymbol)!=null?U:"⭐️"),[b,w]=y.useState(o.type),E=$o(),C=ie(),k=[{title:"默认"},{title:"进度条",type:m.NumberShowType.BAR,example:r.jsx(BT,{width:50,height:3,percent:.25,bgColor:Ph(g),progressColor:Hd(g)})},{title:"环形图",type:m.NumberShowType.RING,example:r.jsx(MT,{bgColor:Ph(g),ringColor:Hd(g),percent:.25,className:"border-grey7",ringColorClassName:"border-active_color"})},{title:"等级评分",type:m.NumberShowType.LEVEL,example:r.jsx(OT,{totalScore:3,score:1.5})}],T=G=>{C.dropdown({className:"w-[240px] next-modal pb-2",popcorn:G.currentTarget,placement:"bottom-end",content:({onCloseModal:ee})=>r.jsx(Vm,{onSelect:te=>{_(te),ee()},hideHeader:!0,value:g,selectedIcon:r.jsx(V,{size:"normal",name:"IcCheck02",className:"text-[18px] text-white"}),bgColorFn:Hd})})},v=G=>{C.dropdown({popcorn:G.currentTarget,placement:"bottom-end",content:({onCloseModal:ee})=>r.jsx(Dbe,{onSelect:te=>{F(te),ee()}})})},I=G=>{w(G),G===m.NumberShowType.BAR||G===m.NumberShowType.RING?S||u(100):u(5)},j=()=>{if(b===m.NumberShowType.LEVEL&&!/^([1-9]|10)$/.test(d.toString())||S&&!/^[1-9][0-9]*$/.test(d.toString()))return;const G=l===m.CollectionSchemaType.FORMULA?"prop_formula_style":l===m.CollectionSchemaType.ROLLUP?"prop_rollup_style":"prop_num_style";me.event(G,{style_type:b===m.NumberShowType.LEVEL?"star":b||"default"}),E(s,t,{showAs:b?{type:b,maxValue:d,color:g,showNumber:f,levelSymbol:x}:void 0}),n==null||n()},S=b===m.NumberShowType.BAR||b===m.NumberShowType.RING;let D=!0;return S&&(i!=null&&i.includes("percent")&&(D=!1),l===m.CollectionSchemaType.ROLLUP&&qm(c)&&(D=!1)),r.jsxs("div",{className:"next-modal py-2.5 px-4 w-[334px]",children:[r.jsx("div",{className:"flex justify-between my-2.5",children:k.map(G=>r.jsxs("div",{onClick:()=>I(G.type),className:R("w-[70px] h-[64px] py-2 flex justify-center items-center flex-col text-grey3 text-t4 rounded border-grey6 border cursor-pointer",b===G.type&&"border border-active_color bg-active_color_10"),children:[G.example&&r.jsx("div",{className:"h-6 flex items-center",children:G.example}),G.title]},G.title))}),b&&r.jsxs(r.Fragment,{children:[b===m.NumberShowType.LEVEL?r.jsxs("div",{className:"flex h-10 items-center justify-between cursor-pointer",onClick:v,children:[r.jsx("span",{className:"text-t2 flex-shrink-0 mr-auto",children:"图标"}),x,r.jsx(V,{size:"normal",name:"IcMenuNext",className:"w-5 h-5 text-grey4"})]}):r.jsxs("div",{className:"flex h-10 items-center justify-between cursor-pointer",onClick:T,children:[r.jsx("span",{className:"text-t2 flex-shrink-0 mr-auto",children:"颜色"}),r.jsx("div",{className:"w-5 h-5 rounded-full border border-black/5",style:{backgroundColor:Hd(g)}}),r.jsx(V,{size:"normal",name:"IcMenuNext",className:"w-5 h-5 text-grey4"})]}),D&&r.jsxs("div",{className:"flex h-10 items-center justify-between cursor-pointer relative",children:[r.jsx("span",{className:"text-t2 flex-shrink-0 mr-auto",children:b===m.NumberShowType.LEVEL?"分级(1-10)":"总值"}),r.jsx(Ct,{className:"h-8 w-[120px]",style:{backgroundColor:"transparent"},onChange:G=>u(G),type:"number",value:String(d),inputType:"number"})]}),b===m.NumberShowType.LEVEL&&!/^([1-9]|10)$/.test(d.toString())&&r.jsx("div",{className:"right-0 text-red text-t4 text-right",children:"仅支持1~10的整数"}),S&&!/^[1-9][0-9]*$/.test(d.toString())&&r.jsx("div",{className:"right-0 text-red text-t4 text-right",children:"仅支持不小于1的整数"}),r.jsxs("div",{className:"flex h-10 items-center justify-between cursor-pointer",children:[r.jsx("span",{className:"text-t2 flex-shrink-0 mr-auto",children:"显示数字"}),r.jsx(en,{open:f,onSwitch:G=>h(G)})]}),b&&r.jsxs("div",{className:"border border-grey6 rounded flex justify-center items-center h-[100px]",children:[f&&r.jsx("span",{className:"mr-1",children:hl(b===m.NumberShowType.LEVEL?Es(d,1,10)*.25:.25,i)}),b===m.NumberShowType.BAR&&r.jsx(BT,{width:100,height:5,percent:.25,bgColor:(z=Ph(g))!=null?z:"",progressColor:(K=Hd(g))!=null?K:""}),b===m.NumberShowType.RING&&r.jsx(MT,{percent:.25,bgColor:(W=Ph(g))!=null?W:"",ringColor:(Y=Hd(g))!=null?Y:""}),b===m.NumberShowType.LEVEL&&r.jsx(OT,{levelSymbol:x,totalScore:Es(d,1,10),score:Es(d,1,10)*.25})]})]}),r.jsx("p",{className:"text-grey3 text-t4 my-3",children:"将在所有视图下生效"}),r.jsx(De,{onClick:j,className:"w-full h-8",colorType:"active",children:"更换"})]})},Dbe=({onSelect:e})=>r.jsx("div",{className:"text-[24px] w-[194px] next-modal py-2 pr-4 pl-2 flex justify-between flex-wrap",children:["⭐️","❤️","💡","🔥","👍","😀","☘️","🟡️","🔷","⬛"].map((t,n)=>r.jsx("img",{src:"".concat(wo,"/score/").concat(n+1,".png"),className:"w-6 h-6 ml-2 mt-2 cursor-pointer",onClick:()=>e(t)}))}),Abe=({propertyId:e,closeSelf:t})=>{const{collectionId:n}=Ne(),[s,a]=y.useState(!1),o=$o();return r.jsxs("div",{className:"next-modal w-[450px] p-2 pb-7",children:[r.jsxs("div",{className:R("flex rounded p-3 cursor-pointer"),style:{background:s?"rgba(0,0,0,0.06)":void 0},onClick:()=>a(!0),children:[r.jsx(V,{size:"normal",name:"MIcRelationSync",className:"!w-[150px] !h-[100px]"}),r.jsxs("div",{className:"ml-4 flex flex-col justify-center",children:[r.jsx("p",{className:R("text-t2",s&&"font-medium"),children:"创建双向同步属性"}),r.jsxs("p",{className:"mt-1 text-t4",children:[r.jsx("span",{className:"font-bold",children:"自动创建一个与当前属性双向同步的关联属性。"}),"需要在一个多维表中建立“父记录”与“子记录”的双向关系时，请选择该选项。"]})]})]}),r.jsxs("div",{className:R("flex mt-1.5 rounded  p-3 cursor-pointer",!s&&"font-medium"),style:{background:s?void 0:"rgba(0,0,0,0.06)"},onClick:()=>a(!1),children:[r.jsx(V,{size:"normal",name:"MIcRelationUnsync",className:"!w-[150px] !h-[100px]"}),r.jsxs("div",{className:"ml-4 flex flex-col justify-center",children:[r.jsx("p",{className:R("text-t2",!s&&"font-medium"),children:"不创建双向同步属性"}),r.jsxs("p",{className:"mt-1 text-t4",children:[r.jsx("span",{className:"font-bold",children:"只使用一个关联属性。"}),"只需要建立当前记录与恰记录的单向关系时，请选择该选项。"]})]})]}),r.jsx(De,{className:"h-8 text-t2-medium mt-5",size:"auto",colorType:"active",onClick:()=>{var c;let i=e;s&&(i=qe());const{blocks:l}=pe();t(),o(n,e,{type:m.CollectionSchemaType.RELATION,collectionId:n,spaceId:(c=l[n])==null?void 0:c.spaceId,pairProperty:i})},children:"创建关联"})]})},Rbe=({collectionId:e,propertyId:t,closeSelf:n,popcorn:s})=>{const a=ie(),o=$o(),i=pe().blocks[e];if(!i)return null;const l=p1({ancestorId:i.spaceId,findTypes:[m.BlockType.COLLECTION_VIEW,m.BlockType.COLLECTION_VIEW_PAGE]}),c=d=>{var u;if(d.uuid===e)a.dropdown({popcorn:s,placement:"bottom",content:({onCloseModal:f})=>r.jsx(Abe,{propertyId:t,closeSelf:f})}),n();else{const f=qe(),{blocks:h}=pe();o(e,t,{type:m.CollectionSchemaType.RELATION,collectionId:d.uuid,spaceId:(u=h[d.uuid])==null?void 0:u.spaceId,pairProperty:f}),n()}};return r.jsx(oc,{defaultValue:l,onSelect:c,placeholder:"搜索多维表",searchType:"collection",source:"collectionSettingsSource",header:r.jsx("p",{className:"text-t2 mb-2 flex items-center pl-4 text-grey3",children:"选择关联的多维表"})})},F6=11,Pbe=({collectionId:e,propertyId:t,propertyType:n,popcorn:s,isFormView:a,viewId:o})=>{const i=ie(),l=ln(),c=$o(),d=u4(o,t),u=p=>{if(!(p===n&&p!==m.CollectionSchemaType.RELATION))if(me.event("bitalble_property_turn_type",{from_type:n,target_type:p}),p===m.CollectionSchemaType.RELATION)l(Ve.BITABLE_PROPERTY_WIDGET),i.dropdown({popcorn:s,placement:"bottom",content:({onCloseModal:g})=>r.jsx(Rbe,{collectionId:e,propertyId:t,closeSelf:g,popcorn:s})});else{const g={};p===m.CollectionSchemaType.ID_NUMBER&&(d($I),os(g,{name:"ID"})),setTimeout(()=>{c(e,t,{type:p,...g})},200),p===m.CollectionSchemaType.ROLLUP&&i.dropdown({popcorn:s,placement:"bottom",content:()=>r.jsx(l4,{collectionId:e,propertyId:t})}),l(Ve.BITABLE_PROPERTY_WIDGET)}},h=(a?lO:zI.filter(p=>p.type!==m.CollectionSchemaType.ID_NUMBER)).map(p=>({type:H.OPERATION,data:{...p,hasArrow:p.type===n,arrow:r.jsx(V,{size:"normal",name:"IcCheck02"})}}));return r.jsxs("div",{className:"flex flex-col w-[200px] py-[6px] next-modal-scroll text-black",children:[r.jsx("div",{className:"text-t2 text-grey3 ml-4 h-9 flex items-center",children:"基础属性"}),r.jsx(ze,{items:a?h:h.slice(0,F6),onItemClick:p=>u(p.data.type)}),!a&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 text-grey3 h-9 ml-4 flex items-center",children:"高级属性"}),r.jsx(ze,{items:h.slice(F6),onItemClick:p=>u(p.data.type)})]})]})},Bs={ASCENDING:"ASCENDING",DESCENDING:"DESCENDING",VISIBLE_STATE:"VISIBLE_STATE",DELETE:"DELETE",COPY:"COPY",INSERT_LEFT:"INSERT_LEFT",INSERT_RIGHT:"INSERT_RIGHT",OPTION_SELECT:"OPTION_SELECT",NUMBER_SHOW_AS:"NUMBER_SHOW_AS",NUMBER_FORMAT:"NUMBER_FORMAT",FILTER:"FILTER",FULL_URL:"FULL_URL"},Lbe=({viewId:e,collectionId:t,propertyId:n,closeCallbackRef:s,onClose:a,from:o,popcorn:i})=>{var ke,Te;const{viewType:l,pageManager:c,readonly:d,managerReadonly:u}=Ne(),f=vs(e),[h]=Fa(e,{visible:!0,includeIdNumber:!0}),p=Ce(({collectionViews:he})=>{var ge;const Ee=he[e];return(ge=Ee==null?void 0:Ee.format.tableFreezeColumnIndex)!=null?ge:-1},[e]),g=(ke=h==null?void 0:h.findIndex(he=>he.property===n))!=null?ke:0,_=p===g,x=O$(e,n),F=l===m.CollectionViewType.TABLE,b=l===m.CollectionViewType.FORM,E=l===m.CollectionViewType.TIMELINE&&(o===zn.TABLE_HEADER||o===zn.PROPERTY_LIST_TIMELINE_TABLE),{propertySchema:C,relationPropertySchema:k}=eo(t,n),T=Ce(he=>{var Ge,tt,gt;const{collectionViews:Ee,blocks:ge}=he;if(o===zn.PAGE_PROPERTIES){const kt=((tt=(Ge=ge[t])==null?void 0:Ge.data.collectionPageProperties)!=null?tt:[]).find(({property:At})=>At===n);return(gt=kt==null?void 0:kt.visible)!=null?gt:!0}const Se=Ee[e];if(!Se)return;const{properties:Re,timelineTableProperties:Ae=[]}=gn(Se,he.blocks,he.collectionViews),Me=(E?Ae:Re).find(({property:kt})=>kt===n);return Me==null?void 0:Me.visible},[t,n,e,o,E]),v=M$(),I=f4(),j=ie(),S=ln(),D=cf(),A=vbe(),[P,L]=y.useState((Te=C==null?void 0:C.name)!=null?Te:""),[O,$]=y.useState(""),M=P.trim(),U=N$(),z=(C==null?void 0:C.type)===m.CollectionSchemaType.TITLE,K=(C==null?void 0:C.type)===m.CollectionSchemaType.RELATION,W=(C==null?void 0:C.type)===m.CollectionSchemaType.ROLLUP,Y=(C==null?void 0:C.type)===m.CollectionSchemaType.NUMBER,G=(C==null?void 0:C.type)===m.CollectionSchemaType.FORMULA,ee=(C==null?void 0:C.type)===m.CollectionSchemaType.SELECT||(C==null?void 0:C.type)===m.CollectionSchemaType.MULTI_SELECT,te=(C==null?void 0:C.type)===m.CollectionSchemaType.URL,Q=Ce(he=>{if(G)return $n(t,he).getType(n)},[t,n]),ne=Bbe(),se=y.useRef(null);y.useEffect(()=>{const he=se.current;he&&he.setSelectionRange(0,he.value.length)},[]),y.useEffect(()=>{ne(t,P,n)?$("此多维表已经存在相同名称的属性，请修改"):$("")},[ne,t,P,n]);const ce=y.useMemo(()=>{var Ee;if(!b)return[];const he=(Ee=f==null?void 0:f.format.formProperties)==null?void 0:Ee.find(ge=>ge.property===n);return[{type:H.TEXT_SWITCH,data:{switch:he==null?void 0:he.required,title:"必填",onSwitch:ge=>{x("required",ge)}}},{type:H.TEXT_SWITCH,data:{switch:he==null?void 0:he.showDescription,title:"添加说明",onSwitch:ge=>{x("showDescription",ge)}}},{type:H.OPERATION,isHidden:u,data:{icon:T?"IcHide":"IcShow",type:Bs.VISIBLE_STATE,visible:T,title:T?"隐藏":"显示"}}]},[T,f==null?void 0:f.format.formProperties,b,u,n,x]),ae=y.useMemo(()=>{var Ee,ge;if(!C)return[];const he=[{type:H.LINE,data:{},isHidden:z&&o===zn.PROPERTY_LIST,disableClick:!0},...ce,{type:H.OPERATION,isHidden:o!==zn.TABLE_HEADER||d||u,data:{icon:"IcArrowLeft02",type:Bs.INSERT_LEFT,title:"左边插入列"}},{type:H.OPERATION,isHidden:o!==zn.TABLE_HEADER||d||u,data:{icon:"IcArrowRight02",type:Bs.INSERT_RIGHT,title:"右边插入列"}},{type:H.LINE,data:{},isHidden:o!==zn.TABLE_HEADER||d||u,disableClick:!0},{type:H.OPERATION,isHidden:[zn.PAGE_PROPERTIES,zn.FORM_PROPERTIES].includes(o)||u,data:{icon:"IcAscending",type:Bs.ASCENDING,title:"升序"}},{type:H.OPERATION,isHidden:[zn.PAGE_PROPERTIES,zn.FORM_PROPERTIES].includes(o)||u,data:{icon:"IcDescending",type:Bs.DESCENDING,title:"降序"}},{type:H.OPERATION,isHidden:[zn.PAGE_PROPERTIES,zn.FORM_PROPERTIES].includes(o)||u,data:{icon:"IcFilter",type:Bs.FILTER,title:"筛选"}},{type:H.LINE,data:{},isHidden:[zn.PAGE_PROPERTIES,zn.FORM_PROPERTIES].includes(o)||u,disableClick:!0},{type:H.OPERATION,isHidden:z&&!E||u||b,data:{icon:T?"IcHide":"IcShow",type:Bs.VISIBLE_STATE,visible:T,title:T?"隐藏":"显示"}},{type:H.OPERATION,isHidden:!(F&&o===zn.TABLE_HEADER)||d||u,data:{switch:_,icon:_?"IcUnpin":"IcPin",visible:T,title:_?"清除冻结列":"冻结至该列",onClick:()=>{S(Ve.BITABLE_PROPERTY_WIDGET),Rt(e,{tableFreezeColumnIndex:_?-1:g})}}},{type:H.OPERATION,isHidden:z||d||u||K,data:{icon:"IcDuplicate",type:Bs.COPY,title:"拷贝"}},{type:H.OPERATION,isHidden:z||d||u,data:{icon:"IcTrash",type:Bs.DELETE,title:"删除"}}];if(z)he.unshift({type:H.OPERATION,data:{icon:"IcTitle",type:m.CollectionSchemaType.TITLE,title:"标题"}});else{if(Y&&he.unshift({type:H.OPERATION,data:{icon:"IcMenuNum",title:"格式",type:Bs.NUMBER_FORMAT}},{type:H.OPERATION,data:{icon:"MIcRing",title:"显示样式",type:Bs.NUMBER_SHOW_AS}}),G&&Q===et.ValueTool.numberType&&he.unshift({type:H.OPERATION,data:{icon:"MIcRing",title:"显示样式",type:Bs.NUMBER_SHOW_AS}}),W){const Re=qm(C.aggregation)||OM(C==null?void 0:C.aggregation)==="number"||ni()&&((C==null?void 0:C.targetPropertyType)===m.CollectionSchemaType.NUMBER||(C==null?void 0:C.targetPropertyType)===m.CollectionSchemaType.FORMULA&&$n((Ee=k==null?void 0:k.collectionId)!=null?Ee:"").getType((ge=C==null?void 0:C.targetProperty)!=null?ge:"")===et.ValueTool.numberType);he.unshift({type:H.OPERATION,isHidden:!Re,data:{icon:"MIcRing",title:"显示样式",type:Bs.NUMBER_SHOW_AS}}),he.unshift({type:H.OPERATION,data:{icon:"IcTitleRollup",title:"汇总设置",hasArrow:!d,renderSubMenu:()=>d?null:r.jsx(l4,{collectionId:t,propertyId:n})}})}ee?he.unshift({type:H.OPERATION,data:{icon:"IcSettings",type:Bs.OPTION_SELECT,title:"管理选项"}}):te&&he.unshift({type:H.TEXT_SWITCH,data:{switch:!!(C!=null&&C.fullUrl),icon:"IcLink",iconSize:"small",type:Bs.FULL_URL,title:"显示完整URL",onSwitch:Re=>{Np(t,n,{fullUrl:Re})}}});const Se=b?hre:mre;he.unshift({type:H.OPERATION,data:{...Se[C.type],hasArrow:!d,renderSubMenu:()=>d?null:r.jsx(Pbe,{viewId:e,collectionId:t,propertyId:n,propertyType:C.type,isFormView:b,popcorn:i})}})}return he},[C,z,o,ce,d,u,E,b,T,F,_,K,S,e,g,Y,G,Q,W,ee,te,k==null?void 0:k.collectionId,t,n,i]);s.current=y.useCallback(()=>{if(O)return"prevent";M&&M!==(C==null?void 0:C.name)&&Np(t,n,{name:M})},[t,O,n,M,C==null?void 0:C.name]);const de=y.useCallback(async he=>{var Ee,ge,Se,Re;switch(he.data.type){case Bs.ASCENDING:case Bs.DESCENDING:{S(Ve.BITABLE_PROPERTY_WIDGET);const Ae=(Ee=pe().collectionViews)==null?void 0:Ee[e];if(!Ae)return;const Me=(ge=Br(Ae.format.sorters))!=null?ge:[];Me.forEach(gt=>{gt.disable=!1});const Ge=Me.find(gt=>gt.property===n),tt=he.data.type===Bs.ASCENDING?"asc":"desc";if(Ge?Ge.direction=tt:Me.push({property:n,direction:tt,disable:!1}),Rt(e,{sorters:Me}),c!=null&&c.current){const gt=c.current.querySelector(".".concat(rc.tableSortManager)),kt=()=>{var Qt;const At=(Qt=c.current)==null?void 0:Qt.getBoundingClientRect();return{getBoundingClientRect:()=>({...At,x:At.x+At.width/2,y:At.y,left:At.left+At.width/2,top:At.top,width:At.width/2,height:At.height})}};j.dropdown({popcorn:gt?ra(gt):kt(),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(Vg,{})}})}break}case Bs.FILTER:{if(S(Ve.BITABLE_PROPERTY_WIDGET),U({collectionId:t,viewId:e},n,u),c!=null&&c.current){const Ae=c.current.querySelector(".".concat(rc.tableSortManager)),Me=()=>{var tt;const Ge=(tt=c.current)==null?void 0:tt.getBoundingClientRect();return{getBoundingClientRect:()=>({...Ge,x:Ge.x+Ge.width/2,y:Ge.y,left:Ge.left+Ge.width/2,top:Ge.top,width:Ge.width/2,height:Ge.height})}};j.dropdown({popcorn:Ae?ra(Ae):Me(),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(Ug,{})}})}break}case Bs.INSERT_LEFT:case Bs.INSERT_RIGHT:{me.event("bitable_property_create",{from_scene:"view"}),D({collectionId:t,viewId:e,position:{property:n,left:he.data.type===Bs.INSERT_LEFT},visible:!0,isTimelineTable:E}),S(Ve.BITABLE_PROPERTY_WIDGET);break}case Bs.COPY:{me.event("bitable_property_create",{from_scene:"duplicate"}),A(t,e,n,E),S(Ve.BITABLE_PROPERTY_WIDGET);break}case Bs.VISIBLE_STATE:{const Ae=!he.data.visible;if(l===m.CollectionViewType.FORM&&!Ae){const Me=pe().collectionViews[e],Ge=(Se=Me==null?void 0:Me.format.formProperties)!=null?Se:[],tt=(Re=Me==null?void 0:Me.format.formLogic)!=null?Re:[];if(D1(t,e,Ge.filter(kt=>kt.property===n?Ae:kt.visible).map(kt=>kt.property),tt)!=null){if(!await new Promise(At=>{j.warning({title:r.jsx(r.Fragment,{children:"确认隐藏题目吗？"}),content:r.jsx(r.Fragment,{children:"会导致部分跳题逻辑失效，将自动删除失效逻辑。"}),confirm(){At(!0)},cancel(){At(!1)}})}))return;Rt(e,{formLogic:tt})}}v(t,e,n,Ae,E),S(Ve.BITABLE_PROPERTY_WIDGET);break}case Bs.DELETE:{j.warning({title:r.jsx(r.Fragment,{children:"是否确认删除该属性？"}),confirm:()=>{S(Ve.BITABLE_PROPERTY_WIDGET,{closeAfterCallBack:()=>{I(t,n)}})}});break}case Bs.OPTION_SELECT:{S(Ve.BITABLE_PROPERTY_WIDGET),j.dropdown({popcorn:i,placement:"bottom",content:({onCloseModal:Ae})=>d?null:r.jsx(jbe,{viewId:e,collectionId:t,propertyId:n,onClose:Ae})});break}case Bs.NUMBER_SHOW_AS:{S(Ve.BITABLE_PROPERTY_WIDGET),j.dropdown({popcorn:i,placement:"bottom",content:({onCloseModal:Ae})=>d?null:r.jsx(Sbe,{propertyId:n,onCloseModal:Ae})});break}case Bs.NUMBER_FORMAT:{S(Ve.BITABLE_PROPERTY_WIDGET),j.dropdown({popcorn:i,placement:"bottom",content:({onCloseModal:Ae})=>d?null:r.jsx(O8,{propertyId:n,closeModal:Ae})});break}}},[S,e,c,n,j,U,t,u,D,E,A,l,v,I,i,d]);return r.jsxs("div",{className:"flex flex-col w-[240px] next-modal-scroll",children:[!d&&r.jsx("div",{className:"flex flex-row items-center w-full",children:r.jsx(Ct,{inputRef:se,autoFocus:!0,placeholder:"请输入名称",value:P,className:"h-8 mx-2.5 mt-2.5 flex-1",onEnter:()=>{O||a()},onChange:L})}),O&&r.jsx("div",{className:"mx-4 mb-2 text-t4 text-red",children:O}),r.jsxs("div",{className:"flex flex-col mb-[5px]",children:[r.jsx("div",{className:"text-t2 text-grey3 mb-[4px] ml-4 mt-2.5",children:"属性类型"}),r.jsx(ze,{onItemClick:de,items:ae})]})]})},$g=()=>{const{viewId:e,collectionId:t}=Ne(),n=ie(),s=y.useRef();return y.useCallback((a,o,i=zn.TABLE_HEADER,l,c)=>{n.dropdown({popcorn:o,closeBeforeCallBack:()=>{var d;c==null||c(),(d=s.current)==null||d.call(s)},modalId:Ve.BITABLE_PROPERTY_WIDGET,placement:l||"bottom",content:({onCloseModal:d})=>r.jsx(Lbe,{viewId:e,collectionId:t,closeCallbackRef:s,propertyId:a,onClose:d,popcorn:o,from:i})})},[t,n,e])},Bbe=()=>{const e=(t,n,s)=>{const a=pe().blocks[t];return a!=null&&a.data.schema?Object.keys(a.data.schema).map(i=>{var l,c;return{...(c=(l=a.data.schema)==null?void 0:l[i])!=null?c:{},property:i}}).some(i=>s!==i.property&&i.name===n):!1};return y.useCallback(e,[])},HC=y.memo(e=>{const{viewId:t,managerReadonly:n,viewType:s,relationEditor:a,isLocked:o}=Ne(),{col:i,isGroup:l}=e,c=u4(t,i.property),d=s===m.CollectionViewType.TIMELINE,u=oo(i),f=ZF(({offset:[h]})=>{c(Es(h,HI,iO))},{from:u,preventDefault:!0});return r.jsxs("div",{"data-disable-select":!0,className:R("relative flex-shrink-0 h-full print:border-t print:border-b print:border-r transition-all ease-out",!l&&!d&&!a&&"border-r"),style:{width:u},children:[r.jsx(Obe,{...e}),!n&&!o&&r.jsx("div",{...f(),style:{touchAction:"none"},className:"absolute -right-0.5 z-10 cursor-col-resize top-0 w-1 duration-150 hover:bg-black h-full"})]})},yn),Obe=y.memo(e=>{const{col:t,groupName:n}=e,{viewId:s,collectionId:a,viewType:o,readonly:i,managerReadonly:l,isLocked:c}=Ne(),d=y.useRef(null),{propertySchema:u}=eo(a,t.property),f=$g(),h=o===m.CollectionViewType.TIMELINE,p=mee(t.property,zn.TABLE_HEADER,bE(s,n));if(A3(t.property,zn.TABLE_HEADER),y.useEffect(()=>{d.current&&p&&(f(t.property,d.current),st({$newTableProperty:void 0}))},[t.property,p,f]),!u)return null;const g=x=>{if(_||c)return null;t.type!==m.CollectionSchemaType.ID_NUMBER&&(x.preventDefault(),f(t.property,x.currentTarget))},_=i&&l;return r.jsx("button",{ref:d,disabled:_,className:R("text-t2 flex items-center w-full h-full px-2",{"animate-hover rounded-none":!_,"pt-[37px] print:pt-0":h&&!n}),onContextMenu:g,"data-disable-contextmenu":!0,onClick:g,children:r.jsxs("span",{className:"flex items-center overflow-hidden text-grey3 whitespace-nowrap overflow-ellipsis",style:{height:Si},children:[u.type!==m.CollectionSchemaType.ID_NUMBER&&r.jsx(V,{className:"mr-1",size:"middle",name:un[u.type]}),u.name]})})},yn),A1=y.memo(({isGroup:e,groupName:t,properties:n,className:s,recordIds:a})=>{const{viewId:o,embed:i,relationEditor:l,viewType:c,isLocked:d,managerReadonly:u,collectionId:f}=Ne(),h=c===m.CollectionViewType.TIMELINE,p=y.useRef(null),g=We(f,!1),_=Un(),x=Ks(),F=Xae(f,o,a!=null?a:[]),b=Ce(v=>{if(!a)return 0;const I=new Set(a);return v.ui.selectedBlocks.filter(j=>I.has(j.blockId)&&j.viewId===o).length},[a],{obsSelectBlocks:[{blockId:f,viewId:o,syncId:x}]}),w=pE(o,n),E=n.slice(0,w+1),C=n.slice(w+1);y.useEffect(()=>{if(!i)return;const v=p.current,I=v==null?void 0:v.parentElement,j=v==null?void 0:v.closest(".next-space-page");if(!v||!I||!j)return;const S=I.querySelector(".".concat(rc.tableFooter)),D=()=>{const A=I.getBoundingClientRect(),P=j.getBoundingClientRect();if(A.top<P.top){let L=Math.abs(P.top-A.top);const O=S==null?void 0:S.getBoundingClientRect();O&&O.y-P.y<v.clientHeight&&(L=L-(v.clientHeight-(O.top-P.top))),v.style.transform="translate3d(0,".concat(Math.round(L+uE+i8),"px,0)")}else v.style.transform="none"};return j.addEventListener("scroll",D),window.addEventListener("resize",D),()=>{j.removeEventListener("scroll",D),window.removeEventListener("resize",D)}},[i]);let k=0;l||(i?k=void 0:(k=(e?38+gu:gu)-1,_===wt.PAGE_LITE_PREVIEW&&(k=k-11)));const T=r.jsx(r.Fragment,{children:h?null:a&&!g?r.jsx(T$,{isGroup:e,readonly:g,alwaysShow:b>0,checked:F,onCheck:v=>{const I=a.filter(S=>{const D=mn(S);return Xn(D.role,m.PermissionRole.WRITER)}),j=new Set(I);if(v){const S=Bu(I,o,x),D=J.ui.selectedBlocks.filter(A=>!j.has(A.blockId));S.push(...D),re(at.updateSelectBlocks(S))}else{const S=J.ui.selectedBlocks.filter(D=>!j.has(D.blockId));re(at.updateSelectBlocks(S))}}}):null});return r.jsxs("div",{ref:p,style:{top:k},className:R("sticky z-[11] w-full min-w-max border-b transition-none print:border-none bg-white1 flex-shrink-0",s,rc.tableHeader,!e&&!l&&"border-t"),children:[r.jsx(br,{disabled:u||d,className:"flex",appendChild:h?null:r.jsx(ube,{groupName:t}),modifiers:[ew],strategy:tw,onDragStart:()=>Lb(),items:n.map(v=>({id:v.property,...v})),renderItemContent:({item:v})=>r.jsx(HC,{col:v,groupName:t,isGroup:e}),customRenderItems:()=>r.jsxs(r.Fragment,{children:[E.length===0&&T,E.length>0&&r.jsx(b3.Provider,{value:!0,children:r.jsxs("div",{className:"flex sticky left-0 z-[10] bg-white1",children:[T,E.map(v=>r.jsx(iF,{renderItemContent:({item:I})=>r.jsx(HC,{col:I,groupName:t,isGroup:e}),item:{id:v.property,...v},disabled:u||d,onlyHandleDraggable:!1},v.property))]})}),C.map(v=>r.jsx(iF,{renderItemContent:({item:I})=>r.jsx(HC,{col:I,groupName:t,isGroup:e}),item:{id:v.property,...v},disabled:u||d,onlyHandleDraggable:!1},v.property))]}),onChange:(v,{active:I,over:j})=>{var P;if(Lb(),!j)return;const{properties:S=[],timelineTableProperties:D=[]}=(P=gn(o))!=null?P:{},A=h?D:S;if(I.id!==j.id){const L=A.findIndex(M=>M.property===I.id),O=A.findIndex(M=>M.property===j.id),$=Wu(A,L,O);Rt(o,{[h?"timelineTableProperties":"tableProperties"]:$})}}}),h&&!t&&!u&&!d&&r.jsx(Fe,{popup:"收起表格",className:"animate-hover absolute right-2 top-2 z-10 rotate-180 text-grey3",onClick:v=>{v.stopPropagation(),Rt(o,{timelineShowTable:!1})},children:r.jsx(V,{name:"IcUnfold",size:"middle"})})]})}),Mbe=({recordIds:e,recordId:t,propertyId:n,width:s,viewId:a})=>{var W,Y;const{relationRecords:o,relationCollection:i}=C$(t,n),l=We(t,!1),c=ur(),d=ys(),u=li(a!=null?a:""),f=y.useRef(null),h=Oe(),p=y.useRef(null),g=y.useRef(null),_=y.useRef(null),[x,F]=y.useState(""),b=(W=i==null?void 0:i.uuid)!=null?W:"",{resultList:w,onInputChange:E,keyword:C,loadMore:k,hasMore:T,loading:v,firstTime:I}=oE({type:"collection",fileType:void 0,source:"relationMenu",parentId:b,canSearchWithEmpty:!l,getPerPage:()=>100}),j=y.useMemo(()=>{let G=Q8(b,pe(),!1,C);G=G.sort((Q,ne)=>{var ae,de;const se=(ae=Q.updatedAt)!=null?ae:0;return((de=ne.updatedAt)!=null?de:0)-se});const ee=new Set(w.map(Q=>Q.uuid)),te=w.slice(0);return G.forEach(Q=>{ee.has(Q.uuid)||(ee.add(Q.uuid),te.push({...Q,title:""}))}),te},[C,b,w]),S=y.useMemo(()=>{var G,ee;return{collectionId:(G=i==null?void 0:i.uuid)!=null?G:"",viewParentId:(ee=i==null?void 0:i.uuid)!=null?ee:"",viewType:m.CollectionViewType.TABLE,viewId:"",readonly:!0,managerReadonly:!0,relationEditor:!0,changeView(){}}},[i==null?void 0:i.uuid]);y.useEffect(()=>A(),[o]);const D=G=>{var Q;const te=[...(Q=WR(t,n))!=null?Q:[]].filter(ne=>!(ne.type===m.TextType.LINK_PAGE&&ne.uuid===G));c(e!=null?e:t,n,te)},A=()=>{const G=setTimeout(()=>{var ee;clearTimeout(G),(ee=g.current)==null||ee.focus()})},P=G=>{var ne;const ee=(ne=WR(t,n))!=null?ne:[],{relationRecords:te}=wc(t,n);let Q=[];te.includes(G)?Q=ee.filter(se=>se.uuid!==G):Q=ee.concat({type:m.TextType.LINK_PAGE,uuid:G,text:"",enhancer:{code:!1}}),c(e!=null?e:t,n,Q)},L=()=>{h(()=>{var ne;const{blocks:G}=pe(),ee=G[b],te={type:m.BlockType.PAGE};te.data={segments:ht(C)};const Q=ut(te,{parentId:b,last:!0});(ne=ee==null?void 0:ee.views)==null||ne.forEach(se=>{re(ld({uuid:Q,viewId:se}))}),P(Q)},{noThrottle:!0})},O=()=>{g.current&&(g.current.value=""),E(""),A()},$=j.filter(G=>G.type===m.BlockType.PAGE&&!o.includes(G.uuid)).map(G=>G.uuid),M=o.filter(G=>{const ee=J.blocks[G];return(ee==null?void 0:ee.type)===m.BlockType.PAGE&&fe(ee.data.segments).includes(l?x:C)});if(!i)return null;const U=[];Object.entries((Y=i.data.schema)!=null?Y:{}).forEach(([G,ee])=>{const te=G==="title",Q={property:G,visible:!0,name:ee.name,type:ee.type,width:te?1.5*kp:kp};te?U.unshift(Q):U.push(Q)});const z=G=>{const ee=M[G];if(!ee)return null;const te=r.jsx(V,{className:R("sticky left-2 z-10 self-center",l&&"opacity-0"),name:"MIcCircleDelete",onClick:Q=>{l||(Q.stopPropagation(),D(ee))},size:"large"});return r.jsx(S1,{index:G,recordId:ee,properties:U,settingIcon:te,onClick:(Q,ne)=>{const{illegal:se}=mn(ee);d(ee,{illegal:se,forceOpenInRight:ne.altKey,openWay:u,forceOpenNewTab:ne.ctrlKey||ne.metaKey})}})},K=G=>{const ee=$[G];if(!ee)return null;const te=o.includes(ee)?"MIcCircleDelete":"MIcCircleAdd",Q=r.jsx(V,{className:R("sticky left-2 self-center z-10",te==="MIcCircleAdd"&&"invisible group-hover:visible"),name:te,size:"large"});return r.jsx(S1,{index:G,recordId:ee,properties:U,settingIcon:Q,onClick:ne=>P(ne)})};return r.jsxs("div",{className:R("relative w-[800px] pb-4"),style:{width:s},children:[r.jsxs("div",{className:"flex items-center justify-between py-1 border-b relative pr-3",ref:p,children:[r.jsx(Ct,{autoFocus:!0,placeholder:l?"查找页面":"查找或创建新页面",className:"h-8 flex-grow bg-white2 border-none",showBorder:!1,onChange:l?G=>F(G):E,inputRef:g}),r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{size:"middle",name:"IcUploadCancel",onClick:O,className:"text-grey4 cursor-pointer animate-hover"}),r.jsx("div",{className:"flex items-center h-8 ml-4 px-1 text-t2 max-w-[150px] ",onClick:G=>{const{illegal:ee}=mn(t);d(b,{illegal:ee,forceOpenInRight:G.altKey,openWay:u,forceOpenNewTab:G.ctrlKey||G.metaKey})},children:r.jsx(Ir,{uuid:b,interactable:!0,className:"whitespace-nowrap text-ellipsis"})})]})]}),v&&I&&M.length===0&&r.jsx(xs,{className:"w-full h-[60px]"}),M.length>0&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"px-4 mt-2 mb-2 text-grey3 text-t2",children:[M.length," 条关联记录"]}),o.length===0?r.jsx("div",{className:"text-t2 flex h-[60px] w-full items-center justify-center text-grey3",children:l?"关联记录为空":"搜索查找要关联的记录"}):r.jsx("div",{className:"max-h-[250px] w-full overflow-auto",ref:f,children:r.jsx(tF.Provider,{value:f,children:r.jsx("div",{className:"relative w-max min-w-full",children:r.jsxs(rd.Provider,{value:S,children:[r.jsx(A1,{properties:U,className:"pl-8 z-50 bg-white2"}),r.jsx(Mk,{bufferSize:10,scrollRef:f,getItemSize:()=>Si,count:M.length,getItemKey:G=>{var ee;return(ee=M[G])!=null?ee:"row-".concat(G)},renderItem:z})]})})})})]}),!l&&r.jsxs(r.Fragment,{children:[$.length>0&&r.jsx("div",{className:"px-4 mb-2 mt-4 text-grey3 text-t sticky top-0",children:"选择关联记录"}),r.jsx("div",{className:"w-full max-h-[250px] overflow-auto",ref:_,children:$.length>0&&r.jsx(tF.Provider,{value:_,children:r.jsx("div",{className:"relative w-max min-w-full",children:r.jsxs(rd.Provider,{value:S,children:[r.jsx(A1,{properties:U,className:"pl-8 z-50 bg-white2"}),r.jsx(xd,{pageStart:1,initialLoad:!1,useWindow:!1,loadMore:k,getScrollParent:()=>_.current,hasMore:T,children:r.jsx(Mk,{bufferSize:10,scrollRef:_,getItemSize:()=>Si,count:$.length,getItemKey:G=>{var ee;return(ee=$[G])!=null?ee:"row-".concat(G)},renderItem:K})})]})})})}),C&&T&&r.jsx("div",{className:"w-full h-[38px] text-t2 text-grey3 flex items-center pl-2.5 border-b cursor-pointer animate-hover border-t",onClick:k,children:"加载更多"}),C&&r.jsxs("div",{className:"w-full h-[38px] text-t2 text-grey3 flex items-center pl-2.5 border-b cursor-pointer animate-hover",onClick:L,children:[r.jsx(V,{size:"middle",name:"IcAddBoard",className:"mr-2.5"}),"在 ",r.jsx(Ir,{uuid:b})," 中创建 ",r.jsx("span",{className:"text-black",children:C})]})]})]})};Zye(Mbe);const Ube=[],Vbe=[{id:Ve.CLEAR_TEMPLATE,success:Fi()},{id:Ve.CREATE_PAGE_TIP,success:Fi()},{id:Ve.AI_NOVICE,success:Fi()},{id:Ve.HOT_SPOT,success:!1},{id:Ve.KOL_SALES,success:Fi()},{id:Ve.CREATE_SPACE_AFTER,success:Fi()},{id:Ve.IMPORTANT_FEATURE,success:!1}],U$=Aa(()=>({queue:Vbe})),$be=Qs(U$),Hbe=e=>{$be(t=>{const n=t.queue.findIndex(s=>s.id===e);return n>-1&&(t.queue[n].success=!0),t},{replace:!0}),zbe(t=>{const n=t.queue.findIndex(s=>s.id===e);return n>-1&&(t.queue[n].success=!0),t},{replace:!0})},FRe=Aa(()=>({queue:Ube})),zbe=Qs(U$),qbe=()=>y.useCallback(async e=>{const{activityId:t,dailyPopupLimit:n=1,totalPopupLimit:s=-1,userId:a,spaceId:o,request:i}=e;let{validate:l="local"}=e,c=!1;if(!t||!a)return!0;if(kY()&&(l="local"),l==="local"){const d=e.isSpaceSensitive&&o!=null?o:a,u=ue().format("YYYY-MM-DD"),f=localStorage.getItem(t)||"{}",h=JSON.parse(f),p=()=>{localStorage.setItem(t,JSON.stringify(h))},g=h[d];g?g.num===n||s>0&&g.num>=s?c=!0:g.time===u?g.num>n?c=!0:h[d].num++:g.num>s&&s!==-1?c=!0:(h[d].num++,h[d].time=u):h[d]={num:1,time:u},p()}if(l==="user"){const d=await i.infra.getSetting(a),u=JSON.parse(d||"{}")||{};u.userReadActivities?u.userReadActivities.includes(t)?c=!0:u.userReadActivities.push(t):u.userReadActivities=[t],c||i.infra.updateUserSetting(a,u)}return c},[]),wRe=()=>{const e=qbe();return y.useCallback(async t=>!await e(t),[e])},m4=()=>{const[e,t]=y.useState();return y.useEffect(()=>{Eb(Ca.GetAppVersion).then(n=>t(n))},[]),e},Gbe=e=>{var n,s;const t=((s=(n=e==null?void 0:e.split("-")[0])==null?void 0:n.split("."))!=null?s:[]).slice(0,3);return Number(t.join(""))},V$=()=>{const e=Oe(),t=$$(),n=h4(),s=(a,o,i)=>{var g,_,x,F,b;const l=gn(a);if(!l)return;const{view:c,collection:d,properties:u}=l,f=(g=d.data.schema)!=null?g:{},h={...c.format,formShared:!1};let p=[];if(p=Br(u),i!==m.CollectionViewType.TABLE?p.forEach(w=>{w.property!=="title"&&(w.visible=!1)}):(c==null?void 0:c.type)!==m.CollectionViewType.TABLE&&p.forEach(w=>w.visible=!0),i===m.CollectionViewType.TABLE){let w=h.tableProperties;w||(w=p),e(()=>{Rs(a,{title:o,format:Hu({tableProperties:w,oldViewFormat:h}),type:i})})}if(i===m.CollectionViewType.GALLERY){let w=h.galleryProperties;w||(w=p),e(()=>{Rs(a,{title:o,format:m2({galleryProperties:w,oldViewFormat:c.format}),type:i})})}if(i===m.CollectionViewType.LIST){let w=h.listProperties;w||(w=p),e(()=>{Rs(a,{title:o,format:h2({listProperties:w,oldViewFormat:h}),type:i})})}if(i===m.CollectionViewType.BOARD){const w=(x=(_=h.boardGroupBy)==null?void 0:_.property)!=null?x:"",E=f[w];!E||E.type!==m.CollectionSchemaType.SELECT?t(a,o):e(()=>{Rs(a,{title:o,type:i})})}if(i===m.CollectionViewType.TIMELINE&&n(a,{viewTitle:o,targetType:m.CollectionViewType.TIMELINE}),i===m.CollectionViewType.CALENDAR&&n(a,{viewTitle:o,targetType:m.CollectionViewType.CALENDAR}),i===m.CollectionViewType.FORM){let w=h.formProperties;w||(w=Zf(f,i)),e(()=>{Rs(a,{title:o,format:Jj({formProperties:w,oldViewFormat:h}),type:i})}),(b=(F=J.blocks[d.uuid])==null?void 0:F.views)!=null&&b.some(E=>{var C;return((C=J.collectionViews[E])==null?void 0:C.type)===m.CollectionViewType.TABLE})||Io({title:"表格",format:Hu({tableProperties:p}),pageSort:d.subNodes,type:m.CollectionViewType.TABLE},{parentId:d.uuid})}};return y.useCallback(s,[t,n,e])},$$=()=>{const e=Oe(),t=(n,s)=>{var f,h;const a=gn(n);if(!a)return;const{view:o,collection:i}=a,l=(f=i.data.schema)!=null?f:{},c={...o.format};let d=c.boardProperties;d||(d=Zf(l,m.CollectionViewType.BOARD));const u=Object.keys(l).find(p=>{var g;return((g=l[p])==null?void 0:g.type)===m.CollectionSchemaType.SELECT});if(u){const p=Lp({groupProperty:u,options:(h=l[u])==null?void 0:h.options,boardProperties:d,oldViewFormat:c});e(()=>{Rs(n,{title:s!=null?s:o.title,format:p,type:m.CollectionViewType.BOARD})})}else{const p=qe(),g=jE(),{visibleProperty:_,inVisibleProperty:x}=X0(p),F=Lp({groupProperty:p,boardProperties:d.concat(x),options:g,oldViewFormat:c});pd.forEach(b=>{if(b==="boardProperties")return;const w=F[b];w&&(F[b]=[...w,_])}),e(()=>{EI(i.uuid,{[p]:{name:Ci(i.data.schema,"分类"),type:m.CollectionSchemaType.SELECT,options:g}}),Rs(n,{title:s!=null?s:o.title,format:F,type:m.CollectionViewType.BOARD}),Qf(i.uuid,[p],n)})}};return y.useCallback(t,[e])},h4=()=>{const e=Oe(),t=(n,s)=>{var T,v,I;const a=gn(n);if(!a)return;const{view:o,collection:i}=a,{viewTitle:l=o.title,targetType:c=o.type}=s!=null?s:{},d=c===m.CollectionViewType.TIMELINE,{calendarBy:u,calendarByEnd:f,timelineBy:h,timelineByEnd:p}=a;let g=d?h:u,_=d?p:f;const x=(T=i.data.schema)!=null?T:{},F={...o.format,formShared:!1};let b=F.calendarProperties?[...F.calendarProperties]:void 0;b||(b=Zf(x,m.CollectionViewType.CALENDAR));const w=Object.entries(x).filter(([j,S])=>S.type===m.CollectionSchemaType.DATE);let E,C;const k=w.filter(j=>j[0]===g?(E=!0,!1):j[0]===_?(C=!0,!1):!0);if(g=E?g:(v=k[0])==null?void 0:v[0],_=C?_:(I=k[E?0:1])==null?void 0:I[0],g&&_){const j=d?Bp({oldViewFormat:F,timelineProperties:b,timelineBy:g,timelineByEnd:_}):Op({oldViewFormat:F,calendarProperties:b,calendarBy:g,calendarByEnd:_});e(()=>{Rs(n,{title:l||o.title,format:j,type:c})})}else{const j=[],S={...x};if(!g){g=qe();const A={property:g,visible:!1};j.push(A),b.push(A),S[g]={name:Ci(i.data.schema,"开始时间"),type:m.CollectionSchemaType.DATE}}if(!_){_=qe();const A={property:_,visible:!1};j.push(A),b.push(A),S[_]={name:Ci(i.data.schema,"结束时间"),type:m.CollectionSchemaType.DATE}}const D=d?Bp({timelineProperties:b,timelineBy:g,timelineByEnd:_}):Op({calendarProperties:b,calendarBy:g,calendarByEnd:_});pd.forEach(A=>{if(d&&A==="timelineProperties"||!d&&A==="calendarProperties")return;const P=D[A];P&&(D[A]=[...P,...j])}),e(()=>{_e(i.uuid,{data:{schema:S}}),Rs(n,{title:l||o.title,format:D,type:c}),Qf(i.uuid,j.map(A=>A.property),n)})}};return y.useCallback(t,[e])},g2=e=>{const{viewId:t,viewType:n,managerReadonly:s,readonly:a}=Ne(),o=$$();tc(()=>{if(s||a||!e)return;(()=>{const l=n===m.CollectionViewType.BOARD;if(e.withoutValidGroup&&l){o(t);return}e.needUpdateGroups&&Rt(t,{["".concat(l?"boardGroups":"collectionGroups")]:e.newViewGroups}),e.needUpdateSubGroups&&Rt(t,{collectionGroups:e.newViewSubGroups})})()},[e,o,s,a,t,n],{wait:300})},Y_=10*60*1e3,gy=24,w6=40,zu=fn.memo(({type:e="page"})=>{const t=lt(),[n,s]=y.useState(0),a=y.useRef(null),o=D3(),i=_0(f=>{const h=Date.now();return Object.entries(o).filter(([p,g])=>h-g.activityTime<Y_&&g.userId!==f.uuid&&g.present).map(([p,g])=>kn(g,"activityTime")).sort((p,g)=>p.userId.localeCompare(g.userId))});y.useEffect(()=>{const f=setInterval(()=>{s(Date.now())},Y_);return()=>{clearInterval(f)}},[]);const l=y.useMemo(()=>{const f={};return i.forEach(h=>{var p;t===h.pageId&&h.blockId&&(f[h.blockId]||(f[h.blockId]=[]),(p=f[h.blockId])==null||p.push(h))}),f},[i,t]),c=y.useMemo(()=>{const f=[];for(const[h,p]of Object.entries(l))f.push(...p.map((g,_)=>r.jsx(E6,{blockId:g.blockId,position:_,userId:g.userId,showType:e,anchorRef:a},"in-block-".concat(g.userId))));return f},[l,e]),d=y.useMemo(()=>{const f={};return i.forEach(h=>{var p;if(h.blockId){const g=ks(h.pageId),_=J.blocks[g!=null?g:""];g&&t===g&&((_==null?void 0:_.type)===m.BlockType.COLLECTION_VIEW||(_==null?void 0:_.type)===m.BlockType.COLLECTION_VIEW_PAGE)&&(f[g]||(f[g]=[]),(p=f[g])==null||p.push({userId:h.userId,pageId:g,blockId:h.pageId}))}}),f},[i,t]),u=y.useMemo(()=>{const f=[];for(const[h,p]of Object.entries(d))f.push(...p.map((g,_)=>r.jsx(E6,{blockId:g.blockId,position:_,userId:g.userId,showType:e,anchorRef:a},"in-block-".concat(g.userId))));return f},[d,e]);return r.jsxs(r.Fragment,{children:[c,u,r.jsx("div",{className:"hidden",ref:a})]})}),E6=fn.memo(({blockId:e,position:t,userId:n,showType:s,anchorRef:a})=>{const[o,i]=y.useState(),l=Ln(),c=Pi(n),d=_r(n),[u,f]=y.useState(),h=bn(".block-list",l),p=bl(h,"height"),g=y.useCallback((_=e===o)=>{const x=Wbe(a,e,_,s,l,t);return f(x==null?void 0:x.style),x},[a,e,o,l,t,s]);return y.useEffect(()=>{const _=x=>{i(x),g(e===x)};return xn.on("hoverId",_),()=>{xn.off("hoverId",_)}},[e,g]),y.useEffect(()=>{const _=g();let x;_||(x=setTimeout(()=>{g()},1e3));let F;return _!=null&&_.blockListContainer?(F=new MutationObserver((b,w)=>{let E=!1;b.forEach(C=>{switch(C.type){case"childList":{C.addedNodes.forEach(k=>{E||(E=zC(k,e,!0))}),C.removedNodes.forEach(k=>{E||(E=zC(k,e,!0))});break}case"attributes":{if(E)return;E=zC(C.target,e);break}}}),E&&g()}),F.observe(_.blockListContainer,{childList:!0,subtree:!0})):f(void 0),()=>{x&&clearTimeout(x),F&&F.disconnect()}},[a,e,l,t,s,p.height,g]),!c||!u||!e?null:r.jsx("div",{className:R("absolute flex transition"),style:u,"data-user-id":c.uuid,children:r.jsx(ar,{className:"rounded-full text-white",name:d,color:c.backgroundColor,icon:{type:"upload",value:c.avatar},imgClassName:"rounded-full"})})}),zC=(e,t,n)=>{var s;return!!(e instanceof HTMLElement&&(((s=e.dataset)==null?void 0:s.blockId)===t||n&&e.querySelector('[data-block-id="'.concat(t,'"]'))))},Wbe=(e,t,n,s,a,o)=>{var d,u,f,h,p,g,_,x;let i,l;if(s==="board"||s==="table")l=(f=(u=(d=e.current)==null?void 0:d.parentElement)==null?void 0:u.parentElement)==null?void 0:f.querySelector(".block-list"),i=(g=(p=(h=e.current)==null?void 0:h.parentElement)==null?void 0:p.parentElement)==null?void 0:g.querySelector("[data-block-id]");else{if(l=bn(".block-list",a),!l)return;i=l.querySelector("[data-block-id]")}if(!l)return;const c=l.querySelector('[data-block-id="'.concat(t,'"]'));if(c&&i)if(s==="page"){const F=J.blocks[t];if(!F)return;const b=ga((_=J.blocks[F.parentId])==null?void 0:_.type),w=bn(".block-content",a);if(!w)return;if(c.firstElementChild){const E=c.firstElementChild.getBoundingClientRect(),C=parseInt(getComputedStyle(c.firstElementChild).getPropertyValue("line-height"),10),k=parseInt(getComputedStyle(c.firstElementChild).getPropertyValue("padding-top"),10),T=w.getBoundingClientRect(),v=E.top-T.top-gy/2,I=E.left-T.left-10*o-gy,j=((x=J.blocks[F.parentId])==null?void 0:x.type)===m.BlockType.QUOTE,S={top:v+k+C/2,left:I-(n?w6+2:2)-(j?20:0)};return b&&(S.top=v+Si/2),F.type===m.BlockType.COLLECTION_VIEW&&(S.top=v+15),{blockListContainer:l,style:{transform:"translate(".concat(S.left,"px, ").concat(S.top,"px)")}}}}else{const F=-10*o-gy,w={top:c.getBoundingClientRect().top-i.getBoundingClientRect().top-gy/2+Si/2,left:F-(n?w6+2:2)};return{blockListContainer:l,style:{left:"0px",top:"0px",transform:"translate(".concat(w.left,"px, ").concat(w.top,"px)")}}}},H$=(e,t)=>{const n=e.left,s=e.top,a=e.left+e.width,o=e.top+e.height,i=t.left,l=t.top,c=t.left+t.width,d=t.top+t.height;return(c-n)*(i-a)<0&&(d-s)*(l-o)<0},z$=(e,t)=>{const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),i=a-s,l=o-n;if(s<a&&n<o){const c=t.width*t.height,u=i*l/c;return Number(u.toFixed(4))}return 0},Kbe=e=>({x:e.left+e.width*.5,y:e.top+e.height*.5});function Ybe(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}const C6=50,_y=5,k6=5,{autoScroll:Xbe,raf:T6}=RV(),Qbe=()=>{const e=Ho(),t=ng(),n=bw(),s=Un(),a=n||t||e||s===wt.PAGE_LITE_PREVIEW,o=y.useRef(null),i=y.useRef(),[l,c]=y.useState(),d=Ln(),u=lt();return y.useEffect(()=>{if(a)return;const f=bn(".next-space-page",d);if(!f)return;const h=()=>{i.current=void 0,o.current=null,c(void 0),cancelAnimationFrame(T6.id),Ht.removeEventListener("mousemove",g),Ht.removeEventListener("mouseup",h)},p=x=>{if(xt.$blockMenuListId||x.button!==0||document.querySelector('[data-modal-id="SETTING"]'))return;const F=x.target;if(x3(F,E=>!!E.closest("[data-disable-select], [data-draggable], [data-property-id], [data-ignore-draggable]")))return;const w=d?".right-panel":".main-panel";o.current=F.closest("".concat(w," [data-block-id]")),i.current=[x.clientX,x.clientY,f.scrollTop],Ht.addEventListener("mousemove",g),Ht.addEventListener("mouseup",h)},g=x=>{const F=i.current&&Math.abs(i.current[0]-x.clientX)<k6&&Math.abs(i.current[1]-x.clientY)<k6;if(!(!i.current||F||J.ui.selectedCells.length>0)){if(o.current){const b=o.current.getBoundingClientRect(),w=o.current.dataset.blockId,E=u===w,C=w&&J.blocks[w];let k=!1;C&&(C==null?void 0:C.type)===m.BlockType.COLLECTION_VIEW&&(k=!0);const T=b.left-(k?_y:C6),v=b.right+(k?_y:C6),I=b.top-_y,j=b.bottom+_y;if(!k&&(E||x.clientX>T&&x.clientX<v)&&x.clientY>I&&x.clientY<j)return}o.current=null,window.getSelection().removeAllRanges(),document.dispatchEvent(new Event("_clearTextSelection")),Xbe(x.clientX,x.clientY,f),c([x.clientX,x.clientY,f.scrollTop])}},_=()=>{c(x=>{if(!x)return x;const[F,b]=x;return[F,b,f.scrollTop]})};return f.addEventListener("scroll",_),f.addEventListener("mousedown",p),()=>{i.current=void 0,cancelAnimationFrame(T6.id),f.removeEventListener("scroll",_),f.removeEventListener("mousedown",p),Ht.removeEventListener("mouseup",h),Ht.removeEventListener("mousemove",g)}},[d,a]),y.useMemo(()=>{if(!i.current||!l)return;const[f,h,p]=i.current,[g,_,x]=l,F=x-p,b=h-F,w=Math.min(f,g),E=Math.min(b,_),C=Math.abs(_-b),k=Math.abs(g-f);return{top:E,left:w,width:k,height:C}},[l])},Di=({type:e="page"})=>{const t=_5(),n=ng(),a=bw()||n,o=Ln(),i=Qbe(),l=y.useRef(new Map),c=Un(),d=c===wt.MAIN||c===wt.SHARE,u=y.useCallback(()=>{J.ui.selectedBlocks.length===0&&J.ui.selectedCells.length===0||$u()},[]);kk(()=>{(()=>{var L,O,$,M;if(!d)return;const p=document.getElementById("root");if(!i||a){st({$isSelecting:!1}),p==null||p.classList.remove("selecting"),l.current=new Map;return}xt.$isSelecting||(st({$isSelecting:!0}),p==null||p.classList.add("selecting"),l.current=new Map,Co());const{blocks:g}=J,_=bn("[data-page-id]",o);if(!_)return;const x=(L=_.firstElementChild)==null?void 0:L.getBoundingClientRect();if(!x)return;const{pageId:F}=_.dataset;let b=[],w=[];const E=[],C=b0(".block-content [data-block-id]",o),{collectionViews:k}=pe(),T=l.current,v=document.createDocumentFragment();for(const U of C){const{blockId:z,viewId:K,groupValue:W,subGroupValue:Y,syncId:G,mindMapId:ee}=U.dataset;if(!z||ee)continue;const te=K&&((O=k[K])==null?void 0:O.type)===m.CollectionViewType.CALENDAR,Q=T.get(z);if(!Q||te||W){const ne=U.getBoundingClientRect(),se={left:ne.left,width:ne.width,height:ne.height,offsetTop:ne.top-x.top,viewId:K,groupValue:W,subGroupValue:Y,syncId:G};Q?T.set(z,vL(Q.concat(se),In)):T.set(z,[se]),v.appendChild(U.cloneNode(!0))}}let I,j,S,D;for(const[U,z]of l.current){let K=!1,W;const Y=[];if(z.forEach((ne,se)=>{const ce={left:ne.left,top:x.top+ne.offsetTop,width:ne.width,height:ne.height};se===0&&(W=ce),H$(ce,i)&&(Y.push(ne),K=!0)}),!K||!W)continue;const G=g[U];if(!G||G.type===m.BlockType.COLUMN_LIST)continue;const ee=g[G.parentId];if(!ee)continue;(!I||W.top<I)&&(I=W.top,S=G),(!j||W.top>j)&&(j=W.top,D=G);const te=Y[0];if(!te)return;const Q={blockId:U,viewId:te.viewId,syncId:te.syncId};if(te.groupValue){const ne={};Y.forEach(se=>{var ae;const{groupValue:ce}=se;if(ce){const de=(ae=ne[ce!=null?ce:""])!=null?ae:[];ne[ce]=se.subGroupValue?de.concat(se.subGroupValue):de}}),Q.groupValues=ne}ee.type===m.BlockType.COLUMN?w.push(Q):b.push(Q),E.push(U)}if(!S||!D){u();return}if(e==="page"){let U=t(S.uuid);S.type===m.BlockType.REFERENCE_COLLECTION&&(U=t((M=($=S.data.ref)==null?void 0:$.uuid)!=null?M:"")),U.has(D.uuid)?(b=b.filter(z=>{const K=g[z.blockId];return(K==null?void 0:K.parentId)===(D==null?void 0:D.parentId)}),w=w.filter(z=>{const K=g[z.blockId];return(K==null?void 0:K.parentId)===(D==null?void 0:D.parentId)})):b=b.filter(z=>{const K=g[z.blockId];return(K==null?void 0:K.parentId)===F})}const A=[...b,...w].reduce((U,z)=>(U[z.blockId]=z,U),{}),P=E.map(U=>A[U]).filter(U=>{if(!U)return!1;const z=J.blocks[U.blockId],K=z==null?void 0:z.parentId;if(K){const W=J.blocks[K];if(W&&ga(W.type)){const{role:Y}=mn(U.blockId);return Y!==m.PermissionRole.READER}}return!0});In(P,J.ui.selectedBlocks)||re(at.updateSelectBlocks(P))})()},[t,i,a,e,o,d,u],{wait:20});const f=y.useMemo(()=>{var h;if(o&&(i!=null&&i.left)&&!TL){const p=(h=document.querySelector(".main-panel .next-space-page"))==null?void 0:h.getBoundingClientRect().right;return p?i.left-p:void 0}return i==null?void 0:i.left},[o,i==null?void 0:i.left]);return d?r.jsx("div",{style:{...i,left:f,zIndex:1e3},className:"fixed bg-active_color opacity-[0.12] pointer-events-none"}):null},_2=e=>Ce(({collectionViews:t})=>{var s;const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.BOARD&&((s=n.format.boardGroupBy)==null?void 0:s.enableBoardColorColumns)!==!1},[e]),Jbe=(e,t=!1)=>Ce(({collectionViews:n})=>{var a,o;const s=n[e];return(s==null?void 0:s.type)===m.CollectionViewType.BOARD&&!t?((a=s.format.boardGroupBy)==null?void 0:a.hideEmptyGroups)===!0:((o=s==null?void 0:s.format.collectionGroupBy)==null?void 0:o.hideEmptyGroups)===!0},[e,t]),Zbe={[m.CollectionViewType.TABLE]:"table_bottom",[m.CollectionViewType.BOARD]:"kanban_bottom",[m.CollectionViewType.GALLERY]:"gallary",[m.CollectionViewType.TIMELINE]:"timeline",[m.CollectionViewType.CALENDAR]:"calendar",[m.CollectionViewType.FORM]:"form",[m.CollectionViewType.LIST]:"list",[m.CollectionViewType.SPACE]:""},mf=e=>{const{where:t,groupName:n,subGroupName:s,color:a}=e,{viewId:o,viewType:i,readonly:l,managerReadonly:c}=Ne(),d=Mi({ignoreSorters:!0}),u=Ho();if(l||c||!i)return null;const f=i===m.CollectionViewType.BOARD,h=i===m.CollectionViewType.TABLE,p=i===m.CollectionViewType.GALLERY,g=i===m.CollectionViewType.TIMELINE,_=i===m.CollectionViewType.LIST,x=F=>{me.event("bitable_record_create",{from_scene:Zbe[i]});const b=Ig({viewId:o,groupValue:n,subGroupValue:s,isNewRecord:!0});d({viewId:o,where:t,propertyValues:b,from:g?gx.TIMELINE_TABLE:void 0}),F.currentTarget.blur()};return r.jsxs("button",{className:R("relative text-grey4 space-x-1 flex w-full print:hidden",{"h-[36px] min-w-max flex-1 items-center border-b duration-150":h||g,"h-[38px] items-center rounded-md":f,"min-h-[38px] items-center justify-center next-modal shadow-modal-sm":p,"h-9 items-center rounded-md":_,"animate-hover-black3 animate-click":!u}),onClick:x,style:{color:cB(a)},children:[h&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"sticky left-0 flex flex-shrink-0 items-center space-x-1",style:{height:Si-1},children:[r.jsx(V,{size:"middle",name:"IcAddBoard"}),r.jsx("span",{className:"text-t2",children:"创建记录"})]}),r.jsx("div",{className:"w-12 flex-1"})]}),!h&&r.jsxs(r.Fragment,{children:[r.jsx(V,{size:"middle",name:"IcAddBoard"}),r.jsx("span",{className:"text-t2",children:"创建记录"})]})]})},q$=()=>{const e=({viewId:t,groupName:n,visible:s,isSubGroup:a})=>{var p,g;const{view:o,groups:i,subGroups:l,subGroupBy:c,groupBy:d}=(p=gn(t))!=null?p:{},u=(o==null?void 0:o.type)===m.CollectionViewType.BOARD,f=(g=a?l:i)==null?void 0:g.map(_=>!_.value&&!n||_.value===n?{..._,visible:s,emptyHidden:s&&(a?c!=null&&c.hideEmptyGroups:d!=null&&d.hideEmptyGroups)?!1:_.emptyHidden}:_),h=u&&!a;Rt(t,{["".concat(h?"boardGroups":"collectionGroups")]:f})};return y.useCallback(e,[])},eFe=({visible:e,groupName:t,isSubGroup:n,showDragButton:s})=>{const{viewId:a,isLocked:o}=Ne(),i=q$();return r.jsxs("div",{className:R("text-t2 animate-hover flex h-8 cursor-pointer items-center justify-between pr-3",s?"pl-3":"pl-4"),children:[r.jsxs("div",{className:"flex flex-1 items-center overflow-hidden",children:[s&&r.jsx("div",{className:"mr-1 flex h-5 w-5 items-center justify-center",children:r.jsx(V,{size:"normal",name:"IcMenu",className:"text-grey4"})}),r.jsx(vE,{isSubGroup:n,groupName:t,scene:Y0.GROUP_LIST})]}),r.jsx("button",{className:R("h-5 w-5",o&&"cursor-not-allowed opacity-20"),onClick:()=>{o||i({viewId:a,groupName:Qo(t),visible:!e,isSubGroup:n})},children:r.jsx(V,{name:e?"IcHide":"IcShow",size:"middle"})})]})},tFe=()=>{const e=(t,n,s=!1)=>{var p,g;const a=gn(t);if(!a)return;const{view:o,collection:i,groupBy:l,subGroupBy:c}=a,d=s?c:l;let u={property:n,hideEmptyGroups:d==null?void 0:d.hideEmptyGroups,enableBoardColorColumns:d==null?void 0:d.enableBoardColorColumns};switch((g=(p=i.data.schema)==null?void 0:p[n])==null?void 0:g.type){case m.CollectionSchemaType.NUMBER:{u={...u,start:0,end:1e3,size:100,sort:m.GroupSortType.ASCENDING};break}case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:{u={...u,groupLevel:m.GroupLevel.EXACT,sort:m.GroupSortType.ASCENDING};break}case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:{u={...u,groupLevel:m.GroupLevel.RELATIVE,sort:m.GroupSortType.ASCENDING};break}case m.CollectionSchemaType.RELATION:{u={...u,sort:m.GroupSortType.ASCENDING};break}}const h=o.type===m.CollectionViewType.BOARD&&!s;Rt(t,{["".concat(h?"boardGroupBy":"collectionGroupBy")]:u,["".concat(h?"boardGroups":"collectionGroups")]:[]})};return y.useCallback(e,[])},nFe=({isSubGroup:e})=>{var T,v,I;const{viewId:t,viewType:n,isLocked:s,collectionId:a}=Ne(),o=_2(t),i=Jbe(t,e),l=rf(t,e),c=sf(t,e),d=ie(),u=lt(),f=n===m.CollectionViewType.BOARD,h=j=>{s||d.dropdown({popcorn:j.currentTarget,placement:"bottom-end",content:()=>r.jsx(sFe,{isSubGroup:e})})},p=j=>{s||d.dropdown({popcorn:j.currentTarget,placement:"bottom-end",content:()=>r.jsx(rFe,{isSubGroup:e})})},g=j=>{if(s)return;const S=Pu(a,l==null?void 0:l.property);d.dropdown({popcorn:j.currentTarget,placement:"bottom-end",content:()=>S===m.CollectionSchemaType.NUMBER?r.jsx(oFe,{isSubGroup:e}):r.jsx(aFe,{isSubGroup:e})})},_=j=>{var ee;if(s)return;const{groups:S=[],subGroups:D=[],view:A}=(ee=gn(t))!=null?ee:{};if(!A)return;const{sortedRecordIds:P}=Jc({viewId:t,pageId:u}),{blocks:L,collectionViews:O,users:$}=pe(),M=kE({blocks:L,collectionViews:O,users:$,viewId:t,sortedRecordIds:P});if(!M)return;const{groups:U=[],withoutValidGroup:z,subGroups:K=[]}=M;if(!e&&z)return;const W=e?K:U;let Y=[];if(j){const te=new Set;W.forEach(Q=>{Q.recordIds.length===0&&te.add(Q.value)}),Y=(e?D:S).map(Q=>Q.value&&te.has(Q.value)||!Q.value&&te.has(bm)?{...Q,emptyHidden:!0}:{...Q,emptyHidden:void 0})}else Y=(e?D:S).map(te=>({...te,emptyHidden:void 0}));const G={};f&&!e?(G.boardGroups=Y,G.boardGroupBy={...A.format.boardGroupBy,hideEmptyGroups:j}):(G.collectionGroups=Y,G.collectionGroupBy={...A.format.collectionGroupBy,hideEmptyGroups:j}),Rt(t,G)},x=j=>{s||Rt(t,{boardGroupBy:{...l,enableBoardColorColumns:j}})},F=Pu(a,l==null?void 0:l.property);let b;if(F==="date"||F==="number"||F==="text"){const j=ej[F],S=j.find(D=>D.type===(l==null?void 0:l.sort));S?b=S.name:b=(T=j.find(D=>D.type===m.GroupSortType.ASCENDING))==null?void 0:T.name}let w;if(F==="number"){const{start:j,end:S}=rF(l);w="".concat(j," 到 ").concat(S)}else if(F==="date"||F==="text"&&(c==null?void 0:c.type)!==m.CollectionSchemaType.RELATION){const j=q0[F],S=j.find(D=>D.type===(l==null?void 0:l.groupLevel));if(S)w=S.name;else{const D=F==="date"?m.GroupLevel.RELATIVE:m.GroupLevel.EXACT;w=(v=j.find(A=>A.type===D))==null?void 0:v.name}}let E="无";W0(a).includes((I=l==null?void 0:l.property)!=null?I:"")&&(c!=null&&c.name)&&(E=c.name);const C=[{name:"分组条件",onClick:h,value:E},{name:"分组方式",onClick:g,value:w},{name:"排序",onClick:p,value:b}],k=[{name:"隐藏无记录分组",onSwitch:_,value:i,visible:!!(l!=null&&l.property)},{name:"分组颜色",onSwitch:x,value:o,visible:f&&!e&&((c==null?void 0:c.type)===m.CollectionSchemaType.SELECT||(c==null?void 0:c.type)===m.CollectionSchemaType.MULTI_SELECT)}];return r.jsxs("div",{className:"px-4",children:[C.map(({name:j,onClick:S,value:D})=>D?r.jsxs("div",{className:"flex h-10 items-center justify-between",children:[r.jsx("span",{className:"text-t2 flex-shrink-0",children:j}),r.jsxs("div",{className:R("ml-2 flex cursor-pointer items-center text-ellipsis",s&&"cursor-not-allowed"),onClick:S,children:[r.jsx("span",{className:"text-t2 mr-2 text-ellipsis text-grey3",children:D}),r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall"})]})]},j):null),k.map(({name:j,onSwitch:S,value:D,visible:A})=>A?r.jsxs("div",{className:"flex h-10 w-full items-center justify-between",children:[r.jsx("span",{className:"text-t2",children:j}),r.jsx(en,{open:D,onSwitch:S,disabled:s})]},j):null)]})},sFe=({isSubGroup:e})=>{const{viewId:t,viewType:n,collectionId:s}=Ne(),a=tFe(),o=ft(s,f=>f==null?void 0:f.data.schema),i=rf(t,e),[l,c]=y.useState(i==null?void 0:i.property),d=Ce(f=>W0(s,f),[s]);if(!o)return null;const u=[];return d.forEach(f=>{var p;const h=o[f];h&&h.type!==m.CollectionSchemaType.ID_NUMBER&&u.push({type:H.OPERATION,data:{title:(p=o[f])==null?void 0:p.name,propertyId:f,icon:r.jsx(V,{name:un[h.type],size:"middle"}),hasArrow:l===f,arrow:r.jsx(V,{name:"IcCheck02",size:"normal"})}})}),(n!==m.CollectionViewType.BOARD||e)&&u.unshift({type:H.OPERATION,data:{title:"无",hasArrow:typeof l>"u",arrow:r.jsx(V,{name:"IcCheck02",size:"normal"})}}),r.jsx(ze,{className:"next-modal-scroll w-[160px] py-[5px]",items:u,onItemClick:f=>{const{propertyId:h}=f.data;h!==l&&(c(h),a(t,h,e))}})},rFe=({isSubGroup:e})=>{const{viewId:t,viewType:n,collectionId:s}=Ne(),a=rf(t,e),o=n===m.CollectionViewType.BOARD,i=Pu(s,a==null?void 0:a.property);if(i!=="date"&&i!=="number"&&i!=="text")return null;const l=ej[i],c=G0(i,a==null?void 0:a.sort),d=l.map(u=>({type:H.OPERATION,data:{title:u.name,sort:u.type,arrow:r.jsx(V,{name:"IcCheck02",size:"normal"}),hasArrow:c===u.type}}));return r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:d,onItemClick:u=>{const{sort:f}=u.data;(a==null?void 0:a.sort)!==f&&Rt(t,{[o&&!e?"boardGroupBy":"collectionGroupBy"]:{...a,sort:f}})}})},aFe=({isSubGroup:e})=>{const{viewId:t,viewType:n,collectionId:s}=Ne(),a=rf(t,e),o=Pu(s,a==null?void 0:a.property);if(o!=="date"&&o!=="text")return null;const i=q0[o],l=op(o,a==null?void 0:a.groupLevel),c=i.map(d=>({type:H.OPERATION,data:{title:d.name,groupLevel:d.type,arrow:r.jsx(V,{name:"IcCheck02",size:"normal"}),hasArrow:l===d.type}}));return r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:c,onItemClick:d=>{const{groupLevel:u}=d.data,f=n===m.CollectionViewType.BOARD&&!e;(a==null?void 0:a.groupLevel)!==u&&Rt(t,{[f?"boardGroupBy":"collectionGroupBy"]:{...a,groupLevel:u},[f?"boardGroups":"collectionGroups"]:[]})}})},oFe=({isSubGroup:e})=>{const{viewId:t,viewType:n}=Ne(),s=rf(t,e),{run:a}=Zv((c,d)=>{const u=n===m.CollectionViewType.BOARD&&!e;Rt(t,{[u?"boardGroupBy":"collectionGroupBy"]:{...s,[d]:parseFloat(c)||1},[u?"boardGroups":"collectionGroups"]:[]})}),{start:o,end:i,size:l}=rF(s);return r.jsxs("div",{className:"next-modal w-[300px] py-1.5",children:[r.jsx("div",{className:"text-t2 flex h-10 items-center pl-4 text-grey3",children:"分组范围"}),r.jsxs("div",{className:"flex h-10 items-center justify-between px-4 py-2",children:[r.jsx(Ct,{className:"h-8 w-[120px]",style:{backgroundColor:"transparent"},onChange:c=>a(c,"start"),defaultValue:o,inputType:"number"}),r.jsx(Ct,{className:"h-8 w-[120px]",style:{backgroundColor:"transparent"},onChange:c=>a(c,"end"),defaultValue:i,inputType:"number"})]}),r.jsx("div",{className:"text-t2 flex h-10 items-center pl-4 text-grey3",children:"每个分组间隔"}),r.jsx("div",{className:"flex h-10 items-center px-4 py-2",children:r.jsx(Ct,{style:{backgroundColor:"transparent"},className:" h-8 w-full",onChange:c=>a(c,"size"),defaultValue:l,inputType:"number"})}),r.jsxs("div",{className:"text-t2 mx-4 flex items-center text-grey3",children:[o,"到","".concat(Go.sum(o,l)),", ","".concat(Go.sum(o,l)),"到","".concat(Go.sum(o,l*2)),", ..."]})]})},qu=({isSubGroup:e,isFromViewSetting:t})=>{const{viewId:n,viewType:s,isLocked:a}=Ne(),o=x2(),{tableGroups:i}=of(n),l=qN(e);if(!i||!s)return null;const c=b=>{var I;if(a)return;const{groups:w=[],subGroups:E=[]}=(I=gn(n))!=null?I:{},C=s===m.CollectionViewType.BOARD,T=C&&!e?"boardGroups":"collectionGroups",v=C&&e?E:w;Rt(n,{[T]:v.map(j=>({...j,visible:b,emptyHidden:!b}))})},{visibleGroups:d,hiddenGroups:u,visibleSubGroups:f=[],hiddenSubGroups:h=[],withoutValidGroup:p,hasValidSubGroup:g}=i,_=(e?f:d).map(b=>b.value),x=(e?h:u).map(b=>b.value),F=e&&g||!e&&!p;return r.jsxs("div",{className:R("py-[5px]",t?"w-full":"next-modal-scroll w-[400px]"),children:[r.jsxs("div",{className:"text-t2 flex h-10 items-center px-4",children:[r.jsx(V,{className:"mr-1",name:Ga[s],size:"middle"}),r.jsx("span",{className:"mr-2 font-medium",children:wl[s]}),r.jsx("span",{className:"max-w-[140px]",children:e?"子分组设置":"分组设置"})]}),r.jsx(nFe,{isSubGroup:e}),F&&r.jsxs(r.Fragment,{children:[r.jsx(Cr,{className:"mx-4 my-1"}),[_,x].map((b,w)=>{if(b.length===0)return null;const E=w===0;return r.jsxs(y.Fragment,{children:[r.jsxs("div",{className:"flex h-10 items-center justify-between px-4",children:[r.jsx("span",{className:"text-t2 text-grey3",children:E?"可见分组":"隐藏分组"}),r.jsx("button",{className:R("text-t2 text-active_color",a&&"cursor-not-allowed opacity-20"),onClick:()=>c(!E),children:E?"全部隐藏":"全部显示"})]}),r.jsx(br,{virtual:b.length>100,disabled:a||!l,items:b.map(C=>({id:C})),onChange:(C,k)=>o(n,k,e),renderItemContent:({item:C})=>r.jsx(eFe,{groupName:C.id,visible:E,isSubGroup:e,showDragButton:l})})]},w)})]})]})},x2=()=>{const e=(t,{active:n,over:s},a=!1)=>{var g;if(!s||n.id===s.id)return;let o=0,i=0;const{groups:l=[],subGroups:c=[],view:d}=(g=gn(t))!=null?g:{},u=a?c:l,f=Qo(n.id.toString()),h=Qo(s.id.toString());u.forEach((_,x)=>{f===_.value&&(o=x),h===_.value&&(i=x)});const p=(d==null?void 0:d.type)===m.CollectionViewType.BOARD&&!a;Rt(t,{[p?"boardGroups":"collectionGroups"]:Wu(u,o,i)})};return y.useCallback(e,[])},hf=()=>{const{viewType:e}=Ne(),{loadMore:t,showMore:n,autoLoad:s}=Tc();return r.jsxs(r.Fragment,{children:[s&&r.jsx(iFe,{}),n&&r.jsxs("div",{onClick:()=>t(),className:R("w-full h-9 flex items-center text-t2 text-grey4 pl-1 cursor-pointer animate-hover-black3",(e===m.CollectionViewType.TABLE||e===m.CollectionViewType.LIST)&&"border-b"),children:[r.jsx(V,{name:"IcMore",size:"middle",className:"mr-1"}),"展开更多"]})]})},iFe=()=>{const{loadMore:e}=Tc(),{ref:t,inView:n}=Xv({rootMargin:"0px 0px",fallbackInView:!0,trackVisibility:!1,onChange(a){s(a)}}),s=a=>{a&&e(!0)};return y.useEffect(()=>{const a=n?setInterval(()=>{n?e(!0):clearInterval(a)},1e3):"";return()=>{clearInterval(a)}},[n]),r.jsx("div",{ref:t,className:"w-full p-2.5",children:r.jsx($s,{size:"middle"})})},G$=({className:e,groupName:t,isSubGroup:n,before:s})=>{const a=Mi(),{viewId:o,viewType:i}=Ne(),l=()=>{$u(),me.event("bitable_record_create",{from_scene:i===m.CollectionViewType.BOARD&&!n?"kanban_header":"group_header"});const c=Ig({viewId:o,groupValue:n?void 0:t,subGroupValue:n?t:void 0,isNewRecord:!0});a({viewId:o,where:{before:s},propertyValues:c})};return r.jsx(Fe,{popup:"创建新页面",className:R("flex items-center pr-1 transition duration-300",e),children:r.jsx("button",{onClick:l,className:"animate-hover flex cursor-pointer items-center rounded-sm",children:r.jsx(V,{name:"IcAddBoard",size:"middle"})})})},lFe=()=>{const e=Oe(),t=(n,s,a)=>{var _,x;const{view:o,collection:i,groups:l=[],subGroups:c=[],groupBy:d,subGroupBy:u}=(_=gn(n))!=null?_:{};if(!i||!o)return;const f=a?u==null?void 0:u.property:d==null?void 0:d.property,h=a?c:l,p=a?u:d,g=(x=i.data.schema)==null?void 0:x[f!=null?f:""];!g||!p||!f||e(()=>{var k;const F=h.filter(T=>T.value!==s),b=o.type===m.CollectionViewType.BOARD&&!a;Rs(n,{format:{["".concat(b?"boardGroups":"collectionGroups")]:F}});const w=[],{blocks:E,users:C}=pe();if(i.subNodes.forEach(T=>{C1({blocks:E,users:C,collectionId:i.uuid,recordId:T,groupProperty:f,groupBy:p}).includes(s)&&w.push(T)}),w.length>0&&gr(w),g.type===m.CollectionSchemaType.SELECT||g.type===m.CollectionSchemaType.MULTI_SELECT){const T=(k=g.options)==null?void 0:k.filter(v=>v.value!==s);_e(i.uuid,{data:{schema:{...i.data.schema,[f]:{...g,options:T}}}})}})};return y.useCallback(t,[e])},p4=({groupName:e,visible:t=!0,className:n,isSubGroup:s})=>{const a=ie(),{readonly:o,managerReadonly:i,isLocked:l}=Ne(),c=d=>{a.dropdown({popcorn:d.currentTarget,placement:"bottom",content({onCloseModal:u}){return r.jsx(cFe,{isSubGroup:s,closeModal:u,visible:t,groupName:e})}})};return o||i||l?null:r.jsx("button",{onClick:c,className:R("animate-hover flex h-5 w-5 cursor-pointer items-center rounded-sm",n),children:r.jsx(V,{name:"IcMore",size:"middle"})})},cFe=({closeModal:e,visible:t,groupName:n,isSubGroup:s})=>{const a=o4(),{collectionId:o,viewId:i}=Ne(),l=lFe(),c=q$(),d=ie(),u=fE(i,Qo(n),s),f=[{type:H.OPERATION,isHidden:!Qo(n),data:{icon:"IcTrash",type:0,title:"删除"}},{type:H.OPERATION,data:{icon:t?"IcHide":"IcShow",type:1,title:t?"隐藏":"显示"}},{type:H.LINE,isHidden:!u,data:{},disableClick:!0}];return r.jsxs("div",{className:"next-modal w-[240px] py-2",children:[r.jsx(ze,{className:"rounded-r",items:f,onItemClick:h=>{h.data.type===0&&Qo(n)&&d.warning({title:r.jsxs("p",{className:"mt-5 mb-10 w-60",children:["是否确定删除分组？",r.jsx("br",{}),"将同时删除分组内的所有记录"]}),confirmText:"删除",confirm(){l(i,n,s),e()}}),h.data.type===1&&(e(),c({viewId:i,groupName:Qo(n),visible:!t,isSubGroup:s}))}}),u&&r.jsx(Vm,{value:u.color,bgColorFn:J1,onSelect:h=>{var x;const{groupBy:p,subGroupBy:g}=(x=gn(i))!=null?x:{},_=s?g==null?void 0:g.property:p==null?void 0:p.property;_&&a(o,_,{id:u.id,color:h})}})]})},dFe=e=>{var d;const t=(d=J.blocks[e])==null?void 0:d.data.schema;if(!t)return;const n=new Set,s=new Set,a={},o=(u,f)=>{u.forEach(h=>{var g,_;n.has(h.type)||(n.add(h.type),s.add({...h,subItems:[]}));const p=(g=a[h.type])!=null?g:[];a[h.type]=p,(_=h.subItems)==null||_.forEach(x=>{x.schemas||(x.schemas=[]),x.schemas.push(f),p==null||p.push(x)})})},i=UT(e,"title");i.shift(),o(i,{...t.title,propertyId:"title"}),Object.entries(t).forEach(([u,f])=>{if(u==="title")return;const h=UT(e,u);h.shift(),o(h,{...f,propertyId:u})});const l=[],c={};return s.forEach(u=>{const f=a[u.type];if(f){const h=Rr.reduce(f,(p,g)=>{var x;const _=c[g.title+g.type];return _?g.schemas&&((x=_.schemas)==null||x.push(...g.schemas)):(c[g.title+g.type]=g,p.push(g)),p},[]);u.subItems=h}l.push(u)}),l},uFe=(e,t,n)=>{const s=dFe(e);return s==null?void 0:s.map(o=>({type:H.OPERATION,data:{title:o.title,hasArrow:!0,renderSubMenu:()=>{var c,d;const l=(d=(c=o.subItems)==null?void 0:c.map(u=>{const f=u.type===m.AggregationAction.COUNT_ALL;return{type:H.OPERATION,data:{...u,selected:f&&t.aggregation===m.AggregationAction.COUNT_ALL,hasArrow:!f,onClick:()=>{f&&n(u.type)},renderSubMenu:f?void 0:()=>{var g,_;const p=(_=(g=u.schemas)==null?void 0:g.map(x=>({type:H.OPERATION,data:{selected:t.aggregation===u.type&&t.propertyId===x.propertyId,title:x.name,onClick:()=>{n(u.type,x)}}})))!=null?_:[];return r.jsx(ze,{className:"w-[200px] py-2 next-modal",items:p})}}}}))!=null?d:[];return r.jsx(ze,{className:"w-[200px] py-2 next-modal",items:l})}}}))},W$=e=>{var p;const{recordIds:t,groupbyFieldName:n="collectionGroupBy"}=e,s=ie(),{collectionId:a,viewId:o,readonly:i}=Ne(),l=vs(o),c=(p=l==null?void 0:l.format)==null?void 0:p[n],d=Ce(()=>{var b;if(!c)return m.AggregationAction.COUNT_ALL;const g=c==null?void 0:c.aggregationPeopertyId;if(!g)return m.AggregationAction.COUNT_ALL;const _=c.aggregation,F=EE(a,g).find(w=>w.type===_&&_!==m.AggregationAction.NONE);return(b=F==null?void 0:F.type)!=null?b:m.AggregationAction.COUNT_ALL},[o,l]),u=Ce(g=>{var b,w;if(!c)return;const _=c==null?void 0:c.aggregationPeopertyId;if(!_)return"";const x=g.blocks[a],F=(b=x==null?void 0:x.data.schema)==null?void 0:b[_];return(w=F==null?void 0:F.name)!=null?w:""},[a,o,l,d]),f=Ce(g=>{if(!c)return;const _=c==null?void 0:c.aggregationPeopertyId;if(!_)return t.length;const{propertySchema:x,targetPropertySchema:F}=ii(a,_);if(!d||!x)return;const{aggregation:b,type:w}=x!=null?x:{},{blocks:E}=g,C=$n(a),k=JN(t.map(I=>E[I]).filter(I=>!!I),_,d,a,C),T=k==null?void 0:k.result,v=(I,j)=>(I==null?void 0:I.type)===m.CollectionSchemaType.NUMBER&&I.numberFormat&&typeof j<"u"||(I==null?void 0:I.type)===m.CollectionSchemaType.FORMULA&&C.getType(_)===et.ValueTool.numberType&&I.numberFormat&&typeof j<"u"?hl(Number(j),I.numberFormat):j;return w===m.CollectionSchemaType.ROLLUP?Qc(d)&&Qc(b)?v(F,T):T:Qc(d)?v(x,T):T},[o,t,d,l],{ignoreOtherData:!1}),h=g=>{var b;if(i)return;const _=zv();if(!gn(o))return;const F=uFe(a,{propertyId:c==null?void 0:c.aggregationPeopertyId,aggregation:(b=c==null?void 0:c.aggregation)!=null?b:m.AggregationAction.COUNT_ALL},(w,E)=>{Rt(o,{[n]:{...c,aggregationPeopertyId:E==null?void 0:E.propertyId,aggregation:w}}),s.closeModal(_)});F&&s.dropdown({modalId:_,popcorn:g.currentTarget,placement:"bottom",content:()=>r.jsx(ze,{className:"w-[200px] py-2 next-modal",items:F})})};return r.jsx(Cs,{popup:"".concat(u," ").concat(pn[d]),children:r.jsx("span",{className:"text-t2 mx-1.5 text-grey4 animate-hover px-1.5",style:e.style,onClick:h,children:f})})},K$=({recordIds:e,groupName:t,listeners:n,isSubGroup:s})=>{Pa();const{viewId:a,readonly:o,managerReadonly:i}=Ne(),l=_2(a),c=fE(a,Qo(t)),d=Bi(a),u=Li(a),f={color:l?cB(c==null?void 0:c.color):void 0},h={color:l?rJ(c==null?void 0:c.color):void 0},p={width:ji(d,u)+10,backgroundColor:l?h3(c==null?void 0:c.color):void 0};return r.jsxs("div",{...n,"data-disable-select":!0,style:p,className:R("z-10 flex h-[50px] items-center px-[5px] pt-2.5 pb-2",s?"mr-2.5 rounded-md":"rounded-t-md",l&&"bg-grey/5",s&&"group bg-grey/5"),children:[r.jsx("div",{className:"flex items-center text-ellipsis pl-1",style:{maxWidth:"calc(100% - 100px)"},children:r.jsx(vE,{groupName:t,scene:Y0.GROUP_HEADER})}),r.jsx(W$,{groupbyFieldName:"boardGroupBy",recordIds:e,style:h}),r.jsxs("div",{className:"hover-button ml-auto flex items-center text-grey4 opacity-0 transition-all duration-200 group-hover:opacity-100",style:f,children:[r.jsx(p4,{className:"mr-1",groupName:t}),o||i?null:r.jsx(G$,{groupName:t,before:e[0]})]})]})},fFe=({progress:e=0})=>e<0?null:r.jsx("div",{className:"absolute top-0 right-0 z-10 flex justify-end w-full h-full bg-black1/70",children:r.jsxs("div",{className:"flex flex-row items-center w-[63px] h-7.5 px-1.5 mr-2.5 mt-2.5 rounded-sm bg-black/75 dark:text-black",children:[r.jsx($s,{size:"middle"}),r.jsxs("div",{className:"text-white1 text-t4",children:[e,"%"]})]})}),Y$=y.memo(e=>{var l;const{uuid:t,showLoading:n=!0,src:s,...a}=e,o=hc(t),i=(l=o==null?void 0:o.progress)!=null?l:-1;return r.jsxs(r.Fragment,{children:[n&&o&&o.status===is.uploading&&r.jsx(fFe,{progress:i}),r.jsx(KI,{src:s,draggable:!1,...a})]})},yn),mFe=["study","team","work","tech"],hFe=({blockId:e,selectImage:t,deleteCoverImage:n})=>{const[s,a]=y.useState([]),[o,i]=y.useState([]),l=Uo(),c=ln(),[d,u]=y.useState("");y.useEffect(()=>{(async()=>{const g=await ve.editor.getCoverImageList();a(g)})()},[]);const f=y.useMemo(()=>qn(async g=>{var x;const _=await ve.infra.getExternalUrlList({search:g,source:"unsplash"});_&&i([{groupName:"图片来源于 Unsplash",list:((x=_.results)==null?void 0:x.map(F=>{var b,w,E,C,k,T;return{ossName:(b=F.name)!=null?b:"",author:(w=F.name)!=null?w:"",description:(E=F.name)!=null?E:"",illegal:!1,url:(C=F.raw)!=null?C:"",download:(k=F.links)==null?void 0:k.download_location,html:(T=F.html)!=null?T:""}}))||[]}])},200),[]);y.useEffect(()=>{var g;f(d||((g=mFe[Date.now()%4])!=null?g:""))},[f,d]);const h=g=>t({ossName:g,type:"click"}),p=g=>{be.loading({key:"uploadCover",content:"上传中"}),c(Ve.HEADER_COVER_IMAGE),l({file:g,key:e,searchType:"cover",type:"file",onComplete(_){_.success&&(t({ossName:_.ossName,type:"upload",file:g}),be.success("上传完成"),be.closeMessage("uploadCover"))}})};return r.jsxs(xg,{className:"next-modal w-[534px] overflow-y-auto",customButtons:()=>n&&r.jsxs("div",{className:"animate-hover mr-2 flex cursor-pointer items-center rounded py-1.5 px-1",onClick:n,children:[r.jsx(V,{size:"middle",name:"MIcClear"}),r.jsx("div",{className:"text-t2 text-grey3",children:"清除"})]}),children:[r.jsx(Zr,{title:"图库",children:r.jsx("div",{className:"max-h-[35vh] overflow-y-auto px-3 py-1",children:s.map(g=>{var _;return r.jsxs("div",{children:[r.jsx("div",{className:"text-grey3 text-t2 flex h-9 items-center",children:g.groupName}),r.jsx("div",{className:"grid grid-cols-4 gap-2",children:(_=g.list)==null?void 0:_.map((x,F)=>r.jsx(gT,{description:x.description,illegal:x.illegal,url:"".concat(x.url,"/resize,w_640/quality,q_80/"),onClick:()=>{x.illegal?be.error("图片无法使用"):h(x.ossName)}},"".concat(x.url).concat(F)))})]},g.groupName)})})}),r.jsx(Zr,{title:"上传",children:r.jsx(QO,{tip:"建议上传宽度大于 1500 像素的图片",onSelectImage:g=>{var _;t({ossName:(_=g.ossName)!=null?_:"",type:"click"})},fileType:"cover",onUploadFile:p,style:{height:"35vh"}})}),r.jsx(Zr,{title:"链接",children:r.jsx(pN,{placeholder:"输入图片链接",onInputUrl:g=>t({type:"http",url:g})})}),r.jsx(Zr,{icon:"IcUnsplash",title:"Unsplash",children:r.jsxs("div",{className:"max-h-[35vh] overflow-y-auto px-3 py-1",children:[r.jsx("div",{className:"bg-grey8 text-t2 border-grey6 my-4 flex w-full items-center rounded-sm border",children:r.jsx("input",{spellCheck:!1,placeholder:"搜索图片...",className:"text-t2 h-7.5 placeholder-grey4 w-full flex-grow cursor-text bg-transparent px-2 align-middle text-black outline-none",value:d,onChange:g=>{const _=g.target.value.trim();u(_)}})}),o.map(g=>{var _,x;return r.jsxs("div",{children:[r.jsx("div",{className:"text-grey3 text-t2 flex h-9 items-center",children:g.groupName}),r.jsx("div",{className:"grid grid-cols-4 gap-2",children:((_=g.list)==null?void 0:_.length)!==0?(x=g.list)==null?void 0:x.map((F,b)=>{var w;return r.jsx(gT,{description:(w=F.description)!=null?w:"",node:r.jsx("a",{href:F.html,target:"_blank",className:"text-ellipsis text-t4 text-grey3 mt-0.5 animate-hover px-1",rel:"noreferrer",children:"by: ".concat(F.author)}),url:"".concat(F.url,"&w=200&q=80"),onClick:()=>{F.illegal?be.error("图片无法使用"):(t({type:"http",url:"".concat(F.url,"&q=80&w=1920")}),F.download&&YP(F.download))}},"".concat(F.url).concat(b))}):r.jsx("div",{className:"text-grey2 my-2",children:"无结果"})})]},g.groupName)})]})})]})},pFe=e=>{const t=y.useRef(null),{onMoveStart:n,onMove:s,onMoveEnd:a,moveContainer:o}=e,i=y.useCallback(d=>{var u,f;s==null||s({deltaX:d.clientX-(((u=t.current)==null?void 0:u.deltaX)||0),deltaY:d.clientY-(((f=t.current)==null?void 0:f.deltaY)||0)}),t.current={deltaX:d.clientX,deltaY:d.clientY}},[s]),l=y.useCallback(()=>{a==null||a(),(o!=null?o:document).removeEventListener("pointermove",i),document.removeEventListener("pointerup",l)},[i,o,a]);return{moveProps:{onPointerDown:y.useCallback(d=>{n==null||n(),d.stopPropagation(),d.preventDefault(),t.current={deltaX:d.nativeEvent.clientX,deltaY:d.nativeEvent.clientY},(o!=null?o:document).addEventListener("pointermove",i),document.addEventListener("pointerup",l)},[n,o,i,l])}}},X$=Mr(!1),Q$=Mr(!1),J$=Mr(null),Xd=new Ai(localStorage,"comment-expand"),gFe=(e,t)=>{Xd.get(e)!==t&&Xd.put(e,t)},y2=e=>{var b;const t=rr(()=>new JE),n=Ce(w=>{var C,k,T,v;if(!((k=(C=w.blocks[e.pageId])==null?void 0:C.discussions)!=null&&k.length))return[];const E=((v=(T=w.blocks[e.pageId])==null?void 0:T.discussions)!=null?v:[]).map(I=>w.discussions[I]).filter(I=>I!=null&&!I.resolved);return E.sort(pi(Hr(I=>I.createdAt))),E},[e.pageId],{wait:500}),s=pt(),a=Pn(),o=YE(e.pageId),i=(a.planType===St.team||a.planType===St.freeTeam)&&o,[l,c]=pp(X$,pr),d=ea(J$,pr),u=lt(),f=We(u,!1,!0),h=Nm(),[p,g]=y.useState((b=Xd.get(e.pageId))!=null?b:!0),_=y.useMemo(()=>{var E;const w=n.find(C=>!C.resolved);return(E=w==null?void 0:w.comments.length)!=null?E:0},[n]);y.useEffect(()=>{const w=()=>{var E;g((E=Xd.get(e.pageId))!=null?E:!0)};return Xd.addChangeListener(w),()=>{Xd.removeChangeListener(w)}},[e.pageId]);const x=s&&h,F=!s&&(i||l)||x;return n.length<=0&&!F?null:r.jsx(ZE,{manager:t,children:r.jsxs("div",{"data-disable-select":!0,className:R("text-t2",{"border-b border-b-grey6 pb-1":p&&!e.isBottom,"border-t border-t-grey6 pt-1 my-5":e.isBottom}),children:[r.jsxs("div",{hidden:_<=0,className:"w-full flex items-center justify-between py-1 px-2 animate-hover my-1",onClick:()=>{Xd.put(e.pageId,!p)},children:[r.jsx("span",{className:"text-t2 text-grey3",children:"页面评论（".concat(_,"）")}),r.jsx(V,{className:"cursor-pointer animate-hover",name:p?"IcArrowHide":"IcArrowShow",size:"middle",onClick:()=>{Xd.put(e.pageId,!p)}})]}),p&&n.map((w,E)=>r.jsx(I1,{hideBlockContext:!0,showReplyEditor:E===n.length-1,readonly:f,allowCommentInSharePage:h,draftKey:"PageOpenDiscussion:".concat(w.uuid),discussionId:w.uuid,autoFocus:d===w.uuid||h,onResolve:()=>{n.length===1&&c(!1)}},w.uuid)),!f&&n.length===0&&F&&r.jsx(_Fe,{draftKey:"PageTempDiscussion:".concat(e.pageId),pageId:e.pageId,autoFocus:!o&&l||x})]})})},_Fe=e=>{const t=Oe(),n=Lg(),s=So(J$,pr),a=o=>{t(()=>{const i=n.addDiscussion({blockId:e.pageId});i!=null&&(s(i),setTimeout(()=>{s(null)},200),n.appendComment({discussionId:i,text:o}))})};return r.jsx("div",{className:R("py-1 px-2",e.className),children:r.jsx(Pj,{draftKey:e.draftKey,autoFocus:e.autoFocus,onComment:a})})},d_=({onClick:e,className:t,icon:n,text:s})=>r.jsxs("div",{onClick:e,className:R("min-w-22.5 whitespace-nowrap cursor-pointer flex items-center mt-1 pl-[3px] pr-1.5 text-t2 text-grey3 rounded animate-hover mb-1 mr-2 h-8 opacity-0 group-hover:opacity-100 transition-opacity",t),children:[r.jsx(V,{size:"middle",name:n,style:{display:"flex"}}),r.jsx("div",{className:"ml-1",style:{display:"block"},children:s})]}),xFe=e=>{const{uuid:t,showDescription:n}=e,s="".concat(t,"_mock"),a=ye(t,["data"],["description","showEmptyDescription"]),o=We(e.uuid),{enableAI:i}=xr(),l=Ui(),c=Ln(),d=Nn(),u=ft(t,h=>fe(h==null?void 0:h.data.description).length>0),f=La(t,"description");return y.useEffect(()=>{a!=null&&a.data.showEmptyDescription&&Lr(s,0,0)},[a==null?void 0:a.data.showEmptyDescription,s]),ot.print||!n?null:a!=null&&a.data.showEmptyDescription||u?r.jsx(ci,{keydownOption:u0e,uuid:s,"data-disable-select":"true",className:"text-t2 break-words whitespace-pre-wrap page-description",placeholder:"在此添加说明",alwaysShowPlaceholder:!0,onKeyDown:h=>{var p;if(i&&Ie("Space")(h)&&!fe((p=a==null?void 0:a.data.description)!=null?p:[])){const g=bn(".page-description",c);if(g){l({popcorn:g,blockId:t,from:ho.ContextMenu,isBitable:!0,editorScene:it.BlockSelected,isDescription:!0});return}}if(Ie(["Enter","Shift+Enter"])(h)){h.preventDefault();const g=d(s,!1);if(!g)return;const{selection:_}=g;if(!(_!=null&&_.isCollapsed))return;g.performChange(x=>{x.delete().insert("\n")})}},readonly:o,segments:a==null?void 0:a.data.description,segmentType:"description",onChange:(h,p,g)=>{f(h,[p,g])},history:!1}):null},g4=y.createContext("quickSetting"),yFe=()=>y.useContext(g4),b2=Mr({hasResult:!1,templates:[]}),_4=e=>{var t;return(t=Dt().customTemplates)==null?void 0:t.includes(e)},bFe=()=>{const e=lt(),t=jd(),n=n9(),s=Oe(),a=zE();return y.useCallback(async(o,i)=>{var g,_;const{from:l,_targetId:c,addCopyLimit:d=!1}=i;await a({ids:[o],spaceId:Ot(),forceAwait:!0,addCopyLimit:d});let u=c!=null?c:n||e;if(l==="quickSetting"||l==="templateBar"){const x=Ot(),F=An(Hw(J.blocks,x)),b=t(m.BlockType.PAGE,{parentId:x,after:F},Ss.PRIVATE);if(!b)return;u=b}let f=(g=J.blocks[o])==null?void 0:g.type;J.blocks[o]||(f=(_=(await ve.editor.getDoc(o)).blocks[o])==null?void 0:_.type);const h=uv(u)&&ga(f),p=uv(u)&&ir(f);if(h||p||f===m.BlockType.FOLDER){const x=ut({},{parentId:u});re(Sa()),u=x}return await mo(async()=>ve.editor.copyTemplate({uuid:o,targetId:u,addCopyLimit:d})),f!==void 0&&h&&s(()=>{f!==void 0&&[m.BlockType.REFERENCE_COLLECTION_PAGE,m.BlockType.REFERENCE_COLLECTION].includes(f)?nr([u],{type:m.BlockType.REFERENCE_COLLECTION}):nr([u],{type:m.BlockType.COLLECTION_VIEW})},{noThrottle:!0}),f!==void 0&&p&&s(()=>{nr([u],{type:m.BlockType.MIND_MAPPING})},{noThrottle:!0}),await Ao(800),u},[a,t,e,n,s])},Z$=()=>{const e=bFe(),t=Js(),n=Ja(),s=ns();return y.useCallback(async(a,o)=>{if(Ju(),!a.id)return;be.loading({key:"templateLoading",content:"正在加载模板...",duration:3e3});const i=await e(a.id,{from:o,_targetId:a.targetId,addCopyLimit:a.addCopyLimit});if(i)return me.event("copy_template",{is_from:a!=null&&a.isCustom?"custom":"new_page",template_id:a.id}),t(Je.GUIDE_FIRST_TIME_COPY_TEMPLATE,ct.basicList),await n(i,{force:!0}),o!=="record"&&s.push("/".concat(i)),be.closeMessage("templateLoading"),i},[e,n,s,t])},qC="active-from",v6=30*1e3;class FFe{constructor(t){q(this,"active",!0);q(this,"timer");q(this,"lastEnterDate");q(this,"request");q(this,"getTimeWithTimeZone",t=>{const n=new Date;let s=n.getTime()+n.getTimezoneOffset()*60*1e3;return s+=t*60*60*1e3,new Date(s)});q(this,"setActive",t=>{this.active=t});q(this,"checkIfSameDay",()=>{var n,s,a;const t=this.getTimeWithTimeZone(8);(((n=this.lastEnterDate)==null?void 0:n.getFullYear())!==t.getFullYear()||((s=this.lastEnterDate)==null?void 0:s.getMonth())!==t.getMonth()||((a=this.lastEnterDate)==null?void 0:a.getDay())!==t.getDay())&&this.reportEnter()});q(this,"reportEnter",async(t={})=>{const n=sessionStorage.getItem(qC)||void 0;sessionStorage.removeItem(qC);let s=5;for(;s>0;)try{await this.request.infra.behaviorReport.raw({topic:"activity",business:{type:"enter",activeFrom:n,...t}}),this.lastEnterDate=this.getTimeWithTimeZone(8);break}catch(a){await wFe(1500),s--}});q(this,"loop",()=>{this.active&&(this.checkIfSameDay(),this.active=!1,this.request.infra.behaviorReport.raw({topic:"activity",business:{type:"active"}}).catch(()=>{})),this.timer=window.setTimeout(this.loop,v6)});this.request=t}setFrom(t){t&&sessionStorage.setItem(qC,t)}start(){this.reportEnter(),this.timer=window.setTimeout(this.loop,v6)}stop(){window.clearTimeout(this.timer)}}const wFe=e=>new Promise(t=>{setTimeout(t,e)}),Dh=new FFe(ve),EFe=()=>{const t=!!Ut().uuid;y.useEffect(()=>{if(!t)return;const n=()=>{Dh.reportEnter()},s=()=>{Dh.setActive(!0)},a=()=>{document.visibilityState==="visible"&&Dh.reportEnter()};return window.addEventListener("visibilitychange",a),window.addEventListener("online",n),window.addEventListener("pointermove",s,{capture:!0}),Dh.start(),()=>{Dh.stop(),window.removeEventListener("visibilitychange",a),window.removeEventListener("online",n),window.removeEventListener("pointermove",s,{capture:!0})}},[t])},CFe={version:1,themeName:"essos",theme:{seriesCnt:"4",titleColor:"#893448",subtitleColor:"#d95850",textColorShow:!1,textColor:"#333",markTextColor:"#ffffff",color:["#893448","#d95850","#eb8146","#ffb248","#f2d643","#ebdba4"],borderColor:"#ccc",borderWidth:0,visualMapColor:["#893448","#d95850","#eb8146","#ffb248","#f2d643","rgb(247,238,173)"],legendTextColor:"#999999",kColor:"#eb8146",kColor0:"transparent",kBorderColor:"#d95850",kBorderColor0:"#58c470",kBorderWidth:"2",lineWidth:"2",symbolSize:"6",symbol:"emptyCircle",symbolBorderWidth:"2",lineSmooth:!0,graphLineWidth:1,graphLineColor:"#aaaaaa",mapLabelColor:"#893448",mapLabelColorE:"#893448",mapBorderColor:"#999999",mapBorderColorE:"#eb8146",mapBorderWidth:.5,mapBorderWidthE:1,mapAreaColor:"#f3f3f3",mapAreaColorE:"#ffb248",axes:[{type:"all",name:"通用坐标轴",axisLineShow:!0,axisLineColor:"#aaaaaa",axisTickShow:!1,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#999999",splitLineShow:!0,splitLineColor:["#e6e6e6"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]},{type:"category",name:"类目坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!1,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"value",name:"数值坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"log",name:"对数坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"time",name:"时间坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}],axisSeperateSetting:!1,toolboxColor:"#999999",toolboxEmphasisColor:"#666666",tooltipAxisColor:"#cccccc",tooltipAxisWidth:1,timelineLineColor:"#893448",timelineLineWidth:1,timelineItemColor:"#893448",timelineItemColorE:"#ffb248",timelineCheckColor:"#eb8146",timelineCheckBorderColor:"#ffb248",timelineItemBorderWidth:1,timelineControlColor:"#893448",timelineControlBorderColor:"#893448",timelineControlBorderWidth:.5,timelineLabelColor:"#893448",datazoomBackgroundColor:"rgba(255,255,255,0)",datazoomDataColor:"rgba(255,178,72,0.5)",datazoomFillColor:"rgba(255,178,72,0.15)",datazoomHandleColor:"#ffb248",datazoomHandleWidth:"100",datazoomLabelColor:"#333"}},kFe={version:1,themeName:"macarons",theme:{seriesCnt:"4",titleColor:"#008acd",subtitleColor:"#aaaaaa",textColorShow:!1,textColor:"#333",markTextColor:"#eeeeee",color:["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],borderColor:"#ccc",borderWidth:0,visualMapColor:["#5ab1ef","#e0ffff"],legendTextColor:"#333333",kColor:"#d87a80",kColor0:"#2ec7c9",kBorderColor:"#d87a80",kBorderColor0:"#2ec7c9",kBorderWidth:1,lineWidth:2,symbolSize:3,symbol:"emptyCircle",symbolBorderWidth:1,lineSmooth:!0,graphLineWidth:1,graphLineColor:"#aaaaaa",mapLabelColor:"#d87a80",mapLabelColorE:"rgb(100,0,0)",mapBorderColor:"#eeeeee",mapBorderColorE:"#444",mapBorderWidth:.5,mapBorderWidthE:1,mapAreaColor:"#dddddd",mapAreaColorE:"rgba(254,153,78,1)",axes:[{type:"all",name:"通用坐标轴",axisLineShow:!0,axisLineColor:"#eeeeee",axisTickShow:!0,axisTickColor:"#eeeeee",axisLabelShow:!0,axisLabelColor:"#eeeeee",splitLineShow:!0,splitLineColor:["#aaaaaa"],splitAreaShow:!1,splitAreaColor:["#eeeeee"]},{type:"category",name:"类目坐标轴",axisLineShow:!0,axisLineColor:"#008acd",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!1,splitLineColor:["#eee"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"value",name:"数值坐标轴",axisLineShow:!0,axisLineColor:"#008acd",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#eee"],splitAreaShow:!0,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"log",name:"对数坐标轴",axisLineShow:!0,axisLineColor:"#008acd",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#eee"],splitAreaShow:!0,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"time",name:"时间坐标轴",axisLineShow:!0,axisLineColor:"#008acd",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#eee"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}],axisSeperateSetting:!0,toolboxColor:"#2ec7c9",toolboxEmphasisColor:"#18a4a6",tooltipAxisColor:"#008acd",tooltipAxisWidth:"1",timelineLineColor:"#008acd",timelineLineWidth:1,timelineItemColor:"#008acd",timelineItemColorE:"#a9334c",timelineCheckColor:"#2ec7c9",timelineCheckBorderColor:"#2ec7c9",timelineItemBorderWidth:1,timelineControlColor:"#008acd",timelineControlBorderColor:"#008acd",timelineControlBorderWidth:.5,timelineLabelColor:"#008acd",datazoomBackgroundColor:"rgba(47,69,84,0)",datazoomDataColor:"#efefff",datazoomFillColor:"rgba(182,162,222,0.2)",datazoomHandleColor:"#008acd",datazoomHandleWidth:"100",datazoomLabelColor:"#333333"}},TFe={version:1,themeName:"roma",theme:{seriesCnt:"4",titleColor:"#333333",subtitleColor:"#aaaaaa",textColorShow:!1,textColor:"#333",markTextColor:"#eeeeee",color:["#e01f54","#001852","#f5e8c8","#b8d2c7","#c6b38e","#a4d8c2","#f3d999","#d3758f","#dcc392","#2e4783","#82b6e9","#ff6347","#a092f1","#0a915d","#eaf889","#6699FF","#ff6666","#3cb371","#d5b158","#38b6b6"],borderColor:"#ccc",borderWidth:0,visualMapColor:["#e01f54","#e7dbc3"],legendTextColor:"#333333",kColor:"#e01f54",kColor0:"#001852",kBorderColor:"#f5e8c8",kBorderColor0:"#b8d2c7",kBorderWidth:1,lineWidth:2,symbolSize:4,symbol:"emptyCircle",symbolBorderWidth:1,lineSmooth:!1,graphLineWidth:1,graphLineColor:"#aaaaaa",mapLabelColor:"#000000",mapLabelColorE:"rgb(100,0,0)",mapBorderColor:"#444444",mapBorderColorE:"#444",mapBorderWidth:.5,mapBorderWidthE:1,mapAreaColor:"#eeeeee",mapAreaColorE:"rgba(255,215,0,0.8)",axes:[{type:"all",name:"通用坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"category",name:"类目坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!1,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"value",name:"数值坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"log",name:"对数坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"time",name:"时间坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}],axisSeperateSetting:!0,toolboxColor:"#999999",toolboxEmphasisColor:"#666666",tooltipAxisColor:"#cccccc",tooltipAxisWidth:1,timelineLineColor:"#293c55",timelineLineWidth:1,timelineItemColor:"#293c55",timelineItemColorE:"#a9334c",timelineCheckColor:"#e43c59",timelineCheckBorderColor:"#c23531",timelineItemBorderWidth:1,timelineControlColor:"#293c55",timelineControlBorderColor:"#293c55",timelineControlBorderWidth:.5,timelineLabelColor:"#293c55",datazoomBackgroundColor:"rgba(47,69,84,0)",datazoomDataColor:"rgba(47,69,84,0.3)",datazoomFillColor:"rgba(167,183,204,0.4)",datazoomHandleColor:"#a7b7cc",datazoomHandleWidth:"100",datazoomLabelColor:"#333333"}},vFe={version:1,themeName:"shine",theme:{seriesCnt:4,titleColor:"#333333",subtitleColor:"#aaaaaa",textColorShow:!1,textColor:"#333",markTextColor:"#eeeeee",color:["#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487"],borderColor:"#ccc",borderWidth:0,visualMapColor:["#1790cf","#a2d4e6"],legendTextColor:"#333333",kColor:"#c12e34",kColor0:"#2b821d",kBorderColor:"#c12e34",kBorderColor0:"#2b821d",kBorderWidth:1,lineWidth:2,symbolSize:4,symbol:"emptyCircle",symbolBorderWidth:1,lineSmooth:!1,graphLineWidth:1,graphLineColor:"#aaaaaa",mapLabelColor:"#c12e34",mapLabelColorE:"#c12e34",mapBorderColor:"#eee",mapBorderColorE:"#ddd",mapBorderWidth:.5,mapBorderWidthE:1,mapAreaColor:"#ddd",mapAreaColorE:"#e6b600",axes:[{type:"all",name:"通用坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"category",name:"类目坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!1,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"value",name:"数值坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"log",name:"对数坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"time",name:"时间坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}],axisSeperateSetting:!0,toolboxColor:"#06467c",toolboxEmphasisColor:"#4187c2",tooltipAxisColor:"#cccccc",tooltipAxisWidth:1,timelineLineColor:"#005eaa",timelineLineWidth:1,timelineItemColor:"#005eaa",timelineItemColorE:"#005eaa",timelineCheckColor:"#005eaa",timelineCheckBorderColor:"#316bc2",timelineItemBorderWidth:1,timelineControlColor:"#005eaa",timelineControlBorderColor:"#005eaa",timelineControlBorderWidth:.5,timelineLabelColor:"#005eaa",datazoomBackgroundColor:"rgba(47,69,84,0)",datazoomDataColor:"rgba(47,69,84,0.3)",datazoomFillColor:"rgba(167,183,204,0.4)",datazoomHandleColor:"#a7b7cc",datazoomHandleWidth:"100",datazoomLabelColor:"#333333"}},IFe={version:1,themeName:"vintage",theme:{seriesCnt:4,titleColor:"#333333",subtitleColor:"#aaaaaa",textColorShow:!1,textColor:"#333",markTextColor:"#eee",color:["#d87c7c","#919e8b","#d7ab82","#6e7074","#61a0a8","#efa18d","#787464","#cc7e63","#724e58","#4b565b"],borderColor:"#ccc",borderWidth:0,visualMapColor:["#bf444c","#d88273","#f6efa6"],legendTextColor:"#333333",kColor:"#c23531",kColor0:"#314656",kBorderColor:"#c23531",kBorderColor0:"#314656",kBorderWidth:1,lineWidth:2,symbolSize:4,symbol:"emptyCircle",symbolBorderWidth:1,lineSmooth:!1,graphLineWidth:1,graphLineColor:"#aaa",mapLabelColor:"#000000",mapLabelColorE:"rgb(100,0,0)",mapBorderColor:"#444444",mapBorderColorE:"#444444",mapBorderWidth:.5,mapBorderWidthE:1,mapAreaColor:"#eeeeee",mapAreaColorE:"rgba(255,215,0,0.8)",axes:[{type:"all",name:"通用坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"category",name:"类目坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!1,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"value",name:"数值坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"log",name:"对数坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"time",name:"时间坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}],axisSeperateSetting:!0,toolboxColor:"#999999",toolboxEmphasisColor:"#666666",tooltipAxisColor:"#cccccc",tooltipAxisWidth:1,timelineLineColor:"#293c55",timelineLineWidth:1,timelineItemColor:"#293c55",timelineItemColorE:"#a9334c",timelineCheckColor:"#e43c59",timelineCheckBorderColor:"#c23531",timelineItemBorderWidth:1,timelineControlColor:"#293c55",timelineControlBorderColor:"#293c55",timelineControlBorderWidth:.5,timelineLabelColor:"#293c55",datazoomBackgroundColor:"rgba(47,69,84,0)",datazoomDataColor:"rgba(47,69,84,0.3)",datazoomFillColor:"rgba(167,183,204,0.4)",datazoomHandleColor:"#a7b7cc",datazoomHandleWidth:"100",datazoomLabelColor:"#333333"}},NFe={version:1,themeName:"walden",theme:{seriesCnt:"3",titleColor:"#666666",subtitleColor:"#999999",textColorShow:!1,textColor:"#333",markTextColor:"#ffffff",color:["#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"],borderColor:"#ccc",borderWidth:0,visualMapColor:["#2a99c9","#afe8ff"],legendTextColor:"#999999",kColor:"#e6a0d2",kColor0:"transparent",kBorderColor:"#e6a0d2",kBorderColor0:"#3fb1e3",kBorderWidth:"2",lineWidth:"3",symbolSize:"8",symbol:"emptyCircle",symbolBorderWidth:"2",lineSmooth:!1,graphLineWidth:"1",graphLineColor:"#cccccc",mapLabelColor:"#ffffff",mapLabelColorE:"#3fb1e3",mapBorderColor:"#aaaaaa",mapBorderColorE:"#3fb1e3",mapBorderWidth:.5,mapBorderWidthE:1,mapAreaColor:"#eeeeee",mapAreaColorE:"rgba(63,177,227,0.25)",axes:[{type:"all",name:"通用坐标轴",axisLineShow:!0,axisLineColor:"#cccccc",axisTickShow:!1,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#999999",splitLineShow:!0,splitLineColor:["#eeeeee"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]},{type:"category",name:"类目坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!1,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"value",name:"数值坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"log",name:"对数坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"time",name:"时间坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}],axisSeperateSetting:!1,toolboxColor:"#999999",toolboxEmphasisColor:"#666666",tooltipAxisColor:"#cccccc",tooltipAxisWidth:1,timelineLineColor:"#626c91",timelineLineWidth:1,timelineItemColor:"#626c91",timelineItemColorE:"#626c91",timelineCheckColor:"#3fb1e3",timelineCheckBorderColor:"#3fb1e3",timelineItemBorderWidth:1,timelineControlColor:"#626c91",timelineControlBorderColor:"#626c91",timelineControlBorderWidth:.5,timelineLabelColor:"#626c91",datazoomBackgroundColor:"rgba(255,255,255,0)",datazoomDataColor:"rgba(222,222,222,1)",datazoomFillColor:"rgba(114,230,212,0.25)",datazoomHandleColor:"#cccccc",datazoomHandleWidth:"100",datazoomLabelColor:"#999999"}},jFe={version:1,themeName:"westeros",theme:{seriesCnt:"4",titleColor:"#516b91",subtitleColor:"#93b7e3",textColorShow:!1,textColor:"#333",markTextColor:"#eeeeee",color:["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],borderColor:"#ccc",borderWidth:0,visualMapColor:["#516b91","#59c4e6","#a5e7f0"],legendTextColor:"#999999",kColor:"#edafda",kColor0:"transparent",kBorderColor:"#d680bc",kBorderColor0:"#8fd3e8",kBorderWidth:"2",lineWidth:"2",symbolSize:"6",symbol:"emptyCircle",symbolBorderWidth:"2",lineSmooth:!0,graphLineWidth:1,graphLineColor:"#aaaaaa",mapLabelColor:"#000",mapLabelColorE:"#516b91",mapBorderColor:"#516b91",mapBorderColorE:"#516b91",mapBorderWidth:.5,mapBorderWidthE:1,mapAreaColor:"#f3f3f3",mapAreaColorE:"#a5e7f0",axes:[{type:"all",name:"通用坐标轴",axisLineShow:!0,axisLineColor:"#cccccc",axisTickShow:!1,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#999999",splitLineShow:!0,splitLineColor:["#eeeeee"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]},{type:"category",name:"类目坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!1,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"value",name:"数值坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"log",name:"对数坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"time",name:"时间坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}],axisSeperateSetting:!1,toolboxColor:"#999999",toolboxEmphasisColor:"#666666",tooltipAxisColor:"#cccccc",tooltipAxisWidth:1,timelineLineColor:"#8fd3e8",timelineLineWidth:1,timelineItemColor:"#8fd3e8",timelineItemColorE:"#8fd3e8",timelineCheckColor:"#8fd3e8",timelineCheckBorderColor:"#8a7ca8",timelineItemBorderWidth:1,timelineControlColor:"#8fd3e8",timelineControlBorderColor:"#8fd3e8",timelineControlBorderWidth:.5,timelineLabelColor:"#8fd3e8",datazoomBackgroundColor:"rgba(0,0,0,0)",datazoomDataColor:"rgba(255,255,255,0.3)",datazoomFillColor:"rgba(167,183,204,0.4)",datazoomHandleColor:"#a7b7cc",datazoomHandleWidth:"100",datazoomLabelColor:"#333"}},SFe={version:1,themeName:"wonderland",theme:{seriesCnt:"3",titleColor:"#666666",subtitleColor:"#999999",textColorShow:!1,textColor:"#333",markTextColor:"#ffffff",color:["#4ea397","#22c3aa","#7bd9a5","#d0648a","#f58db2","#f2b3c9"],borderColor:"#ccc",borderWidth:0,visualMapColor:["#d0648a","#22c3aa","#adfff1"],legendTextColor:"#999999",kColor:"#d0648a",kColor0:"transparent",kBorderColor:"#d0648a",kBorderColor0:"#22c3aa",kBorderWidth:"1",lineWidth:"3",symbolSize:"8",symbol:"emptyCircle",symbolBorderWidth:"2",lineSmooth:!1,graphLineWidth:"1",graphLineColor:"#cccccc",mapLabelColor:"#28544e",mapLabelColorE:"#349e8e",mapBorderColor:"#999999",mapBorderColorE:"#22c3aa",mapBorderWidth:.5,mapBorderWidthE:1,mapAreaColor:"#eeeeee",mapAreaColorE:"rgba(34,195,170,0.25)",axes:[{type:"all",name:"通用坐标轴",axisLineShow:!0,axisLineColor:"#cccccc",axisTickShow:!1,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#999999",splitLineShow:!0,splitLineColor:["#eeeeee"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]},{type:"category",name:"类目坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!1,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"value",name:"数值坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"log",name:"对数坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"time",name:"时间坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}],axisSeperateSetting:!1,toolboxColor:"#999999",toolboxEmphasisColor:"#666666",tooltipAxisColor:"#cccccc",tooltipAxisWidth:1,timelineLineColor:"#4ea397",timelineLineWidth:1,timelineItemColor:"#4ea397",timelineItemColorE:"#4ea397",timelineCheckColor:"#4ea397",timelineCheckBorderColor:"#3cebd2",timelineItemBorderWidth:1,timelineControlColor:"#4ea397",timelineControlBorderColor:"#4ea397",timelineControlBorderWidth:.5,timelineLabelColor:"#4ea397",datazoomBackgroundColor:"rgba(255,255,255,0)",datazoomDataColor:"rgba(222,222,222,1)",datazoomFillColor:"rgba(114,230,212,0.25)",datazoomHandleColor:"#cccccc",datazoomHandleWidth:"100",datazoomLabelColor:"#999999"}},Bo={},DFe=["#478FF7","#A6EB9A","#5ECBCF","#DCBE8C","#7F90DA","#59A076"],AFe=["#FF7875","#FFC53D","#BAE638","#35CFC9","#3FA9FF","#F759AB"],RFe=["#8BF2BB","#3FD6A2","#8BF4F8","#3FCAEA","#F48AFE","#A52ED9"],PFe=["#FFD591","#5CDBD3","#FFC53D","#FF4C4F","#597FF7","#F759AB"],LFe=["#90BBFF","#FFD390","#FF9F90","#90E3FF","#EDA1EC","#B49FFF"],BFe=["#004FB3","#0A6ED9","#1890FF","#3FA9FF","#6AC0FF","#91D5FF"],OFe=["#AD4F01","#D46B07","#FA8C17","#FFA940","#FFC069","#FFD591"],MFe=["#000000","#232323","#474747","#6E6E6E","#9D9D9D","#D8D8D8"],UFe=[DFe,AFe,RFe,PFe,LFe,BFe,OFe,MFe];for(let e=0;e<8;e++){const t="theme".concat(e);Bo["theme".concat(e)]={themeName:t,theme:{color:UFe[e]}}}Bo.essos=CFe;Bo.macarons=kFe;Bo.roma=TFe;Bo.shine=vFe;Bo.vintage=IFe;Bo.walden=NFe;Bo.westeros=jFe;Bo.wonderland=SFe;Object.keys(Bo).forEach(e=>{QK(e,Bo[e].theme)});const VFe=y.forwardRef((e,t)=>{const n=y.useRef(null),s=y.useRef(),[a,o]=y.useState(0);return y.useEffect(()=>{if(!n.current)return;const i=Ps(()=>{var c;(c=s.current)==null||c.resize()},100),l=Ku.observe(n.current,()=>{i()});return i(),()=>{l()}},[]),y.useImperativeHandle(t,()=>s.current,[a]),y.useEffect(()=>{const i=JK(n.current,e.theme);return s.current=i,o(l=>++l),()=>{i.dispose()}},[e.theme,o]),r.jsx("div",{id:"chart-container",ref:n,className:"w-full h-full text-left"})}),x4={[m.AggregationAction.COUNT_ALL]:"计数",[m.AggregationAction.DEDUPLICATION]:"去重计数"},$Fe={...x4,[m.AggregationAction.SUM]:"求和",[m.AggregationAction.MAX]:"最大值",[m.AggregationAction.MIN]:"最小值",[m.AggregationAction.AVERAGE]:"平均值"},HFe={...x4,[m.AggregationAction.SUM]:"求和",[m.AggregationAction.MAX]:"最大值",[m.AggregationAction.MIN]:"最小值",[m.AggregationAction.AVERAGE]:"平均值","":""},zFe=e=>e?[m.AggregationAction.SUM,m.AggregationAction.MAX,m.AggregationAction.MIN,m.AggregationAction.AVERAGE].includes(e):!1,F2=e=>{var d,u;const{legendAlignPosition:t,showDataLabel:n,xAxisTtile:s,yAxisTtile:a}=bx(e),o={},i=n?12:0,l=40,c=ad();if(o.grid={left:10,right:40,bottom:10,top:30,containLabel:!0},t!=="none"){const f=t==="top"||t==="bottom";o.legend={type:"scroll",orient:f?"horizontal":"vertical",textStyle:f?{color:c?"grey":"black",backgroundColor:"transparent"}:{width:60,overflow:"truncate",color:c?"grey":"black",backgroundColor:"transparent"},[t]:"10"},o.grid={...o.grid,[t]:f?50:120}}return((d=e.chartMode)==null?void 0:d.type)==="HorizontalBar"?o.grid.right=parseInt("".concat(o.grid.right),10)+i:o.grid.top=parseInt("".concat(o.grid.top),10)+i,s&&(o.grid.bottom=parseInt("".concat(o.grid.bottom),10)+l),a&&(((u=e.chartMode)==null?void 0:u.type)==="HorizontalBar"?o.grid.left=parseInt("".concat(o.grid.left),10)+60:o.grid.left=parseInt("".concat(o.grid.left),10)+40),o},I6=(e,t,n,s)=>{const{showDataLabel:a,showGridLine:o,showXAxisLabel:i,showXAxisLine:l,showXAxisCalibration:c,showYAxisLabel:d,showYAxisLine:u,showYAxisCalibration:f,xAxisTtile:h,yAxisTtile:p}=bx(s),g={},_=F2(s),x=ad();switch(n){case"stack":{g.stack="stack";break}case"percent":{g.stack="stack";const b=[];t.forEach(w=>{w.data.forEach((E,C)=>{var T;const k=(T=b[C])!=null?T:0;_b(E)&&(b[C]=k+E)})}),t.forEach(w=>{w.data=w.data.map((E,C)=>_b(E)?parseFloat((E/b[C]).toFixed(3)):E)});break}}return{tooltip:{trigger:"axis",className:"w-100",axisPointer:{type:"shadow",label:{}},appendTo:tH()?void 0:b=>document.body},grid:{left:"10",right:"40",bottom:"10",top:"50",containLabel:!0},yAxis:{type:"value",nameLocation:"middle",name:p,nameGap:30,nameTextStyle:{fontSize:"16px"},axisLabel:{show:d},axisTick:{show:f},axisLine:{show:u},splitLine:{show:o}},xAxis:{nameLocation:"middle",name:h,nameTextStyle:{fontSize:"16px"},nameGap:30,axisLine:{show:l},axisTick:{alignWithLabel:!0,show:c},axisLabel:{show:i},type:"category",data:e},series:t.map(b=>{const w=b.data.map(E=>({value:E}));return{...b,...g,type:"bar",label:{show:a,position:"top",backgroundColor:"transparent",color:x?"grey":"black"},data:w}}),..._}},qFe=(e,t,n,s)=>{const a={},o=F2(s),i=ad(),{showDataLabel:l,showGridLine:c,showXAxisLabel:d,showXAxisLine:u,showXAxisCalibration:f,showYAxisLabel:h,showYAxisLine:p,showYAxisCalibration:g,xAxisTtile:_,yAxisTtile:x}=bx(s);switch(n){case"base":break;case"smooth":{a.smooth=!0;break}case"step":{a.step="middle";break}}return{tooltip:{className:"w-100",trigger:"axis",axisPointer:{type:"shadow"},appendTo:b=>document.body},grid:{left:"10",right:"40",bottom:"10",top:"50",containLabel:!0},yAxis:{type:"value",nameLocation:"middle",name:x,nameGap:30,nameTextStyle:{fontSize:"16px"},axisLabel:{show:h},axisTick:{show:g},axisLine:{show:p},splitLine:{show:c}},xAxis:{type:"category",data:e,nameLocation:"middle",name:_,nameGap:30,nameTextStyle:{fontSize:"16px"},axisLine:{show:u},axisTick:{show:f},axisLabel:{show:d}},series:t.map(b=>({...b,...a,type:"line",label:{show:l,position:"top",backgroundColor:"transparent",color:i?"grey":"black"}})),...o}},GFe=(e,t,n,s)=>{const{showDataLabel:a,showGridLine:o,showXAxisLabel:i,showXAxisLine:l,showXAxisCalibration:c,showYAxisLabel:d,showYAxisLine:u,showYAxisCalibration:f,xAxisTtile:h,yAxisTtile:p}=bx(s),g={},_=F2(s),x=ad();switch(n){case"stack":{g.stack="stack";break}case"percent":{g.stack="stack";const b=[];t.forEach(w=>{w.data.forEach((E,C)=>{var T;if(!_b(E))return;const k=(T=b[C])!=null?T:0;b[C]=k+E})}),t.forEach(w=>{w.data=w.data.map((E,C)=>_b(E)?parseFloat((E/b[C]).toFixed(3)):E)});break}}return{tooltip:{trigger:"axis",axisPointer:{type:"shadow"},appendTo:b=>document.body},xAxis:{type:"value",nameLocation:"middle",name:h,nameGap:30,nameTextStyle:{fontSize:"16px"},axisLine:{show:l},axisTick:{show:c},axisLabel:{show:i},splitLine:{show:o}},yAxis:{type:"category",data:e,nameLocation:"middle",name:p,nameGap:100,nameTextStyle:{fontSize:"16px"},axisLabel:{width:window.innerWidth*.15,overflow:"truncate",show:d},axisTick:{alignWithLabel:!0,show:f},axisLine:{show:u}},series:t.map(b=>{const w=b.data.map(E=>({value:E}));return{...b,...g,type:"bar",label:{show:a,position:"right",backgroundColor:"transparent",color:x?"grey":"black"},data:w}}),..._}},WFe=(e,t,n,s)=>{const{pieInsideRadius:a,pieOutsideRadius:o,showDataLabel:i,pieLabelPosition:l}=eH(s),c=ad(),d=tH()?.75:1,u=F2(s);return{tooltip:{trigger:"item"},series:t.map(h=>{const p=h.data.map((g,_)=>({value:g,name:e[_]}));return{radius:["".concat(a*d,"%"),"".concat(o*.85*d,"%")],...h,data:p,type:"pie",label:{show:i,formatter:"{b}: {c}",position:l,backgroundColor:"transparent",color:c?"grey":"black"}}}),...u}},KFe=e=>{if(!e||!e.chartMode)return"基础柱状图";switch(e.chartMode.type){case"Number":return"统计数字";case"Bar":return e.chartMode.display==="stack"?"堆叠柱状图":e.chartMode.display==="percent"?"百分比堆叠柱状图":"基础柱状图";case"Line":return e.chartMode.display==="smooth"?"平滑折线图":e.chartMode.display==="step"?"阶梯折线图":"基础折线图";case"HorizontalBar":return e.chartMode.display==="stack"?"堆叠条形图":e.chartMode.display==="percent"?"百分比堆叠条形图":"基础条形图";case"Pie":return"图表类型"}},N6=e=>e===m.CollectionSchemaType.NUMBER?$Fe:x4,bx=e=>{var t,n,s,a,o,i,l,c,d,u,f,h,p,g,_,x,F,b,w,E,C,k;return{legendAlignPosition:(n=(t=e==null?void 0:e.style)==null?void 0:t.legendAlignPosition)!=null?n:"top",showDataLabel:(a=(s=e==null?void 0:e.style)==null?void 0:s.showDataLabel)!=null?a:!1,showGridLine:(i=(o=e==null?void 0:e.style)==null?void 0:o.showGridLine)!=null?i:!1,showXAxisLabel:(c=(l=e==null?void 0:e.style)==null?void 0:l.showXAxisLabel)!=null?c:!0,showXAxisLine:(u=(d=e==null?void 0:e.style)==null?void 0:d.showXAxisLine)!=null?u:!1,showXAxisCalibration:(h=(f=e==null?void 0:e.style)==null?void 0:f.showXAxisCalibration)!=null?h:!1,showYAxisLabel:(g=(p=e==null?void 0:e.style)==null?void 0:p.showYAxisLabel)!=null?g:!0,showYAxisLine:(x=(_=e==null?void 0:e.style)==null?void 0:_.showYAxisLine)!=null?x:!1,showYAxisCalibration:(b=(F=e==null?void 0:e.style)==null?void 0:F.showYAxisCalibration)!=null?b:!1,xAxisTtile:(E=(w=e==null?void 0:e.style)==null?void 0:w.xAxisTtile)!=null?E:"",yAxisTtile:(k=(C=e==null?void 0:e.style)==null?void 0:C.yAxisTtile)!=null?k:""}},eH=e=>{var t,n,s,a,o,i,l,c,d,u;return{showDataLabel:(n=(t=e==null?void 0:e.style)==null?void 0:t.showDataLabel)!=null?n:!1,legendAlignPosition:(a=(s=e==null?void 0:e.style)==null?void 0:s.legendAlignPosition)!=null?a:"top",pieLabelPosition:(i=(o=e==null?void 0:e.style)==null?void 0:o.pieLabelPosition)!=null?i:"outside",pieInsideRadius:(c=(l=e==null?void 0:e.style)==null?void 0:l.pieInsideRadius)!=null?c:5,pieOutsideRadius:(u=(d=e==null?void 0:e.style)==null?void 0:d.pieOutsideRadius)!=null?u:75}};function tH(){if(navigator.userAgentData)return navigator.userAgentData.mobile;let e=!1;const t=navigator.userAgent;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e}const YFe=e=>e.length,XFe=e=>Rr.uniq(e!=null?e:[]).length,QFe=e=>(e=e.filter(t=>t!==void 0),Rr.sumBy(e,t=>parseFloat(t))),JFe=e=>(e=e.filter(t=>t!==void 0),Rr.maxBy(e,t=>parseFloat(t))),ZFe=e=>(e=e.filter(t=>t!==void 0),Rr.minBy(e,t=>parseFloat(t))),ewe=e=>(e=e.filter(t=>t!==void 0),e.length===0?0:Rr.meanBy(e,t=>parseFloat(t))),GC={[m.AggregationAction.COUNT_ALL]:YFe,[m.AggregationAction.DEDUPLICATION]:XFe,[m.AggregationAction.SUM]:QFe,[m.AggregationAction.MAX]:JFe,[m.AggregationAction.MIN]:ZFe,[m.AggregationAction.AVERAGE]:ewe},nH=(e,t,n,s)=>{var E,C,k,T,v,I,j,S,D,A;const{chartMode:a,xAxisPropertyId:o="title",xAxisPropertyGroupLevel:i,statistics:l="record",includeEmpty:c=!0,orderRule:d=m.GroupSortType.ASCENDING,groupAggregationPropertyId:u,groupAggregationGroupLevel:f,splitOption:h=!0}=n;let{yAxisPropertyIds:p=[{propertyId:"title"}],orderBy:g="xAxis"}=n;if(l==="property"&&p.length===0){console.warn("统计字段缺失");return}(p.length>1||u)&&(g="xAxis"),l==="record"&&(p=[{propertyId:"title"}]);const _=h,x=[];if((a==null?void 0:a.type)==="Number"){const P=p[0],L=[];t.forEach(z=>{const K=s(z.uuid,P.propertyId,P.groupLevel);K==null||K.forEach(W=>{L.push(W)})});let O=m.AggregationAction.COUNT_ALL;l==="property"&&(O=(E=P.aggregation)!=null?E:m.AggregationAction.COUNT_ALL);const $=GC[O];return{total:(C=$==null?void 0:$(L))!=null?C:"-"}}const F=(a==null?void 0:a.type)==="Line"?0:"-";p.forEach(P=>{var z,K,W,Y,G;const L=(W=(z=e==null?void 0:e.data)==null?void 0:z.schema)==null?void 0:W[(K=P.propertyId)!=null?K:""],O=new Set,$=new Set,M=[];t.forEach(ee=>{var ce;const te=s(ee.uuid,o,i)||["空值"],Q=[];_?te.forEach(ae=>{Q.push(ae)}):Q.push(te.join(",")),Q.forEach(ae=>{O.add(ae)});const ne=[];u&&(s(ee.uuid,u,f)||["空值"]).forEach(de=>{ne.push(de)}),ne.forEach(ae=>{$.add(ae)});const se=(ce=s(ee.uuid,P.propertyId,P.groupLevel))!=null?ce:["空值"];ne.length===0?Q.forEach(ae=>{se.forEach(de=>{const ke={xAxisValue:ae,combineKey:"",value:de};M.push(ke)})}):ne.forEach(ae=>{Q.forEach(de=>{se.forEach(ke=>{const Te={xAxisValue:de,combineKey:ae,value:ke};M.push(Te)})})})});const U=(Y=P.aggregation)!=null?Y:m.AggregationAction.COUNT_ALL;if(u){const ee={};M.forEach(Q=>{var ce,ae;const ne=(ce=ee[Q.xAxisValue])!=null?ce:{},se=(ae=ne[Q.combineKey])!=null?ae:[];se.push(Q.value),ne[Q.combineKey]=se,ee[Q.xAxisValue]=ne}),O.forEach(Q=>{$.forEach(ne=>{var ae,de;const se=(ae=ee[Q])!=null?ae:{},ce=se==null?void 0:se[ne];if(se)if(ce){const ke=GC[U];let Te=(de=ke==null?void 0:ke(ce))!=null?de:F;typeof Te=="number"&&(Te=Te.toFixed(2)),se[ne]=[Te]}else se[ne]=["".concat(F)]})});const te={};Object.keys(ee).forEach(Q=>{const ne=ee[Q];ne&&Object.keys(ne).forEach(se=>{const ce=Rr.first(ne[se]);let ae=te[se];ae||(ae={name:se,data:[],xAxisValueToMap:{}},te[se]=ae),ae.xAxisValueToMap[Q]=ce==="-"?ce:parseFloat(ce),ae.data.push(ce==="-"?ce:parseFloat(ce))})}),Object.keys(te).forEach(Q=>{x.push(te[Q])})}else{const ee={};M.forEach(Q=>{var se;const ne=(se=ee[Q.xAxisValue])!=null?se:[];ne.push(Q.value),ee[Q.xAxisValue]=ne}),O.forEach(Q=>{var se,ce;const ne=(se=ee[Q])!=null?se:[];if(ne){const ae=GC[U];let de=(ce=ae==null?void 0:ae(ne))!=null?ce:"-";typeof de=="number"&&(de=de.toFixed(2)),ee[Q]=[de]}else ee[Q]=["-"]});const te={name:(G=L==null?void 0:L.name)!=null?G:"",data:[],xAxisValueToMap:{}};Object.keys(ee).forEach(Q=>{var se;const ne=(se=Rr.first(ee[Q]))!=null?se:"-";te.xAxisValueToMap[Q]=ne}),x.push(te)}});let b=[];const w=[];return g==="xAxis"?x.forEach(P=>{const L=Rr.map(Rr.entries(P.xAxisValueToMap),([z,K])=>({xAxis:z,value:K})),O=L.filter(z=>z.xAxis==="空值"),M=L.filter(z=>z.xAxis!=="空值").sort((z,K)=>d===m.GroupSortType.ASCENDING?el(z.xAxis,K.xAxis):el(K.xAxis,z.xAxis));c&&M.push(...O),b.length===0&&(b=M.map(z=>z.xAxis));const U=M.map(z=>z.value);w.push({name:l==="record"&&!u?"计数":P.name,data:U,xAxisValueToMap:{}})}):x.forEach(P=>{let O=Rr.map(Rr.entries(P.xAxisValueToMap),([M,U])=>({xAxis:M,value:U})).sort((M,U)=>{if(typeof M.value=="string"&&typeof U.value=="string"){const z=parseFloat(M.value),K=parseFloat(U.value);return m.GroupSortType.ASCENDING===d?z-K:K-z}else if(typeof M.value=="number"&&typeof U.value=="number")return m.GroupSortType.ASCENDING===d?M.value-U.value:U.value-M.value;return 0});c||(O=O.filter(M=>M.xAxis!=="空值")),b.length===0&&(b=O.map(M=>M.xAxis));const $=O.map(M=>M.value);w.push({name:l==="record"&&!u?"计数":P.name,data:$,xAxisValueToMap:{}})}),((k=n.chartMode)==null?void 0:k.type)==="Bar"?I6(b,w,(T=n.chartMode.display)!=null?T:"base",n):((v=n.chartMode)==null?void 0:v.type)==="Line"?qFe(b,w,(I=n.chartMode.display)!=null?I:"base",n):((j=n.chartMode)==null?void 0:j.type)==="HorizontalBar"?GFe(b,w,(S=n.chartMode.display)!=null?S:"base",n):((D=n.chartMode)==null?void 0:D.type)==="Pie"?WFe(b,w,(A=n.chartMode.display)!=null?A:"base",n):I6(b,w,"base",n)},twe=(e,t)=>{if(!e)return!0;const{schema:n}=e.data;return!(t.xAxisPropertyId&&!(n==null?void 0:n[t.xAxisPropertyId])||t.yAxisPropertyIds&&t.yAxisPropertyIds.some(a=>!(n==null?void 0:n[a.propertyId]))||t.groupAggregationPropertyId&&!(n==null?void 0:n[t.groupAggregationPropertyId]))},Zl=y.forwardRef((e,t)=>{const{showBorder:n=!0}=e,s=y.useRef(null);return y.useImperativeHandle(t,()=>s.current,[]),r.jsx("div",{ref:s,className:R({"cursor-pointer":e.title},e.className),onClick:e.onClick,children:r.jsxs("div",{className:R("flex items-center justify-between w-full pl-2 pr-1 py-1 rounded text-t2",{"text-grey4":!e.title&&e.placeHolder,border:n}),children:[r.jsx("span",{children:e.title||e.placeHolder}),r.jsx(V,{name:"IcArrowShow",size:"middle",className:"text-grey2"})]})})}),sH=y.createContext(""),di=()=>y.useContext(sH),rH=(e,t,n=[])=>{var o;const a=(o=e.getState().blocks[t])==null?void 0:o.data.schema;if(a)return Object.keys(a).filter(i=>{var l;return n.includes(i)?!1:((l=a[i])==null?void 0:l.type)!==m.CollectionSchemaType.ID_NUMBER}).map(i=>{var c,d,u;const l=(c=a[i])==null?void 0:c.type;return{value:i,title:(u=(d=a[i])==null?void 0:d.name)!=null?u:"",icon:l&&un[l],type:l}})},DF=(e,t,n,s)=>{var u,f;if(!t)return;const o=(u=e.getState().blocks[t])==null?void 0:u.data.schema;if(!o)return;const i=o[n];if(!i)return;const c=q0.date.find(h=>h.type===s),d=c?" (".concat(c.name,")"):"";return{value:n,title:((f=i.name)!=null?f:"")+d,icon:i.type&&un[i.type],type:i.type}},j6=ZK(),w2=()=>{const e=ss(),t=ie();return y.useCallback((n,s)=>{var i;let a=(i=rH(e,n,s.excludeIds))!=null?i:[];a=a.filter(l=>l.type!==m.CollectionSchemaType.ROLLUP);const o=a.map(l=>{var d;if(l.type===m.CollectionSchemaType.FORMULA){const{propertySchema:u}=ii(n,l.value);if(u){let f=u.type;u.type===m.CollectionSchemaType.FORMULA&&MN(n,l.value,u.formula)&&((d=pe().blocks[n])!=null&&d.data.schema)&&(f=$n(n).getTypeAsCollectionSchemaType(l.value),l.type=f)}}return l.type&&[m.CollectionSchemaType.DATE,m.CollectionSchemaType.CREATED_AT,m.CollectionSchemaType.UPDATED_AT].includes(l.type)?{type:H.OPERATION,data:{title:l.title,icon:l.icon,propertyId:l.value,renderSubMenu:()=>{const f=q0.date.map(h=>({type:H.OPERATION,data:{title:h.name,onClick:()=>{s.callback(l.value,h.type),t.closeModal(j6)}}}));return r.jsx(ze,{className:"next-modal py-0.5",items:f,keyDownPriority:dr+1})}}}:{type:H.OPERATION,data:{title:l.title,icon:l.icon,propertyId:l.value,onClick:()=>{s.callback(l.value)}}}});t.dropdown({modalId:j6,placement:"bottom",offset:[0,0],popcorn:s.popcorn,content:({onCloseModal:l})=>r.jsx(ze,{className:R("next-modal min-w-[100px] max-h-[40vh] overflow-auto py-0.5",s.className),items:o,onItemClick:()=>{l()}})})},[t,e])},nwe=()=>{const e=ss();return y.useCallback((t,n,s)=>{_e(t,{data:{format:{chartFormat:{ref:{uuid:n,viewId:s}}}}},!1,e)},[e])},Hg=()=>{const e=ss();return y.useCallback((t,n)=>{var o;const a=e.getState().blocks[t];_e(t,{data:{format:{chartFormat:{...(o=a==null?void 0:a.data.format)==null?void 0:o.chartFormat,...n}}}},!1,e)},[e])},zg=()=>{const e=ss();return y.useCallback((t,n)=>{var o,i,l;const a=e.getState().blocks[t];_e(t,{data:{format:{chartFormat:{...(o=a==null?void 0:a.data.format)==null?void 0:o.chartFormat,style:{...(l=(i=a==null?void 0:a.data.format)==null?void 0:i.chartFormat)==null?void 0:l.style,...n}}}}},!1,e)},[e])},lh=e=>ft(e,t=>{var n;return(n=t==null?void 0:t.data.format)==null?void 0:n.chartFormat}),y4=e=>ft(e,t=>{var n,s,a,o;return(o=(a=(s=(n=t==null?void 0:t.data.format)==null?void 0:n.chartFormat)==null?void 0:s.style)==null?void 0:a.theme)!=null?o:"theme0"}),aH=e=>ft(e,t=>{var n,s,a,o;return(o=(a=(s=(n=t==null?void 0:t.data.format)==null?void 0:n.chartFormat)==null?void 0:s.style)==null?void 0:a.numberColor)!=null?o:Ze.blue}),oH=e=>ft(e,t=>{var n,s,a,o;return(o=(a=(s=(n=t==null?void 0:t.data.format)==null?void 0:n.chartFormat)==null?void 0:s.style)==null?void 0:a.numberFormatCount)!=null?o:0}),iH=e=>ft(e,t=>{var n,s,a,o;return(o=(a=(s=(n=t==null?void 0:t.data.format)==null?void 0:n.chartFormat)==null?void 0:s.style)==null?void 0:a.numberFormat)!=null?o:"number"}),lH=e=>ft(e,t=>{var n,s,a,o;return(o=(a=(s=(n=t==null?void 0:t.data.format)==null?void 0:n.chartFormat)==null?void 0:s.style)==null?void 0:a.numberDesc)!=null?o:""}),swe=e=>ft(e,t=>{var n,s,a,o;return(o=(a=(s=(n=t==null?void 0:t.data.format)==null?void 0:n.chartFormat)==null?void 0:s.style)==null?void 0:a.legendAlignPosition)!=null?o:"top"}),cH=e=>ft(e,t=>{var n;return bx((n=t==null?void 0:t.data.format)==null?void 0:n.chartFormat)}),rwe=e=>ft(e,t=>{var n;return eH((n=t==null?void 0:t.data.format)==null?void 0:n.chartFormat)});function AF(e){const{values:t,onlyOne:n}=e;return t.length<2?null:r.jsx("div",{className:"flex",children:n?r.jsx("div",{className:R("text-white cursor-pointer text-t3  border px-2 py-1 rounded-md border-active_color bg-active_color"),children:n.desc}):t.map((s,a)=>r.jsx("div",{className:R("cursor-pointer text-t3  border-t border-b px-2 py-1",{"text-white bg-active_color border-active_color":e.active.desc===s.desc,"border-l rounded-l-md":a===0,"border-r rounded-r-md":a===t.length-1}),onClick:()=>{e.onSwicth(s)},children:s.desc},a))})}const awe=[{name:"统计数字",info:[{image:vn.chartNumber,tip:"统计数字",chartMode:{type:"Number",display:"base"}}]},{name:"柱状图",info:[{image:vn.chartBarBase,tip:"基础柱状图",chartMode:{type:"Bar",display:"base"}},{image:vn.chartBarStack,tip:"堆叠柱状图",chartMode:{type:"Bar",display:"stack"}},{image:vn.chartBarPercent,tip:"百分比堆叠柱状图",chartMode:{type:"Bar",display:"percent"}}]},{name:"折线图",info:[{image:vn.chartLineBase,tip:"基础折线图",chartMode:{type:"Line",display:"base"}},{image:vn.chartLineSmooth,tip:"平滑折线图",chartMode:{type:"Line",display:"smooth"}},{image:vn.chartLineStep,tip:"阶梯折线图",chartMode:{type:"Line",display:"step"}}]},{name:"条形图",info:[{image:vn.chartHorizontalbarBase,tip:"基础条形图",chartMode:{type:"HorizontalBar",display:"base"}},{image:vn.chartHorizontalbarStack,tip:"堆叠条形图",chartMode:{type:"HorizontalBar",display:"stack"}},{image:vn.chartHorizontalbarPercent,tip:"百分比堆叠条形图",chartMode:{type:"HorizontalBar",display:"percent"}}]},{name:"饼状图",info:[{image:vn.chartPieBase,tip:"饼状图",chartMode:{type:"Pie",display:"base"}}]}],Mp={type:void 0,title:"无效字段",icon:void 0},owe=e=>{var d,u,f,h,p,g;const t=n3(Iw),n={},s={},a={},o=pe(),i=o.blocks[e];i&&(a[e]=i);const l=(f=(u=(d=i==null?void 0:i.data.format)==null?void 0:d.chartFormat)==null?void 0:u.ref)==null?void 0:f.uuid;if(Object.assign(s,o.users),l){const _=o.blocks[l];_&&(a[l]=_,_.subNodes.forEach(F=>{const b=o.blocks[F];b&&(a[F]=b)}));let x=o.blocks[(h=_==null?void 0:_.parentId)!=null?h:""];for(;x&&(a[x.uuid]=x,x.type!=="SPACE");)x=o.blocks[(p=x==null?void 0:x.parentId)!=null?p:""];(g=_==null?void 0:_.views)==null||g.forEach(F=>{const b=o.collectionViews[F];b&&(n[F]=b)})}return Kv({reducer:t,preloadedState:{blocks:a,users:s,collectionViews:n}})},iwe=[{orderBy:"xAxis",desc:"横轴值",mapping:"扇区字段值"},{orderBy:"yAxis",desc:"纵轴值",mapping:"扇区数值"}],WC=[{orderRule:m.GroupSortType.ASCENDING,desc:"升序"},{orderRule:m.GroupSortType.DESCENDING,desc:"降序"}],lwe=()=>{var E,C,k,T,v,I,j,S,D,A;const e=ss(),t=di(),n=lh(t),s=(E=n==null?void 0:n.ref)==null?void 0:E.uuid,a=(C=n==null?void 0:n.xAxisPropertyId)!=null?C:"title",o=n==null?void 0:n.xAxisPropertyGroupLevel,i=(k=n==null?void 0:n.includeEmpty)!=null?k:!0,l=(T=n==null?void 0:n.splitOption)!=null?T:!0,c=(v=n==null?void 0:n.orderBy)!=null?v:"xAxis",d=iwe.map(P=>{var L;return{...P,desc:((L=n==null?void 0:n.chartMode)==null?void 0:L.type)==="Pie"?P.mapping:P.desc}}),u=c==="xAxis"?d[0]:d[1],h=((I=n==null?void 0:n.orderRule)!=null?I:m.GroupSortType.ASCENDING)===m.GroupSortType.ASCENDING?WC[0]:WC[1],p=(j=DF(e,s,a,o))!=null?j:n!=null&&n.xAxisPropertyId?Mp:void 0,g=(p==null?void 0:p.type)===m.CollectionSchemaType.MULTI_SELECT||(p==null?void 0:p.type)===m.CollectionSchemaType.FILE||(p==null?void 0:p.type)===m.CollectionSchemaType.RELATION||(p==null?void 0:p.type)===m.CollectionSchemaType.PERSON,_=w2(),x=Hg(),F=((S=n==null?void 0:n.yAxisPropertyIds)!=null?S:[]).length>1||(n==null?void 0:n.groupAggregationPropertyId),b=((D=n==null?void 0:n.chartMode)==null?void 0:D.type)==="Pie";if(((A=n==null?void 0:n.chartMode)==null?void 0:A.type)==="Number")return null;const w=p?r.jsxs("div",{className:"flex items-center",children:[p.icon&&r.jsx(V,{name:p.icon,size:"middle"}),r.jsx("div",{className:R("text-ellipsis max-w-[124px] ml-0.5",{"text-red":Mp===p}),children:p==null?void 0:p.title})]}):void 0;return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mt-5 text-t2-medium",children:"横轴"}),r.jsxs("div",{className:"text-t2 mt-2 space-y-3.5",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{children:"字段"}),r.jsx(Zl,{className:R({"cursor-not-allowed":!s}),title:w,showBorder:!1,placeHolder:"请选择字段",onClick:P=>{s&&_(s,{popcorn:P.currentTarget,callback:(L,O)=>{x(t,{xAxisPropertyId:L,xAxisPropertyGroupLevel:O})}})}})]}),g&&r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{children:"多选项拆分统计"}),r.jsx(en,{open:l,onSwitch:P=>{x(t,{splitOption:P})}})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{children:"包含空数据"}),r.jsx(en,{open:i,onSwitch:P=>{x(t,{includeEmpty:P})}})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{children:"排序依据"}),r.jsx(AF,{onlyOne:F?d[0]:void 0,active:u,values:d,onSwicth:P=>{x(t,{orderBy:P.orderBy})}})]}),!b&&r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{children:"排序规则"}),r.jsx(AF,{active:h,values:WC,onSwicth:P=>{x(t,{orderRule:P.orderRule})}})]})]})]})},cwe=e=>{var p,g,_,x,F,b,w;const t=ss(),n=di(),s=lh(n),a=(p=s==null?void 0:s.ref)==null?void 0:p.uuid,o=w2(),i=Hg(),l=(_=(g=s==null?void 0:s.yAxisPropertyIds)==null?void 0:g[e.yAxisIndex])!=null?_:b4,c=ie(),d=(x=y.useMemo(()=>{var E;if(l!=null&&l.propertyId)return DF(t,a,(E=l==null?void 0:l.propertyId)!=null?E:"",l.groupLevel)},[a,l,t]))!=null?x:Mp,u=y.useMemo(()=>{if((d==null?void 0:d.type)===m.CollectionSchemaType.FORMULA&&a){const C=$n(a,pe()).getTypeAsCollectionSchemaType(l==null?void 0:l.propertyId);return N6(C)}return N6(d==null?void 0:d.type)},[d==null?void 0:d.type,a,l==null?void 0:l.propertyId]),f=d?r.jsxs("div",{className:"flex items-center",children:[d.icon&&r.jsx(V,{name:d.icon,size:"middle"}),r.jsx("div",{className:R("text-ellipsis max-w-[124px] ml-0.5",{"text-red":Mp===d}),children:d==null?void 0:d.title})]}):void 0,h=(E,C)=>{if(!s)return;if(!s.yAxisPropertyIds){i(n,{yAxisPropertyIds:[C]});return}const k=s.yAxisPropertyIds.findIndex(I=>I.propertyId===E),T=s.yAxisPropertyIds.slice(0,k),v=s.yAxisPropertyIds.slice(k+1);i(n,{yAxisPropertyIds:[...T,C,...v]})};return r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(Zl,{className:"w-[180px]",title:f,placeHolder:"请选择字段",onClick:E=>{a&&o(a,{className:"w-[180px]",popcorn:E.currentTarget,callback:(C,k)=>{var I,j;if(C===(l==null?void 0:l.propertyId))return;const T=DF(t,a,C,k),v=zFe(l.aggregation);(d==null?void 0:d.type)===m.CollectionSchemaType.NUMBER&&(T==null?void 0:T.type)!==m.CollectionSchemaType.NUMBER&&v?h((I=l==null?void 0:l.propertyId)!=null?I:"",{propertyId:C,aggregation:m.AggregationAction.COUNT_ALL,groupLevel:k}):h((j=l==null?void 0:l.propertyId)!=null?j:"",{propertyId:C,aggregation:l.aggregation,groupLevel:k})}})}}),r.jsx(Zl,{title:HFe[(F=l==null?void 0:l.aggregation)!=null?F:""],className:"cursor-pointer w-[100px] shrink-0",placeHolder:"计数",onClick:E=>{c.dropdown({popcorn:E.currentTarget,content:({onCloseModal:C})=>{if(!l)return null;const k=Object.keys(u).map(T=>{const v=u[T];return{type:H.OPERATION,data:{title:v,onClick:()=>{h(l.propertyId,{propertyId:l.propertyId,aggregation:T})}}}});return r.jsx(ze,{className:"next-modal w-[100px]",items:k,onItemClick:()=>{C()}})}})}}),((w=(b=s==null?void 0:s.yAxisPropertyIds)!=null?b:[])==null?void 0:w.length)>1&&r.jsx("div",{className:"animate-hover p-1",onClick:()=>{var E,C;i(n,{yAxisPropertyIds:(C=(E=s==null?void 0:s.yAxisPropertyIds)==null?void 0:E.filter(k=>k.propertyId!==l.propertyId))!=null?C:[]})},children:r.jsx(V,{name:"IcClose",size:"small"})})]})},yu=({className:e})=>r.jsx("div",{className:rw("bg-grey7 w-full h-px",e)}),KC=[{statistics:"record",desc:"统计记录总数"},{statistics:"property",desc:"统计字段数值"}],b4={propertyId:"title",aggregation:m.AggregationAction.COUNT_ALL},dwe=()=>{var x,F,b,w,E;const e=y.useRef(null),t=di(),n=lh(t),s=n==null?void 0:n.groupAggregationPropertyId,a=(x=n==null?void 0:n.ref)==null?void 0:x.uuid,i=((F=n==null?void 0:n.statistics)!=null?F:"record")==="record"?KC[0]:KC[1],l=(b=n==null?void 0:n.yAxisPropertyIds)!=null?b:a?[b4]:[],c=w2(),d=ss(),u=y.useMemo(()=>{var k;return((k=rH(d,a!=null?a:""))!=null?k:[]).length},[a,d]),f=l.length===u,h=Hg(),p=((w=n==null?void 0:n.chartMode)==null?void 0:w.type)==="Number",g=((E=n==null?void 0:n.chartMode)==null?void 0:E.type)==="Pie",_=()=>{setTimeout(()=>{var k;const C=(k=e.current)==null?void 0:k.closest(".chart-config-scroller");C&&(C.scrollTop=C.scrollHeight)},10)};return r.jsxs(r.Fragment,{children:[r.jsx(yu,{className:"mt-4"}),r.jsx("div",{ref:e,className:"mt-5 text-t2-medium",children:"纵轴"}),r.jsxs("div",{className:"text-t2 mt-2 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{children:"统计类型"}),r.jsx(AF,{values:KC,active:i,onSwicth:C=>{h(t,{statistics:C.statistics}),_()}})]}),i.statistics==="property"&&r.jsxs(r.Fragment,{children:[l.map((C,k)=>r.jsx(cwe,{yAxisIndex:k},k)),!s&&l.length>0&&!p&&!g&&!f&&r.jsxs("div",{className:"flex items-center rounded-md animate-hover w-fit px-2 py-1.5",onClick:C=>{a&&c(a,{popcorn:C.currentTarget,callback:(k,T)=>{h(t,{orderBy:"xAxis",yAxisPropertyIds:[...l,{propertyId:k,aggregation:m.AggregationAction.COUNT_ALL,groupLevel:T}]}),_()},excludeIds:l.map(k=>k.propertyId)})},children:[r.jsx(V,{name:"IcAdd",size:"middle"}),r.jsx("div",{className:"ml-0.5",children:"添加字段"})]})]})]})]})},uwe={propertyId:"title",aggregation:m.AggregationAction.COUNT_ALL},fwe=()=>{var d,u,f,h;const e=di(),t=Hg(),n=lh(e),s=w2(),a=(d=n==null?void 0:n.ref)==null?void 0:d.uuid,o=(u=n==null?void 0:n.yAxisPropertyIds)!=null?u:a?[uwe]:[],i=ss(),l=y.useMemo(()=>{var p,g;if(n!=null&&n.groupAggregationPropertyId)return(g=DF(i,a,(p=n==null?void 0:n.groupAggregationPropertyId)!=null?p:"",n.groupAggregationGroupLevel))!=null?g:Mp},[n==null?void 0:n.groupAggregationPropertyId,n==null?void 0:n.groupAggregationGroupLevel,i,a]);if(o.length>1||((f=n==null?void 0:n.chartMode)==null?void 0:f.type)==="Number"||((h=n==null?void 0:n.chartMode)==null?void 0:h.type)==="Pie")return null;const c=l?r.jsxs("div",{className:"flex items-center",children:[l.icon&&r.jsx(V,{name:l.icon,size:"middle"}),r.jsx("div",{className:R("text-ellipsis max-w-[124px] ml-0.5",{"text-red":Mp===l}),children:l==null?void 0:l.title}),r.jsx("div",{className:"p-0.5 animate-hover",onClick:p=>{p.stopPropagation(),t(e,{groupAggregationPropertyId:""})},children:r.jsx(V,{name:"IcClose",size:"small"})})]}):"不分组";return r.jsxs("div",{className:"mt-1 text-t2 flex items-center justify-between",children:[r.jsx("div",{children:"分组聚合"}),r.jsx(Zl,{showBorder:!1,title:c,onClick:p=>{a&&s(a,{popcorn:p.currentTarget,callback:(g,_)=>{t(e,{groupAggregationPropertyId:g,groupAggregationGroupLevel:_})}})}})]})},mwe=()=>r.jsxs("div",{className:"mt-4",children:[r.jsx(lwe,{}),r.jsx(dwe,{}),r.jsx(fwe,{})]}),hwe=e=>{const t=di(),n=lh(t),s=Hg();return r.jsx("div",{className:"next-modal overflow-auto text-grey4 text-t4 p-4 h-[350px] space-y-2",style:e.style,children:awe.map((a,o)=>r.jsxs("div",{children:[r.jsx("div",{children:a.name}),r.jsx("div",{className:"flex items-center space-x-3",children:a.info.map((i,l)=>r.jsx(Cs,{popup:i.tip,delay:{open:300},children:r.jsx("div",{className:"border w-20 h-12 animate-hover",onClick:()=>{var c,d,u,f;if(e.onClose(),((c=i.chartMode)==null?void 0:c.type)==="Number")s(t,{chartMode:i.chartMode,xAxisPropertyId:"title",yAxisPropertyIds:[b4],groupAggregationPropertyId:""});else if(((d=i.chartMode)==null?void 0:d.type)==="Pie"){const h=((f=(u=n==null?void 0:n.yAxisPropertyIds)==null?void 0:u.length)!=null?f:0)>1;s(t,{chartMode:i.chartMode,groupAggregationPropertyId:"",statistics:h?"property":"record",[h?"yAxisPropertyIds":""]:[{propertyId:"title"}],orderRule:m.GroupSortType.ASCENDING})}else s(t,{chartMode:i.chartMode})},children:r.jsx("img",{className:"w-full h-full py-1.5",src:i.image})})},l))})]},o))})};let db,dH=Date.now(),uH="";const pwe=(e,t)=>{db=e,dH=Date.now(),uH=t},fH=async()=>{const e=Date.now(),t=Ot();if(e-dH>10*60*1e3||t!==uH)db=void 0;else if(db)return db;const s=ve.infra.searchDocs(t,{page:1,perPage:10,source:"quickFind",query:"",sort:m.SearchDocSortType.LAST_EDITED_NEWEST,filters:{isTitleOnly:!0,types:[m.BlockType.COLLECTION_VIEW,m.BlockType.COLLECTION_VIEW_PAGE]}});return pwe(s,t),s},gwe=()=>{const[e,t]=y.useState([]),n=$1();return y.useEffect(()=>{fH().then(s=>{var o,i,l;(o=s.recordMap)!=null&&o.blocks&&n(Tn.update({blocks:(i=s.recordMap)==null?void 0:i.blocks})),(l=s.recordMap)!=null&&l.collectionViews&&n(kl.update(s.recordMap.collectionViews));const a=s.results.map(c=>{var u,f,h;const d=(h=(u=s.recordMap)==null?void 0:u.blocks)==null?void 0:h[(f=c.pageId)!=null?f:""];if(d)return fg(d)}).filter(c=>c);t(a)})},[n]),e},YC=e=>{var n;const t=e==null?void 0:e.querySelector(".select-option");return(n=t==null?void 0:t.getBoundingClientRect().width)!=null?n:300},_we=()=>{var x,F,b,w,E,C,k;const e=ie(),t=y.useRef(null),n=y.useRef(null),s=di(),a=cr(s),o=(b=(F=(x=a==null?void 0:a.data.format)==null?void 0:x.chartFormat)==null?void 0:F.ref)==null?void 0:b.uuid,i=(C=(E=(w=a==null?void 0:a.data.format)==null?void 0:w.chartFormat)==null?void 0:E.ref)==null?void 0:C.viewId,l=Ce(T=>{var D,A,P;const{blocks:v,collectionViews:I}=T,j=v[s],S=(P=(A=(D=j==null?void 0:j.data.format)==null?void 0:D.chartFormat)==null?void 0:A.ref)==null?void 0:P.viewId;if(S)return I[S]},[s]),c=ye(o,["views","data"],["segments","format"]),d=ss(),u=nwe(),f=Ja(),h=gwe(),p=y.useMemo(()=>fe(c==null?void 0:c.data.segments)||qt(c==null?void 0:c.type),[c==null?void 0:c.data.segments,c==null?void 0:c.type]);y.useEffect(()=>{h.length&&(o||setTimeout(()=>{var T;(T=n.current)==null||T.click()},300))},[h]);const g=o?r.jsxs("div",{className:"flex items-center",children:[r.jsx(Fn,{blockId:o,trigger:!1,iconSize:20,defaultIcon:r.jsx(_s,{uuid:o,size:"middle"})}),r.jsx("div",{className:"ml-0.5",children:p})]}):void 0,_=l?r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{name:Ga[l.type],size:"middle"}),r.jsx("div",{className:"ml-0.5",children:l==null?void 0:l.title})]}):void 0;return a?r.jsxs("div",{ref:t,className:"w-full px-4 py-3",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"text-t2-medium",children:"数据源表格"}),r.jsx(Zl,{ref:n,title:g,className:"select-option",placeHolder:"请选择数据源",onClick:T=>{const v=YC(t.current);e.dropdown({popcorn:T.currentTarget,placement:"bottom",offset:[0,0],content:({onCloseModal:I})=>r.jsx(oc,{style:{width:v},defaultValue:h,placeholder:"搜索多维表",searchType:"collection",source:"collectionSettingsSource",onSelect:async j=>{f(j.uuid),_e(s,{data:{format:{chartFormat:{ref:{uuid:j.uuid,viewId:""}}}}},!1,d),I()}})})}}),r.jsx("div",{className:"text-t2-medium",children:"数据范围"}),r.jsx(Zl,{title:i===""?"全部数据":_,className:R({"cursor-not-allowed":!c}),placeHolder:"全部数据",onClick:T=>{var A,P,L;if(!o)return;const v=YC(t.current),I=d.getState(),j=c==null?void 0:c.views;if(!j)return;const D=[...j.map(O=>{var K,W,Y;const $=I.collectionViews[O];if(!$)return null;const M=$.title||wl[$.type],U=Ga[$.type];return{type:H.OPERATION,data:{icon:U,title:M,selected:((Y=(W=(K=a.data.format)==null?void 0:K.chartFormat)==null?void 0:W.ref)==null?void 0:Y.viewId)===O,selectColor:"var(--active_color)",onClick:()=>{u(s,o,O)}}}}).filter(O=>O)];D.unshift({type:H.OPERATION,data:{icon:Ga[m.CollectionViewType.TABLE],title:"全部数据",selected:!((L=(P=(A=a.data.format)==null?void 0:A.chartFormat)==null?void 0:P.ref)!=null&&L.viewId),selectColor:"var(--active_color)",onClick:()=>{u(s,o,"")}}},{type:H.LINE}),e.dropdown({popcorn:T.currentTarget,content:({onCloseModal:O})=>r.jsx("div",{style:{width:v},className:"next-modal max-h-[300px] overflow-auto",children:r.jsx(ze,{items:D,onItemClick:()=>{O()}})})})}}),r.jsx("div",{className:"text-t2-medium",children:"图表类型"}),r.jsx(Zl,{title:KFe((k=a.data.format)==null?void 0:k.chartFormat),placeHolder:"请选图表类型",onClick:T=>{const v=YC(t.current);e.dropdown({popcorn:T.currentTarget,content:({onCloseModal:I})=>r.jsx(hwe,{style:{scrollbarWidth:"none",width:v},onClose:I})})}})]}),r.jsx(mwe,{})]}):null},xwe=()=>{const e=di(),t=zg(),n=aH(e),s=ie(),a=y.useRef(null),o=oH(e),i=iH(e),l=lH(e);wd();const c=i==="number",d=FE.find(u=>u.en===i);return r.jsxs("div",{children:[r.jsx("div",{className:"text-t2-medium",children:"颜色"}),r.jsx("div",{className:"flex items-center mt-2 justify-between",children:gE.items.slice(1).map(u=>{const f=u.colorkey===n,h=tr(u.colorkey);return r.jsx("div",{className:R("animate-hover p-1",{"bg-black_006":f}),onClick:()=>{t(e,{numberColor:u.colorkey})},children:r.jsx("div",{className:"cursor-pointer rounded-full w-5 h-5",style:{backgroundColor:h}})},u.colorkey)})}),r.jsx(yu,{className:"my-4"}),r.jsx("div",{className:"text-t2-medium ",children:"数值格式"}),r.jsxs("div",{className:"text-t2 flex items-center space-x-4",children:[r.jsx("div",{className:"shrink-0",children:"数据格式"}),r.jsx(Zl,{title:d==null?void 0:d.zh,ref:a,className:"w-full",placeHolder:"请选择数据格式",onClick:u=>{var p;const f=(p=a.current)==null?void 0:p.getBoundingClientRect().width,h=ywe(i);s.dropdown({popcorn:u.currentTarget,content:({onCloseModal:g})=>r.jsx(ze,{style:{width:f},className:"next-modal",items:h,onItemClick:_=>{t(e,{numberFormat:_.data.en}),g()}})})}})]}),c&&r.jsxs("div",{className:"mt-3 text-t2 flex items-center space-x-4",children:[r.jsx("div",{className:"shrink-0",children:"小数位数"}),r.jsx(Ct,{type:"number",inputType:"number",className:"text-t2 w-full h-7.5 bg-white1",value:o,focusWidthBorder:!1,placeholder:"请输入小数位数",onChange:u=>{u>10&&(u=10),t(e,{numberFormatCount:u})}})]}),r.jsx(yu,{className:"my-4"}),r.jsx("div",{className:"text-t2-medium",children:"数值说明"}),r.jsx(Ct,{className:"text-t2 w-full h-7.5 bg-white1 mt-2.5",value:l,focusWidthBorder:!1,placeholder:"请输入说明内容",onChange:u=>{t(e,{numberDesc:u})}})]})},ywe=e=>{const t=[];return FE.forEach((n,s)=>{s===7&&t.push({type:H.LINE}),t.push({type:H.OPERABLE_BLOCK_TEXT,data:{title:n.zh,followTitle:!0,selected:e===n.en,selectColor:e===n.en?"var(--active_color)":void 0,desc:n.example,...n}})}),t},xv={top:"顶部",bottom:"底部",left:"左侧",right:"右侧",none:"不显示"},Ll=e=>{const[t,n]=y.useState(e.defaultChecked);return r.jsxs("div",{className:R("flex items-center text-t2",e.className),onClick:()=>{n(!t),e.onCheck(!t)},children:[r.jsx(_a,{size:"middle",checked:t,className:"mr-0.5"}),e.content]})},bwe=()=>{const e=di(),t=zg(),{showDataLabel:n,showGridLine:s,showXAxisLabel:a,showXAxisLine:o,showXAxisCalibration:i,showYAxisLabel:l,showYAxisLine:c,showYAxisCalibration:d,xAxisTtile:u,yAxisTtile:f}=cH(e);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-2 mt-4 w-full",children:[r.jsx(Ll,{defaultChecked:n,content:"数据标签",onCheck:h=>{t(e,{showDataLabel:h})}}),r.jsx(Ll,{defaultChecked:s,content:"网格线",onCheck:h=>{t(e,{showGridLine:h})}})]}),r.jsx(yu,{className:"my-4"}),r.jsx("div",{className:"text-t2-medium",children:"横轴"}),r.jsxs("div",{className:"grid gap-y-2 grid-cols-2  mt-4 w-full   flex-wrap",children:[r.jsx(Ll,{defaultChecked:a,content:"显示标签",onCheck:h=>{t(e,{showXAxisLabel:h})}}),r.jsx(Ll,{defaultChecked:o,content:"显示轴线",onCheck:h=>{t(e,{showXAxisLine:h})}}),r.jsx(Ll,{defaultChecked:i,content:"显示刻度",onCheck:h=>{t(e,{showXAxisCalibration:h})}})]}),r.jsx(yu,{className:"my-4"}),r.jsx("div",{className:"text-t2-medium",children:"纵轴"}),r.jsxs("div",{className:"grid gap-y-2 grid-cols-2  mt-4 w-full   flex-wrap",children:[r.jsx(Ll,{defaultChecked:l,content:"显示标签",onCheck:h=>{t(e,{showYAxisLabel:h})}}),r.jsx(Ll,{defaultChecked:c,content:"显示轴线",onCheck:h=>{t(e,{showYAxisLine:h})}}),r.jsx(Ll,{defaultChecked:d,content:"显示刻度",onCheck:h=>{t(e,{showYAxisCalibration:h})}})]}),r.jsx(yu,{className:"my-4"}),r.jsx("div",{className:"text-t2-medium",children:"轴标题"}),r.jsxs("div",{className:"mt-4 text-t2 flex items-center space-x-2",children:[r.jsx("div",{className:"shrink-0",children:"横轴标题"}),r.jsx(Ct,{className:"text-t2 w-full h-7 bg-white1",value:u,focusWidthBorder:!1,placeholder:"请输入标题",onChange:h=>{t(e,{xAxisTtile:h})}})]}),r.jsxs("div",{className:"text-t2 flex items-center space-x-2 mt-3",children:[r.jsx("div",{className:"shrink-0",children:"纵轴标题"}),r.jsx(Ct,{className:"text-t2 w-full h-7 bg-white1",value:f,focusWidthBorder:!1,placeholder:"请输入标题",onChange:h=>{t(e,{yAxisTtile:h})}})]})]})};var aa=(e=>(e[e.START=1]="START",e[e.RESIZING=2]="RESIZING",e[e.END=3]="END",e))(aa||{}),yv=(e=>(e.leftClick="leftClick",e.rightCLick="rightCLick",e.All="All",e))(yv||{});const qg=(e,t)=>{const{type:n="all",moveSlop:s=1,buttonType:a="leftClick",onResize:o,dispatchEvent:i=!1,compactMouseUp:l=!1}=t,c=y.useRef(o);c.current=o;const d=y.useRef(!1),u=y.useRef(!1);y.useEffect(()=>{const f=e.current;if(!f)return;let h=0,p=0,g=0,_=0,x;const F=E=>{if(!c.current)return;switch(a){case"leftClick":{if(E.button!==0)return;break}case"rightCLick":{if(E.button!==2)return;break}case"All":{if(E.button!==0&&E.button!==2)return;break}}i||(E.stopPropagation(),E.preventDefault()),d.current=!0,h=E.clientX,p=E.clientY,x={resizeStatus:1,downX:h,downY:p,moveX:0,moveY:0,deltaX:0,deltaY:0},c.current(x)&&(d.current=!1,x=void 0,g=0,_=0,h=0,p=0)},b=E=>{if(!c.current||!d.current||!x)return;E.stopPropagation();const C=E.clientX-h,k=E.clientY-p,T=C-g,v=k-_;let I=!1;switch(n){case"x":{I=Math.abs(T)>s;break}case"y":{I=Math.abs(v)>s;break}case"all":{I=Math.abs(T)>s||Math.abs(v)>s;break}}I&&(u.current=!0,x.moveX=C,x.moveY=k,x.deltaX=T,x.deltaY=v,x.resizeStatus=2,g=C,_=k,c.current(x))},w=E=>{if(!c.current||!d.current||!x)return;d.current=!1;const C=E.clientX-h,k=E.clientY-p,T=C-g,v=k-_;x.moveX=C,x.moveY=k,x.deltaX=T,x.deltaY=v,x.resizeStatus=3,c.current(x),x=void 0,g=0,_=0,h=0,p=0,u.current&&(E.stopPropagation(),u.current=!1)};return f.addEventListener("mousedown",F,!0),Ht.addEventListener("mousemove",b),Ht.addEventListener("mouseup",w),l&&Ht.addEventListener("click",w),()=>{l&&Ht.removeEventListener("click",w),Ht.removeEventListener("mouseup",w),Ht.removeEventListener("mousemove",b),f.removeEventListener("mousedown",F,!0)}},[a,l,i,e,s,n])},bv=({scale:e,onZoom:t,range:n,className:s})=>{var d;const a=y.useRef(null),o=y.useRef(null),i=IL(o),l=(d=i==null?void 0:i.width)!=null?d:0,c=e*l/n.max;return qg(a,{onResize:u=>{if(l!==0&&u.resizeStatus===aa.RESIZING){let f=(u.deltaX+c)*n.max/l;if(f>n.max||f<n.min)return;f=Math.round(f),t(f)}},type:"x"}),r.jsxs("div",{ref:o,className:R("w-full flex relative items-center cursor-pointer p-2",s),"data-ignore-double-click":!0,onClick:u=>{var p;const f=(p=o.current)==null?void 0:p.getBoundingClientRect();if(!f)return;let h=n.max*(u.clientX-f.left)/f.width;h>n.max||h<n.min||(h=Math.round(h),t(h))},children:[r.jsx("div",{className:"w-full h-[3px] rounded absolute bg-grey7 "}),r.jsx("div",{className:"h-[3px] rounded absolute bg-active_color ",style:{width:c}}),r.jsx("div",{ref:a,className:"absolute bg-white w-[18px] h-[18px] rounded-full cursor-pointer",style:{left:c-4,border:"1px solid rgba(0, 0, 0, 0.1)",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.1)"}})]})},S6=[{pos:"outside",desc:"外部"},{pos:"inside",desc:"内部"}],Fwe=()=>{const e=di(),t=zg(),{pieLabelPosition:n,showDataLabel:s,pieInsideRadius:a,pieOutsideRadius:o}=rwe(e);return r.jsxs(r.Fragment,{children:[r.jsx(Ll,{className:"mt-4",defaultChecked:s,content:"数据标签",onCheck:i=>{t(e,{showDataLabel:i})}}),s&&r.jsxs("div",{className:"mt-4 text-t2 flex items-center justify-between",children:[r.jsx("div",{children:"标签位置"}),r.jsx(AF,{active:S6.find(i=>i.pos===n),values:S6,onSwicth:i=>{t(e,{pieLabelPosition:i.pos})}})]}),r.jsx(yu,{className:"my-4"}),r.jsx("div",{className:"text-t2-medium",children:"半径"}),r.jsxs("div",{className:"mt-2 text-t2 text-grey3",children:[r.jsx("span",{children:"饼图内半径："}),r.jsxs("span",{className:"text-active_color",children:[a,"%"]})]}),r.jsx("div",{className:"pr-8",children:r.jsx(bv,{className:"mt-4 p-0",range:{min:0,max:100,step:5},scale:a,onZoom:i=>{t(e,{pieInsideRadius:i})}})}),r.jsxs("div",{className:"mt-10 text-t2 text-grey3",children:[r.jsx("span",{children:"饼图外半径："}),r.jsxs("span",{className:"text-active_color",children:[o,"%"]})]}),r.jsx("div",{className:"pr-8",children:r.jsx(bv,{className:"mt-6 p-0",range:{min:0,max:100,step:5},scale:o,onZoom:i=>{t(e,{pieOutsideRadius:i})}})})]})},wwe=()=>{var u,f;const e=y.useRef(null),t=ie(),n=Cwe(),s=di(),a=y4(s),o=lh(s),i=((u=o==null?void 0:o.chartMode)==null?void 0:u.type)==="Pie",l=Ewe(),{legendAlignPosition:c}=cH(s),d=Bo[a];return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2-medium",children:"主题色"}),r.jsx(Zl,{ref:e,title:r.jsx(mH,{colors:(f=d==null?void 0:d.theme.color.slice(0,6))!=null?f:[]}),className:"mt-2",placeHolder:"请选择数据源",onClick:h=>{var g;const p=(g=e.current)==null?void 0:g.getBoundingClientRect().width;t.dropdown({modalId:Ve.CHART_THEME,popcorn:h.currentTarget,content:()=>r.jsx("div",{style:{width:p},className:"next-modal max-h-[300px] overflow-auto",children:r.jsx(ze,{items:n})})})}}),r.jsx("div",{className:"text-t2-medium mt-4",children:"图例位置"}),r.jsx(Zl,{title:xv[c],className:"mt-2",placeHolder:"请选择数据源",onClick:h=>{var g;const p=(g=e.current)==null?void 0:g.getBoundingClientRect().width;t.dropdown({modalId:Ve.CHART_THEME,popcorn:h.currentTarget,content:({onCloseModal:_})=>r.jsx("div",{style:{width:p},className:"next-modal max-h-[300px] overflow-hidden",children:r.jsx(ze,{items:l,onItemClick:()=>{_()}})})})}}),i&&r.jsx(Fwe,{}),!i&&r.jsx(bwe,{})]})},Ewe=()=>{const e=di(),t=swe(e),n=zg();return Object.keys(xv).map(a=>{const o=xv[a];return{type:H.OPERATION,data:{title:o,selected:t===a,selectColor:"var(--active_color)",onClick:()=>{n(e,{legendAlignPosition:a})}}}})},Cwe=()=>{const e=ln(),t=di(),n=y4(t),s=zg();return y.useMemo(()=>Object.keys(Bo).map(o=>{var u;const i=Bo[o],l=n===o,c=(u=i==null?void 0:i.theme.color.slice(0,6))!=null?u:[];return{type:H.CUSTOM_RENDER,render:()=>r.jsxs("div",{className:"cursor-pointer justify-between flex items-center w-full py-2 px-4",onClick:()=>{s(t,{theme:o}),e(Ve.CHART_THEME)},children:[r.jsx(mH,{colors:c}),l&&r.jsx(V,{name:"IcCheck02",size:"small",className:"text-active_color"})]})}}),[t,e,n,s])},mH=({colors:e,backgroundColor:t})=>r.jsx("div",{className:"flex items-center w-full",style:{backgroundColor:t},children:e.map((n,s)=>r.jsx("div",{className:R("w-7 h-4",{"rounded-l-l":s===0,"rounded-r":s===e.length-1}),style:{backgroundColor:n}},s))}),kwe=()=>{var s;const e=y.useRef(null),t=di(),n=lh(t);return r.jsx("div",{ref:e,className:"w-full px-4 py-3 ",children:((s=n==null?void 0:n.chartMode)==null?void 0:s.type)==="Number"?r.jsx(xwe,{}):r.jsx(wwe,{})})},Twe=e=>{const{className:t}=e,[n,s]=y.useState(0);return r.jsxs("div",{className:t,children:[r.jsxs("div",{className:"px-3 flex items-center space-x-3",children:[r.jsx(D6,{title:"数据和类型",active:n===0,onClick:()=>{s(0)}}),r.jsx(D6,{title:"设置样式",active:n===1,onClick:()=>{s(1)}})]}),r.jsx(yu,{}),r.jsxs("div",{className:"chart-config-scroller overflow-auto h-[calc(100%-42px)]",children:[n===0&&r.jsx(_we,{}),n===1&&r.jsx(kwe,{})]})]})},D6=e=>r.jsx("div",{className:"flex items-center h-10 cursor-pointer",onClick:e.onClick,children:r.jsx("div",{className:R("text-t2",{"text-t2-medium text-active_color underline underline-offset-[13px]":e.active}),style:{textDecorationThickness:"2px"},children:e.title})});let hH;const vwe=e=>{hH=e},F4=({docId:e,pageScene:t,nameSpace:n})=>r.jsx(yd,{scope:pr,initialValues:[[nE,e]],children:r.jsx(Mo.Provider,{value:t,children:r.jsx(Vo.Provider,{value:n,children:r.jsx(Oo,{children:r.jsx(hH,{uuid:e})})})})});s_e(F4);const pH=e=>ft(e.id,n=>{var s,a,o;return(o=(a=(s=n==null?void 0:n.data.format)==null?void 0:s.chartFormat)==null?void 0:a.ref)==null?void 0:o.uuid})?r.jsx(F4,{docId:e.id,pageScene:e.preview?wt.PAGE_CHART:wt.MAIN}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-grey4",children:"请选择数据源"}),E2=e=>{const t=y.useMemo(()=>owe(e.id),[e.id]);return r.jsx(sH.Provider,{value:e.id,children:r.jsx(Mo.Provider,{value:wt.PAGE_CHART,children:r.jsx(z1,{store:t,children:r.jsx(Oo,{children:r.jsx(Iwe,{...e})})})})})},Iwe=e=>{const t=ss(),n=ft(e.id,o=>o==null?void 0:o.data.segments),s=ln(),a=y.useMemo(()=>fe(n),[n]);return r.jsxs("div",{className:"chart-panel flex flex-col min-w-[960px] w-[64vw] h-[80vh] overflow-auto",children:[r.jsxs("div",{className:"flex items-center content-between py-3 px-4",children:[r.jsx(Ct,{className:"text-h4 w-full h-9 bg-transparent",showBorder:!1,value:a,placeholder:"请输入图表名称",onChange:o=>{_e(e.id,{data:{segments:ht(o)}},!0,t)}}),r.jsx(V,{name:"IcClose",size:"middle",onClick:()=>{s(Ve.CHART_PANEL_ID)}})]}),r.jsx("div",{className:"w-full bg-grey7 h-px"}),r.jsxs("div",{className:"flex overflow-hidden h-full",children:[r.jsx("div",{className:"flex-1 overflow-hidden",children:r.jsx(pH,{id:e.id,preview:!0})}),r.jsx(Twe,{className:"w-[340px] border-l border-grey7"})]}),r.jsxs("div",{className:"shrink-0",children:[r.jsx("div",{className:"w-full bg-grey7 h-px"}),r.jsxs("div",{className:"w-full flex justify-end space-x-2 py-2",children:[r.jsx(De,{className:"px-6",onClick:()=>{s(Ve.CHART_PANEL_ID)},children:"取消"}),r.jsx(De,{colorType:"active",className:"!mr-4 px-6",onClick:()=>{const i=t.getState().blocks[e.id];hn(()=>{var l;_e(e.id,{data:{segments:i==null?void 0:i.data.segments,format:{chartFormat:{...(l=i==null?void 0:i.data.format)==null?void 0:l.chartFormat}}}}),s(Ve.CHART_PANEL_ID)})},children:"确定"})]})]})]})},Nwe=()=>{const e=ie();return y.useCallback(t=>{const{popcorn:n,blockId:s}=t;e.dropdown({popcorn:n,placement:"bottom-start",content:({onCloseModal:a})=>r.jsx(jwe,{close:a,blockId:s})})},[e])},jwe=({blockId:e,close:t})=>{const n=ye(e,["data"],["segments"]),s=(n==null?void 0:n.type)===m.BlockType.FILE,a=Oe(),o=s?Cp(n.data.segments).name:fe(n==null?void 0:n.data.segments),i=l=>{a(()=>{if(s){const c=Cp(n.data.segments);if(!l)return;_e(e,{data:{segments:ht(mI(l,c.extName))}})}else _e(e,{data:{segments:ht(l)}})})};return n?r.jsx("div",{className:"next-modal flex items-center p-1 rounded-t",style:{width:"365px"},children:r.jsx(Ct,{autoFocus:!0,showBorder:!1,defaultValue:o,onEnter:t,onChange:i,placeholder:qt(n.type),className:"w-full h-8 bg-grey8"})}):null},Swe=()=>{const e=ie(),t=lt();return y.useCallback((n,s)=>{const a=J.blocks[n];if(!a)return;const o=t===Ri("right"),i=bn('[data-block-id="'.concat(n,'"]'),o);i instanceof HTMLElement&&e.warning({title:r.jsx("div",{className:"w-[338px]",children:"确认取消同步?"}),content:a.type===m.BlockType.SYNC_CONTAINER?"取消后,其他".concat(i.dataset.syncCount,"个页面的同步块将无法再同步内容"):" ",confirmText:"取消同步",cancelText:"我再想想",confirm:s})},[e,t])},Dwe=()=>{const e=ie();return y.useCallback((t,n)=>{const s=t?"1":"多",a="当前同步块有".concat(s,"个页面正在同步,删除后其他同步块也将一并删除");e.warning({title:r.jsx("div",{className:"w-[338px]",children:"确定删除吗?"}),content:a,confirmText:"全部删除",cancelText:"取消",confirm:n})},[e])},gH=e=>{const{onCloseModal:t,blockId:n,items:s,disabledHasRecently:a,onColorSelect:o}=e,i=ye(n,[]),{selectedBlockHistory:l,selectedBlock:c}=Nl(),d=Oe();return r.jsx(Kw,{disabledHasRecently:a,items:s||H0,onColorSelect:u=>{o==null||o(u);const f=c.length?lr(c):[n];me.event("color",{block_name:No(n),is_background:u.isBgColor}),d(()=>{f.forEach(h=>{_e(h,{backgroundColor:u.isBgColor?u.colorkey:"",textColor:u.isBgColor?"":u.colorkey})}),l([])}),t(),(i==null?void 0:i.type)===m.BlockType.MARK&&l2({backgroundColor:u.isBgColor?u.colorkey:"",textColor:u.isBgColor?"":u.colorkey})}})},Awe=e=>{const t=n=>{var s;(s=e==null?void 0:e.onSelectPageInfo)==null||s.call(e,n)};return r.jsx(jN,{className:"py-2.5 relative",searchType:"file",placeholder:e.placeholder||"搜索文件",onSelect:t,fileType:e.fileType})},Rwe=e=>{const t=n=>{var o;const s=n.target.files;if(!s)return;const a=[];for(const i of s)a.push(i);(o=e.onSelectLocalFolder)==null||o.call(e,a)};return r.jsx("div",{className:"flex justify-center items-center h-[62px]",children:r.jsxs("label",{className:"w-[300px] h-8",children:[r.jsx("div",{className:"flex justify-center items-center rounded text-t4-medium active:opacity-50 text-align-center h-8 px-3.5 bg-active_color text-white hover:bg-active_color/90",children:e.title}),r.jsx("input",{type:"file",className:"hidden",webkitdirectory:"",mozdirectory:"",onChange:t})]})})},_H=e=>{var s;const t=Ur(),n=Zw();return r.jsxs(xg,{className:"next-modal w-[534px] sm:w-[370px]",children:[r.jsxs(Zr,{title:"上传",children:[!t&&r.jsxs("div",{className:"text-t2 p-4 flex items-center justify-between w-full",children:[r.jsxs("span",{children:["免费版","空间：单个文件大小不超过2MB"]}),r.jsx("span",{className:"text-active_color animate-click",onClick:()=>n(St.team),children:"升级上传更大文件"})]}),e.uploadFolder?r.jsx(Rwe,{title:e.title,onSelectLocalFolder:e.onSelectFolder}):r.jsx(gN,{inputAttribute:{accept:e.inputAccept},title:e.title,onSelect:e.onSelectFile})]}),!e.hideLink&&r.jsx(Zr,{title:(s=e.linkTitle)!=null?s:"链接",children:r.jsx(pN,{placeholder:e.linkPlaceHolder,onInputUrl:a=>{var o;(o=e.onSelectFile)==null||o.call(e,a)}})}),!e.hideLinkBlock&&r.jsx(Zr,{title:"引用文件",children:r.jsx(Awe,{fileType:e.fileType,placeholder:e.searchLinkFilePlaceholder,onSelectPageInfo:e.onSelectPageInfo})})]})},Pwe=e=>{const{defaultOpenPanel:t,readonly:n,ownerBlockId:s,uuid:a,title:o="添加附件"}=e,i=ch({uuid:a,ownerBlockId:s}),l=Oe();return r.jsx(vc,{className:R(n?"cursor-default":"cursor-pointer"),readonly:n,defaultOpenPanel:t,iconProp:{name:"IcUploadFile",size:"normal"},text:o,onClick:c=>{const d=c.currentTarget.getBoundingClientRect();l(()=>{i({getBoundingClientRect:()=>d})})}})},ch=e=>{const{uuid:t,ownerBlockId:n}=e,s=ye(n||t,["data"],["display","segments"]),a=ie(),o=Lwe(e),i=Oe();return y.useCallback((l,c,d)=>{if(!s)return;let u,f="文件",h=!1;switch(s.data.display){case"image":u="image/*,image/heic,image/heif",f="图片";break;case"video":u=G0e,f="视频";break;case"audio":u=W0e,f="音频";break;default:h=!0}a.dropdown({popcorn:l,placement:c!=null?c:"bottom",offset:d!=null?d:[],content:({onCloseModal:p})=>{let g=s.data.display;if(s.data.display)["image","audio","video"].includes(s.data.display)||(g=void 0);else{const{extName:_}=Cp(s.data.segments);Jt.image.test(_)&&(g="image"),Jt.video.test(_)&&(g="video"),Jt.audio.test(_)&&(g="audio")}return r.jsx(_H,{hideLink:h,linkTitle:"".concat(f,"链接"),linkPlaceHolder:"粘贴来自于网络的".concat(f,"链接"),inputAccept:u,title:"选择".concat(f,"(支持多选)"),searchLinkFilePlaceholder:"搜索".concat(f),fileType:g,onSelectFile:_=>{p(),o(_,g==="image")},onSelectPageInfo:_=>{_.uuid&&(i(()=>{var x;nr([s.uuid],{type:m.BlockType.REFERENCE,data:{ref:{uuid:_.uuid},display:((x=s.data.display)!=null?x:"file")==="file"?"file":g}})}),p())}})}})},[s,o,a,i])},Lwe=e=>{const{uuid:t,ownerBlockId:n}=e,s=ye(n||t,["data"],["viewMode","display"]),a=Oe(),o=Zoe(),i=s==null?void 0:s.data.viewMode,l=y.useCallback(c=>{const d=eh(c);let u=i;return i===fr.preview&&!d&&(u=fr.card,be.warning("当前格式不支持预览")),{newViewModel:u}},[i]);return y.useCallback(async(c,d)=>{if(typeof c=="string"){const f=c,h=rn(f),{newViewModel:p}=l(h.extName);a(()=>{_e(t,{type:m.BlockType.EXTERNAL_FILE,data:{link:c,viewMode:p,extName:h.extName,segments:ht(f)}})});return}const u=[n||t];c.forEach((f,h)=>{h!==0&&u.push(qe())}),o({files:c,inTransferList:!0,blockIds:u,type:"file",keys:u,onCapacitySuccess:async()=>{if(a(()=>{var h,p,g;let f=t;for(let _=1;_<c.length;_++){const x=u[_];f=ut({uuid:x,type:s==null?void 0:s.type,data:{display:s==null?void 0:s.data.display}},{parentId:(g=(p=s==null?void 0:s.parentId)!=null?p:ks((h=s==null?void 0:s.uuid)!=null?h:""))!=null?g:"",after:f})}}),re(Sa()),s!=null&&s.data.display&&["image","video"].includes(s==null?void 0:s.data.display))for(let f=0;f<c.length;f++){const h=c[f],p=u[f];try{const g=(s==null?void 0:s.data.display)==="video"?await F5(h):await hI(h),_=rn(h.name);_e(p,{data:{link:void 0,segments:ht(h.name),extName:_.extName,localUrl:d?URL.createObjectURL(h):void 0,viewMode:l(_.extName).newViewModel,...g}},!0)}catch(g){}}},onComplete:async f=>{if(f.success){const h=f.key,p=u.indexOf(h),g=c[p];if(!g||!h)return;const _=pe(),x=await g1(g),F=rn(g.name);a(()=>{const b={};d&&(b.localUrl=f.url),_e(h,{type:m.BlockType.FILE,data:{link:void 0,segments:ht(g.name),ossName:f.ossName,extName:F.extName,viewMode:l(F.extName).newViewModel,...b,...x,size:g.size}})},{state:_})}}})},[l,n,t,o,s==null?void 0:s.uuid,s==null?void 0:s.data.display,s==null?void 0:s.type,s==null?void 0:s.parentId,a])},xH=e=>{const{uuid:t}=e,n=ie(),s=Oe(),a=XO(),o=y.useCallback(async i=>{s(()=>{a({ownerPageId:t,files:i,spaceId:Ot(),userId:yt.uuid,type:"file",onComplete(){},inTransferList:!0})})},[s,a,t]);return y.useCallback((i,l,c)=>{n.dropdown({popcorn:i,placement:l!=null?l:"bottom",offset:c!=null?c:[],content:({onCloseModal:d})=>r.jsx(_H,{hideLinkBlock:!0,title:"请选择一个文件夹",uploadFolder:!0,onSelectFolder:u=>{d(),o(u)}})})},[o,n])},Bwe=e=>{const{blockId:t,onCloseModal:n}=e,s=Oe(),[a,o]=y.useState(0),i=ft(t,c=>c==null?void 0:c.parentId),l=()=>{var f,h;n();const{blocks:c}=pe(),d=c[(h=(f=c[t])==null?void 0:f.parentId)!=null?h:""];let u="";if((d==null?void 0:d.type)===m.BlockType.COLUMN&&(u=d.uuid),u){const p=c[u];p&&s(()=>{const g=[];for(let _=0;_<a;_++){const x=ut({type:m.BlockType.TEXTAREA},{parentId:p.uuid});x&&g.push(x)}g.length&&g.forEach(_=>{kF([_],p.uuid,"right")})})}else{const p=[];s(()=>{for(let g=0;g<a;g++){const _=ut({type:m.BlockType.TEXTAREA},{parentId:i!=null?i:"",after:t});_&&p.push(_)}if(p.length){let g=t;p.forEach(_=>{g=kF([_],g!=null?g:t,"right")})}})}};return r.jsxs("div",{className:"next-modal flex h-14 py-2.5 px-4 space-x-[5px] content-between",onMouseLeave:()=>{o(0)},children:[r.jsx(Fe,{popup:"一列分栏",children:r.jsx("div",{className:R("cursor-pointer w-5 h-full bg-grey5 opacity-30",{"opacity-100":a>=1}),onMouseEnter:()=>{o(1)},onClick:l})}),r.jsx(Fe,{popup:"两列分栏",children:r.jsx("div",{className:R("cursor-pointer w-5 h-full bg-grey5 opacity-30",{"opacity-100":a>=2}),onMouseEnter:()=>{o(2)},onClick:l})}),r.jsx(Fe,{popup:"三列分栏",children:r.jsx("div",{className:R("cursor-pointer w-5 h-full bg-grey5 opacity-30",{"opacity-100":a>=3}),onMouseEnter:()=>{o(3)},onClick:l})}),r.jsx(Fe,{popup:"四列分栏",children:r.jsx("div",{className:R("cursor-pointer w-5 h-full bg-grey5 opacity-30",{"opacity-100":a>=4}),onMouseEnter:()=>{o(4)},onClick:l})})]})},Owe=({onCloseModal:e,blockId:t})=>{const n=ye(t,["data"],["format"]),s=Oe();if(!n)return null;const a=n.type===m.BlockType.LIST,o=i=>i.map(l=>({type:H.OPERABLE_BLOCK_TEXT,data:l}));return r.jsx(ze,{className:R(Ra,"w-[200px]"),items:o(a?m5:h5),onItemClick:i=>{const{value:l}=i.data;s(()=>{wI({data:{format:{[a?"listFormat":"orderListFormat"]:l}}})}),e()},keyDownPriority:dr+1})},yH=e=>{var b,w,E,C,k,T,v,I,j,S,D,A,P,L,O,$;const t=ye(e.blockId,["data","backgroundColor"]),n=Oe(),s=ie(),a=y.useRef((w=(b=t==null?void 0:t.data.format)==null?void 0:b.cardFormat)==null?void 0:w.cardCaption),o=wd(),i=po(),l=ir(t==null?void 0:t.type),c=(C=(E=t==null?void 0:t.data.format)==null?void 0:E.cardFormat)==null?void 0:C.cardStyle,d=(v=(T=(k=t==null?void 0:t.data.format)==null?void 0:k.cardFormat)==null?void 0:T.showType)!=null?v:"default",u=Mwe(c),f=l||c==="thumbnailImage"||c==="thumbnailPage",h=df(),p=ya(),g=(S=!!(t!=null&&t.data.cover)&&((j=(I=t==null?void 0:t.data.format)==null?void 0:I.cardFormat)==null?void 0:j.isShowCover))!=null?S:!0;let _=!1;if(c==="regular"?_=!0:g||(_=!0),!t)return null;const x=M=>{const U=d==="large"?"large":"small",K=(M===0||M===2)&&o?"dark-":"",W="";return"".concat(W).concat(U,"-card-").concat(K).concat(M,".png")},F=[{type:H.CUSTOM_RENDER,disableCustomHoverBg:!0,render:()=>r.jsx("div",{className:"flex space-x-3 px-3 mt-4 mb-2.5",children:Array.from({length:4}).map((M,U)=>r.jsxs("div",{className:"relative",children:[r.jsx("img",{className:R("cursor-pointer hover:opacity-90 border border-transparent rounded-sm",{"border-active_color":u===U,"h-[64px]":d==="large","h-[35px]":d==="small"}),src:"".concat(Lo,"emoji/website/").concat(x(U)),onClick:()=>{var K,W,Y,G,ee,te,Q,ne,se;if(U===3&&i){h(()=>{p(Mt.page_card)});return}let z="regular";switch(U){case 1:z="fill";break;case 2:z="thumbnailPage";break;case 3:z="thumbnailImage";break}n(()=>{var ce;_e(e.blockId,{data:{format:{cardFormat:{...(ce=t.data.format)==null?void 0:ce.cardFormat,cardStyle:z}}}})}),me.event("page_card_style",{style_type:{showType:(Y=(W=(K=t==null?void 0:t.data.format)==null?void 0:K.cardFormat)==null?void 0:W.showType)!=null?Y:"default",cardStyle:z,isShowCover:(ee=(G=t==null?void 0:t.data.format)==null?void 0:G.cardFormat)==null?void 0:ee.isShowCover,isShowIcon:(Q=(te=t==null?void 0:t.data.format)==null?void 0:te.cardFormat)==null?void 0:Q.isShowIcon,cardCaption:!!((se=(ne=t==null?void 0:t.data.format)==null?void 0:ne.cardFormat)!=null&&se.cardCaption)}})}},U),U===3&&i&&r.jsx(_l,{})]}))})},{type:H.TEXT_SWITCH,isHidden:f,data:{title:"显示页面图标",switch:(P=(A=(D=t.data.format)==null?void 0:D.cardFormat)==null?void 0:A.isShowIcon)!=null?P:!0,onSwitch:M=>{var U,z,K,W,Y,G,ee,te,Q,ne,se,ce;n(()=>{var ae;_e(e.blockId,{data:{format:{cardFormat:{...(ae=t.data.format)==null?void 0:ae.cardFormat,isShowIcon:M}}}})}),me.event("page_card_style",{style_type:{showType:(K=(z=(U=t==null?void 0:t.data.format)==null?void 0:U.cardFormat)==null?void 0:z.showType)!=null?K:"default",cardStyle:(G=(Y=(W=t==null?void 0:t.data.format)==null?void 0:W.cardFormat)==null?void 0:Y.cardStyle)!=null?G:"regular",isShowCover:(te=(ee=t==null?void 0:t.data.format)==null?void 0:ee.cardFormat)==null?void 0:te.isShowCover,isShowIcon:(ne=(Q=t==null?void 0:t.data.format)==null?void 0:Q.cardFormat)==null?void 0:ne.isShowIcon,cardCaption:!!((ce=(se=t==null?void 0:t.data.format)==null?void 0:se.cardFormat)!=null&&ce.cardCaption)}})}}},{type:H.TEXT_SWITCH,isHidden:l,data:{title:"显示配图",switch:($=(O=(L=t.data.format)==null?void 0:L.cardFormat)==null?void 0:O.isShowCover)!=null?$:!0,onSwitch:M=>{var U,z,K,W,Y,G,ee,te,Q,ne,se,ce;n(()=>{var ae;_e(e.blockId,{data:{format:{cardFormat:{...(ae=t.data.format)==null?void 0:ae.cardFormat,isShowCover:M}}}})}),me.event("page_card_style",{style_type:{showType:(K=(z=(U=t==null?void 0:t.data.format)==null?void 0:U.cardFormat)==null?void 0:z.showType)!=null?K:"default",cardStyle:(G=(Y=(W=t==null?void 0:t.data.format)==null?void 0:W.cardFormat)==null?void 0:Y.cardStyle)!=null?G:"regular",isShowCover:(te=(ee=t==null?void 0:t.data.format)==null?void 0:ee.cardFormat)==null?void 0:te.isShowCover,isShowIcon:(ne=(Q=t==null?void 0:t.data.format)==null?void 0:Q.cardFormat)==null?void 0:ne.isShowIcon,cardCaption:!!((ce=(se=t==null?void 0:t.data.format)==null?void 0:se.cardFormat)!=null&&ce.cardCaption)}})}}},{type:H.CUSTOM_RENDER,disableCustomHoverBg:!0,render:()=>r.jsx("div",{className:R("mx-1.5 h-11 pl-2 flex justify-between items-center",{"animate-hover":_,"cursor-not-allowed":!_}),onClick:M=>{_&&s.dropdown({popcorn:M.currentTarget,content:({onCloseModal:U})=>r.jsx("div",{className:"next-modal py-1.5",children:r.jsx(Vm,{hideHeader:!0,className:"pb-2",colors:Uwe,value:t.backgroundColor,selectedIcon:r.jsx(V,{name:"IcCheck02",size:"normal",className:"text-[18px] text-white"}),onSelect:z=>{U(),n(()=>{_e(e.blockId,{backgroundColor:z,textColor:""})})},bgColorFn:cs})})})},children:r.jsxs(Fe,{disabled:_,popup:"配图开启后无法填充卡片颜色",className:R("w-full flex justify-between items-center"),children:[r.jsx("span",{className:"text-t2",children:"卡片填充色"}),r.jsx(WI,{disable:!_,colorkey:t.backgroundColor,desc:"",selected:!1,hover:!1,isBgColor:!0})]})})},{type:H.LINE,data:{},disableClick:!0},{type:H.OPERATION,data:{title:"自定义说明文字",onClick:M=>{var U;(U=e.onClose)==null||U.call(e),s.dropdown({popcorn:ra(M.currentTarget),closeAfterCallBack:()=>{var z,K,W,Y,G,ee,te,Q,ne,se;a.current!==void 0&&(n(()=>{var ce;_e(e.blockId,{data:{format:{cardFormat:{...(ce=t.data.format)==null?void 0:ce.cardFormat,cardCaption:a.current}}}})}),me.event("page_card_style",{style_type:{showType:(W=(K=(z=t==null?void 0:t.data.format)==null?void 0:z.cardFormat)==null?void 0:K.showType)!=null?W:"default",cardStyle:(ee=(G=(Y=t==null?void 0:t.data.format)==null?void 0:Y.cardFormat)==null?void 0:G.cardStyle)!=null?ee:"regular",isShowCover:(Q=(te=t==null?void 0:t.data.format)==null?void 0:te.cardFormat)==null?void 0:Q.isShowCover,isShowIcon:(se=(ne=t==null?void 0:t.data.format)==null?void 0:ne.cardFormat)==null?void 0:se.isShowIcon,cardCaption:!!a.current}}))},content:({onCloseModal:z})=>{var K,W;return r.jsx($U,{content:ht((W=(K=t.data.format)==null?void 0:K.cardFormat)==null?void 0:W.cardCaption),onTextChange:Y=>{a.current=Y},onEnter:Y=>{Y.preventDefault(),z()}})}})}},disableClick:!0}];return r.jsx("div",{className:"next-modal w-[400px] pb-1",children:r.jsx(ze,{items:F,className:"w-full mt-1"})})},Mwe=e=>{let t=0;return e==="fill"?t=1:e==="thumbnailPage"?t=2:e==="thumbnailImage"&&(t=3),t},Uwe=F1.items.map(e=>({key:e.colorkey,name:e.desc})),bH=e=>{var n;const t=ye(e,["data"],["format"]);return(n=t==null?void 0:t.data.format)==null?void 0:n.addImageBorder},Vwe=()=>{const e=Oe(),t=n=>{const s=pe(),{blocks:a,collectionViews:o,users:i}=s,l=a[n];l&&e(()=>{var c,d,u,f,h,p,g,_,x,F;if(l.type===m.BlockType.TABLE){const{tableBlockColumnOrder:b,tableBlockRowHeader:w}=(c=l==null?void 0:l.data.format)!=null?c:{};if(!b)return;const E=l.subNodes[0];if(!E)return;const C=a[E];if(!C)return;const k={},T=[];b.forEach((I,j)=>{var D;let S="";if(w){const A=(D=C.data.collectionProperties)==null?void 0:D[I];S=fe(A)}j===0?k.title={name:S||"标题",type:m.CollectionSchemaType.TITLE}:k[I]={name:Ci(k,S||void 0),type:m.CollectionSchemaType.TEXT},T.push({property:j===0?"title":I,visible:!0})});const v=w?l.subNodes.slice(1):l.subNodes;_e(n,{data:{schema:k},type:m.BlockType.COLLECTION_VIEW}),w&&gr(E),v.forEach(I=>{var S,D,A;const j=a[I];j&&_e(I,{type:m.BlockType.PAGE,data:{segments:(A=(D=j==null?void 0:j.data.collectionProperties)==null?void 0:D[(S=b[0])!=null?S:""])!=null?A:[]}})}),Io({title:"默认视图",format:{tableProperties:T,tableWrap:!0},pageSort:v,type:m.CollectionViewType.TABLE},{parentId:n})}if(l.type===m.BlockType.COLLECTION_VIEW){const b=(u=(d=l.views)!=null?d:[])==null?void 0:u.find(j=>{var S;return((S=o[j])==null?void 0:S.type)===m.CollectionViewType.TABLE}),w=o[b!=null?b:""];if(!w||!b)return;const E=qe(),C=(h=(f=w.format.tableProperties)==null?void 0:f.map(({property:j})=>j==="title"?E:j))!=null?h:[];l.subNodes.forEach(j=>{var D;const S=a[j];S&&_e(j,{type:m.BlockType.TABLE_ROW,data:{collectionProperties:{...S.data.collectionProperties,[E]:(D=S.data.segments)!=null?D:[]}}})});let T=nj({collectionId:l.uuid,records:l.subNodes,tableSchema:(p=l.data.schema)!=null?p:{},users:i,sorters:w.format.sorters,sort:w.pageSort});const v=kE({blocks:a,collectionViews:o,users:i,viewId:b,sortedRecordIds:T});v&&!v.withoutValidGroup&&(T=((_=(g=v.groups)==null?void 0:g.map(S=>S.recordIds))!=null?_:[]).flat()),_e(n,{subNodes:T,data:{format:{tableBlockColumnOrder:C,tableBlockRowHeader:!0}},type:m.BlockType.TABLE});const I={};(F=(x=w.format.tableProperties)!=null?x:[])==null||F.forEach(({property:j})=>{var S,D;I[j==="title"?E:j]=ht((D=(S=l.data.schema)==null?void 0:S[j])==null?void 0:D.name)}),ut({data:{collectionProperties:I},type:m.BlockType.TABLE_ROW},{first:!0,parentId:n}),PM(b)}})};return y.useCallback(t,[e])},$we=()=>{const e=ie();return y.useCallback(t=>{e.warning({title:t?"当前客户端版本过小":"达文件数量/大小处理上限",content:t?"请到官网下载最新版本":"请使用客户端",cancelText:"取消",confirmText:"去下载",colorType:"active",confirm:()=>{window.open(ds.appDownload)}})},[e])},C2=()=>{const e=sx();return y.useCallback(async t=>{var i;const{blocks:n}=pe(),s=n[t];if(!s)return;let a,o="".concat(Date.now());if(s.type===m.BlockType.EXTERNAL_FILE)a=s.data.link,o=s.data.link||o;else{o=fe(s.data.segments)||o,a=await Vs.fetchDownloadUrl({blockId:s.uuid,ossName:(i=s.data.ossName)!=null?i:"",fileName:o});const{extName:l}=rn(o);if(eh(l)==="image"){const{openImageWatermark:c,imageWatermarkText:d}=L1e(s.spaceId);c&&d&&(a=Tm(a,d))}}await e(),a&&cc(a,o)},[e])},dh=()=>{const e=ie(),t=ya(),n=C2(),s=$we(),a=m4();return async o=>{var c,d,u;o=o.filter(f=>{const h=J.blocks[f];return h?!![m.BlockType.FOLDER,m.BlockType.FILE,m.BlockType.EXTERNAL_FILE].includes(h.type):!1});const i=o[0];if(!i){be.error("没有可下载的内容");return}if(o.length===1&&((c=J.blocks[i])==null?void 0:c.type)!==m.BlockType.FOLDER){n(i);return}const l=(u=(d=J.blocks[i!=null?i:""])==null?void 0:d.spaceId)!=null?u:Pn().uuid;if(n5(l)){if(pt()){be.warning("批量下载仅面向专业版/团队版空间,,你可联系空间所有者进行升级");return}e.warning({maxWidth:360,title:"批量下载仅面向专业版/团队版空间",content:"当前空间为".concat(Zo(Rm(l).planType)),confirm:()=>t(Mt.bulk_download),colorType:"active",confirmText:"立即升级",cancelText:"暂不考虑"})}else{if(!yt.uuid){be.warning("批量下载需要先登录");const f=Xf(Nt.login,[{key:dn.callbackPath,value:location.pathname},{key:dn.quickRegister,value:"true"}]);setTimeout(()=>{Er("".concat(r1()).concat(f))},2500);return}if(gs.check){const f=Gbe(a);if(!a||f<115){s(!0);return}const p=(await ve.editor.blocksOssFileBatch({userId:yt.uuid,spaceId:l,blockIds:o})).blocks.flatMap(x=>x.id==null||x.ossName==null||x.title==null?[]:[{blockId:x.id,ossName:x.ossName,fileName:x.title}]),g=await ve.infra.createUrls({batch:p}),_=p.map((x,F)=>({...x,url:g[F].url}));await du.downloadMany({id:qe(),list:Hwe(_)})}else{const{modalId:f}=e.loading({title:"文件打包中"}),h=await ve.editor.filesDownloadBlocksOssZip.raw({userId:yt.uuid,spaceId:l,blockIds:o});if(h.code===200){const p=h.data;cc(p.url,p.name),be.success("打包成功"),e.closeModal(f);return}if(h.code===3223){s(!1),e.closeModal(f);return}be.success("失败"),e.closeModal(f)}}}};function Hwe(e){const t={};return e.map(n=>{const{fileName:s}=n;return t[s]?(t[s]++,n.fileName="".concat(s).concat(t[s]-1)):t[s]=1,n})}const zwe=e=>{var s,a;const t=w5(e);let n=J.blocks[e];n&&(n.type===m.BlockType.SYNC_REFERENCE&&(n=J.blocks[(a=(s=n.data.ref)==null?void 0:s.uuid)!=null?a:""]),n&&(il(n.subNodes,{parentId:n.parentId,after:t,first:!t}),gr(e)))},qwe=async(e,t)=>{var s,a;let n=J.blocks[e];if(n&&n.type===m.BlockType.SYNC_REFERENCE){if(n=J.blocks[(a=(s=n.data.ref)==null?void 0:s.uuid)!=null?a:""],!n)return;await t(Bu(n.subNodes,void 0,e),e),gr(e)}},Gwe=async e=>{const t=await eY.createWorker(["chi_sim"]);try{return(await t.recognize(e)).data.text}finally{t.terminate()}},Wwe=e=>(e=e.replace(/[ ]{2,}/g," "),e.split("\n").filter(s=>s.trim()).filter(s=>s.trim()).join("\n")),FH=()=>{const e=Rye(),t=Mi(),n=Ln(),s=Oe(),{selectedBlockHistory:a}=Nl();return(o,i)=>{var p;const{isOpenMenuList:l=!0,newBlock:c,syncId:d,pos:u="after"}=i||{},f=J.blocks[o],h=f&&ga((p=J.blocks[f.parentId])==null?void 0:p.type);if(f){if(f.type===m.BlockType.TEXTAREA&&Ep(f.data)&&!c){me.event("block_add"),es(100).then(()=>e(f.uuid,{isOpenMenuList:l,syncId:d})),a([]);return}if(h){const g=bn('[data-block-id="'.concat(o,'"]'),n),{viewId:_,groupValue:x}=g.dataset;if(_){const F=u==="after",b=Ig({viewId:_,groupValue:x});t({viewId:_,where:F?{after:f.uuid}:{before:f.uuid},propertyValues:b}),a([])}return}s(()=>{const g=ut({},{parentId:f.parentId,[u]:f.uuid});g&&(me.event("block_add"),es(100).then(()=>e(g,{isOpenMenuList:l,syncId:d})),a([]))})}}},w4=()=>{const e=FH();return t=>{const{pos:n}=t||{},s=n==="before"?ll(J.ui.selectedBlocks):An(J.ui.selectedBlocks);s&&(me.event(n==="before"?"insert_up":"insert_below",{block_name:No(s.blockId)}),e(s.blockId,{newBlock:!0,pos:n,syncId:s.syncId}))}},Kwe=e=>{const t=ye(e,["subNodes"]);return t&&t.subNodes.length>0&&[m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.TODO].includes(t.type)},Ywe=new Set([m.CollectionSchemaType.TITLE,m.CollectionSchemaType.ID_NUMBER,m.CollectionSchemaType.ROLLUP,m.CollectionSchemaType.FORMULA,m.CollectionSchemaType.CREATED_AT,m.CollectionSchemaType.CREATED_BY,m.CollectionSchemaType.UPDATED_AT,m.CollectionSchemaType.UPDATED_BY]),Xwe=()=>{const{viewId:e,collectionId:t}=Ne();lt();let[n=[]]=Fa(e,{visible:!0});const s=Ce(({collectionViews:p})=>p[e],[e]);n=n.filter(p=>!Ywe.has(p.type));const a=Ks(),o=ie(),i=y.useRef(null),l=ur(),{selectedBlockHistory:c}=Nl(),d=uh(),u=!!y.useContext(NI),f=Ce(p=>p.ui.selectedBlocks.filter(g=>g.viewId===e),[],{obsSelectBlocks:[{blockId:t,viewId:e,syncId:a}]});if(f.length===0||(s==null?void 0:s.type)!==m.CollectionViewType.TABLE)return null;const h=n.length*70;return r.jsxs("div",{className:"absolute next-modal flex items-center z-[1] -translate-x-0.5 overflow-hidden","data-no-cancel-selected":!0,children:[r.jsx(Os,{onClick:()=>{re(at.updateSelectBlocks([]))},highlight:!0,label:r.jsx("div",{className:"flex items-center",children:r.jsxs(r.Fragment,{children:[r.jsx("span",{children:"已选中"})," ",r.jsx("span",{className:"text-t2",children:f.length})," ",r.jsx("span",{children:"个"})]})})}),r.jsx("div",{className:"h-9 w-px bg-grey5"}),r.jsx(Cs,{popup:h>500?"滑动可编辑更多属性":"",delay:{open:400},children:r.jsx("div",{"data-disable-select":!0,className:"flex items-center max-w-[500px] overflow-auto",style:{scrollbarWidth:"none"},children:n.map((p,g)=>r.jsx(y.Fragment,{children:r.jsx(Qwe,{className:"border-r",collectionId:t,collectionProperty:p,onClick:_=>{var F,b,w,E;const x=J.ui.selectedBlocks.map(C=>C.blockId);if(p.type===m.CollectionSchemaType.CHECKBOX){const C=(E=(w=J.blocks[(b=(F=J.ui.selectedBlocks[0])==null?void 0:F.blockId)!=null?b:""])==null?void 0:w.data.collectionProperties)==null?void 0:E[p.property];us(fe(C))?l(x,p.property,ht("NO")):l(x,p.property,ht("YES"));return}o.dropdown({popcorn:_.currentTarget,content({onCloseModal:C}){var T;const k=wH(p.type);return r.jsx("div",{"data-no-cancel-selected":!0,className:"next-modal max-h-[80vh] disable-short-cut",style:k,ref:i,children:r.jsx(Qp.Provider,{value:i,children:r.jsx(i4,{site:Ye.CELL,viewId:e,recordId:(T=x[0])!=null?T:"",recordIds:x,propertyId:p.property,onUpdate:()=>{},onClose:C})})})}})}})},g))})}),!u&&r.jsx(r.Fragment,{children:r.jsx(Os,{icon:"IcTrash",onClick:()=>{let p="";const g=bM(t,lr(f)),_=g.length-f.length;_>0&&(p="包含了".concat(_,"个子项目")),o.warning({content:"将删除选中的 ".concat(g.length," 项数据，删除后可在收回站中恢复。").concat(p),className:"disable-cancel-selected",confirm(){hn(()=>{gr(g),c([])})}})}})}),r.jsx(Os,{className:"border-l",icon:"IcMore",onClick:p=>{var g,_;d({noSelect:!0,blockId:(_=(g=f[0])==null?void 0:g.blockId)!=null?_:"",blockNode:p.currentTarget})}})]})},Qwe=e=>{const{collectionId:t,collectionProperty:n}=e,{propertySchema:s}=eo(t,n.property);return s?r.jsx(Os,{className:e.className,icon:un[s.type],label:s.name,onClick:e.onClick}):null},wH=e=>{const t={};return(e===m.CollectionSchemaType.TEXT||e===m.CollectionSchemaType.TITLE||e===m.CollectionSchemaType.NUMBER||e===m.CollectionSchemaType.EMAIL||e===m.CollectionSchemaType.URL||e===m.CollectionSchemaType.PHONE)&&(t.width=250,t.minHeight=36),(e===m.CollectionSchemaType.SELECT||e===m.CollectionSchemaType.MULTI_SELECT)&&(t.minWidth=250,t.maxWidth=320,t.minHeight=36),t},EH=({popcorn:e,blockId:t,collectionId:n,selectedBlocks:s})=>{const a=k$(n),o=ur(),i=ie(),l=ln(),c=Ce(({blocks:f})=>{var h,p;return Object.entries((p=(h=f[n])==null?void 0:h.data.schema)!=null?p:{}).map(([g,_])=>({..._,propertyId:g})).filter(g=>g.type!==m.CollectionSchemaType.ID_NUMBER)},[n]),d=(f,h,p)=>{var F,b,w;const g=lr(s),_=s[0],x=g[0];if(!(!x||!_))if(h===m.CollectionSchemaType.CHECKBOX){const{blocks:E}=J,C=(b=(F=E[x])==null?void 0:F.data.collectionProperties)==null?void 0:b[f];o(g,f,us(fe(C))?"NO":"YES")}else if(h===m.CollectionSchemaType.ROLLUP)a(p,f,(w=_.viewId)!=null?w:"",e);else{const E=wH(h);re(at.update({selectedBlocks:[]})),i.dropdown({popcorn:e,placement:"right",content:({onCloseModal:C})=>r.jsx("div",{className:"next-modal",style:E,children:r.jsx(i4,{site:Ye.CELL,recordIds:g,viewId:_.viewId,recordId:x,propertyId:f,onUpdate:()=>{},onClose:C})})})}},u=[];return c.forEach(f=>{hm.includes(f.type)||u.push({type:H.OPERATION,data:{propertyId:f.propertyId,title:f.name,schemaType:f.type,icon:un[f.type]}})}),r.jsx(ze,{className:"next-modal-scroll w-[200px] py-[6px]",items:u,onItemClick:(f,h,p)=>{const{propertyId:g,schemaType:_}=f.data;l(t),d(g,_,p)}})},CH=()=>{const e=ie();return y.useCallback((t,n,s)=>{const a=J.blocks[t];a&&e.dropdown({popcorn:n,content:({onCloseModal:o})=>{const[i,l]=y.useState(a.data.openLink),[c,d]=y.useState(!!a.data.openLink);return r.jsx(fV,{inLink:s===void 0?c:!1,link:i!=null?i:"",onSetLink:u=>{hn(()=>{_e(a.uuid,{data:{openLink:u}})})},onLinkChange:u=>{l(u)},onClearLink:()=>{hn(()=>{_e(a.uuid,{data:{openLink:""}})})},onCloseModal:o})}})},[e])},Jwe=e=>{let t=-1,n=-1;for(const s of e)s.isHidden||n++,t!==-1&&(s==null?void 0:s.type)===H.LINE&&t+1===n&&(s.isHidden=!0),!s.isHidden&&s.type===H.LINE&&(t=n)},Zwe=e=>{var Se,Re,Ae,Me,Ge,tt,gt,kt,At,Qt,nn,sn,ms,N,B,X;const{onCloseModal:t,blockId:n,popcorn:s,focusEditableAt:a,viewId:o,syncId:i}=e,l=ye(n,["views","updatedBy","updatedAt","data"]),c=lt(),d=(Re=(Se=l==null?void 0:l.data.ref)==null?void 0:Se.uuid)!=null?Re:n,u=(l==null?void 0:l.type)===m.BlockType.FILE,f=_r((Ae=l==null?void 0:l.updatedBy)!=null?Ae:""),h=Oe(),p=GE(),g=dh(),{enableAI:_}=xr(),x=Nwe(),F=ch({uuid:n}),b=xH({uuid:n}),{selectedBlockHistory:w,selectedBlock:E}=Nl(),C=Pd(),k=pt(),T=_I(),v=Swe(),I=Vwe(),j=ff(),S=w4(),D=Dwe(),A=ys(),P=Ui(),L=Js(),O=ie(),$=bH(n),M=CH(),U=Hg(),{illegal:z,role:K}=mt(n);if(!l)return null;const W=()=>{const Z=s.getBoundingClientRect();u?F(s,"bottom",[0,-Z.height/2]):b(s,"bottom",[0,-Z.height/2])},{blocks:Y,collectionViews:G}=J,ee=Z=>E.every(oe=>{var Be;const xe=Y[oe.blockId];return!xe||ga((Be=Y[xe.parentId])==null?void 0:Be.type)?!1:Z.includes(xe.type)}),te=Une(E),Q=E.filter(Z=>{const oe=J.blocks[Z.blockId];return wp(oe)}).map(Z=>Z.blockId),ne=E.every(Z=>{const{role:oe,isRestricted:xe}=mn(Z.blockId);return xe?oe===m.PermissionRole.EDITOR:oe===m.PermissionRole.EDITOR||oe===m.PermissionRole.WRITER}),se=()=>{var Z,oe,xe;if(l.type===m.BlockType.TABLE)return!0;if(l.type===m.BlockType.COLLECTION_VIEW){const{collectionViews:Be}=J,Le=(Z=l.views)==null?void 0:Z.filter(rt=>!!Be[rt]);if(!Le||Le.length>1||((xe=Be[(oe=Le[0])!=null?oe:""])==null?void 0:xe.type)!==m.CollectionViewType.TABLE)return!1;const bt=l.data.schema;if(!bt)return!1;const Ue=new Set([m.CollectionSchemaType.RELATION,m.CollectionSchemaType.ROLLUP,m.CollectionSchemaType.FORMULA,m.CollectionSchemaType.CREATED_AT,m.CollectionSchemaType.UPDATED_AT,m.CollectionSchemaType.CREATED_BY,m.CollectionSchemaType.UPDATED_BY,m.CollectionSchemaType.FILE]);return!Object.values(bt).find(({type:rt})=>Ue.has(rt))}},ce=Bne(l.type),ae=ga((Me=Y[l.parentId])==null?void 0:Me.type);let de=!0;if(ae){const Z=G[o!=null?o:""];Z&&(Z.type===m.CollectionViewType.TIMELINE&&((Ge=Z.format.timelineColorSetting)==null?void 0:Ge.type)===m.CardColorSource.CUSTOM||Z.type===m.CollectionViewType.CALENDAR&&((tt=Z.format.calendarColorSetting)==null?void 0:tt.type)===m.CardColorSource.CUSTOM)&&(de=!1)}const ke=u&&l.data.display==="image",Te=Z=>{var xe,Be;const oe=(Be=(xe=l.data.segments)==null?void 0:xe.map(Le=>Le.type))!=null?Be:[];return Z.some(Le=>oe.includes(Le))};let he=!0;J.ui.selectedBlocks.length===1&&tn(l.type)&&(kt=(gt=l.data.format)==null?void 0:gt.cardFormat)!=null&&kt.showType&&((Qt=(At=l.data.format)==null?void 0:At.cardFormat)==null?void 0:Qt.showType)!=="default"&&(he=!1);const Ee={ai:!IE.has(l.type)||!_||Te([m.TextType.LINK_PAGE]),isRefBlock:l.type===m.BlockType.REFERENCE&&(l.data.display==="audio"||l.data.display==="video"||l.data.display==="image"),copyCutDelete:!1,tableConvert:!se(),turn:!ee(lI)||!ne||z,insert:!ne||!!(o&&((nn=J.collectionViews[o])==null?void 0:nn.type)===m.CollectionViewType.CALENDAR),turnInner:J.ui.selectedBlocks.length>1||l.type!==m.BlockType.COLLECTION_VIEW_PAGE&&l.type!==m.BlockType.REFERENCE_COLLECTION_PAGE&&l.type!==m.BlockType.MIND_MAPPING_PAGE,turnToPage:![m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION,m.BlockType.MIND_MAPPING].includes(l.type),color:!ee([...iI,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.BOOKMARK])||z||ir(l.type)||[m.BlockType.CODE].includes(l.type),down:!([m.BlockType.FILE,m.BlockType.EXTERNAL_FILE].includes(l.type)&&(l.data.ossName||l.data.link)||l.type===m.BlockType.FOLDER)&&!z,replace:![m.BlockType.FILE].includes(l.type)||!l.data.ossName||z,rename:![m.BlockType.FILE,m.BlockType.FOLDER].includes(l.type)||m.BlockType.FILE===l.type&&!l.data.ossName||z,copy:z||!Xn(mn(l.parentId).role,m.PermissionRole.WRITER),formatList:l.type!==m.BlockType.LIST&&l.type!==m.BlockType.ORDER_LIST,move:!ne,wordWrap:!kne(l)||![m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(mn(l.parentId).role),caption:!wp(l),recognizeImage:!(J.ui.selectedBlocks.length===1&&ke&&l.data.ossName),updatedBy:![m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(K)&&!k,template:m.BlockType.TEMPLATE!==l.type,unSync:J.ui.selectedBlocks.length>1||!ce||!Xn(mn(l.uuid).role,m.PermissionRole.WRITER),editProperty:!ae,recordColor:de,comment:J.ui.selectedBlocks.length>1||!w0(l)||ae||!Xn(mn(l.uuid).role,m.PermissionRole.COMMENTER),isPageBlock:J.ui.selectedBlocks.length>1||tn(l.type)||Yl(l)||Ib(l),copyPageLink:!tn(l.type)&&!Yl(l)&&!Ib(l),changeToDoc:!ir(l.type)||J.ui.selectedBlocks.length>1,contentAlignStyle:te.length!==J.ui.selectedBlocks.length,captionAlignStyle:Q.length!==J.ui.selectedBlocks.length,pageFormat:he,insertColumn:!ne||ae,chart:!(J.ui.selectedBlocks.length===1&&Nte(l))};Xn(K,m.PermissionRole.WRITER)||Object.keys(Ee).forEach(Z=>{Z==="copy"||Z==="comment"||(Ee[Z]=!0)});const ge=[{type:H.BLOCK_TRANSFORM,isHidden:!Ee.isRefBlock,disableCustomHoverBg:!0,render:()=>{var xe,Be,Le,bt,Ue,He,rt,je,le;let Z=(bt=(Le=Y[(Be=(xe=l.data.ref)==null?void 0:xe.uuid)!=null?Be:""])==null?void 0:Le.parentId)!=null?bt:"",oe=0;for(;((Ue=Y[Z])==null?void 0:Ue.type)!==m.BlockType.PAGE&&((He=Y[Z])==null?void 0:He.type)!==m.BlockType.FOLDER&&((rt=Y[Z])==null?void 0:rt.type)!==m.BlockType.FILE&&oe<100;)oe++,Z=(le=(je=Y[Z])==null?void 0:je.parentId)!=null?le:"";return r.jsxs("div",{className:"rounded w-full pl-2 pr-2",children:[r.jsx("div",{className:"text-grey4 text-t4 ml-1 my-2 pl-1",children:"引用源"}),r.jsx(Ir,{uuid:Z,interactable:!0,showUnderLine:!1,className:"flex items-center text-black text-t2 break-all line-clamp-1 active-bg animate-hover h-8 pl-2"})]})}},{isHidden:!Ee.isRefBlock,type:H.LINE,data:{},disableClick:!0},{type:H.OPERATION,isHidden:Ee.ai,data:{type:Xe.AI_EDITOR,icon:"IcAiFill",iconClassName:"text-[#A34DD9]",title:Qi.aiAssistantWithEmptyDoc,rightText:"".concat(Ds,"+J")}},{type:H.OPERATION,isHidden:!Ee.isPageBlock||J.ui.selectedBlocks.length>1,data:{type:Xe.OPEN_TAB,icon:"IcJumpTo",title:"在新选项卡中打开"}},{type:H.OPERATION,isHidden:!Ee.isPageBlock||J.ui.selectedBlocks.length>1,data:{type:Xe.OPEN_RIGHT_PAGE,icon:"IcOpenInSide",title:"在侧边栏中打开"}},{type:H.OPERATION,isHidden:Ee.copyCutDelete,data:{type:Xe.COPY_CLIPBOARD,icon:"IcCopy",title:"复制",rightText:"".concat(Ds,"+C")}},{type:H.OPERATION,isHidden:Ee.copyCutDelete,data:{type:Xe.CUT,icon:"IcCut",title:"剪切",rightText:"".concat(Ds,"+X")}},{type:H.OPERATION,isHidden:Ee.copy,data:{type:Xe.COPY,icon:"IcDuplicate",title:"拷贝副本",rightText:"".concat(Ds,"+D")}},{type:H.OPERATION,isHidden:Ee.copy,data:{type:Xe.COPY_MOVE,icon:"IcCopyToPage",title:"拷贝副本至页面"}},{type:H.OPERATION,isHidden:Ee.template,data:{type:Xe.TEMPLATE,icon:"MIcListSeetings",title:"设置模板按钮",onClick:()=>{Vi(n,!0,!1),re(at.updateSelectBlocks([])),a(n,fe(l.data.segments).length)}}},{type:H.OPERATION,isHidden:Ee.turnToPage,data:{type:Xe.TURN_TO_PAGE,icon:"IcTurnInto",title:"转换为页面"}},{type:H.OPERATION,isHidden:Ee.changeToDoc,data:{icon:"IcTurnInto",title:"转换为页面内容",onClick:()=>{h(()=>{var oe,xe,Be;const Z=(Be=(xe=(oe=l.data.format)==null?void 0:oe.mindMappingFormat)==null?void 0:xe.oldBlockType)!=null?Be:m.BlockType.TEXTAREA;nr([l.uuid],{type:Z})}),me.event("turninto_page_content")}}},{type:H.OPERATION,isHidden:Ee.tableConvert,data:{type:Xe.TABLE_CONVERT,icon:"IcTurnInto",title:l.type===m.BlockType.TABLE?"转换为多维表":"转换为简单表格"}},{type:H.OPERATION,isHidden:Ee.turnInner,data:{type:Xe.TURN_TO_EMBED,icon:"IcTurnInto",title:"转换为嵌入"}},{type:H.OPERATION,isHidden:Ee.rename,data:{type:Xe.RENAME,icon:"IcEdit02",title:"重命名"}},{type:H.OPERATION,isHidden:Ee.turn,data:{icon:"IcTurnInto",title:"转换为",hasArrow:!0,renderSubMenu:()=>r.jsx(r4,{...e})}},{type:H.OPERATION,isHidden:Ee.isPageBlock,data:{icon:"IcLink",title:"拷贝块访问链接",onClick:()=>{const Z=i?"?s=t":"",oe=ks(l.uuid);Xt("".concat(_n(),"/").concat(oe).concat(Z,"#").concat(l.uuid))},rightText:"F"}},{type:H.OPERATION,isHidden:Ee.copyPageLink||J.ui.selectedBlocks.length>1,data:{icon:"IcLink",title:"拷贝页面访问链接",onClick:()=>{var xe;const oe=Yl(l)?(xe=Om(n))==null?void 0:xe.uuid:n;me.event("copy_page_link"),Xt("".concat(_n(),"/").concat(oe))},rightText:"F"}},{type:H.OPERATION,isHidden:Ee.copyCutDelete,data:{type:Xe.DELETE,icon:"IcTrash",title:"删除",rightText:"Del"}},{isHidden:Ee.move,type:H.LINE,data:{},disableClick:!0},{type:H.OPERATION,isHidden:Ee.down,data:{icon:"IcDownload",title:"下载",onClick:()=>g(lr(J.ui.selectedBlocks))}},{type:H.OPERATION,isHidden:Ee.replace,data:{icon:"IcTurnInto",title:"替换",onClick:W}},{type:H.OPERATION,isHidden:Ee.unSync,data:{icon:"IcMenuUnsync",title:l.type===m.BlockType.SYNC_REFERENCE?"取消同步":"取消全部同步",onClick:()=>{const Z=jD(Bu(n),!0),oe=()=>{T(async()=>{l.type===m.BlockType.SYNC_CONTAINER?zwe(n):await qwe(n,p)})};Z?v(n,oe):oe()}}},{type:H.OPERATION,isHidden:Ee.editProperty,data:{icon:"IcList",title:"编辑属性",hasArrow:!0,renderSubMenu:()=>r.jsx(EH,{popcorn:s,blockId:l.uuid,collectionId:l.parentId,selectedBlocks:J.ui.selectedBlocks})}},{type:H.OPERATION,isHidden:Ee.recordColor,data:{icon:"IcColor",title:"颜色",hasArrow:!0,renderSubMenu:()=>r.jsx("div",{className:"next-modal py-1.5",children:r.jsx(Vm,{value:l.data.collectionCardColor,onSelect:Z=>{o&&h(()=>{_e(l.uuid,{data:{collectionCardColor:Z}})})}})})}},{type:H.OPERATION,isHidden:Ee.move,data:{icon:"IcMove",title:"移动到",rightText:"".concat(Ds,"+Shift+P"),onClick:()=>{me.event("moveto_blockmenu_click",{block_name:No(n)}),C({popcorn:s,uuid:n,placement:"left",offset:[0,20]})}}},{isHidden:Ee.color,type:H.LINE,data:{},disableClick:!0},{type:H.OPERATION,isHidden:Ee.color,data:{icon:"IcColor",title:"颜色",hasArrow:!0,renderSubMenu:()=>r.jsx(gH,{blockId:n,onCloseModal:t})}},{type:H.OPERATION,isHidden:Ee.pageFormat,data:{icon:"IcMenuPageStyle",title:"样式设置",hasArrow:!0,renderSubMenu:()=>r.jsx(yH,{blockId:l.uuid,onClose:t})}},{type:H.OPERATION,isHidden:Ee.contentAlignStyle,data:{icon:"IcAlignLeft",title:"对齐方式",hasArrow:!0,renderSubMenu:()=>r.jsx(cF,{blockIds:te,closeModal:t})}},{isHidden:Ee.color||Ee.contentAlignStyle,type:H.LINE,data:{},disableClick:!0},{type:H.OPERATION,isHidden:Ee.recognizeImage||!1,data:{icon:"IcShow",title:"识别文字",onClick:async()=>{be.loading({key:"recognizeImage",content:"识别中"});const Z=bn('[data-image-id="'.concat(n,'"]'));if(Z instanceof HTMLImageElement){let oe=await Gwe(Z);if(be.closeMessage("recognizeImage"),oe=Wwe(oe),!oe.trim()){be.warning("当前图片无法识别出文字");return}O.warning({content:oe,minWidth:300,colorType:"secondary",confirmText:"复制文本",cancelText:"插入到图片下方",cancelColorType:"active",cancel:()=>{h(()=>{_e(n,{data:{caption:ht(oe)}})})},confirm(){Xt(oe)}})}}}},{type:H.TEXT_SWITCH,isHidden:Ee.recognizeImage,data:{switch:$,icon:"IcImage",title:"图片边框",iconSize:"small",onSwitch:Z=>{h(()=>{_e(n,{data:{format:{addImageBorder:Z}}})})}}},{type:H.OPERATION,isHidden:Ee.recognizeImage,data:{icon:"IcLink",title:"添加超链接",onClick:()=>{M(n,s,!0)}}},{type:H.OPERATION,isHidden:Ee.caption,data:{icon:"IcAddDescription",title:"添加说明",onClick:()=>{re(at.updateSelectBlocks([])),_e(n,{data:{showEmptyCaption:!0,format:{isShowCaption:!0}}}),l.type===m.BlockType.FILE&&l.data.display==="image"&&L(Je.CREATE_IMAGE_BLOCK,ct.basicList,{step2:!0}),a(n,0,"caption"),me.event("block_caption",{block_name:No(n)})}}},{type:H.OPERATION,isHidden:Ee.captionAlignStyle,data:{icon:"IcDescriptionSetting",title:"说明设置",hasArrow:!0,renderSubMenu:()=>r.jsx(cF,{blockIds:Q,isCaption:!0,closeModal:t})}},{type:H.OPERATION,isHidden:Ee.comment,data:{icon:"IcComment",title:"添加评论",rightText:"".concat(Ds,"+Shift+M"),onClick:()=>{j({blockId:n})}}},{type:H.OPERATION,isHidden:Ee.chart,data:{icon:"IcSettings",title:"图表配置",onClick:()=>{O.modal({autoClose:!1,modalId:Ve.CHART_PANEL_ID,className:"rounded-md",content:()=>r.jsx(E2,{id:e.blockId})})}}},{type:H.TEXT_SWITCH,isHidden:Ee.chart,data:{icon:"IcFileCheckSmall",iconSize:"small",title:"图表边框",switch:(N=(ms=(sn=l.data.format)==null?void 0:sn.chartFormat)==null?void 0:ms.border)!=null?N:!0,onSwitch:Z=>{h(()=>{U(l.uuid,{border:Z})})}}},{type:H.OPERATION,isHidden:Ee.chart,data:{icon:"IcDownload",iconSize:"small",title:"下载图片",onClick:()=>{xn.emit("chart2png")}}},{type:H.TEXT_SWITCH,isHidden:Ee.wordWrap,data:{title:"自动换行",switch:(X=(B=l.data.format)==null?void 0:B.codeWrap)!=null?X:!1,onSwitch:()=>{h(()=>{var Z,oe;_e(n,{data:{format:{codeWrap:!((oe=(Z=l.data.format)==null?void 0:Z.codeWrap)!=null&&oe)}}})})}}},{isHidden:Ee.formatList,type:H.LINE,data:{},disableClick:!0},{type:H.OPERATION,isHidden:Ee.formatList,data:{icon:"IcMenuListFormat",title:"标记格式设置",hasArrow:!0,renderSubMenu:()=>r.jsx(Owe,{blockId:n,onCloseModal:t})}},{type:H.LINE,data:{},disableClick:!0,isHidden:Ee.insert},{type:H.OPERATION,isHidden:Ee.insert,data:{icon:"IcArrowUp02",title:"在上方插入块",rightText:"A",onClick:()=>{S({pos:"before"})}}},{type:H.OPERATION,isHidden:Ee.insert,data:{icon:"IcArrowDown02",title:"在下方插入块",rightText:"B",onClick:()=>{S({pos:"after"})}}},{type:H.OPERATION,isHidden:Ee.insertColumn,data:{icon:"IcBlockRightColumns",title:"向右方添加分栏",hasArrow:!0,renderSubMenu:()=>r.jsx(Bwe,{blockId:n,onCloseModal:t})}},{isHidden:Ee.updatedBy,type:H.LINE,data:{},disableClick:!0}];return Jwe(ge),r.jsx(ze,{className:Ra,items:ge,customFooter:!Ee.updatedBy&&r.jsx(Zm,{name:f,updatedAt:l.updatedAt,isByAI:l.data.isByAI}),onItemClick:async Z=>{var oe,xe,Be,Le;if(!Z.data.hasArrow){t();const{type:bt}=Z.data,Ue=E.length?E:Bu(n,o,i);switch(bt){case Xe.CUT:{document.execCommand("cut");break}case Xe.COPY_CLIPBOARD:{document.execCommand("copy");break}case Xe.DELETE:{const He=jD(Ue);if(He){D(He.onlyOne,async()=>{l.type===m.BlockType.SYNC_CONTAINER&&h(()=>{gr(lr(Ue)),w([])})});return}const rt=ks(n);if(ir((oe=J.blocks[rt!=null?rt:""])==null?void 0:oe.type)&&ke){h(()=>{nr([n],{type:m.BlockType.TEXTAREA,data:{segments:l.data.caption}})});return}me.event("delete",{block_name:No(n)}),h(()=>{gr(lr(Ue)),w([])});break}case Xe.COPY:{me.event("duplicate",{block_name:No(n)}),p(Ue,void 0,i);break}case Xe.COPY_MOVE:{C({popcorn:s,uuid:n,placement:"left",offset:[0,20],placeholder:"搜索拷贝到...的页面",copyAndMove:{syncId:i,viewId:o}});break}case Xe.TABLE_CONVERT:{I(n);break}case Xe.TURN_TO_EMBED:{switch(l.type){case m.BlockType.COLLECTION_VIEW_PAGE:ve.editor.getDoc(n).then(He=>{re(Tn.update({blocks:He.blocks})),re(kl.update(He.collectionViews)),h(()=>{_e(n,{type:m.BlockType.COLLECTION_VIEW})})});break;case m.BlockType.REFERENCE_COLLECTION_PAGE:{h(()=>{_e(n,{type:m.BlockType.REFERENCE_COLLECTION})});break}case m.BlockType.MIND_MAPPING_PAGE:{h(()=>{_e(n,{type:m.BlockType.MIND_MAPPING})});break}}break}case Xe.TURN_TO_PAGE:{let He=m.BlockType.PAGE;switch(l.type){case m.BlockType.COLLECTION_VIEW:He=m.BlockType.COLLECTION_VIEW_PAGE;break;case m.BlockType.REFERENCE_COLLECTION:He=m.BlockType.REFERENCE_COLLECTION_PAGE;break;case m.BlockType.MIND_MAPPING:He=m.BlockType.MIND_MAPPING_PAGE;break}h(()=>{_e(n,{type:He})}),me.event("turninto_page",{block_type:l.type});break}case Xe.RENAME:{x({popcorn:s,blockId:n});break}case Xe.OPEN_RIGHT_PAGE:{A(d,{forceOpenInRight:!0});break}case Xe.OPEN_TAB:{window.open("/".concat(d));break}case Xe.AI_EDITOR:{let He=0;const rt=(Be=(xe=Y[l.parentId])==null?void 0:xe.subNodes)!=null?Be:[];J.ui.selectedBlocks.forEach(({blockId:Tt})=>{He=Math.max(rt.indexOf(Tt),He)});const je=(Le=rt[He])!=null?Le:n,le=c===Ri("right");let Qe=bn('[data-block-id="'.concat(je,'"]'),le);if(Qe||(Qe=bn('[data-block-id="'.concat(n,'"]'),le)),!Qe)return;P({blockId:n,popcorn:Qe,editorScene:it.BlockSelected,from:ho.BlockMenu});break}}}}})},uh=()=>{const e=y.useContext(od),t=A0(),n=ie();return y.useCallback(s=>{const{blockId:a,menuPosition:o,blockNode:i,noSelect:l,offset:c=[0,22]}=s,d=ra(o||i),{blocks:u}=J,f=u[a],p=(f==null?void 0:f.type)===m.BlockType.COLLECTION_VIEW||(f==null?void 0:f.type)===m.BlockType.REFERENCE_COLLECTION?"left-start":"left",{syncId:g,viewId:_}=i.dataset,x=Qxe(i)||fd(a,void 0,g),F=(w,E,C,k)=>{var v;if(!w)return;J.blocks[w];const T=fd(w,void 0,(v=k==null?void 0:k.syncId)!=null?v:g);t2(T,E,C)};n.dropdown({modalId:a,popcorn:d,placement:p,offset:c,modifiers:[{name:"flip",options:{fallbackPlacements:[p,"right"]}}],closeBeforeCallBack:t,content:({onCloseModal:w})=>r.jsx(od.Provider,{value:e,children:r.jsx(Zwe,{focusEditableAt:F,blockId:a,syncId:g,viewId:_,editorKey:x,popcorn:d,onCloseModal:w})})});const{selectedBlocks:b}=J.ui;if(!l){const{viewId:w,groupValue:E,syncId:C}=i.dataset;b.find(k=>k.blockId===a&&k.viewId===w?!k.groupValues||!E?!0:Object.keys(k.groupValues).includes(E):!1)||re(at.updateSelectBlocks([{blockId:a,viewId:w,syncId:C,groupValues:E?{[E]:[]}:void 0}])),st({$focusedInSyncBlockId:""})}st({$blockMenuListId:a})},[t,n,e])},E4=e=>{const t=We(e.blockId),n=ie(),s=ff(),a=Nr(),o=uh();return t?null:r.jsxs("div",{className:R("text-t3 flex items-center h-7.5",e.className),children:[r.jsx(Cs,{popup:"配置",className:"w-8 h-7.5 animate-hover animate-click shrink-0 rounded-none",onClick:()=>{n.modal({autoClose:!1,modalId:Ve.CHART_PANEL_ID,className:"rounded-md",content:()=>r.jsx(E2,{id:e.blockId})})},children:r.jsx(V,{size:"middle",className:"text-grey2",name:"IcSettings"})}),r.jsx("div",{className:"h-full bg-grey8 w-px"}),r.jsx(Cs,{popup:"对齐方式",className:"w-8 h-7.5 animate-hover animate-click shrink-0 rounded-none",onClick:i=>{n.dropdown({placement:"top",popcorn:i.currentTarget,content:({onCloseModal:l})=>r.jsx(cF,{blockIds:[e.blockId],closeModal:l})})},children:r.jsx(V,{size:"middle",className:"text-grey2",name:"IcAlignLeft"})}),r.jsx("div",{className:"h-full bg-grey8 w-px"}),r.jsx(Cs,{popup:"评论",className:"w-8 h-7.5 animate-hover animate-click shrink-0 rounded-none",onClick:i=>{s({blockId:e.blockId,popcorn:i.currentTarget})},children:r.jsx(V,{size:"middle",className:"text-grey2",name:"IcComment"})}),r.jsx("div",{className:"h-full bg-grey8 w-px"}),r.jsx(Cs,{popup:"添加说明",className:"w-8 h-7.5 animate-hover animate-click shrink-0  rounded-none",onClick:()=>{re(at.updateSelectBlocks([])),_e(e.blockId,{data:{showEmptyCaption:!0,format:{isShowCaption:!0}}}),a(e.blockId,0,"caption"),me.event("block_caption",{block_name:No(e.blockId)})},children:r.jsx(V,{size:"middle",className:"text-grey2",name:"IcAddDescription"})}),r.jsx(Cs,{popup:"更多",className:"w-8 h-7.5 animate-hover animate-click shrink-0  rounded-none",onClick:i=>{const l=document.querySelector('[data-block-id="'.concat(e.blockId,'"]'));o({menuPosition:i.currentTarget,blockId:e.blockId,blockNode:l,placement:"right-end",offset:[0,8]})},children:r.jsx(V,{size:"middle",className:"text-grey2",name:"IcMore"})})]})},RF=e=>{const t=ie(),n=ft(e.id,c=>c==null?void 0:c.data.segments),s=lH(e.id),a=e.type==="segments",o=y.useRef(null),i=We(e.id),l=y.useMemo(()=>xp(n),[n]);return a&&!l||!a&&!s?null:r.jsx("div",{ref:o,className:R("text-left px-5 z-20  text-ellipsis w-[96%]",e.className),onClick:c=>{i||t.dropdown({placement:"bottom-start",offset:[-4,-30],popcorn:c.currentTarget,content:({onCloseModal:d})=>{var f;const u=((f=o.current)==null?void 0:f.getBoundingClientRect().width)||300;return r.jsx(eEe,{onClose:d,id:e.id,title:a?l:s,width:u,type:e.type})}})},children:a?l:s})},eEe=e=>{const t=zg(),n=e.type==="segments",[s,a]=y.useState(e.title),o=y.useRef(s);return o.current=s,y.useEffect(()=>()=>{hn(()=>{e.type==="segments"?_e(e.id,{data:{segments:ht(o.current)}}):t(e.id,{numberDesc:o.current})})},[e.id,e.type,t]),r.jsx("input",{style:{width:e.width},autoFocus:!0,className:R("px-2  h-8 next-modal",{"text-h4":n,"text-t2 text-center":!n}),value:s,onChange:i=>{a(i.currentTarget.value)},onKeyDown:i=>{Ie("Enter")(i)&&e.onClose()}})},kH=()=>y.useCallback(async e=>{var p;const{collectionId:t,viewId:n,store:s,recordIds:a,callback:o}=e,i=s.getState(),l=i.blocks[t];if(!l)return;let c=a;n||(c=(p=l==null?void 0:l.subNodes)!=null?p:[]);const d=l==null?void 0:l.data.schema;if(!d)return;const u=new Map;Object.keys(d).forEach(g=>{const _=d[g];_&&sEe(_.type)&&u.set(g,_)});const f=new Set;u.forEach((g,_)=>{c.forEach(x=>{var b,w,E;const F=i.blocks[x];if(F)if(g.type===m.CollectionSchemaType.PERSON){const C=(b=F.data.collectionProperties)==null?void 0:b[_];ru(C).forEach(k=>{var v;Rn((v=k.uuid)!=null?v:"","")||k.uuid&&f.add(k.uuid)})}else g.type===m.CollectionSchemaType.CREATED_BY?F.createdBy&&(Rn((w=F.createdBy)!=null?w:"","")||f.add(F.createdBy)):g.type===m.CollectionSchemaType.UPDATED_BY&&F.updatedBy&&(Rn((E=F.updatedBy)!=null?E:"")||f.add(F.updatedBy))})});const h=[...f];h.length!==0&&await tEe(s,h,o)},[]);let v_=[],Fv=[];const tEe=async(e,t,n)=>(v_.push(...t),Fv.push(n),v_=[...new Set(v_)],nEe(e,v_)),nEe=qn(async(e,t)=>{v_=[];const n=Fv;Fv=[];const s=await ve.editor.queryRecords({requests:[...t].map(a=>({id:a,table:"user"}))});if(s.users)return e.dispatch(Ha.updateSpaceUsers({users:s.users})),n.forEach(a=>a()),!0},300),sEe=e=>e===m.CollectionSchemaType.PERSON||e===m.CollectionSchemaType.CREATED_BY||e===m.CollectionSchemaType.UPDATED_BY,rEe=({id:e,children:t})=>{var d,u,f,h,p,g,_,x;const n=ye(e,["data"],["format"]),s=We(e),a=Jm((h=(f=(u=(d=n==null?void 0:n.data.format)==null?void 0:d.chartFormat)==null?void 0:u.ref)==null?void 0:f.uuid)!=null?h:""),o=ie(),i=cr((_=(g=(p=n==null?void 0:n.data.format)==null?void 0:p.chartFormat)==null?void 0:g.ref)==null?void 0:_.uuid),l=(x=n==null?void 0:n.data.format)==null?void 0:x.chartFormat,c=y.useMemo(()=>l?twe(i,l):!0,[i,l]);return(a==null?void 0:a.tag)==="NO_PERMISSION"?r.jsxs("div",{className:"w-full h-full relative",children:[r.jsx(RF,{id:e,className:"z-[11] text-h4 ml-4 mt-2",type:"segments"}),r.jsx("div",{className:"w-full h-full flex justify-center items-center text-grey",children:"无访问权限"})]}):(a==null?void 0:a.tag)==="NOT_FOUND"||!c?r.jsxs("div",{className:"w-full h-full relative",children:[r.jsx(RF,{id:e,className:"z-[11] text-h4 ml-4 mt-2",type:"segments"}),r.jsxs("div",{className:"w-full h-full flex flex-col justify-center items-center ",children:[r.jsx("div",{className:"text-grey",children:"数据源失效"}),!s&&r.jsx("div",{className:"text-active_color animate-click",onClick:()=>{o.modal({autoClose:!1,modalId:Ve.CHART_PANEL_ID,className:"rounded-md",content:()=>r.jsx(E2,{id:e})})},children:"重新配置"})]}),r.jsx(E4,{blockId:e,className:"z-[12] opacity-0 group-hover:opacity-100 next-modal absolute right-0 top-0"})]}):r.jsx(r.Fragment,{children:t})},aEe=e=>{var k,T,v,I,j,S,D,A,P;const t=ss(),n=ye(e.uuid,["data"],["format","segments"]),s=cr((v=(T=(k=n==null?void 0:n.data.format)==null?void 0:k.chartFormat)==null?void 0:T.ref)==null?void 0:v.uuid),a=(I=n==null?void 0:n.data.format)==null?void 0:I.chartFormat,o=y.useRef(null),i=aH(e.uuid),l=tr(i),c=iH(e.uuid),d=oH(e.uuid),[u,f]=y.useState(),{width:h,height:p}=ja(o.current,{type:"all"}),g=kH(),[_,x]=y.useState(!1);let{sortedRecordIds:F}=tj((S=(j=a==null?void 0:a.ref)==null?void 0:j.viewId)!=null?S:"",[s==null?void 0:s.uuid],!1);(D=a==null?void 0:a.ref)!=null&&D.viewId||(F=(A=s==null?void 0:s.subNodes)!=null?A:[]),y.useEffect(()=>{var L;s!=null&&s.uuid&&F&&g({collectionId:s==null?void 0:s.uuid,viewId:(L=a==null?void 0:a.ref)==null?void 0:L.viewId,recordIds:s==null?void 0:s.subNodes,store:t,callback:()=>{x(!0)}})},[s==null?void 0:s.uuid,(P=a==null?void 0:a.ref)==null?void 0:P.viewId,t,g,s==null?void 0:s.subNodes,F]);const b=Ce(L=>{const{blocks:O}=L;return F.map($=>O[$]).filter($=>$)},[e.uuid,F]);y.useEffect(()=>{if(!a)return;const L=nH(s,b,a,(O,$,M)=>sj(O,$,M,t.getState()));L&&f(L)},[s,a,b,t,_]);let w=u==null?void 0:u.total;typeof w=="string"&&(w=parseFloat(w));let E;c==="number"?E=w==null?void 0:w.toFixed(Math.min(d,100)):E=hl(w!=null?w:0,c);const C=oEe(E,h,p);return r.jsxs("div",{ref:o,className:"w-full h-full flex flex-col justify-center",children:[r.jsx("div",{className:"font-semibold w-full text-center flex justify-center items-center",style:{color:l,fontSize:C,lineHeight:C},children:r.jsx("div",{children:h>0?E:void 0})}),r.jsx(RF,{id:e.uuid,className:"text-center text-grey4 text-t2 shrink-0",type:"desc"})]})},oEe=(e,t,n)=>{if(e===void 0)return;t===0&&(t=600),n<=0&&(n=300);const s="".concat(e).length;return"min(".concat(t/s*1.5,"px,").concat(n/1.5,"px)")},TH=e=>{var o,i;const t=ft(e.uuid,l=>{var c;return(c=l==null?void 0:l.data.format)==null?void 0:c.chartFormat}),n=Ja(),s=Ce(l=>{var d,u,f,h;const{blocks:c}=l;return(h=(f=(u=(d=c[e.uuid])==null?void 0:d.data.format)==null?void 0:u.chartFormat)==null?void 0:f.ref)==null?void 0:h.uuid},[]),a=Ce(l=>{var d,u,f,h;const{blocks:c}=l;return(h=(f=(u=(d=c[e.uuid])==null?void 0:d.data.format)==null?void 0:u.chartFormat)==null?void 0:f.ref)==null?void 0:h.viewId},[]);return y.useEffect(()=>{(async()=>{s&&!C5(s)&&await n(s)})()},[s,n,a]),r.jsx(Mo.Provider,{value:wt.PAGE_CHART,children:r.jsx(Oo,{children:r.jsx(rEe,{id:e.uuid,children:r.jsxs("div",{className:"w-full h-full flex flex-col relative group",children:[r.jsx(RF,{id:e.uuid,className:"z-[11] text-h4 ml-4 mt-2",type:"segments"}),((o=t==null?void 0:t.chartMode)==null?void 0:o.type)==="Number"&&r.jsx(aEe,{uuid:e.uuid}),((i=t==null?void 0:t.chartMode)==null?void 0:i.type)!=="Number"&&r.jsx(iEe,{uuid:e.uuid}),r.jsx(E4,{blockId:e.uuid,className:"z-[12] opacity-0 group-hover:opacity-100 next-modal absolute right-0 top-0"})]})})})})},iEe=e=>{var _,x,F,b,w,E,C,k,T;const t=ss(),n=cr(e.uuid),s=cr((F=(x=(_=n==null?void 0:n.data.format)==null?void 0:_.chartFormat)==null?void 0:x.ref)==null?void 0:F.uuid),a=(b=n==null?void 0:n.data.format)==null?void 0:b.chartFormat,o=y4(e.uuid),i=y.useRef(0),[l,c]=y.useState(),d=kH(),[u,f]=y.useState(!1),h=wd();let{sortedRecordIds:p}=tj((E=(w=a==null?void 0:a.ref)==null?void 0:w.viewId)!=null?E:"",[s==null?void 0:s.uuid],!1);(C=a==null?void 0:a.ref)!=null&&C.viewId||(p=(k=s==null?void 0:s.subNodes)!=null?k:[]);const g=Ce(v=>{const{blocks:I}=v;return p.map(j=>I[j]).filter(j=>j)},[e.uuid,p]);return y.useEffect(()=>{if(l==null||l.renderToCanvas,!l)return;const v=()=>{const I=l==null?void 0:l.getConnectedDataURL({type:"png",backgroundColor:ad()?"black":"white"}),j="".concat(fe(n==null?void 0:n.data.segments),".png")||"图片.png";I&&cc(I,j)};return xn.on("chart2png",v),()=>{xn.off("chart2png",v)}},[n==null?void 0:n.data.segments,l]),y.useEffect(()=>{var v;s!=null&&s.uuid&&p&&d({collectionId:s==null?void 0:s.uuid,viewId:(v=a==null?void 0:a.ref)==null?void 0:v.viewId,recordIds:s==null?void 0:s.subNodes,store:t,callback:()=>{f(!0)}})},[s==null?void 0:s.uuid,(T=a==null?void 0:a.ref)==null?void 0:T.viewId,t,d,s==null?void 0:s.subNodes,p]),y.useEffect(()=>{var j,S,D;if(!l||!s||!a||((j=a.chartMode)==null?void 0:j.type)==="Number")return;const v=nH(s,g,a,(A,P,L)=>sj(A,P,L,t.getState())),I=(D=(S=v==null?void 0:v.series)==null?void 0:S[0])==null?void 0:D.data;tY(I)?(i.current,I.length,i.current=I.length,v&&(l==null||l.setOption(v,!0))):(console.warn("setOption issue"),v&&(l==null||l.setOption(v,!0)))},[l,s,a,g,t,u,h]),r.jsx(VFe,{theme:o,ref:v=>{v&&c(v)}})},k2=e=>{const t=lt(),n=aM(),s=ye(t,[]),a=Jm(t),o=s5(s==null?void 0:s.spaceId),i=S3(),l=Un(),{illegal:c}=mt(t),d=uf(t),u=n||(a==null?void 0:a.tag)==="NO_PERMISSION"||(a==null?void 0:a.tag)==="NOT_FOUND"||i||d;if(!pt()||d||l===wt.FORM_ENG_PAGE)return r.jsx("div",{className:"footer h-[15vh] flex-shrink-0"});if(Cb)return null;const f=!c&&o;return!f&&!!u?r.jsx("div",{className:"mt-20"}):ot.blog?null:r.jsx(lEe,{...e,showReport:!0,showAd:f})},lEe=e=>{const{showAd:t}=e,n=$j(),[s,a]=y.useState();return y.useEffect(()=>{ZJ("6c5b0932-dcf8-42f1-95e4-bfa1ed94f5c4").then(i=>{a(i)}),Math.random()<.01&&me.event("bottom_ad_show")},[]),r.jsxs("footer",{className:R("footer flex flex-col items-center w-full max-w-[1420px] mx-auto flex-shrink-0 bg-white1 mt-20 line-default justify-center border-t",e.className),style:{fontFamily:BL},children:[r.jsxs("div",{className:"flex w-full max-w-4xl flex-col items-center justify-center px-10",children:[t&&s&&(s==null?void 0:s.length)>0&&r.jsx(r.Fragment,{children:r.jsx(NL,{loop:!0,autoplay:{delay:8e3},slidesPerView:"auto",watchSlidesProgress:!0,modules:[nY],className:"max-w-[960px] mt-2.5",children:s==null?void 0:s.map((o,i)=>r.jsx(jL,{className:"flex items-center justify-center transform-gpu",children:r.jsx("a",{href:o.link,onClick:()=>{me.event("web_bottom_bar")},children:o.image.startsWith("http")?r.jsx("img",{className:"inline h-full max-h-[150px] w-full rounded-[10px]",src:o.image,alt:jZ}):r.jsx(cEe,{blockId:o.id,ossName:o.image,className:"inline h-full max-h-[150px] w-full rounded-[10px]"})})},i))})}),r.jsxs("div",{className:R("text-t3 text-grey3 my-5 flex justify-end w-full",t&&"justify-between"),children:[r.jsxs("div",{hidden:!t,children:["本页面由",r.jsx("a",{href:ds.learnMore,className:"mx-1 text-black",children:JI}),"提供技术支持"]}),r.jsx("div",{children:e.showReport&&r.jsxs("div",{className:"flex whitespace-nowrap flex-shrink-0",children:["如内容涉及违法违规或侵权，点击",r.jsx("div",{className:"ml-0.5 animate-click underline underline-offset-3",onClick:n,children:"投诉/举报"})]})})]})]}),e.addSpace&&r.jsx("div",{className:"h-[120px] w-full"})]})},cEe=e=>{const{blockId:t,ossName:n,className:s}=e,[a,o]=y.useState("");return y.useEffect(()=>{Vs.fetchImageUrl({blockId:t,ossName:n}).then(i=>{o(i)})},[t,n]),a?r.jsx("img",{src:a,className:s}):null},Gg=(e,t)=>{const{enable:n=!0}=t||{},s=bw();y.useEffect(()=>{const a=e.current;if(!a||!n||!s)return;let o=!1,i=0,l=0,c=0,d=0;const u=!a.className.includes("select-none"),f=document.createElement("div");f.className="absolute top-0 left-0 z-20 cursor-grab",f.id="drag-scroll-mask",os(f.style,{width:"".concat(a.scrollWidth,"px"),height:"".concat(a.scrollHeight,"px")}),a.appendChild(f);const h=()=>{Ht.removeEventListener("mouseup",g),a.removeEventListener("mousemove",_),u&&a.classList.remove("select-none")},p=x=>{if(x.stopPropagation(),!(x.metaKey||x.ctrlKey||x.altKey)){h(),st({$isCtrlKeyDown:!1});return}o=!0,i=x.pageX-a.offsetLeft,l=x.pageY-a.offsetTop,c=a.scrollLeft,d=a.scrollTop,a.addEventListener("mousemove",_),Ht.addEventListener("mouseup",g),f.classList.replace("cursor-grab","cursor-grabbing"),u&&a.classList.add("select-none")},g=()=>{f.classList.replace("cursor-grabbing","cursor-grab"),s||f.remove(),h(),o=!1,i=0,l=0,c=0,d=0},_=x=>{if(!o)return;const F=x.pageX-a.offsetLeft,b=x.pageY-a.offsetTop,w=F-i,E=b-l;os(a,{scrollLeft:c-w,scrollTop:d-E})};return a.addEventListener("mousedown",p),()=>{h(),a.removeEventListener("mousedown",p),f.remove()}},[n,s,e])},dEe=e=>Ce(({blocks:t})=>{const n=new Set,s=t[e];if(!s)return[];const a=i=>{i==null||i.forEach(l=>{l.type===m.TextType.LINK_PAGE&&l.uuid&&n.add(l.uuid)})},o=i=>{const l=t[i];if(!l)return;if(l.type===m.BlockType.REFERENCE){const f=Om(i,t);f&&n.add(f.uuid)}const{segments:c,caption:d,collectionProperties:u={}}=l.data;a(c),a(d),u!==null&&Object.keys(u).forEach(f=>a(u[f])),!tn(l.type)&&l.subNodes.forEach(o)};return s.subNodes.forEach(o),a(s.data.segments),[...n]},[e],{wait:2e3,waitMode:"debounce"}),C4=({uuid:e,canClick:t})=>{const n=ye(e,["data"],["segments"]),a=px()(e),o=ys(),{illegal:i}=mt(e);if(!n)return null;const l=r.jsxs(r.Fragment,{children:[r.jsx(Ys,{size:16,className:"flex items-center",children:r.jsx(Fn,{blockId:e,trigger:!1,iconSize:16,defaultIcon:r.jsx(_s,{uuid:e,size:"small"}),hasOverlay:!t})}),r.jsx("div",{className:"px-1 text-black decoration-grey5 text-ellipsis",children:i?Ts:fe(n.data.segments)||qt(n.type)}),!!(a.length&&!i)&&r.jsx(x0,{showAll:!0,className:"flex-shrink-0 text-grey3",navs:a})]}),c=R("flex items-center text-grey3 text-t3-medium py-0.5 px-1 w-[calc(100%-20px)]",t&&"animate-hover",i&&"opacity-30");return t?r.jsx("div",{onClick:d=>o(e,{forceOpenInRight:d.altKey,forceOpenNewTab:d.ctrlKey||d.metaKey}),className:c,children:l}):r.jsx("div",{className:c,children:l})},uEe=({uuid:e,children:t})=>{const[n,s]=y.useState(!1);return r.jsxs(gj,{rootMargin:"40px 0px",className:"mb-2",children:[r.jsxs("div",{className:"flex items-center py-0.5",children:[r.jsx(V,{name:"IcToggleBlackUnfold",size:"middle",className:R("animate-hover",n&&"-rotate-90"),onClick:()=>{s(a=>!a)}}),r.jsx(C4,{canClick:!0,uuid:e})]}),!n&&t]})},fEe=({uuid:e,callback:t})=>{const n=ie(),s=lt(),a=Oe();if(!ye(e,["data"],["collectionProperties"]))return null;const i=(l,c)=>{var u,f;const d=J.blocks[c];if(d)if(d.type===m.BlockType.REFERENCE){const h=Om(c);if(!h)return;_e(c,{type:m.BlockType.TEXTAREA,data:h.data})}else{const h=x=>{if(x.type===m.TextType.LINK_PAGE&&x.uuid&&x.uuid===l){const F=J.blocks[x.uuid];return F?{text:fe(F.data.segments),type:m.TextType.TEXT,enhancer:x.enhancer}:x}return x},p=(u=d.data.segments)==null?void 0:u.map(h),g=(f=d.data.caption)==null?void 0:f.map(h),_=Hp(d.data.collectionProperties,x=>x.map(h));_e(c,{data:{...d.data,segments:p,caption:g,collectionProperties:_}})}};return r.jsx("div",{className:"absolute right-0 top-1 bg-white2 border transition-opacity flex-shrink-0 text-grey3 rounded-xl text-t3 px-2 mr-3 animate-click opacity-0 group-hover:opacity-100",onClick:l=>{l.preventDefault(),l.stopPropagation(),n.warning({title:"确定取消该引用？",content:"取消后，原引用页面位置将变为纯文字",confirm:()=>{a(()=>{i(s,e)}),t==null||t()}})},children:"取消引用"})},mEe=({pageId:e,uuid:t,index:n,callback:s,isLocked:a})=>{var h,p,g,_;const o=Ut(),i=Lw(),l=ys(),c=ye(t,["data"],["ref","segments","caption","collectionProperties"]),d=y.useMemo(()=>{if(!c)return!1;const x=J.blocks[c.parentId];return x?ga(x.type):!1},[c]);if(!c)return null;const u=c.type===m.BlockType.TABLE_ROW,f=c.type===m.BlockType.FILE?c.data.caption:c.data.segments;return r.jsxs("div",{onClick:x=>{l(e,{hash:"#".concat(u?c.parentId:t),forceOpenInRight:x.altKey,forceOpenNewTab:x.ctrlKey||x.metaKey})},className:"animate-hover-black3 py-1 group relative flex items-center justify-between mt-1 text-t2-medium ml-10",children:[r.jsxs("div",{className:"flex w-full",children:[r.jsxs("div",{className:"flex flex-shrink-0 pl-2 justify-end text-right text-t2",children:[n+1,"."]}),c.type===m.BlockType.REFERENCE?r.jsx(C4,{uuid:(p=(h=c.data.ref)==null?void 0:h.uuid)!=null?p:""}):u||d?r.jsxs("div",{className:"flex divide-x-[1px] divide-grey5 space-x-2 items-center h-full flex-wrap",children:[d&&((g=c.data.segments)==null?void 0:g.length)&&r.jsx("div",{className:"text-t3 pointer-events-none flex items-center",children:fe(c.data.segments)}),Object.entries((_=c.data.collectionProperties)!=null?_:{}).map(([x,F],b)=>{const w=F.filter(E=>{var C;if(d){const k=J.blocks[c.parentId];if(!k)return null;if(!((C=k.data.schema)==null?void 0:C[x]))return!1}if(E.type===m.TextType.LINK_PAGE&&E.uuid){const k=J.blocks[E.uuid];return k?k.status===m.BlockStatus.NORMAL:!1}return!0});return w.length?r.jsx(fs,{segments:w,className:"pl-2 text-t3 h-[18px] leading-[10px] text-grey3 pointer-events-none flex items-center whitespace-nowrap align-sub"},b):null})]}):r.jsx(fs,{segments:f,className:"text-t3 line-clamp-2 pointer-events-none"}),mn(t).permissions.every(x=>An([...i(t)])!==c.spaceId?!1:x.type===m.PermissionType.SPACE||x.type===m.PermissionType.GROUP?x.role===m.PermissionRole.NONE:x.type===m.PermissionType.USER?x.role!==m.PermissionRole.NONE&&x.userId===o.uuid:!0)&&r.jsxs("span",{className:"flex flex-shrink-0 items-center text-red text-t4-medium",children:[r.jsx(V,{name:"IcLock",size:"middle"}),r.jsx("span",{children:"仅我可见"})]})]}),!a&&r.jsx(fEe,{uuid:t,callback:s})]})},vH=({children:e})=>r.jsx("div",{className:"py-4 text-center text-t2 text-grey4",children:e}),IH=({describe:e,tip:t,link:n,type:s})=>{const a=Ut(),o="TIPS::".concat(a.uuid,"::").concat(s),[i,l]=y.useState(!!localStorage.getItem(o));return r.jsxs("div",{hidden:i,className:"flex justify-between items-center space-x-8 text-t2 text-orange p-2 rounded bg-orange/10 mb-2",children:[r.jsx("div",{children:e}),r.jsxs("div",{className:"flex flex-shrink-0 items-center space-x-4 text-t3",children:[r.jsxs("a",{href:n,target:"_blank",rel:"noreferrer",onClick:c=>{c.stopPropagation()},className:"flex items-center animate-click",children:[r.jsx(V,{name:"IcInviteHelp",size:"xsmall",className:"mr-1"}),t]}),r.jsx("div",{className:"w-px bg-orange/20 h-4"}),r.jsx(V,{name:"IcClose",size:"xsmall",className:"animate-click",onClick:()=>{ts(o,"1"),l(!0)}})]})]})},hEe=({uuid:e,setState:t})=>{const[n,s]=y.useState([]),a=Tl(e),o=We(e,!1),i=Ce(({blocks:u})=>n.filter(({pageId:f,subNodes:h})=>{if(h.size===0)return!1;const{role:p}=mn(f,{...J,blocks:u});return p!==m.PermissionRole.NONE}),[n]),l=y.useCallback(async u=>{t(f=>({...f,currentLoading:!0}));try{const f=await ve.editor.getDocBacklinks.raw(e);if(f.code!==200)return;const{recordMap:h,results:p}=f.data;re(Tn.update({blocks:h.blocks}));const g=[];p.forEach(({pageId:_,uuid:x})=>{if(!h.blocks||!_||!x)return;const F=h.blocks[x];if(!F)return;const{segments:b}=F.data;if(b!=null&&b.some(E=>u.parentId===x&&E.uuid===e))return;const w=g.find(E=>E.pageId===_);if(w)w.subNodes.add(x);else{const E=new Set;E.add(x),g.push({pageId:_,subNodes:E})}}),s(g)}finally{t(f=>({...f,init:!1,currentLoading:!1}))}},[t,e]);y.useEffect(()=>{const u=J.blocks[e];!o&&u&&!u.local&&l(u)},[]);const c=i.length;y.useEffect(()=>{t(u=>({...u,currentNum:c}))},[c,t]);const d=y.useCallback((u,f)=>{s(h=>h.map(p=>(p.pageId===u&&p.subNodes.delete(f),p)))},[]);return o?null:r.jsxs(r.Fragment,{children:[r.jsx(IH,{type:"LINK_TABS_CURRENT",link:ds.quotePage,describe:"💡 在其他页面中引用了当前页面，将在此展示被引用记录",tip:"如何引用页面"}),c?i.map(({pageId:u,subNodes:f})=>r.jsx(uEe,{uuid:u,children:[...f].map((h,p)=>r.jsx(mEe,{pageId:u,uuid:h,index:p,isLocked:a,callback:()=>d(u,h)},h))},u)):r.jsx(vH,{children:"当前页面暂未被其他页面引用"})]})},pEe=({linkPages:e})=>r.jsxs("div",{children:[r.jsx(IH,{type:"LINK_TABS_MENTION",link:ds.quotePage,describe:"💡 当前页面中引用了其他页面，将在此展示记录",tip:"如何引用页面"}),e.length?r.jsx(gj,{rootMargin:"100px 0px",children:e.map((t,n)=>r.jsx(gEe,{uuid:t,index:n},t))}):r.jsx(vH,{children:"当前页面暂未引用其他页面"})]}),gEe=({uuid:e,index:t})=>{const n=ys();return r.jsxs("div",{onClick:s=>{n(e,{forceOpenInRight:s.altKey,forceOpenNewTab:s.ctrlKey||s.metaKey})},className:"group flex items-center animate-hover py-1 pl-2",children:[r.jsxs("div",{className:"flex-shrink-0 text-t2 text-right",children:[t+1,"."]}),r.jsx(C4,{uuid:e})]})},A6={current:"引用当前页面",mention:"提及的页面引用"},k4=({uuid:e})=>{var _;const t=ye(e,[]),[n,s]=y.useState("current"),[a,o]=y.useState({init:!0,currentLoading:!1,currentNum:-1}),[i,l]=Rd(Qm.LINK_RECORD),c=We(e,!1),d=Dt(),u=y.useRef(null);Gg(u);const f=dEe(e);if(c)return null;const{isShowBacklink:h}=(_=d.setting)!=null?_:{};if(typeof h=="boolean"&&!h||!t)return null;const p=t.type===m.BlockType.FOLDER,g=ga(t.type);return r.jsxs("div",{hidden:!a.currentLoading&&a.currentNum+f.length===0,className:R("line-default mb-16",g&&"mb-5",a.init&&"invisible"),children:[r.jsxs("div",{className:"flex items-center pb-2 border-b overflow-x-auto",children:[r.jsx(V,{name:"IcArrowHide",size:"middle",className:R("animate-hover transition-all",i?"rotate-180":"rotate-90"),onClick:()=>l(!i)}),r.jsx("div",{className:"flex text-t2 flex-shrink-0 flex-wrap",children:Object.keys(A6).filter(x=>!p&&!g||x==="current").map(x=>r.jsxs("div",{className:R("py-1 px-2 animate-hover flex items-center justify-center",x!==n&&"text-grey3"),onClick:()=>{i||l(!i),s(x)},children:[r.jsx("div",{children:A6[x]}),r.jsx("div",{className:"ml-1 flex justify-center",children:r.jsx(_Ee,{tab:x,state:a,mentionNum:f.length})})]},x))})]}),r.jsxs("div",{hidden:!i,ref:u,className:"relative pb-2 pt-3 line-clamp-2",children:[n==="current"&&r.jsx(hEe,{setState:o,uuid:e}),n==="mention"&&r.jsx(pEe,{linkPages:f})]})]})},_Ee=({state:e,tab:t,mentionNum:n})=>t==="current"&&e.currentLoading?r.jsx($s,{size:"small"}):t==="current"?r.jsx("div",{children:e.currentNum}):t==="mention"?r.jsx("div",{children:n}):null,T4=()=>{const e=Oe(),t=Nr(),n=s=>{const{blocks:a}=pe(),o=a[s];if(!o)return;const i=An(o.subNodes),l=i?a[i]:void 0;if(J.ui.selectedBlocks.length&&re(at.update({selectedBlocks:[]})),(l==null?void 0:l.type)===m.BlockType.TEXTAREA&&Ep(l.data)&&l.subNodes.length===0){t(i,fe(l.data.segments).length);return}e(()=>{const c=ut({},{parentId:s,last:!0});t(c,0)})};return y.useCallback(n,[t,e])},xEe=y.memo(({uuid:e,className:t})=>{const n=T4();return r.jsx("div",{className:R("page-footer min-h-[30vh] flex-1 cursor-text",t),onClick:()=>n(e)})}),v4=()=>{const e=iae();return r.jsx("div",{className:R(e&&"h-[30vh]")})},yEe=500,bEe=300,FEe=300,wEe=1e3,EEe=100,CEe=100,kEe=100,TEe=500,vEe=(e=[])=>{const t={count:0,textCount:0,imageCount:0},{blocks:n}=pe(),s=a=>{a.forEach(o=>{const i=n[o];i&&(t.count++,Nw(i.type)&&t.textCount++,jte(i)&&t.imageCount++,tn(i.type)||s(i.subNodes))})};return s(e),t},IEe={TEXT_THRESHOLD:yEe,COUNT_THRESHOLD:bEe,VISIBLE_RENDER_THRESHOLD:FEe,SUPER_VISIBLE_RENDER_THRESHOLD:wEe},NEe={TEXT_THRESHOLD:EEe,COUNT_THRESHOLD:CEe,VISIBLE_RENDER_THRESHOLD:kEe,SUPER_VISIBLE_RENDER_THRESHOLD:TEe},jEe=e=>e?NEe:IEe,wv=(e,t,n)=>{y.useEffect(()=>{var l;if(!e.current)return;const{width:s,height:a}=e.current.getBoundingClientRect();t({width:s,height:a});const o=qn(c=>{const{offsetWidth:d,offsetHeight:u}=c.target;t({width:d,height:u})},(l=n==null?void 0:n.wait)!=null?l:200);return Ku.observe(e.current,o)},[t,n==null?void 0:n.wait,e])},SEe=e=>{const t=So(m8,pr),n=So(p8,pr),s=So(u8,pr);wv(e,a=>{t(a.width),n(a.height)}),wv(e,a=>{s(a.width<=860)},{wait:0})},DEe=e=>{const t=So(h8,pr);wv(e,n=>{t(n.width)})},NH=e=>{var l,c;const t=ye(e,["data"],["format"]),n=t==null?void 0:t.data.format,s=t==null?void 0:t.spaceId,a=po(s),o=(l=n==null?void 0:n.pageLayout)!=null?l:"default",i=(c=n==null?void 0:n.fontFormat)!=null?c:"default";return a?{pageLayout:"default",fontFormat:"default"}:{pageLayout:o,fontFormat:i}},T2=e=>{const{fontFormat:t,pageLayout:n}=NH(e),s=[t],a={};return n==="compact"?s.push("line-compact"):n==="loose"&&s.push("line-loose"),t==="lxgwWenKai"?a.fontFamily=$c.lxgwWenKai:t==="sourceHanSerif"?a.fontFamily=$c.sourceHanSerif:t==="loraVariable"?a.fontFamily=$c.lora:t==="dmMono"&&(a.fontFamily=$c.DMMono),{fontStyle:a,pageLayoutClassName:s.join(" ")}},I4=e=>r.jsx(AEe,{...kn(e,"disableSpring")}),AEe=e=>{const{children:t,className:n,domRef:s,style:a={},tagName:o="div",config:i={},springProp:l={},...c}=e,d=aL({...a,...l,config:{...i}}),u=oL[o];return r.jsx(u,{ref:s,className:n,style:d,...c,children:t})},Ev=(e,t,n)=>{typeof e.scrollTo=="function"?(n&&e.scrollTo({top:n,behavior:"auto"}),e.scrollTo({top:t,behavior:"smooth"})):e.scrollTop=t},REe=y.memo(e=>e.isLiteSize?r.jsx(LEe,{...e}):r.jsx(PEe,{...e}),yn),R6=y.memo(e=>{const t=J.blocks[e.uuid],n=t==null?void 0:t.data.segments;return n&&fe(n)?r.jsx(fs,{className:e.className,segments:n,interactable:!1,plugins:oa}):r.jsxs(r.Fragment,{children:[e.title,e.level]})},yn),PEe=y.memo(e=>{const{onToggle:t,jumpTop:n,active:s,text:a,uuid:o,paddingLeft:i,deep:l,subCount:c,closed:d}=e;return r.jsxs("div",{className:"flex items-center",style:{paddingLeft:i},children:[r.jsx("div",{onClick:()=>t(o),className:R("flex items-center",c?"animate-hover animate-click":"opacity-0"),children:r.jsx(V,{name:"IcNaviFold",size:"middle",className:R("text-grey3 transition-all",{"rotate-90":!d})})}),r.jsx(Fe,{offset:[0,i+32],placement:"right",popup:r.jsx(R6,{...e}),"data-menu-id":o,onClick:()=>{me.event("float_catalog_clickcatalog"),n(o)},className:R("flex items-center py-1.5 rounded cursor-pointer animate-hover animate-click",s&&"bg-black_006"),style:{width:"calc(100% - 20px)"},children:r.jsx("div",{className:R("w-full min-w-0 px-1.5 text-ellipsis",{"text-grey4":!a,"text-t1-medium":l===0,"text-t2-medium":l===2||l===1,"text-t2":l===3}),children:r.jsx(R6,{...e,className:"text-ellipsis"})})})]})},yn),LEe=y.memo(e=>{const{uuid:t,active:n,jumpTop:s}=e;return r.jsx("div",{"data-menu-id":t,children:r.jsx("div",{"data-menu-id":t,className:"w-[30px] h-[30px] flex items-center justify-center animate-hover rounded","data-id":t,onClick:()=>{me.event("float_catalog_clickcatalog"),s(t)},children:r.jsx("div",{className:R("w-2.5 h-2.5 cursor-pointer rounded-full",n?"bg-black":"bg-grey4")})})})},yn),BEe=({uuid:e,closeAll:t,expandAll:n,onCloseModal:s,isInRight:a,isReadonly:o})=>{const i=Oe(),l=[{type:H.OPERATION,data:{title:"全部折叠",onClick(){t(),s()}}},{type:H.OPERATION,data:{title:"全部展开",onClick(){n(),s()}}},{type:H.LINE},{type:H.OPERATION,data:{title:"跳到页首",onClick(){const c=bn(".next-space-page",a);if(!c)return;let d=0;c.scrollTop>50&&(d=50),Ev(c,0,d),s()}}},{type:H.OPERATION,data:{title:"跳到页尾",onClick(){const c=bn(".next-space-page",a);if(!c)return;let d=0;const u=c.scrollHeight-c.clientHeight;u-c.scrollTop>50&&(d=u-50),Ev(c,u,d),s()}}}];return o||(l.push({type:H.LINE}),l.push({type:H.OPERATION,data:{title:"关闭目录",onClick(){i(()=>{_e(e,{data:{directoryMenu:!1}})}),s()}}})),r.jsx(ze,{className:"py-1 rounded w-48 next-modal",items:l})},OEe=vd.create((e,t)=>{const n=[...jB,m.BlockType.TEMPLATE],s=[m.BlockType.HEADER,m.BlockType.TOGGLE_HEADER],a=new Set,o={},i=l=>{const c=e[l];c&&!a.has(l)&&(!n.includes(c.type)||l===t)&&(a.add(l),c.subNodes.forEach(d=>{var f;const u=e[d];u&&s.includes(u.type)&&(o[d]=u),u&&((f=u.data.ref)!=null&&f.uuid)&&u.type===m.BlockType.SYNC_REFERENCE?i(u.data.ref.uuid):i(d)}))};return i(t),o},(e,t)=>t),jH=400,MEe=200,UEe=54,P6=240,L6=15,XC="DIRECTORY_MENU_WIDTHS",Cf="DIRECTORY_MENU_CLOSED",SH="DIRECTORY_MENU_MORE_BTN_ID",B6=y.memo(e=>{var O,$,M;const{uuid:t,isLiteSize:n,fixed:s}=e,[a,o]=y.useState([]),i=Ln(),l=ja(bn(".page-header",i),{type:"height"}),c=nf(),d=Lce(),u=sY(c),f=y.useRef(!1),h=mx(),p=y.useRef(null),g=ie(),[_,x]=y.useState((O=Bf(Cf)[t])!=null?O:[]),F=We(t),b=y.useCallback(U=>(f.current=!0,h(U,{callback:z=>{z==="animateScrollStart"&&(f.current=!0),z==="animateScrollEnd"&&(f.current=!1),(z==="animateStart"||z==="animateScrollStart")&&C(U)}})),[h]),w=Ce(U=>OEe(U.blocks,t),[t],{wait:500,waitMode:"debounce",ignoreOtherData:!1}),[E,C]=y.useState(""),k=y.useRef(),T=y.useMemo(()=>{const U=[];return Object.values(w).forEach(z=>{var Q;let K=0,W=0,Y="";const G=(Q=z.data.level)!=null?Q:1,ee=An(U);if(ee)if(G>=ee.level)G===ee.level?(Y=ee.parentId,K=ee.paddingLeft,W=ee.deep):(Y=ee.uuid,K=ee.paddingLeft+L6,W=ee.deep+1);else{const ne=NS(U,ae=>ae.level<G),se=NS(U,ae=>ae.level===G),ce=ne||se;ce&&(ce.level<G?(K=ce.paddingLeft+L6,W=ce.deep+1,Y=ce.uuid):(K=ce.paddingLeft,W=ce.deep,Y=ce.parentId))}let te="标题";z.type===m.BlockType.TOGGLE_HEADER&&(te="折叠标题"),U.push({parentId:Y,uuid:z.uuid,level:G,deep:W,paddingLeft:K,text:fe(z.data.segments),subNodes:[],active:!1,closed:!1,subCount:0,title:te})}),U.forEach(z=>{const K=new Set,W=Y=>{K.has(Y)||(K.add(Y),U.forEach(G=>{G.parentId===Y&&z.subNodes.push(G.uuid)}),z.subNodes.forEach(W))};W(z.uuid)}),U},[w]),v=y.useCallback(()=>{const U=[];T.forEach(z=>{var Y;const K=bn('.next-space-page-content [data-block-id="'.concat(z.uuid,'"]'),i);if(!K)return;const W=(Y=b5(K))==null?void 0:Y.top;W&&U.push({id:z.uuid,top:W})}),U.sort((z,K)=>z.top-K.top),o(U)},[i,T]);kk(()=>{v()},[d,T,i,u],{wait:1e3}),kk(()=>{if(f.current||!(u!=null&&u.top))return;const U=u.top+100,z=ll(a);if(z&&z.top>U&&z.id!==E){C(z.id),I(z.id);return}for(let K=0;K<a.length;K++){const W=a[K],Y=a[K+1];if(W&&W.top<=U&&(!Y||Y.top>U)&&W.id!==E){C(W.id);let G=W.id;T.forEach(ee=>{_.includes(ee.uuid)&&ee.subNodes.forEach(te=>{te===G&&(G=ee.uuid)})}),I(G);return}}},[u==null?void 0:u.top,a,d,_,T,E,i],{wait:500,trailing:!1,leading:!0});const I=U=>{const z=bn('.directory-scroll-container [data-menu-id="'.concat(U,'"]'),i),K=bn(".directory-scroll-container",i);Ev(k.current,fI(z,K).top-54)},j=T.length!==0,S=y.useMemo(()=>{if(!_.length)return T.map(K=>({...K,active:K.uuid===E}));let U=E;const z=new Set;return T.forEach(K=>{_.includes(K.uuid)&&K.subNodes.forEach(W=>{W===U&&(U=K.uuid),z.add(W)})}),T.filter(K=>!z.has(K.uuid)).map(K=>({...K,closed:_.includes(K.uuid),active:K.uuid===U}))},[T,_,E]),D=y.useCallback(()=>{x([]);const{[t]:U,...z}=Bf(Cf);ts(Cf,JSON.stringify(z))},[t]),A=y.useCallback(()=>{const U=S.filter(z=>z.subNodes.length).map(z=>z.uuid);x(U),ts(Cf,JSON.stringify({...Bf(Cf),[t]:U}))},[S,t]),P=y.useCallback(()=>{p.current&&g.dropdown({modalId:SH,popcorn:ra(p.current),placement:"bottom-end",offset:[0,4],mask:!1,content({onCloseModal:U}){return r.jsx(BEe,{uuid:t,onCloseModal:U,closeAll:A,expandAll:D,isInRight:i,isReadonly:F})}})},[A,D,i,F,g,t]),L=y.useCallback(U=>{x(z=>{const K=new Set(z);K.has(U)?K.delete(U):K.add(U);const W=[...K];return ts(Cf,JSON.stringify({...Bf(Cf),[t]:W})),W})},[t]);return s&&n&&S.length===0?null:r.jsxs(r.Fragment,{children:[!n&&r.jsxs("div",{className:"group flex items-center justify-between px-2 pl-3 py-1",children:[r.jsx("div",{className:"text-t2-medium text-grey3 py-2",children:"目录"}),r.jsx("div",{ref:p,onClick:P,className:"p-1 animate-hover opacity-0 group-hover:opacity-100",children:r.jsx(V,{size:"middle",name:"IcMore",className:"text-grey3"})})]}),r.jsx("div",{ref:k,className:R("text-t2 transition-all overflow-x-hidden overflow-y-auto block overscroll-y-contain px-2 space-y-1",n&&"hidden-scrollbar"),style:{paddingBottom:l.height+96,maxHeight:((M=($=c==null?void 0:c.current)==null?void 0:$.getBoundingClientRect().height)!=null?M:0)-44-24},children:j?S.map(U=>y.createElement(REe,{onToggle:L,isLiteSize:n,...kn(U,"subNodes"),subCount:U.subNodes.length,key:U.uuid,jumpTop:b})):!n&&r.jsx("div",{className:"flex items-center whitespace-nowrap h-10 pointer-events-none text-grey4 text-t2-medium",children:"请添加标题生成目录"})})]})}),VEe=y.memo(e=>{var h;const{uuid:t}=e,n=f8(),s=Ho(),[a,o]=y.useState((h=Bf(XC)[t])!=null?h:P6),i=m0(SH),l=y.useRef(0),c=y.useMemo(()=>r.jsx(B6,{...e,isLiteSize:!1,fixed:!0}),[e]),d=y.useMemo(()=>n?r.jsx(B6,{...e,isLiteSize:!0}):null,[n,e]),u=p=>{o(p),ts(XC,JSON.stringify({...Bf(XC),[t]:p}))},f=ZF(({offset:[p]})=>{const g=Math.floor(Math.max(Math.min(2*l.current-p,jH),MEe));u(g)},{from:a,preventDefault:!0});return r.jsx(bg,{wait:800,waitMode:"debounce",children:r.jsx("div",{className:"select-none cursor-default",children:r.jsx(I4,{config:{duration:100},className:R("line-default ml-10 mt-6 h-full",{"!pl-3 pr-0 ml-0":n,"flex-shrink-0 max-w-[calc(100%-40px)] min-w-[200px]":!n}),style:{width:n?"auto":a},children:r.jsx("div",{className:"h-full relative z-50 group",children:r.jsxs("div",{className:R("directory-scroll-container sticky left-0 top-0",!n&&"pb-2.5 pl-3.5"),children:[!n&&r.jsx("div",{...f(),onMouseEnter:()=>{l.current=a},onClick:()=>{l.current=a},onDoubleClick:()=>{u(P6)},className:"touch-none group absolute top-0 -left-1 w-3 h-full flex justify-center hover:cursor-col-resize",children:r.jsx("div",{className:"w-[3px] h-full bg-grey9 group-hover:bg-grey6"})}),n?d:c,n&&!s&&r.jsx("div",{className:R("bg-aside w-52 rounded duration-200 transition-all absolute top-0 right-0 translate-x-[200%] group-hover:pointer-events-auto pointer-events-none group-hover:translate-x-0 group-hover:shadow-modal group-hover:delay-150 delay-300",i&&"translate-x-0"),children:c})]})})})})})}),$Ee=e=>{const t=Oe(),n=We(e),s=Ce(({blocks:a})=>{if(!e)return;const o=a[e];if(!o)return;const{schema:i,collectionPageProperties:l=[]}=o.data;if(!i)return;const c=[],d=[],u=new Set;let f=!1;return l.forEach(h=>{const p=i==null?void 0:i[h.property];if(!p){f=!0;return}u.has(h.property)||(c.push({...h}),u.add(h.property),d.push({...h,schema:p}))}),Object.entries(i).forEach(([h,p])=>{if(u.has(h))return;f=!0;const g={property:h,visible:!0};u.add(h),c.push(g),d.push({...g,schema:p})}),{needUpdateProperties:f,newProperties:c,sorted:d}},[e]);return y.useEffect(()=>{!(s!=null&&s.needUpdateProperties)||!s.newProperties||n||s.needUpdateProperties&&t(()=>{e&&_e(e,{data:{collectionPageProperties:s.newProperties}})})},[e,n,s==null?void 0:s.needUpdateProperties,s==null?void 0:s.newProperties,t]),s==null?void 0:s.sorted},HEe=({uuid:e})=>{const t=We(e),n=Oe(),[s,a]=y.useState(!1),o=cf(),i=Ce(y.useCallback(({blocks:g})=>{const _=g[e];if(!_)return;const x=g[_.parentId];if(x&&!(x.type!==m.BlockType.COLLECTION_VIEW&&x.type!==m.BlockType.COLLECTION_VIEW_PAGE))return{viewId:"",collectionId:x.uuid,parentRole:mn(x.uuid,{...pe(),blocks:g}).role}},[e]),[e]),l=Tl(i==null?void 0:i.collectionId),c=We(i==null?void 0:i.collectionId),d=$Ee(i==null?void 0:i.collectionId);if(!i||!d)return null;const u=()=>{me.event("bitable_property_create",{from_scene:"page"});const g=o({collectionId:i.collectionId});g&&st({$newTableProperty:{propertyId:g,from:zn.PAGE_PROPERTIES}})},f=d.filter(g=>g.schema.type===m.CollectionSchemaType.ID_NUMBER||g.property==="title"?!1:s?!0:g.visible),h=d.filter(g=>!g.visible).length,p=g=>{const{active:_,over:x}=g;if(x&&_.id!==x.id){const F=d.findIndex(E=>E.property===_.id),b=d.findIndex(E=>E.property===x.id),w=Wu(d,F,b);n(()=>{_e(i.collectionId,{data:{collectionPageProperties:w.map(({property:E,visible:C})=>({property:E,visible:C}))}})})}};return r.jsx(rd.Provider,{value:{readonly:t,collectionId:i.collectionId,viewId:"",viewParentId:"",changeView(){}},children:r.jsxs(Oo,{children:[r.jsx(br,{disabled:l||c,items:f.map(g=>({id:g.property,...g})),onChange:(g,_)=>p(_),renderItemContent:({item:g})=>r.jsx(zEe,{recordId:e,propertyId:g.id,schema:g.schema,disabled:l||c},g.id)}),!t&&!l&&(h===0||s)&&i.parentRole!==m.PermissionRole.READER&&r.jsxs("button",{"data-disable-select":"true",onClick:u,className:R("text-grey3 h-[36px] pl-1 rounded flex items-center duration-150 animate-hover w-[188px]"),children:[r.jsx(V,{name:"IcAdd",className:"mr-1",size:"middle"}),r.jsx("span",{className:"text-t2",children:"添加属性"})]}),h>0&&r.jsxs("button",{"data-disable-select":"true",className:"animate-hover text-grey3 min-h-[36px] pl-1 pr-2 rounded flex items-center w-[188px]",onClick:()=>a(!s),children:[r.jsx(V,{name:"IcArrowDateBack",size:"middle",className:"mr-1",style:{transform:s?"rotate(90deg)":"rotate(-90deg)"}}),r.jsx("span",{className:"text-t2 ",children:s?"隐藏 ".concat(h," 个属性"):"".concat(h," 个隐藏属性")})]}),r.jsx("hr",{className:"mt-2 mb-2 border-grey6"})]})})},zEe=y.memo(({schema:e,propertyId:t,recordId:n,disabled:s})=>{const a=$g(),o=y.useRef(null),i=A3(t,zn.PAGE_PROPERTIES);return y.useEffect(()=>{o.current&&i&&(a(t,o.current,zn.PAGE_PROPERTIES),st({$newTableProperty:void 0}))},[i,a,t]),r.jsxs("li",{"data-disable-select":"true",className:"flex group relative",children:[r.jsxs("div",{className:"",onClick:l=>{s||a(t,l.currentTarget,zn.PAGE_PROPERTIES)},children:[!s&&r.jsx("button",{className:R("absolute -left-5 top-1.5 opacity-0 w-5 h-6 flex items-center justify-center rounded text-grey4  animate-hover hover:text group-hover:opacity-100"),children:r.jsx(V,{name:"IcMenu",size:"small",className:"pointer-events-none"})}),r.jsxs("button",{ref:o,className:R("flex pl-1 self-start items-center min-h-[36px] text-left rounded",{"animate-hover":!s}),children:[r.jsx(V,{className:"mr-1 text-grey3",size:"small",name:un[e.type]}),r.jsx("div",{className:"flex-shrink-0 mr-1 overflow-hidden text-t2 text-grey3 w-36 overflow-ellipsis whitespace-nowrap",children:e.name})]})]}),r.jsx("div",{className:"flex-1 relative overflow-hidden animate-hover",children:r.jsx(qEe,{schema:e,recordId:n,propertyId:t})})]})}),qEe=({schema:e,recordId:t,propertyId:n})=>{const s=ie(),{getState:a}=ss(),o=We(t),i=ur(),l=Af(e.type),c=E$(e.type),d=y.useRef(null),u=f=>{var x,F,b;if(o&&e.type!==m.CollectionSchemaType.FILE&&e.type!==m.CollectionSchemaType.RELATION)return;if(e.type===m.CollectionSchemaType.RELATION&&((x=a().blocks[t])!=null&&x.isTemplate)){be.warning("模板中暂不支持设置关联属性！");return}if(hm.includes(e.type)||e.type===m.CollectionSchemaType.ROLLUP)return;if(e.type===m.CollectionSchemaType.CHECKBOX){const w=(b=(F=a().blocks[t])==null?void 0:F.data.collectionProperties)==null?void 0:b[n];us(fe(w))?i(t,n,ht("NO")):i(t,n,ht("YES"));return}const h={},p=e.type===m.CollectionSchemaType.DATE||e.type===m.CollectionSchemaType.FILE||e.type===m.CollectionSchemaType.FORMULA,g=f.currentTarget.getBoundingClientRect();p||(h.width=g.width);const _=g.height;s.dropdown({popcorn:f.currentTarget,placement:"bottom-start",offset:[0,-_],content({onCloseModal:w}){return r.jsx("div",{ref:d,className:"next-modal",style:h,children:r.jsx(Qp.Provider,{value:d,children:r.jsx(c,{site:Ye.FIELD,recordId:t,propertyId:n,onClose:w,onUpdate:()=>{},width:g.width})})})}})};return r.jsx("div",{className:R("text-t2 relative text-left whitespace-pre-wrap break-all min-w-[260px] min-h-[36px]",Mn({selectors:{":empty:before":{content:"'".concat(Wa.isEmpty,"'"),display:"block",fontSize:"14px",color:"var(--grey4)",padding:"8px",lineHeight:"20px"}}})),onClick:u,children:r.jsx(Og,{children:r.jsx(l,{site:Ye.FIELD,recordId:t,propertyId:n})})})};let ub;const GEe=e=>{ub=e},PF=({uuid:e,children:t})=>{var v;const n=y.useRef(!1),s=y.useRef(null),a=y.useRef(null),o=f8(),i=WEe(e),l=(v=ft(e,I=>{var j;return(j=I==null?void 0:I.data.format)==null?void 0:j.commentAlignment}))!=null?v:"top",c=We(e),d=Ln(),u=y.useContext(Vo);U5(e,s);const f=_0(I=>{var j;return(j=I.setting)==null?void 0:j.enableHighPerformance}),h=ie(),p=Pm(),{fontStyle:g,pageLayoutClassName:_}=T2(e);SEe(a);const x=Un(),F=x===wt.PAGE_LITE_PREVIEW;if(y.useEffect(()=>{if(c||typeof f<"u")return;const{blocks:I}=pe(),j=I[e];if(!j)return;const S=P=>{p({setting:{...yt.setting,enableHighPerformance:P}})},{count:D}=vEe(j.subNodes),{COUNT_THRESHOLD:A}=jEe(!1);D>A&&h.warning({title:r.jsxs("div",{children:[r.jsx("p",{className:"mb-4",children:"在全局设置中开启高性能模式，将可以在编辑时获取极致流畅的体验"}),r.jsx("p",{className:"mb-4",children:"但会无法使用一些功能，例如浏览器自带的搜索功能"})]}),cancelText:"以后再说",confirmText:"马上开启",confirm:()=>S(!0),cancel:()=>S(!1),closeBeforeCallBackForClickOutSide:()=>{S(!1)}})},[f,h,c,p,e]),!i)return r.jsx(Fg,{});const b=I=>{var L,O,$;const{selectedBlocks:j}=pe().ui;if(j.length||n.current||["input","textarea"].includes(($=(O=(L=document.activeElement)==null?void 0:L.tagName)==null?void 0:O.toLowerCase())!=null?$:"")&&!I.target.closest(".CodeMirror")||I.target.closest("table")||I.target instanceof Element&&(I.target.closest("[contenteditable]")||I.target.closest(".ignore-focus-click")))return;const{blockId:S,node:D}=YV(I,s.current),A=(D==null?void 0:D.id)===y0?document.querySelector('[data-block-id="'.concat(S,'"]')):I.target,P=j1(S,D==null?void 0:D.dataset.syncId);!c&&P&&!A.isContentEditable&&I.currentTarget.contains(A)&&!A.closest(".CodeMirror")&&Lr(P,I.clientX,I.clientY)},w=ot.print,{directoryMenu:E,pageFixedWidth:C=!0}=i,k=!w&&E&&u!==uc.PAGE_HISTORY&&x&&[wt.MAIN,wt.SHARE].includes(x);if(ub===void 0)return null;let T="100%";return C&&(!o&&k?T="".concat(uo+jH,"px"):k?T="".concat(uo+UEe,"px"):T="".concat(uo,"px")),F&&(T="100%"),r.jsx(Ec.Provider,{value:s,children:r.jsxs("div",{ref:s,onPointerEnter:()=>n.current=!0,onPointerLeave:()=>n.current=!1,onClick:b,id:"next-space-page",className:R(_,"next-space-page overflow-y-auto",!w&&"flex flex-col flex-1 overflow-x-hidden"),onScroll:()=>xn.emit("removeHoverMenu"),style:g,children:[r.jsxs("div",{ref:a,className:R("transition-all items-center",!w&&"flex relative flex-1 flex-col",o||d?"px-12":"px-24",k&&"pl-28 pr-6",k&&(o||d)&&"pl-12 pr-6",w&&"px-0"),children:[!F&&r.jsx("div",{className:"w-full transition-all flex-shrink-0",style:{maxWidth:T},children:r.jsx(K4,{uuid:e,children:!ot.blog&&r.jsx(HEe,{uuid:e})})}),w?r.jsx(ub,{uuid:e,readonly:c}):r.jsxs("div",{className:"flex flex-grow flex-shrink-0 transition-all w-full cursor-text",style:{maxWidth:T},children:[r.jsxs("article",{className:"flex flex-col relative w-full block-content transition-all flex-1 min-w-0",children:[r.jsx(ub,{visibleRender:!0,uuid:e,readonly:c}),!c&&r.jsx(xEe,{uuid:e}),l==="bottom"&&r.jsx(y2,{pageId:e,isBottom:!0}),r.jsx(v4,{}),r.jsx(bg,{wait:1e3,waitMode:"debounce",children:r.jsx(k4,{uuid:e})})]}),k&&r.jsx(VEe,{uuid:e})]})]}),t,c&&r.jsx(k2,{addSpace:!!t})]})})},WEe=e=>ft(e,t=>{if(t)return{title:fe(t.data.segments)||fo,icon:t.data.icon,iconUrl:t.data.iconUrl,pageFixedWidth:ot.print?!1:t.data.pageFixedWidth,directoryMenu:t.data.directoryMenu}}),N4=e=>{const t=_d(),n=lt(),s=_5(),a=VN(),o=mx(),i=$N(),l=y.useCallback(()=>{var d;if(a)return;const c=One(t.hash);c&&KEe((d=e==null?void 0:e.pageId)!=null?d:n,c,s,e==null?void 0:e.container,o)},[t,t.hash,n,a,e==null?void 0:e.container,e==null?void 0:e.pageId,i.isVirtualListMode]);return y.useEffect(()=>{l()},[l]),l};let QC;const KEe=(e,t,n,s,a)=>{const o=i=>{const l=sc(i);l.delete(i);const c=[...l].filter(d=>{const u=J.blocks[d],f=xt.$expandFoldRecord[d];return u&&!f});if(c.length)return Vi(c,!0,!1),!0};if(t){QC&&clearTimeout(QC);const i=o(t);QC=setTimeout(()=>{var c;const l=((c=s==null?void 0:s.current)!=null?c:document).querySelector("[data-block-id='".concat(t,"']"));if(l||a==null||a(t),l instanceof HTMLElement){setTimeout(()=>{l.scrollIntoView({behavior:"auto",block:"center"})},l.dataset.mindMapId?500:0);const d=[],{syncId:u}=l.dataset;d.push({blockId:t,syncId:u}),(()=>{var g,_;if(!u)return;let h=J.blocks[u];if(!h||(h.type===m.BlockType.SYNC_REFERENCE&&(h=J.blocks[(_=(g=h.data.ref)==null?void 0:g.uuid)!=null?_:""]),!h))return;n(e,[]).forEach(x=>{var b,w;if(x===u)return;const F=J.blocks[x];if(F){if(F.type===m.BlockType.SYNC_CONTAINER)(h==null?void 0:h.uuid)===x&&d.push({blockId:t,syncId:x});else if(F.type===m.BlockType.SYNC_REFERENCE){const E=J.blocks[(w=(b=F.data.ref)==null?void 0:b.uuid)!=null?w:""];if(!E)return;E.uuid===(h==null?void 0:h.uuid)&&d.push({blockId:t,syncId:F.uuid})}}})})(),re(at.update({selectedBlocks:d}))}},i?150:0)}},YEe=e=>{const{readonly:t}=e;return r.jsxs("div",{className:"cursor-default login-wrapper",children:[r.jsx("div",{className:"text-[70px] leading-[80px]",children:"☕️"}),r.jsx("div",{className:"text-grey4 text-t1",children:"当前文件夹为空"}),!t&&r.jsx("div",{className:"flex items-center justify-center h-10",children:r.jsx("span",{className:"text-grey3 text-t2",children:"拖拽文件到此处或点击“上传”按钮"})})]})},XEe=e=>t=>{const n=QB();t===Xs.TABLE?delete n[e]:n[e]=t,ts(MB,JSON.stringify(n)),st({$folderListViewTypeList:n})},QEe=({uuid:e,className:t})=>{const n=f9(e),s=ie(),a=[{icon:"IcList",type:Xs.TABLE,title:"列表模式"},{icon:"IcThumbnail",type:Xs.THUMBNAIL,title:"缩略图模式"},{icon:"IcLargeImage",type:Xs.PREVIEW,title:"大图模式"}],o=a.find(c=>c.type===n),i=XEe(e),l=c=>{s.dropdown({popcorn:c.currentTarget,placement:"bottom-start",offset:[0,10],content:({onCloseModal:d})=>r.jsx(ze,{className:"next-modal w-44 py-2.5",onItemClick:()=>d(),items:a.map(u=>({type:H.OPERATION,data:{icon:u.icon,title:u.title,selected:u.type===n,onClick:()=>i(u.type)}}))})})};return r.jsx("div",{className:R("text-t2 flex items-center h-full cursor-pointer text-black",t),onClick:l,children:(o==null?void 0:o.icon)&&r.jsxs(r.Fragment,{children:[r.jsx(V,{name:o.icon,size:"middle",className:"mr-1"}),r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall"})]})})},JEe=y.memo(({ids:e,className:t})=>{const n=Ce(i=>i.ui.selectedBlocks,[],{obsSelectBlocks:e.map(i=>({blockId:i}))}),s=y.useMemo(()=>{const i=n.map(d=>d.blockId),l=e.some(d=>i.includes(d));return e.every(d=>i.includes(d))&&l?0:l?1:2},[n,e]),a=i=>{i.stopPropagation(),i.preventDefault(),re(s===0?at.updateSelectBlocks([]):at.updateSelectBlocks(e.map(l=>({blockId:l}))))},o={0:{title:"取消全选",name:"IcCheckbox2Check"},1:{title:"部分选中",name:"IcSelectedPart"},2:{title:"全选",name:"IcCheckbox2"}};return r.jsx(Fe,{"data-no-cancel-selected":!0,popup:o[s].title,onClick:a,className:R(t,n.length&&"opacity-100"),children:r.jsx(_a,{checkbox2:!0,checked:[0,1].includes(s),name:o[s].name})})},yn),Cv=e=>({[Xs.PREVIEW]:{class:"w-[110px] h-[110px]",size:220},[Xs.THUMBNAIL]:{class:"w-[50px] h-[50px]",size:100},[Xs.TABLE]:{class:"w-[28px] h-[28px] p-1",size:56}})[e],j4=({progress:e,fail:t,...n})=>r.jsx("span",{...n,children:r.jsx("div",{className:R("h-full opacity-80 bg-active_color transition-all rounded-full",t&&"bg-grey3 opacity-100"),style:{width:"".concat(e,"%")}})}),DH=()=>y.useCallback(e=>{const t="/".concat(um()).concat(e?"/".concat(e):"");gs.check?window.open(t):window.open("".concat(_n()).concat(t),"__target")},[]),AH=({className:e,children:t,uuid:n,showDefaultBorder:s,...a})=>{const o=Ho(),i=dne(n),l=Sd(n),c=rg(),d=y.useContext(Fm);return r.jsx("div",{...a,"data-draggable":!0,"data-no-cancel-selected":!0,"data-block-id":d?n:void 0,className:R("transition-border mt-px",o&&"pointer-events-none",l&&"bg-active_color_10",e),style:{boxShadow:l||o&&i?"0px 0px 0px 1px var(--active_color)":s?"0px 1px 0px 0px var(--grey6)":"none"},children:r.jsx("div",{className:R("contents",c&&"pointer-events-none"),children:t})})},ZEe=e=>e===void 0?!1:PJ.includes(e);let RH;const e2e=e=>{RH=e},t2e=({uuid:e})=>{const[t,n]=y.useState(""),a=R0()(dn.password),o=y.useCallback(async i=>{sw(Kp.PASSWORD,i);const l=await ve.editor.getDoc.raw(e);l.code===200||l.code===1407?(localStorage.setItem("share-psw-".concat(e),i),location.reload(),n("")):(sessionStorage.clear(),n(l.msg))},[e]);return y.useEffect(()=>{a&&o(a)},[a,o]),r.jsxs(r.Fragment,{children:[r.jsx(RH,{emptyStyle:!0}),r.jsxs(dM,{icon:"🔐",title:r.jsx("span",{className:"text-h2",children:"分享访问密码"}),children:[r.jsx("div",{className:"flex my-2.5",children:r.jsx(IB,{size:4,success:o,onError:()=>n("密码错误"),onChange:()=>n("")})}),t&&r.jsxs("div",{className:"text-t2 text-red flex",children:[r.jsx(na,{emojiStr:"⚠️",className:"mr-1"}),t]})]})]})},PH=({uuid:e,isPreviewPage:t,hideHeader:n,pageScene:s,forceImage:a})=>{var v,I,j,S;const o=ns(),i=Ja(),l=ln(),{illegal:c}=mt(e),d=Jm(e),{role:u}=mt(e),f=s2(e),[h,p]=y.useState(!0),{url:g,imageUrl:_}=bc(c||ot.propertyId?"":e,{isImage:a}),x=ye(e,["data"],["segments","display","collectionProperties"]);let F=fe(x==null?void 0:x.data.segments);ot.propertyId&&x&&(F=(S=(j=((I=(v=x.data.collectionProperties)==null?void 0:v[ot.propertyId])!=null?I:[]).find(A=>A.url===ot.ossName))==null?void 0:j.text)!=null?S:"");const{extName:b}=rn(F),w=()=>l(Ve.FILE_PREVIEW);y.useEffect(()=>{t?i(e).then(()=>{p(!1)}):p(!1)},[i,t,e]),y.useEffect(()=>{F&&me.event("file_preview",{file_format:b})},[b,F]);const[E,C]=y.useState();if(y.useEffect(()=>{var P,L,O;if(!R_()||!ot.propertyId)return;const A=((L=(P=x==null?void 0:x.data.collectionProperties)==null?void 0:P[ot.propertyId])!=null?L:[]).find($=>$.url===ot.ossName);A&&Vs.fetchDownloadUrl({blockId:e,ossName:(O=A.url)!=null?O:"",fileName:A.text}).then($=>{const M=Jo($,b);C(M)})},[x==null?void 0:x.data.collectionProperties,b,e]),c)return r.jsx(L0,{uuid:e});if((d==null?void 0:d.tag)==="NEED_PASSWORD")return r.jsx(t2e,{uuid:e});if(h)return null;if(!x){if(t){if((d==null?void 0:d.tag)==="NOT_FOUND")return r.jsx(r.Fragment,{children:r.jsx(Fg,{showBackButton:!0})});if((d==null?void 0:d.tag)==="NO_PERMISSION"||u===m.PermissionRole.NONE)return r.jsxs(r.Fragment,{children:[r.jsx(ule,{}),r.jsx(k2,{})]})}return null}if(x.type!==m.BlockType.FILE&&x.type!==m.BlockType.EXTERNAL_FILE&&x.type!==m.BlockType.PDF_ANNOTATION&&!R_())return o.push("/".concat(e)),null;const k=b.toLowerCase()==="pdf",T=R_()?E:_;return T?r.jsx(yd,{scope:CN,initialValues:[[kN,{uuid:e,editor:!1}]],children:r.jsxs("div",{className:R("fixed top-0 bottom-0 left-0 right-0",{"bg-black-base/80":!n,"flex-1 overflow-hidden relative":t}),children:[!k&&!n&&r.jsx(jV,{onClose:w,isPreviewPage:t,uuid:e,downloadUrl:g,pageScene:s}),f&&r.jsx("div",{className:R("absolute z-50 w-full top-[55px] h-14",t&&"top-0"),children:r.jsx(Vj,{uuid:e,onDelete:w})}),r.jsx("div",{className:"file-preview absolute bottom-0 flex items-center justify-center w-full overflow-y-hidden text-white",style:{top:k?f?55:0:f?111:55},onClick:D=>D.target===D.currentTarget&&w(),children:r.jsx(Nj,{uuid:e,downloadUrl:T,forceImage:a||x.data.display==="image"})})]})}):null},n2e=({uuid:e,scene:t,ownerBlockId:n})=>{const s=n!=null?n:e,a=y.useMemo(()=>ks(s),[s]),o=hM({uuid:s,pageId:a}),[i,l]=y.useState(Math.max(o.indexOf(s),0)),c=y.useCallback(()=>{l(f=>o[f-1]?f-1:(be.warning("当前为第一张"),f))},[o]),d=y.useCallback(()=>{l(f=>o[f+1]?f+1:(be.warning("当前为最后一张"),f))},[o]);y.useEffect(()=>{const f=p=>{If("ArrowLeft")(p)?c():If("ArrowRight")(p)&&d()};return Ht.addEventListener("keydown",f)},[d,c]);const u=y.useMemo(()=>{var p;const f=o[i],h=J.blocks["".concat(f)];return(h==null?void 0:h.type)===m.BlockType.REFERENCE?(p=h==null?void 0:h.data.ref)==null?void 0:p.uuid:o[i]},[o,i]);return r.jsxs("div",{className:"file-preview",children:[r.jsx(PH,{uuid:u!=null?u:"",pageScene:t,forceImage:!0}),o.length!==0&&r.jsxs(r.Fragment,{children:[r.jsx(Fe,{popup:"上一张",className:"cursor-pointer absolute left-0 pl-2 top-[50%]",children:r.jsx(V,{name:"MIcBtnPre",size:"xxxlarge",onClick:f=>{f.stopPropagation(),c()}})}),r.jsx(Fe,{popup:"下一张",className:"cursor-pointer absolute right-0 pr-2 top-[50%]",children:r.jsx(V,{name:"MIcBtnNext",size:"xxxlarge",onClick:f=>{f.stopPropagation(),d()}})})]})]})},fh=()=>{const e=ie(),t=Un(),n=kj(),s=sh();return y.useCallback((a,o)=>{const{blocks:i}=pe(),l=i[a];if(!l)return;const c=Jt.image.test(rn(l.data.ossName).extName)||l.data.display==="image"||l.type===m.BlockType.PDF_ANNOTATION;if(c){s({uuid:o!=null?o:a});return}n().then(()=>{e.modal({modalId:Ve.FILE_PREVIEW,noAnimation:!0,content:()=>c?r.jsx(n2e,{uuid:a,ownerBlockId:o,scene:t}):r.jsx(PH,{uuid:a,pageScene:t})})})},[n,s,e,t])},s2e=(e,t)=>{be.loading({key:e,content:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{children:t}),r.jsx("div",{onClick:()=>be.closeMessage(e),className:"text-active_color animate-click",children:"关闭提示"})]})})},Yo=new Map,S4=K1("$enqueue-task-id-list-1",()=>({})),LH=Qs(S4,{assign:!0}),kv=()=>{const e={};Yo.forEach((t,n)=>{e[n]=kn(t,["success","fail"])}),LH(e,{replace:!0})},ERe=()=>{const e=S4.getState();ka(e).forEach(t=>{var s;const n=e[t];!Yo.has(t)&&((s=n==null?void 0:n.resData)==null?void 0:s.status)==="in_progress"&&Yo.set(t,n||{})}),LF()},CRe=e=>{const t=S4.getState();LH(kn(t,e),{replaceAll:!0})},D4=async(e,t={})=>{const{taskId:n}=await ve.infra.enqueueTask(e);return Yo.set(n,{body:e,startTime:Date.now(),...t}),LF(),n};let JC=null,xy=0;const LF=()=>{Yo.size&&(JC&&clearTimeout(JC),kv(),JC=setTimeout(async()=>{const e=await ve.infra.getTasks.raw({taskIds:[...Yo.keys()]});if(e.code===200){xy=0;const{results:t}=e.data,n=Object.values(t);n.length||[...Yo.keys()].forEach(s=>{var o,i;const a=Yo.get(s);a&&((o=a.fail)==null||o.call(a,{}),a.lastTime=Date.now(),(i=a.resData)!=null&&i.status&&(a.resData.status="fail"),Yo.set(s,a),kv())}),n.forEach(r2e),LF()}else{if(xy===5){xy=0,Yo.forEach(t=>{var n;(n=t.fail)==null||n.call(t,{})});return}xy++,LF()}},2e3))},r2e=e=>{var o,i;const{status:t,taskId:n,result:s}=e,a=Yo.get(n);if(a&&(a.resData=e,a.lastTime=Date.now(),Yo.set(n,a),kv()),t==="success"){if(be.closeMessage(n),s){const{status:l,msg:c,...d}=s;l==="success"?(o=a==null?void 0:a.success)==null||o.call(a,d):c&&((i=a==null?void 0:a.fail)==null||i.call(a,d),be.error(c))}Yo.delete(n)}},u_=({items:e,onClick:t,value:n})=>{const s=ie(),a=e.find(o=>o.data.value===n);return r.jsxs("div",{className:"flex items-center animate-click",onClick:o=>{s.dropdown({popcorn:o.target,content({onCloseModal:i}){return r.jsx("div",{className:"next-modal w-[200px] py-2",children:r.jsx(ze,{items:e,onItemClick:l=>{t(l.data.value),i()}})})}})},children:[r.jsx("div",{className:"text-t2",children:a==null?void 0:a.data.title}),r.jsx(V,{name:"IcArrowDown01",className:"ml-2 text-grey4",size:"tiny"})]})},Md=({title:e,className:t,children:n})=>r.jsxs("div",{className:R("flex items-center justify-between mb-4",t),children:[r.jsx("div",{className:"text-t2 text-grey3",children:e}),n]}),a2e=[.25,.5,.75,1,1.25,1.5,1.75,2].map(e=>({type:H.OPERABLE_BLOCK_TEXT,data:{title:"".concat(e*100,"%"),value:e}})),o2e=[{type:H.OPERABLE_BLOCK_TEXT,data:{title:"PDF",value:"pdf"}},{type:H.OPERABLE_BLOCK_TEXT,data:{title:"Markdown & CSV",value:"markdown"}},{type:H.OPERABLE_BLOCK_TEXT,data:{title:"Word",value:"word"}}],i2e=[{type:H.OPERABLE_BLOCK_TEXT,data:{title:"A4",value:"a4"}},{type:H.OPERABLE_BLOCK_TEXT,data:{title:"A3",value:"a3"}}],l2e=[{type:H.OPERABLE_BLOCK_TEXT,data:{title:"当前视图范围",value:"current"}},{type:H.OPERABLE_BLOCK_TEXT,data:{title:"全部",value:"all"}}],c2e=[{type:H.OPERABLE_BLOCK_TEXT,data:{title:"竖向",value:!1}},{type:H.OPERABLE_BLOCK_TEXT,data:{title:"横向",value:!0}}],BH=({uuid:e,onCloseModal:t})=>{const n=lt(),s=e||n,a=Dt(),o=Ce(({blocks:d})=>{const u=d[s];if(!u)return!1;if(ga(u.type))return!0;const f=h=>{const p=d[h];if(p){if([m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION].includes(p.type))return!0;if(tn(p.type))return!1;const{subNodes:g}=p;return g.some(f)}};return!!u.subNodes.some(f)},[s]),[i,l]=y.useState({type:"pdf",pdfFormat:"a4",dataBaseRange:"current",scale:1,landscape:!1}),c=async()=>{var u;me.event("export_page",{export_type:i==null?void 0:i.type,page_type:(u=J.blocks[s])==null?void 0:u.type});const d=await D4({eventName:"export",request:{blockId:s,spaceId:a.uuid,exportOptions:i}},{success({url:f}){f&&t7(f),be.closeMessage(d)},fail(){be.closeMessage(d)}});t(),s2e(d,"正在导出，请稍候...")};return r.jsxs("div",{className:"w-[360px] px-8 py-6",children:[r.jsx(Md,{title:"导出格式",children:r.jsx(u_,{items:o2e,value:i==null?void 0:i.type,onClick:d=>{l(d==="markdown"?()=>({type:d,includeContents:!0,includeSubPages:!0,flattenFileTree:!1}):()=>({type:d,pdfFormat:"a4",dataBaseRange:"current",scale:1}))}})}),(i==null?void 0:i.type)==="pdf"&&r.jsxs(r.Fragment,{children:[r.jsx(Md,{title:"页面尺寸",children:r.jsx(u_,{items:i2e,value:i==null?void 0:i.pdfFormat,onClick:d=>l(u=>({...u,pdfFormat:d}))})}),o&&r.jsx(Md,{title:"多维表导出范围",children:r.jsx(u_,{items:l2e,value:i==null?void 0:i.dataBaseRange,onClick:d=>l(u=>({...u,dataBaseRange:d}))})}),r.jsx(Md,{title:"显示比例",children:r.jsx(u_,{items:a2e,value:i==null?void 0:i.scale,onClick:d=>l(u=>({...u,scale:d}))})}),r.jsx(Md,{title:"排版",children:r.jsx(u_,{items:c2e,value:i==null?void 0:i.landscape,onClick:d=>l(u=>({...u,landscape:d}))})})]}),(i==null?void 0:i.type)==="markdown"&&r.jsxs(r.Fragment,{children:[r.jsx(Md,{title:"导出附件",children:r.jsx(en,{open:!!i.includeContents,onSwitch:d=>l(u=>({...u,includeContents:d}))})}),r.jsx(Md,{title:"导出子页面",children:r.jsx(en,{open:!!i.includeSubPages,onSwitch:d=>l(u=>({...u,includeSubPages:d}))})}),r.jsx(Md,{title:"按目录导出",children:r.jsx(en,{open:!i.flattenFileTree,onSwitch:d=>l(u=>({...u,flattenFileTree:!d}))})})]}),r.jsxs("div",{className:"flex items-center justify-end mt-6",children:[r.jsx(De,{onClick:t,className:"mr-4 text-t2-medium",children:"取消"}),r.jsx(De,{colorType:"active",className:"text-t2-medium text-white",onClick:c,children:"导出"})]})]})},OH="由".concat(JI,"提供技术支持"),d2e=e=>{const{exportOption:t}=e,n=po(),s=df(),a=ya();return t.type!=="png"?null:r.jsxs("div",{className:e.className,children:[r.jsxs("div",{className:"flex mb-4",children:[r.jsx("div",{className:"text-t2 text-grey3",children:"导出格式"}),r.jsxs("div",{className:"flex items-center ml-5 ",children:[r.jsx("div",{className:"text-t2",children:"PNG"}),r.jsx(V,{name:"IcArrowDown01",className:"ml-2 text-grey4",size:"tiny"})]})]}),r.jsxs("div",{className:"flex items-start mb-4",children:[r.jsx("div",{className:"text-t2 text-grey3",children:"更多设置"}),r.jsxs("div",{className:"ml-5",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx(V,{size:"large",name:t.transparent?"IcCheckboxCheck":"IcCheckbox",className:R("mr-0.5 ",t.transparent?"text-active_color":""),onClick:()=>{e.onExportOptionChange({transparent:!t.transparent,watermark:t.watermark})}}),r.jsx("div",{className:"text-t2",children:"透明背景"})]}),r.jsxs("div",{className:"relative flex items-center",children:[r.jsx(V,{size:"large",name:t.watermark?"IcCheckboxCheck":"IcCheckbox",className:R("mr-0.5 ",t.watermark?"text-active_color":""),onClick:()=>{if(n){s(()=>{a(Mt.export_watermark)});return}e.onExportOptionChange({transparent:t.transparent,watermark:t.watermark?"":OH})}}),r.jsxs("div",{className:"text-t2",children:[Na," 水印"]}),n&&r.jsx(_l,{className:"right-0 -top-1"})]})]})]}),r.jsxs("div",{className:"flex items-center justify-end mt-24 ml-10",children:[r.jsx(De,{onClick:e.onCancel,className:"mr-4 text-t2-medium",children:"取消"}),r.jsx(De,{colorType:"active",className:"text-t2-medium text-white",onClick:async()=>{var o;(o=e.onExport)==null||o.call(e)},children:"导出"})]})]})},u2e=e=>{const{snapshot:t,transparent:n,isWidthMax:s=!0}=e,a=()=>t?r.jsx("img",{src:t,className:s?"w-full":"h-full"}):r.jsx(xs,{className:"h-full"});return r.jsx("div",{className:"w-[250px] h-[250px] shrink-0 p-5 flex items-center justify-center",style:{background:n?"url(".concat(vn.transparent,")"):void 0},children:a()})},Tv=60,f2e=async(e,t)=>{if(t.type==="png"&&e.firstChild instanceof HTMLElement){const n=e.querySelector(".node-drawer");if(!n)return;const s=n.getBoundingClientRect();return await pj(n,{backgroundColor:t.transparent?null:void 0,useCORS:!0,x:0,y:0,width:s.width-100,height:s.height+Tv,scale:window.devicePixelRatio,ignoreElements:o=>!!o.classList.contains("hidden-textarea")})}},O6=(e,t,n)=>{var s,a,o;if(t.firstChild instanceof HTMLElement){const i=t.firstChild.getBoundingClientRect(),l=e.getContext("2d");if(!l)return;l.save(),l.font="14px normal",l.textAlign="left";const c=e.width/((s=n.scale)!=null?s:window.devicePixelRatio),d=e.height/((a=n.scale)!=null?a:window.devicePixelRatio),u=(i.width-c)/2,f=(i.height-d)/2;if(l.translate(i.left+u,i.top+f),l.clearRect(0,d,c,d+Tv),n.watermark){l.fillStyle=n.isDarkMode?"white":"grey";const h=l.measureText(n.watermark).width;l.fillText(n.watermark,(c-h)*.5,d+(Tv-10)/((o=n.scale)!=null?o:window.devicePixelRatio))}if(n.repeatWatermark){const p=l.measureText(n.repeatWatermark).width,g=30,_=45,x=-120;l.globalAlpha=.045;for(let F=0;F<d;F+=_+g)for(let b=0;b<c;b+=p+g)l.translate(b,F),l.rotate(x),l.fillText(n.repeatWatermark,0,0),l.rotate(-x),l.translate(-b,-F)}l.restore()}},MH=e=>{const[t,n]=y.useState(),s=y.useMemo(()=>Ri("right")===e.id,[e.id]),a=wj(e.id,e.id),[o,i]=y.useState(),[l,c]=y.useState(()=>({type:"png",transparent:!1,watermark:OH,isDarkMode:Xo(),alreadySnapShot:!1})),d=Ip("openWatermark");return y.useEffect(()=>{const u=oC(e.id);if(!u)return;const{scale:f}=u.getSnapShot(),h=a>300?80:100;return u==null||u.zoom(h),()=>{u.zoom(f)}},[a,e.id]),y.useEffect(()=>{if(l.type==="png"&&l.alreadySnapShot)return;const u=bn(".next-space-page,.mind-page",s);if(u instanceof HTMLElement){if(!oC(e.id))return;setTimeout(()=>{f2e(u,{...l,transparent:!0}).then(h=>{i(h),n(h==null?void 0:h.toDataURL("image/png")),c(p=>({...p,alreadySnapShot:!0}))})},1e3)}},[l,s,e.id]),y.useEffect(()=>{const u=xa(),f=d?u.nickname+u.phone.slice(-4):"";switch(l.type){case"png":{if(!l.alreadySnapShot||!o)return;const h=bn(".next-space-page,.mind-page",s);if(!oC(e.id))return;h instanceof HTMLElement&&(O6(o,h,{transparent:l.transparent,watermark:l.watermark,isDarkMode:Xo(),repeatWatermark:f}),n(o==null?void 0:o.toDataURL("image/png")));break}}},[o,l.alreadySnapShot,l.transparent,l.type,l.watermark,s,d,e.id]),r.jsxs("div",{className:"w-[600px] py-7 pb-5 px-7",children:[r.jsx("div",{className:"text-h2",children:"导出页面"}),r.jsxs("div",{className:"flex mt-7",children:[r.jsx(u2e,{snapshot:t,transparent:l.transparent,isWidthMax:!!(o&&o.width>o.height)}),r.jsx(d2e,{exportOption:l,onExportOptionChange:u=>{c(f=>({...f,...u}))},className:"ml-7 mt-2 w-full",onCancel:()=>{var u;(u=e.onCloseModal)==null||u.call(e)},onExport:()=>{var w;if(!o||!t)return;const u=J.blocks[e.id];if(!u)return;(w=e.onCloseModal)==null||w.call(e),me.event("export_page",{export_type:"PNG",page_type:u.type});const f=bn(".next-space-page,.mind-page",s);if(!f)return;const h=document.createElement("a"),p=fe(u==null?void 0:u.data.segments)||qt(u==null?void 0:u.type),g="".concat(p,".png");l.watermark&&O6(o,f,{transparent:l.transparent,watermark:"",isDarkMode:Xo(),repeatWatermark:""});const _=document.createElement("canvas"),x=240;_.width=o.width+x,_.height=o.height+x;const F=_.getContext("2d");if(!F)return;F.save(),F.fillStyle=l.transparent?"transparent":Xo()?"black":"white",F.fillRect(0,0,_.width,_.height);const b=new Image;b.setAttribute("crossOrigin","anonymous"),b.onload=()=>{if(F.drawImage(b,0,0,o.width,o.height,x/2,x/2,o.width,o.height),F.stroke(),l.watermark){F.font="28px normal",F.textAlign="left",F.fillStyle=Xo()||l.transparent?"white":"grey";const C=F.measureText(l.watermark).width;F.fillText(l.watermark,(_.width-C)*.5,_.height-x*.3)}F.restore();const E=_.toDataURL("image/png");h.download=g,h.href=E,h.click()},b.src=o==null?void 0:o.toDataURL("image/png")}})]})]})},A4=({uuid:e,formHeaderMenu:t})=>{var ne;const n=ys(),s=ye(e,["updatedBy","updatedAt","data"]),a=tn(s==null?void 0:s.type),o=ns(),i=Oe(),l=ie(),c=dh(),d=fh(),u=Pd(),f=O5(),h=hx(e),p=sh(),{selectedBlockHistory:g}=Nl(),_=Mw(e),x=We(e),F=Ce(se=>lr(se.ui.selectedBlocks).some(ce=>ce===e),[],{obsSelectBlocks:[{blockId:e}]}),b=Ho(),w=s2(e),E=GE(),{illegal:C,role:k}=mt(e),T=C?Ts:fe(s==null?void 0:s.data.segments),v=y.useMemo(()=>rn(T),[T]),I=y.useRef(),[j,S]=y.useState(v.name),[D,A]=y.useState(!1),P=_r((ne=s==null?void 0:s.updatedBy)!=null?ne:""),L=pt(),O=[m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(k);y.useEffect(()=>()=>{l.closeModal(Ve.DRIVE_FILE_CONTEXTMENU)},[l]),y.useEffect(()=>{S(a?T:v.name)},[T]);const $=()=>{A(!1),!(j===v.name||a&&j===T)&&i(()=>{!j&&!a?S(v.name):_e(e,{updatedAt:Date.now(),data:{segments:ht(a?j:mI(j,v.extName))}})})},M=y.useCallback(()=>{E(J.ui.selectedBlocks)},[E]),U=()=>{l.modal({content:se=>ir(s==null?void 0:s.type)?r.jsx(MH,{onCloseModal:se.onCloseModal,id:e}):r.jsx(BH,{uuid:e,onCloseModal:se.onCloseModal})})},z=()=>{I.current&&u({popcorn:I.current,uuid:e,placement:"left",offset:[0,20],placeholder:"搜索拷贝到...的页面",copyAndMove:{}})},K=y.useCallback(()=>{if(location.href.includes("preview")){o.push("/preview/".concat(e));return}if(_3(v.extName)){p({uuid:e});return}d(e)},[v.extName,d,e,o,p]),W=se=>{if(me.event("content_view"),a){n(e,{forceOpenInRight:se==null?void 0:se.altKey});return}if(!a&&(s==null?void 0:s.type)!==m.BlockType.FILE){be.warning("非文件暂不支持预览");return}Jt.pdf.test(v.extName)?window.open("/".concat(L?"share/":"preview/").concat(e)):K()},Y=y.useCallback(()=>{c(J.ui.selectedBlocks.map(se=>se.blockId))},[c]),G=se=>{se.preventDefault(),se.stopPropagation(),re(F?at.updateSelectBlocks(J.ui.selectedBlocks.filter(ce=>ce.blockId!==e)):at.updateSelectBlocks([...J.ui.selectedBlocks,{blockId:e}]))},ee=se=>{se.preventDefault(),se.stopPropagation(),!x&&re(at.updateSelectBlocks([{blockId:e}]))},te=(se,ce=!1)=>{var Se,Re;if(se.preventDefault(),se.stopPropagation(),x)return;me.event("content_menu"),I.current=_m(se),F||re(at.updateSelectBlocks([{blockId:e}]));const{selectedBlocks:ae}=J.ui,de=J.blocks[(Re=(Se=ae[0])==null?void 0:Se.blockId)!=null?Re:""],ke=ae.length===1,Te=O&&ke&&!L,he=$5(),Ee=he&&ke&&!ir(de==null?void 0:de.type)&&ZEe(de==null?void 0:de.type);let ge=[{type:H.OPERATION,isHidden:!ke,data:{type:2,icon:"IcMenuOpen",title:"打开",onClick:W}},{type:H.OPERATION,isHidden:t||!Ee,data:{type:0,icon:"IcDownload",title:"导出",onClick:U}},{type:H.OPERATION,isHidden:t||he,data:{type:0,icon:"IcDownload",title:"下载",onClick:Y}},{type:H.OPERATION,isHidden:!ke||x||t||ce,data:{type:4,icon:"IcEdit02",title:"重命名",onClick:()=>A(!0)}},{type:H.OPERATION,isHidden:ce,data:{type:3,icon:"IcDuplicate",title:"拷贝副本",onClick:M}},{type:H.OPERATION,isHidden:ce,data:{type:9,icon:"IcCopyToPage",title:"拷贝副本至页面",onClick:z}},{type:H.OPERATION,isHidden:ce||!ke,data:{type:8,icon:"IcLink",title:a?"拷贝页面访问链接":"拷贝块访问链接",onClick:qn(()=>{if(me.event("copy_page_link"),a)Xt("".concat(_n(),"/").concat(e),{message:"已复制链接"});else{const Ae=ks(e);Ae&&Xt("".concat(_n(),"/").concat(Ae,"#").concat(e),{message:"已复制链接"})}},300,{leading:!0})}},{type:H.LINE,isHidden:x||t,data:{}},{type:H.OPERATION,isHidden:!_,data:{type:1,icon:"IcMove",title:"移动到",onClick:()=>{I.current&&u({popcorn:I.current,uuid:e})}}},{type:H.LINE,isHidden:x||t,data:{}},{type:H.OPERATION,isHidden:w||x||t,data:{type:5,icon:"IcTrash",title:"删除",onClick:()=>{i(()=>{gr(lr(J.ui.selectedBlocks)),g([])})}}},{type:H.OPERATION,isHidden:!w||x,data:{type:6,icon:"IcTrashRestore",title:"恢复",onClick:()=>{f(e)}}},{type:H.LINE,isHidden:!w||x,data:{}},{type:H.OPERATION,isHidden:!w||x,data:{type:7,icon:"IcTrash",title:"彻底删除",onClick:h}}];Te&&ge.push({type:H.LINE,isHidden:!1,data:{}}),C&&(ge=[{type:H.OPERATION,isHidden:x,data:{type:7,icon:"IcTrash",title:"彻底删除",onClick:()=>h()}}]),l.dropdown({modalId:Ve.DRIVE_FILE_CONTEXTMENU,popcorn:I.current,placement:"right-start",offset:[4,4],content:Ae=>r.jsx(ze,{className:"w-[200px] py-2 overflow-y-auto max-h-[80vh] next-modal",onItemClick:()=>Ae.onCloseModal(),items:ge,customFooter:Te&&r.jsx(Zm,{name:P,updatedAt:s==null?void 0:s.updatedAt,isByAI:s==null?void 0:s.data.isByAI})})})},Q=v.extName.toLowerCase()==="pdf";return{selectCurrentBlock:ee,selectBlock:G,isSelected:F,openMenuList:te,handleClick:W,rename:$,isDragging:b,showRename:D,illegal:C,name:j,readonly:x,setName:S,fileName:T,isPDF:Q,isPage:a}},R4="grid grid-cols-11 gap-x-2 h-[46px] items-center text-t2",m2e=e=>{const{uuid:t,canDownload:n}=e,s=DH(),a=ye(t,["data","updatedAt","createdAt"],["size","ossName"]),{selectCurrentBlock:o,openMenuList:i,handleClick:l,rename:c,setName:d,selectBlock:u,isDragging:f,showRename:h,illegal:p,name:g,readonly:_,isPage:x,fileName:F,isSelected:b,isPDF:w}=A4({uuid:t}),{enableAI:E}=xr(),C=dh();if(!a)return null;const k=p?"-":PU(a.updatedAt||a.createdAt||0),T=a.data.size&&!p?As(a.data.size):"-";return r.jsxs(AH,{uuid:a.uuid,onContextMenu:i,onClick:l,showDefaultBorder:!0,className:R("flex items-center group relative",p&&"opacity-30",!f&&!b&&"hover:bg-active_color_10"),children:[!x&&n&&r.jsx(Fe,{popup:b?"取消选中":"选中",className:R("transition-opacity opacity-0 absolute -left-6 z-10 group-hover:opacity-100",b&&"opacity-100"),children:r.jsx(_a,{size:"small",checkbox2:!0,checked:!!b,onClick:u})}),r.jsxs("div",{className:R(R4,"flex-1 grid grid-cols-11 gap-x-2 transition-none cursor-pointer relative"),children:[r.jsxs("span",{className:"flex relative items-center col-span-7",children:[r.jsx("span",{className:"mr-2 flex items-center justify-center",children:r.jsx(ah,{ossName:a.data.ossName,className:Cv(Xs.TABLE).class,uuid:a.uuid,options:{videoPlayIconSize:"small",resizeWidth:Cv(Xs.TABLE).size},defaultIcon:r.jsx(Fn,{trigger:x,blockId:a.uuid,iconSize:18,className:"p-1",defaultIcon:r.jsx(_s,{uuid:a.uuid,size:"middle",className:"flex-shrink-0"})})})}),h?r.jsx(Ct,{selection:[0,g.length],onEnter:c,className:"h-8 w-full max-w-[360px]",autoFocus:!0,placeholder:qt(a.type),value:g,onBlur:c,onChange:v=>d(v)}):F&&!x?r.jsx(Ad,{className:"w-[calc(100%-100px)]",fileName:F}):r.jsx("span",{className:"text-ellipsis",children:F||qt(a.type)}),!x&&n&&pt()&&r.jsx("div",{className:"ml-auto flex items-center transition-opacity opacity-0 group-hover:opacity-100",children:r.jsx(Fe,{popup:"下载",className:"cursor-pointer animate-hover rounded",children:r.jsx(V,{name:"IcDownload",size:"middle",onClick:v=>{v.preventDefault(),v.stopPropagation(),C([t])}})})}),!_&&r.jsxs("div",{className:"ml-auto flex items-center transition-opacity opacity-0 group-hover:opacity-100",children:[!p&&E&&w&&r.jsx(Fe,{popup:"PDF 助手",className:"cursor-pointer animate-hover rounded mr-2",onClick:()=>s(t),children:r.jsx(V,{name:"IcAi",size:"middle"})}),!p&&r.jsx(tx,{pos:"fileItem",uuid:a.uuid,className:"mr-2"}),r.jsx(Fe,{popup:"更多",className:"cursor-pointer animate-hover rounded",children:r.jsx(V,{...Gs(Hs.driveFileMore),name:"IcMore",size:"middle",onClick:v=>{o(v),i(v)}})})]})]}),r.jsx(Fe,{placement:"top-start",popup:k,className:"col-span-2 text-ellipsis",children:k}),r.jsx("span",{className:"text-ellipsis col-span-2",children:T})]})]})},h2e=({uuid:e})=>{var o,i;const t=hc(e);if(!t)return null;const n=l=>{N0.abort(l),G3(t.key)},s=(o=t.name)!=null?o:"",a=rn(s);return r.jsxs("div",{className:R("relative p-px",R4),children:[r.jsxs("span",{className:"flex items-center col-span-7",children:[r.jsx(V,{name:Ya(a.extName),size:"xxlarge",className:"flex-shrink-0 mr-2 p-1"}),r.jsx(Ad,{className:"w-[calc(100%-100px)]",fileName:s})]}),r.jsxs("span",{className:"col-span-2",style:{color:tr(t.status===is.uploading?Ze.blue:Ze.red)},children:[t.status===is.uploading&&"已上传".concat(t.progress,"%"),t.status===is.failure&&"上传失败"]}),r.jsx("span",{className:"col-span-2",children:As(t.size)}),r.jsx(V,{size:"middle",name:"IcUploadCancel",className:"absolute right-3 text-grey3",onClick:()=>{var l;return n((l=t.uploadId)!=null?l:"")}}),r.jsx(j4,{progress:(i=t.progress)!=null?i:-1,fail:t.status===is.failure,className:"absolute h-[3px] right-0 bottom-[-1px] w-[36%]"})]},t.key)},p2e=y.memo(({uuid:e})=>{var l,c;const t=We(e),n=ye(e,["data"],["format"]),s=V5(e);if(!n)return null;const{sortType:a,reverse:o}=aw((c=(l=n.data)==null?void 0:l.format)==null?void 0:c.orderFolder),i=d=>r.jsx(V,{size:"middle",className:R(o&&"rotate-180",!d&&"hidden"),name:"IcArrowUp02"});return r.jsxs("div",{className:R(R4,"text-grey3 flex-1",t&&"pointer-events-none"),children:[r.jsxs("span",{onClick:()=>s("name"),className:"cursor-pointer items-center flex col-span-7",children:["文件名",i([m.OrderFolderType.NAME,m.OrderFolderType.NAME_REVERSED].includes(a))]}),r.jsxs("span",{onClick:()=>s("time"),className:"col-span-2 text-ellipsis cursor-pointer items-center flex",children:["上次修改时间",i([m.OrderFolderType.TIME,m.OrderFolderType.TIME_REVERSED].includes(a))]}),r.jsxs("span",{onClick:()=>s("size"),className:"col-span-2 text-ellipsis cursor-pointer items-center flex",children:["文件大小",i([m.OrderFolderType.SIZE,m.OrderFolderType.SIZE_REVERSED].includes(a))]})]})}),g2e=y.memo(e=>{const{uuid:t,isPreView:n,canDownload:s}=e,a=ye(t,["data","updatedAt","createdAt"],["ossName","size"]),{selectCurrentBlock:o,openMenuList:i,handleClick:l,rename:c,setName:d,showRename:u,name:f,isDragging:h,selectBlock:p,illegal:g,readonly:_,isPage:x,fileName:F,isSelected:b}=A4({uuid:t}),w=dh(),E=Cv(n?Xs.PREVIEW:Xs.THUMBNAIL);return a?r.jsxs(AH,{uuid:a.uuid,onContextMenu:i,onClick:l,className:R("flex relative m-2.5 ml-0 px-1.5 py-2.5 group cursor-pointer",n?"w-44":"w-28",g&&"opacity-30",!h&&!b&&"hover:bg-active_color_10"),children:[!x&&s&&r.jsxs(r.Fragment,{children:[r.jsx(Fe,{popup:b?"取消选中":"选中",className:R("transition-opacity opacity-0 absolute left-2 top-2 z-10 group-hover:opacity-100",b&&"opacity-100"),children:r.jsx(_a,{size:"small",checkbox2:!0,checked:!!b,onClick:p})}),!x&&s&&pt()&&r.jsx(Fe,{popup:"下载",className:"transition-opacity opacity-0 right-2 top-2 z-10 group-hover:opacity-100 absolute cursor-pointer animate-hover",children:r.jsx(V,{name:"IcDownload",size:"middle",onClick:C=>{C.preventDefault(),C.stopPropagation(),w([t])}})}),!_&&r.jsx(Fe,{popup:"更多",className:"transition-opacity opacity-0 right-2 top-2 z-10 group-hover:opacity-100 absolute cursor-pointer animate-hover",children:r.jsx(V,{...Gs(Hs.driveFileMore),name:"IcMore",size:"middle",onClick:C=>{o(C),i(C)}})})]}),r.jsxs("div",{className:"flex items-center justify-center flex-col w-full",children:[r.jsx(ah,{ossName:a.data.ossName,className:E.class,options:{videoPlayIconSize:"xxxlarge",resizeWidth:E.size},uuid:a.uuid,defaultIcon:r.jsx(Fn,{trigger:!1,blockId:a.uuid,iconSize:n?100:50,defaultIcon:r.jsx(_s,{uuid:a.uuid,size:n?"preview":"max"})})}),r.jsxs("div",{className:"w-full text-center mt-2 text-t2 h-6",children:[u&&r.jsx(Ct,{selection:[0,f.length],onEnter:c,className:"h-6 w-full",autoFocus:!0,placeholder:qt(a.type),value:f,onBlur:c,onChange:C=>d(C)}),!u&&(F&&!x?r.jsx(Ad,{className:"flex justify-center",fileName:F}):r.jsx("div",{className:"text-ellipsis",children:F||qt(a.type)}))]}),r.jsx("div",{className:"text-t4 text-grey3 text-center",children:g?"-":PU(a.updatedAt||a.createdAt||0)}),r.jsx("div",{className:"text-t4 text-center text-grey3",children:a.data.size&&!g?As(a.data.size):"-"})]})]}):null}),_2e=y.memo(({uuid:e})=>{var u,f;let t;(h=>{h.name="文件名",h.time="上次修改时间",h.size="文件大小"})(t||(t={}));const n=ie(),s=ye(e,["data"],["format"]),a=V5(e),o=We(e),{sortType:i,reverse:l}=aw((f=(u=s==null?void 0:s.data)==null?void 0:u.format)==null?void 0:f.orderFolder),c=y.useMemo(()=>{const h={title:"上次修改时间",type:"time"};switch(i){case m.OrderFolderType.NAME:case m.OrderFolderType.NAME_REVERSED:{h.type="name";break}case m.OrderFolderType.TIME:case m.OrderFolderType.TIME_REVERSED:{h.type="time";break}case m.OrderFolderType.SIZE:case m.OrderFolderType.SIZE_REVERSED:{h.type="size";break}}return h.title=t[h.type],h},[i,t]);if(!s||o)return null;const d=h=>{n.dropdown({popcorn:h.currentTarget,placement:"bottom-start",content:({onCloseModal:p})=>r.jsx(ze,{className:"next-modal py-2.5 w-40",onItemClick:()=>p(),items:ka(t).map(g=>({type:H.OPERATION,data:{title:t[g],type:g,selected:c.type===g,onClick:()=>a(g)}}))})})};return r.jsx("div",{className:"text-grey3 text-t2-medium flex items-center h-10 justify-between w-full",children:r.jsxs("div",{className:"flex items-center h-full",children:["排序方式：",r.jsx("span",{className:R("flex items-center cursor-pointer h-full mr-2"),onClick:d,children:c.title}),r.jsx(V,{size:"middle",className:R("animate-hover",l&&"rotate-180"),name:"IcArrowDown02",onClick:()=>a(c.type)})]})})}),x2e=({uuid:e,isPreView:t})=>{var i,l;const n=hc(e),s=c=>{N0.abort(c),n&&G3(n.key)};if(!n)return null;const a=(i=n==null?void 0:n.name)!=null?i:"",o=rn(a);return r.jsxs("div",{className:R("relative flex flex-col items-center justify-center m-2.5 px-1.5 py-2.5",t?"w-52":"w-28"),children:[r.jsx(V,{size:"middle",name:"IcUploadCancel",className:"absolute right-1 top-1 text-grey3",onClick:()=>{var c;return s((c=n.uploadId)!=null?c:"")}}),r.jsx(V,{name:Ya(o.extName),size:t?"preview":"max",className:"flex-shrink-0"}),r.jsx(Ad,{className:"w-full flex items-center justify-center mt-2 text-t2 h-6",fileName:a}),r.jsx("div",{className:"text-t4 text-grey3",children:As(n.size)}),r.jsxs("div",{className:"text-t4",style:{color:tr(n.status===is.uploading?Ze.blue:Ze.red)},children:[n.status===is.uploading&&"已上传".concat(n.progress,"%"),n.status===is.failure&&"上传失败"]}),r.jsx(j4,{progress:(l=n.progress)!=null?l:-1,fail:n.status===is.failure,className:"absolute h-[3px] left-0 bottom-0 w-full"})]},n.key)},y2e=y.memo(e=>{const{uuid:t,listView:n,canDownload:s}=e;switch(n){case Xs.PREVIEW:case Xs.THUMBNAIL:return r.jsx(g2e,{isPreView:n===Xs.PREVIEW,uuid:t,canDownload:s});case Xs.TABLE:default:return r.jsx(m2e,{uuid:t,canDownload:s})}}),b2e=y.memo(({listView:e,uuid:t})=>{switch(e){case Xs.PREVIEW:case Xs.THUMBNAIL:return r.jsx(x2e,{uuid:t,isPreView:e===Xs.PREVIEW});case Xs.TABLE:default:return r.jsx(h2e,{uuid:t})}}),F2e=y.memo(({listView:e,uuid:t})=>{switch(e){case Xs.PREVIEW:case Xs.THUMBNAIL:return r.jsx(_2e,{uuid:t});case Xs.TABLE:default:return r.jsx(p2e,{uuid:t})}}),w2e=({uuid:e,container:t})=>{var x;const n=f9(e),s=n===Xs.TABLE,a=We(e),{allowDownload:o}=mt(e),i=ye(e,[]),l=rE(e),c=M9(e),d=y8(),u=!!(l.files.length+l.folder.length+c.length),f=o&&pt()||!a,h=y.useRef(null),p=(x=ft(e,F=>{var b;return(b=F==null?void 0:F.data.format)==null?void 0:b.commentAlignment}))!=null?x:"top",g=y.useMemo(()=>{const F=[];return l.folder.forEach(b=>{F.push({uuid:b.uuid,type:2})}),c.filter(b=>b.uploadId).forEach(b=>{b.key&&F.push({uuid:b.key,type:0})}),l.files.forEach(b=>{F.push({uuid:b.uuid,type:2})}),F},[l.files,l.folder,c]);if(y.useEffect(()=>{const F=g.map(b=>b.uuid);d({isVirtualListMode:!0,virtualRef:h,subNodes:F||[]})},[g]),!i)return null;const _={overscan:200,customScrollParent:t,totalCount:g.length,itemContent:F=>{const b=g==null?void 0:g[F];return b?b.type===0?r.jsx(b2e,{uuid:b.uuid,listView:n}):r.jsx(y2e,{uuid:b.uuid,listView:n,canDownload:f},b.uuid):null}};return r.jsx(H5.Provider,{value:{isDriveIcon:!0},children:r.jsxs("div",{className:"px-24 sm:px-10 select-none flex flex-col flex-1","data-page-id":e,children:[r.jsxs("article",{className:"w-full h-full block-content flex-1",children:[u&&r.jsxs("div",{className:"flex items-center group relative",children:[f&&r.jsx(JEe,{className:"absolute -left-6 opacity-30 transition-opacity group-hover:opacity-100 cursor-pointer",ids:[...l.files,...l.folder].map(F=>F.uuid)}),r.jsx(F2e,{uuid:i.uuid,listView:n})]}),u?r.jsxs("div",{children:[s?r.jsx(qs,{..._,ref:h}):r.jsx(rY,{ref:h,..._,listClassName:"flex flex-wrap"}),f&&r.jsx(Di,{})]}):r.jsx(YEe,{readonly:a})]}),p==="bottom"&&r.jsx(y2,{pageId:e,isBottom:!0})]})})},E2e=()=>{const e=Oe(),t=ih(),n=jd(),s=ys(),a=ns();return y.useCallback(o=>{const i=n(m.BlockType.MIND_MAPPING_PAGE,{parentId:o.parentId,last:!0});if(!i){be.error("创建失败");return}e(()=>{t({parentId:i,last:!0},i),t({parentId:i,last:!0},i),t({parentId:i,last:!0},i)}),o.openType==="openPage"?s(i):a.push("/".concat(i))},[t,n,a,s,e])},C2e=({uuid:e})=>{const t=We(e),{allowDownload:n}=mt(e),s=$5(),a=n&&pt()||!t,o=ns(),i=jd(),l=ie(),c=XO(),d=ln(),u=Ce(w=>{var E;return(E=w.ui.selectedBlocks[0])==null?void 0:E.blockId},[],{obsSelectBlocks:[{all:!0}]}),f=Js(),h=E2e(),p=w=>{const E=w.target.files;E!=null&&E.length&&(c({ownerPageId:e,files:Array.from(E),type:"file",spaceId:Ot(),userId:yt.uuid,onComplete:()=>{},inTransferList:!0}),w.target.value="",f(Je.CREATE_FOLDER_AND_UPLOAD,ct.basicList,{step2:!0})),d(Ve.DRIVE_UPLOAD_MENU)},g=async w=>{const E=w.target.files;if(!E)return;const C=[];for(const k of E)C.push(k);c({inTransferList:!0,ownerPageId:e,files:C,type:"file",spaceId:Ot(),userId:yt.uuid,onComplete:()=>{}}),d(Ve.DRIVE_UPLOAD_MENU)},_=()=>{const w=i(m.BlockType.FOLDER,{parentId:e,last:!0});w&&o.push("/".concat(w))},x=w=>{l.dropdown({popcorn:w.currentTarget,placement:"bottom",content:E=>r.jsx(ze,{className:Ra,onItemClick:C=>{switch(E.onCloseModal(),C.data.type){case m.BlockType.PAGE:{const k=i(m.BlockType.PAGE,{parentId:e,last:!0});o.push("/".concat(k));break}case m.BlockType.MIND_MAPPING_PAGE:{h({parentId:e,openType:"push"});break}case m.BlockType.COLLECTION_VIEW_PAGE:{const k=i(m.BlockType.COLLECTION_VIEW_PAGE,{parentId:e,last:!0});k&&Yh(k,m.CollectionViewType.TABLE),o.push("/".concat(k));break}}},items:[{type:H.OPERATION,data:{type:m.BlockType.PAGE,title:"新建页面",icon:"IcPageEmpty"}},{type:H.OPERATION,data:{type:m.BlockType.MIND_MAPPING_PAGE,title:"新建思维导图页面",icon:"IcMindmap"}},{type:H.OPERATION,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,title:"新建多维表页面",icon:"IcTable"}}]})})},F=[{type:H.CUSTOM_RENDER,render:()=>r.jsxs("label",{className:"flex items-center h-10 px-1.5 animate-hover cursor-pointer",children:[r.jsx(V,{name:"IcExportPage",size:"middle",className:"mr-2"}),"上传文件",r.jsx("input",{multiple:!0,type:"file",className:"hidden",onChange:p})]})},{type:H.CUSTOM_RENDER,render:()=>r.jsxs("label",{className:"flex items-center h-10 px-1.5 animate-hover cursor-pointer",children:[r.jsx(V,{name:"MIcUploadFolderMenu",size:"middle",className:"mr-2"}),"上传文件夹",r.jsx("input",{webkitdirectory:"",mozdirectory:"",multiple:!0,type:"file",className:"hidden",onChange:g})]})}],b=w=>{me.event("content_add"),l.dropdown({popcorn:w.currentTarget,modalId:Ve.DRIVE_UPLOAD_MENU,offset:[0,10],content:()=>r.jsx(ze,{className:"w-[200px] py-1.5 px-2 next-modal text-t2",items:F})})};return r.jsxs("div",{className:"relative text-h0 sm:text-h1 sm:flex-col text-black px-24 sm:px-10",children:[r.jsx(K4,{className:"flex flex-col",uuid:e}),r.jsxs("div",{className:R("flex items-center justify-between py-1.5 sm:mt-2 mt-5",!a&&"hidden pl-0"),children:[r.jsx(QEe,{uuid:e}),r.jsxs("div",{className:"flex items-center h-8",children:[u&&r.jsx(k2e,{uuid:u,canDownload:a&&!s,readonly:t}),!t&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"whitespace-nowrap flex items-center text-t2 text-grey3 animate-hover px-2 h-8",onClick:_,children:[r.jsx(V,{name:"IcAdd",className:"mr-1",size:"middle"}),r.jsx("span",{children:"新建文件夹"})]}),r.jsxs("div",{className:"whitespace-nowrap flex items-center ml-2 text-t2 text-grey3 animate-hover px-2 h-8",onClick:x,children:[r.jsx(V,{name:"IcAdd",className:"mr-1",size:"middle"}),r.jsx("span",{children:"新建页面"})]}),r.jsxs(De,{className:"text-t2-medium ml-5",colorType:"active",onClick:b,...Gs(Hs.driveHeaderUpload),children:[r.jsx(V,{name:"IcBtnUpload",className:"mr-1",size:"middle"}),"上传"]})]})]})]})]})},k2e=({uuid:e,canDownload:t,readonly:n})=>{const{openMenuList:s}=A4({uuid:e,formHeaderMenu:!0}),a=dh(),o=Oe(),{selectedBlockHistory:i}=Nl(),l=()=>{a(J.ui.selectedBlocks.map(u=>u.blockId))},c=()=>{o(()=>{gr(lr(J.ui.selectedBlocks)),i([])})},d=pt();return r.jsxs("div",{className:"flex items-center text-t2 text-grey3","data-no-cancel-selected":!0,children:[t&&r.jsxs(Fe,{popup:d?"批量下载":"下载",className:R("flex whitespace-nowrap items-center px-2 h-8 animate-hover",{"mr-2.5":!d}),onClick:l,children:[r.jsx(V,{name:"IcDownload",className:"mr-1",size:"middle"}),d?"批量下载":"下载"]}),!n&&r.jsxs(r.Fragment,{children:[r.jsxs(Fe,{popup:"删除",className:"flex whitespace-nowrap items-center mr-2.5 px-2 h-8 animate-hover",onClick:c,children:[r.jsx(V,{name:"IcTrash",className:"mr-1",size:"middle"}),"删除"]}),r.jsx(Fe,{className:"animate-hover",popup:"更多",children:r.jsx(V,{size:"middle",name:"IcMore",onClick:s})})]}),t&&!d&&r.jsx("span",{className:"w-px h-5 bg-grey6 mx-2.5"})]})},UH=({uuid:e,children:t})=>{const n=y.useRef(null),[s,a]=y.useState(n.current),o=We(e),{fontStyle:i}=T2(e);return N4(),y.useEffect(()=>{a(n.current)},[]),r.jsx("div",{className:R("flex flex-col flex-1 overflow-x-hidden next-space-page"),ref:n,style:i,children:r.jsxs("div",{id:Bm,className:"flex relative flex-col flex-1",children:[r.jsx(C2e,{uuid:e}),r.jsx(w2e,{uuid:e,container:s}),r.jsx(v4,{}),r.jsx("div",{className:"px-24 sm:px-10 mt-8",children:r.jsx(k4,{uuid:e})}),t,o&&r.jsx(k2,{className:"mt-auto"})]})})},VH=e=>ft(e,t=>{var s;const n=(s=t==null?void 0:t.data.format)==null?void 0:s.mindMappingFormat;return!!(n!=null&&n.siblingNodeAlignment)},[],{wait:0}),Fx=e=>ft(e,t=>{var o,i,l;const n=(o=t==null?void 0:t.data.format)==null?void 0:o.mindMappingFormat,s=(i=n==null?void 0:n.type)!=null?i:m.MindMappingType.LOGIC_DIAGRAM_LEFT,a=(l=n==null?void 0:n.lineStyle)!=null?l:m.MindMappingLineStyle.NORMAL;return{mindMapStyle:s,mindMapLineStyle:a}}),T2e=e=>{const{mindMapStyle:t,mindMapLineStyle:n}=Fx(e.mindMapId),s=VH(e.mindMapId),a=Oe(),o=We(e.mindMapId),i=y.useCallback(d=>{if(t===d)return;const u=J.blocks[e.mindMapId];if(!u)return;const f=h=>{var p;_e(e.mindMapId,{data:{format:{mindMappingFormat:{...(p=u.data.format)==null?void 0:p.mindMappingFormat,type:d}}}},h),me.event("switch_layout")};o?f(!0):a(()=>{f(!1)})},[t,e.mindMapId,o,a]),l=y.useCallback(d=>{if(n===d)return;const u=J.blocks[e.mindMapId];if(!u)return;const f=h=>{var p;_e(e.mindMapId,{data:{format:{mindMappingFormat:{...(p=u.data.format)==null?void 0:p.mindMappingFormat,lineStyle:d}}}},h),me.event("switch_line")};o?f(!0):a(()=>{f(!1)})},[n,e.mindMapId,o,a]),c=y.useCallback(d=>{if(d===s)return;const u=J.blocks[e.mindMapId];if(!u)return;me.event("node_align",{is_align:d});const f=h=>{var p;_e(e.mindMapId,{data:{format:{mindMappingFormat:{...(p=u.data.format)==null?void 0:p.mindMappingFormat,siblingNodeAlignment:d}}}},h),me.event("switch_layout")};o?f(!0):a(()=>{f(!1)})},[s,e.mindMapId,o,a]);return r.jsxs("div",{className:"px-4 pt-3 pb-2 w-60","data-ignore-double-click":!0,children:[r.jsx("div",{className:"text-t2 text-grey3",children:"结构"}),r.jsxs("div",{className:"flex items-center mt-3 justify-between",children:[r.jsx(Ih,{name:"IcSkeleton1",className:"p-1",active:t===m.MindMappingType.LOGIC_DIAGRAM_LEFT,onClick:()=>{i(m.MindMappingType.LOGIC_DIAGRAM_LEFT)}}),r.jsx(Ih,{name:"IcSkeleton2",className:"py-1 px-1.5",active:t===m.MindMappingType.LOGIC_DIAGRAM_RIGHT,onClick:()=>{i(m.MindMappingType.LOGIC_DIAGRAM_RIGHT)}}),r.jsx(Ih,{name:"IcSkeleton3",className:"p-1 px-1.5",active:t===m.MindMappingType.MIND_MAPPING,onClick:()=>{i(m.MindMappingType.MIND_MAPPING)}}),r.jsx(Ih,{name:"IcSkeleton4",className:"p-1 px-1.5",active:t===m.MindMappingType.ORGANIZATION_STRUCTURE,onClick:()=>{i(m.MindMappingType.ORGANIZATION_STRUCTURE)}})]}),r.jsx("div",{className:"text-t2 text-grey3 mt-3",children:"分支线"}),r.jsxs("div",{className:"flex items-center justify-between mt-3",children:[r.jsx(Ih,{name:"IcBranch1",className:"py-1.5 px-8",active:n===m.MindMappingLineStyle.NORMAL,onClick:()=>{l(m.MindMappingLineStyle.NORMAL)}}),r.jsx(Ih,{name:"IcBranch2",className:"py-1.5 px-8",active:n===m.MindMappingLineStyle.CUBIC_BEZIER,onClick:()=>{l(m.MindMappingLineStyle.CUBIC_BEZIER)}})]}),r.jsx("div",{className:"text-t2 text-grey3 mt-3",children:"节点宽度"}),r.jsxs("div",{className:"flex items-center justify-between h-10 mt-2",children:[r.jsx("span",{className:"mr-1 text-t2",children:"同级节点对齐"}),r.jsx(en,{open:s,onSwitch:d=>{c(d)}})]})]})},Ih=e=>r.jsx("div",{className:R("hover:animate-hover rounded",{"text-active_color bg-active_color_10":e.active},e.className),onClick:e.onClick,children:r.jsx(V,{name:e.name,size:"xxlarge"})}),v2e=()=>{const e=Aj(),t=Fr(),n=a0e();return r.jsxs("div",{className:"flex items-center h-8 px-1","data-ignore-double-click":!0,children:[r.jsx(Fe,{popup:"缩小画布".concat(Ds,"+-"),children:r.jsx(V,{name:"IcPreviewZoomOut",size:"middle",onClick:()=>{t.zoomout(),me.event("zoomout",{from:1})}})}),r.jsx("div",{className:"w-[110px]",children:r.jsx(bv,{range:{min:0,max:300},scale:e,onZoom:s=>{t.zoom(s)}})}),r.jsx(Fe,{popup:"放大画布".concat(Ds,"++"),children:r.jsx(V,{name:"IcPreviewZoomIn",size:"middle",onClick:()=>{t.zoomin(),me.event("zoomin",{from:1})},className:"ml-3 "})}),r.jsx(Fe,{popup:"定位到中心节点",children:r.jsx(V,{name:"IcMenuAnchor",size:"middle",className:"ml-3",onClick:()=>{n()}})})]})},da=e=>r.jsx("div",{className:R("flex items-center justify-center w-full h-full",{"cursor-pointer hover:bg-black_006":!e.disabled,"opacity-30":e.disabled,"bg-black_006":e.selected&&!e.disabled},e.className),onClick:e.onClick,onPointerDown:t=>{t.preventDefault(),t.stopPropagation()},children:e.children}),v2=()=>{const e=Fr();return y.useCallback((t,n,s)=>{var i;const a=(i=xt.$expandFoldRecord[t])!=null?i:!0,o=n!=null?n:!a;e.updateMindNode({id:t,expanded:o}),Vi([t],o,s)},[e])},$H=()=>{const e=Fr();return y.useCallback(t=>{const n=e.getRootMindNode(),s=n.childrenIds.some(l=>{const c=e.getMindNode(l);return c==null?void 0:c.expanded}),a=t!=null?t:!s,o=[],i=l=>{const c=J.blocks[l];c&&(o.push(l),c.subNodes.forEach(d=>{i(d)}))};n.childrenIds.forEach(l=>{i(l)}),e.toggleAllMindNode(o,a),Vi(o,a)},[e])},I2e=()=>{const e=ie(),t=v2(),n=$i(),s=Fr(),a=ss(),o=y.useMemo(()=>Array.from({length:6}).map((i,l)=>{const c=l+1;return{type:H.OPERATION,data:{title:"展开到 ".concat(c," 层节点"),onClick:()=>{const{blocks:u}=a.getState(),f=(h,p)=>{var _,x,F;const g=s.option.supportAppendChild(h);p<=l?g&&((_=u[h])!=null&&_.subNodes.length)&&(t(h,!0,!1),(x=u[h])==null||x.subNodes.forEach(b=>{f(b,p+1)})):g&&((F=u[h])!=null&&F.subNodes.length)&&t(h,!1,!1)};f(n,0),e.closeModal(Ve.EXPAND_NODE)}}}}),[s,n,e,a,t]);return r.jsx(ze,{className:"next-modal py-2",items:o})},HH=e=>{const t=Aj(),n=We(e.id),s=Tl(e.id),a=Un(),o=tg(),i=Ui(),l=ie(),{enableAI:c}=xr(),d=pt();return a&&[wt.PAGE_HISTORY,wt.PAGE_LITE_PREVIEW].includes(a)||s?null:r.jsxs("div",{"data-ignore-double-click":!0,className:"aside-toolbar absolute p-1 left-10 bottom-7 shadow-light",style:{bottom:"30px"},children:[c&&Wk&&!d&&r.jsx(Fe,{appendTo:"parent",placement:"right",popup:"AI助手",children:r.jsx(da,{className:"w-10 h-10",onClick:u=>{const f=u.currentTarget.closest("[data-block-id]");i({popcorn:f!=null?f:_m(u),blockId:e.id,from:ho.mindMap,editorScene:it.PageHasContent,isMindMap:!0,showInput:!1,placement:f?"bottom-start":"top-end"})},children:r.jsx(V,{name:"IcAi",size:"middle"})})}),r.jsx(Fe,{appendTo:"parent",className:"w-10 h-10",placement:"right",popup:"展开节点",children:r.jsx(da,{className:"w-10 h-10",onClick:u=>{l.dropdown({placement:"right",modalId:Ve.EXPAND_NODE,popcorn:u.currentTarget,content:()=>r.jsx(I2e,{})})},children:r.jsx(V,{name:"IcMindmap",size:"middle"})})}),r.jsx(Fe,{animation:"shift-away",appendTo:"parent",delay:0,className:"w-10 h-10",theme:"next-modal",placement:"right",interactive:!0,maxWidth:1e3,popup:r.jsx(v2e,{}),children:r.jsx(da,{children:r.jsx("div",{className:"text-t5-medium text-center",children:"".concat(t,"%")})})}),r.jsx(Fe,{appendTo:"parent",placement:"right",popupClass:"w-32 text-center",popup:o?"切换到编辑模式":"切换到拖拽模式",children:r.jsx(da,{selected:o,className:"w-10 h-10",onClick:()=>{st({$pressedSpace:!o})},children:r.jsx(V,{name:"IcPreviewMove",size:"middle"})})}),r.jsx(Fe,{animation:"shift-away",appendTo:"parent",delay:0,className:"w-10 h-10",theme:"next-modal",placement:"right",interactive:!0,maxWidth:1e3,popup:r.jsx(T2e,{mindMapId:e.id}),children:r.jsx(da,{children:r.jsx(V,{name:"IcMindmapStyle",size:"middle"})})}),!n&&r.jsx(Fe,{appendTo:"parent",className:"w-10 h-10",placement:"right",popup:r.jsxs(r.Fragment,{children:["撤销",r.jsx(Pp,{className:"ml-1",shortcut:"Z"})]}),popupClass:"text-center",children:r.jsx(da,{onClick:()=>{re(jm()),me.event("cancel_redo")},children:r.jsx(V,{name:"IcUndo",size:"middle"})})}),!n&&r.jsx(Fe,{appendTo:"parent",className:"w-10 h-10",placement:"right",popupClass:"text-center",popup:r.jsxs(r.Fragment,{children:["重做",r.jsx(Pp,{className:"ml-1",shortcut:"shift+Z"})]}),children:r.jsx(da,{onClick:()=>{re(cg()),me.event("cancel_redo")},children:r.jsx(V,{name:"IcRedo",size:"middle"})})})]})},N2e=e=>{const[t,n]=y.useState(()=>{var s,a;if(e)return"current"in e?{left:(s=e==null?void 0:e.current)==null?void 0:s.scrollLeft,top:(a=e==null?void 0:e.current)==null?void 0:a.scrollTop}:{left:e==null?void 0:e.scrollLeft,top:e==null?void 0:e.scrollTop}});return y.useEffect(()=>{if(!e)return;let s;if("current"in e?s=e.current:s=e,!e)return;const a=()=>{n({left:s==null?void 0:s.scrollLeft,top:s==null?void 0:s.scrollTop})};return s==null||s.addEventListener("scroll",a),()=>{s==null||s.removeEventListener("scroll",a)}},[e]),t},zH=y.createContext(!1),wx=()=>y.useContext(zH),j2e=e=>r.jsx(zH.Provider,{value:!0,children:r.jsx(Su.Provider,{value:!0,children:e.children})}),S2e=(e,t)=>{const n=lx(e),s=$i(),a=wd(),o=D2e(e,t);return e===s&&n.backgroundColor&&!(o!=null&&o.backgroundColor)&&(n.color="".concat(a?"var(--white1)":"var(--black)")),wx()?{color:n.color||(o==null?void 0:o.color),backgroundColor:n.backgroundColor||(o==null?void 0:o.backgroundColor),left:"-9999px",top:"-9999px"}:{color:n.color||(o==null?void 0:o.color),backgroundColor:n.backgroundColor||(o==null?void 0:o.backgroundColor)}},mh=(e,t)=>{const n=JM(),s=y.useMemo(()=>t===0?30:t===1?20:16,[t]);return{paddingLeft:s,paddingRight:n?0:s}},qH=e=>{const t=$i();return Ce(s=>{var i,l,c,d;let a=e,o;for(;a;){const u=s.blocks[a];if(o=(c=(l=(i=u==null?void 0:u.data)==null?void 0:i.format)==null?void 0:l.mindMappingFormat)==null?void 0:c.nodeThemeColor,o||a===t)break;a=(d=u==null?void 0:u.parentId)!=null?d:""}return o},[e])},D2e=(e,t)=>{const n=qH(e);if(!n)return;const s=t===1?cs(n):dB(n);return{color:tr(n),backgroundColor:s}},GH=[m.BlockType.TABLE,m.BlockType.PAGE,m.BlockType.FOLDER,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION,m.BlockType.REFERENCE_COLLECTION_PAGE,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE],A2e=[m.BlockType.TEXTAREA,m.BlockType.HEADER,m.BlockType.QUOTE,m.BlockType.TODO,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.MARK,m.BlockType.FILE];m.BlockType.TEXTAREA,m.BlockType.HEADER,m.BlockType.QUOTE,m.BlockType.TODO,m.BlockType.MARK,m.BlockType.ORDER_LIST,m.BlockType.LIST;const hh=e=>{switch(e){case 0:return"中心节点";default:return"输入文字"}},R2e=(e,t,n=!1,s=!1)=>{let a="";switch(e){case 0:{a=" text-t0 rounded-lg focus-within:text-t0 text-black bg-black text-white1 border-2 border-solid py-4 border-black10";break}case 1:{a=" text-t0-1 rounded-md focus-within:text-t0-1 text-black bg-grey5 py-2 border-2 border-solid border-transparent ";break}default:a=" text-t1 rounded-md focus-within:text-t1 text-black bg-grey8 py-0.5 border-2 border-solid border-transparent"}return t?a+=" border-active_color":s&&(a+=" hover:border-active_color/30"),a+=" cursor-default focus-within:cursor-text",a},BF=()=>document.activeElement instanceof HTMLElement?document.activeElement.isContentEditable===!0:!1,WH=(e,t)=>{if(!e)return;const{editorKey:n}=e;return n?Xa(n):t(e.blockId)},P2e=(e="",t)=>Xr(e).mix(Xr("black"),t).hex(),L2e=e=>{const{blockId:t}=e,n=ye(t,["textColor","backgroundColor"]),s=tr(n==null?void 0:n.textColor),a=cs(n==null?void 0:n.backgroundColor),o=s||a;return r.jsx("div",{className:"rounded-full w-6 h-6 flex items-center justify-center",style:{color:s,backgroundColor:a,borderWidth:"1px",borderColor:o?o.startsWith("linear-gradient")?void 0:P2e(o,.1):void 0},children:r.jsx(V,{name:"IcText",size:"small"})})},B2e=e=>{const{uuid:t,model:n}=e,s=Nn(),a=c2({}),{queryResult:o}=n2(t),i=f2(),l=d2({}),{inCode:c,inEquation:d,disableEquation:u}=o,f=nd(()=>n.onFormatChange.pipe(EL(20),sd(()=>n.format)),n.format,[n]),h=p=>{const g=s(p);g==null||g.performChange(_=>{_.select(0,g.content.length)})};return r.jsxs("div",{className:"flex items-center next-modal","data-no-cancel-selected":!0,onPointerDown:p=>{p.stopPropagation()},children:[r.jsx(Os,{title:vo("加粗","B"),icon:"IcBold",highlight:f.bold,onClick:p=>{me.event("rtf_choose",{rtf_name:"bold"}),me.event("node_richtext"),p.stopPropagation(),J.ui.selectedBlocks.forEach(g=>{h(g.blockId),i(g.blockId,"bold")})}}),r.jsx(Os,{title:vo("斜体","I"),icon:"IcItalic",highlight:f.italic,onClick:p=>{me.event("rtf_choose",{rtf_name:"italic"}),me.event("node_richtext"),p.stopPropagation(),J.ui.selectedBlocks.forEach(g=>{h(g.blockId),i(g.blockId,"italic")})}}),r.jsx(Os,{title:vo("下划线","U"),icon:"IcUnderline",highlight:f.underline,onClick:p=>{me.event("rtf_choose",{rtf_name:"underline"}),me.event("node_richtext"),p.stopPropagation(),J.ui.selectedBlocks.forEach(g=>{h(g.blockId),i(g.blockId,"underline")})}}),r.jsx(Os,{title:vo("中划线","Shift+S"),icon:"IcDelete",highlight:f.lineThrough,onClick:p=>{me.event("rtf_choose",{rtf_name:"deleteline"}),me.event("node_richtext"),p.stopPropagation(),J.ui.selectedBlocks.forEach(g=>{h(g.blockId),i(g.blockId,"lineThrough")})}}),r.jsx(Os,{title:vo("代码","E"),icon:"IcCode",highlight:c,onClick:p=>{me.event("rtf_choose",{rtf_name:"code"}),me.event("node_richtext"),p.stopPropagation(),J.ui.selectedBlocks.forEach(g=>{h(g.blockId),l(g.blockId)})}}),r.jsx(Os,{title:vo("公式","Shift+X"),disabled:u,icon:"IcEquation",boxClassName:"border-r border-grey6",highlight:d,onClick:p=>{const{selection:g}=n;g!==null&&(me.event("node_richtext"),me.event("rtf_choose",{rtf_name:"equation"}),p.stopPropagation(),J.ui.selectedBlocks.forEach(_=>{h(_.blockId),a(_.blockId)}))}})]})},KH=e=>{var E,C,k,T,v,I,j;const{showBg:t}=e,n=Fr(),s=$i(),a=Oe(),o=v2(),i=GE(),l=ih(),c=Ce(S=>S.ui.selectedBlocks,[],{obsSelectBlocks:[{all:!0}]}),d=(C=(E=c[0])==null?void 0:E.blockId)!=null?C:"",u=(T=(k=c[c.length-1])==null?void 0:k.blockId)!=null?T:"",f=Ag(d),h=Sl(S=>S.rootId===d),p=c.length>1,g=Ce(S=>{const D=n.getState();for(const A of S.ui.selectedBlocks){const P=D.mindNodes[A.blockId];if(P&&P.childrenIds.length>0)return{expanded:P.expanded}}},[],{obsSelectBlocks:[{all:!0}]}),_=J.blocks[(I=(v=c[0])==null?void 0:v.blockId)!=null?I:""],x=_r((j=_==null?void 0:_.updatedBy)!=null?j:"");if(!f||!_)return null;const F=tn(_.type)||Yl(_)||Ib(_),b=[{type:H.OPERATION,isHidden:h||p,data:{title:"插入同级节点",onClick:()=>{a(()=>{var D,A;const S=l({parentId:(A=(D=J.blocks[d])==null?void 0:D.parentId)!=null?A:"",after:d},s);S&&re(at.updateSelectBlocks([{blockId:S,mindMapId:s}]))}),me.event("node_new",{from:2})},rightText:"Enter"}},{type:H.OPERATION,isHidden:!n.option.supportAppendChild(d)||p,data:{title:"插入子节点",onClick:()=>{a(()=>{const S=l({parentId:d,last:!0},s);S&&re(at.updateSelectBlocks([{blockId:S,mindMapId:s}]))}),o(d,!0),me.event("node_new",{from:2})},rightText:"Tab"}},{type:H.OPERATION,isHidden:h||p,data:{title:"插入父节点",onClick:()=>{a(()=>{var D,A;const S=l({parentId:(A=(D=J.blocks[d])==null?void 0:D.parentId)!=null?A:"",after:d},s);S&&(il([d],{parentId:S,last:!0}),re(at.updateSelectBlocks([{blockId:S,mindMapId:s}])),me.event("node_new",{from:2}))})},rightText:"Shift+Tab"}},{type:H.LINE,data:{},disableClick:!0},{type:H.OPERATION,isHidden:F||c.length>1,data:{title:"拷贝块访问链接",onClick:()=>{const S=ks(_.uuid);Xt("".concat(_n(),"/").concat(S,"#").concat(_.uuid))}}},{type:H.OPERATION,isHidden:!F||c.length>1,data:{title:"拷贝页面访问链接",onClick:()=>{var A;const D=Yl(_)?(A=Om(d))==null?void 0:A.uuid:d;me.event("copy_page_link"),Xt("".concat(_n(),"/").concat(D))}}},{type:H.OPERATION,isHidden:h,data:{title:"拷贝副本",onClick:()=>{i(c,u)},rightText:"".concat(Ds,"+D")}},{type:H.OPERATION,isHidden:h,data:{title:"复制",onClick:()=>{document.execCommand("copy")},rightText:"".concat(Ds,"+c")}},{type:H.OPERATION,isHidden:h,data:{title:"剪切",onClick:()=>{document.execCommand("cut")},rightText:"".concat(Ds,"+x")}},{type:H.OPERATION,data:{title:"删除",onClick:()=>{a(()=>{gr(lr(Nne(c)))})},rightText:"Del"}},{type:H.OPERATION,isHidden:p,data:{title:"定位到中心节点",onClick:()=>{n.fitCenter()}}},{type:H.LINE,isHidden:(f==null?void 0:f.childrenIds.length)===0,data:{},disableClick:!0},{type:H.OPERATION,isHidden:!g,data:{title:g!=null&&g.expanded?"折叠子节点":"展开子节点",onClick:()=>{const S=n.getState();c.forEach(D=>{const A=S.mindNodes[D.blockId];A&&A.childrenIds.length>0&&o(D.blockId,!(g!=null&&g.expanded))}),me.event("node_fold",{from:2})},rightText:"".concat(Ds,"+.")}},{type:H.LINE,data:{},disableClick:!0,isHidden:p||pt()}],w=b.find(S=>!S.isHidden);return(w==null?void 0:w.type)===H.LINE&&(w.isHidden=!0),r.jsx("div",{"data-no-cancel-selected":!0,children:r.jsx(ze,{className:t?Ra:L3,items:b,onItemClick:e.onItemClick,customFooter:!p&&!pt()&&r.jsx(Zm,{showWordCount:!1,name:x,updatedAt:_.updatedAt,isByAI:_.data.isByAI})})})},M6=e=>{const{accept:t,iconName:n,onSuccess:s,blockId:a}=e,o=ie(),i=Uo(),l=ln();return r.jsxs("label",{className:"flex items-center",children:[r.jsx(V,{name:n,size:"middle",className:e.disabled?"":"cursor-pointer"}),r.jsx("input",{disabled:e.disabled,type:"file",accept:t,className:"hidden",onChange:async c=>{const d=c.target.files;if(!d)return;const u=d[0];if(!u)return;const f=qe();i({key:a,inTransferList:!0,file:u,blockId:a,type:"file",spaceId:Ot(),onProgress(h){o.loading({modalId:f,title:"正在上传 ".concat(h,"%")})},onComplete(h){l(f),h.success&&s(u,h.ossName)}})}})]})},O2e=10,M2e=42,U2e=y.memo(e=>{var Q,ne,se,ce,ae,de,ke,Te,he,Ee;const t=Ce(ge=>ge.ui.selectedBlocks,[],{obsSelectBlocks:[{all:!0}]}),n=Oe(),s=t.length===1&&t.some(ge=>ge.blockId===e.id),a=Nn(),[o,i]=y.useState(void 0),{enableAI:l}=xr(),c=Un()===wt.MAIN,d=$i(),u=We(d),f=Ce(ge=>{var Se,Re;if(ge.ui.selectedBlocks.length===1){const Ae=(Re=(Se=ge.ui.selectedBlocks[0])==null?void 0:Se.blockId)!=null?Re:"",Me=ge.blocks[Ae];if(Me)return!A2e.includes(Me.type)}return!0},[],{hasSelectBlock:!0}),h=t.length===1,p=qE(),g=ff(),_=ye((Q=t[0])==null?void 0:Q.blockId,[]),x=qH((se=(ne=t[0])==null?void 0:ne.blockId)!=null?se:""),F=Nm(),b=w0(_),w=Xn(mn(_==null?void 0:_.uuid).role,m.PermissionRole.COMMENTER),E=pt(),C=!E&&b&&w&&c,k=E&&b&&w&&F,T=yr(),v=rg(),I=Ho(),j=C||k,S=N2e(T),[D,A]=y.useState(0),P=y.useMemo(()=>{var Re,Ae,Me;if(v||!h)return;const ge=(Re=T.current)==null?void 0:Re.querySelector('[data-block-id="'.concat(_==null?void 0:_.uuid,'"]')),Se=(Ae=T.current)==null?void 0:Ae.getBoundingClientRect();if(ge instanceof HTMLElement&&Se){const Ge=ge==null?void 0:ge.getBoundingClientRect();return{left:Ge.left-((Me=Se==null?void 0:Se.left)!=null?Me:0),top:Ge.top-M2e-O2e}}},[_==null?void 0:_.uuid,v,h,T,S,D]),L=y.useMemo(()=>t.length===0?!1:!t.some(ge=>ge.blockId===e.id),[e.id,t]),O=Ui();y.useEffect(()=>{h&&(_!=null&&_.uuid)&&setTimeout(()=>{A(ge=>++ge)},100)},[_==null?void 0:_.uuid,h]),y.useEffect(()=>{o!==void 0&&i(void 0)},[o]);const $=WH(t[0],a),[M,U]=y.useState(!1),z=y.useMemo(()=>t.every(ge=>{const{role:Se,isRestricted:Re}=mn(ge.blockId);return Re?Se===m.PermissionRole.EDITOR:Se===m.PermissionRole.EDITOR||Se===m.PermissionRole.WRITER}),[t]),K=ge=>t.every(Se=>{var Ae;const Re=J.blocks[Se.blockId];return!Re||ga((Ae=J.blocks[Re.parentId])==null?void 0:Ae.type)?!1:ge.includes(Re.type)});if(y.useEffect(()=>{const ge=$==null?void 0:$.onSelectionChange.subscribe(()=>{U(!!($.selection&&$.selection.length))});return()=>{U(!1),ge==null||ge.unsubscribe()}},[a,$,t]),M||v||I||t.length===0||h&&!P)return null;const W=!K(cI)||!z,Y=(_==null?void 0:_.type)===m.BlockType.CODE,G=Rg((ce=t[0])==null?void 0:ce.editorKey)||((ae=t[0])==null?void 0:ae.blockId)||"";if(u&&j)return h?r.jsx("div",{className:R("absolute bottom-7 h-9",{"w-full":!P}),"data-no-cancel-selected":!0,style:P,children:r.jsx("div",{className:"w-full h-full flex justify-center",children:r.jsxs("div",{className:"flex items-center h-full next-modal",children:[l&&Wk&&h&&r.jsx(Fe,{appendTo:"parent",placement:"right",popup:"AI助手",children:r.jsx(da,{className:"w-10 h-9",onClick:()=>{var Re;const ge=Ri("right")===e.id,Se=bn('[data-block-id="'.concat(_==null?void 0:_.uuid,'"]'),ge);Se&&O({popcorn:Se,blockId:(Re=_==null?void 0:_.uuid)!=null?Re:e.id,from:ho.mindMap,editorScene:it.BlockSelected,isMindMap:!0,showInput:!1})},children:r.jsx(V,{name:"IcAi",size:"middle"})})}),r.jsx(da,{className:"w-10 h-full",onClick:()=>{var ge,Se;g({blockId:(Se=(ge=t[0])==null?void 0:ge.blockId)!=null?Se:""})},children:r.jsx(V,{name:"IcMenuComment",size:"middle"})})]})})}):null;const te=t.some(ge=>{var Se,Re;return[m.BlockType.CODE,m.BlockType.EQUATION].includes((Re=(Se=J.blocks[ge.blockId])==null?void 0:Se.type)!=null?Re:0)});return r.jsx("div",{className:R("absolute bottom-7 h-9",{"w-full":!P}),"data-no-cancel-selected":!0,style:P,children:r.jsx("div",{className:"w-full h-full flex justify-center",children:r.jsxs("div",{className:"flex items-center h-full next-modal",children:[l&&Wk&&r.jsx(Fe,{appendTo:"parent",placement:"right",popup:"AI助手",children:r.jsx(da,{className:"w-10 h-9",onClick:()=>{var Se;const ge=document.querySelector('[data-block-id="'.concat(_==null?void 0:_.uuid,'"]'));ge&&O({popcorn:ge,blockId:(Se=_==null?void 0:_.uuid)!=null?Se:e.id,from:ho.mindMap,editorScene:it.BlockSelected,isMindMap:!0,showInput:!1})},children:r.jsx(V,{name:"IcAi",size:"middle"})})}),!s&&r.jsx(Fe,{lazyLoad:!0,delay:0,popupClass:"next-modal",disabled:W,className:"h-full",interactive:!0,maxWidth:1e3,theme:"none",animation:"shift-away",popup:r.jsx(r4,{showBg:!1,blockId:(ke=(de=t[0])==null?void 0:de.blockId)!=null?ke:""}),children:r.jsx(da,{className:"w-10",disabled:W,children:r.jsx(V,{name:"IcTurnInto",size:"middle"})})}),!s&&r.jsx(Fe,{lazyLoad:!0,delay:0,popupClass:"next-modal",disabled:!$||te,className:"h-full",interactive:!0,maxWidth:1e3,theme:"none",animation:"shift-away",popup:$&&r.jsx(B2e,{uuid:G,model:$}),children:r.jsx(da,{className:"w-10",disabled:!$||te,children:r.jsx(V,{name:"IcMenuTextstyle",size:"middle"})})}),r.jsx(Fe,{delay:0,lazyLoad:!0,disabled:Y,className:R("h-full",Y&&"pointer-events-none opacity-30"),popupClass:"next-modal",visible:o,interactive:!0,maxWidth:1e3,theme:"none",animation:"shift-away",popup:r.jsx(r.Fragment,{children:r.jsx("div",{onPointerDown:ge=>{ge.stopPropagation()},children:r.jsx(Kw,{showBg:!1,items:H0,onColorSelect:ge=>{i(!1),n(()=>{t.forEach(Se=>{_e(Se.blockId,{backgroundColor:ge.isBgColor?ge.colorkey:"",textColor:ge.isBgColor?"":ge.colorkey})})}),me.event("node_color")},footer:L?r.jsx("div",{className:"w-full p-4",children:r.jsx("div",{className:"cursor-pointer flex items-center rounded justify-center h-8 text-t2 border border-grey5 text-center w-full",onClick:()=>{i(!1),n(()=>{t.forEach(ge=>{var Re;const Se=J.blocks[ge.blockId];_e(ge.blockId,{backgroundColor:"",textColor:"",data:{format:{mindMappingFormat:{...(Re=Se==null?void 0:Se.data.format)==null?void 0:Re.mindMappingFormat,nodeThemeColor:""}}}})})})},children:"跟随分支主题"})}):null})})}),children:r.jsx(da,{className:"w-9",children:r.jsx(L2e,{blockId:(Te=_==null?void 0:_.uuid)!=null?Te:""})})}),r.jsx(Fe,{delay:0,lazyLoad:!0,animation:"shift-away",popupClass:"next-modal",visible:o,className:"h-full",interactive:!0,maxWidth:1e3,theme:"none",popup:r.jsx(r.Fragment,{children:r.jsx("div",{className:"w-[240px]",onPointerDown:ge=>{ge.stopPropagation(),ge.preventDefault()},children:r.jsx(Vm,{className:"pb-2",header:"分支颜色",colors:YH,value:x,selectedIcon:r.jsx(V,{name:"IcCheck02",size:"normal",className:"text-[18px] text-white"}),onSelect:ge=>{i(!1),me.event("node_theme"),n(()=>{t.forEach(Se=>{var Re,Ae;_e(Se.blockId,{data:{format:{mindMappingFormat:{...(Ae=(Re=J.blocks[Se.blockId])==null?void 0:Re.data.format)==null?void 0:Ae.mindMappingFormat,nodeThemeColor:ge}}}})})})},bgColorFn:rm})})}),children:r.jsx(da,{className:"w-9",children:r.jsx(V,{name:"IcMenuBranch",size:"middle",style:{color:h?rm(x):void 0}})})}),!s&&h&&r.jsx(Fe,{"data-no-cancel-selected":!0,popup:f?"":"上传图片（当前节点无法上传时，将创建同级节点上传）",className:"h-full",children:r.jsx(da,{className:"w-10",disabled:f,children:r.jsx(M6,{blockId:(he=t[0])==null?void 0:he.blockId,disabled:f,accept:"image/*,image/heic,image/heif",iconName:"IcMenuImage",onSuccess:async(ge,Se)=>{var Ge;const Re=await g1(ge),Ae=(Ge=t[0])==null?void 0:Ge.blockId;if(!Ae)return;const Me=J.blocks[Ae!=null?Ae:""];Me&&n(()=>{var tt,gt,kt;if(Me.type!==m.BlockType.FILE)nr([Ae],{type:m.BlockType.FILE,data:{display:"image",ossName:Se,caption:(tt=J.blocks[Ae])==null?void 0:tt.data.segments,...Re,size:ge.size,segments:ht(ge.name)}});else{if(p(d))return;ut({type:m.BlockType.FILE,data:{display:"image",ossName:Se,caption:[],...Re,size:ge.size,segments:ht(ge.name)}},{parentId:(kt=(gt=J.blocks[Ae])==null?void 0:gt.parentId)!=null?kt:"",after:Ae})}me.event("node_image")})}})})}),!s&&h&&r.jsx(Fe,{popup:f?"":"上传附件(当前节点无法上传时，将创建同级节点上传)",className:"h-full",children:r.jsx(da,{className:"w-10",disabled:f,children:r.jsx(M6,{blockId:(Ee=t[0])==null?void 0:Ee.blockId,disabled:f,iconName:"IcBlockFile",onSuccess:async(ge,Se)=>{var Ge;const Re=await g1(ge),Ae=(Ge=t[0])==null?void 0:Ge.blockId;if(!Ae)return;const Me=J.blocks[Ae!=null?Ae:""];Me&&n(()=>{var tt,gt,kt;if(Me.type!==m.BlockType.FILE&&Me.subNodes.length===0){nr([Ae],{type:m.BlockType.FILE,data:{display:"file",ossName:Se,caption:(tt=J.blocks[Ae])==null?void 0:tt.data.segments,...Re,size:ge.size,segments:ht(ge.name)}}),me.event("node_file");return}p(d)||(ut({type:m.BlockType.FILE,data:{display:"file",ossName:Se,caption:[],...Re,size:ge.size,segments:ht(ge.name)}},{parentId:(kt=(gt=J.blocks[Ae])==null?void 0:gt.parentId)!=null?kt:"",after:Ae}),me.event("node_file"))})}})})}),!s&&r.jsx("div",{className:"h-full w-px bg-grey6"}),!s&&r.jsx(Fe,{lazyLoad:!0,delay:0,popupClass:"next-modal",interactive:!0,maxWidth:1e3,theme:"none",className:"h-full",animation:"shift-away",popup:r.jsx(KH,{}),children:r.jsx(da,{className:"w-10 h-full",children:r.jsx(V,{name:"IcMore",size:"middle"})})}),h&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-full w-px bg-grey6"}),r.jsx(da,{className:"w-10 h-full",onClick:()=>{var ge,Se;g({blockId:(Se=(ge=t[0])==null?void 0:ge.blockId)!=null?Se:""})},children:r.jsx(V,{name:"IcComment",size:"middle"})})]})]})})})},yn),YH=vr.map(e=>({...e,name:""}));YH.unshift({key:"",name:""});const yy=60,V2e=e=>{const t=Fr(),n=Ho(),s=yr();return y.useEffect(()=>{n||t.clearDropInfo()},[t,n]),y.useEffect(()=>{const a=Ps(o=>{const i=s==null?void 0:s.current;if(!i||!!uI())return;const c=t.getState(),d=c.scale*.01,u=i.querySelectorAll("[data-block-id]");let f="";for(const h of u){const{blockId:p}=h.dataset;if(!p)continue;const g=c.mindNodes[p];if(g&&g.height&&(f=$2e(o,t,h,g,d),f))break}t.getState().rootId===f&&(f=void 0),c.hoverId!==f&&t.setHoverId(f)},32);return document.addEventListener("mousemove",a),()=>{document.removeEventListener("mousemove",a)}},[t,s,e.id]),null},$2e=(e,t,n,s,a)=>{const{blockId:o}=n.dataset,{direction:i}=t.getState(),l=H2e(i,n,s,a);if(l&&z2e(l,{x:e.clientX,y:e.clientY,width:1,height:1}))return o},H2e=(e,t,n,s)=>{const a=t.getBoundingClientRect(),o=()=>({x:a.left,y:a.top+(n.height/2-n.regionHeight/2)*s,width:(n.width+yy)*s,height:n.regionHeight*s}),i=()=>({x:a.left-yy*s,y:a.top+(n.height/2-n.regionHeight/2)*s,width:(n.width+yy)*s,height:n.regionHeight*s}),l=()=>({x:a.left,y:a.top,width:n.width*s,height:(n.height+yy/2)*s});if(e===m.MindMappingType.LOGIC_DIAGRAM_LEFT)return o();if(e===m.MindMappingType.LOGIC_DIAGRAM_RIGHT)return i();if(e===m.MindMappingType.MIND_MAPPING)return n.dir==="right"||n.dir===void 0?o():i();if(e===m.MindMappingType.ORGANIZATION_STRUCTURE)return l()},z2e=(e,t)=>e.x<=t.x+t.width&&t.x<=e.x+e.width&&e.y<=t.y+t.height&&t.y<=e.y+e.height,q2e=e=>{var g,_;const t=Ce(x=>x.ui.selectedBlocks,[],{obsSelectBlocks:[{all:!0}]}),n=(g=t[0])==null?void 0:g.blockId,s=Ag(n!=null?n:"",["left","top"]),a=y.useRef(null),o=G2e(e.container),i=t.length===1,l=Nn(),c=WH(t[0],l),d=Nr(),u=y.useRef(!1),f=y.useRef();if(y.useEffect(()=>(i&&!o.current&&(f.current=setTimeout(()=>{var x;(x=a.current)==null||x.focus()},100)),()=>{clearTimeout(f.current)}),[o,i,n]),!i||!s)return null;const h=()=>{var F;if(!a.current)return;const{value:x}=a.current;if((x||u.current)&&c&&!c.readonly){st({$editingBlockId:n}),(F=a.current)==null||F.blur(),a.current.value="",c.performChange(w=>{w.select(0,c.content.length).applyFormat({underline:!1}).replace(x).collapse("end")});const b=wp(J.blocks[n!=null?n:""]);d(n,x.length,b?"caption":"segments")}};let p=s==null?void 0:s.top;return p!==void 0&&(p+=15),r.jsx("textarea",{"data-editor":n,ref:a,onCompositionUpdate:()=>{c!=null&&c.readonly||setTimeout(()=>{var F;const x=(F=a.current)==null?void 0:F.value;x&&(c==null||c.performChange(b=>{b.select(0,c.content.length).applyFormat({underline:!0}).replace(x)}))},0)},onCompositionStart:()=>{u.current=!0},onCompositionEnd:()=>{h(),u.current=!1},onChange:()=>{u.current||h()},onKeyDown:x=>{u.current&&Ie(["Backspace","Delete"],{byKey:!0})(x)&&x.stopPropagation()},className:"absolute opacity-0 hidden-textarea",style:{left:(_=s==null?void 0:s.left)!=null?_:"-9999px",top:p!=null?p:"-9999px"}})},G2e=e=>{const t=y.useRef(!1);return y.useEffect(()=>{const n=e.current;if(!n)return;const s=()=>{setTimeout(()=>{t.current=!0},100)},a=()=>{t.current=!1};return n.addEventListener("focusin",s),n.addEventListener("focusout",a),()=>{n.removeEventListener("focusin",s),n.removeEventListener("focusout",a)}},[e]),t},W2e=new Map([[0,{colorKey:""}],[1,{colorKey:Ze.grey}],[2,{colorKey:Ze.grey,isBgColor:!0}],[3,{colorKey:Ze.brown}],[4,{colorKey:Ze.brown,isBgColor:!0}],[5,{colorKey:Ze.orange}],[6,{colorKey:Ze.orange,isBgColor:!0}],[7,{colorKey:Ze.yellow}],[8,{colorKey:Ze.yellow,isBgColor:!0}],[9,{colorKey:Ze.red}]]),K2e=Array.from(Array(10)).map((e,t)=>{const n=W2e.get(t);return{key:"mod+".concat(t),isBgColor:n==null?void 0:n.isBgColor,colorKey:n==null?void 0:n.colorKey}}),Y2e=()=>{const e=Oe(),t=!!y.useContext(jl);return y.useCallback(n=>{for(const s of K2e)Ie(s.key)(n)&&(n.preventDefault(),e(()=>{const a=GV(document.activeElement);if(t&&a){const o=a?Xa(a):void 0;if(o&&o.selection&&!o.selection.isCollapsed){o.performChange(i=>{i.applyFormat({color:s.isBgColor?"":s.colorKey,backgroundColor:s.isBgColor?s.colorKey:""})});return}}if(J.ui.selectedBlocks.length>0){J.ui.selectedBlocks.forEach(o=>{_e(o.blockId,{backgroundColor:s.isBgColor?s.colorKey:"",textColor:s.isBgColor?"":s.colorKey})});return}if(a){const o=Xa(a);o&&o.performChange(i=>{i.applyFormat({color:s.isBgColor?"":s.colorKey,backgroundColor:s.isBgColor?s.colorKey:""})})}}))},[t,e])},X2e=()=>{const e=Oe(),t=Nn();return y.useCallback(n=>{var s,a;if(Ie("mod+shift+h")(n)){const o=localStorage.getItem(t0);if(o&&o!=="undefined"){n.preventDefault();const i=JSON.parse(o),l=(a=(s=document.activeElement)==null?void 0:s.closest("[data-editor]"))==null?void 0:a.getAttribute("data-editor");if(l){const d=t(l);d&&d.performChange(u=>{i.isBgColor?u.applyFormat({color:void 0,backgroundColor:i.colorkey}):u.applyFormat({backgroundColor:void 0,color:i.colorkey})});return}const c=lr(J.ui.selectedBlocks);e(()=>{let d=!1;c.forEach((u,f)=>{var h,p;if(f===0&&(i.isBgColor?d=i.colorkey===((h=J.blocks[u])==null?void 0:h.backgroundColor):d=i.colorkey===((p=J.blocks[u])==null?void 0:p.textColor)),d){_e(u,{backgroundColor:void 0,textColor:void 0});return}_e(u,{backgroundColor:i.isBgColor?i.colorkey:void 0,textColor:i.isBgColor?void 0:i.colorkey})})}),re(at.updateSelectBlocks([]))}}},[e])},Q2e=()=>{const e=Nn(),t=f2(),n=c2(),s=d2();return y.useCallback((a,o)=>{if(J.ui.selectedBlocks.length===0)return;const i=BF();if(o&&i)return;let l=!1;switch(!0){case Ie("mod+b")(a):case Ie("mod+u")(a):case Ie("mod+i")(a):case Ie("mod+e")(a):case Ie("mod+shift+s")(a):case Ie("mod+shift+x")(a):a.preventDefault(),l=!0;break}if(!l)return;const c=f=>{const h=e(f);h==null||h.performChange(p=>{p.select(0,h.content.length)})},d={},u=f=>{if(d[f])return;const h=J.blocks[f];h&&(tn(h.type)||(d[f]=f,h.subNodes.forEach(u)))};switch(J.ui.selectedBlocks.forEach(f=>{o?d[f.blockId]=f.blockId:u(f.blockId)}),!0){case Ie("mod+b")(a):{Object.entries(d).forEach(([f,h])=>{c(f),t(f,"bold")});break}case Ie("mod+u")(a):{Object.entries(d).forEach(([f,h])=>{c(f),t(f,"underline")});break}case Ie("mod+i")(a):{Object.entries(d).forEach(([f,h])=>{c(f),t(f,"italic")});break}case Ie("mod+e")(a):{Object.entries(d).forEach(([f,h])=>{c(f),s(f)});break}case Ie("mod+shift+s")(a):{Object.entries(d).forEach(([f,h])=>{c(f),t(f,"lineThrough")});break}case Ie("mod+shift+x")(a):{Object.entries(d).forEach(([f,h])=>{c(f),n(f)});break}}return!0},[e,s,n,t])},J2e=["Enter","Tab","Shift+Tab","Space","mod+.","Shift+mod+.","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","mod+=","mod+-","mod+0","mod+z","mod+shift+z","mod+shift+h"],Z2e=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Space"],eCe=()=>{const e=$i(),t=Fr(),n=We(e),s=v2(),a=$H(),o=Oe(),i=ih(),l=Nr(),c=Un(),d=Q2e(),u=lt(),f=X2e(),h=y.useRef(""),p=Y2e(),g=y.useMemo(()=>qn(()=>{BF()||(h.current&&be.closeMessage(h.current),h.current=be.success(xt.$pressedSpace?"切换到编辑模式":"切换到拖拽模式"),st({$pressedSpace:!xt.$pressedSpace}))},100),[]);return y.useCallback(_=>{var w,E,C,k,T;if(c===wt.PAGE_HISTORY)return;const x=BF();if(u!==Ri()||(w=document.activeElement)!=null&&w.closest(".CodeMirror")||(E=document.activeElement)!=null&&E.closest(".latex-input-panel")||((C=document.activeElement)==null?void 0:C.closest("[data-is-comment]"))||tCe(_)||x&&Ie(Z2e)(_))return;if(Ie(J2e)(_)&&(_.stopPropagation(),_.preventDefault()),Ie("Shift+mod+.")(_)){a(),me.event("node_fold",{from:1});return}else if(Ie("mod+=")(_)){t.zoomin();return}else if(Ie("mod+-")(_)){t.zoomout();return}else if(Ie("mod+0")(_)){t.zoom(100);return}else if(Ie("Enter")(_)){if(x){document.activeElement.blur();return}}else Ie("Space")(_)&&J.ui.selectedBlocks.length===0&&g();if(n)return;switch(f(_),p(_),!0){case Ie("mod+z")(_):{re(jm());break}case Ie("mod+shift+z")(_):{re(cg());break}}const b=(T=(k=J.ui.selectedBlocks[0])==null?void 0:k.blockId)!=null?T:"";if(J.ui.selectedBlocks.length===1)switch(!0){case Ie("Enter")(_):{if(b===e)return;o(()=>{var I,j;const v=i({parentId:(j=(I=J.blocks[b])==null?void 0:I.parentId)!=null?j:"",after:b},e);v&&re(at.updateSelectBlocks([{blockId:v,mindMapId:e}]))}),me.event("node_new",{from:1});break}case Ie("Tab")(_):{if(!t.option.supportAppendChild(b))return;o(()=>{const I=i({parentId:b,last:!0},e);document.activeElement instanceof HTMLElement&&document.activeElement.blur(),I&&(re(at.updateSelectBlocks([{blockId:I,mindMapId:e}])),s(b,!0))}),me.event("node_new",{from:1});break}case Ie("Shift+Tab")(_):{if(b===e)return;document.activeElement instanceof HTMLElement&&document.activeElement.blur(),o(()=>{var I,j;const v=i({parentId:(j=(I=J.blocks[b])==null?void 0:I.parentId)!=null?j:"",after:b},e);v&&(il([b],{parentId:v,last:!0}),re(at.updateSelectBlocks([{blockId:v,mindMapId:e}])))}),me.event("node_new",{from:1});break}case Ie("Space")(_):{const v=wp(J.blocks[b]);l(b,-1,v?"caption":"segments");break}case Ie("mod+.")(_):{if(e===b)return;s(b),me.event("node_fold",{from:1});break}}switch(d(_,!0)&&(_.stopPropagation(),_.preventDefault()),!0){case Ie("ArrowLeft")(_):{if(J.ui.selectedBlocks.length===0)return;const v=t.getNextNodeIdByArrowKeyboard("left",b);v&&re(at.updateSelectBlocks([{blockId:v,mindMapId:e}]));break}case Ie("ArrowUp")(_):{if(J.ui.selectedBlocks.length===0)return;const v=t.getNextNodeIdByArrowKeyboard("up",b);v&&re(at.updateSelectBlocks([{blockId:v,mindMapId:e}]));break}case Ie("ArrowRight")(_):{if(J.ui.selectedBlocks.length===0)return;const v=t.getNextNodeIdByArrowKeyboard("right",b);v&&re(at.updateSelectBlocks([{blockId:v,mindMapId:e}]));break}case Ie("ArrowDown")(_):{if(J.ui.selectedBlocks.length===0)return;const v=t.getNextNodeIdByArrowKeyboard("down",b);v&&re(at.updateSelectBlocks([{blockId:v,mindMapId:e}]));break}}},[i,p,t,l,f,e,u,c,n,d,g,a,s,o])},tCe=e=>{var s,a,o,i,l,c,d,u;const t=BF(),n=(a=(s=J.ui.selectedBlocks[0])==null?void 0:s.blockId)!=null?a:"";return!!(Ie("Enter")(e)&&t&&((o=J.blocks[n])==null?void 0:o.type)===m.BlockType.CODE||Ie(["Tab","Tab+shift"])(e)&&t&&(((i=J.blocks[n])==null?void 0:i.type)===m.BlockType.CODE||((l=J.blocks[n])==null?void 0:l.type)===m.BlockType.TABLE)||Ie("Enter")(e)&&!((c=document.activeElement)!=null&&c.closest(".hidden-textarea"))&&(((d=document.activeElement)==null?void 0:d.tagName)==="INPUT"||((u=document.activeElement)==null?void 0:u.tagName)==="TEXTAREA"))},XH=y.forwardRef((e,t)=>{const n=y.useRef(null),s=y.useRef(null),a=Aj(),o=lt(),i=yr(),{offsetX:l,offsetY:c}=r0e(),d=s0e(),u=eCe();y.useImperativeHandle(t,()=>n.current,[]);const f=a*1/100,h=Sj(),p=Fr(),g=y.useContext(jI),_=Pa(),x=tg();y.useEffect(()=>{p.setLineColor(_?"#b8b8b8":"#000000")},[p,_]),y.useEffect(()=>{if(!(d!=null&&d.id))return;const b=i.current;if(!b)return;const w=qn(()=>{b.scrollTop!==0&&$le(d.id,g,{left:b.scrollLeft,top:b.scrollTop})},500);return b.addEventListener("scroll",w),()=>{b.removeEventListener("scroll",w)}},[g,i,d==null?void 0:d.id]),y.useEffect(()=>{var b,w;if(h&&(d!=null&&d.id)){const E=(b=Vle(d==null?void 0:d.id,g))!=null?b:void 0;E&&((w=i.current)==null||w.scroll(E)),setTimeout(()=>{var C;E&&((C=i.current)==null||C.scroll(E))},500),E||(p.fitCenter(),setTimeout(()=>{p.fitCenter()},200))}},[p,h,g,d==null?void 0:d.id,i]),y.useEffect(()=>{if(!i.current)return;const b=i.current;b.style.cursor=x?"grab":""},[i,x]),y.useEffect(()=>{const b=o===e.id;if(!n.current)return;const w=b?document:n.current,E=C=>{C instanceof KeyboardEvent&&u(C)};return w.addEventListener("keydown",E),()=>{w.removeEventListener("keydown",E)}},[u,o,e.id]);let F;return d!=null&&d.regionWidth&&(F=(d==null?void 0:d.regionWidth)+100),r.jsx("article",{tabIndex:-1,ref:n,className:"w-full block-content ",children:r.jsx("div",{ref:s,className:"flex relative node-drawer w-full",style:{transformOrigin:"center",transform:"scale(".concat(f,",").concat(f,")"),left:l,top:c,width:F,height:(d==null?void 0:d.regionHeight)||void 0,opacity:h?void 0:0},children:e.children})})}),QH=()=>{const e=Fr();return Ho()?r.jsx("canvas",{className:"absolute left-[-150px] top-[-150px] touch-none",ref:n=>{n&&e.setDragCanvas(n)}}):null},nCe=()=>{const e=ie();return y.useCallback(t=>{const n=t.target.closest("[data-block-id]");if(n instanceof HTMLDivElement&&!pt()&&n.dataset.blockId&&J.ui.selectedBlocks.length===0){const{blockId:s}=n.dataset;s&&re(at.updateSelectBlocks([{blockId:s,mindMapId:n.dataset.mindMapId}]))}if(t.currentTarget instanceof HTMLElement){const s=t.currentTarget.getBoundingClientRect();e.dropdown({placement:"bottom-start",popcorn:{getBoundingClientRect:()=>({...s,left:t.clientX,top:t.clientY,bottom:t.clientY+1,right:t.clientX+1,width:1,height:1})},content:({onCloseModal:a})=>J.ui.selectedBlocks.length>0&&!pt()?r.jsx(KH,{showBg:!0,onItemClick:()=>{a()}}):r.jsx(sCe,{id:"",onItemClick:()=>{a()}})})}},[e])},sCe=e=>{const t=$H(),n=Fr(),s=[{type:H.OPERATION,data:{title:"画布放大",onClick:()=>{n.zoomin(),me.event("zoomin",{from:2})},rightText:"".concat(Ds,"++")}},{type:H.OPERATION,data:{title:"画布缩小",onClick:()=>{n.zoomout(),me.event("zoomout",{from:2})},rightText:"".concat(Ds,"+-")}},{type:H.OPERATION,data:{title:"重置缩放",onClick:()=>{n.zoom(100)},rightText:"".concat(Ds,"+O")}},{type:H.OPERATION,data:{title:"定位到中心节点",onClick:()=>{n.fitCenter()}}},{type:H.LINE,data:{},disableClick:!0},{type:H.OPERATION,data:{title:"展开/折叠所有节点",onClick:()=>{t(),me.event("node_fold",{from:2})},rightText:"".concat(Ds,"+Shift+.")}}];return r.jsx(ze,{className:"next-modal w-[260px] rounded py-2",items:s,onItemClick:()=>{e.onItemClick()}})},rCe=e=>{const t=nCe(),n=y.useRef(),s=tg(),a=Un();qg(e,{onResize:o=>{const i=e.current;if(i)switch(o.resizeStatus){case aa.START:n.current=!0,i.style.cursor="grab";break;case aa.RESIZING:n.current=!1,i.scrollBy(-o.deltaX,-o.deltaY);break;case aa.END:{s||(i.style.cursor="");break}}},buttonType:s?yv.leftClick:yv.rightCLick,dispatchEvent:!0}),y.useEffect(()=>{const o=e.current;if(!o)return;const i=c=>{c.preventDefault()},l=c=>{c.button===2&&n.current&&a!==wt.PAGE_HISTORY&&(c.preventDefault(),t(c))};return o.addEventListener("contextmenu",i,!0),o.addEventListener("mouseup",l,!0),()=>{o.removeEventListener("mouseup",l,!0),o.removeEventListener("contextmenu",i,!0)}},[e,t,a])},aCe=(e,t)=>{const n=Fr(),s=$i(),a=Un();y.useEffect(()=>{if(!e.current||!t.current||!s)return;const o=e.current,i=t.current.querySelector(".node-drawer");if(!i)return;const{zoomin:l,zoomout:c}=n,d=p=>{if(p.ctrlKey||p.shiftKey)return p.preventDefault(),!1},f=Ps(p=>{if(p.target instanceof Element){const g=p.target.closest(".mind-page");if(!g)return;if(g instanceof HTMLElement){if(g.dataset.mindPageId===s)if(p.ctrlKey){const _=n.getState().scale*.01;p.deltaY<0&&l(3),p.deltaY>0&&c(3);const x=n.getState().scale*.01;if(x!==_){const F=i.getBoundingClientRect(),b=p.clientX-(p.clientX-F.left)/_*x,w=p.clientY-(p.clientY-F.top)/_*x,E=F.left-b,C=F.top-w;requestAnimationFrame(()=>{o.scrollBy(E,C)})}}else if(p.shiftKey)requestAnimationFrame(()=>{o.scrollBy(p.deltaY,0)});else{const _=p.target.closest(".CodeMirror-scroll"),x=p.target.closest(".katex-display");if(_||x)return;requestAnimationFrame(()=>{o.scrollBy(p.deltaX,p.deltaY)})}return!0}}return!1},16),h=a===wt.PAGE_HISTORY?dr:wB;return Ht.addEventListener("wheel",f,h),o.addEventListener("wheel",d,{capture:!0,passive:!1}),()=>{Ht.removeEventListener("wheel",f),o.removeEventListener("wheel",d,{capture:!0})}},[t,n,s,a,e])},oCe=e=>{var i;const t=yr(),n=Fr(),s=$i(),a=y.useRef(),o=y.useRef((i=t.current)==null?void 0:i.style.cursor);qg(e,{onResize:l=>{var d,u,f;const c=t.current;if(c)switch(l.resizeStatus){case aa.START:{o.current=(d=t.current)==null?void 0:d.style.cursor,a.current=!0,c.style.cursor="grabbing",(u=e.current)==null||u.focus({preventScroll:!0});break}case aa.RESIZING:{a.current=!1,c.scrollBy(-l.deltaX,-l.deltaY);break}case aa.END:{c.style.cursor=(f=o.current)!=null?f:"";break}}}}),y.useEffect(()=>{if(!t.current||!s)return;const l=t.current,{zoomin:c,zoomout:d}=n,u=p=>{if(p.ctrlKey||p.shiftKey)return p.preventDefault(),!1},h=Ps(p=>{if(p.target instanceof HTMLElement){const g=p.target.closest(".embed-mind-page");if(!g)return;g instanceof HTMLElement&&g.dataset.mindPageId===s&&(p.ctrlKey?(p.deltaY<0&&c(8),p.deltaY>0&&d(8)):p.shiftKey&&requestAnimationFrame(()=>{l.scrollBy(p.deltaY,0)}))}return!1},16);return document.addEventListener("wheel",h,!0),l.addEventListener("wheel",u,{capture:!0,passive:!1}),()=>{document.removeEventListener("wheel",h,!0),l.removeEventListener("wheel",u,{capture:!0})}},[e,n,s,t])},JH=()=>{const e=Fr();return r.jsx("canvas",{className:"absolute left-[-150px] top-[-150px] touch-none",ref:t=>{t&&e.setCanvas(t)}})},iCe=e=>r.jsxs("div",{className:"flex flex-col w-[370px] next-modal px-2.5 py-3.5",children:[r.jsx(Ct,{autoFocus:!0,className:"h-8 rounded-sm",placeholder:e.placeholder,onChange:e.onChange,onEnter:e.onButtonClick}),r.jsx(De,{size:"large",colorType:"active",className:"mt-3.5 text-t4-medium",onClick:e.onButtonClick,children:"提交"})]}),lCe=e=>{const t=ie(),n=Js(),s=y.useRef("");return r.jsx(vc,{readonly:e.readonly,defaultOpenPanel:e.defaultOpenPanel,onClick:a=>{t.dropdown({popcorn:a.currentTarget,placement:"bottom",content:({onCloseModal:o})=>r.jsx(iCe,{onButtonClick:()=>{var i;s.current.trim()&&((i=e.onButtonClick)==null||i.call(e,s.current.trim()),n(Je.CREATE_WEB_BOOKMARK,ct.advancedList),o())},placeholder:"https://www.example.com",onChange:i=>{s.current=i}})})},iconProp:{name:"IcUploadBookmark",size:"normal"},text:"添加网址书签",className:e.readonly?"cursor-default":"cursor-pointer"})},ZH=e=>{if(!e.url)return r.jsx(lCe,{readonly:e.readonly,defaultOpenPanel:e.defaultOpenInputPanel,onButtonClick:e.onUrlInput});const t=!!e.title;return r.jsx("a",{className:"flex flex-row justify-between animate-hover border rounded pl-4 h-[89px] overflow-hidden",href:e.url,target:"_blank",rel:"noreferrer",children:e.loading?r.jsx(xs,{}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:R("flex flex-col py-[15px] justify-center w-full"),children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("div",{className:"text-ellipsis ".concat(t?"text-t2":"text-t2-bold"),children:e.title||qB(e.url)}),e.description&&r.jsx("div",{className:"mt-2 overflow-hidden text-t4 text-grey3 overflow-ellipsis",style:{display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical"},children:e.description})]}),r.jsxs("div",{className:"flex flex-row items-center mt-2",children:[e.icon&&r.jsx("img",{referrerPolicy:"no-referrer",loading:"lazy",className:"w-4 h-4 mr-[6px]",src:e.icon}),r.jsx("span",{className:"text-t4 text-ellipsis",children:e.url})]})]}),e.cover&&r.jsx(KI,{loader:r.jsx($s,{size:"middle"}),src:e.cover,className:"shrink-0 w-[calc(33.333%)] h-full self-center rounded-r-[3px] object-cover"})]})})},cCe=(e,t,n)=>{const s=Ho(),a=Ce(l=>l.ui.selectedBlocks.findIndex(c=>c.blockId===e)!==-1&&!s,[e],{obsSelectBlocks:[{blockId:e}]}),o=Sl(l=>{var c;return((c=l.dropInfo)==null?void 0:c.parentId)===e});return y.useMemo(()=>R2e(t,a||o,!1,n),[n,a,t,o])},dCe=(e,t)=>{const n=wx(),s=Sl(a=>{if(a.loading||n)return;const o=a.fixWidthRecord[t];if(o&&o.id!==e)return o.fixWidth});if(!n)return s||void 0},uCe=()=>{const e=Fr();return y.useCallback((t,n,s,a,o)=>{var i;e.updateMindNode({id:t.uuid,parentId:e.getState().rootId===t.uuid?"":t.parentId,childrenIds:!a&&GH.includes(t.type)?[]:t.subNodes.filter(l=>{var c;return((c=J.blocks[l])==null?void 0:c.type)!==m.BlockType.PDF_ANNOTATION}),expanded:(i=xt.$expandFoldRecord[t.uuid])!=null?i:!0,width:n,height:s,themeColor:o})},[e])},fCe=()=>{const e=lt();return ft(e,n=>(n==null?void 0:n.type)===m.BlockType.PAGE)},mCe=5,vv=new Map;for(let e=0;e<8;e++)vv.set(e,e*mCe);const ZC=20,U6=4,hCe=e=>{const t=Sd(e.id),n=fCe(),s=Fr(),a=Ag(e.id,["childrenIds","expanded","dir"]),o=Ho(),i=wx(),l=Ce(C=>{const k=s.option.supportAppendChild(e.id);return C.ui.selectedBlocks.length===1&&!o&&k},[],{hasSelectBlock:!0}),c=$i(),{mindMapStyle:d}=Fx(c),u=Sl(C=>C.hoverId===e.id),f=v2(),h=Oe(),p=ih(),g=wj(e.id,c),{width:_,height:x}=e;if(!a||i||!_||!x)return null;const F=!t&&u&&(a==null?void 0:a.childrenIds.length)!==0;let b,w=!1;if(t&&l&&!e.readonly)b=r.jsx(V,{name:"IcAddMindmap",className:"rounded-full cursor-pointer bg-white1",size:"middle",onClick:()=>{a.expanded||f(e.id),h(()=>{const C=p({parentId:e.id,last:!0},c);C&&re(at.updateSelectBlocks([{blockId:C,mindMapId:c}]))})}});else if(!a.expanded&&a.childrenIds.length>0)w=!0,b=r.jsx("div",{className:R("text-center px-1.5 text-t2-medium text-black rounded-[10px] border-[1.6px] border-black",{"cursor-pointer":!n}),onClick:()=>{n||(f(e.id),me.event("node_fold",{from:3}))},children:g});else if(F){let C="0deg";d===m.MindMappingType.LOGIC_DIAGRAM_RIGHT?C="180deg":d===m.MindMappingType.MIND_MAPPING?a.dir==="right"||a.dir===void 0?C="0deg":C="180deg":d===m.MindMappingType.ORGANIZATION_STRUCTURE&&(C="90deg"),b=r.jsx(V,{name:"IcNodeFold",className:R("rounded-full bg-white1"),size:"middle",style:{transform:"rotate(".concat(C,")")},onClick:()=>{f(e.id),me.event("node_fold",{from:3})}})}if(!b||n&&!w)return null;const E=pCe(d);return E?r.jsx(E,{id:e.id,width:e.width,height:e.height,showCount:w,count:g,children:b}):null},pCe=e=>{switch(e){case m.MindMappingType.LOGIC_DIAGRAM_LEFT:return Iv;case m.MindMappingType.LOGIC_DIAGRAM_RIGHT:return ez;case m.MindMappingType.MIND_MAPPING:return gCe;case m.MindMappingType.ORGANIZATION_STRUCTURE:return _Ce;default:return null}},Iv=e=>{const{containerStyle:t}=P4(e);return r.jsxs("div",{"data-no-cancel-selected":!0,className:"absolute",style:t,children:[r.jsx("div",{className:"bg-black h-[3px] w-[4px]"}),e.children]})},ez=e=>{const{containerStyle:t}=P4(e);return r.jsxs("div",{"data-no-cancel-selected":!0,className:"absolute",style:t,children:[e.children,r.jsx("div",{className:"bg-black h-[3px] w-[4px]"})]})},gCe=e=>{const t=Ag(e.id,["dir"]);return(t==null?void 0:t.dir)===void 0?r.jsx(Iv,{...e}):t.dir==="right"||t.dir===void 0?r.jsx(Iv,{...e}):r.jsx(ez,{...e})},_Ce=e=>{const{containerStyle:t}=P4(e);return r.jsxs("div",{"data-no-cancel-selected":!0,className:"absolute",style:t,children:[r.jsx("div",{className:"bg-black h-[4px] w-[3px]"}),e.children]})},P4=e=>{var c,d,u,f;const{id:t,width:n,height:s}=e,a=$i(),o=Ag(t,["left","top","dir","width","height"]),{mindMapStyle:i}=Fx(a),l={};if(!o)return{containerStyle:l};if(!n||!s)return{containerStyle:l};switch(i){case m.MindMappingType.LOGIC_DIAGRAM_LEFT:{l.display="flex",l.alignItems="center",l.left=o.left+n,l.top=o.top,l.height=s;break}case m.MindMappingType.LOGIC_DIAGRAM_RIGHT:{const h=V6((c=e.count)!=null?c:0),p=e.showCount&&(d=vv.get(h))!=null?d:0;l.display="flex",l.alignItems="center",l.left=o.left-ZC-U6-p,l.top=o.top,l.height=s;break}case m.MindMappingType.MIND_MAPPING:{const h=V6((u=e.count)!=null?u:0),p=e.showCount&&(f=vv.get(h))!=null?f:0;l.display="flex",l.alignItems="center",l.top=o.top,l.height=s,o.dir==="right"||o.dir===void 0?l.left=o.left+n:l.left=o.left-ZC-U6-p;break}case m.MindMappingType.ORGANIZATION_STRUCTURE:{l.display="flex",l.alignItems="center",l.flexDirection="column",l.left=o.left+o.width*.5-ZC/2,l.top=o.top+o.height,l.height=s;break}}return{containerStyle:l}};function V6(e){return Math.floor(Math.log10(Math.abs(e)))+1}const $6=4,xCe=y.forwardRef((e,t)=>{var Y,G;const{id:n,level:s,className:a,style:o,children:i,onDoubleClick:l,...c}=e,d=y.useRef(null),{width:u,height:f}=IL(d)||{},h=Ag(n,["id","left","top","themeColor"]),p=Fr(),g=$i(),_=e0e(),x=uCe(),F=We(n),b=S2e(n,e.level),w=tg(),E=y.useContext(Fm),C=n0e(),k=Sd(n),T=ye(n,["subNodes"]),v=ft(n,ee=>{var te,Q;return(Q=(te=ee==null?void 0:ee.data.format)==null?void 0:te.mindMappingFormat)==null?void 0:Q.nodeThemeColor}),I=Un()===wt.MAIN,j=dCe(n,s),S=w0(T),D=Xn(mn(T==null?void 0:T.uuid).role,m.PermissionRole.COMMENTER),A=pt(),P=Nm(),$=!A&&S&&D&&I||A&&S&&D&&P,M=cCe(n,s,$),U=wx();y.useImperativeHandle(t,()=>d.current,[]),y.useEffect(()=>{var ee;U||_(n,g===n?"":(ee=J.blocks[n])==null?void 0:ee.parentId)},[_,g,n,U]);const z=u?u+$6:void 0,K=f?f+$6:void 0,W=s===0;return y.useEffect(()=>{U||T&&(!z||!K||x(T,z,K,W,v))},[x,T,z,K,U,W,v]),y.useEffect(()=>{if(!U)return;const ee=z;ee&&p.updateMindNode({id:n,reallyWidth:ee})},[p,z,n,U]),Gp(()=>{var ee;(T==null?void 0:T.type)===((ee=J.blocks[n])==null?void 0:ee.type)&&(U||C(n))}),r.jsxs(r.Fragment,{children:[r.jsx("div",{"data-draggable":!F&&s!==0&&!w,"data-block-id":E?U?void 0:n:void 0,ref:d,"data-no-cancel-selected":!0,"data-mind-map-id":g,className:R("node-wrapper absolute max-w-[520px]",M,a),style:{left:(Y=h==null?void 0:h.left)!=null?Y:"-9999px",top:(G=h==null?void 0:h.top)!=null?G:"-9999px",...o,...b,width:j},onDoubleClick:ee=>{F||(w&&be.warning({content:"当前处于拖拽模式，无法进行编辑，可在左下角工具栏处切换回编辑模式",duration:3e3}),l==null||l(ee))},onMouseDownCapture:ee=>{F&&!$||(!k||J.ui.selectedBlocks.length>1)&&ee.preventDefault()},onClickCapture:ee=>{if(!(F&&!$)&&!(ee.target instanceof Element&&(!ee.metaKey&&ee.target.closest(".disable-select")||!ee.target.closest(".node-wrapper")))){if(w){ee.preventDefault(),ee.stopPropagation();return}if(!k||J.ui.selectedBlocks.length>1){if(ee.preventDefault(),ee.stopPropagation(),document.activeElement instanceof HTMLElement&&document.activeElement.blur(),ee.metaKey){const te=J.ui.selectedBlocks.find(Q=>Q.blockId===n);re(te?at.removeSelectBlock(te):at.addSelectBlock({blockId:n,mindMapId:g}));return}re(at.updateSelectBlocks([{blockId:n,mindMapId:g}]))}}},...c,children:r.jsxs("div",{className:"relative flex items-center w-full overflow-auto",children:[i,r.jsx(nh,{className:"disable-select ml-1 mr-2",blockId:n})]})}),r.jsx(hCe,{width:z,height:K,id:n,readonly:F})]})}),ia=fn.memo(xCe),Wg=(e,t,n)=>{const s=y.useRef(!1),a=y.useRef(),o=v0e();y.useEffect(()=>{const i=e.current;if(!i)return;const l=()=>{a.current&&(clearTimeout(a.current),a.current=void 0)},c=()=>{l(),a.current=setTimeout(()=>{s.current=!0},500)},d=()=>{l(),s.current=!1},u=f=>{s.current||(document.activeElement instanceof HTMLElement&&document.activeElement.blur(),o(t,f,n))};return i.addEventListener("dblclick",u),i.addEventListener("focusin",c),i.addEventListener("focusout",d),()=>{i.removeEventListener("focusin",c),i.removeEventListener("focusout",d),i.removeEventListener("dblclick",u)}},[t,e,o,n])},ui=e=>{const t=We(e.uuid),n=wx(),{uuid:s,...a}=e,o=n?"fixWidth".concat(s):s;return r.jsx(ci,{uuid:o,comments:!0,keydownOption:Uu,readonly:t,onKeyDown:i=>{Ie("Enter")(i)&&i.preventDefault()},...a})},yCe=fn.memo(e=>{var c;const{alwaysShowPlaceHolder:t,placeHolder:n}=sg(e.id),s=La(e.id,"caption"),a=ye(e.id,["data","local"]),o=Oe(),i=We(e.id),l=y.useRef(null);return Wg(l,e.id,"caption"),y.useEffect(()=>{a!=null&&a.data.link&&Vu(a.data.link).then(d=>{if(!d)return;const u={link:d.link,linkInfo:ht(d.title),cover:d.cover,icon:{type:"http",value:d.icon},description:ht(d.description)};i?_e(a.uuid,{data:u},!0):o(()=>{_e(a.uuid,{data:u})})})},[a==null?void 0:a.data,a==null?void 0:a.uuid,i,o]),a?r.jsx(ia,{id:e.id,level:e.level,ref:l,className:"min-w-[480px] px-0",children:r.jsxs("div",{className:"w-full",children:[r.jsx(ui,{placeholder:n,uuid:e.id,alwaysShowPlaceholder:t,className:"whitespace-pre-wrap break-words mx-2",segments:a.data.caption,segmentType:"caption",onChange:(d,u,f)=>{s(d,[u,f])}}),r.jsx(ZH,{readonly:i,title:fe(a.data.linkInfo),cover:a.data.cover,description:fe(a.data.description),icon:(c=a.data.icon)==null?void 0:c.value,url:a.data.link,onUrlInput:d=>{Vu(d).then(u=>{o(()=>{var f;_e(a.uuid,{data:{link:(f=u==null?void 0:u.link)!=null?f:d,linkInfo:ht(u==null?void 0:u.title),cover:u==null?void 0:u.cover,icon:{type:"http",value:u==null?void 0:u.icon},description:ht(u==null?void 0:u.description),headers:u==null?void 0:u.headerMap}})})})},defaultOpenInputPanel:!!a.local,loading:!1})]})}):null}),L4=e=>r.jsxs("div",{className:"flex flex-1",children:[r.jsx("div",{className:R("mr-1 flex items-start justify-center mt-[1.5px]",e.symbolClassName),children:e.symbol}),e.editorNode]}),bCe=(e,t)=>{const n=y.useRef(t);n.current=t,y.useEffect(()=>{const s=e.current;if(!s)return;const a=()=>{n.current(!0)},o=()=>{n.current(!1)};return s.addEventListener("focusin",a),s.addEventListener("focusout",o),()=>{s.removeEventListener("focusin",a),s.removeEventListener("focusout",o)}},[e])},Kg=(e,t,n,s)=>{const[a,o]=y.useState(void 0),i=dee(e),l=Sl(c=>i?c.scale:1);return bCe(t,c=>{c&&i||st({$editingBlockId:c?e:void 0})}),y.useEffect(()=>{var u;if(!i){o(void 0);return}const c=l*.01,d=(u=t.current)==null?void 0:u.getBoundingClientRect().width;d&&o(d/c)},[t,i,l]),a||(n?s>1?"100px":"112px":void 0)},ek={disc:"•",circle:"◦",square:"▪"},FCe=fn.memo(e=>{const t=Ce(({blocks:u})=>wCe(e.id,u),[e.id]),n=ye(e.id,["data"],["segments"]),s=hh(e.level),a=La(e.id),o=y.useMemo(()=>!fe(n==null?void 0:n.data.segments),[n==null?void 0:n.data.segments]),i=y.useRef(null),l=Kg(e.id,i,o,e.level),{paddingLeft:c,paddingRight:d}=mh(e.id,e.level);return n?r.jsx(ia,{id:e.id,ref:i,className:"flex items-center",level:e.level,style:{paddingLeft:"".concat(c,"px"),minWidth:l},children:r.jsx(L4,{symbol:r.jsx("div",{className:"pseudoBefore mr-1.5",style:{"--pseudoBefore--content":'"'.concat(t,'"')}}),editorNode:r.jsx(ui,{placeholder:s,uuid:e.id,className:"whitespace-pre-wrap break-words self-start",segments:n.data.segments,onChange:(u,f,h)=>{a(u,[f,h])},style:{paddingRight:"".concat(d,"px")}})})}):null});function wCe(e,t){var a;const n=E0(e,t,m.BlockType.LIST),s=(n==null?void 0:n.format)||(n==null?void 0:n.defaultFormat);return s&&(a=ek[s])!=null?a:ek.disc}const tz=e=>r.jsxs("div",{className:R("flex items-start py-3 px-1.5",e.className),style:e.style,children:[r.jsx(Fn,{blockId:e.id,className:R("mt-1",e.iconClassName),hideRemoveBtn:!0,trigger:!e.readonly,iconSize:22,defaultEmoji:"💡",onSelectEmoji:t=>{e.onChange&&e.onChange(t)}}),r.jsx("div",{className:R("w-[calc(100%-36px)] ml-2",e.childrenClassName),children:e.children})]}),ECe=fn.memo(e=>{const t=ye(e.id,["data"],["segments"]),n=hh(e.level),s=La(e.id),a=We(e.id),o=y.useMemo(()=>!fe(t==null?void 0:t.data.segments),[t==null?void 0:t.data.segments]),i=y.useRef(null),l=Kg(e.id,i,o,e.level),{paddingRight:c}=mh(e.id,e.level);return t?r.jsx(ia,{id:e.id,ref:i,className:"flex items-center",level:e.level,style:{paddingLeft:"4px",minWidth:l},children:r.jsx(tz,{childrenClassName:"w-full",id:e.id,readonly:a,className:"min-h-2.5 py-0",iconClassName:"mt-0.5 disable-select",onChange:d=>{l2({icon:d})},children:r.jsx(ui,{placeholder:n,uuid:e.id,className:"whitespace-pre-wrap break-words self-start",segments:t.data.segments,onChange:(d,u,f)=>{s(d,[u,f])},style:{paddingRight:"".concat(c,"px")}})})}):null});function CCe(e){const t=y.useRef(null),n=y.useRef();return n.current=e,y.useEffect(()=>{const s=t.current;let a=null;s.addEventListener("pointerdown",o=>{if(n.current.disabled||a!==null)return;a={type:"beforestart",startX:o.clientX,startY:o.clientY,x:o.clientX,y:o.clientY,stop:!1};const i=()=>{a!=null&&(document.removeEventListener("pointermove",l),document.removeEventListener("pointerup",c),a=null)},l=d=>{var u,f,h,p,g,_;if(a===null)return i();if(a.x=d.clientX,a.y=d.clientY,a.type==="beforestart")if(Math.max(Math.abs(a.x-a.startX),Math.abs(a.y-a.startY))>=((f=(u=n.current)==null?void 0:u.touchSlorp)!=null?f:5)){if(a.type="start",(p=(h=n.current).onDragStart)==null||p.call(h,a,t),a.stop)return i()}else return;a.type="move",(_=(g=n.current).onDragMove)==null||_.call(g,a,t),d.preventDefault()},c=d=>{var u,f;if(a===null)return i();if(d.button===0)return a.type==="beforestart"?(setTimeout(()=>{d.target.dispatchEvent(new MouseEvent("click",{button:d.button,clientX:d.clientX,clientY:d.clientY}))}),i()):(a.type="end",a.x=d.clientX,a.y=d.clientY,(f=(u=n.current).onDragEnd)==null||f.call(u,a,t),a.stop||d.preventDefault(),i())};o.preventDefault(),document.addEventListener("pointermove",l),document.addEventListener("pointerup",c)})},[]),r.jsx(r.Fragment,{children:e.children({ref:t})})}const H6={hidden:()=>{document.body.setAttribute("style","pointer-events:none;"),document.body.classList.add("hiddenScroll")},show:()=>{document.body.removeAttribute("style"),document.body.classList.remove("hiddenScroll")}},kCe=(e="scroll")=>{const t=document.createElement("div");t.style.visibility="hidden",t.style.width="100px",t.style.overflow=e,document.body.append(t);const{offsetWidth:n,clientWidth:s}=t;return t.remove(),n-s},TCe=()=>{kCe()!==0&&document.documentElement.classList.add("next-scrollbar")};var no=(e=>(e[e.left=0]="left",e[e.right=1]="right",e[e.rightBottom=2]="rightBottom",e[e.leftBottom=3]="leftBottom",e[e.bottom=4]="bottom",e))(no||{});const z6=e=>{const{size:t,stateSize:n,blockFullWidth:s,breakPoints:a=!0,widthBreakPoints:o,maxWidth:i,minWidth:l,fullHeight:c,maxHeight:d,minHeight:u}=e,f=Br(t),h={...n};return s?h.width=i:(a&&[...new Set([...o,i].filter(p=>p>0))].sort((p,g)=>g-p).some(p=>Math.abs(p-f.width)<=15?(f.width=p,!0):!1),f.width>=i?i&&(h.width=i):f.width<=l?h.width=l:h.width=f.width),c?(h.height=f.height,d&&(h.height=d)):!d&&!u?h.height=f.height:(u||d)&&(u&&f.height<=u?h.height=u:d&&f.height>d?h.height=d:h.height=f.height),h.height=jS(h.height,2),h.width=jS(h.width,2),{size:h,blockFullWidth:h.width===i}},Ic=y.memo(e=>{var se,ce;const{readonly:t,resizeHeight:n,resizeWidth:s=!0,children:a,className:o,maxHeight:i=null,maxWidth:l=uo,defaultHeight:c=500,defaultWidth:d,minWidth:u=100,debounceSize:f=0,minHeight:h=0,defaultBlockFullWidth:p=!1,doubleResize:g,fullHeight:_,disableStyle:x,onChange:F,onRenderSize:b,childrenClassName:w,widthBreakPoints:E=[l,u],customFooter:C,outerLayoutClassName:k,outerLayoutStyle:T={},onKeyDownMoveBar:v,onKeyUpMoveBar:I,...j}=e,S=Qa(),D=y.useRef(null),A=y.useRef({deltaX:0,deltaY:0}),[P,L]=y.useState(!1),[O,$]=y.useState({width:d,height:c}),M=y.useRef({size:O,blockFullWidth:p}),U=ja(D.current,{mode:"throttle",wait:200});y.useEffect(()=>{b==null||b({width:U.width||0,height:U.height||0})},[U]);const z=y.useRef({width:((se=D.current)==null?void 0:se.getBoundingClientRect().width)||0,height:((ce=D.current)==null?void 0:ce.getBoundingClientRect().height)||0}),K=y.useCallback(ae=>{if(!D.current)return null;z.current.width||(z.current.width=D.current.getBoundingClientRect().width);const de={...z.current};let ke=Math.abs(ae.moveRes.deltaX)*(g?2:1),Te=Math.abs(ae.moveRes.deltaY);f>0&&(A.current={deltaX:A.current.deltaX+ke,deltaY:A.current.deltaY+Te},A.current.deltaX>=f?(ke=A.current.deltaX,A.current.deltaX=0):ke=0,A.current.deltaY>=f?(Te=A.current.deltaY,A.current.deltaY=0):Te=0),[no.left,no.right,no.rightBottom,no.leftBottom].includes(ae.type)&&([no.left,no.leftBottom].includes(ae.type)?ae.moveRes.deltaX>0?de.width-=ke:de.width+=ke:ae.moveRes.deltaX>0?de.width+=ke:de.width-=ke),[no.rightBottom,no.leftBottom,no.bottom].includes(ae.type)&&(ae.moveRes.deltaY>0?de.height+=Te:de.height-=Te);const he=z6({size:de,stateSize:O,fullHeight:_,maxHeight:i,maxWidth:l,minHeight:h,minWidth:u,widthBreakPoints:E});$(he.size)},[g,f,O,_,i,l,h,u,E]),W=y.useRef(qn(ae=>{const{callback:de,...ke}=ae,Te=z6(ke);de(Te)},50));y.useEffect(()=>{const ae={stateSize:O,fullHeight:_,maxHeight:i,maxWidth:l,minHeight:h,minWidth:u,widthBreakPoints:E,blockFullWidth:p};M.current.size.width!==d||M.current.size.height!==c?W.current({...ae,size:{width:d,height:c},breakPoints:!0,isMaxWidthChange:!1,callback:de=>{M.current={...de,blockFullWidth:p},$(de.size)}}):W.current({...ae,size:M.current.size,breakPoints:!0,isMaxWidthChange:!0,callback:de=>{M.current={...de,blockFullWidth:p},$(de.size)}})},[c,d,p,l]);const Y=R("absolute group-hover:opacity-100 transition-opacity",!P&&"opacity-0"),G=ae=>{t||(ae?(z.current={width:O.width,height:O.height},H6.hidden()):(H6.show(),M.current={size:{width:O.width,height:O.height},blockFullWidth:O.width===l},F==null||F({width:M.current.size.width,height:M.current.size.height,blockFullWidth:M.current.blockFullWidth})),L(ae))},ee=ae=>{ae.preventDefault(),v==null||v()},te=ae=>{ae.preventDefault(),I==null||I()},Q=x?{}:{width:S||M.current.blockFullWidth&&!s?"auto":O.width?O.width:void 0,height:_?"auto":O.height};if(ot.print)return r.jsxs("div",{className:R("max-w-full",k),style:{width:Q.width,...T},children:[r.jsx("div",{className:R("max-w-full",o),style:{...Q,...T},children:a}),C]});const ne={onMoveStart:G,onMoveEnd:G,onMoveBar:K,onPointerDown:ee,onPointerUp:te};return r.jsxs("div",{className:R("flex flex-col justify-center flex-shrink-0",k),style:{...T},children:[r.jsxs(I4,{config:{duration:100},className:R("relative group flex-shrink-0 overflow-hidden max-w-full",!P&&"transition-all duration-75 ease-in-out",o),domRef:D,style:Q,...j,children:[r.jsx("div",{className:R("w-full h-full",P&&"pointer-events-none",w),children:a}),!t&&r.jsxs(r.Fragment,{children:[r.jsx(f_,{...ne,type:no.left,className:R(Y,"flex items-center justify-center top-0 left-0 h-full w-2 cursor-[col-resize] py-1 z-10",!s&&"hidden"),children:r.jsx("div",{className:"w-1.5 h-full border border-white max-h-20 rounded-tr-md rounded-br-md bg-black-base/75"})}),r.jsx(f_,{...ne,className:R(Y,"bottom-0 left-0 z-[11] cursor-move",(!n||!s)&&"hidden"),type:no.leftBottom,children:r.jsx("img",{className:"w-6 h-6",src:vn.resizeLeft})}),r.jsx(f_,{...ne,type:no.right,className:R(Y,"flex items-center justify-center top-0 right-0 h-full w-2 cursor-[col-resize] py-1 z-10",!s&&"hidden"),children:r.jsx("div",{className:"w-1.5 h-full border border-white max-h-20 rounded-tl-md rounded-bl-md bg-black-base/75"})}),r.jsx(f_,{...ne,type:no.rightBottom,className:R(Y,"bottom-0 right-0 z-[11] cursor-move",(!n||!s)&&"hidden"),children:r.jsx("img",{className:"w-6 h-6 rotate-[270deg]",src:vn.resizeLeft})}),r.jsx(f_,{...ne,type:no.bottom,className:R(Y,"items-center flex justify-center bottom-0 left-0 w-full h-2 cursor-[row-resize] z-10",!n&&"hidden"),children:r.jsx("div",{className:"w-20 h-1.5 border border-white rounded-tl-md rounded-tr-md bg-black-base/75"})})]})]}),C]})}),f_=e=>{const{children:t,type:n,onMoveBar:s,onMoveStart:a,onMoveEnd:o,...i}=e;return r.jsx(CCe,{onDragStart:()=>a==null?void 0:a(!0),onDragMove:l=>{s({type:n,moveRes:{deltaX:l.x-l.startX,deltaY:l.y-l.startY}})},onDragEnd:()=>o==null?void 0:o(!1),children:({ref:l})=>r.jsx("div",{...i,ref:l,children:t})})},Nc=e=>{var M,U,z,K,W,Y;const{id:t,root:n,defaultWidth:s=uo,defaultHeight:a,defaultBlockFullWidth:o,fullPageContentWidth:i,throttleMilliseconds:l=500,resizeWidth:c=!0}=e,d=Oe(),u=lt(),f=ye(u,["data"],["directoryMenu"]),h=ye(t,["data"],["format","width","height","link"]),p=We(t),[g,_]=y.useState({width:0,height:0}),x=!((M=h==null?void 0:h.data.format)!=null&&M.width),F=y.useRef(null),b=Ho(),w=rg(),E=f==null?void 0:f.data.directoryMenu,C=Ln(),k=y.useRef(Ps(G=>d(()=>_e(t,{data:{format:G}})),l)),T=Pce(),v=Rce(),I=E||C?T:v,j=n||!F.current||!c||C;let S;j?S=null:S=F.current;const D=ja(S,{type:"width",wait:100}),A=j?I:(U=D.width)!=null?U:0,P=y.useCallback(G=>{if(p)return;const ee=n?G.width===I:G.width===A,te=i&&ee,Q={...(h==null?void 0:h.data.format)||{},...G,blockPageWidth:te};n&&!E&&(Q.blockFullWidth=G.width===v,Q.blockFullWidth&&(Q.blockPageWidth=!1)),Q.blockFullWidth&&Q.blockPageWidth&&(Q.blockFullWidth=!1),k.current(Q)},[h==null?void 0:h.data.format,A,E,i,I,v,p,n]),L=!!(i&&((z=h==null?void 0:h.data.format)!=null&&z.blockPageWidth||x&&Number(h==null?void 0:h.data.width)>=T)),O=y.useMemo(()=>{var G,ee;return{defaultWidth:L?T:((G=h==null?void 0:h.data.format)==null?void 0:G.width)||(h==null?void 0:h.data.width)||(h!=null&&h.data.link||(h==null?void 0:h.type)===m.BlockType.FILE?void 0:T||s),blockFullWidth:o||((ee=h==null?void 0:h.data.format)==null?void 0:ee.blockFullWidth)}},[(K=h==null?void 0:h.data.format)==null?void 0:K.blockFullWidth,(W=h==null?void 0:h.data.format)==null?void 0:W.width,h==null?void 0:h.data.link,h==null?void 0:h.data.width,h==null?void 0:h.type,o,s,L,T]),$=y.useMemo(()=>[A,T,uo,...XL({maxWidth:A,mode:"gradual"})],[A,T]);return{renderSize:g,onRenderSize:_,containerRef:F,changeSize:P,containerWidth:A,defaultBlockFullWidth:O.blockFullWidth,defaultWidth:O.defaultWidth,defaultHeight:((Y=h==null?void 0:h.data.format)==null?void 0:Y.height)||(h==null?void 0:h.data.height)||a,isDisable:b||w,widthBreakPoints:$,pageContentWidth:T}},ei=y.memo(e=>{var l,c,d;const t=y.useRef(null),n=ye(e.blockId,["data"],["showEmptyCaption","caption","format"]),s=(c=(l=n==null?void 0:n.data.format)==null?void 0:l.isShowCaption)!=null?c:!0,a=!!(n!=null&&n.data.showEmptyCaption||fe(n==null?void 0:n.data.caption))&&s,o=zU(e.blockId),i=Nn();return y.useEffect(()=>{var f,h,p,g;!!(fe((f=J.blocks[e.blockId])==null?void 0:f.data.caption)&&((g=(p=(h=J.blocks[e.blockId])==null?void 0:h.data.format)==null?void 0:p.isShowCaption)==null||g))&&_e(e.blockId,{data:{showEmptyCaption:!0}},!0)},[e.blockId]),y.useEffect(()=>{const u=()=>{var p;const f=i(e.blockId);if(!f)return;const h=!!fe((p=J.blocks[e.blockId])==null?void 0:p.data.caption);!f.hasFocus&&!h&&_e(e.blockId,{data:{showEmptyCaption:!1}},!0)};return document.addEventListener("click",u),()=>{document.removeEventListener("click",u)}},[i,e.blockId]),!a||!n?null:r.jsx(I4,{domRef:t,className:R("cursor-text relative rounded w-full my-px flex items-center min-h-[36px] max-w-full",e.className),"data-ignore-draggable":!0,style:{...e.style,...o},children:r.jsx(Hi,{uuid:n.uuid,className:"text-t2 text-grey3 w-full",placeholder:(d=e.placeholder)!=null?d:"添加说明",segmentType:"caption",keydownOption:d0e})})}),vCe=1e5,ICe="text/plain",kRe="text/html",TRe="text/next-space-blocks",vRe="text/next-space-content",IRe="text/next-space-cells";var NCe=(e=>(e.CUT="cut",e.COPY="copy",e))(NCe||{});const q6=new WeakSet,jCe=e=>{const t=Pa(),n=Nn(),s=y.useRef(null),a=y.useRef(),o=xB(e),i=y.useRef(!1),l=Un(),c=af("".concat(e.id,"_mock")),d=c,u=y.useRef(),f=y.useRef(NaN),h=We(e.id);y.useEffect(()=>{var E;const _=s.current;if(!_)return;const x=Zi(_,{value:fe(o.current.segments),...e.maxHeight!=null?{}:{viewportMargin:1/0},...(E=e.noScrollbars)!=null&&E?{scrollbarStyle:"null"}:{},lineNumbers:!0,keyMap:"modified",theme:t?"ayu-dark":"default",autoRefresh:!0,highlightSelectionMatches:!0,matchTags:{bothTags:!0},matchBrackets:{strict:!0},extraKeys:{Tab(C){C.indentSelection("add")},"Shift-Tab"(C){C.indentSelection("subtract")}}});a.current=x;const F=n(c,!0);q6.has(F)||(Object.defineProperties(F,{content:{get(){return Wn([ti(x.getValue())])}},revision:{get(){return x.changeGeneration()}},selection:{get(){const C=x.getDoc().indexFromPos(x.getCursor("anchor")),k=x.getDoc().indexFromPos(x.getCursor("head"));return yL(C,k)}},getBoundingClientRectOfRange:{value:(C,k)=>{const T=x.cursorCoords(x.getDoc().posFromIndex(C),"window"),v=x.cursorCoords(x.getDoc().posFromIndex(k),"window"),I=Math.min(T.left,v.left),j=Math.min(T.top,v.top),S=Math.max(T.left,v.left),D=Math.max(T.bottom,v.bottom);return new DOMRect(I,j,S-I,D-j)}},hitTest:{value:(C,k)=>{const T=x.coordsChar({left:C,top:k},"window");return x.getDoc().indexFromPos(T)}},scrollCaretIntoViewIfNeeded:{value:()=>{}},performChange:{value:C=>{C({load(k){i.current=!0,x.setValue(ta(k)),i.current=!1},select(k=0,T=k,v=!1){const I=x.getDoc().posFromIndex(v?T:k),j=x.getDoc().posFromIndex(v?k:T);x.setSelection(I,j,{scroll:!1})},delete(){x.replaceSelection("")},insert(k){typeof k=="string"?x.replaceSelection(k):x.replaceSelection(ta(k))}})}},requestFocus:{value:()=>{x.focus()}}}),q6.add(F)),f.current=x.changeGeneration(),F[Pg]=u,F[fx]=f;let b=x.changeGeneration(),w=[F.content,F.selection];return x.on("beforeChange",()=>{i.current||x.isClean(b)&&(w=[F.content,F.selection])}),x.on("changes",C=>{var T,v;if(l===wt.PAGE_LITE_PREVIEW)return;b=C.changeGeneration();const k=[{type:m.TextType.TEXT,enhancer:{},text:C.getValue()}];u.current=k,(v=(T=o.current).onChange)==null||v.call(T,k,w),f.current=F.revision}),()=>{yE(c);const C=new Range;C.selectNodeContents(_),C.deleteContents()}},[n,d,c,o,e.maxHeight,e.noScrollbars,t,l]),y.useEffect(()=>{const _=a.current;_&&_.setOption("readOnly",h)},[h]),y.useEffect(()=>{const _=a.current;if(!_)return;const x=fe(e.segments);x!==_.getValue()&&(i.current=!0,_.setValue(x),i.current=!1),u.current=e.segments},[e.segments]),y.useEffect(()=>{var F,b;const _=a.current;if(!_)return;const x=Zi.findModeByExtension((F=e.language)==null?void 0:F.toLocaleLowerCase())||jue(e.language);x&&(_.setOption("mode",(b=x.mime)!=null?b:x.mode),Zi.autoLoadMode(_,x.mode,Nue))},[e.language]),y.useEffect(()=>{var x;const _=a.current;_&&_.setOption("lineWrapping",(x=e.wordWrap)!=null?x:!1)},[e.wordWrap]),y.useEffect(()=>{const _=gb(document,"_clearTextSelection").subscribe(()=>{const F=a.current;F&&(F.setSelection({line:0,ch:0},void 0,{scroll:!1}),typeof F.state.selectingText=="function"&&F.state.selectingText())}),x=gb(document,"selectionchange").subscribe(()=>{const F=a.current;if(!F)return;const b=document.getSelection();b&&G1(b.focusNode)!=null&&F.setSelection({line:0,ch:0},void 0,{scroll:!1})});return()=>{_.unsubscribe(),x.unsubscribe()}},[]);const p=WV(d),g=KV(d);return r.jsx("div",{ref:s,"data-disable-select":!0,"data-editor":d,className:R(e.className,"w-full code-mirror",Mn({selectors:{"& div.CodeMirror-gutters":{background:"transparent !important"},"& div.CodeMirror":{minHeight:"24px",height:"100%",maxHeight:e.maxHeight?"".concat(e.maxHeight,"px"):void 0,background:"transparent",fontSize:"14px",color:"var(--black)",padding:e.padding?e.padding:e.noScrollbars?"8px":"24px"},"& .CodeMirror-cursor":{borderLeftWidth:"1px !important",display:h?"none !important":void 0},"& .CodeMirror-selected":{background:"var(--selection) !important"},"& .CodeMirror-focused .CodeMirror-selected":{background:"var(--selection) !important"},"& .CodeMirror-line::selection, & .CodeMirror-line > span::selection, & .CodeMirror-line > span > span::selection":{background:"var(--selection) !important"},"& .CodeMirror pre.CodeMirror-line, & .CodeMirror pre.CodeMirror-line-like":{fontFamily:'SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace'}}})),onPasteCapture:_=>{_.clipboardData.getData(ICe).length>vCe&&(_.preventDefault(),be.warning("内容过大。以防数据丢失，请改用文件形式上传"))},onKeyDownCapture:_=>{var F,b;const x=a.current;if(x){if(Ie("mod+a")(_)){const w=n(d,!1);if(!w)return;const{selection:E}=w;if(!E||E.length===w.content.length)return;_.stopPropagation(),x.execCommand("selectAll")}Ie("ArrowUp")(_)?(F=Ma(d))!=null&&F.isFirstLine&&p(_.nativeEvent):Ie("ArrowDown")(_)&&(b=Ma(d))!=null&&b.isLastLine&&g(_.nativeEvent)}}})},tk=new Map,SCe=y.memo(e=>{var h,p,g;const t=sh(),n=y.useRef(null),{blockId:s}=e,a=ye(s,["data"],["format","viewMode"]),o=(p=(h=a==null?void 0:a.data.format)==null?void 0:h.language)!=null?p:"",i=(g=a==null?void 0:a.data.viewMode)!=null?g:fr.card,l=ft(s,_=>fe(_==null?void 0:_.data.segments)),c=NB(o,i),[d,u]=y.useState(!1),f=y.useCallback(async _=>{if(x3(_.target,C=>C.tagName==="a","svg"))return;const F=n.current;if(!F||!d)return;const b=Xo(),w="mermaid-".concat(b,"-").concat(l);let E="";tk.has(w)?E=tk.get(w):(be.loading({content:"正在生成图片",key:w}),await es(300),E=(await pj(F,{useCORS:!0,backgroundColor:b?Do.dark.grey8:Do.grey8,scale:5})).toDataURL("image/png"),tk.set(w,E),be.closeMessage(w)),t({uuid:"mermaid-".concat(s),src:E})},[s,t,l,d]);return c.preview?r.jsx("div",{ref:n,hidden:!l,className:R("p-4",!c.code&&"pt-0",d&&"animate-click"),onClick:f,children:r.jsx(SJ,{onRender:u,text:l})}):null}),DCe=y.memo(e=>{var i,l;const{blockId:t}=e,n=ye(t,["data"],["format","viewMode"]),s=(l=(i=n==null?void 0:n.data.format)==null?void 0:i.codePreviewFormat)!=null?l:Kl.splitView,a=Oe(),o=c=>{a(()=>{_e(t,{data:{format:{codePreviewFormat:c}}})})};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-4 w-px bg-grey4 mx-2.5"}),r.jsx(Dl,{className:"h-full",dropdownClassName:"w-32",SelectView:U8,readonly:!1,options:RJ,value:s,onChange:o})]})}),G6=40,nz=({id:e,root:t})=>{var L,O,$,M,U,z,K;const n=La(e),s=Oe(),a=pt(),o=ye(e,["textColor","data"],["segments","format","description","viewMode"]),i=We(e),l=Un(),[c,d]=Rd(e,{defaultOpen:!0}),[u,f]=y.useState(!1),{renderSize:h,onRenderSize:p,changeSize:g,containerWidth:_,containerRef:x,isDisable:F,defaultHeight:b}=Nc({id:e,root:t,defaultHeight:(L=o==null?void 0:o.data.format)==null?void 0:L.height,fullPageContentWidth:!0,resizeWidth:!1}),[w,E]=y.useState(!b),C=($=(O=o==null?void 0:o.data.format)==null?void 0:O.language)!=null?$:Lm,k=(U=(M=o==null?void 0:o.data.format)==null?void 0:M.codeWrap)!=null?U:!0,T=(K=(z=o==null?void 0:o.data.format)==null?void 0:z.codePreviewFormat)!=null?K:Kl.splitView,v=NB(C,T),{allowSelectionCopy:I}=mt(e),j=!(!I&&a),S=y.useCallback(()=>{s(()=>{var Y;const W=(Y=o==null?void 0:o.data.format)!=null?Y:{};_e(e,{data:{format:{...W,codeWrap:!k}}})})},[o==null?void 0:o.data.format,e,s,k]),D=y.useCallback(W=>{o!=null&&o.uuid&&s(()=>{_e(o.uuid,{updatedAt:Date.now(),data:{description:ht(W)}})})},[o==null?void 0:o.uuid,s]),A=ot.print||c,P=fe(o==null?void 0:o.data.description);return o?r.jsxs("div",{className:"w-full h-full",ref:x,children:[r.jsxs("div",{className:"rounded bg-grey8",children:[r.jsxs("div",{className:"h-10 flex items-center text-t2 justify-between px-2 overflow-x-auto",children:[r.jsxs("div",{className:"flex items-center text-ellipsis flex-shrink-0 text-black",children:[r.jsx(V,{name:"IcToggleGrey",size:"middle",className:R("text-grey3 mr-1 animate-hover transition-transform rotate-90",!A&&"rotate-0"),onClick:()=>d(!A)}),u?r.jsx(Ct,{autoFocus:!0,showBorder:!1,readonly:i,className:"h-7 w-full rounded-sm",inputClassName:"px-0.5 text-t2 h-7",placeholder:"请输入代码块名称",defaultValue:P,onBlur:()=>{u&&f(!1)},onChange:D}):r.jsx("div",{className:R("animate-hover text-ellipsis w-full px-0.5 min-w-[30px] h-[22px] group-hover:opacity-100 transition-opacity",!P&&"text-grey4 opacity-0"),onClick:W=>{i||(W.preventDefault(),W.stopPropagation(),f(!0))},children:P||(i?"":"请输入代码块名称")})]}),r.jsxs("div",{className:"transition-opacity opacity-0 group-hover:opacity-100 flex items-center flex-shrink-0 text-t2 text-grey3 ml-2 h-7",children:[r.jsx(PCe,{className:"h-full",value:C,readonly:i,onChange:W=>{s(()=>{var G;ts(p5,W);const Y=(G=o.data.format)!=null?G:{};_e(e,{data:{format:{...Y,language:W}}})})}}),!i&&r.jsxs(r.Fragment,{children:[v.button&&r.jsx(DCe,{blockId:e}),r.jsx("div",{className:"h-4 w-px bg-grey4 mx-2.5"}),r.jsxs("div",{className:"flex items-center px-1 animate-hover h-full",onClick:S,children:[r.jsx(V,{name:"IcCode",size:"middle",className:"mr-1"}),"自动换行"," ",k?"开启":"关闭"]}),r.jsx("div",{className:"h-4 w-px bg-grey4 mx-2.5"})]}),r.jsxs("div",{hidden:!j,className:R("h-7 px-1 animate-hover flex items-center",l===wt.NOTIFICATION&&"hidden"),onClick:()=>{Xt(fe(o.data.segments),{message:"已复制代码"})},children:[r.jsx(V,{size:"middle",className:"mr-1",name:"IcCopy"}),r.jsx("span",{children:"复制"})]})]})]}),A&&r.jsxs(r.Fragment,{children:[v.code&&r.jsx(Ic,{resizeHeight:!0,readonly:i||F,defaultBlockFullWidth:!0,resizeWidth:!1,maxWidth:_,minHeight:G6,defaultWidth:_,defaultHeight:b||h.height||G6,onChange:g,onRenderSize:p,onKeyDownMoveBar:()=>{E(!1)},onKeyUpMoveBar:()=>{E(!b)},className:R("flex relative z-0 w-full group border-t",(F||!j)&&"pointer-events-none",w&&"!h-full"),children:r.jsx("div",{className:R("h-full",!w&&"overflow-y-auto"),children:r.jsx("div",{className:R(!w&&"h-full"),children:r.jsx(jCe,{className:R("pb-4",!w&&"h-full"),id:e,noScrollbars:l===wt.NOTIFICATION,maxHeight:l===wt.NOTIFICATION?150:void 0,padding:"0px",language:C,wordWrap:k,segments:o.data.segments,onChange:(W,Y)=>{n(W,Y)}})})})}),v.preview&&r.jsx(SCe,{blockId:e})]})]}),r.jsx(ei,{blockId:e,className:"px-2"})]}):null},ACe=e=>{const{id:t,root:n}=e,s=Pa();return r.jsx(wn,{id:t,className:"my-1 group",horizontal:n,children:r.jsx(nz,{...e})},"".concat(t,"-darkMode-").concat(s))},RCe=e=>{var c,d;const t=ye(e.id,["data"],["description","segments","format"]),[n,s]=yc(),[a]=Rd(e.id,{defaultOpen:!0});if(n||ot!=null&&ot.print||!a)return r.jsx(ACe,{...e});const o=fe(t==null?void 0:t.data.description),i=fe((c=t==null?void 0:t.data.segments)!=null?c:[]),l=(d=t==null?void 0:t.data.format)==null?void 0:d.height;return r.jsxs("div",{ref:s,className:"bg-grey8 my-1 text-t2","data-block-id":e.id,children:[r.jsx("div",{className:"px-3 h-8 flex items-center",children:o}),r.jsx("div",{className:"p-3 pl-10 whitespace-pre-wrap break-words border-t border-grey6",style:{height:l||"unset"},children:i})]})},PCe=({className:e,value:t,onChange:n,readonly:s})=>{const a=qT.map(o=>({title:o,value:o}));return a.sort(Hr(o=>o.title,Rk)),r.jsx(Dl,{SelectView:U8,enableSearch:!0,readonly:s,className:e,options:a,value:t,onChange:n})},LCe=fn.memo(e=>r.jsx(ia,{id:e.id,className:"group !bg-grey8",level:e.level,children:r.jsx(nz,{id:e.id})})),BCe=e=>{const t=y.useRef(!1),n=y.useRef();n.current=e,y.useEffect(()=>{const o=()=>{var i;t.current&&((i=n.current)==null||i.call(n))};return window.addEventListener("blur",o),()=>{window.removeEventListener("blur",o)}},[]);const s=y.useCallback(()=>{t.current=!0},[]),a=y.useCallback(()=>{window.focus(),t.current=!1},[]);return{onMouseOver:s,onMouseOut:a}},Ld=e=>{const{uuid:t,callback:n}=e;y.useEffect(()=>{var s;(s=J.blocks[t])!=null&&s.local&&(n&&n(),_e(t,{local:!1},!0))},[t])},OCe=fn.memo(e=>{const t=ye(e.id,["data"],["link"]);return t!=null&&t.data.link?r.jsx(MCe,{id:e.id,level:e.level}):r.jsx(UCe,{id:e.id,level:e.level})}),MCe=({id:e,level:t})=>{var L;const n=t===0,s=$i(),[a,o]=y.useState(!0),[i,l]=y.useState(!1),c=y.useRef(setTimeout(()=>{})),d=ye(e,["data"],["segments","caption","link"]),{alwaysShowPlaceHolder:u,placeHolder:f}=sg(e,{defaultPlaceholder:"输入文字"}),h=La(e,"caption"),p=Sd(e),g=We(e),_=y.useRef(null),[x,F]=y.useState(""),b=y.useMemo(async()=>{const{website:O,link:$}=await g3(x);return O?O===$r.music163&&$.includes("?type=2")?{resizeHeight:!1,defaultHeight:86}:{}:{}},[x]),{onMouseOver:w,onMouseOut:E}=BCe(()=>{p||J.ui.selectedBlocks.length>=1||re(at.updateSelectBlocks([{blockId:e,mindMapId:s}]))}),{onRenderSize:C,changeSize:k,containerRef:T,isDisable:v,defaultWidth:I,defaultHeight:j,defaultBlockFullWidth:S,widthBreakPoints:D}=Nc({id:e,defaultWidth:500,defaultHeight:400,root:n});Wg(T,e,"caption"),y.useEffect(()=>{var O;Vu((O=d==null?void 0:d.data.link)!=null?O:"",!0).then($=>{F(($==null?void 0:$.link)||(d==null?void 0:d.data.link)||"")})},[d==null?void 0:d.data.link]);const A=y.useCallback(()=>{var O;Xt((O=d==null?void 0:d.data.link)!=null?O:"")},[d==null?void 0:d.data.link]),P=y.useCallback(()=>{_.current&&(_.current.src="",o(!0),l(!1),c.current=setTimeout(()=>{l(!0)},1e4),_.current.src=x)},[x]);return y.useEffect(()=>{Ao(1e3).then(()=>{l(!1)}),c.current=setTimeout(()=>{l(!0),o(!1)},1e4)},[]),y.useEffect(()=>{var O;(O=_.current)==null||O.addEventListener},[]),d?r.jsx(ia,{id:e,ref:T,level:t,children:r.jsxs("div",{className:"w-[520px] px-3",children:[r.jsx(ui,{placeholder:f,uuid:e,alwaysShowPlaceholder:u,className:"whitespace-pre-wrap break-words",segments:(L=d.data.caption)!=null?L:[],segmentType:"caption",onChange:(O,$,M)=>{h(O,[$,M])}}),r.jsxs(Ic,{resizeHeight:!0,resizeWidth:!0,widthBreakPoints:D,readonly:g,doubleResize:n,defaultWidth:I||uo,defaultHeight:j,defaultBlockFullWidth:S,maxWidth:uo,minWidth:36,minHeight:80,outerLayoutClassName:"w-full",className:"w-full",onChange:k,onRenderSize:C,...b,children:[i&&!a&&r.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-full cursor-pointer bg-grey8",onClick:P,children:[r.jsx(na,{emojiStr:"🕸️",iconSize:70,className:"mb-2 pointer-events-none"}),r.jsx("div",{className:"text-grey4 text-t2",children:"网页加载失败，点击刷新"})]}),!i&&a&&r.jsx(xs,{}),r.jsxs("div",{className:"w-full h-full",children:[p&&r.jsxs("div",{onClick:A,className:R("flex absolute top-2.5 right-3 z-10 cursor-pointer bg-black/75 opacity-0 group-hover:opacity-100 text-white1 transition-opacity text-t4 px-1 py-0.5 rounded-sm animate-click items-center"),children:[r.jsx(V,{name:"IcLink",className:"mr-1",size:"middle"}),r.jsx("span",{children:"复制链接"})]}),r.jsx("div",{className:"relative w-full h-full overflow-hidden",onMouseOver:w,onMouseOut:E,children:r.jsx("iframe",{referrerPolicy:"origin",allowFullScreen:!0,className:R("w-full h-full absolute inset-0",v&&"pointer-events-none",{hidden:i}),ref:_,src:x,sandbox:"allow-scripts allow-popups allow-top-navigation-by-user-activation allow-forms allow-same-origin",onLoad:()=>{clearTimeout(c.current),l(!1),o(!1)}})})]})]})]})}):null},UCe=({id:e,level:t})=>{var p;const n=ye(e,["data","local"],["link","embedType"]),s=ie(),[a,o]=y.useState(!1),i=y.useRef(""),l=Oe(),c=We(e),d=n==null?void 0:n.data.embedType,u=d?(p=aj()[d])==null?void 0:p.data:null;Ld({uuid:e}),y.useEffect(()=>{n&&n.local&&n.data.link&&f(n.data.link)},[]);const f=y.useCallback(async g=>{if(!g.trim())return;o(!0);const _=await Vu(g,!0);l(()=>{var x;((x=_==null?void 0:_.headerMap)==null?void 0:x["X-Frame-Options"])!==void 0&&(_.headerMap["X-Frame-Options"].toLocaleLowerCase()==="allow"||_.headerMap["X-Frame-Options"]==="")&&_.link.match(/(https):\/\/([\w.]+\/?)\S*/gi)&&!mV(_.link)?_e(e,{data:{link:g}}):_e(e,{type:m.BlockType.BOOKMARK,data:{link:g,linkInfo:ht(_==null?void 0:_.title),cover:_==null?void 0:_.cover,icon:{type:"http",value:_==null?void 0:_.icon},description:ht(_==null?void 0:_.description),headers:_==null?void 0:_.headerMap}})}),o(!1)},[e,l]),h=y.useCallback(g=>{a||s.dropdown({popcorn:g.currentTarget,placement:"bottom",content:({onCloseModal:_})=>r.jsxs("div",{className:"flex flex-col w-[370px] next-modal px-2.5 py-3.5",children:[r.jsx(Ct,{autoFocus:!0,className:"h-8 rounded-sm",placeholder:u?u.placeholder:"https://www.example.com",onChange:x=>i.current=x,onEnter:()=>{f(i.current),_()}}),r.jsx(De,{size:"large",colorType:"active",className:"mt-3.5 text-t4-medium",onClick:()=>{f(i.current),_()},children:"提交"})]})})},[u,a,s,f]);return r.jsx(ia,{id:e,level:t,className:"max-w-[380px]",children:r.jsx(vc,{readonly:c,iconElement:u&&r.jsx("img",{src:u.image,className:"w-6 h-6"}),defaultOpenPanel:!!(n!=null&&n.local&&!n.data.link),iconProp:{name:"IcGlobeShare",size:"normal"},text:a?"正在嵌入内容...":u?"嵌入".concat(u.title):"添加嵌入内容",onClick:h,className:c?"cursor-default":"cursor-pointer"})})},VCe=fn.memo(e=>{const t=ye(e.id,["data","local"],["segments"]),n=Oe(),s=We(e.id),a=y.useMemo(()=>fe(t==null?void 0:t.data.segments),[t==null?void 0:t.data.segments]);return Ld({uuid:e.id}),t?r.jsx(ia,{id:e.id,className:"min-w-[112px] px-2",level:e.level,children:r.jsx(Bj,{readonly:s,content:a,onChange:o=>{const i=ht(o);n(()=>{_e(e.id,{data:{segments:i}})})},defaultOpenPanel:!!t.local})}):null}),B4=e=>{const{renderList:t}=e;return r.jsx("div",{className:"flex bg-black-base/90 rounded z-10 absolute top-2.5 right-3 opacity-0 group-hover:opacity-100 text-white space-x-1 py-1 px-1.5",children:t.filter(n=>!n.hidden).map(n=>r.jsx(Fe,{popup:n.title,children:r.jsx("div",{className:"p-0.5 flex justify-center items-center animate-click",onClick:n.click,children:r.jsx(V,{size:"small",name:n.icon})})},n.title))})},sz=e=>{const t=uh(),n=ie(),s=CH(),a=y.useMemo(()=>[{title:"对齐方式",icon:"IcAlignLeft",hidden:!e.showAlign,click:o=>{re(at.updateSelectBlocks([{blockId:e.blockId}])),n.dropdown({placement:"top",popcorn:o.currentTarget,content:({onCloseModal:i})=>r.jsx(cF,{blockIds:[e.blockId],closeModal:i})})}},{title:"编辑超链接",icon:"IcLink",click:o=>{s(e.blockId,o.currentTarget)}},{title:e.externalLink?"打开链接":"菜单",icon:e.externalLink?"IcGlobeShare":"IcMore",click:o=>{if(e.externalLink)window.open(e.link);else{const i=document.querySelector('[data-block-id="'.concat(e.blockId,'"]'));t({menuPosition:o.currentTarget,blockId:e.blockId,blockNode:i,placement:"right-end",offset:[0,8]})}}},{title:"添加评论",icon:"IcMenuReply",click:e.onAddComment,hidden:!e.onAddComment}],[t,s,n,e.blockId,e.externalLink,e.link,e.onAddComment,e.showAlign]);return r.jsx(B4,{renderList:a})};function rz(e){return r.jsxs("div",{className:"flex flex-col justify-center items-center bg-grey8 h-[114px] cursor-pointer my-1",onClick:e.readonly?void 0:e.onClick,contentEditable:!1,children:[r.jsx(V,{name:"IcUploadImageFaild",className:"text-grey4",size:"large"}),r.jsx("div",{className:"mt-2 text-t2 text-grey4",children:"图片加载失败，请点击重新上传"})]})}const O4=({width:e=0,height:t=0,maxWidth:n=uo,maxHeight:s})=>(e>n&&(t=t*n/e,e=n),s&&t>s&&(t=t*s/e),{width:e,height:t}),NRe=e=>new Promise(t=>{const n=document.createElement("canvas"),s=n.getContext("2d");if(s){const{width:a,height:o}=e;n.width=a,n.height=o,s.drawImage(e,0,0,a,o),n.toBlob(i=>{t(i||void 0)},"image/png",1)}});function $Ce(e){return r.jsx(vc,{defaultOpenPanel:e.defaultOpenPanel,readonly:e.readonly,iconProp:{name:"IcUploadImage",size:"normal"},text:"添加图片",onClick:e.onClick,className:e.readonly?"cursor-default":"cursor-pointer"})}const ec=e=>{const t=Un();return!e.children||t===wt.PAGE_FEEDS?null:r.jsxs("div",{className:"group-scope relative pl-6 block-child-line-box",style:e.style,children:[r.jsx("span",{className:"block-child-line absolute left-3 w-px opacity-100 group-hover:opacity-0 group-scope-hover:opacity-0 bg-grey6 h-full transition-opacity duration-300 ease-linear dark:bg-white-base/10"}),e.children]})},M4=y.memo(e=>{var te;const{id:t,root:n,ownerBlockId:s,children:a}=e,o=s!=null?s:t,i=ye(t,["data","local"],["ossName","height","width","format","size","link"]),l=We(o),c=hc(o),d=lt(),{role:u}=mt(d),f=ff(),h=C2(),{renderSize:p,onRenderSize:g,changeSize:_,containerWidth:x,containerRef:F,isDisable:b,defaultWidth:w,defaultHeight:E,defaultBlockFullWidth:C,widthBreakPoints:k}=Nc({id:o,root:n,fullPageContentWidth:!0}),T=y.useContext(Qp),v=ja(T==null?void 0:T.current,{type:"width"}).width,I=qU(o,v||Number.MAX_SAFE_INTEGER,!!n),j=U1e(o),{contentGravity:S}=ix(o),D=Un(),{formatUrl:A,loading:P,loadingCalcSize:L,srcSetParams:O,url:$,imageLink:M}=U4(t,{containerWidth:x,defaultWidth:w!=null?w:v}),U=(c==null?void 0:c.status)===is.failure||!Gu(A)&&!A.startsWith("blob")&&!A.endsWith("=")&&A,z=ch({uuid:t}),K=y.useCallback(Q=>{const ne=Q.getBoundingClientRect();z({getBoundingClientRect:()=>ne},"bottom",[0,-(ne.height*.6)])},[z]),W=y.useCallback(()=>{F.current&&K(F.current)},[F,K]),Y=y.useMemo(()=>({width:ot.print?"auto":p.width||L.width,textAlign:ot.print?"center":"left"}),[L.width,p.width]);if(!i)return null;if((!A||U)&&!M&&!P)return r.jsxs(wn,{id:o,blockRef:F,horizontal:n,className:"my-1",style:{height:L.height>0?L.height:void 0,...I},children:[U?r.jsxs(r.Fragment,{children:[r.jsx(rz,{readonly:l,onClick:Q=>K(Q.currentTarget)}),r.jsx(ei,{blockId:o})]}):r.jsx($Ce,{readonly:l,defaultOpenPanel:!!i.local,onClick:Q=>K(Q.currentTarget)}),a&&r.jsx(ec,{blockId:o,children:a})]});const G=r.jsx(HCe,{uuid:t,srcSetParams:O,blockId:o,formatUrl:A,url:$,ownerBlockId:s,maxWidth:x,imageLink:M},$||i.data.link),ee=r.jsxs(Ic,{fullHeight:!0,resizeWidth:!0,doubleResize:S===m.ContentGravity.CENTER,readonly:l||b,disableStyle:!w,defaultWidth:w!=null?w:0,defaultHeight:E,defaultBlockFullWidth:C,maxWidth:x,widthBreakPoints:k,minHeight:36,minWidth:36,onChange:_,onRenderSize:g,outerLayoutClassName:R(s&&"pl-1 border-dashed border-grey5 border-l-[2px]"),outerLayoutStyle:j,className:R("max-w-full cursor-pointer overflow-visible",b&&"pointer-events-none",ot.print&&"my-2.5",ot.print&&n&&"mx-auto"),customFooter:r.jsx(ei,{blockId:o,style:Y}),children:[P?r.jsx(az,{uuid:o,maxWidth:((te=i==null?void 0:i.data.format)==null?void 0:te.width)||x}):G,!ot.print&&!l&&!b&&!s&&r.jsx(sz,{showAlign:!0,blockId:t,onReplace:W,onDownload:()=>h(t),onAddComment:Xn(u,m.PermissionRole.COMMENTER)&&!s?()=>{f({blockId:t})}:void 0,externalLink:i.type===m.BlockType.EXTERNAL_FILE,link:i.data.link})]});return ot.print?r.jsxs("div",{children:[ee,a&&r.jsx(ec,{blockId:o,children:a})]}):D&&D===wt.ONLY_IMAGE?G:D&&[wt.NOTIFICATION,wt.PAGE_FEEDS,wt.UPDATE_LOG].includes(D)?r.jsxs("div",{className:"flex flex-col",children:[G,r.jsx(ei,{blockId:o,style:{width:"100%",textAlign:"center"}})]}):r.jsxs(wn,{blockRef:F,id:o,horizontal:n,fullWidth:!1,"data-draggable":!0,className:R("my-2.5 group",n&&"self-center"),style:{...I},children:[ee,a&&r.jsx(ec,{blockId:o,children:a})]})}),HCe=y.memo(e=>{const{blockId:t,maxWidth:n,uuid:s}=e,a=Ks(),o=Sd(t),i=sh(),l=Un()===wt.ONLY_IMAGE,c=bH(t),d=ye(t,["data"],["openLink"]),u=y.useRef(!1),f=y.useRef();return r.jsx(I2,{...e,"data-image-id":s,maxWidth:n,className:R("transition-all w-full preview-file outline outline-2 outline-transparent",{"cursor-zoom-in outline-active_color":o,"object-cover":l,"outline-grey6":!o&&c}),unloader:h=>r.jsxs("div",{...kn(h,["unloader","loader","src","onError"]),className:R("flex h-24 text-t3 flex-col items-center justify-center bg-grey8 p-2",h.className),children:[r.jsx("div",{children:"加载失败"}),r.jsx("div",{children:"外部图片链接已失效"})]}),onDoubleClick:h=>{u.current=!0,setTimeout(()=>{u.current=!1},1e3),i({uuid:s,src:h.target.src})},onClick:h=>{const p=d!=null&&d.data.openLink?400:0;clearTimeout(f.current),f.current=setTimeout(()=>{if(!u.current){if(d!=null&&d.data.openLink){window.open(Z1(d==null?void 0:d.data.openLink));return}if(!ot.blog){if(!o&&!a){re(at.updateSelectBlocks([{blockId:t}]));return}i({uuid:s,src:h.target.src})}}},p)}})},yn),az=e=>{var s,a,o;const t=ye(e.uuid,["data"],["width","height","format"]),n=O4({width:(t==null?void 0:t.data.width)||((s=t==null?void 0:t.data.format)==null?void 0:s.width),height:(t==null?void 0:t.data.height)||((a=t==null?void 0:t.data.format)==null?void 0:a.height),maxWidth:e.maxWidth});return r.jsx(xs,{size:"middle",style:{height:n.height,width:(o=t==null?void 0:t.data.format)!=null&&o.blockFullWidth?"100%":n.width,maxWidth:"100%"}})},U4=(e,t)=>{var _,x;const{containerWidth:n,defaultWidth:s}=t,{url:a,loading:o,isOssNameUrl:i}=bc(e,{isImage:!0});let l=a;const c=ye(e,["data","local"],["ossName","height","width","format","size","link"]),{openImageWatermark:d,imageWatermarkText:u}=Dg(c==null?void 0:c.spaceId);d&&u&&(l=Tm(a,u));const f=(c==null?void 0:c.type)===m.BlockType.PDF_ANNOTATION,h=y.useMemo(()=>{if(f||!i)return l;if(!c)return"";const{extName:F}=rn(c.data.ossName);return Jo(l,F)},[c,f,l,i]),p=y.useMemo(()=>{var b,w;if(!i||!c||!h||ot.print)return{};const{extName:F}=rn(c.data.ossName);return!Im.test(F)||((w=(b=c.data)==null?void 0:b.size)!=null?w:0)>=50*N_?{}:ZX(h,c==null?void 0:c.data.width,s)},[c,i,s,h]),g=y.useMemo(()=>{var F,b,w;return O4({width:(c==null?void 0:c.data.width)||((F=c==null?void 0:c.data.format)==null?void 0:F.width),height:(c==null?void 0:c.data.height)||((b=c==null?void 0:c.data.format)==null?void 0:b.height),maxWidth:((w=c==null?void 0:c.data.format)==null?void 0:w.width)||n})},[n,(_=c==null?void 0:c.data.format)==null?void 0:_.height,(x=c==null?void 0:c.data.format)==null?void 0:x.width,c==null?void 0:c.data.height,c==null?void 0:c.data.width]);return{srcSetParams:p,loadingCalcSize:g,url:l,loading:o,isOssNameUrl:i,formatUrl:h,imageLink:c==null?void 0:c.data.link}},I2=y.memo(e=>{const{blockId:t,formatUrl:n,srcSetParams:s,maxWidth:a,url:o,imageLink:i,unloader:l,...c}=e,[d,u]=y.useState(!!i),[f,h]=y.useState(!0),[p,g]=y.useMemo(()=>d&&i?[i,{}]:f?[n,s!=null?s:{}]:[o,{}],[n,i,f,d,s,o]),_=()=>{d?u(!1):f&&h(!1)};return r.jsx(Y$,{showLoading:!d,loader:ot.print?void 0:r.jsx(r.Fragment,{children:s?r.jsx(I2,{...kn(e,"srcSetParams")}):r.jsx(az,{uuid:t,maxWidth:a})}),unloader:x=>(_(),l==null?void 0:l(x)),uuid:t,src:p,...g,onError:_,...c,"data-no-cancel-selected":!0})},yn),V4=fn.memo(e=>{var M,U,z,K;const t=(M=e.ownerBlockId)!=null?M:e.id,n=ye(e.id,["data"],["caption","ossName","format","width","height","size"]),s=sh(),a=Sd(e.id),o=ch({uuid:e.id}),i=hc(t),l=We(t),{alwaysShowPlaceHolder:c,placeHolder:d}=sg(e.id),u=C2(),f=lt(),h=ff(),{role:p}=mt(f),{onRenderSize:g,changeSize:_,containerRef:x,isDisable:F,defaultWidth:b,defaultHeight:w,defaultBlockFullWidth:E,widthBreakPoints:C,containerWidth:k}=Nc({id:t,root:!1,fullPageContentWidth:!1}),{formatUrl:T,loading:v,loadingCalcSize:I,srcSetParams:j,url:S,imageLink:D}=U4(e.id,{containerWidth:k,defaultWidth:b});Wg(x,e.id,"caption");const A=zU(e.id),P=(i==null?void 0:i.status)===is.failure||!Gu(T)&&!T.startsWith("blob")&&!T.endsWith("=")&&T,L=La(e.id,"caption");if(!n)return null;const O=W=>{const Y=W.getBoundingClientRect();o({getBoundingClientRect:()=>Y},"bottom",[0,-(Y.height*.6)])},$=()=>{x.current&&O(x.current)};return r.jsx(ia,{id:t,level:e.level,ref:x,children:r.jsxs("div",{className:"w-min px-3",children:[((z=(U=n.data.format)==null?void 0:U.isShowCaption)!=null?z:!0)&&r.jsx(ui,{placeholder:d,uuid:e.id,alwaysShowPlaceholder:c,className:"whitespace-pre-wrap break-words",segments:n.data.caption,segmentType:"caption",onChange:(W,Y,G)=>{L(W,[Y,G])},style:A}),P?r.jsx(rz,{onClick:W=>{O(W.currentTarget)}}):r.jsxs(Ic,{fullHeight:!0,resizeWidth:!0,readonly:l||F,defaultWidth:b!=null?b:200,defaultHeight:w,defaultBlockFullWidth:E,maxWidth:500,maxHeight:200,widthBreakPoints:C,minHeight:36,minWidth:36,onChange:_,onRenderSize:g,className:R("max-[520px]",F&&"pointer-events-none",ot.print&&"my-2.5"),children:[v?r.jsx(xs,{style:{height:I.height,width:(K=n.data.format)!=null&&K.blockFullWidth?"100%":I.width,maxWidth:"100%"}}):r.jsx(I2,{className:R("w-full ",{"preview-file cursor-[zoom-in]":a||l}),onClick:W=>{(a||l)&&s({uuid:e.id,src:W.target.src})},blockId:e.id,srcSetParams:j,formatUrl:T,url:S,maxWidth:k,imageLink:D}),a&&!l&&!e.ownerBlockId&&r.jsx(sz,{blockId:t,onReplace:$,onDownload:()=>u(e.id),onAddComment:Xn(p,m.PermissionRole.COMMENTER)?()=>{h({blockId:e.id})}:void 0,externalLink:!1})]})]})})}),$4=()=>r.jsx("div",{className:"flex items-center animate-spin",children:r.jsx(V,{name:"IcNaviLoading",size:"middle",style:{fill:"white"}})}),zCe=fn.memo(e=>{var b,w;const t=(b=e.ownerBlockId)!=null?b:e.id,n=ye(e.id,["data"],["caption","width","link"]),{alwaysShowPlaceHolder:s,placeHolder:a}=sg(e.id),o=We(t),i=La(e.id,"caption"),{url:l}=bc(e.id),c=hc(e.id),{onRenderSize:d,changeSize:u,containerWidth:f,containerRef:h,isDisable:p,defaultBlockFullWidth:g,defaultWidth:_,defaultHeight:x,widthBreakPoints:F}=Nc({id:t,root:!1,fullPageContentWidth:!1});return Wg(h,e.id,"caption"),n?r.jsx(ia,{id:t,level:e.level,ref:h,className:"max-w-[380px]",children:r.jsxs("div",{className:"w-min px-3",children:[r.jsx(ui,{placeholder:a,uuid:e.id,alwaysShowPlaceholder:s,className:"whitespace-pre-wrap break-words",segments:n.data.caption,segmentType:"caption",onChange:(E,C,k)=>{i(E,[C,k])}}),r.jsxs(Ic,{fullHeight:!0,resizeWidth:!0,readonly:o||p,disableStyle:!_,defaultWidth:_!=null?_:0,defaultHeight:x,defaultBlockFullWidth:g,maxWidth:(w=n.data.width)!=null?w:uo,widthBreakPoints:F,minHeight:36,minWidth:36,onChange:u,onRenderSize:d,className:R("max-[520px]",p&&"pointer-events-none",ot.print&&"my-2.5"),children:[l&&r.jsx(Ij,{videoUrl:l,style:{width:f}}),(c==null?void 0:c.progress)&&r.jsxs("div",{className:"absolute flex items-center px-1.5 right-2.5 top-2.5 rounded-sm bg-black/75",children:[r.jsx($4,{}),r.jsxs("div",{className:"text-white text-t4",children:[c==null?void 0:c.progress,"%"]})]}),(n==null?void 0:n.data.link)&&r.jsx("div",{className:"absolute flex items-center top-2.5 right-2.5 bg-black/75 group-hover:opacity-100 opacity-0 rounded-sm",children:r.jsx(V,{size:"middle",className:"",name:"IcGlobeShare",style:{color:"white"}})})]})]})}):null}),qCe=y.memo(e=>{const t=ye(e.id,["data","local"],["display"]);if(!t)return null;switch(t.data.display){case"image":return r.jsx(V4,{id:t.uuid,level:e.level});case"file":return r.jsx(W6,{id:t.uuid,level:e.level});case"video":return r.jsx(zCe,{id:t.uuid,level:e.level});default:return r.jsx(W6,{id:t.uuid,level:e.level})}}),W6=y.memo(e=>{const t=fh(),n=ye(e.id,["data","local"],["segments","ossName","size","caption"]),s=La(e.id,"caption"),a=fe(n==null?void 0:n.data.segments),{extName:o}=rn(a),i=Ya(o),l=As(n==null?void 0:n.data.size),c=Sd(e.id),{alwaysShowPlaceHolder:d,placeHolder:u}=sg(e.id),f=We(e.id),h=y.useRef(null);Wg(h,e.id,"caption");const p=_=>{const x=pt();Jt.pdf.test(o)?window.open("/".concat(x?"share/":"preview/").concat(_)):t(_,e.ownerBlockId)};if(!n)return null;const g=r.jsxs(r.Fragment,{children:[r.jsx(Fn,{trigger:!1,className:"mr-1 self-center",blockId:e.id,iconSize:18,defaultIcon:r.jsx(V,{size:"middle",name:i})}),r.jsxs("div",{className:"flex max-w-full",children:[r.jsxs("div",{className:"relative w-full text-t1-medium text-ellipsis",children:[a,r.jsx("span",{className:"absolute bottom-px left-0 h-px bg-grey5 w-full"})]}),r.jsx("span",{className:"ml-2 text-t4 self-center mt-1 text-grey3 flex-shrink-0",children:l})]})]});return r.jsx(ia,{id:e.id,level:e.level,ref:h,children:r.jsxs("div",{className:"w-full px-3",children:[r.jsx(ui,{placeholder:u,uuid:e.id,alwaysShowPlaceholder:d,className:"whitespace-pre-wrap",segments:n.data.caption,segmentType:"caption",onChange:(_,x,F)=>{s(_,[x,F])}}),r.jsx("div",{className:R("pl-0.5 group leading-9 flex justify-between items-center h-9",{"animate-hover":c||f}),children:ot.print?r.jsx("a",{href:"".concat(window.location.origin,"/").concat(um(),"/").concat(e.id),className:"pr-10  text-ellipsis flex w-full cursor-pointer",children:g}):r.jsx("div",{className:R("preview-file pr-10 text-ellipsis flex w-full",{"cursor-pointer":c||f}),onClick:()=>{(c||f)&&p(e.id)},children:g})})]})})}),oz=y.memo(e=>{const t=y.useMemo(()=>ht(No(e.id)),[e.id]);return r.jsx(ia,{id:e.id,level:e.level,children:r.jsx(ui,{uuid:e.id,className:"whitespace-pre-wrap break-words",segments:t,readonly:!0})})}),GCe=fn.memo(e=>{const t=ye(e.id,["data"],["segments"]),n=hh(e.level),s=La(e.id),a=y.useMemo(()=>!fe(t==null?void 0:t.data.segments),[t==null?void 0:t.data.segments]),o=y.useRef(null),i=Kg(e.id,o,a,e.level),{paddingRight:l}=mh(e.id,e.level),c=Ce(d=>{const{blocks:u}=d;return t4(e.id,u)},[e.id]);return t?r.jsx(ia,{id:e.id,ref:o,className:"flex items-center",level:e.level,style:{paddingLeft:"12px",minWidth:i},children:r.jsx(L4,{symbolClassName:"mt-0",symbol:r.jsx("div",{className:"text-center inline-block dot mr-1.5",children:c}),editorNode:r.jsx(ui,{placeholder:n,uuid:e.id,className:"whitespace-pre-wrap break-words",segments:t.data.segments,onChange:(d,u,f)=>{s(d,[u,f])},style:{paddingRight:"".concat(l,"px")}})})}):null}),Nv=e=>{const{id:t,ownerBlockId:n,illegal:s,className:a}=e,o=!!y.useContext(jl),i=go(t),l=r.jsx("div",{className:"flex text-ellipsis",children:r.jsxs("div",{className:"relative w-full text-ellipsis",children:[s?Ts:e.title,r.jsx("span",{className:"absolute bottom-px left-0 h-px bg-grey5 w-full"})]})});return r.jsxs("div",{className:R("group relative py-1 flex items-center w-full px-0.5 text-t1-medium",{"max-w-[380px] pr-4":o,"animate-hover":e.onClick,className:a}),contentEditable:!1,onClick:e.onClick,children:[r.jsx(Fn,{trigger:!n,iconSize:20,className:"mr-1",tooltipClassName:"flex-shrink-0",hasOverlay:!!n,blockId:t,offset:[100,0],defaultIcon:r.jsx(_s,{uuid:t})}),ot.print?r.jsx(Fu,{to:i,children:l}):l]})},N2=e=>{const{blockType:t,desc:n,hasCover:s,title:a,small:o}=e;return r.jsxs("div",{className:R("w-[40%] overflow-hidden",o?"mt-3 ml-3 pr-3":"mt-6 ml-4 pr-2"),children:[r.jsx("div",{className:R("text-ellipsis text-t1-bold text-black break-words",{"text-white":s}),children:a||qt(t)}),r.jsx("div",{className:R("mt-1 text-t4 break-words text-black/60",{"text-white":s,"line-clamp-2":o}),children:n})]})},OF="text-t4 text-black/60 break-words mt-1 leading-5",j2=(e,t)=>{var o;const n=Ja(),s=Ce(i=>gI(e,i.blocks),[e]),a=(o=ye(s,["data"]))==null?void 0:o.data.segments;return y.useLayoutEffect(()=>{!WCe(e)&&t&&n(e)},[n,e,t]),a},WCe=e=>{if(tse[e])return!0;const n=J.blocks[e];return n==null?void 0:n.subNodes.some(s=>{const a=J.blocks[s];return!!(a&&!tn(a==null?void 0:a.type))})},KCe=e=>{const{id:t,ownerBlockId:n,illegal:s,showIcon:a,showCover:o,desc:i,isInColumn:l}=e,c=j2(e.id,!i);let d={};return l&&(d={"data-column-item-min-width":"256px"}),r.jsxs("div",{...d,className:R("overflow-hidden flex flex-col relative w-[256px] h-[184px] animate-hover",{"w-full":l}),onClick:e.onClick,children:[o&&r.jsx(Yg,{uuid:e.id,height:92,hiddenEditorButton:!0,className:"flex-shrink-0 w-full relative rounded-t"}),!o&&r.jsx("div",{className:"flex-shrink-0 w-full relative rounded-t border-l border-r border-t h-[92px]",style:zY}),a&&r.jsx(Fn,{tooltipClassName:"w-fit",trigger:!n,iconSize:40,className:"absolute left-2.5 top-[66px] w-10 h-10",hasOverlay:!!n,blockId:t,offset:[100,0],defaultIcon:r.jsx(_s,{uuid:t})}),r.jsxs("div",{className:"border-l border-r border-b rounded-b h-full pb-1 px-4 overflow-auto",children:[r.jsx("div",{className:"text-ellipsis text-t1 break-words flex-shrink-0 mt-3",children:s?Ts:e.title}),!s&&i&&r.jsx("div",{className:OF,style:{color:e.descColor},children:i}),!s&&!i&&c&&r.jsx(fs,{className:OF,segments:c})]})]})},ph=(e,t)=>{var i;const n=ye(e,["data"],["cover","coverPos","localUrl","size"]),[s,a]=y.useState((i=n==null?void 0:n.data.localUrl)!=null?i:""),o=y.useMemo(()=>{var c;const l=(c=n==null?void 0:n.data.cover)!=null?c:"";return f3(l)||l},[n==null?void 0:n.data.cover]);return y.useEffect(()=>{if(!s){if(Gu(o)){a(o);return}n!=null&&n.data.localUrl?a(n.data.localUrl):Vs.fetchImageUrl({blockId:e,ossName:o}).then(l=>{var u,f;const{extName:c}=rn(o),d=Math.max(Math.floor((f=(u=t==null?void 0:t.current)==null?void 0:u.getBoundingClientRect().width)!=null?f:100),800);if(Im.test(c)){const h=sm(l,d);a(Jo(h,c))}else a(Jo(l,c))})}},[o,n==null?void 0:n.data.localUrl,e,t,s]),s},gd=y.forwardRef((e,t)=>{var h;const{blockId:n,showCover:s,className:a,fillBgColor:o,...i}=e,l=y.useRef(null),c=ph(n,l),d=ye(n,["data"],["cover","coverPos","localUrl","size"]),u=(h=d==null?void 0:d.data.coverPos)!=null?h:50;let f={};return s&&(f={backgroundSize:"cover",backgroundImage:"url(".concat(c,")"),backgroundPosition:"center ".concat(u,"%"),backgroundRepeat:"no-repeat"}),y.useImperativeHandle(t,()=>l.current,[]),r.jsx("div",{ref:l,style:f,className:"w-full h-full relative rounded transition-all",...i,contentEditable:!1,children:r.jsx("div",{className:R("relative",a),style:{background:s?"linear-gradient(180deg, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0) 90%)":void 0},children:e.children})})}),YCe=e=>{const{id:t,ownerBlockId:n,illegal:s,showIcon:a,showCover:o,desc:i,isInColumn:l}=e,c=j2(e.id,!i),d=!!ph(t)&&o,u=!!ft(t,h=>h==null?void 0:h.backgroundColor)&&!d;let f={};return l&&(f={"data-column-item-min-width":"256px"}),r.jsxs(gd,{blockId:t,fillBgColor:u,showCover:d,...f,className:R("overflow-hidden flex flex-col relative w-[256px] h-[184px] animate-hover border",{"w-full":l}),onClick:e.onClick,children:[a&&r.jsx(Fn,{tooltipClassName:"w-fit mt-4",trigger:!n,iconSize:40,className:"left-2.5 w-10 h-10",hasOverlay:!!n,blockId:t,offset:[100,0],defaultIcon:r.jsx(_s,{uuid:t})}),r.jsxs("div",{className:"h-full pb-1 px-4 overflow-auto",children:[r.jsx("div",{className:R("text-ellipsis text-t1 break-words flex-shrink-0 mt-2",{"text-white":d||u}),children:s?Ts:e.title}),!s&&i&&r.jsx("div",{className:R(OF,{"text-white":d||u}),style:{color:e.descColor},children:i}),!s&&!i&&c&&r.jsx(fs,{className:R(OF,{"text-white":d||u}),segments:c})]})]})},H4=e=>{const t=J.blocks[e];return(t==null?void 0:t.type)===m.BlockType.COLLECTION_VIEW_PAGE?XCe(e):JCe(e)},XCe=e=>{const t=J.blocks[e];if(!t)return[];if(!t.data.schema)return[];const n=[],s=[];Object.keys(t.data.schema).forEach(i=>{var c;const l=(c=t.data.schema)==null?void 0:c[i];(l==null?void 0:l.type)===m.CollectionSchemaType.FILE&&s.push({id:i,schema:l})}),t.subNodes.forEach(i=>{const l=J.blocks[i];s.forEach(c=>{var u;const d=(u=l==null?void 0:l.data.collectionProperties)==null?void 0:u[c.id];d==null||d.forEach(f=>{f.url&&n.push(f.url)})})});const a={},o=[];return n.forEach(i=>{const l=QCe(i,{spaceId:t.spaceId,parentId:t.uuid});a[l.uuid]=l,o.push(l.uuid)}),re(Tn.update({blocks:a})),n.forEach(i=>{Vs.fetchImageUrl({blockId:t.uuid,ossName:i})}),o},QCe=(e,t)=>({uuid:qe(),spaceId:t.spaceId,parentId:t.parentId,type:m.BlockType.IMAGE,textColor:"",backgroundColor:"",status:m.BlockStatus.NORMAL,version:0,subNodes:[],permissions:[],createdAt:Date.now(),createdBy:"",data:{ossName:e},...fu()}),JCe=e=>{const t=J.blocks[e],n=[];return((t==null?void 0:t.type)===m.BlockType.FILE&&t.data.display==="image"&&t.data.ossName||(t==null?void 0:t.type)===m.BlockType.EXTERNAL_FILE&&t.data.display==="image"&&t.data.ossName||(t==null?void 0:t.type)===m.BlockType.REFERENCE&&t.data.display==="image")&&n.push(e),t==null||t.subNodes.forEach(s=>{const a=J.blocks[s];if(tn(a==null?void 0:a.type))return;const o=H4(s);n.push(...o)}),n},ed=({uuid:e})=>{const t=lx(e),n=ye(e,["subNodes"]),s=y.useRef(null);y.useLayoutEffect(()=>{var i;const o=(i=s.current)==null?void 0:i.querySelector("[data-block-id]");o&&o.setAttribute("style","margin-top:0px;margin-bottom:0px")},[]);const a=_j(n==null?void 0:n.type);return n?r.jsx("div",{ref:s,style:t,className:"flex w-full h-full pointer-events-none",children:r.jsx(a,{id:e})}):null},ZCe=e=>{const{id:t,illegal:n,showCover:s,desc:a,isInColumn:o}=e,i=!!ph(t)&&s,[l,c]=yc(),d=P0(t,l),u=ye(t,["subNodes","data"],["segments"]),f=y.useRef(null),h=y.useRef(),p=n?Ts:fe(u==null?void 0:u.data.segments),[g,_]=y.useState([]);let x={};return o&&(x={"data-column-item-min-width":"250px"}),y.useEffect(()=>{if(d)return;const F=H4(t);_(F)},[t,d]),y.useLayoutEffect(()=>{var w,E,C,k;if(!l||d)return;const F=(w=f.current)==null?void 0:w.querySelector(".footer");F instanceof HTMLElement&&(F.hidden=!0);const b=(k=(E=f.current)==null?void 0:E.querySelector("#".concat(Bm)))!=null?k:(C=f.current)==null?void 0:C.querySelector(".next-space-page");b instanceof HTMLElement&&b.childNodes.forEach(T=>{T instanceof HTMLElement&&T.setAttribute("style","padding-left:12px;padding-right:12px")})},[d,l]),a||o?r.jsxs(gd,{blockId:t,ref:F=>{c(F),F!=null&&(h.current=F)},showCover:s,...x,className:R("overflow-hidden flex relative w-[400px] h-[184px] animate-hover border",{"w-full":o}),onClick:F=>{var w;const b=window.getSelection();b&&b.isCollapsed&&((w=e.onClick)==null||w.call(e,F))},children:[r.jsx(N2,{title:p,blockType:u==null?void 0:u.type,desc:a,hasCover:i}),r.jsx(eke,{ids:g,className:"ml-4 mt-10"})]}):r.jsxs(gd,{blockId:t,ref:F=>{c(F),F!=null&&(h.current=F)},showCover:s,...x,className:R("overflow-hidden flex flex-col relative w-[240px] h-[184px] animate-hover border",{"w-full":o}),onClick:F=>{var w;const b=window.getSelection();b&&b.isCollapsed&&((w=e.onClick)==null||w.call(e,F))},children:[r.jsx("div",{className:R("text-ellipsis ml-4 mt-4 text-t1-bold text-black",{"text-white":i}),children:p||qt(u==null?void 0:u.type)}),r.jsx(tke,{ids:g,className:"ml-4 mt-4"})]})},eke=({ids:e,className:t})=>{const n=e[0],s=e[1],a=e[2];return r.jsx(Mo.Provider,{value:wt.ONLY_IMAGE,children:r.jsxs("div",{className:R("relative",t),children:[r.jsx("div",{className:Zh.id1,style:{...Kc},children:n&&r.jsx(ed,{uuid:n})}),r.jsx("div",{className:Zh.id2,style:{...Kc},children:s&&r.jsx(ed,{uuid:s})}),r.jsx("div",{className:Zh.id3,style:{...Kc},children:a&&r.jsx(ed,{uuid:a})})]})})},tke=({ids:e,className:t})=>{const n=e[0],s=e[1],a=e[2];return r.jsx(Mo.Provider,{value:wt.ONLY_IMAGE,children:r.jsxs("div",{className:R("relative",t),children:[r.jsx("div",{className:"absolute rounded-sm left-0 top-0 w-[150px] h-[100px] overflow-hidden",style:{...Kc,transform:"matrix(0.99, -0.12, 0.15, 0.99, 0, 0)",zIndex:3},children:n&&r.jsx(ed,{uuid:n})}),r.jsx("div",{className:"absolute rounded-sm left-[50px] top-[56px] w-[150px] h-[100px] overflow-hidden",style:{...Kc,transform:"matrix(0.97, -0.25, 0.31, 0.95, 0, 0)",zIndex:2},children:s&&r.jsx(ed,{uuid:s})}),r.jsx("div",{className:"absolute rounded-sm left-[104px] top-[22px] w-[150px] h-[100px] overflow-hidden",style:{...Kc,transform:"matrix(1, -0.07, 0.09, 1, 0, 0)",zIndex:1},children:a&&r.jsx(ed,{uuid:a})})]})})},nke=y.memo(e=>{const{id:t,illegal:n,showCover:s,desc:a,isInColumn:o}=e,i=!!ph(t)&&s,[l,c]=yc(),d=P0(t,l),u=ye(t,["data"],["segments"]),f=y.useRef(null),h=y.useRef(),{width:p}=ja(h.current,{type:"width"}),g=n?Ts:fe(u==null?void 0:u.data.segments);let _={};return o&&(_={"data-column-item-min-width":"250px"}),y.useLayoutEffect(()=>{var b,w,E,C;if(!l||d)return;const x=(b=f.current)==null?void 0:b.querySelector(".footer");x instanceof HTMLElement&&(x.hidden=!0);const F=(C=(w=f.current)==null?void 0:w.querySelector("#".concat(Bm)))!=null?C:(E=f.current)==null?void 0:E.querySelector(".next-space-page");F instanceof HTMLElement&&F.childNodes.forEach(k=>{k instanceof HTMLElement&&k.setAttribute("style","padding-left:12px;padding-right:12px")})},[d,l]),a?r.jsxs(gd,{blockId:t,ref:x=>{c(x),x!=null&&(h.current=x)},showCover:s,..._,className:R("overflow-hidden flex relative w-[400px] h-[184px] animate-hover border",{"w-full":o}),onClick:x=>{var b;const F=window.getSelection();F&&F.isCollapsed&&((b=e.onClick)==null||b.call(e,x))},children:[r.jsx(N2,{title:g,blockType:u==null?void 0:u.type,desc:a,hasCover:i}),r.jsx("div",{ref:f,className:"self-end mr-4 px-2.5 bottom-0 w-[75%] min-w-[188px] h-[70%] border-t border-l border-r overflow-hidden bg-white1",style:{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)"},children:r.jsx(Ec.Provider,{value:f,children:r.jsx(K6,{id:t})})})]}):r.jsxs(gd,{blockId:t,ref:x=>{c(x),x!=null&&(h.current=x)},showCover:s,..._,className:R("overflow-hidden flex flex-col relative w-[240px] h-[184px] animate-hover border",{"w-full":o}),onClick:x=>{var b;const F=window.getSelection();F&&F.isCollapsed&&((b=e.onClick)==null||b.call(e,x))},children:[r.jsx("div",{className:R("text-ellipsis ml-4 mt-4 text-t1-bold text-black",{"text-white":i}),children:g||qt(u==null?void 0:u.type)}),r.jsx("div",{ref:f,className:R("mt-4 w-[75%] min-w-[188px] h-[70%] border-t border-l border-r overflow-hidden bg-white1",{"self-end mr-4":p&&p>250,"ml-[55px]":p&&p<250}),style:{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)"},children:r.jsx(K6,{id:t})})]})}),K6=y.memo(e=>{const{id:t}=e;return r.jsx("div",{className:"zoom-03 w-[333%] overflow-hidden h-[500px] pointer-events-none",children:r.jsx(tM,{id:t})})}),z4=e=>r.jsxs("div",{className:R("flex p-[2px] disable-select",e.className),style:e.style,children:[e.customButton,r.jsx(Os,{title:"默认样式",className:"px-0",boxClassName:"px-0 py-0",icon:"IcMenuViewNormal",active:e.showType==="default",onClick:()=>{e.onClick("default")}}),r.jsx(Os,{title:"小卡片样式",className:"px-0 ml-0.5",boxClassName:"px-0 py-0",icon:"IcMenuViewCard",active:e.showType==="small",onClick:()=>{e.onClick("small")}}),r.jsx(Os,{title:"大卡片样式",className:"px-0 ml-0.5",boxClassName:"px-0 py-0",icon:"IcMenuViewPreview",active:e.showType==="large",onClick:()=>{e.onClick("large")}})]}),ske=e=>{var i;const t=ie(),n=Oe(),s=ft(e.blockId,l=>{var c;return(c=l==null?void 0:l.data.format)==null?void 0:c.cardFormat}),a=ye(e.blockId,["data"]);if(!a)return null;const o=(i=s==null?void 0:s.showType)!=null?i:"default";return r.jsx(z4,{showType:o,customButton:o!=="default"&&!e.illegal?r.jsx(Os,{title:"样式设置",className:"px-0 mr-0.5",boxClassName:"px-0 py-0",icon:"IcBtnEdit",onClick:l=>{t.dropdown({placement:"bottom",popcorn:ra(l.currentTarget),content:({onCloseModal:c})=>r.jsx(yH,{blockId:a.uuid,onClose:c})})}}):void 0,onClick:l=>{var c,d,u;l!==(s==null?void 0:s.showType)&&(me.event("page_card_style",{style_type:{showType:l,cardStyle:(u=(d=(c=a==null?void 0:a.data.format)==null?void 0:c.cardFormat)==null?void 0:d.cardStyle)!=null?u:"regular",isShowCover:s==null?void 0:s.isShowCover,isShowIcon:s==null?void 0:s.isShowIcon,cardCaption:!!(s!=null&&s.cardCaption)}}),n(()=>{var f;_e(e.blockId,{data:{format:{cardFormat:{...(f=a==null?void 0:a.data.format)==null?void 0:f.cardFormat,showType:l}}}})}))}})},rke=e=>{const{id:t,ownerBlockId:n,illegal:s,showIcon:a,showCover:o,desc:i}=e,l=j2(e.id,!i),c=!!y.useContext(jl);return r.jsxs("div",{className:R("flex justify-between items-center w-full h-[90px] animate-hover pl-3",{"min-w-[300px] max-w-[800px]":c,"border-l border-t border-b":o,border:!o}),contentEditable:!1,onClick:e.onClick,children:[r.jsxs("div",{className:"flex items-center overflow-hidden",children:[a&&r.jsx(Fn,{trigger:!n,iconSize:40,className:"mr-2",tooltipClassName:"flex-shrink-0",hasOverlay:!!n,blockId:t,offset:[100,0],defaultIcon:r.jsx(_s,{uuid:t})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-t1 h-6 overflow-hidden break-words line-clamp-1",children:s?Ts:e.title}),!s&&i&&r.jsx("div",{className:"text-t4 text-grey3 h-4 overflow-hidden pr-1 mt-1 break-words line-clamp-1",style:{color:e.descColor},children:i}),!s&&!i&&l&&r.jsx(fs,{className:R("text-t4 text-grey3 h-4 overflow-hidden pr-1 mt-1 line-clamp-1"),segments:l})]})]}),o&&r.jsx(Yg,{uuid:e.id,height:90,hiddenEditorButton:!0,className:"flex-shrink-0 relative rounded-r w-[30%]"})]})},ake=e=>{const{id:t,ownerBlockId:n,illegal:s,showIcon:a,showCover:o,desc:i}=e,l=j2(e.id,!i),c=!!y.useContext(jl),d=!!ph(t)&&o,u=!!ft(t,f=>f==null?void 0:f.backgroundColor)&&!d;return r.jsx(gd,{blockId:t,fillBgColor:u,showCover:o,className:R("flex justify-between items-center w-full h-[90px] animate-hover pl-3",{"min-w-[300px] max-w-[800px]":c,"border-l border-t border-b":o,border:!o}),onClick:e.onClick,children:r.jsxs("div",{className:"flex items-center overflow-hidden",children:[a&&r.jsx(Fn,{trigger:!n,iconSize:40,className:"mr-2",tooltipClassName:"flex-shrink-0",hasOverlay:!!n,blockId:t,offset:[100,0],defaultIcon:r.jsx(_s,{uuid:t})}),r.jsxs("div",{children:[r.jsx("div",{className:R("text-t1 h-6 overflow-hidden break-words line-clamp-1",{"text-white":d||u}),children:s?Ts:e.title}),!s&&i&&r.jsx("div",{className:R("text-t4 text-grey3 h-4 overflow-hidden pr-1 mt-1 break-words line-clamp-1",{"text-white":d||u}),style:{color:e.descColor},children:i}),!s&&!i&&l&&r.jsx(fs,{className:R("text-t4 text-grey3 h-4 overflow-hidden pr-1 mt-1 line-clamp-1",{"text-white":d||u}),segments:l})]})]})})},oke=e=>{const{id:t,illegal:n,showCover:s,desc:a,isInColumn:o}=e,i=!!ph(t)&&s,[l,c]=yc(),d=P0(t,l),u=ye(t,["subNodes","data"],["segments"]),f=y.useRef(null),h=y.useRef(),p=n?Ts:fe(u==null?void 0:u.data.segments),[g,_]=y.useState([]);let x={};return o&&(x={"data-column-item-min-width":"250px"}),y.useEffect(()=>{if(d)return;const F=H4(t);_(F)},[t,d]),y.useLayoutEffect(()=>{var w,E,C,k;if(!l||d)return;const F=(w=f.current)==null?void 0:w.querySelector(".footer");F instanceof HTMLElement&&(F.hidden=!0);const b=(k=(E=f.current)==null?void 0:E.querySelector("#".concat(Bm)))!=null?k:(C=f.current)==null?void 0:C.querySelector(".next-space-page");b instanceof HTMLElement&&b.childNodes.forEach(T=>{T instanceof HTMLElement&&T.setAttribute("style","padding-left:12px;padding-right:12px")})},[d,l]),r.jsxs(gd,{blockId:t,ref:F=>{c(F),F!=null&&(h.current=F)},showCover:s,...x,className:R("overflow-hidden flex relative w-full h-[90px] animate-hover border",{"w-full":o}),onClick:F=>{var w;const b=window.getSelection();b&&b.isCollapsed&&((w=e.onClick)==null||w.call(e,F))},children:[r.jsx(N2,{small:!0,title:p,blockType:u==null?void 0:u.type,desc:a,hasCover:i}),r.jsx(ike,{ids:g,className:R("ml-4 mt-4",{"absolute right-3 ml-0":!o})})]})},ike=({ids:e,className:t})=>{const n=e[0],s=e[1],a=e[2];return r.jsx(Mo.Provider,{value:wt.ONLY_IMAGE,children:r.jsxs("div",{className:R("relative w-[280px]",t),children:[r.jsx("div",{className:Zh.id1,style:{...Kc},children:n&&r.jsx(ed,{uuid:n})}),r.jsx("div",{className:Zh.id2,style:{...Kc},children:s&&r.jsx(ed,{uuid:s})}),r.jsx("div",{className:Zh.id3,style:{...Kc},children:a&&r.jsx(ed,{uuid:a})})]})})},lke=e=>{const{id:t,illegal:n,showCover:s,desc:a,isInColumn:o}=e,i=!!ph(t)&&s,[l,c]=yc(),d=P0(t,l),u=ye(t,["data"],["segments"]),f=y.useRef(null),h=y.useRef(),{width:p}=ja(h.current,{type:"width"}),g=n?Ts:fe(u==null?void 0:u.data.segments);let _={};return o&&(_={"data-column-item-min-width":"250px"}),y.useLayoutEffect(()=>{var b,w,E,C;if(!l||d)return;const x=(b=f.current)==null?void 0:b.querySelector(".footer");x instanceof HTMLElement&&(x.hidden=!0);const F=(C=(w=f.current)==null?void 0:w.querySelector("#".concat(Bm)))!=null?C:(E=f.current)==null?void 0:E.querySelector(".next-space-page");F instanceof HTMLElement&&F.childNodes.forEach(k=>{k instanceof HTMLElement&&k.setAttribute("style","padding-left:12px;padding-right:12px")})},[d,l]),a?r.jsxs(gd,{blockId:t,ref:x=>{c(x),x!=null&&(h.current=x)},showCover:s,..._,className:R("overflow-hidden flex relative w-full h-[90px] animate-hover border",{"w-full":o}),onClick:x=>{var b;const F=window.getSelection();F&&F.isCollapsed&&((b=e.onClick)==null||b.call(e,x))},children:[r.jsx(N2,{small:!0,title:g,blockType:u==null?void 0:u.type,desc:a,hasCover:i}),r.jsx("div",{ref:f,className:"self-end mr-4 px-2.5 bottom-0 w-[75%] min-w-[188px] h-[70%] border-t border-l border-r overflow-hidden bg-white1 pt-2",style:{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)"},children:r.jsx(Fm.Provider,{value:!1,children:r.jsxs("div",{className:"h-full zoom-03 pointer-events-none",children:[r.jsx("div",{className:R("text-ellipsis cursor-text ml-4 text-h0 text-black",{"text-grey3":!g}),children:g||qt(u==null?void 0:u.type)}),r.jsx(yT,{pageId:t,loading:d})]})})})]}):r.jsxs(gd,{blockId:t,ref:x=>{c(x),x!=null&&(h.current=x)},showCover:s,..._,className:R("overflow-hidden flex flex-col relative w-full h-[90px] animate-hover border",{"w-full":o}),onClick:x=>{var b;const F=window.getSelection();F&&F.isCollapsed&&((b=e.onClick)==null||b.call(e,x))},children:[r.jsx("div",{className:R("ml-4 mt-3 text-t1-bold text-black whitespace-pre-wrap",{"text-white":i}),children:g||qt(u==null?void 0:u.type)}),r.jsx("div",{ref:f,className:R("w-[75%] min-w-[188px] h-[130px] border-t border-l border-r overflow-hidden bg-white1 pt-2",{"self-end mr-4":p&&p>250,"ml-[55px]":p&&p<250}),style:{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)"},children:r.jsx(Fm.Provider,{value:!1,children:r.jsxs("div",{className:"h-full zoom-03 pointer-events-none",children:[r.jsx("div",{className:R("cursor-text ml-4 text-h0 text-black break-words",{"text-grey3":!g}),children:g||qt(u==null?void 0:u.type)}),r.jsx(yT,{pageId:t,loading:d})]})})})]})};try{sM(HU)}catch(e){}const cke={regular:"regular",fill:"fill",thumbnailPage:"thumbnailPage",thumbnailImage:"thumbnailImage",horizontalRectangle:"regular",smallVerticalRectangle:"regular"},iz=y.memo(({id:e,ownerBlockId:t})=>{var E,C,k;const n=ye(e,["data"],["segments"]),s=ft(t!=null?t:e,T=>{var v;return(v=T==null?void 0:T.data.format)==null?void 0:v.cardFormat}),a=t&&!n,{illegal:o,role:i}=mt(e),l=ys(),c=y.useRef(),d=lx(e),u=ft(e,T=>T==null?void 0:T.data.cover),f=lt(),h=Bw(),p=Un(),g=y.useMemo(()=>Xu(t!=null?t:e,f),[t,e,f]),_=a?"无法访问":r.jsx(yl,{uuid:(E=n==null?void 0:n.uuid)!=null?E:""}),x=(C=s==null?void 0:s.isShowIcon)!=null?C:!0,F=!!u&&((k=s==null?void 0:s.isShowCover)!=null?k:!0),b=T=>{l(e,{forceOpenInRight:T.altKey,forceOpenNewTab:T.ctrlKey||T.metaKey})},w=y.useMemo(()=>{const T=(s==null?void 0:s.showType)==="default"||(s==null?void 0:s.showType)===void 0||p===wt.PAGE_LITE_PREVIEW,v=s!=null&&s.cardStyle?cke[s.cardStyle]:"regular",I=(s==null?void 0:s.showType)==="large";let j;if(T)j=Nv;else switch(v){case"regular":j=I?KCe:rke;break;case"fill":j=I?YCe:ake;break;case"thumbnailPage":j=I?nke:lke;break;case"thumbnailImage":j=I?ZCe:oke;break;default:j=Nv}return j},[s==null?void 0:s.cardStyle,s==null?void 0:s.showType,p]);return!n&&!a?null:i===Tk.PermissionRole.NONE?r.jsx(eE,{id:e}):r.jsx(bg,{extendsStore:!0,wait:1e3,waitMode:"debounce",children:r.jsx(Cs,{popupClassName:"bg-white2",placement:"top-end",className:R("w-full",{"overflow-hidden max-w-full":(s==null?void 0:s.showType)==="large","w-fit":(s==null?void 0:s.showType)==="large"&&!g}),popup:!pt()&&r.jsx(ske,{blockId:t!=null?t:e,illegal:o}),style:{lineHeight:"36px"},children:r.jsx(Fe,{interactive:!0,placement:"top",lazyLoad:!0,theme:"next-modal",maxWidth:1e4,delay:1e3,className:"w-full",disabled:h,popup:r.jsx(Du,{pageId:e,isLink:!!t,onCloseOutsideModel:()=>{var T;(T=c.current)==null||T.hide()}}),children:r.jsx(w,{id:e,showCover:F,showIcon:x,title:_,isInColumn:g,ownerBlockId:t,onClick:b,illegal:o,desc:s==null?void 0:s.cardCaption,descColor:d.color})})})})}),td=fn.memo(e=>{var s;const t=(s=e.ownerBlockId)!=null?s:e.id;return ye(e.id,[])?r.jsx(ia,{id:t,className:"py-0 bg-transparent",level:e.level,children:r.jsx(iz,{id:e.id,ownerBlockId:e.ownerBlockId})}):null}),dke=y.memo(e=>{const t=ye(e.id,["data"],["segments"]),n=hh(e.level),s=La(e.id),a=y.useMemo(()=>!fe(t==null?void 0:t.data.segments),[t==null?void 0:t.data.segments]),o=y.useRef(null),i=Kg(e.id,o,a,e.level),{paddingLeft:l,paddingRight:c}=mh(e.id,e.level);return t?r.jsx(ia,{id:e.id,ref:o,level:e.level,style:{paddingLeft:"".concat(l,"px"),minWidth:i},children:r.jsx("div",{className:"pl-2 border-l-4 border-solid border-current",children:r.jsx(ui,{placeholder:n,uuid:e.id,className:"whitespace-pre-wrap break-words",segments:t.data.segments,onChange:(d,u,f)=>{s(d,[u,f])},style:{paddingRight:"".concat(c,"px")}})})}):null}),q4=fn.memo(e=>{var s,a;const t=ye(e.id,["data"],["ref","display"]);if(!t)return null;let n=()=>r.jsx(r.Fragment,{});switch(t.data.display){case"image":{n=V4;break}case"file":{n=td;break}case"linkPage":{n=td;break}}return(t.type===m.BlockType.REFERENCE_COLLECTION||t.type===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(n=td),r.jsx(n,{id:(a=(s=t.data.ref)==null?void 0:s.uuid)!=null?a:"",level:e.level,ownerBlockId:e.id})}),uke=fn.memo(e=>{var u;const t=ft(e.id,f=>{var h;return(h=f==null?void 0:f.data.segments)!=null?h:[]}),n=y.useRef(null),s=hh(e.level),a=La(e.id),o=yr(),{paddingLeft:i,paddingRight:l}=mh(e.id,e.level),c=y.useRef((u=o.current)==null?void 0:u.style.cursor),d=tg();return Wg(n,e.id),qg(n,{onResize:f=>{var h,p;if(!(!o.current||!n.current)&&!d)switch(f.resizeStatus){case aa.START:if(c.current=(h=o.current)==null?void 0:h.style.cursor,document.activeElement&&document.activeElement.closest("[data-block-id='".concat(e.id,"']")))return!0;break;case aa.RESIZING:n.current.style.cursor="grabbing",o.current.scrollBy(-f.deltaX,-f.deltaY);break;case aa.END:{n.current.style.cursor=(p=c.current)!=null?p:"";break}}},dispatchEvent:!0}),r.jsx(ia,{ref:n,id:e.id,level:e.level,className:"mind-map-root-node",children:r.jsx(ui,{placeholder:s,uuid:e.id,className:"whitespace-pre-wrap break-words",segments:t,onChange:(f,h,p)=>{a(f,[h,p])},style:{paddingLeft:"".concat(i,"px"),paddingRight:"".concat(l,"px")}})})}),fke=()=>{const e=Oe();return y.useCallback(()=>{const{chosenCells:t}=J.simpleTable,{tableId:n,recordId:s,propertyId:a}=t!=null?t:{};if(!n)return;const o=J.blocks[n];if(!o)return null;const{subNodes:i}=o;ol(s)||e(()=>{const l=J.blocks[s];l&&ut({type:m.BlockType.TABLE_ROW,textColor:l.textColor,backgroundColor:l.backgroundColor,data:l.data},{parentId:n,after:s})}),ol(a)||e(()=>{var g,_,x;const l=(g=o.data.format)!=null?g:{},c=(_=l.tableBlockColumnOrder)!=null?_:[],d=qe(),u=c.indexOf(a),f={...l,tableBlockColumnOrder:[...c.slice(0,u+1),d,...c.slice(u+1)]},h=(x=l.tableBlockColumnFormat)!=null?x:{},p=h[a];p&&(f.tableBlockColumnFormat={...h,[d]:p}),_e(n,{data:{format:f}}),i.forEach(F=>{var E;const b=J.blocks[F],w=(E=b==null?void 0:b.data.collectionProperties)==null?void 0:E[a];w&&_e(F,{data:{collectionProperties:{...b.data.collectionProperties,[d]:w}}})})})},[e])},G4=e=>{const{subNodes:t=[],tableBlockColumnOrder:n=[],tableBlockRanges:s=[]}=ft(e,a=>{if(!a)return{};const{format:o}=a.data;return o?{subNodes:a.subNodes,tableBlockRanges:o.tableBlockRanges,tableBlockColumnOrder:o.tableBlockColumnOrder}:{}});return{subNodes:t,tableBlockRanges:s,tableBlockColumnOrder:n}},lz=e=>{const{subNodes:t,tableBlockColumnOrder:n,tableBlockRanges:s}=G4(e);return y.useMemo(()=>s.reduce((a,{start:o,end:i})=>{if(!o||!i)return a;const[l,c]=o,[d,u]=i;if(!l||!c||!d||!u)return a;const f=t.indexOf(l),h=n.indexOf(c),p=t.indexOf(d),g=n.indexOf(u);return a.push([[f,h],[p,g]]),a},[]),[t,n,s])},cz=e=>Ce(({ui:n,blocks:s})=>{var c,d;const a=s[e];if(!a)return!0;const o=n.selectedCells[0],i=(d=(c=a.data.format)==null?void 0:c.tableBlockColumnOrder)!=null?d:[],{subNodes:l}=a;return l.some(u=>u===(o==null?void 0:o.recordId))&&i.some(u=>u===(o==null?void 0:o.propertyId))},[e],{obsSimpleTable:!0,obsSelectCell:[{all:!0}]}),mke=(e,t,n,s)=>{const a=Oe(),o=Nn(),i=y.useCallback(function*(f){var h;yield*pf(Object.values((h=f.data.collectionProperties)!=null?h:{}))},[]),l=y.useRef(),c=y.useRef(zc),d=y.useMemo(()=>Ps(f=>{var _,x;const h=l.current,p=pe().blocks[t];if(!h||!p)return;if(c.current<zc){c.current=zc;return}const g=(x=(_=p.data.collectionProperties)==null?void 0:_[n])!=null?x:[];a(()=>{re(sr({init(){_e(t,{data:{collectionProperties:{...p.data.collectionProperties,[n]:g}}}),lu(t,i)},redo(){_e(t,{data:{collectionProperties:{...p.data.collectionProperties,[n]:g}}}),re(at.update({selectedCells:[{recordId:t,propertyId:n,viewId:e}]})),lu(t,i);const F=o(s,!0);F.performChange(b=>{b.select(f)}),F.requestFocus()},undo(){var b;_e(t,{data:{collectionProperties:{...p.data.collectionProperties,[n]:(b=h.segments)!=null?b:[]}}}),re(at.update({selectedCells:[{recordId:t,propertyId:n,viewId:e}]})),lu(t,i);const F=o(s,!0);F.performChange(w=>{w.select(h.offset)}),F.requestFocus()}}))}),l.current=void 0},500,{leading:!1}),[t,n,a,i,e,o,s]),u=(f,h)=>{var x,F,b,w;const g=(F=(x=o(s,!0).selection)==null?void 0:x.offset)!=null?F:0;c.current=zc;const _=pe().blocks[t];if(_){if(!l.current)if(h){const[E,C]=h;l.current={segments:mr(E),offset:(b=C==null?void 0:C.offset)!=null?b:0}}else{const E=(w=_.data.collectionProperties)==null?void 0:w[n];l.current=E?{segments:E,offset:g}:{segments:void 0,offset:0}}re(Sn({ignoreOp:!0,uuid:t,patch:{data:{collectionProperties:{..._.data.collectionProperties,[n]:f!=null?f:[]}}}})),lu(t,i,a),d(g)}};return y.useCallback(u,[o,s,t,n,i,a,d])},hke=()=>{const e=Oe();return y.useCallback(()=>{e(()=>{J.ui.selectedCells.forEach(t=>{var s;const n=J.blocks[t.recordId];if(n){const{[t.propertyId]:a,...o}=(s=n.data.collectionProperties)!=null?s:{};_e(t.recordId,{data:{...n.data,collectionProperties:o}})}})})},[e])},pke=({type:e,onCloseModal:t,tableId:n,isFirstColumn:s,isFirstRow:a,recordId:o,propertyId:i})=>{var k,T,v,I,j;const l=ye(n,["data","subNodes","updatedBy","updatedAt"]),c=Oe(),d=hke(),u=fke(),{selectedBlockHistory:f}=Nl(),h=Pi((k=l==null?void 0:l.updatedBy)!=null?k:"");if(!l)return null;const{subNodes:p}=l,g=(T=l.data.format)!=null?T:{},_=(v=g.tableBlockColumnOrder)!=null?v:[],x=(I=g.tableBlockRanges)!=null?I:[],F=S=>{var A;if(i)return i;const D=IF(_,"propertyId")(S);return(A=_[D])!=null?A:""},b=S=>{var A;if(o)return o;const D=IF(p,"recordId")(S);return(A=p[D])!=null?A:""},w=(S,D=!1)=>{const A=_.indexOf(F(D)),P=D?A+1:A;return[..._.slice(0,P),S,..._.slice(P)]},E=[],{selectedCells:C}=J.ui;if(C.length){const S=C.map(L=>L.recordId),D=C.map(L=>L.propertyId),A=({start:L})=>{if(!L)return!1;const[O,$]=L;return!O||!$?!1:S.includes(O)&&D.includes($)},P=x.some(A);P&&E.push({type:H.OPERATION,data:{title:"拆分单元格",icon:"IcMenuSplitCells",onClick:()=>{me.event("simpletable_merge_cell",{openclose:"close"});const L=x.reduce((O,{start:$,end:M})=>{if(!$||!M)return O;const[U,z]=$;return!U||!z||S.includes(U)&&D.includes(z)||O.push({start:$,end:M}),O},[]);c(()=>{_e(n,{data:{format:{tableBlockRanges:L}}}),f([])}),t()}}}),C.length>1&&E.push({type:H.OPERATION,data:{title:"合并单元格",icon:"IcMenuMergeCells",onClick:()=>{const L=ll(S),O=ll(D),$=An(S),M=An(D);!L||!O||!$||!M||(me.event("simpletable_merge_cell",{openclose:"open"}),c(()=>{var W,Y;_e(n,{data:{format:{tableBlockRanges:[...x.filter(G=>!A(G)),{start:[L,O],end:[$,M]}]}}});const U=[],z=C.reduce((G,ee)=>{var de;const{recordId:te,propertyId:Q}=ee,ne=J.blocks[te];if(!ne)return G;const{collectionProperties:se={}}=ne.data,ce=se[Q];if(!ce)return G;ce.forEach(ke=>{var Te;(Te=ke.discussions)==null||Te.forEach(he=>U.push(he))}),_e(te,{data:{collectionProperties:kn(se,Q)},discussions:((de=ne.discussions)!=null?de:[]).filter(ke=>!U.includes(ke))});const ae=An(G);return ae?G.slice(0,-1).concat({...ae,text:"".concat(ae.text,"\n")},ce):G.concat(ce)},[]),K=J.blocks[L];K&&_e(L,{data:{collectionProperties:{...(W=K.data.collectionProperties)!=null?W:{},[O]:z}},discussions:((Y=K.discussions)!=null?Y:[]).concat(U)}),f([])}),t())}}}),(P||C.length>1)&&E.push({type:H.LINE})}return e!=="contextmenu"&&E.push({type:H.OPERATION,data:{icon:"IcColor",title:"颜色",hasArrow:!0,renderSubMenu:()=>r.jsx(Kw,{items:H0,onColorSelect:S=>{t(),c(()=>{var D,A;if(e==="row"){const{textColor:P,backgroundColor:L,...O}=g,$=S.isBgColor?{...O,backgroundColor:S.colorkey}:{...O,textColor:S.colorkey};_e(b(),{data:{format:$}})}if(e==="column"){const P=(A=(D=g.tableBlockColumnFormat)==null?void 0:D[F()])!=null?A:{},{textColor:L,backgroundColor:O,...$}=P,M=S.isBgColor?{...$,backgroundColor:S.colorkey}:{...$,textColor:S.colorkey};_e(n,{data:{format:{tableBlockColumnFormat:{...g.tableBlockColumnFormat,[F()]:M}}}})}})}})}}),e!=="column"&&(E.push({type:H.OPERATION,data:{title:"向上边插入行",icon:"IcArrowUp02",onClick:()=>{me.event("simpletable_add"),t(),c(()=>{ut({type:m.BlockType.TABLE_ROW},{parentId:n,before:b()})})}}}),E.push({type:H.OPERATION,data:{title:"向下边插入行",icon:"IcArrowDown02",onClick:()=>{me.event("simpletable_add"),t(),c(()=>{ut({type:m.BlockType.TABLE_ROW},{parentId:n,after:b(!0)})})}}})),e!=="row"&&(E.push({type:H.OPERATION,data:{title:"向左侧插入列",icon:"IcMenuInsertLeft",onClick:()=>{me.event("simpletable_add"),t();const S=qe();c(()=>{_e(n,{data:{format:{tableBlockColumnOrder:w(S)}}})})}}}),E.push({type:H.OPERATION,data:{title:"向右侧插入列",icon:"IcMenuInsertRight",onClick:()=>{me.event("simpletable_add"),t();const S=qe();c(()=>{_e(n,{data:{format:{tableBlockColumnOrder:w(S,!0)}}})})}}})),e!=="contextmenu"&&E.push({type:H.OPERATION,data:{title:"拷贝副本",icon:"IcDuplicate",rightText:"".concat(Ds,"+D"),onClick:()=>{t(),u()}}}),E.push({type:H.LINE}),E.push({type:H.OPERATION,data:{title:"清空内容",icon:"IcTrash",onClick:()=>{t(),e==="row"&&c(()=>{_e(b(),{backgroundColor:"",textColor:"",data:{collectionProperties:{}}})}),e==="column"&&c(()=>{l.subNodes.forEach(S=>{var A;const D=J.blocks[S];if(D){const{[F()]:P,...L}=(A=D.data.collectionProperties)!=null?A:{};_e(S,{data:{collectionProperties:L}})}})}),e==="contextmenu"&&d(),UC()}}}),e!=="column"&&E.push({type:H.OPERATION,data:{title:"删除所选行",icon:"IcTrash",onClick:()=>{t(),c(()=>{if(p.length===1)Ro(n);else{const{selectedCells:S}=J.ui;if(S.length){gr(S.map(A=>A.recordId));const D=x.filter(A=>{const{start:P}=A;if(!P)return!1;const[L,O]=P;return!S.some($=>L===$.recordId&&O===$.propertyId)});D.length!==x.length&&_e(n,{data:{format:{tableBlockRanges:D}}})}else{const D=b();Ro(D);const A=p.indexOf(D),P=x.filter(L=>{const{start:O,end:$}=L;if(!O||!$)return!1;const[M]=O,[U]=$;return!(M===D&&U===D)});_e(n,{data:{format:{tableBlockRanges:P.map(L=>{const{start:O,end:$}=L;if(!O||!$)return L;const[M,U]=O,[z,K]=$;return M===D?{...L,start:[p[A+1],U]}:z===D?{...L,end:[p[A-1],K]}:L})}}})}}}),UC()}}}),e!=="row"&&E.push({type:H.OPERATION,data:{title:"删除所选列",icon:"IcTrash",onClick:()=>{t(),c(()=>{var S,D,A;if(((S=g.tableBlockColumnOrder)==null?void 0:S.length)===1)Ro(n);else{const{selectedCells:P}=J.ui,L=P.length?P.map(O=>O.propertyId):[i!=null?i:""];if(P.length){const O=x.filter($=>{const{start:M}=$;if(!M)return!1;const[U,z]=M;return!P.some(K=>U===K.recordId&&z===K.propertyId)});O.length!==x.length&&_e(n,{data:{format:{tableBlockRanges:O}}})}else{const O=x.filter(M=>{const{start:U,end:z}=M;if(!U||!z)return!1;const[,K]=U,[,W]=z;return!(K===i&&W===i)}),$=(D=_.indexOf(i!=null?i:""))!=null?D:-1;$>-1&&_e(n,{data:{format:{tableBlockRanges:O.map(M=>{const{start:U,end:z}=M;if(!U||!z)return M;const[K,W]=U,[Y,G]=z;return W===i?{...M,start:[K,_[$+1]]}:G===i?{...M,end:[Y,_[$-1]]}:M})}}})}_e(n,{data:{format:{tableBlockColumnFormat:kn((A=g.tableBlockColumnFormat)!=null?A:{},L),tableBlockColumnOrder:_.filter(O=>!L.includes(O))}}}),l.subNodes.forEach(O=>{var M;const $=J.blocks[O];$&&_e(O,{data:{collectionProperties:kn((M=$.data.collectionProperties)!=null?M:{},L)}})})}}),UC()}}}),E.push({type:H.LINE}),a&&(E.unshift({type:H.LINE}),E.unshift({type:H.TEXT_SWITCH,data:{title:"标题行",switch:g.tableBlockRowHeader,icon:"IcTableHeaderRow",noCancelSelected:!0,onSwitch:S=>{me.event("simpletable_titlerow",{openclose:S?"open":"close"}),c(()=>{_e(n,{data:{format:{tableBlockRowHeader:S}}})})}}})),s&&(E.unshift({type:H.LINE}),E.unshift({type:H.TEXT_SWITCH,data:{title:"标题列",switch:g.tableBlockColumnHeader,icon:"IcTableHeaderColumn",noCancelSelected:!0,onSwitch:S=>{me.event("simpletable_titlecolumn",{openclose:S?"open":"close"}),c(()=>{_e(n,{data:{format:{...g,tableBlockColumnHeader:S}}})})}}})),r.jsx(ze,{className:"py-[5px] rounded-r w-60 next-modal",items:E,customFooter:r.jsx(Zm,{name:Rn((j=h==null?void 0:h.uuid)!=null?j:""),updatedAt:l.updatedAt,isByAI:l.data.isByAI})})},Y6=({propertyId:e,rowIndex:t,columnIndex:n,isRowHandle:s})=>{const{recordId:a,tableId:o}=u2(),i=s||t!==0&&n===0,l=Ce(({simpleTable:p})=>{const{activityTableId:g,hoveringCell:_}=p;return!_||o!==g?!1:i?_.rowIndex===t:_.columnIndex===n},[t,n],{obsSimpleTable:!0}),{isSelected:c,isDragging:d,isSelecting:u}=Ce(({simpleTable:p})=>({isSelected:(()=>{const{chosenCells:_}=p;return!_||_.tableId!==o?!1:i?_.recordId===a:_.propertyId===e})(),isDragging:!!p.draggingStart,isSelecting:!!p.selecting}),[o,e,a],{obsSimpleTable:!0}),f=y.useRef(),h=ie();return u||(i?n>0:t>0)||!l&&!c?null:r.jsx("div",{ref:f,"data-disable-select":!0,"data-no-cancel-selected":!0,onClick:()=>{h.dropdown({modalId:EZ,popcorn:f.current,placement:"bottom-start",offset:[16,-2],content({onCloseModal:p}){return r.jsx(pke,{type:i?"row":"column",recordId:a,propertyId:e,isFirstRow:!!s,isFirstColumn:n===0&&t===0&&!s,tableId:o,onCloseModal:()=>p()})}})},onMouseDown:p=>{p.stopPropagation(),re(at.update({selectedCells:[],selectedBlocks:[]})),re(Ns.update({activityTableId:o,chosenCells:i?{tableId:o,recordId:a}:{tableId:o,propertyId:e}}))},className:R("table-handle shadow-button absolute z-10",i?"top-1/2 -left-2.5 -mt-[13px]":"-top-[13px] left-1/2 -ml-2 rotate-90",c?"table-selector bg-black dark:bg-grey6":"bg-white1 hover:bg-grey8",d&&"opacity-0"),children:r.jsx(Fe,{placement:"top",offset:[0,8],popup:r.jsxs("div",{className:"py-1 px-2 text-center font-semibold",children:[r.jsx("div",{children:"长按拖拽"}),r.jsx("div",{children:"点击打开菜单"})]}),children:r.jsx(V,{name:"IcMenu",className:R(c?"text-white":"text-grey4"),size:"xxsmall"})})})},dz=y.memo(({propertyId:e,rowIndex:t,columnIndex:n,span:s})=>{var T;Pa();const{recordId:a,tableId:o,indexRanges:i}=u2(),l=rr(qe),c=af(l),d=Ks(),u=ye(a,["data"],["format"]),f=Km(a,e),h=ft(o,v=>{var I,j;return(j=(I=v==null?void 0:v.data.format)==null?void 0:I.tableBlockColumnFormat)==null?void 0:j[e]}),p=mke(o,a,e,c),g=ft(o,v=>{const I=v==null?void 0:v.data.format,j=(I==null?void 0:I.tableBlockRowHeader)&&t===0,S=(I==null?void 0:I.tableBlockColumnHeader)&&n===0;return j||S},[t,n]),_=Ce(({ui:{selectedCells:v}})=>v.some(I=>I.recordId===a&&I.propertyId===e),[a,e,o],{obsSelectCell:[{recordId:a,propertyId:e,viewId:o}]}),{isFocus:x,hidden:F}=Ce(({simpleTable:v})=>{const{activityTableId:I,draggingStart:j,chosenCells:S,focus:D}=v;return{isFocus:I===o&&D,hidden:I===o&&j&&((S==null?void 0:S.recordId)===a||(S==null?void 0:S.propertyId)===e)}},[o],{obsSimpleTable:!0}),b=We(o),w=ft(o,v=>{var P,L,O,$,M,U;const I=(P=v==null?void 0:v.subNodes)!=null?P:[],j=(L=v==null?void 0:v.data.format)!=null?L:{},S=(O=j==null?void 0:j.tableBlockColumnFormat)!=null?O:{};let D=(M=($=S[e])==null?void 0:$.width)!=null?M:vF;const A=i.find(([z,K])=>z[0]===0&&K[0]===I.length-1&&z[1]===n&&K[1]!==n);if(A){const[z,K]=A,W=z[1],Y=K[1];((U=j.tableBlockColumnOrder)!=null?U:[]).slice(W+1,Y+1).forEach(ee=>{var te,Q;D+=(Q=(te=S[ee])==null?void 0:te.width)!=null?Q:vF})}return D},[n,e],{waitMode:"throttle"}),E=Oe(),C=(T=u==null?void 0:u.data.format)!=null?T:{},k=y.useMemo(()=>{const v={width:w},I=tr(h==null?void 0:h.textColor),j=tr(C==null?void 0:C.textColor),S=cs(h==null?void 0:h.backgroundColor),D=cs(C==null?void 0:C.backgroundColor);return I?v.color=I:S?v.backgroundColor=S:j?v.color=j:D&&(v.backgroundColor=D),v},[h==null?void 0:h.backgroundColor,h==null?void 0:h.textColor,C==null?void 0:C.backgroundColor,C==null?void 0:C.textColor,w]);return u?r.jsxs("td",{"data-table-row-id":a,"data-table-row-index":t,"data-table-column-index":n,className:R("relative border border-grey6 break-words p-2 transition-all ease-out",g?"text-t2-medium bg-grey8":"text-t2",_&&x&&"focused-table-cell"),style:k,...s,onMouseDown:v=>{v.stopPropagation();const I=v.button===IZ;if(I){if(Co(!0),_)return}else v.target.tagName==="TD"&&Lr(c,v.clientX,v.clientY);re(at.update({selectedCells:[{recordId:a,propertyId:e,viewId:o,syncId:d}]})),re(Ns.update({activityTableId:o,focus:!I,chosenCells:void 0,selecting:{tableId:o,columnIndex:n,rowIndex:t}}));const j=()=>{re(Ns.update({selecting:void 0})),document.removeEventListener("mouseup",j)};document.addEventListener("mouseup",j)},onMouseEnter:()=>{var K;const{selecting:v}=J.simpleTable;if(!v||v.tableId!==o)return;const I=J.blocks[o];if(!I)return;Co(!0);const{subNodes:j,data:S}=I,{tableBlockColumnOrder:D=[]}=(K=S.format)!=null?K:{},A=[v.rowIndex,v.columnIndex],P=[t,n];let L=i;const O=()=>{for(const W of L)aY.boxBox(Math.min(A[1],P[1]),Math.min(A[0],P[0]),Math.abs(P[1]-A[1])+1,Math.abs(P[0]-A[0])+1,W[0][1],W[0][0],Math.abs(W[0][1]-W[1][1])+1,Math.abs(W[0][0]-W[1][0])+1)&&(L=L.filter(G=>G!==W),A[0]=Math.min(W[0][0],A[0],t),A[1]=Math.min(W[0][1],A[1],n),P[0]=Math.max(W[1][0],P[0],v.rowIndex),P[1]=Math.max(W[1][1],P[1],v.columnIndex),O())};i.length&&O();const $=(W,Y,G)=>{const ee=Math.min(G,Y),te=Math.max(G,Y);return W.slice(ee,te+1)},M=$(j,P[0],A[0]),U=$(D,P[1],A[1]),z=[];for(const W of M)for(const Y of U)z.push({recordId:W,propertyId:Y,viewId:o,syncId:d});re(at.update({selectedCells:z})),re(Ns.update({focus:!1}))},onKeyDown:v=>{if(Ie(["Backspace","Delete"],{byKey:!0})(v)){v.stopPropagation();return}if(Ie("Shift+Enter")(v)){v.preventDefault();const I=Xa(c);I==null||I.performChange(j=>{j.delete().insert("\n")});return}if(Ie("Enter")(v)){v.preventDefault(),v.stopPropagation();const I=J.blocks[o];if(!I)return;const{subNodes:j}=I;if(t+1>=j.length)E(()=>{const S=ut({},{parentId:I.parentId,after:o});re(sr({init(){$u("cell"),setTimeout(()=>Lr(S,1/0,1/0))},redo(){$u("cell")},undo(){re(at.update({selectedCells:[{recordId:a,propertyId:e,viewId:o,syncId:d}]})),Lr(c,1/0,1/0)}}))});else{const S=j[t+1];if(S){re(at.update({selectedCells:[{recordId:S,propertyId:e,viewId:o,syncId:d}]}));const D=Kd(o,t+1,n);Lr(D,1/0,1/0)}}}},children:[F&&r.jsx("div",{className:R("w-full h-full bg-white1 absolute left-0 top-0",g&&"!bg-grey8")}),_&&!x&&r.jsx("div",{className:"w-full h-full absolute left-0 top-0 bg-grey6/30 pointer-events-none"}),r.jsx(yd,{scope:YM,initialValues:[[XM,a]],children:r.jsx(ci,{realBlockId:a,readonly:b,uuid:l,className:"whitespace-break-spaces",segments:f,keydownOption:Uu,onChange:(v,I,j)=>{p(v,[I,j])},history:!1,comments:!0})}),!b&&(n===0||t===0)&&r.jsx(Y6,{rowIndex:t,columnIndex:n,propertyId:e}),!b&&t===0&&n===0&&r.jsx(Y6,{isRowHandle:!0,rowIndex:t,columnIndex:n,propertyId:e})]}):null},yn),gke=y.memo(({rowIndex:e})=>{const{tableId:t,spans:n,recordId:s}=u2(),{tableBlockColumnOrder:a}=G4(t);return r.jsx("tr",{className:"align-baseline",children:a.map((o,i)=>{var c,d;const l=(d=(c=n[s])==null?void 0:c[o])!=null?d:{};return l.colSpan===0||l.rowSpan===0?null:r.jsx(dz,{span:l,propertyId:o,rowIndex:e,columnIndex:i},"".concat(i,"-").concat(o))})})}),_ke=({tableId:e,indexRanges:t})=>{const n=ye(e,["subNodes","data"]),s=y.useMemo(()=>{if(!n)return{};const{data:a,subNodes:o}=n,{format:i={}}=a,{tableBlockColumnOrder:l=[],tableBlockRanges:c=[]}=i;return c.reduce((d,{start:u,end:f})=>{var k,T;if(!u||!f)return d;const[h,p]=u,[g,_]=f;if(!h||!p||!g||!_)return d;const x=o.indexOf(h),F=l.indexOf(p),b=o.indexOf(g),w=l.indexOf(_);d[h]={...(k=d[h])!=null?k:{},[p]:{colSpan:w-F+1,rowSpan:b-x+1}};const E=o.slice(x,b+1),C=l.slice(F,w+1);for(const v of E)for(const I of C)v===h&&I===p||(d[v]={...(T=d[v])!=null?T:{},[I]:{colSpan:0,rowSpan:0}});return d},{})},[n]);return n?r.jsx("tbody",{className:"w-max",onMouseMove:a=>{var d,u;const{hoveringCell:o,draggingStart:i}=J.simpleTable;if(i)return;const c=a.target.closest("td");if(c){const f=Number((d=c.dataset.tableRowIndex)!=null?d:0),h=Number((u=c.dataset.tableColumnIndex)!=null?u:0);(!o||o.rowIndex!==f||o.columnIndex!==h)&&re(Ns.update({activityTableId:e,hoveringCell:{rowIndex:f,columnIndex:h}}))}},onMouseLeave:()=>{const{draggingStart:a}=J.simpleTable;a||re(Ns.update({hoveringCell:void 0}))},children:n.subNodes.map((a,o)=>J.blocks[a]&&r.jsx(Qj.Provider,{value:{tableId:e,recordId:a,spans:s,indexRanges:t},children:r.jsx(gke,{rowIndex:o})},a))}):null},xke=y.memo(({id:e,level:t,children:n})=>{const s=y.useRef(null),a=Ce(({simpleTable:i})=>!!i.draggingStart,[],{obsSimpleTable:!0});a$(e),y.useEffect(()=>{const i=document.getElementById("root");a?i==null||i.classList.add("dragging"):i==null||i.classList.remove("dragging")},[a]);const o=lz(e);return r.jsxs(ia,{id:e,level:t,children:[r.jsx(Su.Provider,{value:!0,children:r.jsx("div",{className:R("overflow-x-auto overflow-y-hidden relative",t===0&&"-ml-[104px] pl-24 sm:-ml-12 sm:pl-12"),onScroll:()=>xn.emit("removeHoverMenu"),children:r.jsx("table",{ref:s,className:"w-max mt-3 mx-2 mb-[18px]",children:r.jsx(_ke,{tableId:e,indexRanges:o})})})}),n]})}),yke=fn.memo(e=>{const t=ye(e.id,["data","local"],["segments"]),n=hh(e.level),s=La(e.id),a=yr(),o=y.useMemo(()=>!fe(t==null?void 0:t.data.segments),[t==null?void 0:t.data.segments]),i=y.useRef(null),l=Kg(e.id,i,o,e.level),{paddingLeft:c,paddingRight:d}=mh(e.id,e.level);return Ld({uuid:e.id,callback:()=>{setTimeout(()=>{if(!a.current)return;const u=a.current.querySelector("[data-block-id='".concat(e.id,"']"));u&&u.scrollIntoView({block:"nearest",behavior:"auto"})},150)}}),t?r.jsx(ia,{id:e.id,ref:i,level:e.level,style:{minWidth:l},children:r.jsx(ui,{placeholder:n,uuid:e.id,className:"whitespace-pre-wrap break-words",segments:t.data.segments,onChange:(u,f,h)=>{s(u,[f,h])},style:{paddingLeft:"".concat(c,"px"),paddingRight:"".concat(d,"px")}})}):null}),bke=fn.memo(e=>{const t=ye(e.id,["data"],["segments","checked"]),n=hh(e.level),s=La(e.id),a=Oe(),o=y.useMemo(()=>!fe(t==null?void 0:t.data.segments),[t==null?void 0:t.data.segments]),i=y.useRef(null),l=Kg(e.id,i,o,e.level),c=We(e.id),{paddingRight:d}=mh(e.id,e.level);if(!t)return null;const{checked:u}=t.data;return r.jsx(ia,{id:e.id,ref:i,className:"flex items-center",level:e.level,style:{paddingLeft:"8px",minWidth:l},children:r.jsx(L4,{symbolClassName:"disable-select",symbol:r.jsx(_a,{size:"large",checked:u,onClick:f=>{c||(f.stopPropagation(),a(()=>{wI({data:{checked:!u}},e.id)}))}}),editorNode:r.jsx(ui,{placeholder:n,uuid:e.id,className:R("whitespace-pre-wrap break-words self-start",u?"opacity-50":"no-underline",{"line-through":u}),segments:t.data.segments,onChange:(f,h,p)=>{s(f,[h,p])},style:{paddingRight:"".concat(d,"px")}})})})}),uz=y.memo(e=>r.jsx(ia,{id:e.id,level:e.level,children:r.jsx(Xm,{id:e.id})})),fz=new Map;let mz;const Fke=e=>{mz=e},Zs=(e,t)=>{fz.set(e,t)},wke=e=>(ye(e.id,[]),null),Eke=[m.BlockType.DIVIDER,m.BlockType.PDF_ANNOTATION],Cke=(e,t)=>{if(e===void 0)return wke;if(t===0)return uke;if(Eke.includes(e))return null;const n=fz.get(e);return n||mz};Fke(yke);Zs(m.BlockType.FILE,qCe);Zs(m.BlockType.TABLE,xke);Zs(m.BlockType.ORDER_LIST,GCe);Zs(m.BlockType.QUOTE,dke);Zs(m.BlockType.LIST,FCe);Zs(m.BlockType.MARK,ECe);Zs(m.BlockType.BOOKMARK,yCe);Zs(m.BlockType.EQUATION,VCe);Zs(m.BlockType.CODE,LCe);Zs(m.BlockType.PAGE,td);Zs(m.BlockType.COLLECTION_VIEW_PAGE,td);Zs(m.BlockType.COLLECTION_VIEW,td);Zs(m.BlockType.REFERENCE_COLLECTION_PAGE,q4);Zs(m.BlockType.MIND_MAPPING,td);Zs(m.BlockType.MIND_MAPPING_PAGE,td);Zs(m.BlockType.FOLDER,td);Zs(m.BlockType.REFERENCE,q4);Zs(m.BlockType.REFERENCE_COLLECTION,q4);Zs(m.BlockType.EXTERNAL_FILE,V4);Zs(m.BlockType.EMBED,OCe);Zs(m.BlockType.TODO,bke);Zs(m.BlockType.SYNC_REFERENCE,uz);Zs(m.BlockType.SYNC_CONTAINER,uz);Zs(m.BlockType.COLUMN,oz);Zs(m.BlockType.COLUMN_LIST,oz);const MF=y.memo(e=>{const t=ye(e.id,["subNodes","data","hidden"],[]),n=Cke(t==null?void 0:t.type,e.level),[s]=Rd(e.id,{defaultOpen:!0});return!t||!n||t.hidden?null:r.jsxs(yd,{scope:wg,initialValues:[[Eg,e.id]],children:[r.jsx(n,{id:e.id,level:e.level}),s&&!(GH.includes(t.type)&&e.level!==0)&&t.subNodes.map(a=>r.jsx(MF,{id:a,level:e.level+1},a))]})}),kke=50,X6=50,by=5,Q6=5,{autoScroll:Tke,raf:J6}=RV(),vke=()=>{const e=Ho(),t=ng(),n=y.useRef(null),s=y.useRef(),[a,o]=y.useState(),i=Ln(),l=lt();return y.useEffect(()=>{const c=bn(".next-space-page",i);if(!c||e||t)return;const d=()=>{s.current=void 0,n.current=null,o(void 0),cancelAnimationFrame(J6.id),Ht.removeEventListener("mousemove",f),Ht.removeEventListener("mouseup",d)},u=p=>{if(xt.$blockMenuListId||p.button!==0||document.querySelector('[data-modal-id="SETTING"]'))return;const g=p.target;if(g.closest("[data-disable-select], [data-draggable], [data-property-id], [data-ignore-draggable]"))return;const _=i?".right-panel":".main-panel";n.current=g.closest("".concat(_," [data-block-id]")),s.current=[p.clientX,p.clientY,c.scrollTop],Ht.addEventListener("mousemove",f),Ht.addEventListener("mouseup",d)},f=p=>{const g=s.current&&Math.abs(s.current[0]-p.clientX)<Q6&&Math.abs(s.current[1]-p.clientY)<Q6;if(!(!s.current||g||J.ui.selectedCells.length>0)){if(n.current){const _=n.current.getBoundingClientRect(),x=n.current.dataset.blockId,F=l===x,b=x&&J.blocks[x];let w=!0;b&&[m.BlockType.COLLECTION_VIEW].includes(b.type)&&(w=!1);const E=_.left-(w?X6:by),C=_.right+(w?X6:by),k=_.top-by,T=_.bottom+by;if((F||p.clientX>E&&p.clientX<C)&&p.clientY>k&&p.clientY<T)return}n.current=null,window.getSelection().removeAllRanges(),document.dispatchEvent(new Event("_clearTextSelection")),Tke(p.clientX,p.clientY,c,kke),o([p.clientX,p.clientY,c.scrollTop])}},h=()=>{o(p=>{if(!p)return p;const[g,_]=p;return[g,_,c.scrollTop]})};return c.addEventListener("scroll",h),c.addEventListener("mousedown",u),()=>{s.current=void 0,cancelAnimationFrame(J6.id),c.removeEventListener("scroll",h),c.removeEventListener("mousedown",u),Ht.removeEventListener("mouseup",d),Ht.removeEventListener("mousemove",f)}},[t,e,i]),y.useMemo(()=>{if(!s.current||!a)return;const[c,d,u]=s.current,[f,h,p]=a,g=p-u,_=d-g,x=Math.min(c,f),F=Math.min(_,h),b=Math.abs(h-_),w=Math.abs(f-c);return{top:F,left:x,width:w,height:b}},[a])},Ike=({type:e="page"})=>{const t=ng(),n=Ln(),s=vke(),a=y.useRef(new Map),o=tg(),i=y.useCallback(()=>{J.ui.selectedBlocks.length===0&&J.ui.selectedCells.length===0||$u()},[]);y.useEffect(()=>{var C,k;if(o)return;const c=document.getElementById("root");if(!s||t){st({$isSelecting:!1}),c==null||c.classList.remove("selecting"),a.current=new Map;return}xt.$isSelecting||(st({$isSelecting:!0}),c==null||c.classList.add("selecting"),a.current=new Map,Co());const{blocks:d}=J,u=bn("[data-mind-page-id]",n);if(!u)return;const f=(C=u.firstElementChild)==null?void 0:C.getBoundingClientRect();if(!f)return;const h=[],p=[],g=b0(".next-space-page [data-block-id]",n),{collectionViews:_}=pe();for(const T of g){const{blockId:v,viewId:I,groupValue:j,subGroupValue:S,syncId:D}=T.dataset;if(!v)return;const A=a.current.get(v),P=I&&((k=_[I])==null?void 0:k.type)===m.CollectionViewType.CALENDAR;if(A){if(P||j){const L=T.getBoundingClientRect(),O={left:L.left,width:L.width,height:L.height,offsetTop:L.top-f.top,viewId:I,groupValue:j,subGroupValue:S,syncId:D};a.current.set(v,vL(A.concat(O),In))}}else{const L=T.getBoundingClientRect(),O={left:L.left,width:L.width,height:L.height,offsetTop:L.top-f.top,viewId:I,groupValue:j,subGroupValue:S,syncId:D};a.current.set(v,[O])}}let x,F,b,w;for(const[T,v]of a.current){let I=!1,j;const S=[];if(v.forEach((O,$)=>{const M={left:O.left,top:f.top+O.offsetTop,width:O.width,height:O.height};$===0&&(j=M),H$(M,s)&&(S.push(O),I=!0)}),!I||!j)continue;const D=d[T];if(!D||D.type===m.BlockType.COLUMN_LIST)continue;const A=d[D.parentId];if(!A)continue;(!x||j.top<x)&&(x=j.top,b=D),(!F||j.top>F)&&(F=j.top,w=D);const P=S[0];if(!P)return;const L={blockId:T,viewId:P.viewId,syncId:P.syncId};if(P.groupValue){const O={};S.forEach($=>{var U;const{groupValue:M}=$;if(M){const z=(U=O[M!=null?M:""])!=null?U:[];O[M]=$.subGroupValue?z.concat($.subGroupValue):z}}),L.groupValues=O}A.type===m.BlockType.COLUMN?p.push(L):h.push(L)}if(!b||!w){i();return}let E=[...h,...p];E=E.filter(T=>{const v=J.blocks[T.blockId],I=v==null?void 0:v.parentId;if(I){const j=J.blocks[I];if(j&&ga(j.type)){const{role:S}=mn(T.blockId);return S!==m.PermissionRole.READER}}return!0}),In(E,J.ui.selectedBlocks)||re(at.updateSelectBlocks(E))},[s,t,e,n,o,i]);const l=y.useMemo(()=>{var c;if(n&&(s!=null&&s.left)&&!TL){const d=(c=document.querySelector(".main-panel .next-space-page"))==null?void 0:c.getBoundingClientRect().right;return d?s.left-d:void 0}return s==null?void 0:s.left},[n,s==null?void 0:s.left]);return r.jsx("div",{style:{...s,left:l,zIndex:1e3},className:"fixed bg-active_color opacity-[0.12] pointer-events-none"})},Nke=e=>{const t=y.useRef(null),n=yr(),{mindMapStyle:s,mindMapLineStyle:a}=Fx(e.id),o=Fr(),i=We(e.id),l=VH(e.id);aCe(n,t),rCe(n);const c=N4({container:n}),d=Un(),u=Sj();return YU(n.current,f=>{var g;const[h,p]=o.getSize();if(f.width&&f.height&&(o.setSize(f.width,f.height),h&&p)){const _=Math.floor(f.width-h),x=Math.floor(f.height-p);(g=n.current)==null||g.scrollBy({left:_,top:x})}},"all"),y.useEffect(()=>{setTimeout(()=>{o.setAlignSiblingNode(l)},l?300:0)},[l,o]),y.useEffect(()=>{o.setRootId(e.id),o.setDirection(s,!0),o.setLineStyle(a)},[o,a,s,e.id]),y.useEffect(()=>{var h;if(!n.current||!t.current)return;const f=(h=n.current)==null?void 0:h.getBoundingClientRect();f&&o.setSize(f.width,f.height),o.setContainer(t.current),o.setScroller(n.current)},[o,n]),Gp(()=>{o.destroy()}),y.useEffect(()=>(kM(e.id,o),()=>{TM(e.id)}),[o,e.id]),y.useEffect(()=>{if(wt.MAIN!==d)return;if(Ej(J,e.id,e.id)>150){const h=J.blocks[e.id];h!=null&&h.subNodes&&Vi(h.subNodes,!1,!1),c()}},[e.id,c,d]),r.jsxs(r.Fragment,{children:[r.jsxs(XH,{ref:t,id:e.id,children:[r.jsx(q2e,{container:t}),r.jsx(JH,{}),r.jsx(MF,{id:e.id,level:0}),l&&r.jsx(j2e,{children:r.jsx(MF,{id:e.id,level:0})}),r.jsx(QH,{})]}),r.jsx(HH,{id:e.id}),r.jsx(U2e,{id:e.id}),r.jsx(V2e,{id:e.id}),!u&&r.jsx(xs,{className:"absolute left-0 top-0"}),!i&&r.jsx(Ike,{})]})},hz=e=>{const{uuid:t}=e,n=ye(t,[]),s=y.useRef(null),a=Ln(),o=rr(()=>new WU({getAllElement:()=>{var i;return(i=s.current)==null?void 0:i.querySelectorAll("[data-block-id]")},getCanvasPosition:(i,l,c)=>{if(s.current){const u=i.getState().scale*.01,f=s.current.querySelector(".node-drawer"),h=f==null?void 0:f.getBoundingClientRect();if(!h)return[l,c];const p=l-h.left,g=c-h.top;return[p/u,g/u]}return[l,c]},supportAppendChild:i=>B0(i),getLineColor:i=>rm(i)}));return y.useEffect(()=>{var c;const i=qn(vM,200),l=o.addScaleListener({onScaleChange:(d,u)=>{i(d,u,!1)}});return o.zoom((c=IM(t,!1))!=null?c:100),l},[o,t]),n?r.jsx(jl.Provider,{value:o,children:r.jsx(Oo,{children:r.jsx(Vo.Provider,{value:a?uc.RIGHT_PAGE_MIND:void 0,children:r.jsx(Ec.Provider,{value:s,children:r.jsx("div",{className:"w-full next-space-page mind-page overflow-auto h-full",ref:s,"data-mind-page-id":t,children:r.jsx(Nke,{id:t},t)})})})})}):r.jsx(Fg,{})},pz=e=>{var k,T;const{uuid:t,children:n}=e,s=ye(t,["data","local"],["icon","segments","iconUrl"]),a=lt(),o=WZ(),i=!!s,l=Hj(),c=Ja(),d=y.useContext(Su),u=We(t),f=u9(),{allowDuplicate:h,illegal:p}=mt(t),g=pt(),_=Ln(),x=Dt(),b=!!Ut().uuid,w=Sg(),E=Un()===wt.TEMPLATE;if(y.useEffect(()=>{const v=window.sessionStorage.getItem(v1);g&&v===t&&b&&(window.sessionStorage.removeItem(v1),w(t))},[w,g,t,b]),y.useEffect(()=>{if(!t||!i||!b||E)return;const v=J.blocks[t];!v||v.local||mo(async()=>{var I;if(u||ve.editor.addSpaceVisitsHistory(v.spaceId,{uuid:t}),!pt()){if(_&&((I=J.blocks[o])==null?void 0:I.spaceId)!==v.spaceId)return;ve.editor.addDocVisits.raw(t)}})},[u,t,i,b,_,o,E]),y.useEffect(()=>{if(!i)return;const v=pe().blocks[t];v&&(me.event("page_enter",{is_success:!0,page_type:v.type,page_id:v.uuid,is_shared:g}),b&&Dh.reportEnter({spaceId:v.spaceId,activeFrom:g?"share_link":void 0}))},[t,i,b,g]),y.useEffect(()=>{var v,I;_||bT(i&&!p?{title:fe(s==null?void 0:s.data.segments)||qt(s==null?void 0:s.type),icon:{type:(v=s==null?void 0:s.data.icon)==null?void 0:v.type,value:(s==null?void 0:s.data.iconUrl)||((I=s==null?void 0:s.data.icon)==null?void 0:I.value)}}:{title:p?Ts:x.title})},[i,x.title,_,p,s==null?void 0:s.data.segments,(k=s==null?void 0:s.data.icon)==null?void 0:k.type,(T=s==null?void 0:s.data.icon)==null?void 0:T.value,s==null?void 0:s.data.iconUrl,s==null?void 0:s.type]),y.useEffect(()=>{if(!s)return;const v=pe().blocks[s.parentId];if((v==null?void 0:v.type)===m.BlockType.COLLECTION_VIEW_PAGE||(v==null?void 0:v.type)===m.BlockType.COLLECTION_VIEW)return l.subscribeChildPages(s.spaceId,t,()=>{c(t)})},[s,c,l,t]),y.useEffect(()=>{const v=document.getElementById("root");g&&!h?v==null||v.classList.add("no-print"):v==null||v.classList.remove("no-print")},[h,g]),y.useEffect(()=>{s!=null&&s.local&&setTimeout(()=>{_e(t,{local:!1},!0)},200)},[s==null?void 0:s.local,t]),y.useEffect(()=>{localStorage.getItem(lD)!==a&&a&&!g&&ts(lD,a)},[g,a]),p)return r.jsx(L0,{uuid:t});let C=null;switch(s==null?void 0:s.type){case m.BlockType.PAGE:{C=r.jsx(PF,{uuid:t,children:n});break}case m.BlockType.COLLECTION_VIEW:case m.BlockType.REFERENCE_COLLECTION:case m.BlockType.REFERENCE_COLLECTION_PAGE:case m.BlockType.COLLECTION_VIEW_PAGE:{C=r.jsx(dq,{uuid:t,children:n});break}case m.BlockType.FOLDER:{C=r.jsx(UH,{uuid:t,children:n});break}case m.BlockType.MIND_MAPPING:case m.BlockType.MIND_MAPPING_PAGE:{C=r.jsx(hz,{uuid:t});break}case m.BlockType.CHART:case m.BlockType.CHART_PAGRE:C=r.jsx(TH,{uuid:t});break;default:t?C=r.jsx(Fg,{showBackButton:!1}):C=r.jsx(PF,{uuid:t,children:n});break}return r.jsx(yd,{scope:pr,initialValues:[[nE,t]],children:r.jsx(Su.Provider,{value:d||f.backup||f.noPermission,children:C},t)})},jke=e=>e.isCustomTemplate?r.jsx("div",{className:R("absolute w-full h-full top-0 lef-0 flex items-center justify-center cursor-pointer"),onClick:()=>e.onClick(),children:r.jsx("img",{className:"w-[100px]",src:e.imageUrl})}):r.jsx("img",{className:R("cursor-pointer w-full h-full rounded scale-[1.1] object-cover",e.className),src:e.imageUrl,onClick:()=>{e.onClick()},style:{objectPosition:"0px -10px"}}),Ske=0,Dke=1,gz=e=>{const t=ie(),n=a=>(o,i)=>{switch(a(),i){case Ske:e.onEdit();break;case Dke:e.onDelete();break}},s=[{type:H.OPERATION,data:{icon:"IcEditor",title:"编辑"}},{type:H.OPERATION,data:{icon:"IcTrash",title:"删除"}}];return r.jsx("div",{onClick:a=>{a.stopPropagation(),t.dropdown({popcorn:a.currentTarget,placement:"bottom-start",content:({onCloseModal:o})=>r.jsx(ze,{className:"w-[200px] py-2 next-modal",items:s,onItemClick:n(o)})})},className:R("flex justify-center items-center cursor-pointer  self-end",e.className),children:r.jsx(V,{size:"middle",name:"IcMore",style:{color:e.moreColor||"white"}})})},X_=({template:e,onPreviewOpen:t,className:n,preview:s,targetId:a})=>{var I,j;const o=ns(),i=Ja(),l=Js(),c=yFe(),d=ln(),[u,f]=y.useState(""),[h,p]=y.useState(""),{role:g}=mt(e.id),_=_4(e.id),x=ie(),F=Oe(),b=_r((I=e.userId)!=null?I:""),[w,E]=yc(),C=Z$(),k=async()=>{const S=await C({...e,targetId:a,addCopyLimit:!e.isCustom},c);S&&(me.event("copy_template",{is_from:e!=null&&e.isCustom?"custom":"new_page",template_id:e.id}),l(Je.COPY_PAGE_FROM_TEMPLATE,ct.basicList),await i(S,{force:!0}),c!=="record"&&o.push("/".concat(S)),be.closeMessage("templateLoading"),d(Ve.TEMPLATE_CENTER))};y.useEffect(()=>{if(w&&!u&&e.image){if(e.image.startsWith("http")){f(e.image);return}Vs.fetchImageUrl({blockId:e.pageId,ossName:e.image}).then(S=>f(sm(S,Math.floor(360*1.5*Math.ceil(window.devicePixelRatio)))))}},[w,u,e.pageId,e.image,f]),y.useEffect(()=>{w&&(h||e.sourceImage&&Vs.fetchImageUrl({blockId:e.pageId,ossName:e.sourceImage}).then(S=>p(sm(S,Math.floor(24*1.5*Math.ceil(window.devicePixelRatio))))))},[w,h,e.pageId,e.sourceImage,f]);const T=g===m.PermissionRole.EDITOR||g===m.PermissionRole.WRITER;if(!_&&e.isCustom)return null;const v=c==="titleSearchFooter";return r.jsxs("div",{className:n,ref:E,children:[r.jsxs("div",{className:R("group relative bg-white1 rounded-[6px] overflow-hidden h-0 pb-[66%] w-full"),style:{border:"1px solid var(--black_006)",boxShadow:"0px 1px 3px var(--black_006)"},children:[!s&&u&&r.jsx(jke,{imageUrl:u,isCustomTemplate:e.isCustom,templateId:e.id,className:"absolute",onClick:()=>{v&&k(),t(e.id)}}),s&&w&&r.jsx("div",{className:"zoom-03 w-[333%] overflow-hidden h-[800px] pointer-events-none",children:r.jsx(pz,{uuid:e.id})}),r.jsx("div",{className:"opacity-0 group-hover:opacity-100 flex justify-end items-center absolute h-[56px] w-full top-0 rounded-b-1.5",children:e.isCustom&&T&&r.jsx(gz,{className:"absolute z-20 w-[26px] h-[26px] group-hover:opacity-100 right-0 top-0 opacity-0 mt-2.5 mr-2.5 bg-black/75 rounded-sm",onEdit:()=>{window.open("/".concat(e.id))},onDelete:()=>{x.warning({title:"确认删除模板？",content:"删除后，该模板将从模板库移除并进入回收站",confirmText:"确认删除",colorType:"red",confirm:()=>{F(()=>{gr(e.id)})}})}})}),!v&&r.jsxs("div",{className:"opacity-0 group-hover:opacity-100 border-t flex justify-between items-center absolute h-[56px] w-full bottom-0 rounded-b-1.5 px-2.5 bg-white3",children:[r.jsx("p",{className:"text-t3 text-grey3 line-clamp-2 overflow-ellipsis",children:e.desc}),r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex justify-center items-center w-[56px] h-8 cursor-pointer border border-solid border-grey5 rounded text-black text-t2-medium  bg-white1 hover:bg-white1/90",onClick:()=>t(e.id),children:"预览"}),r.jsx("div",{className:"flex justify-center items-center ml-2.5 w-[56px] h-8 cursor-pointer bg-active_color text-t2-medium text-white hover:bg-active_color/90 rounded",onClick:k,children:"使用"})]})]})]}),r.jsxs("div",{className:"relative flex justify-between items-center mt-4 mb-[30px] overflow-hidden w-full",children:[r.jsxs("div",{className:"flex-1 overflow-hidden",children:[r.jsx("div",{className:"text-t2-medium text-ellipsis",children:e.isCustom?r.jsx(yl,{uuid:e.id}):e.name}),r.jsx("div",{className:"text-t2 text-grey3 mt-[2px] text-ellipsis",children:e.source||b})]}),h&&r.jsx("img",{className:"w-9 h-9 md:w-5 md:h-5 rounded-full mr-1",src:h}),e.isCustom&&r.jsx(Ake,{userId:(j=e.userId)!=null?j:""})]})]})},Ake=e=>{const t=Pi(e.userId),n=_r(e.userId);return t?r.jsx(ar,{className:"rounded-full text-white w-9 h-9 mr-1",name:n||"客",color:(t==null?void 0:t.backgroundColor)||void 0,icon:t!=null&&t.avatar?{type:"upload",value:t.avatar}:void 0,imgClassName:"rounded-full"}):null},Z6="import-modal",Rke="notion-modal",_z={[m.ImportType.MARKDOWN]:{icon:"IcMarkdown",title:"Markdown",description:"支持 ZIP RAR",accept:".md,.zip,.rar"},[m.ImportType.CSV]:{icon:"IcTable",title:"CSV",description:"",accept:".csv"},[m.ImportType.HTML]:{icon:"IcEmbeddedWebpage",title:"HTML",description:"",accept:".html,.zip,.rar"},[m.ImportType.WORD]:{icon:"MIcWord",title:"Word",description:"支持 DOCX",accept:".docx,.zip,.rar"},[m.ImportType.NOTION]:{icon:"MIcImportNotion",title:"Notion",description:"通过 Notion API 导入",accept:"",help:ds.importFromNotion}},xz=()=>{const e=jd(),t=Ja(),n=Dt(),s=Yw(),a=ns(),o=ie();return{createDocPage:e,fetchPage:t,currentSpace:n,closeAllModal:s,history:a,openModal:o,openLoading:c=>{o.loading({title:c,modalId:Z6,forceUpdate:!0,autoClose:!0,keyboard:!0})},closeLoading:()=>{o.closeModal(Z6)}}},Pke=()=>{const{createDocPage:e,fetchPage:t,currentSpace:n,closeAllModal:s,history:a,openLoading:o,closeLoading:i}=xz(),[l,c]=y.useState(""),d=()=>{const p=window.screen.width/2-400,g=window.screen.height/2-800/2,_=encodeURIComponent("".concat(Jh).concat(Nt.notion));window.open("https://api.notion.com/v1/oauth/authorize?client_id=".concat(bZ,"&response_type=code&owner=user&redirect_uri=").concat(_),"notion","width=800,height=800,left=".concat(p,",top=").concat(g))},u=()=>{if(l.length!==32){be.error("Notion id 错误, 如果是 database 只需要 ?v= 之前的部分");return}const f=e(m.BlockType.PAGE,{parentId:n.uuid},Ss.PRIVATE);f&&(o("云端导入中，点击空白处关闭等待，点击屏幕右下角菜单可以查看导入状态"),mo(()=>D4({eventName:"import",request:{blockId:f,spaceId:n.uuid,importOptions:{type:"notion",notionId:l}}},{success:async({uuid:h})=>{h&&t(h,{force:!0}),i(),s(),a.push("/".concat(f))},fail(){f&&(i(),s(),be.warning("Had a bit of a problem getting the task status"))}})))};return r.jsx("div",{className:"w-[480px] p-6",children:r.jsxs("div",{className:"w-full",children:[r.jsxs("div",{className:"flex items-center ",children:[r.jsx(eP,{orderNum:1,className:"self-start mt-0.5"}),r.jsxs("div",{className:"ml-2",children:[r.jsx("div",{className:"text-t2-medium",children:"授权待导入 Notion 页面"}),r.jsx("div",{className:"text-grey2 text-t4 mt-1",children:"已授权页面可以跳过此步骤"}),r.jsx(De,{className:"mt-4 h-7 text-t2-medium",colorType:"active",onClick:d,children:"授权"})]})]}),r.jsxs("div",{className:"flex items-center mt-6 w-full",children:[r.jsx(eP,{orderNum:2,className:"self-start mt-0.5"}),r.jsxs("div",{className:"ml-2 w-full",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"text-t2-medium",children:"输入已授权 Notion 页面 id"}),r.jsx("a",{target:"_blank",href:ds.importFromNotion,className:"animate-click",children:r.jsx(V,{size:"small",name:"IcInviteHelp",className:"text-grey3 ml-2"})})]}),r.jsx(Ct,{className:"w-full mt-1",inputClassName:"h-8 ",placeholder:"输入已授权 Notion 页面 id",onChange:c,value:l}),r.jsx(De,{className:"mt-4 h-7 text-t2-medium",colorType:"active",onClick:u,children:"导入"})]})]})]})})},eP=e=>r.jsx("div",{className:R("flex justify-center items-center rounded-full w-4 h-4 bg-active_color/20",e.className),children:r.jsx("span",{className:" text-active_color text-t4",children:e.orderNum})}),yz=({from:e,pageId:t})=>r.jsxs("div",{className:"w-125 p-8",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("div",{className:"text-h2",children:"导入"}),r.jsxs("a",{target:"_blank",href:ds.howToImport,hidden:!1,className:"flex items-center text-grey4 animate-click",children:[r.jsx(V,{size:"small",name:"IcInviteHelp",className:"mr-1.5"}),r.jsx("div",{className:"text-t2 text-grey4",children:"如何导入"})]})]}),r.jsx("div",{className:"grid grid-cols-2 gap-5",children:Object.keys(_z).map(n=>r.jsx(Lke,{fileType:n,from:e,pageId:t},n))})]}),Lke=({fileType:e,from:t,pageId:n})=>{const{createDocPage:s,fetchPage:a,currentSpace:o,closeAllModal:i,history:l,openModal:c,openLoading:d,closeLoading:u}=xz(),f=WE(),h=Uo(),p=_z[e];if(!p)return null;const g=F=>{const b=F.target.files;if(!b||b.length===0)return;const w=b[0];if(!w)return;const E=t==="page"?"empty_import":"import";me.event(E,{file_type:e}),d("正在上传... (0%)"),h({file:w,type:"temp",onProgress(C){d(C===100?"正在导入，请稍候...":"正在上传... (".concat(C,"%)"))},onComplete(C){if(!C.success){u();return}const{ossName:k}=C;if(k){let T=n||Ri();if(t==="button"&&(T=s(m.BlockType.PAGE,{parentId:o.uuid},Ss.PRIVATE)),!T){be.error("导入失败，请重试");return}mo(()=>D4({eventName:"import",request:{blockId:T,spaceId:o.uuid,importOptions:{type:e,ossName:k}}},{success:async({uuid:v})=>{v&&a(v,{force:!0}),await f(Je.STANDING_IMPORT),u(),i(),t==="button"&&l.push("/".concat(T))},fail(){t==="button"&&T&&Ro(T),u()}}))}}})},_=e!==m.ImportType.NOTION,x=()=>{_||c.modal({modalId:Rke,content:Pke})};return r.jsxs("label",{className:"border-grey5 animate-hover animate-click flex h-[70px] items-center rounded-md border px-4 shadow-sm",onClick:x,children:[_&&r.jsx("input",{type:"file",accept:p.accept,className:"hidden",onChange:g}),r.jsx(V,{name:p.icon,size:"large",className:"text-normal"}),r.jsxs("div",{className:"ml-2.5",children:[r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"text-t1-medium text-normal",children:p.title}),p.help&&r.jsx("a",{target:"_blank",href:p.help,className:"animate-click",children:r.jsx(V,{size:"small",name:"IcInviteHelp",className:"text-grey3 ml-2"})})]}),!!p.description&&r.jsx("div",{className:"text-t4 text-grey3",children:p.description})]})]})};let bz;const Bke=e=>{bz=e},Oke=({closeSelf:e,type:t})=>{var u,f;const[n,s]=y.useState((u=Fy[0])==null?void 0:u.type),a=ie(),o=Js(),i=ih(),l=jd(),c=ns(),d=()=>{const h=Fy.find(_=>_.type===n);if(!h){e();return}const p=[];t===Ss.PRIVATE&&p.push({role:m.PermissionRole.EDITOR,type:m.PermissionType.USER,userId:xa().uuid}),t===Ss.SPACE&&p.push({role:m.PermissionRole.EDITOR,type:m.PermissionType.SPACE});let g="";switch(n){case"template":{g=l(m.BlockType.PAGE,{parentId:Ot(),first:!0},t),g&&c.push("/".concat(g)),o(Je.CREATE_NEW_PAGE,ct.basicList,{isFirstTask:!0}),a.modal({modalId:Ve.TEMPLATE_CENTER,content:()=>r.jsx(bz,{onlyShowTab:"template",from:"page"})}),e();return}case"import":{g=l(m.BlockType.PAGE,{parentId:Ot(),first:!0},t),g&&c.push("/".concat(g)),o(Je.CREATE_NEW_PAGE,ct.basicList,{isFirstTask:!0}),a.modal({content:()=>r.jsx(yz,{pageId:g,from:"page"})}),e();return}case"table":case"board":case"gallery":case"list":case"timeline":case"calendar":case"form":{hn(()=>{g=ut({type:m.BlockType.COLLECTION_VIEW_PAGE,permissions:p},{parentId:Ot(),first:!0},!1,!0),Yh(g,h.viewType)}),o(Je.CREATE_NEW_PAGE,ct.basicList,{isFirstTask:n==="list"||n==="board"||n==="gallery"}),n==="table"?o(Je.CREATE_BITABLE_EXPLORE,ct.basicList,{isFirstTask:!0}):h.taskId&&o(h.taskId,ct.basicList,{isFirstTask:!0});break}case"folder":{g=l(m.BlockType.FOLDER,{parentId:Ot(),first:!0},t),o(Je.CREATE_NEW_PAGE,ct.basicList,{isFirstTask:!0});break}case"mindmap":{hn(()=>{g=l(m.BlockType.MIND_MAPPING_PAGE,{parentId:Ot(),first:!0},t),g&&(i({parentId:g,last:!0},g),i({parentId:g,last:!0},g),i({parentId:g,last:!0},g))}),o(Je.CREATE_NEW_PAGE,ct.basicList,{isFirstTask:!0});break}case"doc":{g=l(m.BlockType.PAGE,{parentId:Ot(),first:!0},t),o(Je.CREATE_NEW_PAGE,ct.basicList,{isFirstTask:!0});break}}g&&es(1e3).then(()=>c.push("/".concat(g))),e()};return r.jsxs("div",{className:"w-[960px]",children:[r.jsx("div",{className:"flex items-center h-[80px] pl-[30px] border-b",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h2",{className:"text-t1-medium flex items-center",children:"页面类型"}),r.jsx("p",{className:"text-t2 text-grey3 mt-0.5",hidden:!1,children:"首次创建页面得 ⭐️+5 可累积抵现兑会员"})]})}),r.jsxs("div",{className:"py-2.5 min-h-[440px] flex ",children:[r.jsx("div",{className:"w-[240px]",children:Fy.map(h=>{const{title:p,icon:g,type:_}=h;return r.jsx("div",{className:"px-2 h-10",children:r.jsxs("div",{onClick:()=>s(_),className:R("flex items-center h-full rounded animate-hover-black3 pl-[42px] relative",n===_&&"bg-black_006"),children:[r.jsx(V,{name:g,size:"middle",className:"absolute left-5 top-2.5"}),r.jsx("span",{className:"text-t2-medium text-grey2",children:p})]})},p)})}),r.jsxs("div",{className:"pt-4 px-[60px]",children:[r.jsx("img",{src:"".concat(Lo,"activity/page/").concat((f=Fy.find(h=>h.type===n))==null?void 0:f.type,".png"),className:"w-[600px] h-[338px] border rounded-md"}),r.jsx("div",{className:"flex items-center mt-4",children:r.jsx(De,{colorType:"active",onClick:d,children:"创建"})})]})]})]})},jRe=()=>{const e=ie();return y.useCallback(t=>{e.modal({autoClose:!1,closeAfterCallBack:async()=>{await es(1e3),Hbe(Ve.CREATE_PAGE_TIP)},content:n=>r.jsx(Oke,{closeSelf:n.onCloseModal,type:t})})},[e])},Fy=[{icon:"IcPageEmpty",title:"页面",type:"doc",btn:""},{icon:"IcMindmap",title:"思维导图",type:"mindmap",btn:""},{icon:"IcFolder",title:"文件夹",type:"folder",btn:""},{icon:"MIcNaviImport",title:"导入",type:"import",btn:""},{icon:"IcTable",title:"表格",viewType:m.CollectionViewType.TABLE,taskId:Je.CREATE_BITABLE_EXPLORE,type:"table",btn:""},{icon:"IcBoard",title:"看板",viewType:m.CollectionViewType.BOARD,type:"board",btn:""},{icon:"IcGallery",title:"画廊",viewType:m.CollectionViewType.GALLERY,type:"gallery",btn:""},{icon:"IcList",title:"目录",viewType:m.CollectionViewType.LIST,type:"list",btn:""},{icon:"IcTimeline",title:"时间轴",viewType:m.CollectionViewType.TIMELINE,taskId:Je.CREATE_TIMELINE_VIEW,type:"timeline",btn:""},{icon:"IcCalendar",title:"日历",viewType:m.CollectionViewType.CALENDAR,taskId:Je.CREATE_CALENDAR_VIEW,type:"calendar",btn:""},{icon:"IcForm",title:"收集表",viewType:m.CollectionViewType.FORM,taskId:Je.CREATE_FORM_VIEW,type:"form",btn:""},{icon:"IcTemplate",title:"模板库",type:"template",btn:""}],Mke=e=>{const{officialTemplates:t,currentCategory:n,setCurrentCategory:s}=e,a=So(b2);return r.jsxs("div",{className:"w-[240px] bg-white2 border-r flex-shrink-0",children:[r.jsxs("div",{className:"w-full overflow-auto relative h-[calc(100%-50px)]",children:[r.jsx("div",{className:"text-t2-medium py-[5px]",children:r.jsx("div",{onClick:()=>{s("myTemplate"),me.event("template_category",{category_id:"我的模板"}),a({})},className:R("h-10 flex items-center cursor-pointer hover:bg-black_003 rounded pl-[30px] mx-2",n==="myTemplate"&&"bg-black_006"),children:"我的模板"})}),r.jsx("div",{className:"bg-grey6 h-px my-1 mx-2"}),r.jsx("div",{children:t.map(o=>r.jsx(Uke,{first:o,changeCategory:i=>{s(i),a({})},currentCategory:n},o.name))})]}),r.jsxs("div",{hidden:!1,className:"hover:normal-bg w-full cursor-pointer rounded-bl",onClick:()=>window.open(ds.templateContribution),children:[r.jsx("div",{className:"h-px bg-grey6 w-full"}),r.jsxs("div",{className:"ml-4 flex items-center",children:[r.jsx("img",{src:vn.submit,className:"w-5 h-5"}),r.jsx("div",{className:"text-t2-medium h-[50px] flex items-center ml-2",children:"投稿你的模板"})]})]})]})},tP=5,Uke=({first:e,changeCategory:t,currentCategory:n})=>{const[s,a]=y.useState(!1),{name:o,subGroups:i}=e;return i?r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h2",{className:"text-t2-medium h-[50px] flex items-center pl-[30px]",children:o}),(s?i:i.slice(0,tP)).map(l=>{var d,u;if(((d=l.templates)==null?void 0:d.length)===0&&((u=l.subGroups)==null?void 0:u.length)===0)return null;const c="".concat(o,"/").concat(l.name);return r.jsx("button",{onClick:()=>{t(c),me.event("template_category",{category_id:l.name})},className:R("h-10 flex items-center text-t2-medium text-grey2 mx-2 pl-[42px] cursor-pointer rounded hover:bg-black_003",n===c&&"bg-black_006"),children:l.name},c)}),i.length>tP&&r.jsx("button",{className:"text-t2 text-grey3 mx-2 pl-[42px] animate-hover h-10 flex items-center",onClick:()=>a(!s),children:s?"收起":"显示更多"})]},o):null},Fz=()=>{const e=Id(),t=mc(o=>{var l;const i=e==null?void 0:e.spaceId;if(i)return(l=o[i])==null?void 0:l.customTemplates}),n={name:"我创建的",templates:[]},s={name:"分享给我的",templates:[]};return t==null||t.forEach(o=>{var d;const i=wz(o);if(!i)return;const l=J.blocks[o];let c;((l==null?void 0:l.type)===m.BlockType.REFERENCE_COLLECTION||(l==null?void 0:l.type)===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(c=Om(o)),l&&(((d=c==null?void 0:c.data.createdTemplateBy)!=null?d:l.data.createdTemplateBy)===yt.uuid?n.templates.push(i):s.templates.push(i))}),{name:"我的模板",subGroups:[n,s]}},wz=e=>{var a,o,i;if(r2(e))return;const t=J.blocks[e];let n;return((t==null?void 0:t.type)===m.BlockType.REFERENCE_COLLECTION||(t==null?void 0:t.type)===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(n=Om(e)),t?{id:e,pageId:e,name:fe((a=n==null?void 0:n.data.segments)!=null?a:t.data.segments)||qt((n==null?void 0:n.type)||t.type),source:"",icon:(o=n==null?void 0:n.data.icon)!=null?o:t.data.icon,desc:"",image:vn.templateEmpty,isCustom:!0,userId:(i=n==null?void 0:n.data.createdTemplateBy)!=null?i:t.data.createdTemplateBy}:void 0},Vke=({category:e,preview:t,onPreviewOpen:n,targetId:s})=>{var o,i;const a=((o=e==null?void 0:e.templates)!=null?o:[]).length>0;return r.jsxs("div",{children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-t1 mt-9 mb-2.5",children:e.name}),r.jsx("div",{className:"bg-grey6 w-full h-px mb-[14px]"})]}),r.jsxs("div",{className:"w-full pb-9 pt-5 grid gap-4",style:{gridTemplateColumns:"repeat(auto-fill, 360px)"},children:[(i=e.templates)==null?void 0:i.map(l=>r.jsx(X_,{template:l,preview:t,targetId:s,onPreviewOpen:n},l.pageId)),!a&&r.jsx($ke,{})]})]})},$ke=()=>r.jsxs("div",{className:"px-[30px] relative w-fit flex flex-col items-center",children:[r.jsx("div",{style:{fontSize:"60px"},children:"☕️"}),r.jsx("div",{className:"text-grey4 text-t2",children:"暂无模板"})]}),Hke=e=>r.jsxs("div",{className:e.className,children:[r.jsx("div",{className:"text-h2",children:"使用模板，高效创作"}),r.jsx("div",{className:"text-grey3 text-t2 mt-2.5",children:"将经常使用的页面转换为模板，避免重复编辑。你还可以分享给团队成员，提高团队效率。"}),r.jsx("div",{className:"w-full max-w-4xl",children:r.jsx("img",{src:vn.templatesEmpty,className:"mt-7 "})})]}),zke=e=>{var x,F,b,w,E,C,k,T,v,I;const{officialTemplates:t,currentCategory:n,openTemplatePreview:s}=e,a=ea(b2),{templates:o=[],hasResult:i=!1,keyword:l}=a,c=n.split("/").filter(Boolean),d=t.find(j=>j.name===c[0]),u=(x=d==null?void 0:d.subGroups)==null?void 0:x.find(j=>j.name===c[1]),[f,h]=y.useState((w=(b=(F=u==null?void 0:u.subGroups)==null?void 0:F[0])==null?void 0:b.name)!=null?w:""),p=Fz(),g=n==="myTemplate";y.useEffect(()=>{var j,S,D;h((D=(S=(j=u==null?void 0:u.subGroups)==null?void 0:j[0])==null?void 0:S.name)!=null?D:"")},[n,u]);let _=[];return!g&&u&&(_=(E=u.templates)!=null?E:[],f&&(_=(T=(k=(C=u.subGroups)==null?void 0:C.find(j=>j.name===f))==null?void 0:k.templates)!=null?T:[])),r.jsxs("div",{className:"relative w-full px-[30px] overflow-auto h-full",children:[l&&(i?r.jsx("div",{className:"overflow-auto grid gap-4 pt-5",style:{gridTemplateColumns:"repeat(auto-fill, 360px)"},children:o.map(j=>r.jsx(X_,{targetId:e.targetId,template:j,onPreviewOpen:S=>{s(S)}},j.pageId))}):r.jsxs("div",{children:[r.jsxs("div",{className:"flex flex-col items-center relative py-[100px] border-b",children:[r.jsx("div",{className:"text-[70px] leading-[80px]",children:"👀"}),r.jsx("div",{className:"text-t1-medium text-black",children:"暂时没有找到符合条件的模板"}),r.jsx("a",{target:"_blank",href:ds.templateFeedback,hidden:!1,className:"text-t2 text-active_color cursor-pointer",rel:"noreferrer",children:"点击反馈你的模板需求"})]}),r.jsx("p",{className:"h-9 text-t1 mt-5 mb-2.5",children:"试试这些模板吧"}),r.jsx("div",{className:"overflow-auto grid gap-4",style:{gridTemplateColumns:"repeat(auto-fill, 360px)"},children:o.map(j=>r.jsx(X_,{targetId:e.targetId,template:j,onPreviewOpen:S=>s(S)},j.pageId))})]})),!l&&r.jsxs(r.Fragment,{children:[g&&r.jsx(r.Fragment,{children:((v=p==null?void 0:p.subGroups)!=null?v:[]).map(j=>{var S;return(S=j.templates)!=null?S:[]}).flat().length===0?r.jsx(Hke,{className:"mt-5"}):(I=p==null?void 0:p.subGroups)==null?void 0:I.map(j=>r.jsx(Vke,{targetId:e.targetId,preview:!0,category:j,onPreviewOpen:s},j.name))}),!g&&(u==null?void 0:u.subGroups)&&r.jsx(qke,{templateGroups:u.subGroups,setThirdCategory:h,thirdCategory:f}),!g&&r.jsx("div",{className:"w-full pb-9 pt-5 grid gap-4",style:{gridTemplateColumns:"repeat(auto-fill, 360px)"},children:_.map(j=>r.jsx(X_,{targetId:e.targetId,template:j,onPreviewOpen:s},j.pageId))})]})]})},qke=({templateGroups:e,setThirdCategory:t,thirdCategory:n})=>{var c;const s=y.useRef(null),[a,o]=y.useState(0),[i,l]=y.useState(!1);return y.useEffect(()=>{var p;l(!1);const d=s.current;if(!d)return;const u=(p=d.parentElement)==null?void 0:p.clientWidth;if(!u)return;let f=0,h=Array.from(d.children).findIndex(g=>(f+=g.clientWidth+20,u-f<80));u-f<70&&h--,o(h!==-1?h+1:e.length)},[e]),e.length===0?null:r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-wrap pt-[15px] sticky top-0 bg-white2 z-10",children:[(c=e.slice(0,i?e.length:a))==null?void 0:c.map(d=>r.jsx("button",{onClick:()=>{me.event("template_category",{category_id:d.name}),t(d.name)},className:R("px-2 py-[5px] mr-5 rounded hover:bg-black_003 my-[5px] text-t2 text-grey2",n===d.name&&"bg-black_006 text-t2-medium"),children:d.name},d.name)),a!==e.length&&r.jsxs("button",{className:"text-t2 text-grey3 ml-auto animate-hover px-2 flex items-center h-[30px] self-center",onClick:()=>l(!i),children:[i?"收起":"展开",r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall",className:R("ml-1",i&&"rotate-180")})]})]}),r.jsx("div",{className:"flex pt-[15px] top-0 bg-white2 absolute w-[calc(100%-60px)] overflow-auto opacity-0",ref:s,children:e.map(d=>r.jsx("button",{className:"px-2 py-[5px] mr-5 rounded hover:bg-black_003 my-[5px] text-t2 flex-shrink-0 text-grey2",children:d.name},d.name))})]})},UF=()=>{const e=t9(),[t,n]=y.useState({canGoBack:!1,canGoForward:!1}),s=ns();y.useEffect(()=>(Eb(Ca.CanHistoryBackAndForward).then(n),s.listen(()=>{Eb(Ca.CanHistoryBackAndForward).then(n)})),[s]);const a=()=>{t.canGoBack&&window.history.back()},o=()=>{t.canGoForward&&window.history.forward()};return!gs.check||!e?null:r.jsxs("div",{className:"flex items-center",children:[r.jsx(Ys,{disabled:!t.canGoBack,size:26,className:R("mr-1 animate-hover",!t.canGoBack&&"opacity-30 cursor-not-allowed"),onClick:a,popup:r.jsxs("div",{children:["后退",r.jsx(Pp,{className:"ml-1",shortcut:"["})]}),children:r.jsx(V,{size:"xlarge",name:"IcArrowBack"})}),r.jsx(Ys,{disabled:!t.canGoForward,size:26,className:R("animate-hover",!t.canGoForward&&"opacity-30 cursor-not-allowed"),onClick:o,popup:r.jsxs("div",{children:["前进",r.jsx(Pp,{className:"ml-1",shortcut:"]"})]}),children:r.jsx(V,{size:"xlarge",name:"IcArrowForward"})})]})},Ez=()=>y.useCallback(e=>{st({$isCollapsed:e}),e?ts(Vk,"true"):localStorage.removeItem(Vk)},[]),SRe=({className:e})=>{const t=Ez(),n=yw(),s=y.useCallback(a=>{a.stopPropagation(),t(!0)},[t]);return n?null:r.jsx(Fe,{popup:r.jsxs("span",{children:["收起侧边栏",r.jsxs("span",{className:"text-grey3 px-1",children:[Ds,"+\\"]})]}),className:R("flex items-center justify-center w-5 h-5 ml-2 transition-all duration-200 rounded opacity-0 toc-collapse-trigger sm:opacity-100",e),onClick:s,children:r.jsx(V,{name:"IcFold",className:"text-grey2 animate-hover",size:"middle"})})},VF=({showInSharePage:e})=>{const t=yw(),n=pt(),s=Ez(),a=o1(),o=i=>{i.stopPropagation(),s(!1)};return!t||n&&!e&&!a||ot.embed?null:r.jsx(Fe,{popup:r.jsxs("span",{children:["展开侧边栏",r.jsxs("span",{className:"text-grey3 ml-0.5",children:[Ds,"+\\ "]})]}),className:"toc-collapse flex items-center justify-center mr-0.5 rounded animate-hover group-hover:flex relative",onClick:o,children:r.jsx(Ys,{size:28,children:r.jsx(V,{name:"IcUnfold",className:"text-grey3",size:"middle"})})})},W4=e=>{var _,x;const t=lt(),n=(_=e.pageId)!=null?_:t,s=(x=e.styleVariant)!=null?x:"default",a=px(),o=ie(),i=t9(),l=Ln(),c=a(n,!0,e.ancestorId);if(e.hideIfPageIsRoot&&c.length===1)return null;const[d,...u]=c;if(!d||l)return null;const f=SL(u,2),h=wL(u,2),p=F=>{o.dropdown({popcorn:F.currentTarget,placement:"bottom",offset:[0,8],content({onCloseModal:b}){return r.jsx("div",{className:"py-2 next-modal w-60",children:h.map(({uuid:w})=>r.jsx(Gke,{uuid:w,onCloseModal:b},"bread-".concat(w)))})}})},g=c.length>3?r.jsxs(r.Fragment,{children:[r.jsx(Fe,{popup:"查看折叠的页面路径",className:"w-5 h-5 px-1 mx-1 text-black rounded text-t2 animate-hover",onClick:p,children:"..."}),r.jsx(Cz,{})]}):null;return r.jsxs("nav",{className:"flex items-center overflow-x-auto",children:[i&&s!=="messages"&&e.showHistoryButton&&r.jsxs(r.Fragment,{children:[r.jsx(VF,{}),r.jsx(UF,{})]}),r.jsx(nP,{uuid:d.uuid,styleVariant:s},"bread-".concat(d.uuid)),g,(s==="messages"?f.slice(0,-1):f).map(({uuid:F},b)=>r.jsx(nP,{uuid:F,last:b===f.length-1,styleVariant:s},"bread-".concat(F)))]})},Gke=({uuid:e,onCloseModal:t})=>{const n=ye(e,["data"],["segments"]),{illegal:s}=mt(e),a=go(e);return n?r.jsxs(Fu,{to:a,onClick:t,className:R("flex items-center px-4 py-2 cursor-pointer animate-hover",s&&"opacity-30"),children:[r.jsx(Fn,{trigger:!1,blockId:e,className:"mr-1",defaultIcon:r.jsx(_s,{uuid:e})}),r.jsx("span",{className:"text-t2 text-ellipsis",children:s?Ts:fe(n.data.segments)||qt(n.type)})]}):null},nP=({uuid:e,last:t,styleVariant:n})=>{var c;const s=ye(e,["data"],["segments","icon"]),a=ns(),{illegal:o}=mt(e),i=go(e);if(!s)return null;const l=o?Ts:r.jsx(yl,{uuid:e});return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:R("flex items-center rounded animate-hover",n==="messages"?"text-grey3 text-t4 px-1":"mx-2 text-black text-t2 p-1",o&&"opacity-30"),onPointerDown:()=>{a.push(i),Xl.lastGoBackPath=i,Xl.tmpDisable=!0,setTimeout(()=>{Xl.tmpDisable=!1},500)},children:[((c=s.data.icon)==null?void 0:c.value)&&n!=="messages"&&r.jsx(Fn,{blockId:s.uuid,trigger:!1,className:"mr-1",iconSize:18,defaultIcon:r.jsx(_s,{uuid:e,size:"middle"})}),r.jsx(Fe,{popup:l,className:R("block text-ellipsis",t?"max-w-[238px]":"max-w-[166px]"),children:l})]}),r.jsx(Cz,{})]})},Cz=()=>r.jsx("span",{className:"w-1 pointer-events-none text-grey4 last:hidden",children:"/"}),Wke=qe(),kz=e=>{const{localKey:t,endDay:n}=e,s=ie(),a=$E(t,{endDay:n});return y.useCallback((o,i)=>{o.current&&a.showOnce&&(a.close(),s.dropdown({modalId:Wke,mask:!1,autoClose:i.autoClose,popcorn:o.current,placement:"bottom",offset:[0,8],arrow:!0,content:l=>r.jsxs("div",{className:"next-modal py-1 pl-2 pr-1 text-white text-t3-medium max-w-[270px] relative z-10 bg-black1 flex items-center justify-center",children:[r.jsx("div",{children:i.content}),r.jsx(V,{onClick:()=>{l.onCloseModal()},name:"IcToastClose",size:"middle",className:"animate-click"})]})}))},[a,s])},nk=({title:e,text:t,onClick:n,icon:s})=>r.jsx(Fe,{popup:r.jsx(jv,{title:e,text:t}),children:r.jsx("button",{className:"flex items-center justify-center w-5 h-5 rounded outline-none animate-hover",onClick:n,children:r.jsx(V,{name:s,size:"middle"})})}),jv=({title:e,text:t,className:n})=>r.jsxs("div",{className:R("p-1",n),children:[r.jsx("div",{className:"text-t4-medium text-white",children:e}),t&&r.jsx("div",{className:"text-t4-medium text-gray-300",children:t})]});const Kke=e=>{var te,Q,ne,se,ce;const{uuid:t,officialTemplates:n,currentCategory:s,from:a}=e,o=_4(t),i=Fz(),l=Js(),c=Z$(),d=Ut(),u=Dt(),{keyword:f,templates:h=[]}=ea(b2),[p,g]=y.useState(s),[_,x]=y.useState(!1),F=y.useMemo(()=>{const ae=[];return n.forEach(de=>{var ke;(ke=de.subGroups)==null||ke.forEach(Te=>ae.push("".concat(de.name,"/").concat(Te.name)))}),ae},[n]),b=ae=>{var he,Ee,ge,Se;let de=[];const ke=ae.split("/").filter(Boolean);if(ae==="myTemplate")(he=i==null?void 0:i.subGroups)==null||he.forEach(Re=>{var Ae;de.push(...(Ae=Re.templates)!=null?Ae:[])});else{const Re=n.find(Me=>Me.name===ke[0]),Ae=(Ee=Re==null?void 0:Re.subGroups)==null?void 0:Ee.find(Me=>Me.name===ke[1]);de=(ge=Ae==null?void 0:Ae.templates)!=null?ge:[],(Se=Ae==null?void 0:Ae.subGroups)==null||Se.forEach(Me=>{var Ge;de.push(...(Ge=Me.templates)!=null?Ge:[])})}return de},w=kz({localKey:Qm.COMMENT_TIPS,endDay:0}),E=y.useRef(null);let C=[];f?C=h:C=b(p);const[k,T]=y.useState(C.findIndex(ae=>ae.id===t)),v=(Q=(te=C[k])==null?void 0:te.id)!=null?Q:"",[I,j]=y.useState(v),S=Ja(),D=ln(),A=Yw(),P=ie(),[L,O]=y.useState(!0),$=rr(()=>dL({initialEntries:["/share/".concat(t)]})),M=Oe(),{role:U}=mt(I),z=cr(I);y.useEffect(()=>{$.replace("".concat(v))},[$,v]),y.useEffect(()=>{me.event("template_view",{template_id:t})},[t]),y.useEffect(()=>{setTimeout(()=>{w(E,{content:"成功分享即可获得 AI 使用次数 🎉",autoClose:!0})},1e3)},[w]),y.useEffect(()=>{if(!I)return;let ae=!0;return O(!0),S(I).finally(()=>{ae&&O(!1)}),()=>{ae=!1}},[I,S]),y.useEffect(()=>$.listen((ae,de)=>{const ke=gw(ae),Te=ke.pathname.substring(ke.pathname.lastIndexOf("/")+1);(de==="PUSH"||de==="REPLACE")&&j(he=>{if(he===Te){const Ee=Cd(ke.search);if(Ee)return Ee}return Te})}),[$]);const K=(ae,de)=>{f||P.dropdown({popcorn:de.currentTarget,placement:"bottom",content:({onCloseModal:ke})=>r.jsx(r.Fragment,{children:r.jsxs("div",{className:"bg-black/75 rounded px-2 py-1",children:[_?r.jsx("div",{className:"text-t4 text-white",children:"无更多模板"}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t4 text-white",children:"该分类下无更多模板"}),r.jsx("div",{className:"cursor-pointer text-t4 text-white underline",onClick:()=>{ke(),Ls.unstable_batchedUpdates(()=>{const Te=p.split("/").filter(Boolean),he=F.indexOf("".concat(Te[0],"/").concat(Te[1])),Ee=F[ae?he+1:he-1];if(!Ee){x(!0);return}const ge=b(Ee);g(Ee),T(ae?0:ge.length-1),O(!0)})},children:["查看",ae?"下一分类":"上一分类"].join("")})]}),r.jsx("div",{id:"triangle-up","data-popper-arrow":!0,className:"opacity-75"})]})})})};if(!v)return null;const W=k!==0,Y=k!==C.length-1,G=U===m.PermissionRole.EDITOR||U===m.PermissionRole.WRITER;let ee=null;return o?ee=((ce=(se=(ne=i==null?void 0:i.subGroups)==null?void 0:ne[0])==null?void 0:se.templates)==null?void 0:ce.find(de=>de.id===t))?"我的模板":"分享给我的模板":ee=r.jsxs(r.Fragment,{children:[p.split("/")[0],r.jsx("span",{className:"mx-2.5",children:"/"}),p.split("/")[1],r.jsx("span",{className:"ml-2.5",children:"/"}),!L&&r.jsx(W4,{ancestorId:v})]}),r.jsx(uL,{history:$,children:r.jsx(Mo.Provider,{value:wt.TEMPLATE,children:r.jsx(Vo.Provider,{value:uc.PAGE_TEMPLATE,children:r.jsxs("div",{className:"relative flex flex-col w-[1040px] h-[85.42vh] next-modal",children:[r.jsxs("div",{className:"flex w-full justify-between items-center h-[55px] px-4 flex-shrink-0",children:[r.jsxs("div",{className:"flex",children:[r.jsxs("div",{className:"flex cursor-pointer hover:opacity-80 items-center hover:normal-bg px-1 rounded",onClick:()=>D(Ve.TEMPLATE_PREVIEW),children:[r.jsx(V,{name:"IcTemplate",size:"middle"}),r.jsx("div",{className:"text-t2 ml-2",children:"模板库"})]}),r.jsx("div",{className:"flex items-center text-grey4 ml-2.5",children:"/"}),r.jsx("div",{className:"flex overflow-hidden items-center ml-2.5 text-black text-t2",children:ee})]}),r.jsxs("div",{className:"flex items-center",children:[o&&G&&r.jsx(gz,{className:"w-8 h-8 border border-solid border-grey5 rounded mr-5 ",moreColor:"black",onEdit:()=>window.open("/".concat(t)),onDelete:()=>{P.warning({title:"确认删除模板？",content:"删除后，该模板将从模板库移除并进入回收站",confirmText:"确认删除",colorType:"red",confirm:()=>{M(()=>{gr(t)}),D(Ve.TEMPLATE_PREVIEW)}})}}),r.jsx("div",{className:R("flex items-center justify-center cursor-pointer border border-solid border-grey5 w-[49px] h-8 rounded-l-l ",{"hover:normal-bg":W}),onClick:ae=>{W?Ls.unstable_batchedUpdates(()=>{var ke,Te;T(k-1);const de=(Te=(ke=C[k-1])==null?void 0:ke.id)!=null?Te:"";de!==I&&($.replace("/".concat(de)),O(!0))}):o||K(!1,ae)},children:r.jsx(V,{name:"IcArrowDateBack",size:"middle",className:R({"opacity-30":!W})})}),r.jsx("div",{className:R("flex items-center justify-center cursor-pointer border-r border-t border-b border-solid border-grey5 w-[49px] h-8 rounded-r ",{"hover:normal-bg":Y}),onClick:ae=>{Y?Ls.unstable_batchedUpdates(()=>{var ke,Te;T(k+1);const de=(Te=(ke=C[k+1])==null?void 0:ke.id)!=null?Te:"";de!==I&&($.replace("/".concat(de)),O(!0))}):o||K(!0,ae)},children:r.jsx(V,{name:"IcArrowDateNext",size:"middle",className:R({"opacity-30":!Y})})}),r.jsx(De,{ref:E,className:"ml-3",onClick:()=>{var Te;const ae=new URLSearchParams;ae.set(dn.inviteCode,d.inviteCode),ae.set(dn.spaceId,u.uuid);const de=(Te=fe(z==null?void 0:z.data.segments))!=null?Te:qt(z==null?void 0:z.type),ke="我在".concat(Na,"发现了模板《").concat(de,"》，高效又实用，你也来试试吧！点击链接，一键拷贝到你的空间 👉").concat(_n(),"/share/").concat(t,"?").concat(ae.toString());Xt(ke,{message:"🎉 成功复制模板链接，分享给好友吧！"})},children:"分享该模板"}),r.jsx(De,{colorType:"active",className:"ml-3",onClick:async()=>{const ae=C[k];if(!ae)return;await c({...ae,addCopyLimit:!ae.isCustom},a)&&A(),l(Je.COPY_PAGE_FROM_TEMPLATE,ct.basicList)},children:"使用该模板"})]})]}),L?r.jsx(xs,{className:"flex-1"}):r.jsx(pz,{uuid:I})]})})})})},Yke=e=>{const[t,n]=y.useState([]),s=Cye(),a=ie();bl(document.body,"width");const[o,i]=y.useState("");y.useEffect(()=>{s().then(c=>{var u,f;n(c!=null?c:[]);const d=c==null?void 0:c[0];d&&i("".concat(d.name,"/").concat((f=(u=d.subGroups)==null?void 0:u[0])==null?void 0:f.name))})},[s]),y.useEffect(()=>{var c;(c=e.onCategoryChange)==null||c.call(e,o)},[o]),y.useEffect(()=>{me.event("template_page",{is_from:e.from==="quickSetting"?"side_bar":"new_page"})},[e.from]);const l=c=>{a.modal({modalId:Ve.TEMPLATE_PREVIEW,content:()=>r.jsx(Kke,{uuid:c,targetId:e.targetId,currentCategory:o,officialTemplates:t,from:e.from})})};return o?r.jsx(g4.Provider,{value:e.from,children:r.jsxs("div",{className:"overflow-auto w-full h-[calc(100%-50px)] flex flex-col",children:[!t&&r.jsx(xs,{}),r.jsxs("div",{className:"flex overflow-hidden flex-1",children:[r.jsx(Mke,{officialTemplates:t,setCurrentCategory:i,currentCategory:o}),r.jsx(zke,{targetId:e.targetId,officialTemplates:t,currentCategory:o,openTemplatePreview:l})]})]})}):null},Xke=e=>{const{keyword:t,currentCategory:n}=e,s=y.useRef(null),[a,o]=y.useState(""),i=So(b2);y.useEffect(()=>{i({}),o("")},[n,i]);const l=y.useCallback(Ps(async u=>{try{const{uuid:f}=Pn();if(!u.trim()){i({});return}const h=await ve.editor.searchTemplates(u,f),{recommendResult:p=[],recordMap:g,searchResult:_,hasSearchResult:x}=h;re(Tn.update({blocks:g.blocks}));let F=[];if(x){const{my:b=[],official:w=[]}=_!=null?_:{},E=b.map(k=>wz(k)).filter(k=>!!k),C=w.map(k=>NF(k)).filter(k=>!!k);F=E.concat(C)}else F=p.map(b=>NF(b)).filter(b=>!!b);i({hasResult:x,keyword:u.trim(),templates:F})}catch(f){}},1e3),[]),c=y.useCallback(u=>{o(u),l(u)},[l]);y.useEffect(()=>{t&&c(t)},[c,t]);const d=()=>{c(""),s.current&&s.current.focus()};return r.jsx("div",{className:"h-full flex flex-shrink-0",children:r.jsx("div",{className:"px-2 flex items-center justify-between",children:r.jsxs("div",{className:"relative",children:[r.jsx(Ct,{className:"h-8 pl-10 pr-5 rounded-sm",inputClassName:"pl-0",placeholder:"搜索模板",inputRef:s,value:a,onChange:c}),r.jsx(V,{size:"normal",className:"absolute left-3 top-1.5 text-xl text-grey4 leading-none",name:"IcSearch"}),a&&r.jsx(V,{size:"normal",name:"IcUploadCancel",onClick:d,className:"absolute right-0 top-1.5 text-grey4 mr-2 w-[18px] h-[18px]"})]})})})},fp=e=>{const t=ie(),{onlyShowTab:n}=e,[s,a]=y.useState(""),[o,i]=y.useState(0),l=r.jsx(V,{name:"IcBannerClose",size:"middle",className:"animate-hover animate-click",onClick:()=>t.closeModal(Ve.TEMPLATE_CENTER)});return r.jsx("div",{children:r.jsx(tB,{onChangeTab:c=>{i(c)},childrenClassName:"h-full",headerClassName:"px-2",active:o,className:"w-[90vw] h-[90vh]",customButtons:()=>r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(Xke,{keyword:e.keyword,currentCategory:s}),l]}),children:(n===void 0||n==="template")&&r.jsx(Sk,{title:r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx("img",{src:vn.templateEmpty,className:"w-5 h-5",alt:"模板icon"}),r.jsx("h2",{children:"模板库"})]}),children:r.jsx(Yke,{targetId:e.targetId,from:e.from,onCategoryChange:c=>{a(c)}})})})})};Bke(fp);const Qke=({searchResult:e,setDisableRecommend:t,keyword:n})=>{const s=ie(),a=Oe(),o=y.useRef(null),{width:i}=bl(o),l=_g(),c=()=>{s.modal({modalId:Ve.TEMPLATE_CENTER,content:()=>r.jsx(fp,{onlyShowTab:"template",from:"titleSearch",keyword:n})})},d=u=>{s.dropdown({popcorn:u.currentTarget,placement:"top-end",offset:[0,10],content:({onCloseModal:f})=>r.jsxs("div",{className:"border rounded-sm bg-white1 text-grey3 text-t4 flex whitespace-nowrap",children:[r.jsx("button",{className:"border-r px-1.5",onClick:()=>{a(()=>{l(yt.currentSpaceViewId,{setting:{closeTemplateRecommend:!0}})}),f()},children:"永久关闭"}),r.jsx("button",{className:"px-1.5",onClick:()=>{t(!0),f()},children:"本次关闭"})]})})};return r.jsx(g4.Provider,{value:"titleSearchFooter",children:r.jsxs("div",{className:"pt-4 bg-grey9 absolute bottom-0 w-full z-[100]",children:[r.jsxs("div",{className:"flex justify-between pr-8",children:[r.jsx("p",{className:"text-t1 py-2 pl-[30px]",children:"为你找到一些模板，试试看？"}),r.jsxs("div",{className:"text-grey3 flex items-center",children:[r.jsx("button",{className:"underline mr-5",onClick:c,children:"查看更多相关模板"}),r.jsx(V,{name:"IcUploadCancel",onClick:d,className:"text-grey4",size:"middle"})]})]}),r.jsx("div",{className:"pl-8 pr-4 overflow-auto flex flex-nowrap",ref:o,children:e.map(u=>r.jsx(X_,{template:u,className:R("flex-shrink-0 mr-4",(i!=null?i:0)>800?"w-[225px]":"w-[180px]"),onPreviewOpen:()=>{t(!0)}},u.pageId))})]})})},Jke=y.memo(({uuid:e})=>{var Y,G,ee;const t=ot.print,n=Nn(),s=Js(),a=ye(e,["local","data"]),o=a==null?void 0:a.type,{data:i,local:l}=a||{},c=af(e),d=n(e,!0,oa),u=Ln(),f=Id(),{planType:h}=Dt(),p=ea(Q$,pr),g=y.useRef(),_=y.useRef(NaN),x=y.useContext(Fm),F=Oe(),b=La(e),w=We(e),E=n4(e,"segments",Uu),C=s4(e,"segments",Uu),k=o===m.BlockType.REFERENCE_COLLECTION||o===m.BlockType.REFERENCE_COLLECTION_PAGE,T=o===m.BlockType.FOLDER,v=o===m.BlockType.COLLECTION_VIEW_PAGE||o===m.BlockType.COLLECTION_VIEW||o===m.BlockType.REFERENCE_COLLECTION||o===m.BlockType.REFERENCE_COLLECTION_PAGE,I=Nr(),j=y.useMemo(()=>k?fe(a==null?void 0:a.data.segments).length>0||p:!0,[a==null?void 0:a.data.segments,k,p]),S=ai(),D=!eI(h)||S||!!(f!=null&&f.setting.closeTemplateRecommend),A=ft(e,te=>{var Q;return((Q=te==null?void 0:te.subNodes)!=null?Q:[]).length>0}),[P,L]=y.useState([]),O=((Y=J.blocks[e])==null?void 0:Y.createdAt)===((G=J.blocks[e])==null?void 0:G.updatedAt),[$,M]=y.useState(!(l||O)||T);y.useEffect(()=>{A&&(M(!0),L([]))},[A]),y.useEffect(()=>{d.setReadonly(w)},[d,w]);const U=y.useRef(null);y.useEffect(()=>{const te=U.current;if(te)return te.addEventListener("inlinedinput",E),()=>{te.removeEventListener("inlinedinput",E)}},[E]),y.useEffect(()=>(d[Pg]=g,d[fx]=_,xE(c,d),()=>{yE(c)}),[c,d]),lV(c,d),y.useEffect(()=>{Ko.activeEditorKey===c&&d.requestFocus()},[c,d]),y.useEffect(()=>{e2(d,i==null?void 0:i.segments)},[e,d,i==null?void 0:i.segments,o]),y.useEffect(()=>{const te=i==null?void 0:i.segments;(!te||te.length===0)&&d.requestFocus()},[]);const z=y.useCallback(Ps(async te=>{if(wu())return;const Q=fe(te);if(!Q){L([]);return}const{uuid:ne}=Pn(),se=await ve.editor.searchTemplates(Q,ne,"docTitle"),{recommendResult:ce,recordMap:ae,searchResult:de,hasSearchResult:ke}=se;re(Tn.update({blocks:ae.blocks}));const{my:Te=[],official:he=[]}=de!=null?de:{},ge=(ke?[...new Set(Te.concat(he))]:ce!=null?ce:[]).map(Se=>NF(Se)).filter(Se=>!!Se);L(ge)},600),[]);y.useEffect(()=>{if(w)return;const te=d.onChange.subscribe(async({previousContent:Q,previousSelection:ne})=>{const{content:se}=d;if(se===Q)return;const ce=mr(se);_.current!==d.revision&&(g.current=ce,b(ce,[Q,ne]),_.current=d.revision),!D&&!$&&z(ce)});return()=>{te.unsubscribe()}},[d,b,w,$,D,z]),y.useEffect(()=>{var te;if(!$&&!D&&o===m.BlockType.PAGE){const Q=(te=U.current)==null?void 0:te.closest(".next-space-page");if(!Q)return;Q.style.paddingBottom="400px"}},[o,D,$]);const K=y.useMemo(()=>r.jsx(a3,{className:R("break-words",Mn({outline:"0 !important"})),emptyClassName:Mn(t?{}:{selectors:{"&::after":{content:JSON.stringify(k?"视图标题":qt(o)),pointerEvents:"none",color:"var(--grey5)"},"& > br":{display:"none"}}}),ref:U,model:d,spellCheck:!1,onKeyDown:te=>{w||v||T||Ie(["ArrowDown","ArrowRight","Enter","Shift+Enter","mod+a"])(te)||C(te)}}),[o,C,d,v,T,k,t,w]);if(!i||!j)return null;const W=((ee=U.current)==null?void 0:ee.closest(".next-space-page"))||document.body;return r.jsxs("header",{...Gs(Hs.DocTitle),"data-block-id":x?e:void 0,"data-disable-select":!0,className:R("relative text-h0 whitespace-pre-wrap"),onKeyDown:te=>{var Q;if(Ie("mod+a")(te)){te.stopPropagation();return}if(Ie(["Enter","Shift+Enter"])(te)){Ju();const ne=Xa(c);if(!ne)return;const{selection:se}=ne;if(!(se!=null&&se.isCollapsed))return;if(te.shiftKey){d.performChange(Te=>{Te.delete().insert("\n")});return}if(v||T)return;const{offset:ce}=se,ae=mr(Jr(ne.content,0,ce)),de=mr(Jr(ne.content,ce,ne.content.length)),ke=(Q=J.blocks[e])==null?void 0:Q.subNodes.length;(ke===0||!ke)&&s(Je.CREATE_NEW_PAGE,ct.basicList),F(()=>{_e(e,{data:{segments:ae}});const Te=ut({data:{segments:de}},{parentId:e,first:!0});re(sr({init(){I(Te,0)},undo(){I(e,ce)},redo(){I(Te,0)}}))});return}if(!(v||T)){if(Ie("ArrowRight")(te)){const ne=Ma(e,d);if(!(ne!=null&&ne.collapsed)||!ne.isLastChar)return!1;const[se]=Nu(u);if(se){I(se.blockId,0);return}F(()=>{const ce=ut({},{parentId:e,first:!0});re(sr({init(){I(ce,0)},undo(){I(e,0)},redo(){I(ce,0)}}))})}if(Ie("ArrowDown")(te)){const ne=Ma(e,d);if(!(ne!=null&&ne.collapsed)||!ne.isLastLine)return!1;const[se]=Nu(u);se&&Lr(se.editorKey,ne.caretRect.x,0)}}},children:[K,P.length>0&&!$&&!D&&Ls.createPortal(r.jsx(Qke,{targetId:e,searchResult:P,setDisableRecommend:M,keyword:fe(i==null?void 0:i.segments)}),W)]})}),Tz=e=>(e!=null?e:1024)*.29,K4=y.memo(({uuid:e,className:t,children:n,hiddenCover:s})=>{var L,O,$,M,U;const a=ye(e,["data"],["icon","cover","showEmptyDescription","format","ref","segments"]),o=YE(e),i=(a==null?void 0:a.type)===m.BlockType.REFERENCE_COLLECTION||(a==null?void 0:a.type)===m.BlockType.REFERENCE_COLLECTION_PAGE,l=(O=(L=a==null?void 0:a.data.format)==null?void 0:L.commentAlignment)!=null?O:"top",c=Pn(),d=(c.planType===St.team||c.planType===St.freeTeam)&&o,u=Oe(),f=ft(e,z=>fe(z==null?void 0:z.data.description).length>0),[h,p]=oY("collection:".concat(e,":showDescription"),void 0),{role:g}=mt(e),_=We(e),[x,F]=pp(X$,pr),[b,w]=pp(Q$,pr),E=y.useMemo(()=>{if(i)return fe(a==null?void 0:a.data.segments).length===0},[a==null?void 0:a.data.segments,i]),C=Ce(z=>{var W,Y;return((Y=(W=z.blocks[e])==null?void 0:W.discussions)!=null?Y:[]).map(G=>z.discussions[G]).filter(G=>G!=null&&!G.resolved).length},[e]),k=!!(a!=null&&a.data.cover)&&!s,T=ja(k?document.body:void 0,{type:"height"});if(!a)return null;const v=!!(($=a.data.icon)!=null&&$.value&&a.data.icon.type),I=!(((M=a.data.icon)==null?void 0:M.type)==="emoji"||((U=a.data.icon)==null?void 0:U.type)==="icon"),j=Tz(T.height),S=v?80:ot.print?0:56,D=v?j-(I?65:45):j+10,A=k?D:S,P=[];if(!v&&!_&&P.push(r.jsx(d_,{text:"添加图标",icon:"IcIcon",className:"text-grey4 font-normal",onClick:()=>{const z=zw(!0);u(()=>{_e(e,{data:{icon:{type:"emoji",value:z}}})})}},"addIcon")),!b&&E&&!_&&P.push(r.jsx(d_,{text:"添加标题",icon:"IcTitle",className:"text-grey4 font-normal",onClick:()=>{w(!0)}},"addTitle")),!k&&!_&&P.push(r.jsx(d_,{text:"添加封面",icon:"IcImage",className:"text-grey4 font-normal",onClick:async()=>{const z=await ve.editor.getCoverImage();u(()=>{_e(e,{data:{cover:z,coverPos:50}})})}},"addCover")),ga(a.type)&&(!_||f)){const z=(h||h===void 0)&&f||a.data.showEmptyDescription;P.push(r.jsx(d_,{text:z?"隐藏说明":f?"显示说明":"添加说明",icon:"IcInfo",className:"text-grey4 font-normal",onClick:()=>{z?Ls.unstable_batchedUpdates(()=>{p(!1),_e(e,{data:{showEmptyDescription:!1}},!0)}):f?p(void 0):(p(void 0),me.event("add_description"),_e(e,{data:{showEmptyDescription:!0}},!0))}},"addDesc"))}return!pt()&&Xn(g,m.PermissionRole.COMMENTER)&&C<=0&&!d&&!x&&P.push(r.jsx(d_,{text:"添加评论",icon:"IcComment",className:"text-grey4 font-normal",onClick:()=>{F(!0)}},"addComment")),r.jsxs("div",{className:R("page-header line-default",t),children:[r.jsxs("div",{className:"group",children:[k&&r.jsx(Yg,{uuid:e}),r.jsxs("div",{className:"relative",children:[!s&&r.jsx("div",{className:"transition-all",style:{height:A}}),v&&r.jsx(Fn,{blockId:e,className:"inline-block relative z-10",iconSize:I?130:78}),!ot.print&&r.jsx("span",{className:"flex h-8 group-hover:visible",children:P})]})]}),r.jsxs("div",{children:[r.jsx(Jke,{uuid:e},e),r.jsx(xFe,{uuid:e,showDescription:h||h===void 0}),n,l==="top"&&r.jsx(y2,{pageId:e})]})]})},yn),Yg=y.memo(({uuid:e,height:t,className:n,isCardCover:s,isGalleryCard:a,isVertical:o,width:i,fitImage:l,hiddenEditorButton:c,ossName:d,shareId:u})=>{var W,Y,G,ee;const f=Js(),h=ye(e,["data"],["cover","coverPos","localUrl","size"]),p=(W=h==null?void 0:h.data.coverPos)!=null?W:50,[g,_]=y.useState(p),x=y.useRef(g),[F,b]=y.useState(!1),w=y.useRef(null),E=y.useRef(null),C=o9(),k=(Y=ja(E.current,{type:"height"}).height)!=null?Y:0,T=(G=ja(w.current,{type:"width"}).width)!=null?G:i,[v,I]=y.useState((ee=h==null?void 0:h.data.localUrl)!=null?ee:""),j=We(e),S=ie(),D=Oe(),A=y.useRef(""),P=y.useMemo(()=>{var Q;const te=(Q=d!=null?d:h==null?void 0:h.data.cover)!=null?Q:"";return f3(te)||te},[h==null?void 0:h.data.cover,d]);let L=t!=null?t:Tz(C);(s||a)&&T&&(L=T*(o?1.5:.55)),y.useEffect(()=>{if(Gu(P)){I(P);return}h!=null&&h.data.localUrl?I(h.data.localUrl):Vs.fetchImageUrl({blockId:e,ossName:P,opt:{shareId:u}}).then(te=>{const{extName:Q}=rn(P);if(A.current=Jo(te,Q),Im.test(Q)){let ne="".concat(te,"&x-oss-process=image/quality,q_100/");(a||s)&&i&&(ne=sm(te,Math.floor(a?i*2*Math.ceil(window.devicePixelRatio):i*Math.ceil(window.devicePixelRatio)))),I(Jo(ne,Q))}else I(Jo(te,Q))})},[P,h==null?void 0:h.data.localUrl,s,a,i,e,d,u]),y.useEffect(()=>_(p),[p]);const O=()=>{D(()=>{_e(e,{data:{coverPos:x.current}})}),b(!1)},$=()=>{_(p),b(!1)},{moveProps:M}=pFe({onMove(te){const Q=ne=>Number(Math.min(Math.max(ne,-(k-L))).toFixed(2));_(ne=>{let se=Q(ne-te.deltaY/5);return se<=0?se=0:se>100&&(se=100),x.current=se,se})}}),U=async te=>{let Q="";te.imageFile&&(Q=(await hI(te.imageFile)).url),D(()=>{_e(e,{data:{cover:te.ossName,coverPos:50,localUrl:Q}})})},z=()=>{D(()=>{_e(e,{data:{cover:"",localUrl:void 0}})})},K=te=>{te.currentTarget.parentElement&&S.dropdown({modalId:Ve.HEADER_COVER_IMAGE,popcorn:te.currentTarget.parentElement,placement:"bottom-end",offset:[75,0],content:({onCloseModal:Q})=>r.jsx(hFe,{blockId:e,selectImage:({ossName:ne,type:se,file:ce,url:ae})=>{if(se==="http"){D(()=>{_e(e,{data:{cover:ae,coverPos:50}})});return}U({ossName:ne,imageFile:ce}),se==="upload"&&(f(Je.GUIDE_FIRST_TIME_UPLOAD_COVER,ct.basicList),Q())},deleteCoverImage:()=>{Q(),z()}})})};return r.jsxs("div",{className:R("bg-cover group absolute top-0 left-0 w-full overflow-hidden transition-all",n),ref:w,style:{height:L},children:[F&&r.jsx("span",{className:"tran text-t4 pointer-events-none absolute top-1/2 left-1/2 z-10 -translate-x-1/2 -translate-y-1/2 rounded-sm bg-black-base/75 px-6 py-1 text-white",children:"拖动图片以调整位置"}),v&&r.jsx("div",{ref:E,children:r.jsx(Y$,{uuid:e,...F?M:{},src:v,onError:()=>{h!=null&&h.data.localUrl&&pO(h),A.current&&I(A.current)},className:R('w-full after:absolute after:top-0 after:left-0 after:h-full after:w-full after:bg-white1 after:content-[""] select-none',F?"relative z-[1] cursor-move":"pointer-events-none",l?"object-contain":"object-cover"),style:{height:L,objectPosition:"center ".concat(g,"%"),transition:"height 0.2s"}})}),!j&&!s&&!c&&!d&&r.jsxs("div",{className:R("text-t4 absolute bottom-2.5 right-[90px] z-10 flex items-center rounded-sm bg-black-base/50 text-white opacity-0 transition-opacity",F&&"opacity-100",!F&&"group-hover:opacity-100"),children:[F&&r.jsxs(r.Fragment,{children:[r.jsx("span",{onClick:O,className:"cursor-pointer border-r border-white/10 px-2 leading-[26px] hover:opacity-50",children:"保存"}),r.jsx("span",{onClick:$,className:"cursor-pointer px-2 leading-[26px] hover:opacity-50",children:"取消"})]}),!F&&r.jsxs(r.Fragment,{children:[r.jsx("span",{onClick:K,className:"cursor-pointer border-r border-white/10 px-2 leading-[26px] hover:opacity-50",children:"更换封面"}),r.jsx("span",{onClick:()=>b(!0),className:"cursor-pointer px-2 leading-[26px] hover:opacity-50",children:"调整位置"})]})]})]})}),Zke="w-5 h-6 flex items-center justify-center animate-hover rounded text-grey1 animate-hover",Y4=y.memo(({id:e})=>{const{expand:t,toggle:n}=X4(e,{defaultOpen:!0}),s=ye(e,["subNodes"]),[a,o]=y.useState(!1);if(y.useEffect(()=>{const l=c=>{o(c===e)};return xn.on("hoverId",l),()=>{xn.off("hoverId",l)}},[e]),!(s!=null&&s.subNodes.length))return null;const i=ot.print||t;return r.jsx(Fe,{popup:r.jsx("span",{children:i?"展开":"收起"}),className:R("absolute -left-5 block-before-icon-top",Zke),placement:"bottom","data-no-cancel-selected":!0,children:r.jsx(V,{size:"large",name:"IcToggleBlack",onClick:n,className:R("transition duration-150 cursor-pointer",{"rotate-90 opacity-0":i,"opacity-30":a,"opacity-100":!i})})})}),X4=(e,t)=>{const{defaultOpen:n=!1}=t||{},[s,a]=Rd(e,{defaultOpen:n}),o=Lw(),i=c=>{const d=o(c);return J.ui.selectedBlocks.some(u=>d.has(u.blockId)||u.blockId===c)};return{expand:s,toggle:()=>{if(a(!s),!i(e)){$u();return}const d=J.blocks[e];if(!d)return;const u=J.blocks[d.parentId];if(!u)return;const f=[];u.subNodes.forEach(h=>{i(h)&&f.push(h)}),Vi(f,!s)}}},Ex=e=>{const{className:t,onClick:n,children:s,...a}=e;return s?r.jsx("div",{className:R("flex items-start justify-center w-6 mr-1",t),onClick:n,...a,children:s}):null},sk={disc:"•",circle:"◦",square:"▪"},eTe=({id:e,root:t,children:n})=>{const s=Ce(({blocks:i})=>vz(e,i),[e]),[a]=Rd(e,{defaultOpen:!0}),o=ot.print||a;return r.jsxs("div",{className:"relative",children:[r.jsx(Y4,{id:e}),r.jsxs(wn,{id:e,className:"my-px",horizontal:t,children:[r.jsxs("div",{className:"block-has-icon-container flex-1",children:[r.jsx(Ex,{className:"h-7",children:r.jsx("div",{className:"pseudoBefore",style:{"--pseudoBefore--content":'"'.concat(s,'"')}})}),r.jsx(Hi,{placeholder:"项目列表",className:"self-start flex-1 w-0",uuid:e})]}),n&&o&&r.jsx(ec,{blockId:e,children:n})]})]})};function vz(e,t){var a;const n=E0(e,t,m.BlockType.LIST),s=(n==null?void 0:n.format)||(n==null?void 0:n.defaultFormat);return s&&(a=sk[s])!=null?a:sk.disc}const tTe=({id:e,root:t,children:n})=>{Pa();const s=ye(e,["textColor","backgroundColor"]),a=We(e);if(!s)return null;const o=Iz(s.textColor,s.backgroundColor);return r.jsx(wn,{id:e,className:"border border-transparent my-1 rounded",horizontal:t,style:{borderColor:o},children:r.jsxs(tz,{id:e,readonly:a,className:"pr-4 leading-8",onChange:i=>{l2({icon:i})},children:[r.jsx(wn,{dropInChild:!0,className:"my-1 overflow-auto",bindId:!1,id:e,children:r.jsx(Hi,{uuid:e,className:"leading-6",placeholder:"着重文字"})}),n&&r.jsx("div",{className:"-ml-0.5 mb-1",children:n})]})})},Iz=(e,t)=>{if(!e&&!t&&KS(e||Ze.grey),!t)return KS(e||Ze.grey)},nTe=({uuid:e})=>{const t=ye(e,["data"],["segments","level"]);if(!t)return null;const{segments:n,level:s}=t.data;return r.jsx(fs,{segments:n,className:R("w-full font-bold",{"text-[24px]":s===1,"text-[19px]":s===2,"text-[16px]":s===3,"text-[14px]":s===4})})},sTe=({uuid:e,children:t})=>{const n=ye(e,["data"],["segments"]);if(!n)return null;const{segments:s}=n.data;return r.jsxs(r.Fragment,{children:[r.jsx(fs,{segments:s,className:"text-t4 py-0.5 whitespace-break-spaces"}),t&&r.jsx(Xg,{children:t})]})},rTe=({uuid:e,children:t})=>{const n=ye(e,["textColor","backgroundColor","data"],["segments"]);if(!n)return null;const{segments:s}=n.data,a=Iz(n.textColor,n.backgroundColor);return r.jsxs("div",{style:{borderColor:a},children:[r.jsxs("div",{className:"flex pl-1 py-0.5",children:[r.jsx(Fn,{blockId:e,hideRemoveBtn:!0,trigger:!1,iconSize:18,defaultEmoji:"💡"}),r.jsx(fs,{segments:s,className:"text-t4 w-full ml-2 overflow-hidden"})]}),t&&r.jsx(Xg,{children:t})]})},aTe=({uuid:e,children:t})=>{const n=ye(e,["data"],["checked","segments"]);if(!n)return null;const{checked:s,segments:a}=n.data;return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex text-t4 py-0.5",children:[r.jsx(V,{size:"middle",name:s?"IcCheckbox2Check":"IcCheckbox2",className:R("mt-0.5 mr-1.5 w-[18px] h-[18px]",s?"text-active_color":"")}),r.jsx(fs,{className:R("flex-1 mr-4",s?"opacity-50":"no-underline",{"line-through":s}),segments:a})]}),t&&r.jsx(Xg,{children:t})]})},oTe=({uuid:e,children:t})=>{const n=ye(e,["data"],["segments"]);if(!n)return null;const{segments:s}=n.data,a=vz(e,pe().blocks);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex text-t4 flex-1 py-0.5",children:[r.jsx("div",{className:"pseudoBefore pt-0.5 w-6 flex justify-center",style:{"--pseudoBefore--content":'"'.concat(a,'"')}}),r.jsx(fs,{className:"self-start flex-1",segments:s})]}),t&&r.jsx(Xg,{children:t})]})},iTe=({uuid:e,children:t})=>{const n=ye(e,["data"],["segments"]);if(!n)return null;const{segments:s}=n.data,a=t4(e,pe().blocks);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex text-t4 flex-1 py-0.5",children:[r.jsx("div",{className:"min-w-[24px] mr-1 text-center inline-block dot",children:a}),r.jsx(fs,{className:"self-start flex-1",segments:s})]}),t&&r.jsx(Xg,{children:t})]})},lTe=({uuid:e})=>{const t=ye(e,["subNodes","data"],["segments"]);if(!t)return null;const{segments:n}=t.data;return r.jsxs("div",{className:"flex text-t4 ignore-focus-click flex-1 overflow-hidden py-0.5",children:[r.jsx("span",{className:"flex",children:r.jsx(V,{size:"middle",name:"IcToggleBlack",className:R("transform duration-150 cursor-pointer",{"opacity-30":t.subNodes.length===0})})}),r.jsx(fs,{className:"self-start mr-4 flex-1 w-0",segments:n})]})},cTe=({uuid:e,children:t})=>{const n=ye(e,["data"],["segments"]);if(!n)return null;const{segments:s}=n.data;return r.jsxs("div",{className:"border-l-[3px] border-solid border-current py-0.5",children:[r.jsx("div",{className:"pl-2",children:r.jsx(fs,{className:"w-full text-t4 px-0.5",segments:s})}),t&&r.jsx(Xg,{children:t})]})},dTe=({uuid:e})=>{var s,a,o,i;const t=ye(e,["data"],["ref","display"]),n=t==null?void 0:t.type;if(!t)return null;switch(n){case m.BlockType.REFERENCE_COLLECTION_PAGE:case m.BlockType.PAGE:{let l=e;return n===m.BlockType.REFERENCE_COLLECTION_PAGE&&(l=(a=(s=t.data.ref)==null?void 0:s.uuid)!=null?a:""),r.jsx(Ir,{uuid:l,className:"flex text-t4 p-0.5",autoIconSize:!0})}case m.BlockType.REFERENCE:{if(t.data.display==="linkPage"&&((o=t.data.ref)!=null&&o.uuid))return r.jsx(Ir,{uuid:(i=t.data.ref)==null?void 0:i.uuid,isLinkPage:!0,className:"flex text-t4 py-0.5",autoIconSize:!0});break}}return null},Xg=e=>e.children?r.jsx("div",{className:"relative pl-6",children:e.children}):null,uTe=e=>{switch(e){case m.BlockType.TEXTAREA:return sTe;case m.BlockType.HEADER:return nTe;case m.BlockType.MARK:return rTe;case m.BlockType.TODO:return aTe;case m.BlockType.LIST:return oTe;case m.BlockType.ORDER_LIST:return iTe;case m.BlockType.FOLD_LIST:case m.BlockType.TOGGLE_HEADER:return lTe;case m.BlockType.QUOTE:return cTe;default:return dTe}},Nz=({uuid:e,renderIds:t})=>{const n=ye(e,["subNodes"]),s=lx(e),a=uTe(n==null?void 0:n.type),o=iY(n==null?void 0:n.subNodes,t),i=y.useMemo(()=>o.map(l=>r.jsx(Nz,{uuid:l,renderIds:t},l)),[o,t]);return n?r.jsx("div",{style:s,className:"pointer-events-none",children:r.jsx(a,{uuid:e,children:i})}):null},fTe=({recordId:e})=>{const{ids:t=[],imageBlockId:n=ase(e)}=ose(e),{viewId:s,viewType:a}=Ne(),o=Bi(s),i=Li(s);if(!ft(e,u=>u==null?void 0:u.subNodes.length))return null;if(n)return r.jsx(mTe,{uuid:n});const c=a===m.CollectionViewType.GALLERY,d={width:c?void 0:ji(o,i),height:c?void 0:fre[o]};return t.length>0?r.jsx("div",{className:"w-full h-full p-2 overflow-hidden opacity-60 bg-grey7 border-b border-black_006",style:d,children:t.map((u,f)=>{var p,g;const{blocks:h}=pe();return t.slice(0,f).includes((g=(p=h[u])==null?void 0:p.parentId)!=null?g:"")?null:r.jsx(Nz,{root:!0,uuid:u,renderIds:t},u+f)})}):null},mTe=({uuid:e})=>{const{viewId:t,viewType:n}=Ne(),s=Bi(t),a=mE(t),o=Li(t),i=n===m.CollectionViewType.GALLERY,l=ji(s,o),c={width:i?void 0:l,height:i?void 0:l*iT(o)},{url:d,formatUrl:u,srcSetParams:f}=U4(e,{containerWidth:l,defaultWidth:l}),h=a===m.CoverAspectType.CONTAIN?"object-contain":"object-cover";return r.jsx(I2,{srcSetParams:f,blockId:e,style:c,className:R("w-full h-full flex items-center justify-center border-b border-black/[0.06]",h),url:d,formatUrl:u})},hTe=({recordId:e})=>{var b;const{viewId:t,viewType:n}=Ne(),s=y.useRef(null),a=(b=ja(s.current))==null?void 0:b.width,o=ye(e,["data"]),i=Bi(t),l=Li(t),{previewType:c,previewProperty:d}=Wm(t),u=mE(t),f=n===m.CollectionViewType.GALLERY,p=n===m.CollectionViewType.BOARD&&c===m.CoverType.PAGE_COVER&&(o==null?void 0:o.data.cover)||f&&c===m.CoverType.PAGE_COVER,[g,_]=y.useState(!1);y.useEffect(()=>{if(g)return;const w=s.current;w&&(f&&(w.style.height="".concat(w.clientWidth*iT(l),"px")),_(!0))},[l,f,g]);const x=()=>{var w;if(d)return r.jsx(pTe,{recordId:e,propertyId:d});if(p)return r.jsx(Yg,{className:"relative rounded-t border-b border-black_006",uuid:e,fitImage:u===m.CoverAspectType.CONTAIN,width:(w=s.current)==null?void 0:w.clientWidth,isGalleryCard:f,isVertical:l===m.CollectionCardImageDir.VERTICAL,isCardCover:!0});if(c===m.CoverType.PAGE_CONTENT)return r.jsx(fTe,{recordId:e})},F=ji(i,l);return r.jsx("div",{ref:s,style:{height:f?(a!=null?a:F)*iT(l):void 0},className:"flex items-center overflow-hidden",children:g&&x()})},pTe=({recordId:e,propertyId:t})=>{var g;const{viewId:n,viewType:s}=Ne(),a=mE(n),o=(g=Km(e,t))!=null?g:[],[i,l]=y.useState(!1),c=Bi(n),d=Li(n),u=o.find(_=>_.type===m.TextType.URL&&_.fileStorageType==="internal"&&(!_.size||_.size<=xx));if(!u||!Jp(u.url)||i)return null;const h=ji(c,d),p=s===m.CollectionViewType.GALLERY;return r.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:r.jsx(ah,{className:R("object-center border-b border-black_006",a===m.CoverAspectType.CONTAIN?"object-contain h-full w-auto":"object-cover w-full h-full"),uuid:e,ossName:u.url,defaultIcon:r.jsx(xs,{className:"text-grey3",description:"加载中..."}),options:{resizeWidth:Math.round((p?h*1.2:h)*window.devicePixelRatio),hideVideoIcon:!0,onError:()=>l(!0)}})})},gTe=({recordId:e})=>{const{viewId:t,managerReadonly:n,readonly:s,viewType:a}=Ne(),o=a===m.CollectionViewType.GALLERY,i=A0(),l=ie(),c=Ks(),d=We(e,!1),u=ag(),f=e===(u==null?void 0:u.id)&&t===u.viewId,h=ys();if(s||n||d)return null;const p=_=>{_.stopPropagation(),f?h(e,{forceOpenInRight:!0}):st({$newCreatedRecord:{id:e,viewId:t}})},g=_=>{_.stopPropagation(),_.preventDefault();const{selectedBlocks:x}=J.ui,F=_.currentTarget.getBoundingClientRect(),b={getBoundingClientRect:()=>F},{modalId:w}=l.dropdown({modalId:e,popcorn:b,placement:"right-start",closeBeforeCallBack:i,content:({onCloseModal:C})=>r.jsx(_Te,{popcorn:b,onCloseModal:C,blockId:e,viewId:t})}),E=x.findIndex(C=>C.blockId===e)===-1?Bu(e,t,c):x;st({$blockMenuListId:w}),re(at.update({selectedBlocks:E,selectedCells:[]}))};return r.jsxs("div",{className:R("operator-button absolute right-1.5 z-10 flex opacity-0 transition duration-300",o?"top-1.5":"top-[9px]"),children:[r.jsx(Fe,{className:"ml-2 flex items-center transition duration-300",placement:"bottom",popup:f?"右侧边栏打开":"编辑",children:r.jsx("button",{onClick:p,className:"animate-hover-opaque flex h-6 w-6 cursor-pointer items-center justify-center rounded-l-l border-y border-l border-grey6 bg-white1",children:r.jsx(V,{name:f?"IcBlockRightSidebarOpen":"IcEdit",size:"small",className:"text-grey3"})})}),r.jsx(Fe,{className:"flex items-center transition duration-300",placement:"bottom",popup:"点击打开菜单",children:r.jsx("button",{onClick:g,className:"animate-hover-opaque flex h-6 w-6 cursor-pointer items-center justify-center rounded-r border border-grey6 bg-white1",children:r.jsx(V,{name:"IcMore",size:"middle",className:"text-grey3"})})})]})},_Te=e=>{var w;const{onCloseModal:t,blockId:n,popcorn:s,viewId:a}=e,{illegal:o,role:i}=mt(n),l=ye(n,["updatedBy","updatedAt","data"],["isByAI"]),c=Oe(),d=TU(),u=Pd(),{selectedBlockHistory:f}=Nl(),h=pt(),p=Pi((l==null?void 0:l.updatedBy)||""),g=w4(),_=_r((w=p==null?void 0:p.uuid)!=null?w:""),x=ys(),F=[m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(i);if(!l)return null;const b=[{type:H.OPERATION,data:{type:5,icon:"IcOpenInSide",title:"在侧边栏中打开"}},{type:H.OPERATION,data:{type:1,icon:"IcTrash",title:"删除"}},{type:H.OPERATION,isHidden:o,data:{type:2,icon:"IcDuplicate",title:"拷贝副本"}},{type:H.OPERATION,isHidden:o||!Xn(mn(l.parentId).role,m.PermissionRole.WRITER),data:{type:3,icon:"IcCopyToPage",title:"拷贝副本至页面"}},{type:H.OPERATION,data:{icon:"IcLink",title:"拷贝页面访问链接",onClick:()=>{me.event("copy_page_link"),Xt("".concat(_n(),"/").concat(n))},rightText:"F"}},{type:H.LINE,data:{},disableClick:!0},{type:H.OPERATION,data:{icon:"IcEditProperty",title:"编辑属性",hasArrow:!0,renderSubMenu:()=>r.jsx(EH,{popcorn:s,blockId:l.uuid,collectionId:l.parentId,selectedBlocks:J.ui.selectedBlocks})}},{type:H.OPERATION,data:{type:4,icon:"IcMove",title:"移动到"}},{type:H.LINE,isHidden:!(F&&!h),data:{},disableClick:!0},{type:H.OPERATION,isHidden:!(F&&!h),data:{icon:"IcArrowUp02",title:"在上方插入块",rightText:"A",onClick:()=>{g({pos:"before"})}}},{type:H.OPERATION,isHidden:!(F&&!h),data:{icon:"IcArrowDown02",title:"在下方插入块",rightText:"B",onClick:()=>{g({pos:"after"})}}},{type:H.LINE,data:{},disableClick:!0}];return r.jsx(ze,{className:"py-2 rounded next-modal w-[260px]",items:b,customFooter:F&&!h&&r.jsx(Zm,{name:_,updatedAt:l.updatedAt,isByAI:l.data.isByAI}),onItemClick:async E=>{const{type:C}=E.data;C===1&&c(()=>{gr(lr(J.ui.selectedBlocks))}),C===2&&d(a,J.ui.selectedBlocks,{effects:f}),C===4&&u({popcorn:s,uuid:n,placement:"left",offset:[0,20]}),C===3&&u({popcorn:s,uuid:n,placement:"left",offset:[0,20],placeholder:"搜索拷贝到...的页面",copyAndMove:{viewId:a}}),C===5&&x(n,{forceOpenInRight:!0}),t()}})},xTe=({recordId:e})=>{var F,b,w;const{viewId:t,viewType:n,tableCellWrap:s}=Ne(),a=ur(),o=ye(e,["subNodes","data"],["segments","icon"]),[i=[]]=Fa(t),{previewType:l}=Wm(t),c=l===m.CoverType.NONE,d=n===m.CollectionViewType.GALLERY,u=ag(),f=e===(u==null?void 0:u.id)&&t===u.viewId,h=((F=o==null?void 0:o.subNodes)!=null?F:[]).length>0||!!((b=o==null?void 0:o.data.icon)!=null&&b.type),p=Cg(t),[g,_]=y.useState(!1);return y.useEffect(()=>{_(f);const E=()=>{st({$newCreatedRecord:void 0})};return f&&document.addEventListener("click",E),()=>{document.removeEventListener("click",E)}},[f]),!((w=i.find(E=>E.property==="title"))==null?void 0:w.visible)||!o?null:r.jsxs("div",{className:R("page-title space-x-1",d?"my-1.5 px-3":"my-1 px-2",g&&"cursor-text"),onClick:E=>{g&&E.stopPropagation()},children:[(h&&!f||d&&c||g)&&p&&r.jsx(Fn,{className:"inline-block p-0 align-middle",tooltipClassName:"align-middle",blockId:e,trigger:g,iconSize:16,defaultIcon:r.jsx(_s,{uuid:e,size:"small"})}),g?r.jsx(ci,{uuid:e,className:"text-t2-medium inline whitespace-pre-wrap break-words align-middle",plugins:oa,keydownOption:{bracketRightKey:!1},placeholder:fo,autoFocus:!0,toolbar:!1,autoFocusCaretToEnd:!0,segments:o.data.segments,interactable:f,onChange:E=>a(e,"title",E),onKeyDown:E=>{if(Ie("mod+a")(E)){E.stopPropagation();return}(Ie("enter")(E)||Ie("esc")(E))&&st({$newCreatedRecord:void 0})}}):r.jsx(fs,{className:R("text-t2-medium inline break-words align-middle",{"text-ellipsis":!s,"whitespace-pre-wrap":s}),plugins:oa,segments:o==null?void 0:o.data.segments,placeholder:fo,interactable:!1}),r.jsx(nh,{className:"inline-flex align-middle pointer-events-none",blockId:e})]})},yTe=e=>{const{parent2ChildMap:t}=Mg(),{viewId:n}=Ne(),s=t==null?void 0:t.get(e.recordId);return Il(n)!=="Card"?null:r.jsx(r.Fragment,{children:s==null?void 0:s.map(o=>r.jsx(Cs,{popup:"按住Alt点击可右侧打开",delay:{open:1e3},flexCenter:!1,className:"inline",children:r.jsx(Ir,{interactable:!0,uuid:o,autoIconSize:!0,className:R("text-t4 leading-none p-0 mr-2 whitespace-nowrap text-ellipsis")})},o))})},Cx=({recordId:e})=>{var v,I;const{viewId:t,collectionId:n,viewType:s,tableCellWrap:a}=Ne(),o=We(e),i=Il(t),l=ur(),c=vs(t),d=ye(e,["data","createdAt","updatedAt"],["schema","collectionProperties"]),u=ft(n,j=>j==null?void 0:j.data.schema),f=$n(n),h=E8(t);if(!c||!d||!u)return null;const p=gn(c),g=(v=p==null?void 0:p.properties)!=null?v:[],_=[],x=s===m.CollectionViewType.LIST,F=s===m.CollectionViewType.TIMELINE,b=s===m.CollectionViewType.CALENDAR,w=x||F?Ye.LIST:b?Ye.CALENDAR:Ye.CARD,E=(I=d.data.collectionProperties)!=null?I:{},C=!a||x||F||b,k=[];if(g.forEach(j=>{var $,M,U,z,K;if(!j.visible)return;const S=j.property;if(S==="title")return;const D=u[S];if(!D)return;let A=D.type;if(A===m.CollectionSchemaType.ID_NUMBER)return;let P=($=E[S])!=null?$:[];A===m.CollectionSchemaType.FORMULA&&(A=f.getTypeAsCollectionSchemaType(S),P=(M=f.getValueAsSegments(e,S))!=null?M:[]);const L=r.jsx("span",{className:"mr-1.5 text-t4 text-grey3 text-ellipsis h-full flex-shrink-0 w-1/5 pt-0.5",children:D.name});k.push(L);const O=w===Ye.CARD&&h?r.jsx("div",{className:R("text-t4 min-w-[20px] break-words py-0.5 whitespace-nowrap"),children:r.jsx("span",{className:"text-t4 text-grey4",children:Wa.isEmpty})}):null;switch(A){case m.CollectionSchemaType.TEXT:{fe(P)?_.push(r.jsx("div",{className:R("text-t4 min-w-[20px] break-words py-0.5",!C&&"whitespace-pre-wrap"),children:r.jsx(fs,{className:R(C&&"text-ellipsis"),segments:P,interactable:!0})})):_.push(O);break}case m.CollectionSchemaType.NUMBER:{let W,Y;W=fe(P);let G=parseFloat(W);Number.isNaN(G)&&(G=parseFloat((z=(U=W.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:U[0])!=null?z:""));const{numberFormat:ee,showAs:te}=D;W=(K=hl(G,ee))==null?void 0:K.toString();const{showNumber:Q}=te!=null?te:{};typeof G<"u"&&(Y=E1({num:Math.max(0,G),showAs:te,numberFormat:ee,from:"property-value"})),W?_.push(r.jsxs("div",{className:R("text-t4 flex min-w-[20px] items-center break-words py-0.5 min-h-[22px]"),children:[(te&&Q||!te)&&r.jsx("span",{className:R(C&&"text-ellipsis","flex-shrink-0"),children:W}),Y]})):_.push(O);break}case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:{let W;if(A===m.CollectionSchemaType.CREATED_AT||A===m.CollectionSchemaType.UPDATED_AT)W=ue(A===m.CollectionSchemaType.CREATED_AT?d.createdAt:d.updatedAt).format(On);else if(A===m.CollectionSchemaType.DATE){const Y=P==null?void 0:P.find(G=>G.type===m.TextType.DATE||G.type===m.TextType.DATETIME);Y&&(W=Yp(Y,D.dateFormat,(Y==null?void 0:Y.type)===m.TextType.DATETIME,D.timeFormat))}W?_.push(r.jsx("div",{className:R("text-t4 flex min-w-[20px] items-center break-words py-0.5"),children:r.jsx("span",{className:R(C&&"text-ellipsis"),children:W})})):_.push(O);break}case m.CollectionSchemaType.CHECKBOX:{const W=fe(P),Y=us(W);_.push(r.jsxs("div",{className:R("text-t4 pointer-events-auto flex min-w-[20px] items-center justify-start break-words py-0.5"),children:[r.jsx("button",{className:"flex items-center",disabled:o,onClick:G=>{G.stopPropagation(),l(e,S,Y?"NO":"YES")},children:r.jsx(V,{size:"small",className:Y?"text-active_color":"",name:Y?"IcCheckbox2Check":"IcCheckbox2"})}),(w!==Ye.CARD||!h)&&r.jsx("span",{className:R("ml-[7px]",C&&"text-ellipsis"),children:D.name})]}));break}case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{fe(P)?_.push(r.jsx("div",{className:R("flex-1 text-t4 break-words"),children:r.jsx(p2,{site:w,recordId:e,multiple:A===m.CollectionSchemaType.MULTI_SELECT,propertyId:S,className:R(C&&"whitespace-nowrap"),itemClassName:R("text-t4 mr-1",b?"my-[1px]":"my-0.5",!C&&"max-w-[calc(100%-6px)]")})})):_.push(O);break}case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.URL:{if(Oi(P)){const W=Af(A);_.push(r.jsx("div",{className:R("text-t4 relative min-w-[20px] break-words py-0.5",C&&"text-ellipsis",b&&"py-[1px]"),children:r.jsx(W,{site:w,recordId:e,propertyId:S})}))}else _.push(O);break}case m.CollectionSchemaType.FILE:{if(P.filter(Y=>Y.type===m.TextType.URL&&Y.fileStorageType==="internal").length>0){const Y=Af(A);_.push(r.jsx("div",{className:R("text-t4 relative min-w-[20px] text-ellipsis break-words",!C&&"max-w-[calc(100%-6px)]"),children:r.jsx(Y,{site:w,recordId:e,propertyId:S})}))}else _.push(O);break}case m.CollectionSchemaType.CREATED_BY:case m.CollectionSchemaType.UPDATED_BY:case m.CollectionSchemaType.PERSON:{if(A===m.CollectionSchemaType.CREATED_BY&&!d.createdAt||A===m.CollectionSchemaType.UPDATED_BY&&!d.updatedAt||A===m.CollectionSchemaType.PERSON&&P.filter(Y=>Y.type===m.TextType.USER).length===0){_.push(O);break}const W=Af(A);_.push(r.jsx("div",{className:R("text-t4 relative min-w-[20px] text-ellipsis break-words",!C&&"max-w-[calc(100%-6px)]"),children:r.jsx(W,{site:w,recordId:e,propertyId:S})}));break}case m.CollectionSchemaType.RELATION:{const W=Af(A);if(wc(e,S).relationRecords.length===0&&b)return;_.push(r.jsx("div",{className:R("text-t4 flex min-w-[20px] items-center break-words py-0.5",C&&"whitespace-nowrap"),children:r.jsx(W,{site:w,recordId:e,propertyId:S})}));break}case m.CollectionSchemaType.ROLLUP:{const W=Af(A);_.push(r.jsx("div",{className:R("text-t4 flex min-w-[20px] items-center break-words overflow-hidden",!b&&"py-0.5",C&&"text-ellipsis whitespace-nowrap"),children:r.jsx(W,{site:w,recordId:e,propertyId:S})}));break}}}),i==="Card"&&_.push(r.jsx(yTe,{recordId:e})),_.length<=0)return null;const T=_.map((j,S)=>j?r.jsxs("div",{className:R("flex",(x||F)&&"ml-5 items-center"),children:[w===Ye.CARD&&h&&k[S],r.jsx("div",{className:R("flex-1",w===Ye.CARD?"w-0":"",b&&"overflow-hidden"),children:j})]},S):null);return x?r.jsx("div",{className:"flex overflow-hidden",children:T}):F||b?r.jsx(r.Fragment,{children:T}):r.jsx("div",{className:"mt-[5px] mb-2 px-2",children:T})},Q4=fn.memo(e=>{const{recordId:t,groupValue:n,subGroupValue:s}=e,{viewId:a,viewType:o}=Ne(),i=ye(t,[]),{illegal:l}=mt(t),c=ys(),d=y.useRef(null),{previewType:u}=Wm(a),f=u===m.CoverType.NONE,h=li(a),p=o===m.CollectionViewType.GALLERY;if(!i)return null;const g=_=>{const x=_.target.closest("a");if(x&&_.currentTarget.contains(x)||_.target.closest(".inline-page"))return;c(t,{illegal:l,onOpenInRight:()=>{var w;if(p){const E=(w=d.current)==null?void 0:w.closest(".block-list");E&&(E.style.width="".concat(E==null?void 0:E.clientWidth,"px"),setTimeout(()=>{E.style.width="unset"},1e3))}},forceOpenInRight:_.altKey,openWay:h,forceOpenNewTab:_.ctrlKey||_.metaKey})};return r.jsx(wn,{id:t,viewId:a,blockRef:d,hideHoverMenu:!0,"data-draggable":!0,horizontal:p,groupValue:n,subGroupValue:s,"data-only-horizontal":p,onClick:g,"data-no-cancel-selected":!0,className:R("sub-group-card relative w-full list-none next-modal shadow-modal-sm cursor-pointer animate-hover overflow-auto",l&&"opacity-30",p&&"h-full",f?"min-h-[38px]":"min-h-[48px]"),style:{scrollbarWidth:"none"},children:l?r.jsxs("div",{className:"text-t2-medium whitespace-pre-wrap break-words px-2 py-2",children:[r.jsx(Fn,{className:"mr-1 inline p-0 align-middle",blockId:t,trigger:!1,iconSize:20,defaultIcon:r.jsx(_s,{uuid:t,size:"middle"})}),r.jsx("span",{className:"border-b border-grey6",children:Ts})]}):r.jsxs(r.Fragment,{children:[!f&&r.jsx(hTe,{recordId:t}),r.jsx(d4,{recordId:t,className:"mt-1 mx-0"}),r.jsx(xTe,{recordId:t}),r.jsx(Cx,{recordId:t}),r.jsx(c4,{className:"mb-1",recordId:t}),r.jsx(gTe,{recordId:t})]})})}),jz=e=>{const t=y.useRef(null),[n,s]=y.useState(!1);return y.useEffect(()=>{var l,c;const a=t.current;if(!a)return;a.style.height="".concat((c=(l=a.previousElementSibling)==null?void 0:l.clientHeight)!=null?c:200,"px"),a.style.borderWidth="1px";const o=d=>{d.forEach(u=>{s(()=>u.isIntersecting?(a.style.height="unset",a.style.borderWidth="0px",!0):(a.style.height="".concat(a.offsetHeight,"px"),a.style.borderWidth="1px",!1))})},i=new IntersectionObserver(o,{rootMargin:"600px 0px"});return i.observe(a),()=>i.disconnect()},[]),r.jsx("div",{ref:t,className:"rounded cursor-pointer","data-card-id":e.recordId,children:n&&r.jsx(Q4,{...e})})},Sz=()=>{const{viewId:e,readonly:t,managerReadonly:n,isLocked:s}=Ne(),{tableGroups:a}=of(e),{hiddenGroups:o=[]}=a!=null?a:{},i=Bi(e),l=Li(e),c=x2(),d=qN();return t&&n||o.length===0?null:r.jsx("div",{className:"ml-2.5 flex-shrink-0 bg-white1",style:{width:ji(i,l)},"data-disable-select":!0,children:r.jsxs("div",{className:"rounded-md bg-grey/5 p-[5px] px-1",children:[r.jsx("div",{className:"text-t2 flex h-[38px] w-full items-center pl-[4px] text-grey4",children:"隐藏分组"}),r.jsx(br,{disabled:t||n||s||!d,items:o.map(u=>({id:u.value,...u})),onChange:(u,f)=>c(e,f),renderItemContent:({item:u})=>r.jsx(bTe,{groupName:u.value,recordIds:u.recordIds})})]})})},bTe=({groupName:e,recordIds:t})=>{const{viewId:n}=Ne();return sf(n)?r.jsxs("div",{className:"group animate-hover-black3 flex h-[38px] cursor-pointer items-center justify-between rounded-sm px-1",children:[r.jsx("div",{className:"flex items-center",style:{maxWidth:"calc(100% - 40px)"},children:r.jsx(vE,{groupName:e,scene:Y0.HIDDEN_GROUP})}),r.jsx("span",{className:"mx-1.5 text-grey4",children:t.length}),r.jsx(p4,{visible:!1,className:"ml-auto mr-2 text-grey3 opacity-0 group-hover:opacity-100",groupName:e})]}):null},FTe=()=>{const{viewId:e,managerReadonly:t,isLocked:n,readonly:s,embed:a}=Ne(),{tableGroups:o}=of(e),{visibleGroups:i}=o!=null?o:{},l=x2(),c=qN();return i?r.jsxs("div",{className:"flex pt-4 border-t border-grey6",children:[r.jsx(br,{className:"flex",isHorizontalAxis:!0,disabled:t||n||!c,strategy:tw,modifiers:[ew,H1],items:i.map(d=>({id:d.value,...d})),onChange:(d,u)=>l(e,u),onlyHandleDraggable:!0,renderItemContent:({item:d,listeners:u})=>r.jsx(za,{recordIds:d.recordIds,children:r.jsx(wTe,{recordIds:d.recordIds,groupName:d.value,groupProperty:d.groupProperty,listeners:u})})}),r.jsx(Ou,{}),r.jsx(Sz,{}),!s&&!a&&r.jsx(Di,{type:"collection"})]}):null},wTe=e=>{Pa();const{groupProperty:t,groupName:n,recordIds:s,listeners:a}=e,{viewId:o,embed:i}=Ne(),l=_2(o),c=fE(o,Qo(n)),d=Bi(o),u=Li(o),f=th(o),{recordIds:h}=Tc(),p=yr();if(!p.current)return null;const g={height:"fit-content",width:ji(d,u)+10,backgroundColor:l?h3(c==null?void 0:c.color):void 0};return r.jsxs("div",{"data-is-empty":s.length===0?!0:null,"data-is-board":!0,"data-group-property":t,"data-group-value":n,"data-view-id":o,style:{width:ji(d,u)+10},className:R("mr-2.5 h-full flex flex-col board-group group"),children:[r.jsx(K$,{groupName:n,recordIds:s,listeners:a}),r.jsxs("div",{style:g,className:R("w-full relative flex-1 block-list flex flex-col items-center rounded-b-md pb-[5px] px-[5px]",l&&"bg-grey/5"),children:[r.jsx(qs,{className:"w-full",customScrollParent:p.current,overscan:Dn,increaseViewportBy:Dn,totalCount:h.length,itemContent:_=>{const x=h[_];return x?r.jsx("div",{className:"py-1","data-card-id":x,children:r.jsx(Q4,{recordId:x,groupValue:n})},x):null}}),!i&&r.jsx(zu,{type:"board"}),f&&r.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-black/30 opacity-0 group-hover:opacity-100"}),r.jsx(hf,{}),r.jsx(mf,{where:{after:s[s.length-1]},groupName:n,color:l?c==null?void 0:c.color:void 0})]})]})};const ETe=()=>{var n,s,a;const e=lt(),t=ye(e,["data"],["pageFixedWidth","directoryMenu"]);return(a=(s=(n=t==null?void 0:t.data)!=null?n:{})==null?void 0:s.pageFixedWidth)!=null?a:!0},kx=y.memo(e=>{const{isSubGroup:t=!1,tableGroup:{recordIds:n,value:s,visible:a},isInTable:o,index:i}=e,{viewId:l,readonly:c,managerReadonly:d,embed:u,isColumnListChildren:f,isFoldListChildren:h,viewType:p}=Ne(),g=ig(l,s),_=Un(),x=y.useRef(null),F=p===m.CollectionViewType.TIMELINE,b=ETe();y.useEffect(()=>{if(!u&&!(F&&!o)||ot.print)return;const E=x.current,C=E==null?void 0:E.closest(".next-space-page");if(!C||!E)return;const k=()=>{var D;const T=E.parentElement,v=T==null?void 0:T.getBoundingClientRect();if(!v)return;const I=C.getBoundingClientRect(),j=F&&!o?74:0,S=I.y+j;if(S>v.y){let A=Math.abs(S-v.y);const P=T==null?void 0:T.nextSibling;if(P){const O=P.getBoundingClientRect();O.y-S<E.clientHeight&&(A=A-(E.clientHeight-(O.y-S)))}const L=(D=T==null?void 0:T.querySelector(".table-footer"))==null?void 0:D.getBoundingClientRect();L&&L.y-S<E.clientHeight&&(A=A-(E.clientHeight-(L.y-S))),E.style.transform="translateY(".concat(A+(u?uE:gu),"px)"),E.style.backgroundColor="var(--white1)"}else E.style.transform="none",F&&(E.style.backgroundColor="unset")};return C.addEventListener("scroll",k),window.addEventListener("resize",k),()=>{C.removeEventListener("scroll",k),window.removeEventListener("resize",k)}},[u,o,F]);const w=()=>{var C;const E=(C=xt.$tableGroupFoldStatus)!=null?C:{};st({$tableGroupFoldStatus:{...E,[l]:{...E[l],[s]:!g}}}),ts(bE(l,s,t),JSON.stringify(!g))};return r.jsxs("div",{className:R("sticky z-20",!t&&"border-t border-grey6",!(F&&!o)&&"bg-white1"),style:{top:u?void 0:_===wt.PAGE_LITE_PREVIEW?gu-11:gu-1},ref:x,children:[r.jsxs("div",{className:R("sticky flex h-[38px] w-96 items-center bg-white1 pl-1",u?b?"left-8":"left-0":_===wt.PAGE_LITE_PREVIEW?"left-10":"left-24",F&&(o?"h-[37px] w-auto":"bg-transparent"),!(f||h)&&"-translate-x-8"),children:[r.jsx("button",{className:"animate-hover mr-1.5 h-6 w-6 rounded text-grey4",onClick:w,children:r.jsx(V,{name:"IcToggleBlackUnfold",size:"large",className:"transition-all duration-200 print:hidden",style:{transform:g?"rotate(0deg)":"rotate(-90deg)"}})}),r.jsx(vE,{isSubGroup:t,groupName:s,scene:Y0.GROUP_HEADER}),r.jsx(W$,{groupbyFieldName:"collectionGroupBy",recordIds:n}),!ot.print&&r.jsxs(r.Fragment,{children:[r.jsx(p4,{isSubGroup:t,groupName:s,visible:a,className:"ml-3 mr-1 text-grey3"}),c||d?null:r.jsx(G$,{groupName:s,before:n[0],isSubGroup:t,className:"text-grey3"})]})]}),F&&o&&a&&i===0&&r.jsx(Fe,{popup:"收起表格",onClick:E=>{E.stopPropagation(),Rt(l,{timelineShowTable:!1})},children:r.jsx(V,{name:"IcUnfold",size:"middle",className:"animate-hover absolute right-2 top-2 rotate-180 text-grey3"})})]})},yn),Qg=e=>{const{hiddenGroupsLength:t,hiddenGroups:n,isTimelineTable:s}=e,{viewId:a,embed:o}=Ne(),i=fee(a),l=kg(a),{viewType:c}=Ne();if(t===0)return null;const d=c===m.CollectionViewType.TIMELINE;return r.jsxs(r.Fragment,{children:[d&&l&&!s?r.jsx("div",{className:"h-[42px]"}):r.jsx("div",{className:"mb-1",children:r.jsxs("button",{"data-disable-select":"true",className:R("sticky left-0 animate-hover-black3 text-grey3 h-[38px] pl-1 pr-2 rounded flex items-center",o?"left-0":"left-24"),onClick:()=>{st({$tableShowHiddenGroup:{...xt.$tableShowHiddenGroup,[a]:!i}})},children:[r.jsx(V,{name:"IcArrowShow",size:"middle",className:"mr-1 text-grey4 duration-200 transition-all",style:{transform:i?"rotate(0deg)":"rotate(-90deg)"}}),r.jsxs("span",{className:"text-t2 text-grey4",children:[t," 隐藏分组"]})]})}),i&&n]})},CTe=()=>{const{viewId:e,embed:t,readonly:n,managerReadonly:s,isLocked:a}=Ne(),{tableGroups:o}=of(e),i=x2(),l=yr(),[c,d]=y.useState(l==null?void 0:l.current);if(y.useEffect(()=>{d(l==null?void 0:l.current)},[c,l]),!c||!o)return null;const{visibleGroups:u,visibleSubGroups:f=[],hiddenSubGroups:h=[]}=o;return r.jsxs("div",{className:"flex border-t border-grey6 pt-2",children:[r.jsxs("div",{children:[r.jsx(br,{className:"flex pb-2",isHorizontalAxis:!0,appendChild:r.jsx(Ou,{}),disabled:s||a,strategy:tw,modifiers:[ew,H1],items:u.map(p=>({id:p.value,...p})),onChange:(p,g)=>i(e,g),renderItemContent:({item:p})=>r.jsx(K$,{groupName:p.value,recordIds:p.recordIds,isSubGroup:!0})}),ac(f.length)?r.jsx(qs,{customScrollParent:c,overscan:Dn,increaseViewportBy:Dn,computeItemKey:p=>p,totalCount:f.length,itemContent:p=>{const g=f[p];return g?r.jsx(wy,{tableGroup:g},g.value):null}}):r.jsx(r.Fragment,{children:f.map(p=>r.jsx(wy,{tableGroup:p},p.value))}),r.jsx(Qg,{hiddenGroupsLength:h.length,hiddenGroups:h.length>100?r.jsx(qs,{customScrollParent:c,overscan:Dn,increaseViewportBy:Dn,computeItemKey:p=>p,totalCount:h.length,itemContent:p=>{const g=h[p];return g?r.jsx(wy,{tableGroup:g},g.value):null}}):r.jsx(r.Fragment,{children:h.map(p=>r.jsx(wy,{tableGroup:p},p.value))})}),r.jsx(Ou,{isSubGroup:!0}),!n&&!t&&r.jsx(Di,{type:"collection"})]}),r.jsx(Sz,{})]})},wy=y.memo(e=>{const{tableGroup:t}=e,{viewId:n}=Ne(),s=ig(n,t.value);return r.jsxs("div",{className:"pb-5",children:[r.jsx(kx,{isSubGroup:!0,tableGroup:t}),s&&r.jsx(kTe,{tableGroup:t})]})},yn),kTe=({tableGroup:e})=>r.jsx("div",{className:"flex",children:e.groups.map(t=>r.jsx(za,{recordIds:t.recordIds,children:r.jsx(TTe,{groups:t,subGroupValue:e.value,subGroupProperty:e.groupProperty},t.value)}))}),TTe=({groups:e,subGroupValue:t,subGroupProperty:n})=>{var x;const{viewId:s}=Ne(),a=sf(s),o=yr(),{recordIds:i}=Tc(),l=_2(s),c=Bi(s),d=Li(s),u=th(s),{recordIds:f,value:h,visible:p,groupProperty:g}=e;if(!o.current||!p)return null;const _=(x=a==null?void 0:a.options)==null?void 0:x.find(F=>F.value===h);return r.jsxs("div",{"data-is-empty":f.length===0?!0:null,"data-is-board":!0,"data-group-property":g,"data-group-value":h,"data-subgroup-property":n,"data-sub-group-value":t,"data-view-id":s,className:R("relative group flex flex-col items-center rounded-md p-[5px] mr-2.5 min-h-[45px]",(l&&!(_!=null&&_.color)||!l)&&"bg-grey/5"),style:{width:ji(c,d)+10,backgroundColor:l?h3(_==null?void 0:_.color):void 0},children:[r.jsx(qs,{className:"w-full",customScrollParent:o.current,overscan:Dn,increaseViewportBy:Dn,computeItemKey:F=>F,totalCount:i.length,itemContent:F=>{const b=i[F];return b?r.jsx("div",{className:"py-1","data-card-id":b,children:r.jsx(Q4,{recordId:b,groupValue:h,subGroupValue:t})},b):null}}),u&&r.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-black/30 opacity-0 group-hover:opacity-100"}),r.jsx(hf,{}),r.jsx(mf,{where:{after:f[f.length-1]},groupName:h,subGroupName:t,color:l?_==null?void 0:_.color:void 0})]},h)},Dz=e=>{const{viewId:t}=Ne(),n=ss(),{previewType:s}=Wm(t);y.useEffect(()=>{if(s!==m.CoverType.PAGE_CONTENT)return;const a=e,o=a==null?void 0:a.closest(".next-space-page");if(!a||!o)return;const i=()=>{const c=a.querySelectorAll("[data-card-id]"),d=o.getBoundingClientRect(),u=new Set;c.forEach(f=>{const{cardId:h,loaded:p}=f.dataset;if(!h||p==="true")return;const g=f.getBoundingClientRect();z$(g,d)>0&&(u.add(h),f.dataset.loaded="true")}),u.size>0&&Wv([...u],50).forEach(h=>{ise([...h],n.getState())})};setTimeout(()=>i(),100);const l=qn(i,100);return o.addEventListener("scroll",l),()=>{o.removeEventListener("scroll",l)}},[e,s,t])},vTe=()=>{var h,p;const{viewId:e,readonly:t,managerReadonly:n,embed:s}=Ne(),{tableGroups:a,child2ParentMap:o,parent2ChildMap:i,filteredRecordIdSet:l}=lf(e);g2(a);const c=y.useMemo(()=>({child2ParentMap:o,parent2ChildMap:i,filteredRecordIdSet:l}),[o,l,i]),d=y.useRef(null),[u,f]=y.useState(d.current);return Dz(u),y.useEffect(()=>{u||f(d.current)}),a?(a.withoutValidGroup||a.needUpdateGroups)&&((p=(h=a.newViewGroups)==null?void 0:h[0])==null?void 0:p.propertyType)===m.CollectionSchemaType.SELECT?t||n?r.jsx("div",{className:"text-t2 h-[35px] flex items-center pl-2",children:"当前视图无有效分组属性，无法展示"}):null:a.needUpdateSubGroups&&!(t||n)?null:r.jsx(wm.Provider,{value:c,children:r.jsx("div",{ref:d,style:{width:"fit-content",minWidth:"100%"},className:R(!s&&"-mr-24 pr-24 box-content sm:-mr-12 sm:pr-12"),children:a.hasValidSubGroup?r.jsx(CTe,{}):r.jsx(FTe,{})})}):null};const zr=12,R1=18,Ji=10,rk=5,Q_=90;var $F=(e=>(e.DAY="day",e.MONTH="month",e))($F||{});const HF=[{type:"day",name:"日视图"},{type:"month",name:"月视图"}],J4=(e,t)=>{const n=hE(e);return Ce(({blocks:s})=>{var i,l,c,d,u,f;const a=s[t];if(!a)return;let o="";if((n==null?void 0:n.type)===m.CardColorSource.CUSTOM&&(o=a.data.collectionCardColor),(n==null?void 0:n.type)===m.CardColorSource.PROPERTY){if(!n.propertyId)return;const h=(c=(i=s[a.parentId])==null?void 0:i.data.schema)==null?void 0:c[(l=n.propertyId)!=null?l:""];if(!h||h.type!==m.CollectionSchemaType.SELECT)return;const p=(u=a.data.collectionProperties)==null?void 0:u[(d=n.propertyId)!=null?d:""],g=fe(p),_=(f=h.options)==null?void 0:f.find(x=>x.value===g.trim());o=_==null?void 0:_.color}return aJ(o)},[e,t])},m_=(e,t)=>{e-=Ji;let n=Math.floor(e/t);return n=e-n*t>t/2?n+1:n,n},ITe=(e,t,n,s,a,o)=>{const{autoScrollY:i,rafY:l}=zj(),{disableTop:c,disableBottom:d}=o;let u=!1;const f=Ji,h=n.clientHeight-Ji,p=F=>{F.preventDefault();const b=F.target;if(!b)return;let{clientY:w}=F;const E=F.clientY,C=b.classList.contains("resize-top"),k={top:parseInt(e.style.top,10),height:parseInt(e.style.height,10),bottom:parseInt(e.style.height,10)+parseInt(e.style.top,10)},T=j=>{if(!u){if(Math.abs(j.clientY-E)<5)return;u=!0}i({y:j.clientY,container:t,offset:{top:120}}),w=j.clientY,v()},v=()=>{const j=n.getBoundingClientRect(),S=w-j.y;if(C){let D=S;const A=D<f?f:D;D=m_(A,zr)*zr+Ji;const L=Es(D,f,k.bottom),O=D>k.bottom?Math.min(D,h)-k.bottom:k.bottom-D;if(d&&L+O>k.bottom)return;e.style.top="".concat(L,"px"),e.style.height="".concat(Math.max(O,R1),"px")}else{let D=S;D=m_(D,zr)*zr+Ji;const P=Es(D,f,h),L=D>k.top?k.top:P,O=Math.abs(P-k.top);if(c&&L<k.top)return;e.style.top="".concat(L,"px"),e.style.height="".concat(Math.max(O,R1),"px")}},I=()=>{u=!1,document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",I),t.removeEventListener("scroll",v),cancelAnimationFrame(l.id);const j=parseInt(e.style.top,10),S=parseInt(e.style.height,10),D=m_(j,zr);s==null||s(D,S<zr?0:S/zr,u)};document.addEventListener("mousemove",T),document.addEventListener("mouseup",I),t.addEventListener("scroll",v)},g=F=>{if(F.preventDefault(),!F.target)return;let{clientY:w}=F;const E=F.clientY,C=e.getBoundingClientRect(),k=F.clientY-C.top,T={top:parseInt(e.style.top,10),height:parseInt(e.style.height,10),bottom:parseInt(e.style.height,10)+parseInt(e.style.top,10)},v=S=>{if(!u){if(Math.abs(S.clientY-E)<5)return;u=!0}w=S.clientY,i({y:w,container:t,offset:{top:120}}),I()},I=()=>{const S=n.getBoundingClientRect(),D=w-S.y,A=Es(D-k,f,h-T.height),L=m_(A,zr)*zr+Ji;e.style.top="".concat(L,"px")},j=()=>{document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",j),t.removeEventListener("scroll",I),cancelAnimationFrame(l.id);const S=parseInt(e.style.top,10),D=parseInt(e.style.height,10),A=m_(S,zr);s==null||s(A,D<zr?0:D/zr,u)};document.addEventListener("mousemove",v),document.addEventListener("mouseup",j),t.addEventListener("scroll",I)},_=F=>{const b=F.target;if(!b)return;if(b.classList.contains("resize-top")||b.classList.contains("resize-bottom"))p(F);else{if(c||d)return;g(F)}},x=F=>{u||a(F),u=!1};return e.addEventListener("mousedown",_),e.addEventListener("mouseup",x),()=>{e.removeEventListener("mouseup",x),e.removeEventListener("mousedown",_)}},Az=e=>{var l,c,d;const t=gn(e);if(!t)return{calendarByType:void 0,calendarByEndType:void 0};const{view:n,collection:s}=t,{calendarBy:a="",calendarByEnd:o=""}=n.format,i=(l=s==null?void 0:s.data.schema)!=null?l:{};return{calendarByType:(c=i[a])==null?void 0:c.type,calendarByEndType:(d=i[o])==null?void 0:d.type}},NTe=e=>{const{viewId:t,collectionId:n}=Ne(),s=lt(),a=og(t),o=Ce(c=>{const{blocks:d,collectionViews:u}=c,f=d[n],h={allDayRecord:[],timeRangeRecord:[]},p=u[t];if(!p||!f)return h;const{calendarBy:g="",calendarByEnd:_=""}=p.format,{calendarByType:x,calendarByEndType:F}=Az(t);let{sortedRecordIds:b}=Jc({viewId:t,pageId:s});return b=b.map(w=>d[w]).filter(w=>!!w).sort((w,E)=>{var C,k;return((C=w.createdAt)!=null?C:0)-((k=E==null?void 0:E.createdAt)!=null?k:0)}).map(w=>w.uuid),b.forEach(w=>{var S,D;const E=d[w];if(!E)return;let C=0,k=0,T=!0,v=!0;if(x===m.CollectionSchemaType.CREATED_AT||x===m.CollectionSchemaType.UPDATED_AT)T=!0,C=x===m.CollectionSchemaType.CREATED_AT?E.createdAt:E.updatedAt;else{const{textType:A,timestamp:P}=(S=va(E,g))!=null?S:{};T=A===m.TextType.DATETIME,C=P}if(F===m.CollectionSchemaType.CREATED_AT||F===m.CollectionSchemaType.UPDATED_AT)v=!0,k=F===m.CollectionSchemaType.CREATED_AT?E.createdAt:E.updatedAt;else{const{textType:A,timestamp:P}=(D=va(E,_))!=null?D:{};v=A===m.TextType.DATETIME,k=P}if(!x||!F||!C&&!C||(C||(C=k,T=v),k||(k=C,v=T),!C)||!k)return;k<C&&(k=C,v=T);const I=Us(C),j=Us(k);if(I===e||j===e||I<e&&k>=e+as){I===j&&v&&!T&&(C=k,T=v);const L={uuid:w,startTime:C,endTime:k};if(I===e&&T||j===e&&v){h.timeRangeRecord.push(L);return}h.allDayRecord.push(L)}}),h},[n,t,a]),{timeRangeRecord:i}=o;i.sort((c,d)=>(c.startTime||c.endTime||0)-(d.startTime||d.endTime||0));const l=[];return i.forEach((c,d)=>{if(d===0){l.push([c]);return}for(const u of l)if(!u.find(h=>sP(h,c))){u.push(c);return}l.push([c])}),l.forEach((c,d)=>{c.forEach(u=>{u.left=d;const f=l.slice(d+1);let h=d+1;for(const p of f)if(p.find(_=>sP(u,_)))h++;else if(d+1!==h){const _=f.findIndex(x=>x===p);h+=f.length-_;break}else continue;u.recordCount=h})}),o},sP=(e,t)=>{const{startTime:n,endTime:s}=e,{startTime:a,endTime:o}=t;if(!(!n||!a||!s||!o))return n<a?a>=n&&a<s:n>=a&&n<o},Rz=(e,t)=>{var o;const n=ye(t,["data"],["collectionCardColor"]),{type:s}=(o=hE(e))!=null?o:{},a=Oe();y.useEffect(()=>{var i;if(n&&s===m.CardColorSource.CUSTOM){const l=n.data.collectionCardColor,c=vr.map(d=>d.key);if(!l||!c.includes(l)){const{role:d}=mn(t);if(d===m.PermissionRole.WRITER||d===m.PermissionRole.EDITOR){const u=(i=nm(c))!=null?i:Ze.grey;a(()=>{_e(t,{data:{collectionCardColor:u}})})}}}},[n,t,a,s,e])},Pz=100;let Xh,Hf;const rP=(e,t,n=Pz)=>{const s=t.getBoundingClientRect(),a=()=>{if(e-s.left<n){const i=(n-(e-s.left))/10;t.scrollLeft-=i,Xh=requestAnimationFrame(a)}if(s.right-e<n){const i=(n-(s.right-e))/10;t.scrollLeft+=i,Xh=requestAnimationFrame(a)}};cancelAnimationFrame(Xh),Xh=requestAnimationFrame(a)},Sv=({y:e,container:t,threshold:n=Pz,offset:s})=>{var c,d;const a=t.getBoundingClientRect(),o=n+((c=s==null?void 0:s.top)!=null?c:0),i=n+((d=s==null?void 0:s.bottom)!=null?d:0),l=()=>{if(e-a.top<o){const f=(o-(e-a.top))/10;t.scrollTop-=f,Hf=requestAnimationFrame(l)}if(a.bottom-e<i){const f=(n-(a.bottom-e))/10;t.scrollTop+=f,Hf=requestAnimationFrame(l)}};cancelAnimationFrame(Hf),Hf=requestAnimationFrame(l)},zF=({base:e=Date.now(),dir:t=ym.NEXT,length:n=100,includeBase:s=!1,zoomLevel:a=Ft.MONTH})=>{const o=[],i=t===ym.NEXT;if(Jg(a)||a===Ft.QUARTER){let l=Vp(e);a===Ft.QUARTER&&(l-=(new Date(e).getDay()-1)*Kn);const c=a===Ft.QUARTER?Kn*7:Kn,d=s?n:n+1;for(let u=0;u<d;u++)if(!(!s&&u===0))if(i){const f=l+u*c;o.push(f)}else{const f=l-u*c;o.unshift(f)}}else if(a===Ft.YEAR){const l=new Date(e),c=Vp(l.setDate(1));if(s)o.push(c);else{const d=new Date(c).getMonth();o.push(new Date(c).setMonth(i?d+1:d-1,1))}for(let d=0;d<n-1;d++)if(i){const u=o[o.length-1],f=new Date(u).getMonth();o.push(new Date(u).setMonth(f+1,1))}else{const u=o[0],f=new Date(u).getMonth();o.unshift(new Date(u).setMonth(f-1,1))}}else if(a===Ft.DAY||a===Ft.HOUR){const l=a===Ft.DAY?Lz(e):P1(e),c=a===Ft.DAY?eF:Lu,d=s?n:n+1;for(let u=0;u<d;u++)if(!(!s&&u===0))if(i){const f=l+u*c;o.push(f)}else{const f=l-u*c;o.unshift(f)}}return o},Up=({zoomLevel:e,length:t,base:n})=>[...zF({base:n,dir:ym.PREV,zoomLevel:e,length:t}),...zF({base:n,dir:ym.NEXT,zoomLevel:e,length:t,includeBase:!0})],Vp=e=>new Date(new Date(e).toDateString()).getTime(),Lz=e=>new Date(e).setHours(new Date(e).getHours(),0,0,0),P1=e=>{const t=Lz(e);return t+Math.floor((e-t)/Lu)*Lu},Yr=e=>{const t=new Date(e);return{year:t.getFullYear(),month:t.getMonth()+1,date:t.getDate(),day:t.getDay(),monthDesc:C3[t.getMonth()],time:e}},ql=(e,t,n)=>{const s=new Date(t);return n===Ft.DAY||n===Ft.HOUR?new Date(t):ue(e).year(s.getFullYear()).month(s.getMonth()).date(s.getDate()).toDate()},kr=(e,t,n,s)=>{const{needDateStart:a=!1,abs:o=!0}=s!=null?s:{};let i=0;return n===Ft.HOUR||n===Ft.DAY?i=(a?P1(e)-P1(t):e-t)/Lu:i=(a?Vp(e)-Vp(t):e-t)/Kn,o?Math.abs(i):i},jTe=[31,28,31,30,31,30,31,31,30,31,30,31],STe=e=>{const t=new Date(e),n=t.getFullYear(),s=t.getMonth();return s===1?n%4===0&&n%100!==0||n%400===0?29:28:jTe[s]},Jg=e=>e===Ft.MONTH||e===Ft.WEEK||e===Ft.BIWEEK,em=e=>e===Ft.DAY||e===Ft.HOUR?Lu:Kn,Nh=(e,t)=>t===m.TextType.DATETIME||e===Ft.DAY||e===Ft.HOUR,DTe=(e,t)=>{const n=hr[e];let s=t.length*n;if(e===Ft.YEAR){const a=t[t.length-1],o=ATe(a);s=(kr(o,t[0],e)+1)*n}else e===Ft.QUARTER?s=7*t.length*n:e===Ft.DAY&&(s=4*t.length*n);return s},ATe=e=>new Date(e).setMonth(new Date(e).getMonth()+1,0),RTe=e=>e===Ft.DAY||e===Ft.HOUR,Bz=y.createContext(void 0),Tx=()=>{const e=y.useContext(Bz);if(!e)throw new Error("useBitable");return e},PTe=(e,t,n)=>{const s=Us(new Date(e).setDate(1)),a=Us(new Date(e).setMonth(new Date(e).getMonth()+1,0));n.querySelectorAll(".calender-date.current-month-date").forEach(d=>{d.classList.remove("current-month-date")});const i=n.querySelectorAll(".calender-date"),l=s+as/2,c=a+as/2;Array.from(i).forEach(d=>{var f;const u=parseInt((f=d.dataset.date)!=null?f:"",10);u>=l&&u<=c&&d.classList.add("current-month-date")})},LTe=(e,t,n)=>{const s=n.querySelector(".calender-date.drag-hover-highlight");s==null||s.classList.remove("drag-hover-highlight");const a=n.querySelectorAll(".calender-date");let o,i;return Array.from(a).forEach((l,c)=>{const d=l.getBoundingClientRect();e>=d.left&&e<=d.right&&t>=d.top&&t<=d.bottom&&(o=c,i=l,l.classList.add("drag-hover-highlight"))}),{targetIndex:o,targetNode:i}},Oz=e=>{const{recordId:t,calendarBy:n,calendarByEnd:s,blocks:a=pe().blocks}=e,o=a[t],i=JSON.stringify({...o,recordId:t,calendarBy:n,calendarByEnd:s});if(W2.has(i))return W2.get(i);const l=hd(o,n),c=hd(o,s),d=l||c;let u=c;l&&c&&(u=c>=l?c:l),c||(u=l);const f={rawStartTime:l,renderStartTime:d,rawEndTime:c,renderEndTime:u};return W2.set(i,f),f},BTe=4,OTe=4,MTe=22,Mz=36,qF=e=>BTe*2+MTe*e+OTe,UTe=y.memo(e=>{var z,K;const{recordId:t,renderStartTime:n,renderEndTime:s,weekStartDate:a,weekEndDate:o,isStartTime:i,isEndTime:l,weekFirstDay:c,order:d,calendarBy:u,calendarByEnd:f,calendarByType:h,calendarByEndType:p}=e,{container:g}=Tx(),{viewId:_}=Ne(),x=li(_),F=ys(),b=We(t,!1),[w=[]]=Fa(_,{visible:!0}),E=w.length,{illegal:C}=mt(t),k=ye(t,["data","subNodes"],["segments","icon"]),T=y.useRef({renderStartTime:n,renderEndTime:s,weekStartDate:a,weekEndDate:o});T.current={renderStartTime:n,renderEndTime:s,weekStartDate:a,weekEndDate:o};const v=Oe(),I=y.useRef({x:0,y:0}),j=J4(_,t);Rz(_,t);const S=ie(),D=ag(),A=t===(D==null?void 0:D.id)&&_===D.viewId,P=y.useRef(null);y.useEffect(()=>{if(!A)return;const W=P.current;W&&S.dropdown({placement:"bottom-start",popcorn:W,offset:[-2,-W.clientHeight-3],closeAfterCallBack:()=>{st({$newCreatedRecord:void 0})},content({onCloseModal:Y}){return r.jsx("div",{className:"next-modal max-h-[80vh]",style:{width:W.clientWidth+4},children:r.jsx(_v,{site:Ye.CELL,viewId:_,recordId:t,propertyId:"title",onUpdate:()=>{},onClose:Y})})}})},[]);const L=(W,Y)=>{if(W.preventDefault(),W.stopPropagation(),b)return;const G=g.current,ee=G==null?void 0:G.closest("[data-page-id]");if(!G||!ee)return;const te=Y===Kf.left;let Q,ne={x:W.clientX,y:W.clientY};const se=(Te=!1)=>{const he=gn(_);if(!he)return;const{calendarBy:Ee,calendarByEnd:ge}=he;if(!Ee||!ge)return;const{blocks:Se}=pe(),Re=Se[t];Re&&v(()=>{_e(t,{data:{collectionProperties:{...Re.data.collectionProperties}}},Te)})},ce=Ps(Te=>{ne={x:Te.clientX,y:Te.clientY},Sv({y:Te.clientY,container:ee}),ke(Te.clientX,Te.clientY),se(!0)},500,{leading:!1,trailing:!0}),ae=()=>{ee.removeEventListener("scroll",de),Ht.removeEventListener("mousemove",ce),Ht.removeEventListener("mouseup",ae),cancelAnimationFrame(Hf),se()},de=()=>ke(ne.x,ne.y),ke=(Te,he)=>{var Qt,nn,sn;let Ee=1/0;if(G.querySelectorAll(".calender-date").forEach(ms=>{const N=ms.getBoundingClientRect(),B=Ybe(Kbe(N),{x:Te,y:he});B<Ee&&(Ee=B,Q=ms)}),!Q)return;let Se=parseInt((Qt=Q==null?void 0:Q.dataset.date)!=null?Qt:"",10);if(!Se||(Se-=as/2,te&&(Se>Us(T.current.renderEndTime)||Se===T.current.weekStartDate)||!te&&(Se<Us(T.current.renderStartTime)||Se===T.current.weekEndDate)))return;const Re=gn(_);if(!Re)return;const{calendarBy:Ae,calendarByEnd:Me}=Re;if(!Ae||!Me)return;const{blocks:Ge}=pe(),tt=Ge[t];if(!tt)return;const gt={},kt=(nn=va(tt,Ae))==null?void 0:nn.textType;gt[Ae]=te?[Gn({from:ql(n,Se),includeTime:kt===m.TextType.DATETIME})]:[Gn({from:new Date(n),includeTime:kt===m.TextType.DATETIME})];const At=(sn=va(tt,Me))==null?void 0:sn.textType;gt[Me]=te?[Gn({from:s>n?new Date(s):ql(s,n),includeTime:At===m.TextType.DATETIME})]:[Gn({from:ql(s,Se),includeTime:At===m.TextType.DATETIME})],_e(t,{data:{collectionProperties:{...tt.data.collectionProperties,...gt}}},!0)};ee.addEventListener("scroll",de),Ht.addEventListener("mousemove",ce),Ht.addEventListener("mouseup",ae)},O=W=>{W.preventDefault();const{ui:Y}=pe();if(Y.selectedBlocks.map(Ge=>Ge.blockId).includes(t)||re(at.updateSelectBlocks([{blockId:t,viewId:_}])),b)return;const ee=[m.CollectionSchemaType.CREATED_AT,m.CollectionSchemaType.UPDATED_AT];if(h&&ee.includes(h)||p&&ee.includes(p))return;I.current={x:W.clientX,y:W.clientY};const te=g.current,Q=te==null?void 0:te.closest("[data-page-id]");if(!te||!Q)return;const ne=W.currentTarget,{parentElement:se}=ne;if(!se)return;const ce=ne.getBoundingClientRect(),de=se.clientWidth/(parseFloat(se.style.width)/100)/7,ke=a+Math.floor((W.clientX-ce.left)/de)*as;let Te=!1,he,Ee,ge={x:W.clientX,y:W.clientY};const Se=Ge=>{if(ge={x:Ge.clientX,y:Ge.clientY},!(!Te&&Math.abs(Ge.clientX-I.current.x)<5&&Math.abs(Ge.clientY-I.current.y)<5)){if(!Te){Te=!0,he=document.createElement("div"),he.style.pointerEvents="none",he.style.opacity="0.5",he.style.position="fixed",he.style.inset="0",he.style.zIndex="100";const{ui:tt}=pe();tt.selectedBlocks.map(kt=>kt.blockId).forEach(kt=>{te.querySelectorAll('[data-record-id="'.concat(kt,'"]')).forEach(Qt=>{const nn=Qt.getBoundingClientRect(),sn=Qt.cloneNode(!0);sn.style.position="absolute",sn.style.width="".concat(nn.width,"px"),sn.style.height="".concat(nn.height,"px"),sn.style.top="".concat(nn.top,"px"),sn.style.left="".concat(nn.left,"px"),he==null||he.appendChild(sn)})}),document.body.appendChild(he)}Sv({y:Ge.clientY,container:Q}),Re(Ge.clientX,Ge.clientY)}},Re=(Ge,tt)=>{if(!he)return;he.style.transform="translate(".concat(Ge-I.current.x,"px, ").concat(tt-I.current.y,"px)"),Ee=LTe(Ge,tt,te).targetNode},Ae=()=>{Q.removeEventListener("scroll",Me),Ht.removeEventListener("mousemove",Se),Ht.removeEventListener("mouseup",Ae),cancelAnimationFrame(Hf),he==null||he.remove();const Ge=te.querySelector(".calender-date.drag-hover-highlight");Ge==null||Ge.classList.remove("drag-hover-highlight"),Te&&v(()=>{var N;if(!Ee)return;const tt=gn(_);if(!tt)return;const{calendarBy:gt,calendarByEnd:kt}=tt;if(!gt||!kt)return;const{blocks:At,ui:Qt}=pe();let nn=parseInt((N=Ee==null?void 0:Ee.dataset.date)!=null?N:"",10);if(!nn||(nn-=as/2,nn===ke))return;const sn=nn-ke;Qt.selectedBlocks.map(B=>B.blockId).forEach(B=>{var He,rt;const{renderStartTime:X,renderEndTime:Z}=Oz({recordId:B,calendarBy:gt,calendarByEnd:kt,blocks:At});if(!X||!Z)return;const oe=At[B];if(!oe)return;const xe=X+sn,Be=xe+Z-X,Le={},bt=(He=va(oe,gt))==null?void 0:He.textType;Le[gt]=[Gn({from:ql(X,xe),includeTime:bt===m.TextType.DATETIME})];const Ue=(rt=va(oe,kt))==null?void 0:rt.textType;Le[kt]=[Gn({from:ql(Z,Be),includeTime:Ue===m.TextType.DATETIME})],_e(B,{data:{collectionProperties:{...oe.data.collectionProperties,...Le}}})})})},Me=()=>{Re(ge.x,ge.y)};Q.addEventListener("scroll",Me),Ht.addEventListener("mousemove",Se),Ht.addEventListener("mouseup",Ae)},$={top:(d-1)*qF(E)+Mz,left:lo((a-c)/as/7),width:lo(((o-a)/as+1)/7),height:qF(E)},M=((z=k==null?void 0:k.subNodes)!=null?z:[]).length>0||!!((K=k==null?void 0:k.data.icon)!=null&&K.type),U=Cg(_);return r.jsx("div",{style:$,className:R("absolute pb-1 transition-all",{"pl-1.5":i,"pr-1.5":l}),children:r.jsxs(wn,{blockRef:P,id:t,viewId:_,"data-record-id":t,"data-no-cancel-selected":!0,"data-disable-select":!0,onMouseDown:O,className:"w-full h-full cursor-pointer",children:[r.jsx("div",{className:"bg-white1 relative h-full",children:r.jsxs("div",{className:R("h-full p-1",{border:!j,"rounded-l-l":i,"rounded-r":l}),onClick:W=>F(t,{illegal:C,forceOpenInRight:W.altKey,openWay:x,forceOpenNewTab:W.ctrlKey||W.metaKey}),style:{backgroundColor:j},children:[C&&r.jsxs(r.Fragment,{children:[r.jsx(Fn,{className:"text-t2-medium mr-1 inline p-0 align-middle opacity-30",blockId:t,trigger:!1,iconSize:16,defaultIcon:r.jsx(V,{name:"IcPages",size:"small"})}),r.jsx("span",{className:"border-b border-grey6 opacity-30",children:Ts})]}),!C&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex",children:[M&&U&&r.jsx(Fn,{tooltipClassName:"align-middle",className:"mr-1.5 inline-flex p-0 align-middle",blockId:t,iconSize:16,defaultIcon:r.jsx(_s,{uuid:t,size:"small"})}),r.jsx(fs,{className:"text-t4-medium text-ellipsis whitespace-nowrap align-middle leading-[22px]",plugins:oa,segments:k==null?void 0:k.data.segments,placeholder:fo,interactable:!1}),r.jsx(nh,{className:"inline-flex align-middle pointer-events-none",blockId:t})]}),r.jsx(Cx,{recordId:t})]})]})}),!b&&u!==f&&pre.map(W=>W===Kf.left&&i&&h!==m.CollectionSchemaType.CREATED_AT&&h!==m.CollectionSchemaType.UPDATED_AT?r.jsx("div",{className:"absolute top-0 left-0 bottom-0 z-10 w-[4px] rounded-full py-0.5 hover:cursor-col-resize hover:bg-black",onMouseDown:Y=>L(Y,W)},W):W===Kf.right&&l&&p!==m.CollectionSchemaType.CREATED_AT&&p!==m.CollectionSchemaType.UPDATED_AT?r.jsx("div",{className:"absolute top-0 right-0 bottom-0 z-10 w-[4px] rounded-full py-0.5 hover:cursor-col-resize hover:bg-black",onMouseDown:Y=>L(Y,W)},W):null)]},t)})}),aP=e=>{var P;const{record:t,base:n,container:s,viewType:a,isAllDay:o}=e,{uuid:i,startTime:l,endTime:c,left:d=0,recordCount:u=1}=t,f=We(i),h=y.useRef(null),{width:p}=(P=bl(s,"width"))!=null?P:{},{illegal:g}=mt(i),{viewId:_}=Ne(),x=ys(),F=li(_),b=Oe(),w=J4(_,i),[E=[]]=Fa(_,{visible:!0}),C=E.length,k=Us(l),T=Us(c);let v=!1,I=!1;const{calendarByType:j,calendarByEndType:S}=Az(_);if((j===m.CollectionSchemaType.CREATED_AT||j===m.CollectionSchemaType.UPDATED_AT||j===m.CollectionSchemaType.DATE&&k!==n)&&(v=!0),(S===m.CollectionSchemaType.CREATED_AT||S===m.CollectionSchemaType.UPDATED_AT||S===m.CollectionSchemaType.DATE&&T!==n)&&(I=!0),y.useEffect(()=>{const L=h.current,O=s.current,$=L==null?void 0:L.closest("[data-page-id]");if(!L||!O||!$)return;const z=ITe(L,$,O,(K,W)=>{const Y=n+K*Hc,G=Y+Math.floor(W)*Hc,ee=gn(_);if(!ee)return;const{calendarBy:te,calendarByEnd:Q}=ee;if(!te||!Q)return;const ne={};v||(ne[te]=[Gn({from:new Date(Y),includeTime:!0})]),I||(ne[Q]=[Gn({from:new Date(G),includeTime:!0})]),b(()=>{const{blocks:se}=pe(),ce=se[i];ce&&_e(i,{data:{collectionProperties:{...ce.data.collectionProperties,...ne}}})})},K=>{x(i,{illegal:g,forceOpenInRight:K.altKey,openWay:F,forceOpenNewTab:K.ctrlKey||K.metaKey})},{disableTop:v||f||!!o,disableBottom:I||f||!!o});return()=>{z()}},[s,n,x,i,g,o,_,b,v,I,f]),y.useEffect(()=>{const L=h.current,O=s.current;if(!L||!O)return;if(o){L.style.opacity="1",L.style.width="".concat(O.clientWidth-Q_-13,"px");return}const $=(u-1)*rk;if(a===$F.DAY){const U=(O.clientWidth-Q_-13-$)/u;L.style.width="".concat(U,"px"),L.style.left="".concat((U+rk)*d+6,"px")}else{const M=(O.clientWidth-Q_)/7,z=(M-$)/u,K=new Date(n).getDay()||7;L.style.width="".concat(z,"px"),L.style.left="".concat((z+rk)*d+(K-1)*M,"px")}L.style.opacity="1"},[u,n,s,d,a,p,o]),!l||!c)return null;let D=0,A;if(o)D=qF(C);else{const L=Math.max(l,n)-n,O=Math.min(c,n+as)-Math.max(l,n);A=L/Hc*zr+Ji,D=O/Hc*zr}return r.jsxs(wn,{id:i,viewId:_,"data-record-id":i,blockRef:h,style:{top:A,height:D,minHeight:R1},className:R("rounded border bg-white1 flex-shrink-0 opacity-0 overflow-hidden cursor-pointer",o?"mt-1.5":"absolute"),children:[r.jsxs("div",{className:R("relative h-full p-1",D<=zr*2?"py-0":""),style:{boxShadow:"0px 1px 3px var(--black_006)",backgroundColor:w},children:[g&&r.jsxs(r.Fragment,{children:[r.jsx(Fn,{className:"text-t2-medium mr-1 inline p-0 align-middle opacity-30",blockId:i,trigger:!1,iconSize:16,defaultIcon:r.jsx(V,{name:"IcPages",size:"middle"})}),r.jsx("span",{className:"border-b border-grey6 opacity-30",children:Ts})]}),!g&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex",children:r.jsx(VTe,{recordId:i,height:D})}),r.jsx(Cx,{recordId:i})]})]}),!o&&!f&&r.jsxs(r.Fragment,{children:[!v&&r.jsx("div",{className:"resize-top",onClick:L=>L.stopPropagation()}),!I&&r.jsx("div",{className:"resize-bottom",onClick:L=>L.stopPropagation()})]})]},i)},VTe=({recordId:e,height:t})=>{var f,h;const{viewId:n}=Ne(),s=cr(e),a=ur(),o=ag(),i=((f=s==null?void 0:s.subNodes)!=null?f:[]).length>0||!!((h=s==null?void 0:s.data.icon)!=null&&h.type),l=e===(o==null?void 0:o.id)&&n===o.viewId,[c,d]=y.useState(l),u=Cg(n);return s?r.jsxs(r.Fragment,{children:[i&&u&&r.jsx(Fn,{tooltipClassName:"align-middle",className:"mr-1.5 inline-flex p-0 align-middle",blockId:e,iconSize:16,defaultIcon:r.jsx(_s,{uuid:e,size:"small"})}),c?r.jsx(ci,{uuid:e,className:R("text-t4-medium whitespace-nowrap align-middle flex-grow-0",t>=R1&&"leading-[22px]"),plugins:oa,keydownOption:{bracketRightKey:!1},placeholder:fo,autoFocus:!0,toolbar:!1,autoFocusCaretToEnd:!0,segments:s.data.segments,interactable:!0,onChange:p=>a(e,"title",p),onBlur:()=>{d(!1),st({$newCreatedRecord:void 0})},onKeyDown:p=>{if(Ie("mod+a")(p)){p.stopPropagation();return}(Ie("enter")(p)||Ie("esc")(p))&&p.currentTarget.blur()}}):r.jsx(fs,{className:R("text-t4-medium text-ellipsis whitespace-nowrap align-middle",t>=R1&&"leading-[22px]"),plugins:oa,segments:s==null?void 0:s.data.segments,placeholder:fo,interactable:!1}),r.jsx(nh,{className:"inline-flex align-middle pointer-events-none",blockId:e})]}):null},oP=e=>(new Date().setSeconds(0,0)-Us(Date.now()))/Hc*e+Ji,$Te=({date:e,unitHeight:t=zr})=>{const[n,s]=y.useState(oP(t)),a=y.useRef(),o=y.useRef(null),i=y.useRef(null),l=Us(Date.now());return y.useEffect(()=>(a.current=setInterval(()=>{s(oP(t))},k3),()=>{a.current&&clearInterval(a.current)}),[t]),y.useEffect(()=>{const c=o.current,d=i.current;!c||!d||(c.style.left="-5px")},[e,l]),e!==l?null:r.jsxs("div",{className:"absolute right-0 border-t border-red bg-white",style:{top:n,left:1},ref:i,children:[r.jsx("span",{className:"absolute -ml-[30px] -translate-x-full -translate-y-1/2 text-xs text-red bg-white1",children:ue(new Date).format(co)}),r.jsx("span",{ref:o,className:"absolute overflow-hidden rounded-full bg-red p-1 text-red",style:{top:-4}})]})},HTe=()=>{const e=ue().startOf("year").valueOf();return r.jsx("div",{className:"pointer-events-none",children:new Array(24).fill(1).map((t,n)=>r.jsxs("div",{style:{height:zr*4},className:R("relative border-t",n===23?"border-b":""),children:[r.jsx("span",{className:"absolute -ml-[30px] text-t4-medium text-grey3 -translate-x-full -translate-y-1/2",children:ue(e+n*Hc*4).format(co)}),n===23&&r.jsx("span",{className:"absolute bottom-0  -ml-[30px] -translate-x-full translate-y-1/2 text-t4-medium text-grey3",children:ue(e+(n+1)*Hc*4).format(co)})]},n))})},zTe=({currentDate:e,setToday:t})=>{var c,d;const{isLocked:n,managerReadonly:s,viewId:a}=Ne(),o=HN(a),i=ie(),l=u=>{if(n||s)return;const f=HF.map(h=>({type:H.OPERABLE_BLOCK_TEXT,data:{title:h.name,...h,selected:h.type===o}}));i.dropdown({popcorn:u.currentTarget,placement:"bottom",content:({onCloseModal:h})=>r.jsx(ze,{className:"next-modal w-36 py-2",items:f,onItemClick:({data:p})=>{Rt(a,{calendarType:p.type}),h()}})})};return r.jsxs("div",{className:"text-t2-medium pl-2 border-t",children:[r.jsxs("div",{className:"flex items-center py-1 h-[38px]",children:[r.jsx("p",{className:"mr-auto",children:ue(e).format("YYYY年MM月")}),r.jsxs("div",{className:"ml-auto flex items-center",children:[r.jsxs("button",{onClick:l,className:"text-t2 flex h-full items-center px-3 text-grey3",children:[(c=HF.find(u=>u.type===o))==null?void 0:c.name,!s&&r.jsx(V,{size:"xxxsmall",name:"IcArrowDown01",className:"ml-1"})]}),r.jsx(Fe,{className:"rounded-sm animate-hover",onClick:()=>t(e-as),children:r.jsx(V,{name:"IcArrowDateBack",size:"middle"})}),r.jsx("span",{className:"bg-white1 px-2 cursor-pointer",onClick:()=>t(Us(Date.now())),children:"今天"}),r.jsx(Fe,{className:"rounded-sm animate-hover",onClick:()=>t(e+as),children:r.jsx(V,{name:"IcArrowDateNext",size:"middle"})})]})]}),r.jsx("div",{className:"flex h-[38px] text-t4-medium text-grey3 items-center",children:a1((d=Cu[ue(e).day()])!=null?d:"")})]})},qTe=()=>{const[e,t]=y.useState(Us(Date.now())),n=y.useRef(null),{viewId:s,readonly:a}=Ne(),o=Mi({ignoreSorters:!0}),{allDayRecord:i,timeRangeRecord:l}=NTe(e),c=u=>{if(a)return;const f=n.current;if(!f)return;const h=f.getBoundingClientRect(),p=u.clientY-Ji-h.top,g=Math.floor(p/zr),_=e+g*Hc,x=_+fw,F=gn(s);if(!F)return;const{calendarBy:b,calendarByEnd:w}=F;b&&w&&o({viewId:s,where:{last:!0},propertyValues:{[b]:[Gn({from:new Date(_),includeTime:!0})],[w]:[Gn({from:new Date(x),includeTime:!0})]}})},d=u=>{if(a||u.target!==u.currentTarget)return;const f=gn(s);if(!f)return;const{calendarBy:h,calendarByEnd:p}=f;h&&p&&o({viewId:s,where:{last:!0},propertyValues:{[h]:[Gn({from:new Date(e)})],[p]:[Gn({from:new Date(e)})]}})};return r.jsxs("div",{className:"relative flex flex-1 flex-col min-w-[300px]",children:[r.jsxs("div",{className:"sticky top-0 bg-white1 z-10 ",children:[r.jsx(zTe,{setToday:t,currentDate:e}),r.jsxs("div",{className:"border min-h-[62px] flex",style:{boxShadow:"0px 4px 6px rgba(0, 0, 0, 0.06)"},children:[r.jsx("div",{className:"flex items-center justify-center text-grey3 text-t2-medium flex-shrink-0 ",style:{width:Q_},children:"全天"}),r.jsxs("div",{className:"border-l flex-1",onDoubleClick:d,children:[r.jsx("p",{className:"pt-2 pl-3 text-t2-medium flex mb-1.5",children:r.jsx("span",{className:R(e===Us(Date.now())&&"w-6 h-6 rounded-full flex items-center justify-center -mt-0.5 -ml-1 bg-red text-white"),children:ue(e).format("DD")})}),r.jsx("div",{className:"flex-1 p-1.5 pt-0 max-h-[150px] overflow-auto",onDoubleClick:d,children:i.map(u=>r.jsx(aP,{base:e,record:u,viewType:$F.DAY,container:n,isAllDay:!0},u.uuid))})]})]})]}),r.jsx("div",{className:"flex-1 border-x border-b",ref:n,style:{paddingLeft:Q_},children:r.jsxs("div",{className:"relative border-l bg-grey8",style:{padding:"".concat(Ji,"px 0"),height:24*zr*4+Ji*2},children:[r.jsx(HTe,{}),r.jsx("div",{className:"absolute inset-0 overflow-hidden",onDoubleClick:c,children:l.map(u=>r.jsx(aP,{base:e,record:u,viewType:$F.DAY,container:n},u.uuid))}),r.jsx($Te,{date:e})]})})]})},Uz=e=>r.jsx(r.Fragment,{children:e.children}),GTe={lunarInfo:[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,92821,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42416,83315,21168,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,23232,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19195,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448,84835,37744,18936,18800,25776,92326,59984,27424,108228,43744,37600,53987,51552,54615,54432,55888,23893,22176,42704,21972,21200,43448,43344,46240,46758,44368,21920,43940,42416,21168,45683,26928,29495,27296,44368,84821,19296,42352,21732,53600,59752,54560,55968,92838,22224,19168,43476,41680,53584,62034,54560],solarMonth:[31,28,31,30,31,30,31,31,30,31,30,31],Gan:["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],Zhi:["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],Animals:["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"],festival:{"1-1":{title:"元旦节"},"2-14":{title:"情人节"},"5-1":{title:"劳动节"},"5-4":{title:"青年节"},"6-1":{title:"儿童节"},"9-10":{title:"教师节"},"10-1":{title:"国庆节"},"12-25":{title:"圣诞节"},"3-8":{title:"妇女节"},"3-12":{title:"植树节"},"4-1":{title:"愚人节"},"5-12":{title:"护士节"},"7-1":{title:"建党节"},"8-1":{title:"建军节"},"12-24":{title:"平安夜"}},lFestival:{"12-30":{title:"除夕"},"1-1":{title:"春节"},"1-15":{title:"元宵节"},"2-2":{title:"龙抬头"},"5-5":{title:"端午节"},"7-7":{title:"七夕节"},"7-15":{title:"中元节"},"8-15":{title:"中秋节"},"9-9":{title:"重阳节"},"10-1":{title:"寒衣节"},"10-15":{title:"下元节"},"12-8":{title:"腊八节"},"12-23":{title:"北方小年"},"12-24":{title:"南方小年"}},getFestival(){return this.festival},getLunarFestival(){return this.lFestival},setFestival(e={}){this.festival=e},setLunarFestival(e={}){this.lFestival=e},solarTerm:["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"],sTermInfo:["9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","9778397bd19801ec9210c965cc920e","97b6b97bd19801ec95f8c965cc920f","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd197c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bcf97c3598082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd19801ec9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bd07f1487f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b97bd197c36c9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b70c9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","977837f0e37f149b0723b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0723b06bd","7f07e7f0e37f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f595b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e37f14998083b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14898082b0723b02d5","7f07e7f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66aa89801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e26665b66a449801e9808297c35","665f67f0e37f1489801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722"],nStr1:["日","一","二","三","四","五","六","七","八","九","十"],nStr2:["初","十","廿","卅"],nStr3:["正","二","三","四","五","六","七","八","九","十","冬","腊"],lYearDays:function(e){let t,n=348;for(t=32768;t>8;t>>=1)n+=this.lunarInfo[e-1900]&t?1:0;return n+this.leapDays(e)},leapMonth:function(e){return this.lunarInfo[e-1900]&15},leapDays:function(e){return this.leapMonth(e)?this.lunarInfo[e-1900]&65536?30:29:0},monthDays:function(e,t){return t>12||t<1?-1:this.lunarInfo[e-1900]&65536>>t?30:29},solarDays:function(e,t){if(t>12||t<1)return-1;const n=t-1;return n===1?e%4===0&&e%100!==0||e%400===0?29:28:this.solarMonth[n]},toGanZhiYear:function(e){var t=(e-3)%10,n=(e-3)%12;return t===0&&(t=10),n===0&&(n=12),this.Gan[t-1]+this.Zhi[n-1]},toAstro:function(e,t){const n="魔羯水瓶双鱼白羊金牛双子巨蟹狮子处女天秤天蝎射手魔羯",s=[20,19,21,21,21,22,23,23,23,23,22,22];return n.substr(e*2-(t<s[e-1]?2:0),2)+"座"},toGanZhi:function(e){return this.Gan[e%10]+this.Zhi[e%12]},getTerm:function(e,t){if(e<1900||e>2100||t<1||t>24)return-1;const n=this.sTermInfo[e-1900],s=[];for(let a=0;a<n.length;a+=5){const o=parseInt("0x"+n.substr(a,5)).toString();s.push(o[0],o.substr(1,2),o[3],o.substr(4,2))}return parseInt(s[t-1])},toChinaMonth:function(e){if(e>12||e<1)return-1;let t=this.nStr3[e-1];return t+="月",t},toChinaDay:function(e){let t;switch(e){case 10:t="初十";break;case 20:t="二十";break;case 30:t="三十";break;default:t=this.nStr2[Math.floor(e/10)],t+=this.nStr1[e%10]}return t},getAnimal:function(e){return this.Animals[(e-4)%12]},solar2lunar:function(e,t,n){let s=parseInt(e),a=parseInt(t),o=parseInt(n);if(s<1900||s>2100||s===1900&&a===1&&o<31)return-1;let i;s?i=new Date(s,parseInt(a)-1,o):i=new Date;let l,c=0,d=0;s=i.getFullYear(),a=i.getMonth()+1,o=i.getDate();let u=(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate())-Date.UTC(1900,0,31))/864e5;for(l=1900;l<2101&&u>0;l++)d=this.lYearDays(l),u-=d;u<0&&(u+=d,l--);let f=new Date,h=!1;f.getFullYear()===s&&f.getMonth()+1===a&&f.getDate()===o&&(h=!0);let p=i.getDay(),g=this.nStr1[p];p===0&&(p=7);const _=l;c=this.leapMonth(l);let x=!1;for(l=1;l<13&&u>0;l++)c>0&&l===c+1&&x===!1?(--l,x=!0,d=this.leapDays(_)):d=this.monthDays(_,l),x===!0&&l===c+1&&(x=!1),u-=d;u===0&&c>0&&l===c+1&&(x?x=!1:(x=!0,--l)),u<0&&(u+=d,--l);const F=l,b=u+1,w=a-1,E=this.toGanZhiYear(_),C=this.getTerm(s,a*2-1),k=this.getTerm(s,a*2);let T=this.toGanZhi((s-1900)*12+a+11);o>=C&&(T=this.toGanZhi((s-1900)*12+a+12));let v=!1,I=null;C===o&&(v=!0,I=this.solarTerm[a*2-2]),k===o&&(v=!0,I=this.solarTerm[a*2-1]);const j=Date.UTC(s,w,1,0,0,0,0)/864e5+25567+10,S=this.toGanZhi(j+o-1),D=this.toAstro(a,o),A=s+"-"+a+"-"+o,P=_+"-"+F+"-"+b,L=this.festival,O=this.lFestival,$=a+"-"+o;let M=F+"-"+b;return F===12&&b===29&&this.monthDays(_,F)===29&&(M="12-30"),{date:A,lunarDate:P,festival:L[$]?L[$].title:null,lunarFestival:O[M]?O[M].title:null,lYear:_,lMonth:F,lDay:b,Animal:this.getAnimal(_),IMonthCn:(x?"闰":"")+this.toChinaMonth(F),IDayCn:this.toChinaDay(b),cYear:s,cMonth:a,cDay:o,gzYear:E,gzMonth:T,gzDay:S,isToday:h,isLeap:x,nWeek:p,ncWeek:"星期"+g,isTerm:v,Term:I,astro:D}},lunar2solar:function(e,t,n,s){e=parseInt(e),t=parseInt(t),n=parseInt(n),s=!!s;const a=this.leapMonth(e);if(this.leapDays(e),s&&a!==t||e===2100&&t===12&&n>1||e===1900&&t===1&&n<31)return-1;const o=this.monthDays(e,t);let i=o;if(s&&(i=this.leapDays(e,t)),e<1900||e>2100||n>i)return-1;let l=0,c;for(c=1900;c<e;c++)l+=this.lYearDays(c);let d=0,u=!1;for(c=1;c<t;c++)d=this.leapMonth(e),u||d<=c&&d>0&&(l+=this.leapDays(e),u=!0),l+=this.monthDays(e,c);s&&(l+=o);const f=Date.UTC(1900,1,30,0,0,0),h=new Date((l+n-31)*864e5+f),p=h.getUTCFullYear(),g=h.getUTCMonth()+1,_=h.getUTCDate();return this.solar2lunar(p,g,_)}},WTe=(e,t)=>{const{viewId:n,collectionId:s}=Ne(),a=lt(),o=og(n);return Ce(i=>{const{blocks:l,collectionViews:c}=i,d=l[s],u=[],f=c[n];if(!f||!d)return u;const{calendarBy:h="",calendarByEnd:p=""}=f.format,{sortedRecordIds:g}=Jc({viewId:n,state:i,pageId:a}),{schema:_={}}=d.data;g.forEach(b=>{var S,D;const{rawStartTime:w,renderStartTime:E,rawEndTime:C,renderEndTime:k}=Oz({recordId:b,calendarBy:h,calendarByEnd:p,blocks:l});if(!E||!k)return;const T=Us(E),v=Us(k);if(v<e||T>t)return;const I=T>=e&&T<=t?T:e,j=v>=e&&v<=t?v:t;u.push({calendarBy:h,calendarByEnd:p,calendarByType:(S=_[h])==null?void 0:S.type,calendarByEndType:(D=_[p])==null?void 0:D.type,recordId:b,rawStartTime:w,rawEndTime:C,renderStartTime:E,renderEndTime:k,weekStartDate:I,weekEndDate:j,isStartTime:I===T,isEndTime:j===v,order:1})});const x=wk(u,b=>b.weekStartDate),F={};return x.forEach(b=>{var k,T;let w=0;const E=F[b.weekStartDate];E&&(w=Object.entries(wk(E)).findIndex(([v,I])=>Number(v)!==I),w=w===-1?E.length:w);let C=b.weekStartDate;for(;C<=b.weekEndDate;)F[C]=(k=F[C])!=null?k:[],(T=F[C])==null||T.push(w),C+=as;b.order=w+1}),x},[n,s,e,t,o])},KTe=y.memo(({weekFirstDay:e,weekLastDay:t,weekRef:n})=>{const s=WTe(e,t),{viewId:a}=Ne(),o=Qa(),[i=[]]=Fa(a,{visible:!0}),l=i.length;return y.useEffect(()=>{const c=n.current;if(!c)return;const d=o?80:124;if(s.length===0)c.style.height="".concat(d,"px");else{const u={};s.forEach(p=>{let g=p.weekStartDate;for(;g<=p.weekEndDate;)u[g]=(u[g]||0)+1,g=g+as});const h=Math.max(...Object.values(u))*qF(l)+Mz;c.style.height="".concat(Math.max(h,d),"px")}},[o,s,l,n]),s.length===0?null:r.jsx(r.Fragment,{children:s.map(c=>y.createElement(UTe,{...c,key:c.recordId,weekFirstDay:e}))})}),YTe=y.memo(({dates:e,setCurrentMonth:t})=>{const{container:n,calenderHeader:s}=Tx(),a=Qa(),o=y.useRef(null);return y.useEffect(()=>{var u;const i=(u=n.current)==null?void 0:u.closest("[data-page-id]"),l=o.current,c=s.current;if(!i||!l||!c)return;const d=()=>{const f=l.getBoundingClientRect(),h=c.getBoundingClientRect();f.top<h.bottom&&f.bottom>h.bottom&&t(p=>{const g=e[e.length-1];if(!g)return p;const _=g+as;return _!==p?Us(new Date(_).setDate(1)):p})};return i.addEventListener("scroll",d),()=>i.removeEventListener("scroll",d)},[s,n,e,t]),r.jsxs("div",{className:R("flex w-full relative calender-week",a?"min-h-[64px]":"min-h-[124px]"),ref:o,children:[e.map(i=>r.jsx(XTe,{date:i},i)),r.jsx(KTe,{weekFirstDay:e[0],weekLastDay:e[e.length-1],weekRef:o})]})},yn),XTe=y.memo(({date:e})=>{e+=12*fw;const{startDay:t}=Tx(),{viewId:n,readonly:s}=Ne(),a=w8(n),o=Mi({ignoreSorters:!0}),i=Qa(),l=l9()===Us(e),c=new Date(e),d=c.getDate(),u=c.getDay()===0,f=c.getDay()===1,h=c.getMonth()+1,p=GTe.solar2lunar(c.getFullYear(),h,d),g=()=>{if(s)return;const _=gn(n);if(!_)return;const{calendarBy:x,calendarByEnd:F}=_;x&&F&&o({viewId:n,where:{last:!0},propertyValues:{[x]:[Gn({from:new Date(e)})],[F]:[Gn({from:new Date(e)})]}})};return r.jsx("div",{onDoubleClick:g,"data-date":e,className:R("min-h-full border-r border-b border-grey6 calender-date flex-1 text-right flex justify-between group relative flex-shrink-0 text-t2 text-grey3",t===m.DaySetting.MON?f&&"border-l":u&&"border-l"),children:r.jsxs("div",{className:"h-10 pt-2 px-2 flex justify-between w-full",children:[!s&&r.jsx(Fe,{popup:"创建新页面",placement:"top",className:"absolute top-1.5 left-1.5 opacity-0 group-hover:opacity-100 cursor-pointer duration-150\n            text-black text-sm w-6 h-6 bg-white1 border rounded flex items-center justify-center text-center",onClick:g,children:r.jsx(V,{name:"IcBtnNew",size:"middle",className:"text-grey3"})}),r.jsxs("div",{className:R("flex w-full",a?"justify-between":"justify-end"),children:[a&&r.jsx("span",{className:"text-t3",children:!i&&p!==-1&&r.jsx(r.Fragment,{children:p.lunarFestival||p.Term?p.lunarFestival||p.Term:p.lDay===1?p.IMonthCn:p.IDayCn})}),r.jsx("span",{className:R("ml-1",l&&"calendar-today w-6 h-6 bg-red inline-block text-center text-white rounded-full"),children:d===1?"".concat(h,"月").concat(d,"日"):d})]})]})})}),L1=(e,t="init",n)=>{let s=0,a=0;if(t==="init"){const d=n?new Date(n):new Date,u=d.getMonth(),f=d.setMonth(u,1),h=d.setMonth(u+2,0);s=Us(f-((new Date(f).getDay()||7)-1)*as)-as,a=Us(h-((new Date(h).getDay()||7)-1)*as)+as*5}if(t==="append"&&n){const d=new Date(n),u=d.setMonth(d.getMonth()+2,0);s=n,a=Us(u-((new Date(u).getDay()||7)-1)*as)+as*5}const o=t==="append"?n:e===m.DaySetting.MON?s+as:s,i=e===m.DaySetting.MON?a+as:a,l=[];let c=o;if(!c)return l;for(;c<=i;)l.push(c),c+=as;return l},Dv=(e,t=Date.now())=>{const n=new Date(t),s=n.getMonth(),a=n.setMonth(s,1),o=n.setMonth(s+1,0),i=Us(a-((new Date(a).getDay()||7)-1)*as),l=i-as,d=Us(o-((new Date(o).getDay()||7)-1)*as)+as*5,u=e===m.DaySetting.MON?i:l,f=e===m.DaySetting.MON?d+as:d,h=[];let p=u;for(;p<=f;)h.push(p),p+=as;return h},QTe=({currentMonth:e,setCurrentMonth:t})=>{var x;const{calenderHeader:n,setCalenderDates:s,container:a,calenderDates:o,embed:i,startDay:l}=Tx(),{isLocked:c,managerReadonly:d,viewId:u}=Ne(),f=HN(u),h=ie();y.useEffect(()=>{const F=a.current;F&&PTe(e,o,F)},[o,a,e]);const p=F=>{let b=Date.now();if(F==="today")b=new Date().setDate(2);else{const w=new Date(e),E=w.getMonth(),C=F==="pre"?E-1:E+1;b=w.setMonth(C,1)}if(t(b),i)s(Dv(l,b));else{const w=a.current,E=w==null?void 0:w.closest("[data-page-id]");if(!E)return;s(L1(l,"init",b)),E.scrollTop=0}},g=F=>{if(c||d)return;const b=HF.map(w=>({type:H.OPERABLE_BLOCK_TEXT,data:{title:w.name,...w,selected:w.type===f}}));h.dropdown({popcorn:F.currentTarget,placement:"bottom",content:({onCloseModal:w})=>r.jsx(ze,{className:"next-modal w-36 py-2",items:b,onItemClick:({data:E})=>{Rt(u,{calendarType:E.type}),w()}})})},_=new Date(e);return r.jsxs("div",{className:"sticky w-full flex-shrink-0 justify-between border-b border-t bg-white1 z-10 text-t2-medium",style:{top:i?uE:gu},ref:n,children:[r.jsxs("div",{className:"flex items-center h-[38px] pl-4",children:[r.jsx("div",{className:"h-full flex bg-white1",children:e&&r.jsx("span",{className:"h-full inline-flex items-center",children:r.jsxs(r.Fragment,{children:[_.getFullYear(),"年",_.getMonth()+1,"月"]})})}),r.jsxs("div",{className:"ml-auto flex items-center",children:[r.jsxs("button",{onClick:g,className:"text-t2 flex h-full items-center px-3 text-grey3",children:[(x=HF.find(F=>F.type===f))==null?void 0:x.name,!d&&r.jsx(V,{size:"xxxsmall",name:"IcArrowDown01",className:"ml-1"})]}),r.jsx(Fe,{className:"rounded-sm animate-hover",onClick:()=>p("pre"),children:r.jsx(V,{name:"IcArrowDateBack",size:"middle"})}),r.jsx("span",{className:"bg-white1 px-2 cursor-pointer",onClick:()=>p("today"),children:"今天"}),r.jsx(Fe,{className:"rounded-sm animate-hover",onClick:()=>p("next"),children:r.jsx(V,{name:"IcArrowDateNext",size:"middle"})})]})]}),r.jsx("div",{className:"flex h-[38px]",children:(l===m.DaySetting.MON?"一_二_三_四_五_六_日".split("_"):Cu).map(F=>r.jsx("div",{className:"flex-1 flex items-center justify-center text-grey3",children:"周".concat(F)},F))})]})},JTe=y.memo(({embed:e})=>{const t=X3(),[n,s]=y.useState(e?Dv(t):L1(t)),a=y.useRef([]),o=y.useRef(null),i=y.useRef(null);y.useEffect(()=>{s(e?Dv(t):L1(t))},[e,t]);const l=y.useMemo(()=>({embed:e,startDay:t,container:o,calenderDates:n,setCalenderDates:s,calenderDatesRef:a,calenderHeader:i}),[n,e,t]);return a.current=n,r.jsx(Bz.Provider,{value:l,children:r.jsx(ZTe,{})})}),ZTe=()=>{const{viewId:e}=Ne(),{container:t,calenderDates:n,setCalenderDates:s,embed:a,startDay:o}=Tx(),i=y.useRef(!1),[l,c]=y.useState(Us(new Date().setDate(2))),d=yr();y.useEffect(()=>{var p;if(a)return;const f=(p=t.current)==null?void 0:p.closest("[data-page-id]");if(!f)return;const h=()=>{f.scrollHeight<f.scrollTop+f.clientHeight+200&&!i.current&&(i.current=!0,s(g=>g.concat(L1(o,"append",g[g.length-1]+as))))};return f.addEventListener("scroll",h),()=>f.addEventListener("scroll",h)},[t,a,s,o]),y.useEffect(()=>{var h;if(a)return;i.current=!1;const f=(h=t.current)==null?void 0:h.closest("[data-page-id]");f&&f.scrollHeight<=f.clientHeight&&s(p=>p.concat(L1(o,"append",p[p.length-1]+as)))},[n.length,t,a,s,o]);const u=y.useMemo(()=>{const f=[];return n.forEach((h,p)=>{p%7===0&&f.push({value:h,index:p})}),f},[n]);return r.jsxs(r.Fragment,{children:[r.jsx(QTe,{currentMonth:l,setCurrentMonth:c}),r.jsx("div",{"data-view-id":e,className:"max-h-full w-full mx-auto flex items-center flex-col overflow-auto relative calendar-container",style:{background:o===m.DaySetting.MON?"linear-gradient(90deg, transparent 71.42857142857143%, var(--grey8) 71.42857142857143%)":"linear-gradient(90deg, var(--grey8) 14.285714285%, transparent 14.285714285%, transparent 85.714285714%, var(--grey8) 85.714285714%)"},ref:t,children:r.jsx(Uz,{defaultWait:200,waitMode:"throttle",costumerWait:1e3,costumerWaitMode:"debounce",children:r.jsx(qs,{className:"w-full",data:u,customScrollParent:d.current,defaultItemHeight:124,overscan:600,itemContent:(f,h)=>r.jsx(YTe,{dates:n.slice(h.index,h.index+7),setCurrentMonth:c},h.value)})})})]})};const eve=()=>{const{viewId:e,collectionId:t,readonly:n,managerReadonly:s,embed:a}=Ne(),o=h4(),{tableGroups:i}=of(e),l=Ce(d=>{const{collectionViews:u}=d,f=u[e];if(!f)return HT(()=>null);const{calendarBy:h=""}=f.format,p=Hr(g=>{const _=pe().blocks[g];return hd(_,h)},so(kf));return HT(g=>{if(i==null)return null;if(i.withoutValidGroup){const _=i.sortedRecordIds.slice(0);_.sort(p);const x=_.indexOf(g);return x>=0?{records:_,index:x}:null}for(const _ of i.visibleGroups){const x=_.recordIds.slice(0);x.sort(p);const F=x.indexOf(g);if(F>=0)return{records:x,index:F}}return null})},[e,i]);sue(e,l);const c=Ce(({blocks:d,collectionViews:u})=>{var w,E,C;const f=d[t],h=u[e],p=(w=f==null?void 0:f.data.schema)!=null?w:{};if(!h)return;const{calendarBy:g="",calendarByEnd:_=""}=h.format,x={updateCalendarBy:!1,updateCalendarByEnd:!1},F=(E=p[g])==null?void 0:E.type,b=(C=p[_])==null?void 0:C.type;return F!==m.CollectionSchemaType.DATE&&F!==m.CollectionSchemaType.CREATED_AT&&F!==m.CollectionSchemaType.UPDATED_AT&&(x.updateCalendarBy=!0),b!==m.CollectionSchemaType.DATE&&b!==m.CollectionSchemaType.CREATED_AT&&b!==m.CollectionSchemaType.UPDATED_AT&&(x.updateCalendarByEnd=!0),x},[t,e]);return y.useEffect(()=>{n||s||c&&(c.updateCalendarBy||c.updateCalendarByEnd)&&o(e)},[o,c,n,e,s]),c?c.updateCalendarBy||c.updateCalendarByEnd?n||s?r.jsx("div",{className:"text-t2 h-[35px] flex items-center pl-2",children:"当前视图无有效日期属性，无法展示"}):null:i!=null&&i.sortedRecordIds?r.jsxs("div",{className:"min-w-[300px]",children:[r.jsx(JTe,{embed:!!a}),!n&&!a&&r.jsx(Di,{type:"collection"})]}):null:null},tve=()=>{const{viewId:e}=Ne();return HN(e)==="month"?r.jsx(eve,{}):r.jsx(qTe,{})},Z4=Mr(null),nve=e=>{var C;const{required:t,children:n,index:s,renderDragHandle:a,title:o,description:i,showDescription:l,formSerialNumber:c=!0,viewId:d,property:u,titleAfter:f,titleBefore:h,readonly:p}=e,g=$g(),_=O$(d,u),x=vs(d),b=((C=x==null?void 0:x.format.formLogic)!=null?C:[]).filter(k=>k.condition.property===u||k.gotoProperty===u),w=So(Z4),E=k=>{g(e.property,ra(k.currentTarget),zn.FORM_PROPERTIES,"left")};return r.jsxs("div",{className:"mb-5 px-2","data-form-property":u,children:[r.jsx("div",{className:"text-t1-medium flex items-center min-h-10 py-2.5 relative group",children:r.jsxs("div",{className:"flex w-full",children:[!p&&a({className:"absolute -left-6 top-3 pr-1.5 opacity-0 group-hover:opacity-80 transition-opacity",popup:"拖拽排列顺序",onClick:k=>{k.preventDefault(),E(k)}}),h&&r.jsx("span",{className:"flex-shrink-0",children:h}),c&&r.jsxs("span",{className:"flex-shrink-0",children:[s,"."]}),r.jsx("div",{className:R("break-words",o?"":"min-w-[80px]"),children:o!=null?o:"未命名标题"}),t&&r.jsx("span",{className:"text-red",children:"*"}),f&&r.jsx("span",{className:"flex-shrink-0",children:f}),b.length>=1&&!p&&r.jsxs("span",{onClick:()=>{w(()=>u)},className:"cursor-pointer text-t4 text-[#717374] bg-grey bg-opacity-20 rounded-sm inline-block px-1.5 my-1 leading-5 ml-2",children:["跳题逻辑 ",b.length,"项"]})]})}),l&&(p&&i||!p)&&r.jsx("div",{className:"py-2",onPointerDown:k=>k.stopPropagation(),children:r.jsx(ci,{keydownOption:XU,readonly:p,uuid:u,className:"text-grey3 text-t1 whitespace-pre-wrap ",placeholder:p?"":"请输入说明介绍",segments:i,onChange:k=>{fe(k).length<=1e3&&_("description",k)}})}),r.jsx("div",{onPointerDown:k=>k.stopPropagation(),children:n})]})},sve=e=>{const{submitData:t,property:n,handleChangeSubmitData:s}=e,a=us(fe(t)),o=()=>{s(n,ht(a?"NO":"YES"))};return r.jsx("div",{className:"h-11 flex items-center w-full animate-hover-black3 rounded-none",onClick:o,children:r.jsx(Ys,{size:24,className:"cursor-pointer",children:r.jsx(_a,{checked:a})})})},rve=e=>{const{type:t,schema:n,submitData:s,property:a,handleChangeSubmitData:o,collectionId:i,readonly:l}=e,{options:c=[]}=n||{},d=t===m.CollectionSchemaType.MULTI_SELECT,u=ie(),f=a4(),h=$o(),p=o4(),g=x$(),_=Ln(),x=T=>{let v=fe(s).split(",");v.some(j=>T===j&&T&&j)&&s?v=v.filter(j=>j!==T):d?v.push(T):v=[T],o(a,ht(v.join(",")))},F=T=>{h(i,a,{options:T})},b=y.useMemo(()=>{var v,I,j;const T=vr.map(S=>S.key);return(j=NE(T,(I=(v=n==null?void 0:n.options)==null?void 0:v.map(S=>S.color))!=null?I:[]))!=null?j:vr[0].key},[n==null?void 0:n.options]),w=()=>{const T=qe(),v=["选项",c.length+1].join(" ");f(i,a,{id:T,value:v,color:b}),setTimeout(()=>{const I=b0('[data-form-property="'.concat(a,'"] [data-form-select-option-id="').concat(T,'"]'),_)[0];I&&I.click()},0)},E=(T,v)=>{p(i,a,{id:T,value:v})},C=T=>{u.warning({title:r.jsx("div",{className:"mt-5 mb-5 w-80",children:"是否确认删除该选项？"}),confirm:()=>{g(i,a,T)}})},k=(T,v,I)=>{T.stopPropagation();let j=I,S=!1;const D=T.currentTarget.parentNode.getBoundingClientRect();u.dropdown({popcorn:T.currentTarget,placement:"bottom-start",offset:[-4,0],escCloseBeforeCallBack:()=>{S=!0},closeAfterCallBack:()=>{j=j.split(",").join(""),!(S||!j)&&(c.some(A=>A.value===j&&A.id!==v)?be.error("已存在同名选项"):E(v,j))},content:A=>r.jsx("div",{className:"next-modal p-2",style:{width:D.width},children:r.jsx(Ct,{defaultValue:j,autoFocus:!0,showBorder:!1,inputClassName:"text-t2 bg-white2 px-1",className:"bg-white2",onChange:P=>{P.split(",").join(""),c.some(L=>L.value===j&&L.id!==v)&&be.error("已存在同名选项"),j=P},onEnter:()=>A.onCloseModal()})})})};return r.jsxs(r.Fragment,{children:[r.jsx(br,{disabled:l,items:c,onChange:F,renderItemContent:({item:T,renderDragHandle:v})=>{const I=fe(s).split(",").some(j=>j===T.value&&j&&T.value);return r.jsxs("div",{className:"group relative flex w-full animate-hover-black3 rounded-none py-2 mx-1 mr-4",onClick:()=>x(T.value),children:[!l&&v({className:"absolute -left-5 top-3 opacity-0 group-hover:opacity-80 transition-opacity"}),d?r.jsx(_a,{size:"large",checked:I}):r.jsx(V,{className:R("mr-1.5 mt-0.5",I&&"text-active_color"),name:I?"MIcRadioSelected":"IcRadio",size:"middle"}),r.jsx("div",{"data-form-select-option-id":T.id,className:R("break-words w-full",l&&"pointer-events-none"),onClick:j=>k(j,T.id,T.value),children:r.jsx(Fe,{popup:"点击修改选项名",children:r.jsx(oi,{readonly:!0,className:"cursor-pointer min-w-[80px]",boxClassName:"w-full pr-4",placeholder:"输入选项名",value:T.value})})}),!l&&r.jsx(V,{className:"ml-2 absolute right-1 text-grey4 opacity-0 group-hover:opacity-100 transition-opacity",name:"IcOptionDelete",size:"middle",onClick:j=>{j.stopPropagation(),C(T.id)}})]})}}),!l&&r.jsxs("div",{className:"flex items-center px-1 cursor-pointer animate-hover text-t1 text-grey4 py-1.5",onClick:w,children:[r.jsx(V,{name:"IcAdd",size:"middle",className:"mr-1 opacity-60"}),r.jsx("span",{children:"添加选项"})]})]})},ave=e=>{var h,p,g,_;const[t,n]=y.useState(!1),{submitData:s,handleChangeSubmitData:a,property:o,collectionId:i}=e,l=s==null?void 0:s.find(x=>[m.TextType.DATE,m.TextType.DATETIME].includes(x.type)),c=l?ud(l):null,d=$o(),u=eo(i,o),f=l&&Yp(l,(h=u.propertySchema)==null?void 0:h.dateFormat,(l==null?void 0:l.type)===m.TextType.DATETIME,(p=u.propertySchema)==null?void 0:p.timeFormat);return r.jsx(h0,{visible:t,onClick:()=>n(!0),onChange:n,placement:"bottom",content:r.jsx(J0,{uiOption:{hasFormatSetting:!e.readonly},dateInfo:{from:c!=null?c:new Date,includeTime:(l==null?void 0:l.type)===m.TextType.DATETIME,dateFormat:(g=u.propertySchema)==null?void 0:g.dateFormat,timeFormat:(_=u.propertySchema)==null?void 0:_.timeFormat},onChange:x=>{a(o,[Gn(x)]),e.readonly||d(i,o,{dateFormat:x.dateFormat,timeFormat:x.timeFormat})},onClear:()=>{a(o,ht("")),n(!1)}}),children:r.jsx("div",{className:R("text-t1 py-2.5 px-2 border border-grey6 rounded cursor-pointer",!f&&"text-grey6"),children:f||"年/月/日"})})},ove=e=>{const{submitData:t,handleChangeSubmitData:n,property:s,pushUploadFileList:a,uploadFileList:o=[],readonly:i,spaceId:l,viewId:c}=e,d=Uo(),u=Joe(),f=nN(),h=ie(),p=ln(),g=F=>{var k;let b=0;const w=qe();if(!i||!l){be.error("当前状态无法上传");return}if(!F[0])return;((k=J.collectionViews[c])==null?void 0:k.format.formPermission)===m.FormPermission.NO_LOGIN?Array.from(F).forEach(T=>{u({file:T,type:"file",spaceId:l,viewId:c,isDatabase:!0,onProgress(v){h.loading({modalId:w,title:"正在上传 ".concat(v,"%")})},async onComplete(v){if(b++,b===F.length&&p(w),v.success){const I=await f(T),j=Zk({name:T.name,ossName:v.ossName,...I});be.success("".concat(T.name,"上传成功")),n(s,[j],{concatSegment:!0}),a(s,"".concat(j.uuid),URL.createObjectURL(T))}}})}):Array.from(F).forEach(T=>{d({file:T,type:"file",spaceId:l,isDatabase:!0,onProgress(v){h.loading({modalId:w,title:"正在上传 ".concat(v,"%")})},async onComplete(v){if(b++,b===F.length&&p(w),v.success){const I=await f(T),j=Zk({name:T.name,ossName:v.ossName,...I});be.success("".concat(T.name,"上传成功")),n(s,[j],{concatSegment:!0}),a(s,"".concat(j.uuid),URL.createObjectURL(T))}}})})},_=F=>{if(!F)return;const b=t==null?void 0:t.filter(w=>w.uuid!==F);n(s,b)},x=F=>{n(s,F)};return t!=null&&t.length?r.jsx(h0,{placement:"bottom",content:r.jsxs("div",{className:"next-modal max-w-lg min-w-[500px]",children:[r.jsx("div",{className:"overflow-y-auto max-h-[50vh]",children:r.jsx(br,{modifiers:[e3],items:t.map(F=>({id:"".concat(F.uuid),data:F})),onChange:F=>x(F.map(b=>b.data)),renderItemContent:({item:F,renderDragHandle:b})=>{var k;const w=Jt.image.test(rn(F.data.text).extName),E=(k=o.find(T=>T.id===F.data.uuid))==null?void 0:k.url;let C=r.jsxs("span",{className:"text-t2 px-1 flex items-center w-full",children:[r.jsx(V,{name:Ya(rn(F.data.text).extName),size:"middle",className:"mr-2"}),F.data.text]});return w&&(C=r.jsx("img",{className:"max-h-[165px]",src:E,alt:F.data.text})),r.jsxs("div",{className:"flex px-4 py-2.5 pr-11 relative",children:[b({className:"mr-2 mt-1"}),C,r.jsx(Fe,{popup:"移除文件",className:"absolute right-4 top-3 animate-hover cursor-pointer text-grey4",children:r.jsx(V,{onClick:()=>_(F.data.uuid),name:"IcOptionDelete",size:"middle"})})]},F.data.uuid)}})}),r.jsxs(pv,{className:"animate-hover rounded-none relative flex items-center text-t2 w-full text-grey3 h-10 border-t border-grey6 cursor-pointer px-4",multiple:!0,onSelect:F=>{g(F)},children:[r.jsx(V,{name:"IcAdd",size:"middle",className:"mr-1"}),"添加附件或图片"]})]}),children:r.jsx("div",{className:R("border border-grey6 rounded px-1 pt-2 cursor-pointer flex items-center flex-wrap",t.length===0&&"pb-2"),children:t.map(F=>{var E;const b=Jt.image.test(rn(F.text).extName),w=(E=o.find(C=>C.id===F.uuid))==null?void 0:E.url;return w&&b?r.jsx("img",{className:"h-7 mr-1.5 mb-2",src:w,alt:F.text},F.uuid):r.jsx("span",{className:"text-t2 px-1 bg-grey6 mr-1.5 mb-2",children:F.text},F.uuid)})})}):r.jsx(Fe,{popup:"支持多选",children:r.jsxs(pv,{className:"relative flex items-center text-t1 w-full text-grey4 h-11 rounded bg-grey8 cursor-pointer px-2",multiple:!0,onSelect:F=>{g(F)},children:[r.jsx(V,{name:"IcBlockFile",size:"middle",className:"mr-1"}),"点击上传文件"]})})},ive=e=>{var f;const{property:t,schema:n,submitData:s,handleChangeSubmitData:a,type:o}=e,i=y.useMemo(()=>{const h={tooltip:"",icon:"",url:Oi(s),href:""};switch(o){case m.CollectionSchemaType.EMAIL:pb(h.url)&&(h.tooltip="发送邮件",h.icon="IcTitleEmail",h.href="mailto:".concat(h.url));break;case m.CollectionSchemaType.PHONE:r8(h.url)&&(h.tooltip="拨打电话",h.icon="IcTitlePhone",h.href="tel:".concat(h.url));break;case m.CollectionSchemaType.URL:Gu(h.url)&&(h.tooltip="访问链接",h.icon="IcTitleUrl",h.href=Rp(h.url));break;default:return null}return h},[s,o]),l=h=>{const p=/^\d+$/.test(h);m.CollectionSchemaType.PHONE===o&&!p&&h||a(t,ht(h))},c=h=>{var g,_;let p=SS(h);return Number.isNaN(p)&&(p=SS((_=(g=h.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:g[0])!=null?_:"")),Number.isNaN(p)?"":"".concat(p)},d=((f=zI.find(h=>h.type===(n==null?void 0:n.type)))==null?void 0:f.title)||"文本",u=!!(o&&[m.CollectionSchemaType.TEXT,m.CollectionSchemaType.TITLE].includes(o));return r.jsxs("div",{className:"border border-grey6 rounded text-t1 py-2.5 px-2 relative group",children:[r.jsx(oi,{singleLine:!u,shiftEnter:u,fontClassName:R(u&&"max-h-[100px] overflow-y-auto"),onBlur:()=>{if(m.CollectionSchemaType.NUMBER===o){const h=c(fe(s||[]));a(t,ht(h))}},placeholder:"请输入".concat(d),value:fe(s||[]),onChange:h=>{l(h.currentTarget.value)}}),(i==null?void 0:i.href)&&r.jsx(Fe,{popup:i.tooltip,className:"opacity-0 group-hover:opacity-100 transition-opacity absolute right-2 top-3",children:r.jsx("a",{href:i.href,target:"_blank",rel:"noopener noreferrer",className:"w-6 h-6 flex items-center justify-center border rounded bg-white1 animate-hover-opaque",children:r.jsx(V,{name:i.icon,size:"middle",className:"text-grey3"})})})]})},lve=e=>{const{submitData:t,handleChangeSubmitData:n,property:s}=e,a=ba(),o=ie(),i=d=>{n(s,d)},l=({defaultValue:d,onUpdate:u,onCloseModal:f})=>{const[h,p]=y.useState(d);return r.jsx("div",{className:"next-modal",children:r.jsx(TE,{value:h,includeGroup:!1,onClose:()=>f(),onUpdate:g=>{p(g),u(g)}})})},c=d=>{o.dropdown({popcorn:d.currentTarget,placement:"bottom",content:u=>r.jsx(l,{defaultValue:t,onUpdate:i,onCloseModal:u.onCloseModal})})};return r.jsx("div",{onClick:c,className:R("px-2 border border-grey6 rounded cursor-pointer",t!=null&&t.length?"py-0.5":"py-2"),children:t!=null&&t.length?r.jsx("div",{className:"flex items-center flex-wrap cursor-pointer py-px",children:t.map(d=>d.uuid&&a[d.uuid]?r.jsx(wE,{userId:d.uuid},d.uuid):null)}):r.jsx("div",{className:"text-t1 text-grey4",children:"添加成员"})})},cve=({collectionId:e,viewId:t})=>{const{isLocked:n}=Ne(),s=cf(),a=$g();if(n)return null;const o=i=>{me.event("bitable_property_create",{from_scene:"form"});const l=s({collectionId:e,viewId:t});l&&(st({$newTableProperty:{propertyId:l,from:zn.FORM_PROPERTIES}}),a(l,ra(i.currentTarget),zn.FORM_PROPERTIES,"bottom-start"))};return r.jsxs("div",{className:"flex items-center px-2 text-t2 animate-hover text-grey4 py-2",onClick:o,children:[r.jsx(V,{name:"IcAdd",size:"middle",className:"mr-1 opacity-60"}),r.jsx("span",{children:"添加属性"})]})},Ac={Person:lve,CheckBox:sve,Select:rve,DateElement:ave,File:ove,FormatTextarea:ive,Container:nve,CreateFormProperty:cve},dve=({isFromViewSetting:e})=>{var g;const{viewId:t,collectionId:n,isLocked:s}=Ne(),a=vs(t),[o=[]]=Fa(t,{visible:!0}),i=ft(n,_=>{var x;return(x=_==null?void 0:_.data.schema)!=null?x:{}}),l=SF(i,o.map(_=>_.property),(g=a==null?void 0:a.format.formLogic)!=null?g:[]),[c,d]=pp(Z4),u=()=>{const _=l.slice(0);if(o.length===0)return;const x=o[0];_.push({condition:{property:x.property,propertyType:x.type,operator:"isNotEmpty",type:"filter",value:""},gotoProperty:tp}),Rt(t,{formLogic:_}),me.event("form_logic_manage",{manage_type:"create"})},f=(_,x)=>{const F=l.slice(0);F[_]=x,Rt(t,{formLogic:F})},h=_=>{const x=l.slice(0);x.splice(_,1),Rt(t,{formLogic:x}),me.event("form_logic_manage",{manage_type:"delete"})},p=_=>{Rt(t,{formLogic:_.map(x=>x.rule)})};return Gp(()=>{d(null)}),r.jsxs("div",{className:R("min-w-[560px]",!e&&"next-modal-scroll"),children:[l.length===0&&r.jsx("div",{className:"text-grey3 text-t2 mx-4 my-2 select-none",children:"当前无跳题逻辑"}),r.jsx(br,{className:"min-h-0 max-h-[calc(80vh-90px)] flex-1 overflow-y-auto",onlyHandleDraggable:!0,items:l.map((_,x)=>({id:"".concat(x),rule:_})),renderItemContent:({item:{id:_,rule:x},renderDragHandle:F})=>{const b=Number(_);return r.jsxs("div",{className:R("px-4 py-2 space-y-2 border-grey6 text-t2",_!=="0"&&"border-t",(c===x.condition.property||c===x.gotoProperty)&&"bg-light_yellow bg-opacity-20"),children:[r.jsxs("div",{className:"flex items-center",children:[r.jsxs("div",{className:"flex flex-1 min-w-0 items-center",children:[r.jsxs("div",{className:"flex items-center justify-between w-[64px] text-grey3",children:[F({className:"cursor-pointer"}),r.jsx("span",{className:"select-none",children:"若"})]}),r.jsx(iP,{className:"w-[160px] mx-2",value:x.condition.property,onChange:w=>{f(b,Yn(x,E=>{Uy(n,E.condition,"property",w)}))}}),r.jsx(A$,{className:"mr-2",property:x.condition.property,value:x.condition.operator,onChange:w=>{f(b,Yn(x,E=>{Uy(n,E.condition,"operator",w)}))}}),r.jsx(R$,{path:[],className:"w-[160px]",property:x.condition.property,operator:x.condition.operator,value:x.condition.value,onChange:w=>{f(b,Yn(x,E=>{Uy(n,E.condition,"value",w)}))}})]}),!s&&r.jsx(V,{size:"large",className:"ml-3 cursor-pointer text-grey3 hover:text-grey1",name:"IcToastClose",onClick:()=>{h(b)}})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex justify-end w-[64px] text-grey3",children:r.jsx("span",{className:"select-none",children:"则跳转"})}),r.jsx(iP,{className:"w-[160px] mx-2",value:x.gotoProperty,mustGtValue:x.condition.property,allowEndPage:!0,onChange:w=>{f(Number(_),{...x,gotoProperty:w})}}),r.jsx("span",{className:"text-grey3 select-none",children:"，不符合条件将正常进入下一题"})]})]})},onChange:p}),r.jsxs("button",{className:R("flex items-center w-full h-10 p-2 animate-hover pl-4 border-t border-grey6 text-grey3",s&&"cursor-not-allowed"),onClick:u,disabled:s,children:[r.jsx(V,{className:"mr-1",name:"IcAdd",size:"middle"}),r.jsx("span",{className:"text-t2",children:"创建跳题逻辑"})]})]})},iP=({className:e,value:t,mustGtValue:n,onChange:s,allowEndPage:a=!1})=>{const{viewId:o,isLocked:i}=Ne(),[l=[]]=Fa(o,{visible:!0}),c=l.filter(u=>!qI.includes(u.type)),d=n?c.findIndex(u=>u.property===n):-1;return r.jsx(Dl,{readonly:i,className:e,dropdownClassName:"max-w-[260px]",value:t,onChange:s,options:[...c.map((u,f)=>{const{type:h}=u;return{value:u.property,title:"".concat(f+1,". ").concat(u.name),icon:h&&un[h]}}).filter((u,f)=>f>d),...a?[{value:tp,title:"结束页",icon:"IcEndPage"}]:[]]})},eS=({isFromViewSetting:e})=>{const{collectionId:t,viewId:n,readonly:s,isLocked:a,viewType:o}=Ne(),[i,l]=y.useState(!1),c=vs(n),[d=[],u=[]]=Fa(n),f=cf(),h=ie();if(!c||!o)return null;const p=o===m.CollectionViewType.FORM?d.filter(b=>!qI.includes(b.type)):i?u:d,g=p.every(b=>b.visible===!0),_=async b=>{var j;const{active:w,over:E}=b;if(!E)return;const{properties:C=[],timelineTableProperties:k=[],formLogic:T=[]}=(j=gn(n))!=null?j:{},v=i?k:C;let I;if(w.id!==E.id){const S=v.findIndex(P=>P.property===w.id),D=v.findIndex(P=>P.property===E.id),A=Wu(v,S,D);if(o===m.CollectionViewType.FORM&&(I=D1(t,n,A.map(P=>P.property),T),I!=null&&!await new Promise(L=>{h.warning({title:r.jsx(r.Fragment,{children:"确认调整题目顺序吗？"}),content:r.jsx(r.Fragment,{children:"会导致部分跳题逻辑失效，将自动删除失效逻辑。"}),confirm(){L(!0)},cancel(){L(!1)}})})))return;Rt(n,{[i?"timelineTableProperties":"".concat(o,"Properties")]:A,...I?{formLogic:I}:{}})}},x=async()=>{var j;if(a)return;const b=!g,{previewType:w}=C8(n),{properties:E=[],timelineTableProperties:C=[],formLogic:k=[]}=(j=gn(n))!=null?j:{},v=(i?C:E).map(S=>c.type!==m.CollectionViewType.FORM&&S.property==="title"&&!i&&(o===m.CollectionViewType.TABLE||o===m.CollectionViewType.LIST||o===m.CollectionViewType.TIMELINE||o===m.CollectionViewType.CALENDAR||w===m.CoverType.NONE)?S:{...S,visible:b}),I={[i?"timelineTableProperties":"".concat(o,"Properties")]:v};if(i&&(I.timelineShowTable=b),o===m.CollectionViewType.FORM&&!b){const S=D1(t,n,v.filter(D=>D.visible).map(D=>D.property),k);if(S!=null){if(!await new Promise(A=>{h.warning({title:r.jsx(r.Fragment,{children:"确认隐藏题目吗？"}),content:r.jsx(r.Fragment,{children:"会导致部分跳题逻辑失效，将自动删除失效逻辑。"}),confirm(){A(!0)},cancel(){A(!1)}})}))return;I.formLogic=S}}Rt(n,I)},F=()=>{me.event("bitable_property_create",{from_scene:"menu"});const b=f({collectionId:t,viewId:n,visible:!0,isTimelineTable:i});b&&st({$newTableProperty:{propertyId:b,from:zn.PROPERTY_LIST}})};return r.jsxs("div",{className:R("pt-[5px]",e?"w-full":"next-modal-scroll w-[400px]"),children:[r.jsxs("div",{className:"flex h-10 items-center justify-between px-4",children:[r.jsxs("div",{className:"text-t2 flex items-center",children:[r.jsx(V,{className:"mr-1",name:Ga[o],size:"middle"}),r.jsx("span",{className:"mr-2 font-medium",children:wl[o]}),r.jsx("span",{className:"max-w-[140px] overflow-hidden overflow-ellipsis whitespace-nowrap",children:c.title})]}),[m.CollectionViewType.TABLE,m.CollectionViewType.LIST,m.CollectionViewType.CALENDAR,m.CollectionViewType.TIMELINE,m.CollectionViewType.FORM].includes(o)&&r.jsx("button",{className:R("text-t2 text-active_color",a&&"cursor-not-allowed opacity-20"),onClick:x,children:g?"全部隐藏":"全部显示"})]}),[m.CollectionViewType.BOARD,m.CollectionViewType.GALLERY].includes(o)&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"flex h-10 items-center justify-between px-4",children:[r.jsx("span",{className:"text-t2 text-grey3",children:r.jsxs(r.Fragment,{children:["在",wl[o],"中显示"]})}),r.jsx("button",{className:R("text-t2 text-active_color",a&&"cursor-not-allowed opacity-20"),onClick:x,children:g?"全部隐藏":"全部显示"})]})}),o===m.CollectionViewType.TIMELINE&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"border-b border-grey6 py-1.5 px-2",children:[r.jsx("button",{onClick:()=>l(!1),className:R("mr-2 rounded-sm py-1.5 px-4",!i&&"bg-black_006"),children:"时间轴"}),r.jsx("button",{onClick:()=>l(!0),className:R("rounded-sm py-1.5 px-4",i&&"bg-black_006"),children:"表格"})]})}),r.jsx(br,{disabled:a,items:p.map(b=>({id:b.property,...b})),onChange:(b,w)=>_(w),renderItemContent:({item:b})=>r.jsx(uve,{...b,isTimelineTable:i})}),!s&&!a&&r.jsxs(r.Fragment,{children:[r.jsx(Cr,{}),r.jsxs("button",{className:"animate-hover flex h-10 w-full items-center px-3 text-grey3",onClick:F,children:[r.jsx(V,{className:"mr-1",name:"IcAdd",size:"middle"}),r.jsx("span",{className:"text-t2",children:"创建属性"})]})]})]})},uve=e=>{const t=ie(),{property:n,visible:s,name:a,type:o,dragOverlay:i,isTimelineTable:l}=e,{viewId:c,viewType:d,collectionId:u,isLocked:f}=Ne(),h=M$(),{previewType:p}=Wm(c),g=$g(),_=y.useRef(null),x=A3(n,zn.PROPERTY_LIST),F=async C=>{var k,T;if(!f){if(d===m.CollectionViewType.FORM&&!C){const v=pe().collectionViews[c],I=(k=v==null?void 0:v.format.formProperties)!=null?k:[],j=(T=v==null?void 0:v.format.formLogic)!=null?T:[];if(D1(u,c,I.filter(D=>D.property===n?C:D.visible).map(D=>D.property),j)!=null){if(!await new Promise(A=>{t.warning({title:r.jsx(r.Fragment,{children:"确认隐藏题目吗？"}),content:r.jsx(r.Fragment,{children:"会导致部分跳题逻辑失效，将自动删除失效逻辑。"}),confirm(){A(!0)},cancel(){A(!1)}})}))return;Rt(c,{formLogic:j})}}h(u,c,n,C,l)}};y.useEffect(()=>{_.current&&x&&(g(n,_.current,l?zn.PROPERTY_LIST_TIMELINE_TABLE:zn.PROPERTY_LIST),st({$newTableProperty:void 0}))},[x,l,g,n]);const b=n==="title",w=d!==m.CollectionViewType.FORM&&b&&!l&&(d===m.CollectionViewType.TABLE||d===m.CollectionViewType.LIST||d===m.CollectionViewType.TIMELINE||d===m.CollectionViewType.CALENDAR||p===m.CoverType.NONE),E=C=>{f||g(n,C.currentTarget,l?zn.PROPERTY_LIST_TIMELINE_TABLE:zn.PROPERTY_LIST)};return r.jsxs("div",{ref:_,className:R("text-t2 animate-hover flex h-8 cursor-pointer items-center justify-between px-3",i&&"cursor-[grabbing]"),onClick:E,children:[r.jsxs("div",{className:"flex flex-1 items-center overflow-hidden",children:[r.jsx("div",{className:"mr-1 flex h-5 w-5 items-center justify-center",children:r.jsx(V,{name:"IcMenu",className:"text-grey4",size:"middle"})}),r.jsx(V,{className:"mr-1",size:"middle",name:un[o]}),r.jsx("span",{className:"flex-1 overflow-hidden overflow-ellipsis whitespace-nowrap pr-2",children:a})]}),r.jsx(en,{open:s,disabled:w||f,onSwitch:F})]})},Vz=({children:e,header:t,report:n,className:s,hiddenFooter:a,headerClassName:o,containerClassName:i})=>r.jsxs("div",{className:R("relative flex flex-col items-center",i),children:[r.jsx("div",{className:R("w-full flex-shrink-0 h-[320px]",o),children:t}),r.jsx("div",{className:R("px-20 -mt-[150px] next-modal shadow-light w-full relative z-10 max-w-[960px] mb-10",s),children:e}),r.jsx("div",{hidden:!1,className:R("flex items-center w-full max-w-[1420px] border-t border-grey6 h-24 flex-shrink-0 mt-auto",a&&"border-none hidden"),children:!a&&r.jsxs("div",{className:"flex items-center justify-between w-full max-w-[960px] mx-auto",children:[r.jsx("span",{className:"text-t2 flex items-center",children:r.jsx(Bg,{description:r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"ml-2",children:JI}),r.jsx("span",{className:"text-grey3",children:" 提供技术支持 "})]})})}),n?r.jsx("span",{className:"text-t2 cursor-pointer",onClick:n,children:"举报违法信息"}):r.jsx("span",{})]})})]}),$z=({uuid:e})=>r.jsx(F4,{docId:e,pageScene:wt.FORM_ENG_PAGE,nameSpace:uc.FORM_END_PAGE}),fve=e=>{var b;const{collectionId:t,viewId:n,onCloseModal:s}=e,a=vs(n),o=Ja(),i=ye(t,["data"],["cover","coverPos"]),[l,c]=y.useState((b=a==null?void 0:a.format.formEndPage)!=null?b:""),[d,u]=y.useState(""),[f,h]=y.useState(!0),p=async()=>{var k;const w=new P3,E=Xp(l),C=(k=An(E==null?void 0:E.pathname.split(Nt.share)))==null?void 0:k.slice(0,36);if(XZ(l)){be.error("暂不支持收集表链接");return}if(!hw(l)||!C){be.error("链接不正确，请填写公开分享链接");return}return await o(C,{callback:T=>{if(T.code===200&&mn(C).shared){w.resolve(C);return}be.error("链接未开启分享"),w.resolve("")}}).catch(()=>{be.error("链接未开启分享"),w.resolve("")}),w.promise},g=async()=>{if(!l)return;const w=await p();w&&u(w)},_=async()=>{l?await p()&&(me.event("end_page"),Rt(n,{formEndPage:l})):Rt(n,{formEndPage:l}),s()},x=()=>{a!=null&&a.format.formEndPage&&(Rt(n,{formEndPage:void 0}),be.success("设置成功")),u(""),c("")};if(y.useEffect(()=>{a!=null&&a.format.formEndPage?g().then(()=>{h(!1)}):h(!1)},[]),!i)return null;if(f)return r.jsx(xs,{});const F=r.jsxs("div",{className:"pt-14 px-24 mx-auto h-full flex flex-col text-left",children:[r.jsx("div",{className:"text-h3",children:"支持在结束页嵌入分享页面，用于提交后的信息展示"}),r.jsx("div",{className:"mt-10 text-t2",children:"1. 自行撰写内容  2.开启“".concat(E3,"”并粘贴至下方")}),r.jsx(Ct,{autoFocus:!0,value:l,onChange:c,className:"h-8 w-full mt-7",placeholder:"粘贴分享链接",addonAfter:r.jsx("div",{onClick:g,className:R("w-24 h-full flex items-center justify-center border-l bg-white2 rounded-l-none",!l&&"cursor-not-allowed",l&&"animate-hover animate-click"),children:"预览"})})]});return r.jsxs("div",{className:"flex flex-col h-full relative",children:[r.jsxs("div",{className:"w-full flex items-center justify-between h-14 px-4 text-t1-medium bg-white2 flex-shrink-0 sticky top-0 left-0 z-20",children:[r.jsx("div",{className:"text-t2-medium",children:"结束页设计"}),r.jsxs("div",{className:"flex",children:[r.jsx(De,{colorType:"base_white",className:"mr-2",onClick:()=>s(),children:"取消"}),r.jsx(De,{colorType:"active",onClick:_,children:"完成"})]})]}),r.jsxs("div",{className:"flex absolute top-16 right-4 z-50",children:[l&&r.jsx(De,{colorType:"base_white",className:"mr-4",onClick:x,children:"恢复默认"}),d&&r.jsx(De,{colorType:"base_white",onClick:()=>u(""),children:"修改链接"})]}),r.jsx(Vz,{className:"h-[60vh] flex px-0",containerClassName:"pb-20",header:r.jsx(Yg,{uuid:i.uuid,ossName:i.data.cover||"cover/flowus2",hiddenEditorButton:!0,height:320}),hiddenFooter:!0,children:d?r.jsx($z,{uuid:d}):F})]})},Hz=()=>{const e=ie(),t=n=>{e.modal({className:"w-[95vw] h-[95vh]",content:s=>r.jsx(fve,{viewId:n.viewId,collectionId:n.collectionId,onCloseModal:s.onCloseModal})})};return y.useCallback(t,[e])},zz=()=>{const e=Oe(),t=n=>{const s=gn(n);if(!s)return;const{view:a}=s,o=qe(),i=Date.now(),l={...a,format:{...a.format,formShared:!1},uuid:o,status:m.BlockStatus.NORMAL,createdAt:i,updatedAt:i,version:0,title:a.title?"副本 ".concat(a.title):"",shareId:void 0};return e(()=>(re(ku({collectionView:l})),re(Tu({uuid:o,parentId:a.parentId,after:n})),o))};return y.useCallback(t,[e])},qz=()=>{const e=Oe(),t=n=>{e(()=>{PM(n)})};return y.useCallback(t,[e])},mve=()=>{const e=(t,n)=>{const{collectionViews:s}=J,a=s[t];if(!a)return;const o={boardCardSize:n};switch(a.type){case m.CollectionViewType.BOARD:o.boardCardSize=n;break;case m.CollectionViewType.GALLERY:o.galleryCardSize=n;break}Rt(t,o)};return y.useCallback(e,[])},hve=()=>{const e=Oe(),{getState:t}=ss(),n=(s,a,o)=>{e(()=>{const{collectionViews:i}=t(),l=i[s];if(!l)return;const c={};switch(l.type){case m.CollectionViewType.BOARD:{c.boardCoverType=a,c.boardCoverProperty=o;break}case m.CollectionViewType.GALLERY:{c.galleryCoverType=a,c.galleryCoverProperty=o;break}}Rs(s,{format:c})})};return y.useCallback(n,[t,e])},Ey={[m.CardSize.SMALL]:"小",[m.CardSize.MEDIUM]:"中",[m.CardSize.LARGE]:"大"},pve={[m.CollectionCardImageDir.HORIZONTAL]:"横向",[m.CollectionCardImageDir.VERTICAL]:"纵向"},gve={[m.CoverType.NONE]:"无",[m.CoverType.PAGE_COVER]:"封面",[m.CoverType.PAGE_CONTENT]:"页面内容"},_ve=()=>{const e=Js(),{viewId:t,viewType:n,isLocked:s}=Ne(),[a=[]]=Fa(t),o=Bi(t),i=Li(t),l=mE(t),c=E8(t),{previewType:d,previewProperty:u}=Wm(t),f=ie(),h=hve(),p=mve(),g=n===m.CollectionViewType.BOARD,_=E=>{if(s)return;const C=a.filter(k=>k.type===m.CollectionSchemaType.FILE);f.dropdown({popcorn:E.currentTarget,placement:"bottom-end",offset:[-8,0],content:({onCloseModal:k})=>r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:[{type:H.OPERABLE_BLOCK_TEXT,data:{title:"无",type:m.CoverType.NONE,selected:d===m.CoverType.NONE}},{type:H.OPERABLE_BLOCK_TEXT,data:{title:"封面",type:m.CoverType.PAGE_COVER,selected:d===m.CoverType.PAGE_COVER}},{type:H.OPERABLE_BLOCK_TEXT,data:{title:"页面内容",type:m.CoverType.PAGE_CONTENT,selected:d===m.CoverType.PAGE_CONTENT}},{type:H.LINE,isHidden:C.length<=0},...C.map(T=>({type:H.OPERATION,data:{title:T.name,icon:"IcTitleFiles",type:m.CoverType.FILE_PROPERTY,property:T.property,selected:d===m.CoverType.FILE_PROPERTY&&u===T.property}}))],onItemClick:T=>{(T.data.type!==d||T.data.property!==u)&&(h(t,T.data.type,T.data.property),T.data.type===m.CoverType.PAGE_COVER&&(e(Je.GUIDE_FIRST_TIME_BOARD_VIEW,ct.advancedList),g||e(Je.CREATE_GALLERY_VIEW,ct.advancedList,{step2:!0}))),k()}})})},x=E=>{s||f.dropdown({popcorn:E.currentTarget,placement:"bottom-end",offset:[-8,0],content:({onCloseModal:C})=>r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:[{type:H.OPERABLE_BLOCK_TEXT,data:{title:Ey[m.CardSize.SMALL],type:m.CardSize.SMALL,selected:o===m.CardSize.SMALL}},{type:H.OPERABLE_BLOCK_TEXT,data:{title:Ey[m.CardSize.MEDIUM],type:m.CardSize.MEDIUM,selected:o===m.CardSize.MEDIUM}},{type:H.OPERABLE_BLOCK_TEXT,data:{title:Ey[m.CardSize.LARGE],type:m.CardSize.LARGE,selected:o===m.CardSize.LARGE}}],onItemClick:k=>{k.data.type!==o&&(p(t,k.data.type),C())}})})},F=E=>{s||f.dropdown({popcorn:E.currentTarget,placement:"bottom-end",offset:[-8,0],content:({onCloseModal:C})=>r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:[{type:H.OPERABLE_BLOCK_TEXT,data:{title:"横向",type:m.CollectionCardImageDir.HORIZONTAL,selected:i===m.CollectionCardImageDir.HORIZONTAL}},{type:H.OPERABLE_BLOCK_TEXT,data:{title:"纵向",type:m.CollectionCardImageDir.VERTICAL,selected:i===m.CollectionCardImageDir.VERTICAL}}],onItemClick:k=>{k.data.type!==i&&(Rt(t,{[g?"boardImageDir":"galleryImageDir"]:k.data.type}),C())}})})},b=E=>{s||Rt(t,{[g?"boardCoverAspect":"galleryCoverAspect"]:E?m.CoverAspectType.CONTAIN:m.CoverAspectType.COVER})},w=E=>{s||Rt(t,{[g?"boardShowPropertyName":"galleryShowPropertyName"]:E})};return r.jsxs("div",{children:[r.jsxs("button",{className:"animate-hover flex h-10 w-full items-center justify-between px-2",onClick:_,children:[r.jsx("span",{className:"text-t2",children:"卡片预览"}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-t2 mr-2 text-grey3",children:d===m.CoverType.FILE_PROPERTY?(()=>{const E=a.find(C=>C.property===u);return r.jsxs("span",{className:"flex items-center",children:[r.jsx(V,{name:"IcTitleFiles",size:"middle"}),r.jsx("span",{children:E==null?void 0:E.name})]})})():gve[d]}),r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall"})]})]}),d!==m.CoverType.FILE_PROPERTY&&r.jsxs("button",{className:"animate-hover flex h-10 w-full items-center justify-between px-2",onClick:F,children:[r.jsx("span",{className:"text-t2",children:"卡片样式"}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-t2 mr-2 text-grey3",children:pve[i]}),r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall"})]})]}),r.jsxs("button",{className:"animate-hover flex h-10 w-full items-center justify-between px-2",onClick:x,children:[r.jsx("span",{className:"text-t2",children:"卡片大小"}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-t2 mr-2 text-grey3",children:Ey[o]}),r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall"})]})]}),d!==m.CoverType.NONE&&r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"适应预览图"}),r.jsx(en,{open:l===m.CoverAspectType.CONTAIN,onSwitch:b,disabled:s})]}),r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"显示属性名"}),r.jsx(en,{open:c,onSwitch:w,disabled:s})]})]})},xve=()=>{const e=Oe(),{getState:t}=ss(),n=(s,a,o)=>{const{collectionViews:i}=t(),l=i[s];if(!l)return;const c=l.type===m.CollectionViewType.TIMELINE,d={};a==="startTime"&&(d[c?"timelineBy":"calendarBy"]=o),a==="endTime"&&(d[c?"timelineByEnd":"calendarByEnd"]=o),e(()=>{Rs(s,{format:d})})};return y.useCallback(n,[t,e])},yve=({isStartTime:e,onCloseModal:t})=>{const{viewId:n,collectionId:s}=Ne(),a=xve(),{startBy:o,endBy:i}=Ce(({collectionViews:d})=>{var x;const u=d[n],{timelineBy:f,timelineByEnd:h,calendarBy:p,calendarByEnd:g}=(x=u==null?void 0:u.format)!=null?x:{},_=(u==null?void 0:u.type)===m.CollectionViewType.TIMELINE;return{startBy:_?f:p,endBy:_?h:g}},[n]),l=ft(s,d=>{var h;const u=(h=d==null?void 0:d.data.schema)!=null?h:{},f=[];return Object.entries(u).forEach(([p,g])=>{(g.type===m.CollectionSchemaType.CREATED_AT||g.type===m.CollectionSchemaType.UPDATED_AT||g.type===m.CollectionSchemaType.DATE)&&f.push({id:p,...g})}),f}),c=()=>l.map(d=>({type:H.OPERATION,data:{id:d.id,title:d.name,icon:un.date,hasArrow:e?d.id===o:d.id===i,arrow:r.jsx(V,{name:"IcCheck02",size:"normal"})}}));return r.jsx(ze,{className:"w-[160px] next-modal-scroll py-[5px]",items:c(),onItemClick:d=>{d.data.id!==(e?o:i)&&(a(n,e?"startTime":"endTime",d.data.id),t==null||t())}})},bve=({closeSelf:e})=>{const{viewId:t}=Ne(),n=zN(t),s=[10,20,30,50,100,Tp].map(a=>({type:H.OPERABLE_BLOCK_TEXT,data:{title:a===Tp?"不限":"".concat(a,"条"),selected:n===a,pageSize:a}}));return r.jsx("div",{className:"w-[220px] py-2 next-modal",children:r.jsx(ze,{className:"overflow-auto max-h-120",items:s,onItemClick:a=>{Rt(t,{loadLimit:a.data.pageSize}),e()}})})},Gz=[{type:m.CardColorSource.EMPTY,name:"不显示"},{type:m.CardColorSource.CUSTOM,name:"自定义颜色"},{type:m.CardColorSource.PROPERTY,name:"跟随单选属性颜色"}],Fve=()=>{var f;const{viewId:e,viewType:t,collectionId:n}=Ne(),{propertyId:s,type:a}=(f=hE(e))!=null?f:{},[o=[]]=Fa(e),i=ft(n,h=>{var p;return(p=h==null?void 0:h.data.schema)!=null?p:{}}),[l,c]=y.useState(a==="property"),d=[];Object.keys(i).forEach(h=>{const p=i[h];(p==null?void 0:p.type)===m.CollectionSchemaType.SELECT&&d.push({type:H.OPERATION,data:{title:p.name,property:h,order:o.findIndex(g=>g.property===h),icon:"IcTitleSelect",hasArrow:h===s,arrow:r.jsx(V,{size:"normal",name:"IcCheck02"})}})}),d.sort((h,p)=>h.data.order-p.data.order);const u=[];return Gz.forEach(h=>{u.push({type:H.OPERATION,data:{title:h.name,type:h.type,hasArrow:h.type===a,arrow:r.jsx(V,{size:"normal",name:"IcCheck02"})}})}),l&&u.push({type:H.LINE},{type:H.OPERATION,data:{title:"单选",hasArrow:!0,type:"property",renderSubMenu:()=>r.jsx(ze,{className:"next-modal-scroll py-1.5 w-[160px]",items:d,onItemClick:h=>{const{property:p}=h.data;p!==s&&Rt(e,{[t===m.CollectionViewType.TIMELINE?"timelineColorSetting":"calendarColorSetting"]:{type:m.CardColorSource.PROPERTY,propertyId:p}})}})}}),r.jsx("div",{className:"next-modal-scroll w-[160px] py-[5px]",children:r.jsx(ze,{items:u,onItemClick:async h=>{var g;const{type:p}=h.data;a!==p&&(Rt(e,{[t===m.CollectionViewType.TIMELINE?"timelineColorSetting":"calendarColorSetting"]:{type:p,propertyId:p==="property"?(g=d[0])==null?void 0:g.data.property:s}}),c(p==="property"))}})})},Wz=({onChange:e,viewId:t})=>{const{viewType:n,collectionId:s,viewParentId:a}=Ne(),o=vs(t),i=V$(),l=s!==a,c=[];return jF.forEach(d=>{l&&d.type===m.CollectionViewType.FORM||c.push({type:H.OPERATION,data:{title:d.name,type:d.type,icon:r.jsx(V,{name:Ga[d.type],size:"middle"}),hasArrow:d.type===n,arrow:r.jsx(V,{size:"normal",name:"IcCheck02"})}})}),r.jsx(ze,{className:"next-modal-scroll w-[160px] py-[5px]",items:c,onItemClick:d=>{var f;const{type:u}=d.data;n!==u&&i(t,(f=o==null?void 0:o.title)!=null?f:"",u),e()}})},Kz=[{icon:"IcBlockRightSidebarOpen",title:"右侧边栏打开",openWay:"openInRight"},{icon:"IcBlockFullPageOpen",title:"整页打开",openWay:"openFullscreen"}],wve=({closeSelf:e})=>{const{viewId:t}=Ne(),n=li(t),s=Kz.map(a=>({type:H.OPERATION,data:{icon:a.icon,title:a.title,selected:a.openWay===n,openWay:a.openWay}}));return r.jsx("div",{className:"w-[220px] py-2 next-modal",children:r.jsx(ze,{className:"overflow-auto max-h-120",items:s,onItemClick:a=>{Rt(t,{openPageWay:a.data.openWay}),e()}})})},Eve=({onCloseModal:e,viewTitleRef:t})=>{var ee,te,Q,ne,se,ce,ae,de,ke,Te;const{changeView:n,embed:s,viewType:a,viewId:o,collectionId:i,isLocked:l,managerReadonly:c,viewParentId:d,tableCellWrap:u}=Ne(),f=Cg(o),h=w8(o),p=Ce(({collectionViews:he})=>{var Ee,ge;return(ge=(Ee=he[o])==null?void 0:Ee.format.showTitle)!=null?ge:!0},[o]),g=Hz(),_=zz(),x=qz(),F=ie(),b=hE(o),w=vs(o),[E,C]=y.useState((ee=w==null?void 0:w.title)!=null?ee:""),{views:k=[]}=(te=cr(d))!=null?te:{},T=zN(o),v=li(o),I=f4(),j=cf(),[S=[]]=Fa(o,{includeIdNumber:!0}),D=S.find(he=>he.type===m.CollectionSchemaType.ID_NUMBER),[A,P]=y.useState(!!D);y.useEffect(()=>{var he;C((he=w==null?void 0:w.title)!=null?he:""),t&&(t.current=w==null?void 0:w.title)},[w==null?void 0:w.title,t]);const{startBy:L,endBy:O}=Ce(({collectionViews:he})=>{var Ge;const Ee=he[o],{timelineBy:ge,timelineByEnd:Se,calendarBy:Re,calendarByEnd:Ae}=(Ge=Ee==null?void 0:Ee.format)!=null?Ge:{},Me=(Ee==null?void 0:Ee.type)===m.CollectionViewType.TIMELINE;return{startBy:Me?ge:Re,endBy:Me?Se:Ae}},[o]),$=ye(i,["data"],["schema"]),M=a===m.CollectionViewType.BOARD||a===m.CollectionViewType.GALLERY,U=he=>{l||F.dropdown({popcorn:he.currentTarget,placement:"bottom-end",content:({onCloseModal:Ee})=>r.jsx(Wz,{onChange:Ee,viewId:o})})},z=(he,Ee)=>{l||F.dropdown({popcorn:he.currentTarget,placement:"bottom-end",content:({onCloseModal:ge})=>r.jsx(yve,{isStartTime:Ee,onCloseModal:ge})})},K=he=>{l||F.dropdown({popcorn:he.currentTarget,placement:"bottom-end",content:()=>r.jsx(Fve,{})})},W=he=>{l||F.dropdown({popcorn:he.currentTarget,placement:"bottom",content({onCloseModal:Ee}){return r.jsx(bve,{closeSelf:Ee})}})},Y=he=>{l||F.dropdown({popcorn:he.currentTarget,placement:"bottom",content({onCloseModal:Ee}){return r.jsx(wve,{closeSelf:Ee})}})},G=Kz.find(he=>he.openWay===v);return w?r.jsxs("div",{className:"pb-[5px] px-2",children:[r.jsx(Ct,{autoFocus:!0,readonly:l,placeholder:"请输入名称",className:"h-8 flex-1 my-2.5",value:E,onEnter:e,onChange:he=>{C(he),t&&(t.current=he)}}),r.jsxs("div",{className:"w-full py-2.5 text-t2 text-grey3 mb-1 px-2 flex justify-between animate-hover cursor-pointer",onClick:U,children:[r.jsx("p",{className:"text-black",children:"视图类型"}),r.jsxs("button",{className:"text-t2 text-grey3 flex items-center",children:[wl[w.type],r.jsx(V,{name:"IcArrowDown01",className:"ml-2",size:"xxxsmall"})]})]}),s&&r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"显示多维表名称"}),r.jsx(en,{open:p,onSwitch:he=>{Rt(o,{showTitle:he})},disabled:l})]}),a&&[m.CollectionViewType.TABLE,m.CollectionViewType.BOARD,m.CollectionViewType.GALLERY].includes(a)&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"自适应行高"}),r.jsx(en,{open:!!u,onSwitch:he=>{Rt(o,{tableWrap:he})},disabled:l})]})}),a===m.CollectionViewType.TABLE&&r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"显示序号"}),r.jsx(en,{open:A,onSwitch:he=>{P(he),he?j({collectionId:i,viewId:o,position:{first:!0},visible:!0,width:$I,propertyName:"No.",propertyType:m.CollectionSchemaType.ID_NUMBER}):D&&I(i,D.property)},disabled:l})]}),(a===m.CollectionViewType.TABLE||a===m.CollectionViewType.BOARD||a===m.CollectionViewType.GALLERY||a===m.CollectionViewType.LIST)&&r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"每页大小"}),r.jsxs("button",{className:"text-t2 text-grey3 flex items-center",onClick:W,children:[T===Tp?"不限":"".concat(T,"条"),r.jsx(V,{name:"IcArrowDown01",className:"ml-2",size:"xxxsmall"})]})]}),a!==m.CollectionViewType.FORM&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"打开记录方式"}),r.jsxs("button",{className:"text-t2 text-grey3 flex items-center",onClick:Y,children:[r.jsx(V,{name:(Q=G==null?void 0:G.icon)!=null?Q:"IcBlockRightSidebarOpen",size:"middle",className:"mr-1"}),G==null?void 0:G.title,r.jsx(V,{name:"IcArrowDown01",className:"ml-2",size:"xxxsmall"})]})]}),r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"显示页面图标"}),r.jsx(en,{open:f,onSwitch:he=>{Rt(o,{showPageIcon:he})},disabled:l})]})]}),a===m.CollectionViewType.CALENDAR&&r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"显示农历"}),r.jsx(en,{open:h,onSwitch:he=>{Rt(o,{showLunarCalendar:he})},disabled:l})]}),M&&r.jsxs(r.Fragment,{children:[r.jsx(Cr,{className:"my-1 mx-2"}),r.jsx(_ve,{})]}),(a===m.CollectionViewType.CALENDAR||a===m.CollectionViewType.TIMELINE)&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",onClick:K,children:[r.jsx("span",{className:"text-t2",children:"颜色显示"}),r.jsxs("button",{className:"text-t2 text-grey3 flex items-center",children:[(se=(ne=Gz.find(he=>he.type===(b==null?void 0:b.type)))==null?void 0:ne.name)!=null?se:"不显示",r.jsx(V,{name:"IcArrowDown01",className:"ml-2",size:"xxxsmall"})]})]}),r.jsx(Cr,{className:"my-1 mx-2"}),r.jsxs("div",{className:"w-full py-2.5 text-t2 text-grey3 mb-1 px-2 flex justify-between animate-hover cursor-pointer",onClick:he=>z(he,!0),children:[r.jsx("p",{className:"text-black",children:"开始日期"}),r.jsxs("button",{className:"text-t2 text-grey3 flex items-center",disabled:l,children:[(ae=(ce=$==null?void 0:$.data.schema)==null?void 0:ce[L!=null?L:""])==null?void 0:ae.name,r.jsx(V,{name:"IcArrowDown01",className:"ml-2",size:"xxxsmall"})]})]}),r.jsxs("div",{className:"w-full py-2.5 text-t2 text-grey3 mb-1 px-2 flex justify-between animate-hover cursor-pointer",onClick:he=>z(he,!1),children:[r.jsx("p",{className:"text-black",children:"结束日期"}),r.jsxs("button",{className:"text-t2 text-grey3 flex items-center",disabled:l,children:[(ke=(de=$==null?void 0:$.data.schema)==null?void 0:de[O!=null?O:""])==null?void 0:ke.name,r.jsx(V,{name:"IcArrowDown01",className:"ml-2",size:"xxxsmall"})]})]})]}),a===m.CollectionViewType.FORM&&r.jsxs(r.Fragment,{children:[r.jsx(Cr,{className:"my-1 mx-2"}),r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"显示收集表说明"}),r.jsx(en,{open:!!(w!=null&&w.format.formShowDescription),onSwitch:he=>{Rt(o,{formShowDescription:he})},disabled:l})]}),r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"显示序号"}),r.jsx(en,{open:!!((Te=w==null?void 0:w.format.formSerialNumber)==null||Te),onSwitch:he=>{Rt(o,{formSerialNumber:he})},disabled:l})]}),r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2 animate-hover animate-click",onClick:()=>g({viewId:o,collectionId:i}),children:[r.jsx("span",{className:"text-t2",children:"结束页设计"}),r.jsxs("span",{className:"text-t2 text-grey3 flex items-center",children:[w.format.formEndPage?"已设置":"未设置",r.jsx(V,{className:"ml-2",size:"xxxsmall",name:"IcArrowUnfold"})]})]})]}),!l&&!c&&r.jsxs(r.Fragment,{children:[r.jsx(Cr,{className:"my-1 mx-2"}),a!==m.CollectionViewType.FORM&&r.jsxs("button",{className:"h-10 px-2 flex w-full items-center animate-hover rounded",onClick:()=>{Xt("".concat(_n(),"/").concat(i,"#").concat(o))},children:[r.jsx(V,{className:"mr-1",size:"middle",name:"IcLink"}),r.jsx("span",{className:"text-t2",children:"复制引用视图链接"})]}),r.jsxs("button",{className:"h-10 px-2 flex w-full items-center animate-hover rounded",onClick:()=>{me.event("bitable_view_create",{from_scene:s?"inline":"inthepage",view_type:a});const he=_(o);he&&n(he)},children:[r.jsx(V,{className:"mr-1",size:"middle",name:"IcDuplicate"}),r.jsx("span",{className:"text-t2",children:"拷贝视图"})]}),k.length>1&&r.jsxs("button",{className:"h-10 px-2 flex w-full items-center animate-hover rounded",onClick:()=>{F.warning({title:r.jsx(r.Fragment,{children:"是否确认删除该视图？"}),confirm:()=>{x(o)}})},children:[r.jsx(V,{className:"mr-1",size:"middle",name:"IcTrash"}),r.jsx("span",{className:"text-t2",children:"删除视图"})]})]})]}):null},Cve=()=>{var o;const{collectionId:e}=Ne(),t=ft(e,i=>{var l;return(l=i==null?void 0:i.data.format)==null?void 0:l.openSubItem}),n=ie(),{propertySchema:s}=eo(e,(o=t==null?void 0:t.parentPropertyId)!=null?o:"");if(!s)return null;const a=i=>{var f;const l=(f=J.blocks[e])==null?void 0:f.data.schema;if(!l)return;const c=new Set,d=[],u=(h,p)=>({type:H.OPERATION,data:{icon:un[h.type],title:h.name,selected:(t==null?void 0:t.parentPropertyId)===p,onClick:()=>{p!==(t==null?void 0:t.parentPropertyId)&&hn(()=>{_e(e,{data:{format:{openSubItem:{parentPropertyId:p}}}})})}}});Object.entries(l).filter(([h,p])=>p.type===m.CollectionSchemaType.RELATION&&p.collectionId===e).forEach(([h,p])=>{c.has(h)||d.push(u(p,h))}),n.dropdown({placement:"right",offset:[0,-40],popcorn:i.currentTarget,content:({onCloseModal:h})=>r.jsx(ze,{className:"py-1 next-modal w-[160px]",items:d,onItemClick:()=>h()})})};return r.jsxs("div",{className:"next-modal px-4 py-2 w-[360px]",children:[r.jsx("div",{className:"my-2 text-t2 text-grey2",children:"选择表示父项的关系属性。我们将“父记录”作为默认值。"}),r.jsx("div",{className:"h-px w-full bg-grey7"}),r.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{className:"mr-1",size:"middle",name:un[s.type]}),r.jsx("div",{className:"text-t2 ",children:"属性"})]}),r.jsxs("div",{className:"animate-hover flex items-center px-2 h-8",onClick:a,children:[r.jsx("div",{className:"text-t2 text-grey3",children:s.name}),r.jsx(V,{name:"IcArrowDown01",className:"ml-2",size:"xxxsmall"})]})]})]})},kve=e=>{const{collectionId:t}=Ne();return zm(t)?r.jsx(Tve,{}):r.jsx(vve,{...e})},lP={Nested:"逐层嵌套",Card:"卡片属性",ParentOnly:"仅父记录",Flattenlist:"扁平列表"},Tve=()=>{const{viewId:e,collectionId:t}=Ne(),n=Il(e),s=ie(),a=aE(t),o=f4(),i=d=>{var h;const u=(h=J.collectionViews[e])==null?void 0:h.type,f=Object.entries(lP).filter(([p])=>!(p==="Nested"&&!Jb(u)||p==="Card"&&Jb(u))).map(([p,g])=>({type:H.OPERATION,data:{title:g,selected:p===n,onClick:()=>{Rt(e,{subItemstyle:p})}}}));s.dropdown({popcorn:d.currentTarget,content:({onCloseModal:p})=>r.jsx(ze,{className:"next-modal w-[200px] py-1",items:f,onItemClick:()=>p()})})},l=d=>{s.dropdown({offset:[0,-40],popcorn:d.currentTarget,content:()=>r.jsx(Cve,{})})},c=()=>{if(a&&a.parentPropertyId){const{propertySchema:d}=ii(t,a.parentPropertyId);s.warning({title:"是否确认关闭子记录？",content:"关闭子记录功能后会同时删除表中的 ".concat(d==null?void 0:d.name," 属性"),confirmText:"关闭子记录并删除属性",confirm:()=>{a.childPropertyId&&o(t,a.childPropertyId),a.parentPropertyId&&o(t,a.parentPropertyId)}})}};return r.jsxs("div",{className:"text-t2",children:[r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-4",children:[r.jsx("span",{className:"",children:"子记录样式"}),r.jsxs("button",{className:"flex items-center",onClick:i,children:[lP[n],r.jsx(V,{name:"IcArrowDown01",className:"ml-2",size:"xxxsmall"})]})]}),r.jsx("div",{className:"animate-hover flex h-10 w-full items-center justify-between px-4",onClick:l,children:r.jsx("span",{children:"子记录属性"})}),r.jsxs("div",{className:"border-t px-4 w-full h-12 animate-hover flex items-center rounded-none",onClick:c,children:[r.jsx(V,{name:"IcTrash",size:"middle"}),r.jsx("div",{className:"ml-1",children:"关闭子记录"})]})]})},vve=e=>{const{viewId:t,collectionId:n}=Ne(),s=cf(),a=()=>{var l;const o=qe();s({newPropertyId:o,collectionId:n,viewId:t,propertyType:m.CollectionSchemaType.RELATION,visible:!1,propertyName:"父记录",partialSchema:{collectionId:n,pairProperty:o}})&&(o?hn(()=>{_e(n,{data:{format:{openSubItem:{parentPropertyId:o}}}})}):console.warn("something wrong"),(l=e.onCloseModal)==null||l.call(e))};return r.jsxs("div",{className:"px-4 space-y-4 pb-4",children:[r.jsx("div",{className:"text-t2 text-grey2 flex items-center h-10",children:"使用子记录功能可以对记录进行分解，大事化小"}),r.jsx("img",{className:"w-[360px]",src:vn.subitemFeature}),r.jsx(De,{className:"w-full",colorType:"active",onClick:a,children:"开启子记录功能"})]})};var tS=(e=>(e.VIEW="view",e.PROPERTY="property",e.FILTER="filter",e.SORT="sort",e.GROUP="group",e.SUB_GROUP="sub_group",e.FORM_LOGIC="form_logic",e.SUBITEM="subitem",e))(tS||{});const ak=[{name:"视图",type:"view",Component:Eve},{name:"属性",type:"property",Component:eS},{name:"筛选",type:"filter",Component:Ug},{name:"排序",type:"sort",Component:Vg},{name:"分组",type:"group",Component:qu},{name:"子记录",type:"subitem",Component:kve}],nS=e=>{var i,l;const{viewType:t}=Ne(),[n,s]=y.useState((i=e.defaultItemType)!=null?i:"view");let a=[...ak];t===m.CollectionViewType.FORM?(a=ak.filter(c=>c.type==="view"||c.type==="property"),a.push({name:"跳题逻辑",type:"form_logic",Component:dve})):t===m.CollectionViewType.BOARD?a.push({name:"子分组",type:"sub_group",Component:qu}):t===m.CollectionViewType.CALENDAR&&(a=ak.filter(c=>c.type!=="group"));const o=(l=a.find(c=>c.type===n))==null?void 0:l.Component;return o?r.jsxs("div",{className:"next-modal-scroll pt-[5px] min-w-[400px]",children:[r.jsx("div",{className:"border-b border-grey6 py-1.5 px-2 flex",children:a.map(c=>r.jsx("button",{onClick:()=>s(c.type),className:R("mr-2 rounded-sm py-1.5 px-2 animate-hover-black3 text-t2",c.type===n&&"bg-black_006"),children:c.name},c.name))}),r.jsx(o,{...e,isSubGroup:n==="sub_group",isFromViewSetting:!0})]}):null},Ive=()=>mc(e=>Object.values(e).every(t=>!t.permissions)),Yz=({icon:e,description:t,children:n})=>{const s=Ive();return r.jsxs("div",{className:"flex flex-col h-[480px]",children:[r.jsxs("div",{className:"flex flex-col items-center justify-center flex-1",children:[r.jsx(na,{emojiStr:e,disableHover:!0,iconSize:70}),r.jsx("div",{className:"text-t1-medium mt-2.5",children:t}),n]}),r.jsxs("a",{hidden:!1,href:s?"".concat(_n()).concat(Nt.create):location.origin,onClick:()=>ts(wZ,"true"),className:"inline-flex items-center justify-center border-b border-black mx-auto flex-shrink-0 mb-10 cursor-pointer",rel:"noreferrer",children:[r.jsx(na,{emojiStr:"👉",disableHover:!0,iconSize:14})," 使用 ",Na," 免费创建收集表 ",r.jsx(na,{emojiStr:"👈",disableHover:!0,iconSize:14})]})]})},Nve=e=>{const t=Ja(),{formOnlyOneSubmit:n,resubmit:s,viewId:a}=e,o=vs(a),[i,l]=y.useState("padding"),[c,d]=y.useState(!1),u=y.useMemo(()=>{var F,b;let g=o==null?void 0:o.format.formEndPage;if(g!=null&&g.includes(gp)&&(g=(F=g.split(gp))==null?void 0:F[0]),g!=null&&g.includes(" ")&&(g=(b=g.split(" "))==null?void 0:b[0]),!g)return"";const _=Xp(g);return mw((_==null?void 0:_.pathname)||"")},[o==null?void 0:o.format.formEndPage]),f=()=>{d(!0)},h=async()=>{if(!u){l("hidden");return}await t(u,{callback:g=>{g.code===200&&mn(u).shared?l("show"):l("hidden")}}).catch(()=>{l("hidden")})},p=()=>{F0(o==null?void 0:o.format.formEndPage)};return y.useEffect(()=>{h()},[]),c?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex justify-end absolute -top-10 z-[100] w-full",children:[n?r.jsx("div",{}):r.jsx(De,{className:"text-t2",colorType:"base_white",onClick:s,children:"返回再次填写"}),r.jsx(De,{className:"text-t2 ml-4",colorType:"base_white",onClick:p,children:"查看原页面"})]}),r.jsx("div",{className:"flex max-h-[60vh] min-h-[58vh]",children:r.jsx($z,{uuid:u})})]}):r.jsxs(Yz,{icon:"😀",description:"你已提交成功",children:[i==="hidden"&&!n&&r.jsx(De,{className:"mt-10 w-44",colorType:"active",size:"middle",onClick:()=>s==null?void 0:s(),children:"再填写一次"}),i==="show"&&r.jsxs("div",{className:"text-t1 text-grey3 mt-3 select-none",children:["即将自动跳转至信息展示页 ",r.jsx(u3,{time:3,onFinish:f}),r.jsx("span",{className:"ml-2 animate-click text-active_color",onClick:f,children:"立即跳转"})]})]})};let Xz;const jve=e=>{Xz=e},Qz=({shareId:e})=>{const t=WE(),{collectionId:n,viewId:s}=Ne(),[a,o]=y.useState(null),i=vs(s),{formIllegal:l,formOnlyOneSubmit:c}=(i==null?void 0:i.format)||{},d=$j(s,{blockType:"form"}),u=ye(n,["data"],["cover","coverPos"]),f=Mi({ignoreSorters:!0}),h=!e,p=uf(n),g=r.jsx(Nve,{viewId:s,formOnlyOneSubmit:c,resubmit:()=>{o(null)}}),_=x=>{if(e){if(!i)return be.success("提交失败，请刷新后重试");const{title:F,...b}=x;ve.editor.formViewPostBlock.raw(e,{id:qe(),spaceId:i.spaceId,segments:F,collectionProperties:b}).then(w=>{w.code===200?(o(g),yt.uuid&&t(Je.LIMITED_TIME_COLLECTION_TABLE,{createdBy:i.createdBy})):o(r.jsx(Yz,{icon:"😑",description:w.msg}))}),me.event("submit_form")}else f({viewId:s,where:{},propertyValues:x}),o(g)};return u?r.jsx(Vz,{className:"p-0",containerClassName:"relative min-h-[100%]",header:r.jsx(Yg,{shareId:e,uuid:u.uuid,ossName:u.data.cover||"cover/flowus2",hiddenEditorButton:!0,height:320}),report:!p&&!l?d:void 0,hiddenFooter:h,children:a||r.jsx(Xz,{shareOrPreview:!0,className:"px-20",onSubmit:_})}):null},Jz=()=>{const e=ie();return y.useCallback(t=>{const{viewId:n,collectionId:s}=t,a={viewId:n,collectionId:s,viewParentId:s,readonly:!0,managerReadonly:!0,changeView:()=>{},isColumnListChildren:!1,isFoldListChildren:!1,viewType:m.CollectionViewType.FORM};e.modal({modalId:Ve.PREVIEW_FORM,className:"form-scroll-container w-[90vw] h-[90vh] pb-10 overflow-y-auto",content:()=>r.jsx(rd.Provider,{value:a,children:r.jsx(Oo,{children:r.jsx(Vo.Provider,{value:uc.FORM_PREVIEW,children:r.jsx(Qz,{})})})})})},[e])},Sve=()=>{const e=ie();return y.useCallback(t=>{const{viewId:n,collectionId:s}=t,a={viewId:n,collectionId:s,viewParentId:s,readonly:!0,managerReadonly:!0,changeView:()=>{},isColumnListChildren:!1,isFoldListChildren:!1,viewType:m.CollectionViewType.FORM};e.modal({modalId:Ve.PREVIEW_FORM,className:"form-scroll-container w-[90vw] h-[90vh] pb-10 overflow-y-auto",content:()=>r.jsx(rd.Provider,{value:a,children:r.jsx(Oo,{children:r.jsx(Vo.Provider,{value:uc.FORM_PREVIEW,children:r.jsx(Qz,{})})})})})},[e])},Dve=e=>{var u;const{width:t=370,tabs:n,main:s}=e,a=-t,[o,i]=y.useState(0),[l,c]=y.useState(((u=n[0])==null?void 0:u.id)||""),d=f=>{c(f),i(a)};return r.jsx("div",{className:"sm:mx-3 sm:w-[calc(100vw-24px)] next-modal overflow-hidden",style:{width:t},children:r.jsxs("div",{className:"flex transition-transform ease-in-out",style:{transform:"translateX(".concat(o,"px)")},children:[r.jsx(cP,{width:t,active:o===0,children:s(d)}),r.jsx(cP,{width:t,active:o===a,children:n.map(f=>f.id!==l?null:r.jsx(y.Fragment,{children:f.content(()=>i(0))},f.id))})]})})},cP=({active:e,children:t,width:n})=>r.jsx("div",{className:"flex-shrink-0",style:{width:n},children:e&&t}),sS=()=>{const e=ie();return y.useCallback(t=>{const{popcorn:n,viewId:s,placement:a,collectionId:o}=t,i=[{id:"FormUserList",content:l=>r.jsx(EU,{uuid:s,backToMainPanel:l})},{id:"SelectUsers",content:l=>r.jsx(N8,{searchType:"form",uuid:s,backToMainPanel:l})}];e.dropdown({popcorn:n,placement:a,content:({onCloseModal:l})=>r.jsx(Dve,{main:c=>r.jsx(Ave,{onChangeTab:c,viewId:s,onCloseModal:l,collectionId:o}),tabs:i})})},[e])},Ave=({viewId:e,onChangeTab:t,collectionId:n})=>{const a=$0(e),o=Tl(a),i={[m.FormPermission.LOGIN]:"任何获得此链接的人，登录后可填写",[m.FormPermission.NO_LOGIN]:"任何获得此链接的人，无需登录即可填写",[m.FormPermission.WORKSPACE]:"仅当前空间成员可填写",[m.FormPermission.INVITE]:"仅邀请的人可填写"},l=ie(),c=vs(e),d=Pi(c==null?void 0:c.createdBy),{formPermission:u=m.FormPermission.LOGIN,formInviteUserPermissions:f=[]}=(c==null?void 0:c.format)||{},h=!!(c!=null&&c.format.formShared),p=u===m.FormPermission.INVITE,g=u===m.FormPermission.NO_LOGIN,_="".concat(_n()).concat(Nt.form).concat(c==null?void 0:c.shareId).concat(d!=null&&d.inviteCode?"?".concat(dn.inviteCode,"=").concat(d.inviteCode):"");y.useEffect(()=>{O0(Pn().uuid)},[]);const x=async(E=!h)=>{var k,T;if(o)return;if(me.event("form_share_switch",{is_open:E}),E&&!(c!=null&&c.shareId)){const I=(await ve.editor.getCollectionView(e)).shareId||qe();ic(e,{shareId:I})}const C=(k=pe().collectionViews)==null?void 0:k[e];C&&Rt(e,{formShared:E,formPermission:(T=C.format.formPermission)!=null?T:m.FormPermission.LOGIN,formOnlyOneSubmit:C.format.formPermission===m.FormPermission.NO_LOGIN?!1:C.format.formOnlyOneSubmit})},F=(E=!(c!=null&&c.format.formOnlyOneSubmit))=>{o||Rt(e,{formOnlyOneSubmit:E})},b=E=>{o||l.dropdown({popcorn:E.currentTarget,content:C=>r.jsx(ze,{className:"next-modal py-2.5 w-80",onItemClick:()=>C.onCloseModal(),items:Object.keys(i).map(k=>({type:H.OPERATION,data:{title:i[k],selected:u===Number(k),onClick:()=>{var I;const T={[m.FormPermission.LOGIN]:"Anyone_login",[m.FormPermission.NO_LOGIN]:"Anyone",[m.FormPermission.WORKSPACE]:"Space_member",[m.FormPermission.INVITE]:"people_invite"};me.event("form_authority",{authority_is:T[k]});const v=(I=pe().collectionViews)==null?void 0:I[e];v&&Rt(e,{formPermission:Number(k),formOnlyOneSubmit:v.format.formPermission===m.FormPermission.NO_LOGIN?!1:v.format.formOnlyOneSubmit})}}}))})})},w=()=>{var E;Xt("".concat(_,"\n").concat(gp).concat((E=c==null?void 0:c.title)!=null?E:VB),{message:"已复制链接"})};return r.jsxs("div",{className:R("pt-2.5",!h&&"pb-2.5"),children:[r.jsxs("div",{className:"animate-hover rounded-none cursor-pointer py-2.5 px-4 flex items-center justify-between",onClick:()=>x(),children:[r.jsxs("div",{children:[r.jsx(ul,{popup:"了解收集表分享",className:"text-t2 mb-px",link:_i.shareFormLink,children:"分享表单"}),r.jsx("div",{className:"text-t4 text-grey3",children:"开启后可进行分享设置"})]}),r.jsx(en,{open:h,onSwitch:x,disabled:o})]}),h&&r.jsxs(r.Fragment,{children:[r.jsx(Cr,{className:"mx-4 my-1"}),r.jsxs("div",{className:R("animate-hover rounded-none cursor-pointer py-2.5 px-4 flex items-center justify-between",g&&"pointer-events-none opacity-30"),onClick:()=>F(),children:[r.jsx("div",{className:"text-t2 mb-px",children:"允许填写人提交多次"}),r.jsx(en,{open:!c.format.formOnlyOneSubmit,onSwitch:()=>F(),disabled:o})]}),r.jsx(Cr,{className:"mx-4 my-1"}),r.jsx("div",{className:R("animate-hover rounded-none cursor-pointer py-2.5 px-4 flex items-center justify-between mb-1",o&&"cursor-not-allowed"),onClick:E=>b(E),children:r.jsxs("div",{className:"text-t2 mb-px flex items-center justify-between w-full",children:[r.jsxs("span",{className:"flex items-center",children:[r.jsx(V,{name:"IcLink",className:"mr-2",size:"middle"}),i[u]]}),r.jsx(V,{name:"IcArrowDown01",className:"text-grey3 ml-2",size:"xxxsmall"})]})}),p&&r.jsxs(r.Fragment,{children:[r.jsx(Cr,{className:"mx-4 my-1"}),r.jsx(FU,{className:"px-4 py-2.5",uuid:n,onClick:()=>t("SelectUsers")}),f.length>0&&r.jsx("div",{className:"px-4 py-2.5",children:r.jsx(EU,{uuid:e,num:5,onlyUserList:!0})}),5<f.length&&r.jsxs("div",{onClick:()=>t("FormUserList"),className:"flex items-center animate-click animate-hover rounded-none px-4 py-2.5",children:[r.jsx(V,{size:"middle",className:"text-grey4",name:"IcShareAnyone"}),r.jsxs("div",{className:"text-t3 text-grey4 pl-4",children:["查看所有填写者（",f.length," 个）"]})]})]}),r.jsx(gU,{uuid:e,url:_,onCopyLink:w})]})]})},Rve=()=>{var p;const{viewId:e,collectionId:t,viewParentId:n,changeView:s}=Ne(),a=ie(),o=vs(e),i=sS(),l=yx(),c=Sve(),d=Hz(),u=y.useRef((p=o==null?void 0:o.title)!=null?p:"");y.useEffect(()=>{var g;u.current=(g=o==null?void 0:o.title)!=null?g:""},[o==null?void 0:o.title]);const f=y.useRef(e);f.current=e;const h=g=>{a.dropdown({popcorn:g.currentTarget,placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],closeBeforeCallBack(){var F;const _=u.current,x=(F=pe().collectionViews)==null?void 0:F[f.current];_!==(x==null?void 0:x.title)&&ic(f.current,{title:_})},content:({onCloseModal:_})=>r.jsx(nS,{viewTitleRef:u,onCloseModal:_,defaultItemType:tS.FORM_LOGIC})})};return r.jsxs("div",{className:"py-2 next-modal w-28 ml-3 h-min px-1 space-y-1",children:[r.jsx(h_,{icon:"IcSkipQuestion",text:"逻辑",onClick:g=>{h(g)}}),r.jsx(h_,{icon:"IcEndPage",text:"结束页",onClick:()=>{d({viewId:e,collectionId:t})}}),r.jsx(h_,{icon:"IcShow",text:"预览",onClick:()=>{c({viewId:e,collectionId:t})}}),r.jsx(h_,{icon:"IcFormShare",text:"分享",onClick:g=>{i({popcorn:g.currentTarget,viewId:e,collectionId:t,placement:"bottom"})}}),r.jsx(h_,{icon:"IcTable",text:"数据",onClick:()=>{var _,x;const g=(x=(_=J.blocks[t])==null?void 0:_.views)==null?void 0:x.find(F=>{var b;return((b=J.collectionViews[F])==null?void 0:b.type)===m.CollectionViewType.TABLE});if(g)s(g);else{const F=l(n,"表格",m.CollectionViewType.TABLE);F?s(F):be.error("切换失败")}}})]})},h_=e=>r.jsxs("div",{className:"flex flex-col items-center py-2 px-1 animate-hover space-y-1 text-t2",onClick:e.onClick,children:[r.jsx(V,{name:e.icon,size:"middle"}),r.jsx("span",{children:e.text})]}),Zz=({onSubmit:e,shareOrPreview:t=!1,className:n})=>{var Y;const s=ie(),{viewId:a,collectionId:o,readonly:i,isLocked:l}=Ne(),c=hw(),[d,u]=y.useState(null),f=vs(a),h=f==null?void 0:f.format.formIllegal,p=!!(i||h||c||l),g=ft(o,G=>{var ee;return(ee=G==null?void 0:G.data.schema)!=null?ee:{}}),[_=[]]=Fa(a,{visible:!0}),[x,F]=y.useState({}),[b,w]=y.useState({}),{fontStyle:E}=T2(o),C=(Y=f==null?void 0:f.format.formLogic)!=null?Y:[],k=t,T=y.useMemo(()=>(f==null?void 0:f.format.formPermission)&&[m.FormPermission.WORKSPACE].includes(f.format.formPermission),[f==null?void 0:f.format.formPermission]),v=(G,ee,te)=>{w(Q=>({...Q,[G]:[...Q[G]||[],{id:ee,url:te}]}))},I=_.filter(G=>!(!T&&p&&G.type===m.CollectionSchemaType.PERSON||qI.includes(G.type))),j=SF(g,I.map(G=>G.property),C),[S,D]=y.useState(null),[A,P]=y.useState(0),O=(G=>{if(!k||j.length<=0)return _;const ee=G===null?0:_.findIndex(ne=>ne.property===G),Q=(ne=>{for(let se=ne;se<_.length;se++)if(j.some(ce=>ce.condition.property===_[se].property))return se;return-1})(ee);return Q!==-1?_.slice(ee,Q+1):_.slice(ee)})(S),$=I.filter(G=>O.some(ee=>ee.property===G.property)).map(G=>{var ee;return{id:G.property,data:G,submitData:x[G.property],formProperty:(ee=f==null?void 0:f.format.formProperties)==null?void 0:ee.find(te=>te.property===G.property)}}),M=async G=>{var ne;const ee=G.map(se=>se.data),te=D1(o,a,ee.map(se=>se.property),C);if(te!=null&&!await new Promise(ce=>{s.warning({title:r.jsx(r.Fragment,{children:"确认调整题目顺序吗？"}),content:r.jsx(r.Fragment,{children:"会导致部分跳题逻辑失效，将自动删除失效逻辑。"}),confirm(){ce(!0)},cancel(){ce(!1)}})}))return;const Q=J.collectionViews[a];Q&&Rt(a,{["".concat(Q.type,"Properties")]:dg([...ee,...(ne=Q.format.formProperties)!=null?ne:[]],"property"),...te?{formLogic:te}:{}})},U=(G,ee,te)=>{const{concatSegment:Q=!1}=te||{};F(Q?ne=>({...ne,[G]:[...ne[G]||[],...ee||[]]}):ne=>({...ne,[G]:ee||[]}))},z=G=>{Rt(a,{formDescription:G})},K=G=>{ic(a,{title:G.replace(/[\r\n]/g,"")})},W=()=>{var ee;if($.every(te=>{var se;const Q=()=>{var ke;const ce=document.querySelector('.form-scroll-container [data-form-property="'.concat((ke=te.formProperty)==null?void 0:ke.property,'"]')),ae=document.querySelector(".form-scroll-container"),{top:de}=fI(ce,ae);ce.classList.add("animate__flash","animate__animated"),setTimeout(()=>{ce.classList.remove("animate__flash","animate__animated")},2e3),ae.scrollTo({top:de-200,behavior:"smooth"})},ne=fe(te.submitData);if((se=te.formProperty)!=null&&se.required){if(te.data.type===m.CollectionSchemaType.CHECKBOX&&!us(ne))return Q(),be.error("请填写必填项"),!1;if(!te.submitData||te.submitData.length===0||!ne)return Q(),be.error("请填写必填项"),!1}return!0}))if(k){const te=(ee=$[$.length-1].formProperty)==null?void 0:ee.property,Q=C.filter(ce=>ce.condition.property===te),se=(ce=>{var de,ke;const ae=I.findIndex(Te=>Te.property===te);if(ae===-1||ae===I.length-1)return tp;for(const Te of ce)if(W8(Te.condition,{collectionId:o,schemas:g})({data:{segments:x.title,collectionProperties:x}}))return Te.gotoProperty;return(ke=(de=I[ae+1])==null?void 0:de.property)!=null?ke:tp})(Q);se===tp?e==null||e(x):(D(se),P(ce=>ce+$.length))}else e==null||e(x)};return f?r.jsxs("div",{"data-disable-select":!0,className:R("line-default flex flex-col justify-between h-full",n),style:E,children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-h1 text-center w-full pt-10 pb-2",children:r.jsx(oi,{readonly:p,placeholder:VB,fontClassName:"text-center",maxLength:1e3,defaultValue:f.title,onChange:G=>K(G.currentTarget.value)})}),f.format.formShowDescription&&(p&&f.format.formDescription||!p)&&r.jsx("div",{className:"py-2 text-center",children:r.jsx(ci,{keydownOption:XU,readonly:p,uuid:a,className:"text-t1",placeholder:p?"":"请输入收集表说明",segments:typeof f.format.formDescription=="string"?ht(f.format.formDescription):f.format.formDescription,onChange:G=>{fe(G).length<=1e3&&z(G)}})}),r.jsx("div",{className:"h-5"}),r.jsx(br,{disabled:p,onDragStart:G=>u(G.active.id.toString()),onDragEnd:()=>u(null),items:$,onChange:M,modifiers:[e3],renderItemContent:({item:G,renderDragHandle:ee})=>r.jsx(Pve,{...G.data,hiddenElement:d===G.id,readonly:p,formProperties:G.formProperty,renderDragHandle:ee,index:A+$.findIndex(te=>te.data.property===G.data.property),handleChangeSubmitData:U,submitData:G.submitData,uploadFileList:b,pushUploadFileList:v})}),!p&&r.jsx("div",{className:"pb-10",children:r.jsx(Ac.CreateFormProperty,{viewId:a,collectionId:o})})]}),p&&!c&&!h?r.jsx(De,{colorType:"active",size:"auto",className:"h-12 w-44 self-end my-10",onClick:W,children:"提交"}):r.jsx("div",{className:"h-20"})]}):null},Pve=e=>{const{readonly:t,handleChangeSubmitData:n,property:s,uploadFileList:a,submitData:o,type:i,name:l,pushUploadFileList:c,renderDragHandle:d,index:u,formProperties:f,hiddenElement:h}=e,{collectionId:p,viewId:g}=Ne(),_=vs(g),{formPermission:x,formSerialNumber:F}=(_==null?void 0:_.format)||{},b=x&&[m.FormPermission.WORKSPACE].includes(x),{propertySchema:w}=eo(p,s),E=hw(),C={readonly:t,schema:w,collectionId:p,submitData:o,key:s,property:s,handleChangeSubmitData:n,spaceId:_==null?void 0:_.spaceId,viewId:g,type:i},k={};let T=r.jsx(Ac.FormatTextarea,{...C});switch(i){case m.CollectionSchemaType.CHECKBOX:T=r.jsx(Ac.CheckBox,{...C});break;case m.CollectionSchemaType.DATE:T=r.jsx(Ac.DateElement,{...C});break;case m.CollectionSchemaType.FILE:T=r.jsx(Ac.File,{...C,uploadFileList:a[s],pushUploadFileList:c});break;case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:k.after=r.jsx("span",{className:"text-grey3 mx-1 w-full",children:i===m.CollectionSchemaType.SELECT?"【单选】":"【多选】"}),T=r.jsx(Ac.Select,{...C,type:i});break;case m.CollectionSchemaType.PERSON:b||(k.after=r.jsx(Fe,{hideOnClick:!1,className:"w-3.5 pt-px",maxWidth:300,onClick:I=>I.stopPropagation(),popup:"非当前空间成员无法填写成员属性",children:r.jsx(V,{name:"IcBadgeDanger",size:"xsmall",className:"ml-0.5 mt-1.5"})})),T=r.jsx(Ac.Person,{...C});break;case m.CollectionSchemaType.NUMBER:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.PHONE:T=r.jsx(Ac.FormatTextarea,{...C,type:i});break}const v=typeof(f==null?void 0:f.description)=="string"?ht(f==null?void 0:f.description):f==null?void 0:f.description;return r.jsx(Ac.Container,{readonly:h||t,titleAfter:k.after,titleBefore:k.before,renderDragHandle:d,collectionId:p,index:u+1,property:s,formSerialNumber:F,title:l,required:f==null?void 0:f.required,showDescription:(f==null?void 0:f.showDescription)&&!h,description:v,viewId:g,children:!h&&(E?r.jsx("div",{className:"pointer-events-none cursor-default",children:T}):T)})},Lve=()=>{const{viewId:e,collectionId:t,readonly:n}=Ne(),s=vs(e),a=FN(e,{blockType:"form"}),o=s==null?void 0:s.format.formIllegal,i=wN(t);return r.jsxs(r.Fragment,{children:[o&&r.jsxs("div",{className:"flex items-center justify-between bg-red text-white h-14 text-t2 px-4",children:[r.jsx("span",{}),r.jsx("span",{children:"当前页面违反平台分享协作条例，已禁止使用"}),i&&r.jsx(De,{colorType:"white",onClick:a,children:"申诉"})]}),r.jsxs("div",{className:"flex mx-auto mt-5 max-w-[1050px]",children:[r.jsx("div",{className:"next-modal px-20 w-full",children:r.jsx(Zz,{})}),!n&&r.jsx(Rve,{})]})]})},Bve=e=>{const t=ff();return r.jsx("div",{"data-disable-select":!0,onClick:()=>{t({blockId:e.blockId})},children:r.jsx(V,{name:"IcComment",size:"small",className:"pointer-events-none"})})},Ove=({hoverNode:e})=>{const t=uh();return r.jsx("div",{id:y0,"data-draggable":!0,"data-disable-select":!0,"data-block-id":e.id,"data-relation-parent-id":e.node.dataset.relationParentId,"data-view-id":e.node.dataset.viewId,"data-group-value":e.node.dataset.groupValue,onClick:n=>{const s=No(e.id);me.event("block_menu",{block_name:s}),t({blockId:e.id,blockNode:e.node,menuPosition:n.currentTarget})},className:"w-5 h-6 flex items-center justify-center animate-hover rounded text-grey4 hover:text-grey1 cursor-grab",children:r.jsx(V,{name:"IcMenu",size:"small",className:"pointer-events-none"})})},Mve=({id:e,className:t})=>{const n=ft(e,s=>{var a;if(s&&[m.BlockType.HEADER,m.BlockType.TOGGLE_HEADER].includes(s.type))return(a=s.data.level)!=null?a:1});return n?r.jsx("div",{className:R("text-grey4 pointer-events-none",t),children:"H".concat(n)}):null},Uve=()=>{const e=rg(),t=bw(),[n,s]=y.useState(),a=Ln(),o=y.useCallback(()=>{xn.emit("hoverId"),s(void 0)},[]);return y.useEffect(()=>(xn.on("removeHoverMenu",o),()=>{xn.off("removeHoverMenu",o)}),[o]),y.useEffect(()=>{const i=bn(".block-content",a),l=bn(".next-space-page",a);if(!i||e||t||!l){o();return}const d=Ps(u=>{var _;if(u.target instanceof HTMLElement&&x3(u.target,F=>F.className.includes("keep-hover-node")))return;const{blockId:f,node:h}=YV(u,i);let p=f,g=h;if(!(h!=null&&h.dataset.hideHoverMenu)){if(h!=null&&h.dataset.dropInChild)g=h.closest("[data-block-id]");else if((h==null?void 0:h.tagName)==="TD")g=(_=h.parentElement)==null?void 0:_.closest("[data-block-id]"),p=g==null?void 0:g.dataset.blockId;else if(h!=null&&h.dataset.mindMapId)return;if(p&&(g!=null&&g.firstElementChild)){if(g.id===y0)return;const x=g.firstElementChild.getBoundingClientRect(),F=getComputedStyle(g.firstElementChild),b=parseInt(F.getPropertyValue("line-height"),10),w=parseInt(F.getPropertyValue("padding-top"),10),E=i.getBoundingClientRect();let C=x.left-E.left,k=x.top-E.top;const T=parseInt(F.getPropertyValue("padding-left"),10);T>90&&(C+=T-2,k+=20),(n==null?void 0:n.id)!==p&&(xn.emit("hoverId",p),s({id:p,node:g,lineHeight:b,paddingTop:w,offsetTop:k,offsetLeft:C}))}else o()}},100);return l.addEventListener("mousemove",d),l.addEventListener("keydown",o),()=>{l.removeEventListener("mousemove",d),l.removeEventListener("keydown",o)}},[n==null?void 0:n.id,n==null?void 0:n.offsetTop,e,a,o,t]),n},$p=({readonly:e=!1})=>{var j,S;const t=FH(),n=Uve(),s=uI(),a=xt.$columnResizing,o=xt.$isSelecting,i=_w(),{collectionViews:l}=J,c=ye(n==null?void 0:n.id,["data","status"],["segments"]),d=ye(c==null?void 0:c.parentId,[]),u=w4(),f=Kwe(c==null?void 0:c.uuid),h=c&&n&&ga(d==null?void 0:d.type),p=Nm(),g=pt(),_=Un()===wt.MAIN,x=D=>{if(c!=null&&c.uuid){const A=J.ui.selectedBlocks;re(at.updateSelectBlocks(Bu([c.uuid]))),u({pos:D}),re(at.updateSelectBlocks(A))}},F=!e&&(h||!f&&(c==null?void 0:c.type)===m.BlockType.TEXTAREA&&!xp(c==null?void 0:c.data.segments).trim());if(!c||!n||!(n!=null&&n.node.clientHeight)||s||a||i||o||(c==null?void 0:c.status)!==m.BlockStatus.NORMAL)return null;const b=c&&d,w=(b==null?void 0:b.type)===m.BlockType.QUOTE,E=n?{top:n.offsetTop+n.lineHeight/2+n.paddingTop,left:n.offsetLeft-2-(w?20:0)}:{};if(h){E.top=n.offsetTop+Si/2;const D=(j=n.node.dataset.viewId)!=null?j:"",A=l[D],{role:P}=mn((S=A==null?void 0:A.parentId)!=null?S:""),{role:L}=mn(c.parentId);if(P===m.PermissionRole.READER||L===m.PermissionRole.READER||(A==null?void 0:A.type)===m.CollectionViewType.CALENDAR||(A==null?void 0:A.type)===m.CollectionViewType.BOARD)return null;(A==null?void 0:A.type)===m.CollectionViewType.LIST&&(E.top=n.offsetTop+Si/2-5)}n&&(c!=null&&c.type)&&([m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION,m.BlockType.MIND_MAPPING_PAGE].includes(c.type)&&(E.top=n.offsetTop+16),[m.BlockType.SYNC_CONTAINER,m.BlockType.TABLE].includes(c.type)&&(E.top=n.offsetTop+32),[m.BlockType.CODE].includes(c.type)&&(E.top=n.offsetTop+19));const C=w0(c),k=Xn(mn(c==null?void 0:c.uuid).role,m.PermissionRole.COMMENTER),I=!g&&!h&&C&&k&&_||g&&!h&&C&&k&&p;if(e&&!I)return null;if(c){const{role:D}=mn(c.uuid);if(D===m.PermissionRole.READER)return null}return r.jsxs("div",{id:gne,className:"group absolute transition-all duration-75 animate-fade-in",style:E,onClick:D=>{D.preventDefault()},children:[F&&r.jsx(Fe,{className:R("w-5 h-6 flex items-center justify-center animate-hover rounded text-grey4 hover:text-grey1 cursor-pointer absolute -top-3 -left-10"),placement:"bottom",popup:"添加块",children:r.jsx("div",{id:"addMenu","data-disable-select":!0,onClick:D=>{c!=null&&c.uuid&&(D.stopPropagation(),t(c.uuid,{syncId:n.node.dataset.syncId}))},children:r.jsx(V,{name:"IcBlockAdd",className:"pointer-events-none",size:"small"})})}),!e&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:R("group absolute -top-5 -left-5",f&&"-left-10"),children:[!F&&r.jsx("div",{className:"keep-hover-node pt-2 -mt-2",children:r.jsxs(Fe,{className:"flex items-center justify-center h-2 w-5 scale-75 hover:scale-125 opacity-0 group-hover:opacity-100 transition-all hover_menu_add_pos_block",placement:"top",popup:"在上方插入块",onClick:()=>x("before"),children:[r.jsx("div",{className:"h-0.5 rounded-sm w-3 bg-grey4 hover_menu_line_icon"}),r.jsx(V,{name:"IcBlockAdd",className:"hidden icon pointer-events-none bg-black_006 rounded p-px",size:"small"})]})}),r.jsx(Fe,{placement:"left",className:F?"pt-2":"",popup:r.jsxs("span",{className:"text-center",children:[r.jsx("div",{children:"长按拖拽"}),r.jsx("div",{children:"点击打开菜单"})]}),children:r.jsx(Ove,{hoverNode:n})}),!F&&r.jsx("div",{className:"keep-hover-node pb-2",children:r.jsxs(Fe,{className:"flex items-center justify-center h-2 w-5 scale-75 hover:scale-125 opacity-0 group-hover:opacity-100 transition-all hover_menu_add_pos_block",placement:"bottom",popup:"在下方插入块",onClick:()=>x("after"),children:[r.jsx("div",{className:"h-0.5 rounded-sm w-3 bg-grey4 hover_menu_line_icon"}),r.jsx(V,{name:"IcBlockAdd",className:"hidden icon pointer-events-none bg-black_006 rounded p-px",size:"small"})]})})]}),r.jsx(Mve,{id:n.id,className:"absolute -top-3 -left-10"})]}),e&&I&&r.jsx(Fe,{className:R("absolute -top-3 -left-5 cursor-pointer",f&&"-left-9"),children:r.jsx(Bve,{blockId:n.id})})]})},eq=e=>Ce(t=>{const n=gn(e,t.blocks,t.collectionViews);if(!n)return!1;const{view:s,collection:a}=n;return z0(s.format.filter,a.data.schema)},[e]),tq=({filterEnabled:e,groupValue:t})=>{const{viewId:n}=Ne(),s=Mi(),a=og(n),o=th(n),i=()=>{e&&a&&s({viewId:n,where:{last:!0}})};return r.jsxs("div",{"data-is-empty":!0,"data-group-value":t,"data-view-id":n,onClick:i,className:R("group text-t2 relative flex h-[37px] items-center border-b pl-2 text-grey4",e&&a&&" cursor-pointer"),children:[o&&r.jsx("div",{className:"absolute top-0 left-0 h-1 w-full bg-black/30 opacity-0 group-hover:opacity-100"}),e?a?"无记录，点击创建新记录 ，或调整视图筛选设置":"没有找到符合筛选条件的记录":"表格内容为空"]})},rS=y.memo(e=>{const{tableCellWrap:t}=Ne();return t?r.jsx(Vve,{...e}):r.jsx($ve,{...e})},yn),Vve=y.memo(({tableGroup:e,withoutValidGroup:t,embed:n,properties:s})=>{const{recordIds:a}=Tc(),{viewId:o,readonly:i,collectionId:l}=Ne(),c=eq(o),d=nf(),[u,f]=y.useState(d==null?void 0:d.current),h=zm(l);return y.useEffect(()=>{f(d==null?void 0:d.current)},[d]),u?r.jsxs("div",{className:"block-list relative","data-view-id":o,"data-group-value":e==null?void 0:e.value,children:[r.jsx(qs,{customScrollParent:u,overscan:Dn,increaseViewportBy:Dn,computeItemKey:p=>p,totalCount:a.length,itemContent:p=>{const g=a[p];return g?r.jsx(S1,{index:p,recordId:g,tableCellWrap:!0,groupProperty:e==null?void 0:e.groupProperty,groupValue:e==null?void 0:e.value,properties:s,level:h?0:void 0,idnumberIndex:p}):null}}),a.length===0&&r.jsx(tq,{filterEnabled:c,groupValue:e==null?void 0:e.value}),r.jsx(hf,{}),r.jsx(mf,{where:{after:t?void 0:a[a.length-1]},groupName:e==null?void 0:e.value}),!i&&!n&&r.jsx(zu,{type:"table"})]}):null},yn),$ve=y.memo(({tableGroup:e,withoutValidGroup:t,embed:n,properties:s})=>{const{recordIds:a}=Tc(),{collectionId:o,viewId:i,readonly:l,viewType:c}=Ne(),d=a.length===0,u=eq(i),f=nf(),h=yr(),[p,g]=y.useState(f==null?void 0:f.current),_=zm(o),F=Il(i)==="Nested"&&_;return y.useEffect(()=>{g(c===m.CollectionViewType.TIMELINE?h==null?void 0:h.current:f==null?void 0:f.current)},[h,f,c]),p?r.jsxs("div",{className:"block-list relative","data-view-id":i,"data-group-value":e==null?void 0:e.value,children:[r.jsx(qs,{customScrollParent:p,overscan:Dn,increaseViewportBy:Dn,computeItemKey:b=>b,fixedItemHeight:F?void 0:37,totalCount:a.length,itemContent:b=>{const w=a[b];return w?r.jsx(S1,{index:b,recordId:w,tableCellWrap:F,groupProperty:e==null?void 0:e.groupProperty,groupValue:e==null?void 0:e.value,properties:s,level:_?0:void 0},w):null}}),!l&&!n&&r.jsx(zu,{type:"table"}),d&&r.jsx(tq,{filterEnabled:u}),r.jsx(hf,{}),r.jsx(mf,{where:{after:t?void 0:a[a.length-1]},groupName:e==null?void 0:e.value})]}):null},yn),Cy=2,nq=()=>{const{viewId:e}=Ne(),[t=[]]=Fa(e,{visible:!0,includeIdNumber:!0}),n=pE(e,t);return n===-1?null:r.jsx(Hve,{properties:t,columnIndex:n})},Hve=e=>{var I;const{properties:t,columnIndex:n}=e,{viewId:s,collectionId:a,embed:o}=Ne(),i=We(a,!1),l=y.useRef(null),c=y.useRef(null),d=y.useRef(null),u=y.useRef(null),[f,h]=y.useState(-1),p=f!==-1,[g,_]=y.useState(!1),x=lt();let F=i?0:up,b=i?0:up;for(let j=0;j<=n;j++){const S=t[j],D=oo(S);F+=D}for(let j=0;j<=f;j++){const S=t[j],D=oo(S);b+=D}const w=t[n],E=u4(s,(I=w==null?void 0:w.property)!=null?I:""),C=ZF(({offset:[j]})=>{E(Es(j,HI,iO))},{from:w==null?void 0:w.width,preventDefault:!0}),k=()=>{var D;const j=(D=d.current)==null?void 0:D.style;let S=0;if(j){const A=parseInt(j.right,10),P=F-A;let L=i?0:up;for(let O=0;O<=t.length;O++){const $=t[O],M=oo($);if(L+M/2<P)L+=M;else{S=O-1;break}}}return S},T=i?{}:C(),v=n===f;return qg(c,{type:"all",onResize(j){var S,D,A,P,L,O;switch(j.resizeStatus){case aa.START:{if(i)return;_(!0),h(n);const $=(S=d.current)==null?void 0:S.closest(".will-change-scroll");if(!$)return;const M=o&&((A=(D=J.blocks[x])==null?void 0:D.data)!=null&&A.pageFixedWidth)?0:96;if($.scrollLeft<=M)return;$&&$.scroll({left:M});break}case aa.RESIZING:{if(i||!d.current)return;const{style:$}=d.current,M=k();if(M!==-1&&f!==M&&h(M),$){let z=parseInt($.right,10);z-=j.deltaX,$.right="".concat(z,"px")}const U=(P=u.current)==null?void 0:P.style;if(U){const{top:z}=d.current.getBoundingClientRect(),K=j.downY-z+j.moveY;U.top="".concat(K,"px");let W=parseInt(U.right,10);W-=j.deltaX,U.right="".concat(W,"px")}break}case aa.END:{if(i)return;_(!1);const $=k(),M=(L=d.current)==null?void 0:L.style,U=(O=u.current)==null?void 0:O.style;M&&(M.right="0px"),U&&(U.right="0px"),h(-1),Rt(s,{tableFreezeColumnIndex:$});break}}}}),r.jsx("div",{ref:l,className:R("flex top-0 absolute w-full h-[calc(100%-73px)]",{"pointer-events-none":!p,"cursor-col-resize":p}),children:r.jsx("div",{className:"flex relative w-full",children:r.jsxs("div",{className:"flex sticky left-0 w-full h-full z-[12] ",style:{width:F+Cy},children:[r.jsx("div",{className:"relative ",style:{width:F}}),r.jsx(Cs,{popup:p||i?"":"按住拖动调整冻结列",delay:{open:500},children:r.jsx("div",{ref:c,"data-disable-select":!0,className:R("group pointer-events-auto absolute h-full",{"cursor-col-resize":!i}),style:{right:"1px",width:"5px"},children:r.jsx("div",{className:R("absolute mt-[39px] bg-grey6 ",{hidden:v,"group-hover:bg-grey6":p,"group-hover:bg-black/50":!i}),style:{right:"1px",width:Cy,height:pt()?"100%":"calc(100% - 39px)"}})})}),p&&r.jsx("div",{ref:d,className:"absolute h-full bg-black/50",style:{right:"2px",width:Cy}}),r.jsx("div",{...T,style:{touchAction:"none"},className:R("absolute pointer-events-auto  bg-grey6 h-[39px] w-0.5 right-0.5 ",{hidden:v,"hover:bg-black hover:right-px hover:w-1 cursor-col-resize":!i})}),g&&p&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-0.5 absolute bg-active_color/80  h-[calc(100%)] ",style:{left:"".concat(b-Cy,"px")}}),r.jsx("div",{ref:u,className:"absolute px-2 text-t4-medium py-1 bg-black2 rounded whitespace-pre-wrap text-white",style:{right:"-100px",top:"0px"},children:"冻结第".concat(f+1,"列")})]})]})})})},zve=()=>{const e=Oe(),t=(n,s,a)=>{var c,d;const{collectionViews:o}=pe(),i=o[n];if(!i||a===((d=(c=i.format.aggregations)==null?void 0:c[s])==null?void 0:d.action))return;const l={...i.format.aggregations,[s]:{action:a}};e(()=>{Rs(n,{format:{aggregations:l}})})};return y.useCallback(t,[e])},dP=({recordIds:e,propertyId:t,width:n,index:s})=>{const{collectionId:a,viewId:o,managerReadonly:i,isLocked:l}=Ne(),c=ie(),d=lt(),u=Pw(),f=zve(),{propertySchema:h,targetPropertySchema:p}=eo(a,t),g=ln(),_=Ce(({collectionViews:E})=>{var v,I,j;const C=(j=(I=(v=E[o])==null?void 0:v.format.aggregations)==null?void 0:I[t])==null?void 0:j.action,T=EE(a,t).find(S=>S.type===C&&C!==m.AggregationAction.NONE);return T==null?void 0:T.type},[o,t]),{aggregation:x,type:F}=h!=null?h:{},b=Ce(E=>{if(!_||!h)return;const C=gn(o,E.blocks,E.collectionViews);if(!C)return;const{view:k,collection:T}=C,{blocks:v}=E,{role:I}=mn(T.uuid),j=I===m.PermissionRole.READER||I===m.PermissionRole.NONE;let S=j?DN(o):k.format.filter;j&&(!S||S.filters.length===0)&&(S=k.format.filter);const D=J8({collectionId:a,records:e.map($=>v[$]).filter($=>!!$),schemas:T.data.schema,userId:u,filter:S,pageId:d}),A=$n(a),P=JN(D,t,_,a,A),L=P==null?void 0:P.result,O=($,M)=>($==null?void 0:$.type)===m.CollectionSchemaType.NUMBER&&$.numberFormat&&typeof M<"u"||($==null?void 0:$.type)===m.CollectionSchemaType.FORMULA&&A.getType(t)===et.ValueTool.numberType&&$.numberFormat&&typeof M<"u"?hl(Number(M),$.numberFormat):M;return F===m.CollectionSchemaType.ROLLUP?Qc(_)&&Qc(x)?O(p,L):L:Qc(_)?O(h,L):L},[a,o,t,_,h,p,e],{ignoreOtherData:!1}),w=E=>{if(i||l)return;const C=zv(),k=UT(a,t),T=_!=null?_:m.AggregationAction.NONE,v=k.map(I=>({type:H.OPERATION,data:{...I,hasArrow:I.subItems,selected:I.type===T,renderSubMenu:I.subItems?()=>{var D,A;const S=(A=(D=I.subItems)==null?void 0:D.map(P=>({type:H.OPERATION,data:{...P,selected:P.type===T}})))!=null?A:[];return r.jsx(ze,{className:"w-[200px] py-2 next-modal",items:S,onItemClick:P=>{f(o,t,P.data.type),g(C)}})}:void 0}}));c.dropdown({modalId:C,popcorn:E.currentTarget,placement:"bottom",content:({onCloseModal:I})=>r.jsx(ze,{className:"w-[200px] py-2 next-modal",items:v,onItemClick:j=>{j.data.type===q8.NONE&&f(o,t,m.AggregationAction.NONE),I()}})})};return r.jsx("button",{dir:"rtl",onClick:w,style:{width:n!=null?n:kp},className:R("flex-shrink-0 text-right overflow-hidden whitespace-nowrap duration-150","opacity-0 animate-hover-black3 w-full h-full px-2 flex items-center text-grey3",l||i?"opacity-100 pointer-events-none":"group-hover:opacity-100",_?"opacity-100":"opacity-0"),children:_?r.jsxs(r.Fragment,{children:[b!==void 0&&r.jsx("span",{className:"ml-2 text-t2",dir:"ltr",children:b}),r.jsx("span",{className:"text-t2 text-grey3",children:pn[_]})]}):r.jsxs(r.Fragment,{children:[r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall",className:"ml-1 text-grey4"}),r.jsx("span",{className:"text-t2 text-grey4",children:"统计"})]})})},aS=y.memo(({recordIds:e})=>{const{viewId:t,embed:n,viewType:s,readonly:a}=Ne(),o=s===m.CollectionViewType.TIMELINE,[i=[],l=[]]=Fa(t,{visible:!0,includeIdNumber:!0}),c=y.useRef(null);y.useEffect(()=>{if(!n)return;const h=c.current,p=h==null?void 0:h.parentElement,g=h==null?void 0:h.closest(".next-space-page");if(!h||!p||!g)return;const _=()=>{const x=p.getBoundingClientRect(),F=g.getBoundingClientRect();if(x.bottom>F.bottom){let b=Math.abs(F.bottom-x.bottom);const w=p.querySelector(".".concat(rc.tableHeader)),E=w==null?void 0:w.getBoundingClientRect();E&&F.bottom-E.bottom<h.clientHeight&&(b=b-(h.clientHeight-(F.bottom-E.bottom))),b-=parseInt(getComputedStyle(p).getPropertyValue("padding-bottom"),10),h.style.transform="translate3d(0,-".concat(Math.round(b),"px,0)"),h.style.borderTopWidth="1px"}else h.style.transform="none",h.style.borderTopWidth="0px"};return g.addEventListener("scroll",_),window.addEventListener("resize",_),()=>{g.removeEventListener("scroll",_),window.removeEventListener("resize",_)}},[n]);const d=pE(t,i),u=i.slice(0,d+1),f=i.slice(d+1);return r.jsxs("div",{className:R("group sticky bottom-0 flex w-full min-w-max transition-none print:hidden bg-white1 z-[12]",rc.tableFooter),style:{height:Si},ref:c,children:[!o&&!a&&u.length===0&&r.jsx("div",{style:{width:up}}),u.length>0&&r.jsxs("div",{className:"flex sticky left-0 z-[10] bg-white1",children:[!o&&!a&&r.jsx("div",{style:{width:up}}),(o?l:u).map((h,p)=>h.type===m.CollectionSchemaType.ID_NUMBER?r.jsx("div",{style:{width:oo(h)}},p):r.jsx(dP,{recordIds:e,index:p,propertyId:h.property,width:oo(h)},h.property))]}),(o?l:f).map((h,p)=>h.type===m.CollectionSchemaType.ID_NUMBER?r.jsx("div",{style:{width:oo(h)}},p):r.jsx(dP,{recordIds:e,index:p,propertyId:h.property,width:oo(h)},h.property)),!o&&r.jsx("div",{className:"w-12 flex-1"})]})},El),ok=y.memo(({className:e})=>{const{viewId:t,readonly:n,viewType:s,embed:a}=Ne(),{tableGroups:o,child2ParentMap:i,parent2ChildMap:l,filteredRecordIdSet:c}=lf(t),[d=[],u=[]]=Fa(t,{visible:!0,includeIdNumber:!0}),f=y.useMemo(()=>({child2ParentMap:i,parent2ChildMap:l,filteredRecordIdSet:c}),[i,c,l]);S2(),g2(o);const h=y.useRef(null),p=nf(),g=s===m.CollectionViewType.TIMELINE?u:d,[_,x]=y.useState(!0);y.useLayoutEffect(()=>{o!=null&&o.withoutValidGroup||x(!1)},[o==null?void 0:o.withoutValidGroup]);const F=()=>{var v,I;let T=DL(g.map(j=>oo(j)));return h.current&&(T<=((I=(v=h.current.parentElement)==null?void 0:v.clientWidth)!=null?I:0)?T=void 0:T+=48),T};if(!o)return null;const{withoutValidGroup:b,sortedRecordIds:w,visibleGroups:E,hiddenGroups:C}=o;if(b)return r.jsx(wm.Provider,{value:f,children:r.jsxs("div",{className:R("relative min-w-max print:border-l",!a&&"-mr-24 pr-24",e),children:[r.jsx(A1,{isGroup:!1,properties:g,recordIds:w}),r.jsx(nq,{}),r.jsx(za,{recordIds:w,children:r.jsx(rS,{embed:a,properties:g})}),r.jsx(aS,{recordIds:w}),!n&&!a&&r.jsx(Di,{type:"collection"}),!a&&r.jsx($p,{readonly:n})]})});const k={width:F()};return r.jsx(wm.Provider,{value:f,children:r.jsxs("div",{ref:h,className:R("relative min-w-max",!a&&"-mr-24 pr-24",e),children:[_&&r.jsx(xs,{className:"h-[300px]"}),!_&&(p==null?void 0:p.current)&&r.jsxs(r.Fragment,{children:[ac(C.length)?r.jsx(qs,{computeItemKey:T=>T,style:k,customScrollParent:p.current,overscan:Dn,increaseViewportBy:Dn,totalCount:E.length,itemContent:T=>{const v=E[T];return v?r.jsx(cu,{tableGroup:v,withoutValidGroup:b,embed:a,properties:g},v.value):null}}):r.jsx(r.Fragment,{children:E.map(T=>r.jsx(cu,{tableGroup:T,withoutValidGroup:b,embed:a,properties:g},T.value))}),r.jsx(Qg,{hiddenGroupsLength:C.length,hiddenGroups:ac(C.length)?r.jsx(qs,{computeItemKey:T=>T,style:k,customScrollParent:p.current,overscan:Dn,increaseViewportBy:Dn,totalCount:C.length,itemContent:T=>{const v=C[T];return v?r.jsx(cu,{tableGroup:v,withoutValidGroup:b,embed:a,properties:g},v.value):null}}):r.jsx(r.Fragment,{children:C.map(T=>r.jsx(cu,{tableGroup:T,withoutValidGroup:b,embed:a,properties:g},T.value))})}),r.jsx(Ou,{}),!n&&!a&&r.jsx(Di,{type:"collection"}),!a&&r.jsx($p,{readonly:n})]})]})})}),cu=y.memo(e=>{const{tableGroup:t,embed:n,withoutValidGroup:s,properties:a,index:o}=e,{viewId:i,viewType:l}=Ne(),{recordIds:c,value:d}=t,u=ig(i,d);return r.jsxs("div",{className:"pb-5","data-group-property":t.groupProperty,"data-group-value":t.value,children:[r.jsx(kx,{tableGroup:t,isInTable:!0,index:o}),u&&r.jsxs(r.Fragment,{children:[r.jsx(A1,{recordIds:c,isGroup:!0,groupName:d,properties:a}),r.jsx(nq,{}),r.jsx(za,{recordIds:c,disable:l===m.CollectionViewType.TIMELINE,children:r.jsx(rS,{embed:n,tableGroup:t,withoutValidGroup:s,properties:a})}),r.jsx(aS,{recordIds:c})]})]})},yn),S2=()=>{const{viewId:e}=Ne(),t=Ce(({collectionViews:n})=>{var s;return(s=n[e])==null?void 0:s.format.collectionGroups},[e]);y.useEffect(()=>{var a;const n={};(t!=null?t:[]).forEach(o=>{var i,l;n[(i=o.value)!=null?i:bm]=localStorage.getItem(bE(e,(l=o.value)!=null?l:bm))!=="false"});const s=(a=xt.$tableGroupFoldStatus)!=null?a:{};st({$tableGroupFoldStatus:{...s,[e]:n}})},[t,e])},qve=e=>{const{viewId:t}=Ne(),{tableGroups:n}=lf(t);return r.jsx(za,{recordIds:(n==null?void 0:n.sortedRecordIds)||[],children:r.jsx(Gve,{...e})})},Gve=()=>{const{viewId:e,readonly:t,embed:n}=Ne(),{tableGroups:s,child2ParentMap:a,parent2ChildMap:o,filteredRecordIdSet:i}=lf(e),l=Bi(e),c=Li(e),d=th(e),{recordIds:u}=Tc();S2(),g2(s);const f=y.useMemo(()=>({child2ParentMap:a,parent2ChildMap:o,filteredRecordIdSet:i}),[a,i,o]),h=y.useRef(null),[p,g]=y.useState(h.current);Dz(p),y.useEffect(()=>{p||g(h.current)});const _=yr(),[x,F]=y.useState(_==null?void 0:_.current);if(y.useEffect(()=>{F(_==null?void 0:_.current)},[x,_]),!x||!s)return null;const{withoutValidGroup:b,sortedRecordIds:w,visibleGroups:E,hiddenGroups:C}=s;return r.jsxs(wm.Provider,{value:f,children:[b?r.jsxs(r.Fragment,{children:[r.jsxs("div",{"data-is-gallery":!0,ref:h,"data-is-empty":w.length===0?!0:null,"data-view-id":e,className:"p-1 block-list grid gap-4 relative border-t border-grey6 pt-4 group",style:{gridTemplateColumns:"repeat(auto-fill, minmax(".concat(ji(l,c),"px, 1fr))")},children:[u.map(k=>r.jsx(jz,{recordId:k},k)),d&&r.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-black/30 opacity-0 group-hover:opacity-100"}),!t&&!n&&r.jsx(zu,{}),r.jsx(mf,{})]}),r.jsx(hf,{})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"block-list",ref:h,children:[ac(E.length)?r.jsx(qs,{customScrollParent:x,overscan:Dn,increaseViewportBy:Dn,computeItemKey:k=>k,totalCount:E.length,itemContent:k=>{const T=E[k];return T?r.jsxs(za,{recordIds:T.recordIds,children:[r.jsx(ky,{tableGroup:T},T.value),";"]}):null}}):r.jsx(r.Fragment,{children:E.map(k=>r.jsx(za,{recordIds:k.recordIds,children:r.jsx(ky,{tableGroup:k})},k.value))}),r.jsx(Qg,{hiddenGroupsLength:C.length,hiddenGroups:C.length>100?r.jsx(qs,{customScrollParent:x,overscan:Dn,increaseViewportBy:Dn,computeItemKey:k=>k,totalCount:C.length,itemContent:k=>{const T=C[k];return T?r.jsxs(za,{recordIds:T.recordIds,children:[r.jsx(ky,{tableGroup:T},T.value),";"]}):null}}):r.jsx(r.Fragment,{children:C.map(k=>r.jsx(za,{recordIds:k.recordIds,children:r.jsx(ky,{tableGroup:k},k.value)}))})}),!t&&!n&&r.jsx(zu,{})]}),r.jsx(Ou,{})]}),!t&&!n&&r.jsx(Di,{type:"collection"})]})},ky=y.memo(e=>{const{tableGroup:t}=e,{viewId:n}=Ne(),s=Bi(n),a=Li(n),{value:o,groupProperty:i}=t,l=th(n),c=ig(n,o),{recordIds:d}=Tc();return r.jsxs("div",{"data-is-gallery":!0,"data-is-empty":d.length===0?!0:null,"data-view-id":n,"data-group-value":o,"data-group-property":i,className:"relative group pb-5",children:[r.jsx(kx,{tableGroup:t}),l&&r.jsx("div",{className:"absolute top-10 left-0 w-full h-1 bg-black/30 opacity-0 group-hover:opacity-100"}),c&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid gap-4 block-list p-1",style:{gridTemplateColumns:"repeat(auto-fill, minmax(".concat(ji(s,a),"px, 1fr))")},children:[d.map(u=>r.jsx(jz,{recordId:u,groupValue:o},u)),r.jsx(mf,{where:{after:d[d.length-1]},groupName:t.value})]}),r.jsx(hf,{})]})]})},yn),Wve=()=>{const{viewId:e}=Ne(),{tableGroups:t,child2ParentMap:n,parent2ChildMap:s,filteredRecordIdSet:a}=lf(e),o=y.useMemo(()=>({child2ParentMap:n,parent2ChildMap:s,filteredRecordIdSet:a}),[n,a,s]);return r.jsx(wm.Provider,{value:o,children:r.jsx(za,{recordIds:(t==null?void 0:t.sortedRecordIds)||[],children:r.jsx(Kve,{})})})},Kve=()=>{const{viewId:e,readonly:t,embed:n,collectionId:s}=Ne(),{tableGroups:a}=lf(e),o=th(e),{recordIds:i}=Tc(),l=zm(s),c=Il(e),d=l&&c==="Nested";S2(),g2(a);const u=y.useMemo(()=>n?r.jsx(r.Fragment,{}):r.jsx($p,{readonly:t}),[n,t]),f=yr(),[h,p]=y.useState(f==null?void 0:f.current);if(y.useEffect(()=>{p(f==null?void 0:f.current)},[h,f]),!h||!a)return null;const{withoutValidGroup:g,sortedRecordIds:_,visibleGroups:x,hiddenGroups:F}=a;return g?r.jsxs("div",{"data-is-empty":_.length===0?!0:null,"data-view-id":e,className:"block-list group relative border-t border-grey6 sm:w-max min-w-[500px]",children:[r.jsx(qs,{customScrollParent:h,overscan:Dn,increaseViewportBy:Dn,computeItemKey:b=>b,fixedItemHeight:d?void 0:38,totalCount:i.length,itemContent:b=>{const w=i[b];return w?r.jsx(oS,{uuid:w,level:l?0:void 0}):null}}),u,!t&&!n&&r.jsx(Di,{type:"collection"}),!t&&!n&&r.jsx(zu,{}),o&&r.jsx("div",{className:"absolute top-0 left-0 h-1 w-full bg-black/30 opacity-0 group-hover:opacity-100"}),r.jsx(hf,{}),r.jsx(mf,{})]}):r.jsxs("div",{className:"block-list relative sm:w-max min-w-[500px]",children:[ac(x.length)?r.jsx(qs,{customScrollParent:h,overscan:Dn,increaseViewportBy:Dn,computeItemKey:b=>b,totalCount:x.length,itemContent:b=>{const w=x[b];return w?r.jsxs(za,{recordIds:w.recordIds,children:[r.jsx(Ty,{tableGroup:w},w.value),";"]}):null}}):r.jsx(r.Fragment,{children:x.map(b=>r.jsx(za,{recordIds:b.recordIds,children:r.jsx(Ty,{tableGroup:b},b.value)}))}),r.jsx(Qg,{hiddenGroupsLength:F.length,hiddenGroups:ac(F.length)?r.jsx(qs,{customScrollParent:h,overscan:Dn,increaseViewportBy:Dn,computeItemKey:b=>b,totalCount:F.length,itemContent:b=>{const w=F[b];return w?r.jsx(za,{recordIds:w.recordIds,children:r.jsx(Ty,{tableGroup:w},w.value)}):null}}):r.jsx(r.Fragment,{children:F.map(b=>r.jsx(za,{recordIds:b.recordIds,children:r.jsx(Ty,{tableGroup:b},b.value)}))})}),u,!t&&!n&&r.jsx(Di,{type:"collection"}),!t&&!n&&r.jsx(zu,{}),r.jsx(Ou,{})]})},Ty=y.memo(({tableGroup:e})=>{const{viewId:t,collectionId:n}=Ne(),{recordIds:s,value:a,groupProperty:o}=e,i=th(t),l=ig(t,a),{recordIds:c}=Tc(),d=zm(n),u=Il(t),f=d&&u==="Nested",h=yr();return h.current?r.jsxs("div",{"data-is-empty":s.length===0?!0:null,"data-view-id":t,"data-group-value":a,"data-group-property":o,className:"group relative pb-5",children:[r.jsx(kx,{tableGroup:e}),i&&r.jsx("div",{className:"absolute top-10 left-0 h-1 w-full bg-black/30 opacity-0 group-hover:opacity-100"}),l&&r.jsxs(r.Fragment,{children:[r.jsx(qs,{customScrollParent:h.current,overscan:Dn,increaseViewportBy:Dn,fixedItemHeight:f?void 0:38,computeItemKey:p=>p,totalCount:c.length,itemContent:p=>{const g=c[p];return g?r.jsx(oS,{groupValue:a,uuid:g,level:d?0:void 0},g):null}}),r.jsx(hf,{}),r.jsx(mf,{where:{after:s[s.length-1]},groupName:e.value})]})]}):null},yn),oS=({uuid:e,groupValue:t,level:n,...s})=>{var F;const{viewId:a,collectionId:o,readonly:i}=Ne(),l=vN(o,a,e)||!!ot.print,c=IN(o,a,e),{parent2ChildMap:d,filteredRecordIdSet:u}=Mg(),f=Il(a),h=(F=d==null?void 0:d.get(e))!=null?F:[],p=aE(o),g=Mi({ignoreSorters:!0}),_=f==="Nested";if(n&&n>15)return null;const x=n!==void 0&&_;return r.jsxs(r.Fragment,{children:[r.jsx(Yve,{uuid:e,alpha:u==null?void 0:u.has(e),groupValue:t,level:n,expandNode:x&&r.jsx(v$,{childrenLen:h.length,expand:l,onExpand:c,level:n}),...s}),l&&x&&_&&r.jsxs("div",{children:[h.map(b=>r.jsx(oS,{uuid:b,level:n+1,groupValue:t,"data-relation-parent-id":e})),!ot.print&&r.jsxs("div",{onClick:()=>{p&&(p!=null&&p.parentPropertyId)&&g({viewId:a,propertyValues:{[p.parentPropertyId]:[{type:m.TextType.LINK_PAGE,uuid:e,text:"",enhancer:{code:!1}}]}})},className:R("flex items-center w-full animate-hover h-8 text-grey border-b",{hidden:i}),style:{paddingLeft:40+n*30},children:[r.jsx(V,{name:"IcAdd",size:"small"}),r.jsx("div",{className:"text-t2 ml-1 flex items-center",children:"创建子记录"})]})]})]})},Yve=({uuid:e,groupValue:t,expandNode:n,alpha:s,...a})=>{const o=ye(e,["data"],["segments"]),{illegal:i}=mt(e),{viewId:l}=Ne(),c=ys(),d=li(l);return o?r.jsx("div",{className:"py-px",children:r.jsxs(wn,{id:e,viewId:l,groupValue:t,onClick:u=>c(e,{illegal:i,forceOpenInRight:u.altKey,openWay:d,forceOpenNewTab:u.ctrlKey||u.metaKey}),className:R("group animate-hover-black3 flex h-9 cursor-pointer items-center justify-between rounded pr-1",s&&"opacity-50"),...kn(a,"level"),children:[i&&r.jsxs("div",{className:"flex min-w-[240px] items-center whitespace-nowrap opacity-30",children:[r.jsx(Fn,{className:"mr-1 inline-block h-5 w-5 min-w-[20px] p-0 align-middle",blockId:e,trigger:!1,iconSize:20,defaultIcon:r.jsx(_s,{uuid:e,size:"middle"})}),r.jsx("span",{className:"text-t2 text-ellipsis border-b border-grey6 align-middle",children:Ts})]}),!i&&r.jsxs(r.Fragment,{children:[r.jsx(Xve,{recordId:e,expandNode:n}),r.jsx(Cx,{recordId:e})]})]})}):null},Xve=({recordId:e,expandNode:t})=>{const{viewId:n,readonly:s,managerReadonly:a}=Ne(),o=We(e),i=ur(),l=cr(e),c=ag(),d=e===(c==null?void 0:c.id)&&n===c.viewId,u=Cg(n),f=ys(),[h,p]=y.useState(d),g=Nn(),_=F=>{F.stopPropagation(),d?f(e,{forceOpenInRight:!0}):st({$newCreatedRecord:{id:e,viewId:n}})};y.useEffect(()=>{p(d);const F=()=>{st({$newCreatedRecord:void 0})};return d&&document.addEventListener("click",F),()=>{document.removeEventListener("click",F)}},[d]);const x=!(s||a||o);return l?r.jsxs("div",{className:R("group-scope flex min-w-[240px] items-center whitespace-nowrap max-w-[50%]",h&&"cursor-text"),onClick:F=>{h&&F.stopPropagation()},children:[t,u&&r.jsx(Fn,{tooltipClassName:"align-middle",className:"mr-1 inline-block h-5 w-5 min-w-[20px] p-0 align-middle",blockId:e,trigger:h,iconSize:20,defaultIcon:r.jsx(_s,{uuid:e,size:"middle"})}),r.jsx("span",{className:"text-t2 text-ellipsis border-b border-grey6 align-middle",children:h?r.jsx(ci,{uuid:e,className:"text-t2-medium inline break-words align-middle",plugins:oa,keydownOption:{bracketRightKey:!1},placeholder:fo,autoFocus:!0,autoFocusCaretToEnd:!0,toolbar:!1,segments:l.data.segments,interactable:d,onBlur:()=>{const F=g(e);F&&i(e,"title",mr(F.content))},onKeyDown:F=>{if(Ie("mod+a")(F)){F.stopPropagation();return}(Ie("enter")(F)||Ie("esc")(F))&&F.currentTarget.blur()}}):r.jsx(fs,{className:"text-t2-medium inline break-words align-middle",plugins:oa,segments:l==null?void 0:l.data.segments,placeholder:fo,interactable:!1})}),x&&r.jsx(Cs,{popup:h?"右侧边栏打开":"编辑",children:r.jsx("button",{onClick:_,className:"animate-hover-opaque ml-1 flex h-6 w-6 cursor-pointer items-center justify-center rounded border border-grey6 bg-white1 group-scope-hover:opacity-100 opacity-0",children:r.jsx(V,{name:d?"IcBlockRightSidebarOpen":"IcEdit",size:"small",className:"text-grey3"})})}),r.jsx(c4,{recordId:e}),r.jsx(d4,{recordId:e}),r.jsx(nh,{className:"inline-flex align-middle pointer-events-none",blockId:e})]}):null};const sq=y.createContext(void 0),xo=()=>{const e=y.useContext(sq);if(!e)throw new Error("useBitable");return e},rq=()=>{const{timelineDates:e,zoomLevel:t}=xo(),n=t===Ft.HOUR||t===Ft.DAY,[s,a]=y.useState(0),o=y.useRef(),i=y.useCallback(()=>n?(new Date().setSeconds(0,0)-e[0])/Lu*hr[t]:kr(Date.now(),e[0],t,{abs:!1})*hr[t],[n,t,e]);return y.useEffect(()=>{a(i());const l=()=>{o.current=setTimeout(l,y1),a(i())};return o.current=setTimeout(l,y1),()=>{o.current&&clearTimeout(o.current)}},[i]),s},Qve=()=>{const{timelineDates:e,zoomLevel:t}=xo(),n=t===Ft.HOUR||t===Ft.DAY,s=rq();if(Date.now()>e[e.length-1]||Date.now()<e[0])return null;let a=s;Jg(t)&&(a=kr(Date.now(),e[0],t,{abs:!1,needDateStart:!0})*hr[t]+hr[t]/2);const o=()=>n?ue(new Date).format(co):t===Ft.WEEK||t===Ft.BIWEEK?a1("".concat(Cu[Yr(Date.now()).day]," ").concat(Yr(Date.now()).date)):new Date().getDate();return r.jsxs(r.Fragment,{children:[r.jsx("span",{style:{left:a},className:R("px-1 absolute inline-flex justify-center items-center rounded-full -translate-x-1/2  z-10",n?"text-red":"text-white bg-red",t===Ft.MONTH||t===Ft.QUARTER||t===Ft.YEAR?"w-6 h-6":"h-[25px]"),children:o()}),r.jsx("span",{style:{left:s},className:"w-2 h-2 rounded-full bg-red -bottom-2 absolute -translate-x-1/2 -translate-y-1/2"})]})},Jve=()=>{const{timelineDates:e}=xo(),t=rq();return Date.now()>e[e.length-1]||Date.now()<e[0]?null:r.jsx("div",{style:{left:t,height:"calc(100% - 76px)"},className:"absolute w-px bg-red bottom-0 top-[76px]"})},Zve=y.memo(()=>{const[e,t]=y.useState(Date.now()),n=y.useRef(),{containerWidth:s,timelineDates:a,datesContainer:o,zoomLevel:i}=xo(),l=hr[i];y.useEffect(()=>{if(i===Ft.DAY||i===Ft.HOUR){const d=()=>{n.current=setTimeout(d,y1),t(Date.now())};n.current=setTimeout(d,y1)}return()=>{n.current&&clearTimeout(n.current)}},[i]);const c=d=>{let u=d;i!==Ft.DAY&&i!==Ft.HOUR&&(u=d+12*eF);let f=0,h="";return Jg(i)?(i===Ft.WEEK||i===Ft.BIWEEK?h=a1("".concat(Cu[Yr(u).day],"  ").concat(Yr(u).date)):h=Yr(u).date,f=l):i===Ft.YEAR?(h="".concat(Yr(u).month,"月"),f=l*STe(u)):i===Ft.QUARTER?(h="".concat(Yr(u).date),f=l*7):i===Ft.DAY?(h=Math.abs(e-u)<eF?"":ue(new Date(u)).format("HH:00"),f=l*4):i===Ft.HOUR&&(h=Math.abs(e-u)<Lu?"":ue(new Date(u)).format(co),f=l),r.jsx("div",{className:R("inline-flex h-full items-center",i!==Ft.DAY&&i!==Ft.HOUR&&i!==Ft.QUARTER&&"justify-center"),style:{width:f},children:i===Ft.DAY||i===Ft.HOUR||i===Ft.QUARTER?r.jsxs("span",{className:"-translate-x-1/2",children:[" ",h]}):h},u)};return r.jsxs("div",{ref:o,className:"text-t2-medium relative z-30 h-[38px] border-b bg-white1 py-1.5 font-medium text-grey4",style:{width:s},children:[a.map(d=>c(d)),r.jsx(Qve,{})]})},El),e3e=y.memo(y.forwardRef((e,t)=>{const{containerWidth:n,timelineDates:s,zoomLevel:a}=xo(),o=hr[a],i=l=>{let c=!1,d="",u=0;return Jg(a)?(c=new Date(l).getDate()===1,d="".concat(new Date(l).getMonth()+1,"月"),u=kr(l,s[0],a)*o):a===Ft.YEAR?(c=new Date(l).setMonth(0,1)===l,d="".concat(new Date(l).getFullYear(),"年"),u=kr(l,s[0],a)*o):a===Ft.QUARTER?(new Date(l).getMonth()!==new Date(l+6*Kn).getMonth()||new Date(l).getDay()===0)&&(c=!0,d="".concat(new Date(l+6*Kn).getMonth()+1,"月"),u=(kr(l,s[0],a)+(7-new Date(l+6*Kn).getDate()))*o):(a===Ft.DAY||a===Ft.HOUR)&&(c=Vp(l)===l,d="".concat(new Date(l).getMonth()+1,"月").concat(new Date(l).getDate(),"日"),u=kr(l,s[0],a)*o),c?r.jsx("div",{style:{left:u},className:"absolute h-full inline-flex items-center justify-center flex-shrink-0",children:d},l):null};return r.jsx("div",{ref:t,className:"timeline-month relative z-30 h-[38px] bg-white1 text-t2-medium border-t transition-none",style:{width:n},children:s.map(i)})}),El),t3e=y.memo(()=>{const{containerWidth:e,timelineDates:t,zoomLevel:n}=xo(),s=hr[n];return r.jsxs("div",{className:"absolute top-0 h-full",style:{width:e},children:[t.map(a=>{const o=kr(a,t[0],n)*s;return n===Ft.HOUR||n===Ft.DAY||n===Ft.QUARTER||n===Ft.YEAR?r.jsx("div",{style:{left:o},className:"absolute h-full bg-grey6 w-[1px]"},a):n===Ft.WEEK?r.jsx("div",{style:{left:o,width:s},className:R("absolute h-full border-l border-grey6",(Yr(a).day===6||Yr(a).day===0)&&"bg-grey8 dark:bg-grey8/5")},a):Yr(a).day===6?r.jsx("div",{style:{left:o,width:s*2},className:"absolute h-full bg-grey8 dark:bg-white3 flex-shrink-0 flex flex-col items-center justify-center"},a):null}),r.jsx(Jve,{})]})},El),n3e=y.memo(y.forwardRef((e,t)=>{var C;const{container:n,setTimelineDates:s,scrollLeft:a,stepLength:o,timelineDates:i,zoomLevel:l}=xo(),{viewId:c,managerReadonly:d,isLocked:u,embed:f}=Ne(),h=kg(c),p=Qa(),g=ie(),[_,x]=y.useState(),F=hr[l];y.useEffect(()=>{const k=n.current;if(!k)return;const T=()=>{const I=Math.floor(k.scrollLeft/hr[l]),j=i[0]+I*em(l);j&&x(S=>{let D=0;return Jg(l)||l===Ft.QUARTER?D=new Date(j).setDate(2):l===Ft.YEAR?D=new Date(j).setMonth(0,2):(l===Ft.DAY||l===Ft.HOUR)&&(D=Vp(j)+12*fw),D!==S?D:S})};T();const v=Ps(T,60);return k.addEventListener("scroll",v),()=>k.removeEventListener("scroll",v)},[F,n,l,i]);const b=k=>{if(u||d)return;const T=kA.map(v=>({type:H.OPERABLE_BLOCK_TEXT,data:{title:v.name,...v,selected:v.level===l}}));g.dropdown({popcorn:k.currentTarget,placement:"bottom",content:({onCloseModal:v})=>r.jsx(ze,{className:"next-modal w-36 py-2",items:T,onItemClick:({data:I})=>{if(!n.current)return;o.current=DT[I.level];const j=Up({zoomLevel:I.level,length:o.current});s(j),a.current=kr(Date.now(),j[0],I.level)*hr[I.level]-n.current.clientWidth/2,Rt(c,{timelinePreference:{zoomLevel:I.level}}),v()}})})},w=()=>{if(!n.current)return;const k=Up({zoomLevel:l,length:o.current});s(k),a.current=kr(Date.now(),k[0],l)*hr[l]-n.current.clientWidth/2},E=k=>{n.current&&(k===Kf.left?n.current.scrollLeft-=n.current.clientWidth/2:n.current.scrollLeft+=n.current.clientWidth/2)};return r.jsx("div",{className:"absolute top-0.5 left-0 z-40 flex h-[36px] w-full items-center whitespace-nowrap",ref:t,children:_&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex h-full",children:[r.jsxs("div",{className:R("flex items-center bg-white1",h?"pl-2":"pl-4"),children:[!h&&!d&&!u&&r.jsx(Fe,{popup:"显示表格",onClick:()=>Rt(c,{timelineShowTable:!0}),children:r.jsx(V,{name:"IcUnfold",size:"middle",className:"animate-hover mr-4 text-grey3"})}),r.jsxs("span",{className:"text-t2-medium inline-flex h-full items-center bg-white1",children:[Yr(_).year,"年",l!==Ft.YEAR&&r.jsxs(r.Fragment,{children:[Yr(_).month,"月"]}),(l===Ft.DAY||l===Ft.HOUR)&&r.jsxs(r.Fragment,{children:[Yr(_).date,"日"]})]})]}),r.jsx("span",{className:"h-full w-6",style:{backgroundImage:"linear-gradient(to right, var(--white1) 20%, transparent 100%)"}})]}),r.jsxs("div",{className:"ml-auto flex h-full items-center",children:[r.jsx("span",{className:"h-full w-6",style:{backgroundImage:"linear-gradient(to left, var(--white1) 20%, transparent 100%)"}}),r.jsxs("div",{className:R("flex h-full items-center bg-white1",!f&&!p&&"pr-24"),children:[r.jsxs("button",{onClick:b,className:"text-t2 flex h-full items-center px-3 text-grey3",children:[(C=kA.find(k=>k.level===l))==null?void 0:C.name,!d&&r.jsx(V,{size:"xxxsmall",name:"IcArrowDown01",className:"ml-1"})]}),r.jsx(Fe,{className:"animate-hover rounded-sm",children:r.jsx(V,{name:"IcArrowDateBack",size:"middle",onClick:()=>E(Kf.left)})}),r.jsx("span",{className:"text-t2-medium mx-1.5 cursor-pointer",onClick:w,children:"今天"}),r.jsx(Fe,{className:"animate-hover rounded-sm",children:r.jsx(V,{name:"IcArrowDateNext",size:"middle",onClick:()=>E(Kf.right)})})]})]})]})})}),El),aq=({startTime:e,unitLength:t})=>{const{timelineDates:n,zoomLevel:s}=xo(),a=e+t*em(s),o=hr[s],i=kr(e,n[0],s,{needDateStart:!0,abs:!1})*hr[s],l=s===Ft.DAY||s===Ft.HOUR?t*o:(t+1)*o,c=()=>{if((s===Ft.YEAR||s===Ft.QUARTER)&&e&&a){const d=ue(e).format("YYYY-MM"),u=ue(a).format("YYYY-MM");return d===u&&l<90?"".concat(ue(e).format(np)," - ").concat(ue(a).format("DD")):r.jsxs(r.Fragment,{children:[r.jsx("span",{children:ue(e).format(np)}),r.jsx("span",{children:ue(a).format(np)})]})}else if(Jg(s)){const d=o;let u=Yr(e).date,f=Yr(a).date;return(s===Ft.WEEK||s===Ft.BIWEEK)&&(u=a1("".concat(Cu[Yr(e).day],"  ").concat(Yr(e).date)),f=a1("".concat(Cu[Yr(a).day],"  ").concat(Yr(a).date))),r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"inline-flex h-full items-center justify-center text-black",style:{width:d},children:u}),f!==u&&r.jsx("div",{className:"inline-flex h-full items-center justify-center text-black",style:{width:d},children:f})]})}};return r.jsx("div",{className:R("absolute top-1.5 flex h-6 justify-between rounded-xl",s===Ft.YEAR||s===Ft.QUARTER?"bg-grey9 px-1 text-black ":"bg-black_003"),style:{left:i,minWidth:l},children:c()})},s3e=e=>{const t=e.getBoundingClientRect(),n=document.createElement("div");n.style.position="fixed",n.style.width="".concat(t.width,"px"),n.style.height="".concat(t.height,"px"),n.style.top="".concat(t.top,"px"),n.style.left="".concat(t.left,"px"),n.style.opacity="0.5",n.style.zIndex="100";const s=e.cloneNode(!0);return n.appendChild(s),document.body.appendChild(n),n},r3e=(e,t,n)=>{let s;const a=e.querySelectorAll(".record-line-container [data-record-id]");let o=0;const i=t.getBoundingClientRect();let l;a.forEach(d=>{var h;if(d.dataset.recordId===Wl)return;const u=d.getBoundingClientRect();(h=d.lastElementChild)!=null&&h.classList.contains("indicator")&&d.lastElementChild.remove();const f=z$(i,u);f>o&&(o=f,i.top<u.top?l="top":l="bottom",s=d)});const c=document.createElement("div");return c.classList.add("indicator"),c.style.position="absolute",c.style.zIndex="100",c.style.width="100%",c.style.height="4px",c.style.backgroundColor="rgba(0, 0, 0, 0.3)",l==="top"?c.style.top="-2px":c.style.bottom="-2px",s&&s.dataset.recordId!==n&&s.appendChild(c),{target:s,position:l}};let uP;const oq=e=>{const{zoomLevel:t}=xo(),{viewId:n,collectionId:s}=Ne(),a=t===Ft.DAY||t===Ft.HOUR;return Ce(({collectionViews:o,blocks:i})=>{var E,C,k,T,v,I;const l=o[n];if(!l)return;const c=(E=l.format.timelineBy)!=null?E:"",d=(C=l.format.timelineByEnd)!=null?C:"",u=i[s],f=i[e];if(!u||!f)return;const h=(k=u.data.schema)==null?void 0:k[c],p=(T=u.data.schema)==null?void 0:T[d];if(!h||!p)return;let g,_,x=m.TextType.DATE,F=m.TextType.DATE;if(h.type===m.CollectionSchemaType.CREATED_AT||h.type===m.CollectionSchemaType.UPDATED_AT)x=m.TextType.DATETIME,g=h.type===m.CollectionSchemaType.CREATED_AT?f.createdAt:f.updatedAt;else if(h.type===m.CollectionSchemaType.DATE){const j=va(f,c);x=(v=j==null?void 0:j.textType)!=null?v:m.TextType.DATE,g=j==null?void 0:j.timestamp}if(p.type===m.CollectionSchemaType.CREATED_AT||p.type===m.CollectionSchemaType.UPDATED_AT)F=m.TextType.DATETIME,_=p.type===m.CollectionSchemaType.CREATED_AT?f.createdAt:f.updatedAt;else if(p.type===m.CollectionSchemaType.DATE){const j=va(f,d);F=(I=j==null?void 0:j.textType)!=null?I:m.TextType.DATE,_=j==null?void 0:j.timestamp}if(!g&&!_)return;let b=g||_,w=_;if(g&&_&&(w=_>=g?_:g),_||(w=g),!(!b||!w)&&(a&&(x===m.TextType.DATE&&(b=Us(b)),F===m.TextType.DATE&&(w=Us(w)+Kn)),!(!b||!w)))return{timelineBy:c,timelineByEnd:d,renderStartTime:b,renderEndTime:w}},[n,s,e])},a3e=({recordId:e,card:t})=>{var se;const{container:n,datesContainer:s,timelineDatesRef:a,draggingRecordId:o,zoomLevel:i,containerWidth:l}=xo(),c=We(e,!1),{viewId:d,managerReadonly:u}=Ne(),f=Oe(),h=ys(),p=li(d),g=cr(e),[_,x]=y.useState(),[F,b]=y.useState(),[w,E]=y.useState(),{illegal:C}=mt(e),k=ur(),T=y.useRef(null),v=y.useRef({x:0,y:0}),I=oq(e),j=J4(d,e),S=ag(),D=y.useContext(Fm);if(!I)return null;let{renderStartTime:A,renderEndTime:P}=I;const{timelineBy:L,timelineByEnd:O}=I,$=!!((se=g==null?void 0:g.data.icon)!=null&&se.type),M=hr[i],U=i===Ft.DAY||i===Ft.HOUR,z=e===(S==null?void 0:S.id)&&d===S.viewId&&S.from===gx.TIMELINE,K=ce=>{if(ce.preventDefault(),c||u)return;const ae=s.current,de=n.current,ke=t.current,Te=T.current,he=ce.currentTarget.closest(".next-space-page");if(!he||!ke||!de||!Te||!ae)return;v.current={x:ce.clientX,y:ce.clientY};let Ee={x:ce.clientX,y:ce.clientY};const ge=ke.getBoundingClientRect(),Se=ge.width,Re=ce.clientX-ge.left;let Ae,Me=!1,Ge,tt,gt;const kt=sn=>{if(Ee={x:sn.clientX,y:sn.clientY},!Me){if(Math.abs(sn.clientX-v.current.x)<5&&Math.abs(sn.clientY-v.current.y)<5)return;Me=!0,o.current=e,Ge=s3e(Te)}rP(sn.clientX,de),Sv({y:sn.clientY,container:he}),nn(sn.clientX,sn.clientY)},At=()=>{var N;if(he.removeEventListener("scroll",Qt),de.removeEventListener("scroll",Qt),document.removeEventListener("mousemove",kt),document.removeEventListener("mouseup",At),cancelAnimationFrame(Xh),cancelAnimationFrame(Hf),Ge==null||Ge.remove(),b(void 0),o.current=void 0,tt&&((N=tt.lastElementChild)!=null&&N.classList.contains("indicator"))&&tt.lastElementChild.remove(),!Me||!g)return;const sn=tt==null?void 0:tt.dataset.recordId,ms=sn&&sn!==e;f(()=>{var rt,je,le,Qe,Tt,Pt,cn;const{timelineBy:B,timelineByEnd:X}=(rt=gn(d))!=null?rt:{};if(!B||!X)return;const Z=Ae+em(i)*(U?Se/M:Se/M-1),{blocks:oe,collectionViews:xe}=pe(),Be=oe[g.parentId],Le=xe[d];if(!Be||!Le)return;const bt=(je=Be.data.schema)==null?void 0:je[B],Ue=(le=Be.data.schema)==null?void 0:le[X];let He={};if((bt==null?void 0:bt.type)===m.CollectionSchemaType.DATE){const Lt=(Qe=va(g,B))==null?void 0:Qe.textType;He[B]=[Gn({from:ql(A,Ae,i),includeTime:Nh(i,Lt)})]}if((Ue==null?void 0:Ue.type)===m.CollectionSchemaType.DATE){const Lt=(Tt=va(g,X))==null?void 0:Tt.textType;He[X]=[Gn({from:ql(P,Z,i),includeTime:Nh(i,Lt)})]}if(ms){const Lt=(Pt=Te.parentElement)==null?void 0:Pt.dataset.groupValue,Bn=tt==null?void 0:tt.dataset.groupValue;if(Lt!==Bn){const Gt=Ig({viewId:d,groupValue:tt==null?void 0:tt.dataset.groupValue});He={...He,...Gt}}}if(_e(e,{data:{segments:(cn=He.title)!=null?cn:g.data.segments,collectionProperties:{...g.data.collectionProperties,...He}}}),ms){const{newPageSort:Lt}=SE(Le.pageSort,Be.subNodes),Bn=Lt.indexOf(e);let Gt=Lt.indexOf(sn);Gt=gt==="top"?Bn<Gt?Gt-1:Gt:Bn<Gt?Gt:Gt+1,Bn!==Gt&&Rs(d,{pageSort:Wu(Lt,Bn,Gt)})}})},Qt=()=>nn(Ee.x,Ee.y),nn=(sn,ms)=>{if(!Ge)return;Ge.style.transform="translate(".concat(sn-v.current.x,"px, ").concat(ms-v.current.y,"px)");const N=de.getBoundingClientRect(),B=de.scrollLeft+sn-N.x-Re,X=Math.round(B/M);Ae=a.current[0]+X*em(i),b(Ae);const Z=r3e(de,Ge,e);tt=Z.target,gt=Z.position};he.addEventListener("scroll",Qt),de.addEventListener("scroll",Qt),document.addEventListener("mousemove",kt),document.addEventListener("mouseup",At)},W=(ce,ae)=>{if(c)return;ce.preventDefault(),ce.stopPropagation();const de=s.current,ke=n.current;if(!ke||!de)return;E(ae);const Te=ae===b1.left;let he,Ee=ce.clientX;const ge=Me=>{Ee=Me.clientX,rP(Me.clientX,ke),o.current=e,Ae(Me.clientX)},Se=()=>{ke.removeEventListener("scroll",Re),document.removeEventListener("mousemove",ge),document.removeEventListener("mouseup",Se),cancelAnimationFrame(Xh),E(void 0),x(void 0),o.current=void 0,!(!g||!pe().blocks[g.parentId])&&f(()=>{var Qt,nn,sn,ms;if(!he)return;const{blocks:Ge}=pe(),tt=Ge[g.parentId];if(!tt)return;const gt=(Qt=tt.data.schema)==null?void 0:Qt[L],kt=(nn=tt.data.schema)==null?void 0:nn[O],At={};if((gt==null?void 0:gt.type)===m.CollectionSchemaType.DATE){const N=(sn=va(g,L))==null?void 0:sn.textType;At[L]=Te?[Gn({from:ql(A,he,i),includeTime:Nh(i,N)})]:[Gn({from:new Date(A),includeTime:Nh(i,N)})]}if((kt==null?void 0:kt.type)===m.CollectionSchemaType.DATE){const N=(ms=va(g,O))==null?void 0:ms.textType;At[O]=Te?[Gn({from:P>A?new Date(P):ql(P,A,i),includeTime:Nh(i,N)})]:[Gn({from:ql(P,he,i),includeTime:Nh(i,N)})]}_e(e,{data:{collectionProperties:{...g.data.collectionProperties,...At}}})})},Re=()=>Ae(Ee),Ae=Me=>{const Ge=ke.getBoundingClientRect(),tt=ke.scrollLeft+Me-Ge.x,gt=Te||U?Math.round(tt/M):Math.round(tt/M)-1,kt=a.current[0]+gt*em(i);kt&&(Te&&kt<=Math.max(A,P)||!Te&&kt>=(RTe(i)?P1(A):Us(A)))&&(he=kt,x(kt))};ke.addEventListener("scroll",Re),document.addEventListener("mousemove",ge),document.addEventListener("mouseup",Se)};_&&(w===b1.left?A=_:P=_);const Y=kr(A,a.current[0],i,{needDateStart:!0,abs:!1})*M,G=kr(P,A,i,{needDateStart:!0,abs:!0}),ee=U?Math.max(G*M,10):(G+1)*M,te=lo((Y+ee)/l),Q="linear-gradient(90deg, rgb(0, 0, 0) ".concat(te,", rgba(0, 0, 0, 0.4) ").concat(te,")"),ne=r.jsxs("div",{className:"absolute left-0 flex h-full w-full items-center overflow-hidden",ref:T,children:[r.jsxs("div",{ref:t,onMouseDown:K,"data-block-id":D?e:void 0,"data-view-id":d,"data-hide-hover-menu":!0,className:"absolute flex h-full cursor-pointer items-center whitespace-nowrap",style:{left:Y,width:ee,boxShadow:"0px 1px 3px var(--black_006-base)"},children:[r.jsx("div",{className:"h-full w-full",onClick:ce=>h(e,{illegal:C,forceOpenInRight:ce.altKey,openWay:p,forceOpenNewTab:ce.ctrlKey||ce.metaKey})}),O!==L&&!c&&r.jsx(r.Fragment,{children:l8.map(ce=>r.jsxs("div",{className:R("group absolute z-10 h-full w-[9px] rounded-full px-[3px] py-1.5 hover:cursor-col-resize",w&&w!==ce&&"pointer-events-none",ce==="left"?"-left-[5px]":"-right-[5px]"),onMouseDown:ae=>W(ae,ce),children:[r.jsx("span",{className:R("inline-block h-full w-[3px] rounded-full group-hover:bg-black",w===ce&&"bg-black")}),w===ce&&_&&r.jsx("div",{className:R("text-t4 absolute top-1.5 flex items-center rounded bg-white1 px-1 text-black",ce==="left"?"right-3":"left-3"),children:U?ue(P1(_)).format("MM/DD HH:mm"):ue(_).format(np)})]},ce))}),r.jsx("div",{className:"absolute pointer-events-none right-0 top-0 rounded h-full z-10 w-full bg-white3",children:r.jsx("span",{style:{backgroundColor:j},className:"absolute w-full h-full rounded border border-black/10"})})]}),r.jsx("div",{className:"pointer-events-none absolute left-0 flex h-full w-full items-center z-10",style:{WebkitMaskImage:Q},children:r.jsxs("div",{className:"absolute flex h-[34px] cursor-pointer items-center px-2",style:{left:Y,minWidth:ee},children:[C&&r.jsxs(r.Fragment,{children:[r.jsx(Fn,{className:"text-t2-medium mr-1 inline p-0 align-middle opacity-30",blockId:e,trigger:!1,iconSize:16,defaultIcon:r.jsx(V,{name:"IcPageEmpty",size:"middle"})}),r.jsx("span",{className:"border-grey6 border-b opacity-30",children:Ts})]}),!C&&r.jsxs(r.Fragment,{children:[$&&!z&&r.jsx(Fn,{tooltipClassName:"align-middle",className:"mr-1.5 inline-flex p-0 align-middle",blockId:e,iconSize:20}),z?r.jsx(ci,{uuid:e,className:"text-t2-medium inline whitespace-nowrap",plugins:oa,placeholder:fo,segments:g==null?void 0:g.data.segments,autoFocus:!0,autoFocusCaretToEnd:!0,onChange:ce=>k(e,"title",ce),onFocus:()=>clearTimeout(uP),onBlur:()=>{uP=setTimeout(()=>{st({$newCreatedRecord:void 0})},1e3)},onKeyDown:ce=>{(Ie("enter")(ce)||Ie("esc")(ce))&&ce.currentTarget.blur()}}):r.jsx(fs,{className:"text-t2-medium inline whitespace-nowrap",segments:g==null?void 0:g.data.segments,placeholder:fo,interactable:!1,plugins:oa}),!z&&r.jsx(Cx,{recordId:e})]})]})}),s.current&&(_||F)&&Ls.createPortal(r.jsx(aq,{startTime:F!=null?F:A,unitLength:G}),s.current)]});return r.jsx(r.Fragment,{children:ne})},o3e=y.memo(({recordId:e,card:t})=>{const{setTimelineDates:n,container:s,scrollLeft:a,stepLength:o,timelineDates:i,zoomLevel:l}=xo(),[c,d]=y.useState(!1),[u,f]=y.useState(!1),h=oq(e),p=bl(s.current).width,{renderStartTime:g,renderEndTime:_}=h!=null?h:{},x=y.useCallback(()=>{if(!s.current||!t.current)return;const b=t.current.getBoundingClientRect(),w=s.current.getBoundingClientRect();b.left<w.left!==c&&d(b.left<w.left),b.right>w.right!==u&&f(b.right>w.right)},[t,s,c,u]);y.useEffect(()=>{if(!s.current)return;const b=s.current;return b.addEventListener("scroll",x),()=>b.addEventListener("scroll",x)},[s,x]),y.useEffect(()=>{x()},[x,g,_,i,p]);const F=b=>{if(!s.current||!g||!_)return;const w=100,E=b===b1.left,C=Up({zoomLevel:l,base:E?g:_,length:o.current});E?a.current=kr(g,C[0],l)*hr[l]-w:a.current=kr(_,C[0],l)*hr[l]-(s.current.clientWidth-w),n(C),E?d(!1):f(!1)};return!g||!_?null:r.jsx(r.Fragment,{children:l8.map(b=>{if(!s.current)return null;const w=b===b1.right,E=w?u:c;return r.jsxs("button",{onClick:()=>F(b),className:R("sticky h-full px-2 flex items-center pointer-events-auto group z-[20] duration-150"),style:{left:w?s.current.clientWidth-32:0,opacity:E?1:0,transform:E?"scale(1)":"scale(0)"},children:[r.jsx(V,{name:"IcDateBack",size:"small",className:R("text-white1 bg-black/30 rounded",w&&"rotate-180")}),r.jsxs("span",{className:R("absolute px-1 flex items-center text-black bg-white1 rounded text-t4 opacity-0 group-hover:opacity-100 pointer-events-none",w?"right-[30px]":"left-[30px]"),children:[ue(g).format(Et),r.jsx(V,{name:"IcDateEnd",size:"xxsmall",className:"mx-0.5"}),ue(Math.max(g,_)).format(Et)]})]},b)})})},yn),i3e=({initDateRangeLength:e,movingStartDate:t,recordId:n,relationParentId:s})=>{const{timelineDates:a,zoomLevel:o}=xo(),{viewId:i}=Ne(),l=kg(i),c=ft(n,u=>u==null?void 0:u.data.segments),d=hr[o]*e;return n===Wl?l&&!t?null:r.jsxs("div",{className:R("h-9 top-0.5 rounded flex items-center whitespace-nowrap pr-2 pl-1",t?"absolute bg-black_006 pointer-events-none":"sticky left-24 text-grey3",s&&"h-7"),style:{width:d,left:t?kr(t,a[0],o)*hr[o]:void 0},children:[r.jsx(V,{name:"IcAddBoard",size:"middle",className:"mr-1.5"}),r.jsx("span",{className:"text-t2",children:"创建页面"})]}):t?r.jsx("div",{className:"absolute h-[37px] top-0.5 bg-black_006 rounded pointer-events-none px-1.5 flex items-center whitespace-nowrap",style:{width:d,left:kr(t,a[0],o)*hr[o]},children:r.jsx(fs,{className:"inline text-t2-medium",plugins:oa,segments:c,placeholderColor:"var(--black)",placeholder:fo,interactable:!1})}):null},B1=y.memo(e=>{var f;const{level:t}=e,{collectionId:n,viewId:s}=Ne(),a=vN(n,s,e.recordId)||!!ot.print,o=IN(n,s,e.recordId),{parent2ChildMap:i}=Mg(),l=(f=i==null?void 0:i.get(e.recordId))!=null?f:[];y.useEffect(()=>{const h=p=>{p.recordId===e.recordId&&o(p.expand)};return xn.on("timelineExpand",h),()=>{xn.off("timelineExpand",h)}},[e.recordId]);const d=Il(s)==="Nested",u=t!==void 0&&d;return t&&t>10?null:r.jsxs(r.Fragment,{children:[r.jsx(fP,{...e}),a&&u&&r.jsxs(r.Fragment,{children:[l.map(h=>y.createElement(B1,{...e,recordId:h,key:h})),y.createElement(fP,{...e,recordId:Wl,key:Wl,relationParentId:e.recordId})]})]})},El),fP=y.memo(e=>{const{recordId:t,groupName:n,lastRecordId:s,relationParentId:a}=e,{collectionId:o,viewId:i}=Ne(),l=Oe(),c=We(t,!1),{container:d,datesContainer:u,draggingRecordId:f,zoomLevel:h,timelineDatesRef:p}=xo(),g=y.useRef(null),_=ye(t,["data"],["collectionProperties"]),{illegal:x}=mt(t),F=Mi(),[b,w]=y.useState(),E=aE(o),{timelineBy:C,timelineByEnd:k,recordStartTime:T,recordEndTime:v}=Ce(({collectionViews:L,blocks:O})=>{var K,W;const $=O[t],M=L[i],U=(K=M==null?void 0:M.format.timelineBy)!=null?K:"",z=(W=M==null?void 0:M.format.timelineByEnd)!=null?W:"";return{timelineBy:U,timelineByEnd:z,recordStartTime:hd($,U),recordEndTime:hd($,z)}},[t,i]);Rz(i,t);const I=C===k?1:Ace[h],j=L=>{if(T||v||x||t!==Wl&&c||f.current)return;const O=u.current;if(!d.current||!O)return;const $=d.current.getBoundingClientRect(),M=d.current.scrollLeft+L.clientX-$.x,U=Math.floor(M/hr[h]);w(p.current[0]+U*em(h))},S=()=>{w(void 0)},D=()=>{if(!x&&!(t!==Wl&&c)&&b){const L=b,O=L+(P?I:I-1)*em(h),$={[C]:[Gn({from:new Date(L),includeTime:P})],[k]:[Gn({from:new Date(O),includeTime:P})]};if(t===Wl){let M={};a&&(E!=null&&E.parentPropertyId)&&(M={[E.parentPropertyId]:[{type:m.TextType.LINK_PAGE,uuid:a,text:"",enhancer:{code:!1}}]}),F({viewId:i,where:{after:s},propertyValues:{...Ig({viewId:i,groupValue:n,isNewRecord:!0}),...$,...M},from:gx.TIMELINE})}else _&&l(()=>{var M;_e(t,{data:{collectionProperties:{...(M=_.data.collectionProperties)!=null?M:{},...$}}})});w(void 0)}},A=T||v,P=h===Ft.DAY||h===Ft.HOUR;return r.jsxs("div",{"data-disable-select":!0,"data-record-id":t,"data-group-value":n,onMouseMove:j,onMouseLeave:S,onClick:D,className:R("relative flex h-[37px] w-full hover:bg-green-100",!A&&"cursor-pointer",t===Wl&&"h-8"),children:[r.jsx(i3e,{recordId:t,initDateRangeLength:I,movingStartDate:b,relationParentId:a}),u.current&&b&&Ls.createPortal(r.jsx(aq,{startTime:b,unitLength:P?I:I-1}),u.current),A&&r.jsxs(r.Fragment,{children:[r.jsx(o3e,{recordId:t,card:g}),r.jsx(a3e,{recordId:t,card:g})]})]})},El),l3e=({recordIds:e})=>{const{viewId:t}=Ne(),n=Oce(t),s=y.useRef(DT[n]),a=Up({zoomLevel:n,length:s.current}),[o,i]=y.useState(a),l=y.useRef(o),c=y.useRef(null),d=y.useRef(null),u=y.useRef(),f=y.useRef();l.current=o,y.useEffect(()=>{s.current=DT[n],u.current=void 0,f.current=void 0;const p=Up({zoomLevel:n,length:s.current});l.current=p,i(p)},[n]);const h=y.useMemo(()=>({containerWidth:DTe(n,o),zoomLevel:n,timelineDatesRef:l,stepLength:s,timelineDates:o,setTimelineDates:i,container:c,scrollLeft:u,datesContainer:d,draggingRecordId:f}),[n,o]);return r.jsx(sq.Provider,{value:h,children:r.jsx(c3e,{recordIds:e})})},c3e=y.memo(({recordIds:e})=>{var A,P;const{embed:t,readonly:n,viewId:s}=Ne(),{timelineDates:a,setTimelineDates:o,container:i,datesContainer:l,scrollLeft:c,stepLength:d,zoomLevel:u,timelineDatesRef:f}=xo(),h=y.useRef(null),p=y.useRef(null),g=Qa(),_=kg(s),{tableGroups:x}=(A=of(s))!=null?A:{},{withoutValidGroup:F,visibleGroups:b=[],hiddenGroups:w=[]}=x!=null?x:{},E=y.useRef(null),[C,k=[]]=Fa(s,{visible:!0}),T=hr[u];Gg(i),y.useLayoutEffect(()=>{i.current&&(i.current.scrollLeft=kr(Date.now(),a[0],u)*T-i.current.clientWidth/2)},[i,a,T,u]),y.useLayoutEffect(()=>{!i.current||!c.current||(i.current.scrollLeft=c.current,c.current=void 0)},[a,i,c]),y.useEffect(()=>{if(i.current&&i.current.scrollWidth<i.current.clientWidth*2){d.current=Math.ceil(d.current*1.5);const L=Up({zoomLevel:u,length:d.current});o(L),c.current=kr(Date.now(),L[0],u)*T-i.current.clientWidth/2}},[(P=i.current)==null?void 0:P.clientWidth,T,u]),y.useEffect(()=>{if(!i.current||!l.current)return;const L=i.current,O=()=>{if(!(typeof c.current<"u"||!i.current)){if(L.scrollWidth-L.scrollLeft-L.clientWidth<CA){const M=f.current,U=kr(M[d.current],M[0],u)*T;c.current=i.current.scrollLeft-U,o(z=>{const K=An(z),W=zF({zoomLevel:u,base:K,length:d.current,dir:ym.NEXT});return[...z.slice(d.current),...W]})}if(L.scrollLeft<CA){const M=f.current,U=kr(M[M.length-1],M[d.current-1],u)*T;c.current=i.current.scrollLeft+U,o(z=>{const K=z[0];return[...zF({zoomLevel:u,base:K,length:d.current,dir:ym.PREV}),...z.slice(0,z.length-d.current)]})}}},$=_re?qn(O):Ps(O,60);return L.addEventListener("scroll",$),()=>L.removeEventListener("scroll",$)},[i,c,d,l,o,f,u,T]),y.useEffect(()=>{const L=i.current,O=l.current,$=h.current,M=p.current,U=O==null?void 0:O.closest(".next-space-page");if(!L||!O||!$||!M||!U)return;const z=t?uE:gu,K=()=>{const W=L.getBoundingClientRect(),Y=U.getBoundingClientRect();if(W.top<Y.top){let G=Math.abs(Y.top-W.top);W.bottom<Y.top+111&&(G-=Y.top+111-W.bottom),$.style.transform="translate3d(0,".concat(Math.round(G+z),"px,0)"),M.style.transform="translate3d(0,".concat(Math.round(G+z),"px,0)"),O.style.transform="translate3d(0,".concat(Math.round(G+z),"px,0)")}else $.style.transform="none",M.style.transform="none",O.style.transform="none"};return U.addEventListener("scroll",K),window.addEventListener("resize",K),()=>{U.removeEventListener("scroll",K),window.removeEventListener("resize",K)}},[i,l,t]);const v=yr(),[I,j]=y.useState(v==null?void 0:v.current);y.useEffect(()=>{j(v==null?void 0:v.current)},[v]);const S=DL(k.map(L=>oo(L))),D=()=>F?r.jsxs("div",{className:"relative border-r",children:[r.jsx(A1,{isGroup:!1,properties:k}),r.jsx(za,{recordIds:e,disable:!0,children:r.jsx(rS,{embed:t,properties:k})}),r.jsx(aS,{recordIds:e}),!n&&!t&&r.jsx(Di,{type:"collection"}),!t&&r.jsx($p,{readonly:n})]}):r.jsx(tF.Provider,{value:E,children:r.jsxs("div",{className:"relative border-r",children:[I&&r.jsxs(r.Fragment,{children:[ac(b.length)?r.jsx(qs,{style:{width:S},customScrollParent:I,overscan:Dn,increaseViewportBy:Dn,computeItemKey:L=>L,totalCount:b.length,itemContent:L=>{const O=b[L];return O?r.jsx(cu,{tableGroup:O,withoutValidGroup:F,embed:t,properties:k,index:L},O.value):null}}):r.jsx(r.Fragment,{children:b.map((L,O)=>r.jsx(cu,{tableGroup:L,withoutValidGroup:F,embed:t,properties:k,index:O},L.value))}),r.jsx(Qg,{hiddenGroupsLength:w.length,isTimelineTable:!0,hiddenGroups:ac(w.length)?r.jsx(qs,{style:{width:S},customScrollParent:I,overscan:Dn,increaseViewportBy:Dn,computeItemKey:L=>L,totalCount:w.length,itemContent:L=>{const O=w[L];return O?r.jsx(cu,{tableGroup:O,withoutValidGroup:F,embed:t,properties:k},O.value):null}}):r.jsx(r.Fragment,{children:w.map(L=>r.jsx(cu,{tableGroup:L,withoutValidGroup:F,embed:t,properties:k},L.value))})})]}),r.jsx(Ou,{}),!n&&!t&&r.jsx(Di,{type:"collection"}),!t&&r.jsx($p,{readonly:n})]})});return r.jsxs("div",{ref:E,className:R("flex",!t&&(g?"-mx-10 sm:-mx-10":"-mr-24"),!t&&!_&&"-ml-24"),children:[!g&&_&&D(),r.jsxs("div",{className:"relative flex-1 overflow-hidden",children:[r.jsx(n3e,{ref:h}),r.jsxs("div",{ref:i,className:"relative h-full w-full overflow-auto pb-[40px]",children:[r.jsx(e3e,{ref:p}),r.jsx(Zve,{}),r.jsx(t3e,{}),r.jsx(d3e,{recordIds:e})]})]})]})}),d3e=({recordIds:e})=>{var g;const{collectionId:t,viewId:n,readonly:s,managerReadonly:a}=Ne(),o=y.useRef(null),i=kg(n),{containerWidth:l}=xo(),{tableGroups:c}=(g=of(n))!=null?g:{},{withoutValidGroup:d,visibleGroups:u=[],hiddenGroups:f=[]}=c!=null?c:{},h=zm(t);S2();const p=yr();return p.current?r.jsxs("div",{ref:o,className:R("record-line-container relative",i&&!d&&"-translate-y-[75px]"),style:{width:l},children:[d&&r.jsxs(r.Fragment,{children:[r.jsx(qs,{customScrollParent:p.current,overscan:Dn,increaseViewportBy:Dn,computeItemKey:_=>_,totalCount:e.length,itemContent:_=>{const x=e[_];return x?r.jsx(B1,{recordId:x,level:h?0:void 0},x):null}}),i&&e.length===0&&r.jsx("div",{className:"h-[37px]"}),s||a?null:r.jsx(B1,{recordId:Wl,lastRecordId:e[e.length-1],level:h?0:void 0})]}),!d&&r.jsxs(r.Fragment,{children:[ac(u.length)?r.jsx(qs,{customScrollParent:p.current,overscan:Dn,increaseViewportBy:Dn,computeItemKey:_=>_,totalCount:u.length,itemContent:_=>{const x=u[_];return x?r.jsx(vy,{tableGroup:x},x.value):null}}):r.jsx(r.Fragment,{children:u.map(_=>r.jsx(vy,{tableGroup:_},_.value))}),r.jsx(Qg,{hiddenGroupsLength:f.length,hiddenGroups:ac(f.length)?r.jsx(qs,{customScrollParent:p.current,overscan:Dn,increaseViewportBy:Dn,computeItemKey:_=>_,totalCount:f.length,itemContent:_=>{const x=f[_];return x?r.jsx(vy,{tableGroup:x},x.value):null}}):r.jsx(r.Fragment,{children:f.map(_=>r.jsx(vy,{tableGroup:_},_.value))})}),!i&&r.jsx(Ou,{})]})]}):null},vy=y.memo(({tableGroup:e,className:t})=>{const{collectionId:n,viewId:s,readonly:a,managerReadonly:o}=Ne(),{recordIds:i,value:l}=e,c=kg(s),d=ig(s,l),u=zm(n),f=yr();return f.current?c&&!d?r.jsx("div",{className:"h-[57px]"}):r.jsxs("div",{className:R(t,c?"pt-[75px] pb-[57px]":"pb-5"),children:[!c&&r.jsx(kx,{tableGroup:e}),d&&r.jsxs(r.Fragment,{children:[r.jsx(qs,{customScrollParent:f.current,overscan:Dn,increaseViewportBy:Dn,computeItemKey:h=>h,fixedItemHeight:37,totalCount:i.length,itemContent:h=>{const p=i[h];return p?r.jsx(B1,{recordId:p,level:u?0:void 0},p):null}}),c&&i.length===0&&r.jsx("div",{className:"h-[37px]"}),a||o?null:r.jsx(B1,{recordId:Wl,lastRecordId:i[i.length-1],groupName:l,level:u?0:void 0})]})]}):null},yn),u3e=()=>{const{viewId:e,collectionId:t,readonly:n,managerReadonly:s}=Ne(),a=h4(),{tableGroups:o,child2ParentMap:i,parent2ChildMap:l,filteredRecordIdSet:c}=lf(e),d=Ce(({blocks:f,collectionViews:h})=>{var C,k,T;const p=f[t],g=h[e],_=(C=p==null?void 0:p.data.schema)!=null?C:{};if(!g)return;const{timelineBy:x="",timelineByEnd:F=""}=g.format,b={updateTimelineBy:!1,updateTimelineByEnd:!1},w=(k=_[x])==null?void 0:k.type,E=(T=_[F])==null?void 0:T.type;return w!==m.CollectionSchemaType.DATE&&w!==m.CollectionSchemaType.CREATED_AT&&w!==m.CollectionSchemaType.UPDATED_AT&&(b.updateTimelineBy=!0),E!==m.CollectionSchemaType.DATE&&E!==m.CollectionSchemaType.CREATED_AT&&E!==m.CollectionSchemaType.UPDATED_AT&&(b.updateTimelineByEnd=!0),b},[e,t]),u=y.useMemo(()=>({child2ParentMap:i,parent2ChildMap:l,filteredRecordIdSet:c}),[i,c,l]);return y.useEffect(()=>{n||s||d&&(d.updateTimelineBy||d.updateTimelineByEnd)&&a(e)},[a,s,d,n,e]),y.useEffect(()=>{o&&o.needUpdateGroups&&Rt(e,{collectionGroups:o.newViewGroups})},[o,e]),!d||o!=null&&o.needUpdateGroups?null:d.updateTimelineBy||d.updateTimelineByEnd?n||s?r.jsx("div",{className:"text-t2 h-[35px] flex items-center pl-2",children:"当前视图无有效日期属性，无法展示"}):null:o!=null&&o.sortedRecordIds?r.jsx(wm.Provider,{value:u,children:r.jsx(l3e,{recordIds:o.sortedRecordIds})}):null},iq=e=>{const t=We(e);y.useEffect(()=>{if(t)return;const n=J.blocks[e];if(!n)return;const s=n.subNodes.filter(a=>{const o=J.blocks[a];return o&&o.type!==m.BlockType.PAGE});s.length>0&&hn(()=>{s.forEach(a=>{const{role:o}=mn(a);o===m.PermissionRole.EDITOR&&_e(a,{type:m.BlockType.PAGE})})})},[e,t])},iS=(e,t=!1)=>{const n="viewId:".concat(e),s=Ce(({blocks:l,collectionViews:c})=>{var d,u;return(u=(d=l[e])==null?void 0:d.views)==null?void 0:u.filter(f=>{const h=c[f];return h&&h.status!==-1})},[e],{useRedux:!0}),a=y.useCallback(()=>{var u;const l=location.hash.slice(1).trim(),c=(u=localStorage.getItem(n))==null?void 0:u.trim();let d="";if(t?d=c!=null?c:"":l?d=l:d=c!=null?c:"",!(d&&(s!=null&&s.includes(d)))){const f=s==null?void 0:s[0];f&&(d=f)}return s!=null&&s.includes(d)?d:""},[t,n,s]),[o,i]=y.useState(()=>a());return y.useEffect(()=>{ts(n,o),t||history.replaceState(null,"","#".concat(o));const l=a();l!==o&&i(l)},[t,a,n,o]),[o,i]},lq=e=>{const t=Hj();y.useEffect(()=>{if(e)return t.subscribeCollectionView(e,async()=>{const n=await ve.editor.getCollectionView(e);Rs(e,n,!0)})},[e,t])};let cq;const f3e=e=>{cq=e},dq=y.memo(({uuid:e,children:t})=>{const n=y.useRef(null),s=y.useRef(null),a=Ce(({blocks:b})=>{var C,k;let w=e;const E=b[e];return((E==null?void 0:E.type)===m.BlockType.REFERENCE_COLLECTION||(E==null?void 0:E.type)===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(w=(k=(C=E.data.ref)==null?void 0:C.uuid)!=null?k:""),w},[e]),o=Tl(e),i=We(a,!1),l=We(e,!1),[c,d]=iS(e),u=yx();lq(c),U5(e,n),iq(a);const f=Ce(({collectionViews:b})=>{var w;return(w=b[c!=null?c:""])==null?void 0:w.type},[c]),h=uq(f),{fontStyle:p}=T2(e),g=f&&![m.CollectionViewType.TIMELINE].includes(f);Gg(n,{enable:g});const _=Ce(b=>{var w,E,C;return(C=(E=(w=b.blocks[a])==null?void 0:w.data.format)==null?void 0:E.commentAlignment)!=null?C:"top"},[a]),x=F8(c);y.useEffect(()=>{if(!i&&!c){const b=u(e,"表格",m.CollectionViewType.TABLE);b&&d(b)}},[u,i,c,e,d]);const F=y.useMemo(()=>({tableCellWrap:x,collectionId:a,viewParentId:e,viewType:f,viewId:c!=null?c:"",readonly:i,managerReadonly:l,isLocked:o,changeView:d,pageManager:s}),[a,o,l,i,d,x,e,c,f]);return!a||!c?null:r.jsx(rd.Provider,{value:F,children:r.jsx(Oo,{children:r.jsx("div",{className:R("overflow-auto next-space-page will-change-scroll",ot.print?"overflow-x-hidden":"relative flex flex-col flex-1"),ref:n,"data-page-id":e,onScroll:()=>xn.emit("removeHoverMenu"),style:p,children:r.jsxs(Ec.Provider,{value:n,children:[r.jsx(K4,{uuid:e,className:"md:px-12 px-24 sticky left-0"}),r.jsx(cq,{className:"md:px-12 px-24 left-0 mt-5 sticky top-[-1px] z-50"}),r.jsx("div",{className:"relative flex-1 md:px-12 px-24",children:r.jsx("article",{className:"block-content",children:r.jsx(h,{scrollRef:n})})}),_==="bottom"&&r.jsx("div",{className:"sticky left-0 px-24 md:px-12",children:r.jsx(y2,{pageId:a,isBottom:!0})}),r.jsx("div",{hidden:i,className:"sticky left-0 px-24 md:px-12 my-24",children:r.jsx(k4,{uuid:e})}),r.jsx(v4,{}),t,i&&r.jsx("div",{className:"sticky left-0",children:r.jsx(k2,{})})]})})})})}),uq=e=>{if(ot.print)return ok;switch(e){case m.CollectionViewType.TABLE:return ok;case m.CollectionViewType.BOARD:return vTe;case m.CollectionViewType.GALLERY:return qve;case m.CollectionViewType.LIST:return Wve;case m.CollectionViewType.TIMELINE:return u3e;case m.CollectionViewType.CALENDAR:return tve;case m.CollectionViewType.FORM:return Lve;default:return ok}},fq=({uuid:e})=>{const t=ye(e,[]),{illegal:n}=mt(e);if(n)return r.jsx(L0,{uuid:e});let s=null;switch(t==null?void 0:t.type){case m.BlockType.PAGE:{s=r.jsx(PF,{uuid:e});break}case m.BlockType.REFERENCE_COLLECTION:case m.BlockType.REFERENCE_COLLECTION_PAGE:case m.BlockType.COLLECTION_VIEW:case m.BlockType.COLLECTION_VIEW_PAGE:{s=r.jsx(dq,{uuid:e});break}case m.BlockType.FOLDER:{s=r.jsx(UH,{uuid:e});break}case m.BlockType.MIND_MAPPING:case m.BlockType.MIND_MAPPING_PAGE:{s=r.jsx(hz,{uuid:e});break}case m.BlockType.CHART_PAGRE:case m.BlockType.CHART:{s=r.jsx(TH,{uuid:e});break}default:e?s=r.jsx(Fg,{showBackButton:!1}):s=r.jsx(PF,{uuid:e});break}return s},m3e=({id:e,root:t})=>pt()?null:r.jsx(wn,{id:e,className:"py-1 my-px w-full pr-2",horizontal:t,children:r.jsx(vc,{readonly:!0,onClick:()=>{},iconProp:{name:"IcUploadBookmark",size:"normal"},text:"广告块(需开启分享，且仅在android端的微信/qq浏览器内展示)",className:"cursor-default"})}),h3e=e=>{const{visible:t,placeholder:n,children:s}=e;return t?r.jsx(r.Fragment,{children:s}):r.jsx(r.Fragment,{children:n})},p3e=({id:e,root:t})=>{var u;const n=Ks(),s=ye(e,["data","local"],["link","icon","description","cover","linkInfo","headers"]),a=Oe(),o=We(e),[i,l]=yc();Ld({uuid:e}),y.useEffect(()=>{!(s!=null&&s.data.link)||!i||Vu(s.data.link).then(f=>{if(!f)return;const h={link:f.link,linkInfo:ht(f.title),cover:f.cover,icon:{type:"http",value:f.icon},description:ht(f.description)};o?_e(s.uuid,{data:{...s.data,...h}},!0):a(()=>{_e(s.uuid,{data:h})})})},[s,o,a,i]);const{title:c,description:d}=y.useMemo(()=>({title:fe(s==null?void 0:s.data.linkInfo),description:fe(s==null?void 0:s.data.description)}),[s==null?void 0:s.data.description,s==null?void 0:s.data.linkInfo]);return s?r.jsxs("div",{className:"relative","data-block-id":e,"data-horizontal":t,"data-sync-id":n,ref:l,children:[r.jsx(h3e,{visible:!s.data.link||i,placeholder:r.jsxs("div",{className:"h-[89px] my-1 text-t4 text-grey3",children:[r.jsx("p",{children:c}),r.jsx("p",{children:d}),r.jsx("p",{children:s.data.link})]}),children:r.jsx(wn,{id:e,className:"my-1 rounded line-default",horizontal:t,children:r.jsx(ZH,{readonly:o,title:c,cover:s.data.cover,description:d,icon:(u=s.data.icon)==null?void 0:u.value,url:s.data.link,onUrlInput:f=>{Vu(f).then(h=>{a(()=>{var p;_e(s.uuid,{data:{link:(p=h==null?void 0:h.link)!=null?p:f,linkInfo:ht(h==null?void 0:h.title),cover:h==null?void 0:h.cover,icon:{type:"http",value:h==null?void 0:h.icon},description:ht(h==null?void 0:h.description),headers:h==null?void 0:h.headerMap}})})})},defaultOpenInputPanel:!!s.local,loading:!1})})}),r.jsx(ei,{blockId:e})]}):null},g3e=({children:e})=>r.jsx(r.Fragment,{children:e}),mP=46,_3e=70,x3e=fn.memo(e=>{ye(e.id,["subNodes"]);const t=Ho(),n=rg(),s=y.Children.toArray(e.children),a=Oe(),o=We(e.id),i=Ln(),l=T4(),c=Ce(_=>{const x=_.blocks[e.id];if(!x)return[];const F=[];return x.subNodes.forEach(b=>{const w=_.blocks[b];if(w){const E=u5(w,["data"],["columnRatio"]);E&&F.push(E)}}),F},[e.id]),[d,u]=y.useMemo(()=>{const _=[];let x=0;return c.forEach(F=>{const b=F.data.columnRatio||1/c.length;x+=b,_.push(b)}),[x,_]},[c]),f=(_,x)=>{var O,$,M,U;const F=bn(".column-list-".concat(e.id),i);if(!F)return;const b=z=>{let K=_3e;const W=z.querySelectorAll("[data-column-item-min-width]");for(const Y of W)if(Y instanceof HTMLElement&&Y.dataset.columnItemMinWidth){const G=parseFloat(Y.dataset.columnItemMinWidth);G>K&&(K=G)}return K},w=[],E=[];F.childNodes.forEach(z=>{z instanceof Element&&z.classList.contains("column-block")&&(w.push(z),E.push(b(z)))});const C=F.getBoundingClientRect().width-mP*(w.length-1),k=w[_],T=(O=E[_])!=null?O:0,v=($=c[_])==null?void 0:$.uuid,I=w[_+1],j=(M=E[_+1])!=null?M:0,S=(U=c[_+1])==null?void 0:U.uuid;if(!k||!v||!I||!S)return;const D=parseFloat(getComputedStyle(k).width)+x.deltaX,A=parseFloat(getComputedStyle(I).width)-x.deltaX;if(D<T||A<j)return;const P=D/C*c.length,L=A/C*c.length;switch(x.resizeStatus){case aa.START:{st({$columnResizing:!0});break}case aa.RESIZING:{Ls.unstable_batchedUpdates(()=>{_e(v,{data:{columnRatio:P}},!0),_e(S,{data:{columnRatio:L}},!0)});break}case aa.END:{st({$columnResizing:!1}),a(()=>{_e(v,{data:{columnRatio:P}}),_e(S,{data:{columnRatio:L}})});break}}},h=Qa(),p=Ce(({blocks:_})=>{var F,b;const x=(F=_[e.id])==null?void 0:F.subNodes;return Math.max(...(b=x==null?void 0:x.map(w=>{var E;return((E=_[w])==null?void 0:E.subNodes.length)||0}))!=null?b:[])},[e.id],{wait:0}),g=s.flatMap((_,x,F)=>{var T;if(!y.isValidElement(_))return null;const b=(T=u[x])!=null?T:1,w={width:h?"100%":"calc((100% - ".concat((s.length-1)*mP,"px) * ").concat(b/d,")")},E=_.props.id,C=r.jsxs("div",{className:"flex flex-col column-block my-[0.5px]",style:w,children:[_,r.jsx("div",{className:"flex-1",onClick:()=>{var I,j;if(o)return;((j=(I=J.blocks[E])==null?void 0:I.subNodes.length)!=null?j:0)<p&&l(E)}})]},E),k=r.jsx(ik,{readonly:o,className:"col-drop relative w-[46px]",position:"right",id:E,supportResize:!t&&!n,onResize:v=>{f(x,v)}},"".concat(E,"-right"));return t?x===0?[r.jsx(ik,{readonly:o,className:"absolute w-20 inset-y-2 -left-20",position:"left",id:E},"".concat(E,"-left")),C,k]:x===F.length-1?[C,r.jsx(ik,{readonly:o,className:"absolute w-20 inset-y-2 -right-20",position:"right",id:E},"".concat(E,"-right"))]:[C,k]:x===F.length-1?C:[C,k]});return r.jsx(wn,{horizontal:!0,hideHoverMenu:!0,"data-column-list":!0,id:e.id,className:R("flex py-1.5 column-list-".concat(e.id),h?"flex-col":""),children:g})}),ik=({id:e,position:t,className:n,supportResize:s,onResize:a,readonly:o})=>{var f,h,p,g;const i=y.useRef(null),l=y.useRef(null),c=une(e),{height:d=0}=bl(l,"height"),u="-".concat((d-((h=(f=i.current)==null?void 0:f.clientHeight)!=null?h:0))*.5,"px");return qg(l,{onResize:_=>{var x,F,b;_.resizeStatus===aa.START?((x=l.current)==null||x.setAttribute("style","opacity:1;top: ".concat(u)),document.body.classList.add("select-none")):_.resizeStatus===aa.END&&((F=l.current)==null||F.removeAttribute("style"),(b=l.current)==null||b.setAttribute("style","top: ".concat(u)),document.body.classList.remove("select-none")),a==null||a(_)},type:"x"}),r.jsxs("div",{"data-column-id":e,ref:i,className:n,children:[c===t&&r.jsx("div",{"data-disable-select":!0,className:R("absolute bg-black/30 h-full w-1",t==="left"?"right-2":"left-2")}),!o&&r.jsx("div",{ref:l,className:R("absolute flex justify-center w-[46px] min-h-[56px] h-full cursor-[col-resize] opacity-0 transition-opacity hover:opacity-100",{hidden:!s||c}),style:{top:"-".concat((d-((g=(p=i.current)==null?void 0:p.clientHeight)!=null?g:0))*.5,"px")},children:r.jsx("div",{className:"bg-black/30 h-full w-1 left-[calc(50%-2px)]"})})]})},y3e=({id:e,root:t,children:n})=>r.jsxs(r.Fragment,{children:[r.jsx(wn,{id:e,horizontal:t,children:r.jsx("div",{className:"flex items-center h-5 leading-5",children:r.jsx("div",{className:"h-px w-full bg-grey6"})})}),n]}),lS=({uuid:e,url:t})=>{const n=t||"".concat(_n(),"/preview/").concat(e);return r.jsxs(r.Fragment,{children:[r.jsx("a",{href:n,className:"block my-2 break-words border w-full underline rounded p-8",children:n}),r.jsx(ei,{blockId:e})]})},b3e=({id:e,root:t})=>{const n=ye(e,["data","local"],["link"]);if(!n)return null;const s=ot.print;return n.data.link&&!n.local?s?r.jsx(lS,{uuid:e,url:n.data.link}):r.jsx(w3e,{id:e,root:t}):r.jsx(F3e,{id:e,root:t})},F3e=e=>{var h;const t=ye(e.id,["local","data"],["link","embedType"]),n=ie(),[s,a]=y.useState(!1),o=y.useRef(""),i=Oe(),l=We(e.id),c=t==null?void 0:t.data.embedType,d=c?(h=aj()[c])==null?void 0:h.data:null;Ld({uuid:e.id,callback:()=>(t==null?void 0:t.data.link)&&void u(t.data.link)}),y.useEffect(()=>{t&&t.local&&t.data.link&&u(t.data.link)},[]);const u=y.useCallback(async p=>{if(!p.trim())return;a(!0);const g=await Vu(p,!0);i(()=>{var _;if(g!=null&&g.isDone||((_=g==null?void 0:g.headerMap)==null?void 0:_["X-Frame-Options"])!==void 0&&(g.headerMap["X-Frame-Options"].toLocaleLowerCase()==="allow"||g.headerMap["X-Frame-Options"]==="")&&g.link.match(/(https):\/\/([\w.]+\/?)\S*/gi)&&!mV(g.link)){_e(e.id,{data:{link:p}});return}_e(e.id,{type:m.BlockType.BOOKMARK,data:{link:p,linkInfo:ht(g==null?void 0:g.title),cover:g==null?void 0:g.cover,icon:{type:"http",value:g==null?void 0:g.icon},description:ht(g==null?void 0:g.description),headers:g==null?void 0:g.headerMap}})}),a(!1)},[e.id,i]),f=y.useCallback(p=>{s||n.dropdown({popcorn:p.currentTarget,placement:"bottom",content:({onCloseModal:g})=>r.jsxs("div",{className:"flex flex-col w-[370px] next-modal px-2.5 py-3.5",children:[r.jsx(Ct,{autoFocus:!0,className:"h-8 rounded-sm",placeholder:d?d.placeholder:"https://www.example.com",onChange:_=>o.current=_,onEnter:()=>{u(o.current),g()}}),r.jsx(De,{size:"large",colorType:"active",className:"mt-3.5 text-t4-medium",onClick:()=>{u(o.current),g()},children:"提交"})]})})},[d,s,n,u]);return r.jsx(wn,{id:e.id,horizontal:e.root,className:"my-1 print:hidden",children:r.jsx(vc,{readonly:l,iconElement:d&&r.jsx("img",{src:d.image,className:"w-6 h-6"}),defaultOpenPanel:!!(t!=null&&t.local&&!t.data.link),iconProp:{name:"IcGlobeShare",size:"normal"},text:s?"正在嵌入内容...":d?"嵌入".concat(d.title):"添加嵌入内容",onClick:f,className:l?"cursor-default":"cursor-pointer"})})},w3e=({id:e,root:t})=>{const[n,s]=y.useState(!1),[a,o]=y.useState(!1),i=Qa(),l=y.useRef(setTimeout(()=>{})),c=ye(e,["data"],["link"]),d=We(e),[u,f,h]=yc(),[p,g]=y.useState(""),_=y.useMemo(async()=>{const{website:A,link:P}=await g3(p);return A?A===$r.music163&&P.includes("?type=2")?{resizeHeight:!1,defaultHeight:86}:{}:{}},[p]),{renderSize:x,onRenderSize:F,changeSize:b,containerWidth:w,containerRef:E,isDisable:C,defaultWidth:k,defaultHeight:T,defaultBlockFullWidth:v,widthBreakPoints:I}=Nc({id:e,defaultWidth:500,defaultHeight:400,root:t});y.useEffect(()=>{var A;u&&!p&&Vu((A=c==null?void 0:c.data.link)!=null?A:"",!0).then(P=>{g((P==null?void 0:P.link)||(c==null?void 0:c.data.link)||"")})},[c==null?void 0:c.data.link,p,u]);const j=y.useCallback(()=>{var A;Xt((A=c==null?void 0:c.data.link)!=null?A:"")},[c==null?void 0:c.data.link]),S=y.useCallback(()=>{var A;(A=h.current)==null||A.requestFullscreen()},[h]),D=y.useCallback(()=>{g(""),s(!0),o(!1),es(1e3).then(()=>{g(p)})},[p]);return c?r.jsxs(wn,{blockRef:E,id:e,horizontal:t,fullWidth:!t||i,className:"my-2.5 self-center",children:[r.jsxs(Ic,{resizeHeight:!0,widthBreakPoints:I,readonly:d,doubleResize:t,defaultWidth:k||uo,defaultHeight:T,defaultBlockFullWidth:v,maxWidth:w,minHeight:80,onChange:b,onRenderSize:F,..._,children:[a&&!n&&r.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-full cursor-pointer bg-grey8",onClick:D,children:[r.jsx(na,{emojiStr:"🕸️",iconSize:70,className:"mb-2 pointer-events-none"}),r.jsx("div",{className:"text-grey4 text-t2",children:"网页加载失败，点击刷新"})]}),!a&&n&&r.jsx(xs,{}),r.jsxs("div",{className:"w-full h-full",children:[r.jsx(B4,{renderList:[{icon:"IcMenuOpen",title:"全屏查看",click:S},{icon:"IcLink",title:"复制链接",click:j}]}),r.jsx("div",{className:"relative w-full h-full overflow-hidden",children:r.jsx("iframe",{referrerPolicy:"origin",allowFullScreen:!0,className:R("w-full h-full absolute inset-0",C&&"pointer-events-none",{hidden:a}),ref:f,src:p,sandbox:"allow-scripts allow-popups allow-top-navigation-by-user-activation allow-forms allow-same-origin",onLoad:()=>{clearTimeout(l.current),o(!1),s(!1)}})})]})]}),r.jsx(ei,{blockId:e,style:{width:x.width}})]}):null},mq=()=>{const e=Ui(),t=ie();return(n,s,a=!1)=>{const o=()=>{e({popcorn:s,blockId:n,from:ho.ContextMenu,isBitable:!0,editorScene:it.BlockSelected,isDescription:a})};localStorage.getItem(S8)?o():t.modal({closeAfterCallBack:()=>{o()},content:({onCloseModal:i})=>r.jsx(E3e,{closeSelf:i,openEditor:o})})}},E3e=({closeSelf:e,openEditor:t})=>{const[n,s]=y.useState(!1);return r.jsxs("div",{className:"px-7 py-6",children:[r.jsxs("p",{className:"mb-2.5 w-60 text-t1-medium text-center",children:[Na," 辅助功能目前仅针对当前视图进行数据处理"]}),r.jsxs("div",{className:"flex items-center cursor-pointer text-t2 justify-center",onClick:()=>s(!n),children:[r.jsx(V,{name:n?"IcCheckboxCheck":"IcCheckbox",size:"large",className:n?"text-active_color":""}),"不再提示"]}),r.jsx(De,{className:"h-8 flex items-center mt-8 w-full justify-center",colorType:"active",autoFocus:!0,onClick:()=>{e(),n&&ts(S8,JSON.stringify(!0)),t()},children:"知道了"})]})},cS=e=>{const{uuid:t}=e,n=Oe(),{role:s}=mt(t),a=ft(t,l=>{var c;return(c=l==null?void 0:l.data.format)==null?void 0:c.locked}),[o,i]=y.useState(!1);return y.useEffect(()=>{t&&i(!1)},[t]),s===m.PermissionRole.READER?null:a?r.jsx(k3e,{uuid:t,onClick:()=>{me.event("page_lock",{is_open:!1}),n(()=>{_e(t,{data:{format:{locked:!1,lockedBy:yt.uuid}}})}),o||i(!0)}}):o?r.jsx(T3e,{uuid:t,onClick:()=>{me.event("page_lock",{is_open:!0}),n(()=>{_e(t,{data:{format:{locked:!0,lockedBy:yt.uuid}}})}),i(!1)}}):null},C3e=fn.memo(e=>{const t=ft(e.uuid,s=>{var a;return(a=s==null?void 0:s.data.format)==null?void 0:a.lockedBy}),n=_r(t!=null?t:"","");return r.jsxs("div",{className:"flex rounded px-2 py-1 flex-col items-center",children:[n?r.jsx("div",{children:"已被".concat(n,"锁定")}):r.jsx("div",{children:"页面已被锁定"}),r.jsx("div",{children:"点击解锁"})]})}),k3e=e=>r.jsx(Fe,{popup:r.jsx(C3e,{uuid:e.uuid}),children:r.jsxs("div",{className:"cursor-pointer flex hover:animate-hover py-1 px-2 items-center rounded h-7.5 text-ellipsis",...e,children:[r.jsx(V,{size:"normal",name:"IcLock",style:{color:"var(--grey4)"}}),r.jsx("div",{className:"text-t2 text-grey4 ml-0.5 sm:hidden",children:"已锁定"})]})}),T3e=e=>r.jsx(Fe,{popup:"点击重新锁定页面",children:r.jsxs("div",{className:"cursor-pointer flex border-active_color border hover:opacity-90 py-1 px-2 items-center rounded h-7.5 text-ellipsis",...e,children:[r.jsx(V,{size:"normal",name:"IcUnlock",style:{color:Do.active_color}}),r.jsx("div",{className:"text-t2 text-active_color ml-0.5 sm:hidden",children:"重新锁定"})]})}),Av=({className:e})=>{const t=y.useRef(),{viewId:n}=Ne(),s=og(n),[a,o]=y.useState(""),[i,l]=y.useState(!1),c=y.useCallback(_=>{const x=xt.$collectionSearch;st({$collectionSearch:{...x,[n]:_}})},[n]);y.useEffect(()=>()=>c(void 0),[c]);const{run:d}=Zv(c,{wait:500}),u=y.useCallback(_=>{o(_),d(_)},[d]),f=_=>{_.stopPropagation(),l(!1),o(""),c(void 0)},h=_=>{Ie("esc")(_)&&(l(!1),o(""),c(void 0))},p=()=>{l(!1),a===""&&c(void 0)},g=s!==void 0||i;return r.jsxs("div",{className:R("relative flex items-center",e),onClick:_=>{var F;if(_.stopPropagation(),i){(F=t.current)==null||F.blur();return}const x=setTimeout(()=>{var b;(b=t.current)==null||b.focus(),c(""),o(""),clearTimeout(x)});l(!0)},children:[r.jsx("div",{className:"animate-hover flex p-1 items-center justify-center rounded text-grey3",children:r.jsx(V,{size:"middle",name:"IcSearch"})}),r.jsx(Ct,{type:"text",showBorder:!1,inputRef:t,onBlur:p,className:"border-none !bg-transparent transition-all duration-200 focus:border-0",inputClassName:"px-0 focus:border-none",style:{width:g?160:0},value:a,onChange:u,onKeyDown:h}),g&&r.jsx(V,{size:"small",className:R("animate-hover cursor-pointer text-grey4",a?"opacity-100":"opacity-0"),name:"IcUploadCancel",onClick:f})]})},dS=()=>{const{viewId:e,collectionId:t}=Ne();return Ce(({blocks:s,collectionViews:a})=>{var l;const o=a[e];if(!o||o.type!==m.CollectionViewType.CALENDAR)return;const i=(l=s[t])==null?void 0:l.subNodes;if(i)return i.filter(c=>{var g,_;const d=s[c];if((d==null?void 0:d.type)!==m.BlockType.PAGE)return!1;const u=(g=o.format.calendarBy)!=null?g:"",f=(_=o.format.calendarByEnd)!=null?_:"",h=hd(d,u),p=hd(d,f);return!h&&!p})},[e,t])},hq=({closeModal:e,popper:t})=>{var d;const{viewId:n}=Ne(),s=Oe(),a=dS(),o=Hm(),i=(()=>{if(!a)return[];const{blocks:u}=pe();return a.map(f=>{const h=u[f];return{type:H.SEARCH,data:{uuid:f,title:fe(h==null?void 0:h.data.segments)||qt(m.BlockType.PAGE),icon:h==null?void 0:h.data.icon,type:m.BlockType.PAGE,renderRight:()=>r.jsx("div",{className:"text-t2 animate-hover p-1",onClick:p=>{p.stopPropagation(),o(f);const g=setTimeout(()=>{var _;(_=t==null?void 0:t.current)==null||_.forceUpdate(),clearTimeout(g)},300)},children:"查看"})}}})})(),l=u=>{const{uuid:f}=u.data,h=gn(n);if(!h)return;const{calendarBy:p,calendarByEnd:g}=h;if(!p||!g)return;const{blocks:_}=pe(),x=_[f];if(!x)return;(a==null?void 0:a.length)===1&&e();const F=setTimeout(()=>{clearTimeout(F),s(()=>{_e(f,{data:{collectionProperties:{...x.data.collectionProperties,[p]:[Gn({from:new Date})],[g]:[Gn({from:new Date})]}}})})},300)},c=new Date;return r.jsxs("div",{className:"w-[400px] next-modal py-[5px]",children:[r.jsx("div",{className:"h-10 px-4 flex justify-between items-center",children:r.jsxs("div",{className:"flex items-center text-t2",children:[r.jsx(V,{className:"mr-1",name:Ga[m.CollectionViewType.CALENDAR],size:"middle"}),r.jsxs("span",{className:"mr-2",children:[(d=a==null?void 0:a.length)!=null?d:0," 条记录没有填写日期时间"]})]})}),r.jsxs("div",{className:"h-10 px-4 flex items-center text-grey3 text-sm",children:["点击将以下记录添加到日历"," (",ue(c).format("MM月DD日"),")"]}),r.jsx(ze,{items:i,onItemClick:u=>l(u)})]})},v3e=()=>{const{viewId:e,viewParentId:t,isLocked:n}=Ne(),s=ie(),a=Oe(),o=Ce(({collectionViews:c})=>{var d;return(d=c[e])==null?void 0:d.type},[e]),l=[...pq(),{type:H.OPERATION,data:{icon:n?"IcUnlock":"IcLock",title:n?"解锁多维表":"锁定多维表",tip:"锁定时，无法新增/修改多维表的配置、视图和属性，但可以新增/编辑记录。",onClick:()=>{a(()=>{_e(t,{data:{format:{locked:!n,lockedBy:yt.uuid}}})})}}},{type:H.LINE},{type:H.OPERATION,data:{title:"属性",icon:"IcGeneralSetting",onClick(c){s.dropdown({popcorn:c.currentTarget,placement:"left",content(){return r.jsx(eS,{})}})}}},{type:H.OPERATION,isHidden:o===m.CollectionViewType.FORM,data:{title:"筛选",icon:"IcFilter",onClick(c){s.dropdown({popcorn:c.currentTarget,placement:"left",content(){return r.jsx(Ug,{})}})}}},{type:H.OPERATION,isHidden:o===m.CollectionViewType.FORM,data:{title:"排序",icon:"IcDescending",onClick(c){s.dropdown({popcorn:c.currentTarget,placement:"left",content(){return r.jsx(Vg,{})}})}}},{type:H.OPERATION,isHidden:o===m.CollectionViewType.CALENDAR||o===m.CollectionViewType.FORM,data:{title:"分组",icon:"IcBoard",onClick(c){s.dropdown({popcorn:c.currentTarget,placement:"left",content(){return r.jsx(qu,{})}})}}},{type:H.OPERATION,isHidden:o!==m.CollectionViewType.BOARD,data:{title:"子分组",icon:"IcSubGroup",onClick(c){s.dropdown({popcorn:c.currentTarget,placement:"left",content(){return r.jsx(qu,{isSubGroup:!0})}})}}},{type:H.LINE,isHidden:o===m.CollectionViewType.FORM},{type:H.OPERATION,isHidden:o===m.CollectionViewType.FORM,data:{title:"复制访问链接",icon:"IcLink",onClick(){Xt("".concat(_n(),"/").concat(t,"#").concat(e))}}}];return r.jsx("div",{className:"w-[200px] py-2 next-modal",children:r.jsx(ze,{items:l,customFooter:r.jsx(ul,{beforeIcon:!0,linkContainer:!0,link:_i.bitableLink,className:"text-t4 text-grey3 items-center h-10 mx-4 mt-1 border-t border-grey6 w-full",children:"了解如何使用多维表"})})})},I3e=()=>{var F,b,w;const{viewId:e,viewParentId:t,isLocked:n,tableCellWrap:s}=Ne(),a=ye(t,["data"],["ref"]),o=ns(),i=ie(),l=Oe(),c=dS(),d=go(t),u=jg(),f=Ce(({collectionViews:E})=>{var C;return(C=E[e])==null?void 0:C.type},[e]),{role:h}=mt((b=(F=J.blocks[t])==null?void 0:F.parentId)!=null?b:""),p=Mw(t),g=pq(),_=E=>{i.dropdown({popcorn:E.currentTarget,placement:"left",content({onCloseModal:C}){var j,S;const{blocks:k}=J,T=k[t],v=ks(t);if(!T)return null;const I=((S=(j=k[T.spaceId])==null?void 0:j.subNodes)!=null?S:[]).map(D=>{if(D===v||D===t)return;const A=k[D];if(A&&!(A.type!==m.BlockType.PAGE&&A.type!==m.BlockType.COLLECTION_VIEW_PAGE&&A.type!==m.BlockType.COLLECTION_VIEW))return fg(A)}).filter(D=>!!D);return r.jsx(oc,{onSelect:async D=>{C(),l(()=>il([t],{parentId:D.uuid,last:!0}))},defaultValue:I,searchType:"page",source:"move"})}})},x=[{type:H.OPERATION,isHidden:h===m.PermissionRole.READER,data:{title:"删除",icon:"IcTrash",onClick(){l(()=>{Ro(t)})}}},{type:H.OPERATION,isHidden:f===m.CollectionViewType.FORM,data:{title:"复制访问链接",icon:"IcLink",onClick:()=>{Xt("".concat(_n(),"/").concat(t,"#").concat(e))}}},{type:H.OPERATION,isHidden:f===m.CollectionViewType.FORM||!(a!=null&&a.data.ref),data:{title:"复制原表访问链接",icon:"IcLink",onClick:()=>{Xt("".concat(_n(),"/").concat(a==null?void 0:a.data.ref))}}},{type:H.OPERATION,isHidden:h===m.PermissionRole.READER,data:{title:"拷贝副本",icon:"IcDuplicate",onClick:()=>{u([t])}}},{type:H.OPERATION,isHidden:!p,data:{title:"移动到",icon:"IcMove",onClick:_,disableAutoClose:!0}},{type:H.OPERATION,data:{title:"以页面打开",icon:"IcFullScreen2",onClick:()=>{o.push(d)}}},{type:H.OPERATION,data:{icon:n?"IcUnlock":"IcLock",title:n?"解锁多维表":"锁定多维表",tip:"锁定时，无法新增/修改多维表的配置、视图和属性，但可以新增/编辑记录。",disableAutoClose:!0,onClick:()=>{l(()=>{_e(t,{data:{format:{locked:!n,lockedBy:yt.uuid}}})})}}},{type:H.LINE},{type:H.OPERATION,isHidden:h===m.PermissionRole.READER,data:{title:"转换为页面",icon:"IcTurnInto",onClick:()=>{l(()=>{_e(t,{type:(a==null?void 0:a.type)===m.BlockType.COLLECTION_VIEW?m.BlockType.COLLECTION_VIEW_PAGE:m.BlockType.REFERENCE_COLLECTION_PAGE})})}}},{type:H.LINE},...g,{type:H.OPERATION,data:{title:"属性",icon:"IcGeneralSetting",disableAutoClose:!0,onClick(E){i.dropdown({popcorn:E.currentTarget,placement:"left",content(){return r.jsx(eS,{})}})}}},{type:H.OPERATION,isHidden:f&&[m.CollectionViewType.FORM].includes(f),data:{title:"筛选",icon:"IcFilter",disableAutoClose:!0,onClick(E){i.dropdown({popcorn:E.currentTarget,placement:"left",content(){return r.jsx(Ug,{})}})}}},{type:H.OPERATION,isHidden:f&&[m.CollectionViewType.FORM].includes(f),data:{title:"排序",icon:"IcDescending",disableAutoClose:!0,onClick(E){i.dropdown({popcorn:E.currentTarget,placement:"left",content(){return r.jsx(Vg,{})}})}}},{type:H.OPERATION,isHidden:(c==null?void 0:c.length)===0||f!==m.CollectionViewType.CALENDAR,data:{title:"无时间记录(".concat((w=c==null?void 0:c.length)!=null?w:0,")"),icon:"IcTitleNodate",disableAutoClose:!0,onClick(E){i.dropdown({popcorn:E.currentTarget,placement:"left",content:({onCloseModal:C,popper:k})=>r.jsx(hq,{closeModal:C,popper:k})})}}},{type:H.OPERATION,isHidden:f&&[m.CollectionViewType.CALENDAR,m.CollectionViewType.FORM].includes(f),data:{title:"分组",icon:"IcBoard",disableAutoClose:!0,onClick:E=>{i.dropdown({popcorn:E.currentTarget,placement:"left",content(){return r.jsx(qu,{})}})}}},{type:H.OPERATION,isHidden:f&&f!==m.CollectionViewType.BOARD,data:{title:"子分组",icon:"IcSubGroup",disableAutoClose:!0,onClick:E=>{i.dropdown({popcorn:E.currentTarget,placement:"left",content(){return r.jsx(qu,{isSubGroup:!0})}})}}},{type:H.LINE,isHidden:!f||![m.CollectionViewType.TABLE,m.CollectionViewType.BOARD,m.CollectionViewType.GALLERY].includes(f)},{type:H.TEXT_SWITCH,isHidden:!f||![m.CollectionViewType.TABLE,m.CollectionViewType.BOARD,m.CollectionViewType.GALLERY].includes(f),data:{title:"自适应行高",disabled:n,switch:s,disableAutoClose:!0,onSwitch:E=>{n||Rt(e,{tableWrap:E})}}}];return r.jsx("div",{className:"w-[200px] py-2 next-modal-scroll",children:r.jsx(ze,{items:x,onItemClick:E=>{E.data.disableAutoClose||i.closeModal(Ve.BITABLE_OPTION_MENU)},customFooter:r.jsx(ul,{beforeIcon:!0,linkContainer:!0,link:_i.bitableLink,className:"text-t4 text-grey3 items-center h-10 mx-4 mt-1 border-t border-grey6 w-full",children:"了解如何使用多维表"})})})},pq=()=>{const{viewId:e,collectionId:t,viewType:n,changeView:s,viewParentId:a}=Ne(),o=Jz(),i=sS(),l=yx(),c=ln();return y.useMemo(()=>n!==m.CollectionViewType.FORM?[]:[{type:H.OPERATION,data:{title:"预览",icon:"IcHide",onClick(){o({viewId:e,collectionId:t}),c(Ve.BITABLE_OPTION_MENU)}}},{type:H.OPERATION,data:{title:"分享收集表",icon:"IcFormShare",onClick(d){i({popcorn:d.currentTarget,viewId:e,collectionId:t,placement:"left-start"})}}},{type:H.OPERATION,data:{title:"查看收集表数据",icon:"IcMenuOpenNew",onClick(){var u,f;const d=(f=(u=J.blocks[t])==null?void 0:u.views)==null?void 0:f.find(h=>{var p;return((p=J.collectionViews[h])==null?void 0:p.type)===m.CollectionViewType.TABLE});if(d)s(d);else{const h=l(a,"表格",m.CollectionViewType.TABLE);h?s(h):be.error("切换失败")}c(Ve.BITABLE_OPTION_MENU)}}}],[l,s,c,t,o,i,e,a,n])},N3e=()=>{const e=Oe();return y.useCallback(t=>e(()=>{gr([t])}),[e])},gq=()=>{const e=Oe();return y.useCallback(t=>e(()=>ut({type:m.BlockType.PAGE,isTemplate:!0},{parentId:t,templatePages:!0})),[e])},j3e=()=>{var g;const{collectionId:e,viewId:t,readonly:n,isLocked:s}=Ne(),a=ie(),o=ln(),i=Ce(_=>_.collectionViews[t],[t]),l=gq(),c=Hm(),d=Mi({ignoreSorters:!0}),u=Oe(),f=(g=_ue())!=null?g:"",h=ft(e,_=>{var x;return((x=_==null?void 0:_.templatePages)!=null?x:[]).map(F=>{const{role:b}=mn(F);return{id:F,role:b}}).filter(F=>F.role!==m.PermissionRole.NONE)}),p=_=>{o(Ve.BITABLE_TEMPLATE_RECORDS,{noAnimation:!0}),d({viewId:t,where:{first:!0},templateId:_,openInRight:!0})};return i==null?null:r.jsxs("div",{className:"w-[370px] next-modal",children:[r.jsxs("div",{className:"h-10 px-4 flex items-center text-t2",children:[r.jsx(V,{className:"mr-1",name:Ga[i.type],size:"middle"}),r.jsx("span",{className:"mr-2 font-medium",children:wl[i.type]}),r.jsx("span",{className:"max-w-[140px]",children:"模板记录"})]}),r.jsxs("div",{className:R("max-h-[80vh] overflow-auto",h.length>=1&&"m-2"),children:[r.jsx(br,{items:h,onChange:_=>{u(()=>{_e(e,{templatePages:_.map(x=>x.id)})})},renderItemContent:({item:_,renderDragHandle:x})=>r.jsxs("div",{className:"flex items-center h-10 px-2 text-t2 animate-hover",onClick:()=>p(_.id),children:[x({className:"cursor-pointer flex items-center justify-center w-5 h-5 mr-1 text-grey4"}),r.jsxs("div",{className:"flex items-center flex-1 overflow-hidden ",children:[r.jsx(Fn,{iconSize:18,blockId:_.id,className:"w-5 h-5 mr-1",placement:"bottom-start",defaultIcon:r.jsx(_s,{uuid:_.id,size:"middle"})}),r.jsx("div",{className:"text-ellipsis",children:r.jsx(yl,{uuid:_.id})})]}),f===_.id&&r.jsx("div",{className:"text-t4-medium text-grey3 shrink-0",style:{marginLeft:"4px",marginRight:"4px"},children:"默认"}),!n&&!s&&r.jsx("button",{className:R("flex items-center p-1 text-t2 text-grey3 rounded animate-hover whitespace-nowrap"),onClick:F=>{F.stopPropagation(),a.dropdown({modalId:Qd,popcorn:F.currentTarget,content:()=>r.jsx(hP,{templatePageId:_.id,role:_.role})})},children:r.jsx(V,{size:"middle",name:"IcMore"})})]})}),h.length>=1&&r.jsxs("div",{className:"flex items-center flex-1 h-10 pl-8 animate-hover space-x-1 px-2",onClick:()=>p(),children:[r.jsx(V,{name:"IcPages",size:"middle",className:"text-grey3"}),r.jsx("span",{className:"text-t2 flex-1",children:"空白页面"}),f===Rv&&r.jsx("div",{className:"text-t4-medium text-grey3 shrink-0",children:"默认"}),r.jsx("button",{className:R("flex items-center p-1 text-t2 text-grey3 rounded animate-hover whitespace-nowrap"),onClick:_=>{_.stopPropagation(),a.dropdown({modalId:Qd,popcorn:_.currentTarget,content:()=>r.jsx(hP,{templatePageId:"",role:m.PermissionRole.WRITER})})},children:r.jsx(V,{size:"middle",name:"IcMore"})})]})]}),!s&&r.jsxs("button",{className:R("flex items-center w-full h-10 p-2 animate-hover text-grey3",h.length>=1&&"border-t border-grey6"),onClick:()=>{o(Ve.BITABLE_TEMPLATE_RECORDS,{noAnimation:!0});const _=l(e);c(_,{state:{noticeBannerShowBackButton:!0}})},children:[r.jsx(V,{className:"mr-1",name:"IcAdd",size:"middle"}),r.jsx("span",{className:"text-t2",children:"创建模板记录"})]})]})},Qd="57250b19-0854-498f-a71e-2ce59075cbd5",Rv="empty",hP=e=>{const{templatePageId:t,role:n}=e,{collectionId:s,viewId:a}=Ne(),o=!t,i=ie(),l=ln(),c=Hm(),d=jg(),u=cr(t),f=cr(s),h=N3e(),p=()=>{hn(()=>{var _;_e(s,{data:{defaultTemplateId:o?Rv:t}}),(_=f==null?void 0:f.views)==null||_.forEach(x=>{ic(x,{format:{defaultTemplateId:void 0}})})})},g=()=>{hn(()=>{ic(a,{format:{defaultTemplateId:o?Rv:t}})})};return r.jsx("div",{className:"w-[200px] py-2 next-modal",children:r.jsx(ze,{items:[{type:H.OPERATION,isHidden:![m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(n)||o,data:{title:"编辑",icon:"IcEdit",onClick:()=>{l(Ve.BITABLE_TEMPLATE_RECORDS,{noAnimation:!0}),l(Qd,{noAnimation:!0}),c(t,{state:{noticeBannerShowBackButton:!0}})}}},{type:H.OPERATION,isHidden:![m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(n),data:{title:"设置为默认",icon:"IcPin",onClick:()=>{const _=o?qt(m.BlockType.PAGE):fe(u==null?void 0:u.data.segments)||qt(u==null?void 0:u.type);i.modal({content:({onCloseModal:x})=>r.jsxs("div",{className:"px-7 py-6 max-w-xs",children:[r.jsx("div",{children:'创建新页面时将"'.concat(_,'"用作默认模板？')}),r.jsxs("div",{className:"mt-4 flex flex-col w-full text-t3 space-y-2.5",children:[r.jsx(De,{className:"w-full",onClick:()=>{x(),l(Qd,{noAnimation:!0}),p()},children:"适用于所有视图"}),r.jsx(De,{className:"w-full",onClick:()=>{x(),l(Qd,{noAnimation:!0}),g()},children:"仅当前视图"}),r.jsx(De,{className:"w-full",onClick:()=>{x(),l(Qd,{noAnimation:!0})},children:"取消"})]})]})})}}},{type:H.OPERATION,isHidden:o,data:{title:"拷贝副本",icon:"IcDuplicate",onClick:async()=>{await d([t]),l(Qd)}}},{type:H.OPERATION,isHidden:![m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(n)||o,data:{title:"删除",icon:"IcTrash",onClick:()=>{l(Qd),i.warning({title:r.jsx("p",{className:"mt-5 mb-10 w-60",children:"确定删除这个模板记录吗？"}),confirmText:"确定删除",confirm(){h(t)}})}}}]})})},S3e=({onClose:e,closeAddPanel:t})=>{const{changeView:n,embed:s,collectionId:a,viewParentId:o}=Ne(),i=ye(a,["views"]),[l,c]=y.useState(m.CollectionViewType.TABLE),d=yx(),u=y.useRef(null),f=y.useRef(""),h=a!==o,p=g=>{var F;me.event("bitable_view_create",{from_scene:s?"inline":"inThePage",view_type:l});const _=(F=i==null?void 0:i.views)==null?void 0:F.some(b=>{var w;return((w=J.collectionViews[b])==null?void 0:w.type)===m.CollectionViewType.TABLE}),x=d(o,f.current,l);x&&n(x),!_&&l===m.CollectionViewType.FORM&&d(o,"表单视图",m.CollectionViewType.TABLE),g(),e()};return r.jsxs("div",{className:"w-[240px] next-modal p-2",onClick:()=>{var g;return(g=u.current)==null?void 0:g.focus()},children:[r.jsx(Ct,{autoFocus:!0,inputRef:u,placeholder:"请输入名称",className:"h-8 flex-1",onChange:g=>f.current=g,onEnter:()=>p(t)}),r.jsxs("div",{className:"p-1 mb-1",children:[r.jsx("div",{className:"text-t2 text-grey3 my-2",children:"视图类型"}),(h?jF.filter(g=>g.type!==m.CollectionViewType.FORM):jF).map(g=>r.jsxs("div",{className:"flex justify-between items-center animate-hover px-1",onClick:()=>c(g.type),children:[r.jsxs("div",{className:"flex h-8 items-center",children:[r.jsx(V,{name:Ga[g.type],size:"middle"}),r.jsx("span",{className:"text-t2 ml-1",children:g.name})]}),r.jsxs("span",{className:"flex items-center",children:[l===g.type&&r.jsx(V,{name:"IcCheck02",size:"small"}),r.jsx(Vb,{popup:"查看视图帮助",link:g.helperLink})]})]},g.type))]}),r.jsx(De,{className:"h-8 text-t2",size:"auto",colorType:"active",onClick:()=>p(t),children:"创建"})]})},_q=()=>{const e=ie(),t=(n,s,a)=>{e.dropdown({popcorn:n,placement:a!=null?a:"right",content({onCloseModal:o}){return r.jsx(S3e,{onClose:s,closeAddPanel:o})}})};return y.useCallback(t,[e])},D3e=e=>{var p;const{changeView:t,managerReadonly:n,viewId:s,isLocked:a}=Ne(),{viewId:o,onClose:i,dragOverlay:l}=e,c=Ce(({collectionViews:g})=>g[o],[o]),d=ie(),u=y.useRef(c==null?void 0:c.type);y.useEffect(()=>{u.current=c==null?void 0:c.type},[c==null?void 0:c.type]);const f=y.useRef((p=c==null?void 0:c.title)!=null?p:"");y.useEffect(()=>{var g;f.current=(g=c==null?void 0:c.title)!=null?g:""},[c==null?void 0:c.title]);const h=(g,_)=>{d.dropdown({popcorn:g,placement:"right",closeBeforeCallBack(){const x=f.current;x!==_.title&&ic(o,{title:x})},content({onCloseModal:x}){return r.jsx(xq,{viewId:o,onCloseModal:x,viewTitleRef:f})}})};return c?r.jsxs("div",{className:R("px-2 h-8 text-t2 cursor-pointer animate-hover flex items-center justify-between",l&&"cursor-[grabbing]"),onClick:()=>{t(o),i==null||i()},children:[r.jsxs("div",{className:"flex overflow-hidden pr-1",children:[r.jsx("div",{className:"flex flex-shrink-0 justify-center items-center w-5 h-5 mr-1 cursor-[grab]",children:r.jsx(V,{name:"IcMenu",size:"normal",className:"text-grey4"})}),r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{name:Ga[c.type],size:"middle"}),r.jsx("span",{className:R("flex-1 overflow-hidden whitespace-nowrap overflow-ellipsis ml-1",{"text-t2-bold":c.uuid===s}),children:c.title||wl[c.type]})]})]}),!n&&!a&&r.jsx("button",{className:"w-5 h-5 flex-shrink-0 animate-hover rounded-sm flex items-center justify-center",onClick:g=>{g.stopPropagation(),h(g.currentTarget,c)},children:r.jsx(V,{name:"IcMore",size:"normal",className:"text-grey3"})})]}):null},xq=({viewId:e,onCloseModal:t,onClose:n,viewTitleRef:s})=>{var b,w;const a=t,{changeView:o,embed:i,collectionId:l,viewParentId:c,isLocked:d}=Ne(),u=Ce(({collectionViews:E})=>E[e],[e]),f=ie(),h=y.useRef(null),p=(b=u==null?void 0:u.type)!=null?b:m.CollectionViewType.TABLE,g=qz(),_=zz(),{views:x=[]}=(w=cr(c))!=null?w:{},F=E=>{d||f.dropdown({popcorn:E.currentTarget,placement:"bottom-end",content:({onCloseModal:C})=>r.jsx(Wz,{viewId:e,onChange:()=>{C(),a(),n==null||n()}})})};return u?r.jsxs("div",{className:"w-[240px] space-y-1 next-modal p-2",onClick:()=>{var E;return(E=h.current)==null?void 0:E.focus()},children:[r.jsx(Ct,{autoFocus:!0,inputRef:h,placeholder:"请输入名称",className:"h-8 flex-1 mb-2",defaultValue:u.title,onEnter:t,onChange:E=>s.current=E}),r.jsxs("div",{className:"w-full text-t2 py-1 text-grey3 mb-1 px-2 flex justify-between animate-hover cursor-pointer",onClick:F,children:[r.jsx("p",{className:"text-black",children:"视图设置"}),r.jsxs("button",{className:"text-t2 text-grey3 flex items-center",children:[wl[u.type],r.jsx(V,{name:"IcArrowDown01",className:"ml-2",size:"xxxsmall"})]})]}),r.jsx(Cr,{className:"my-2"}),p!==m.CollectionViewType.FORM&&r.jsxs("button",{className:"h-8 px-1 flex w-full items-center animate-hover rounded",onClick:()=>{Xt("".concat(_n(),"/").concat(l,"#").concat(e)),t(),n==null||n()},children:[r.jsx(V,{className:"mr-1",size:"middle",name:"IcLink"}),r.jsx("span",{className:"text-t2",children:"复制引用视图链接"})]}),r.jsxs("button",{className:"h-8 px-1 flex w-full items-center animate-hover rounded",onClick:()=>{me.event("bitable_view_create",{from_scene:i?"inline":"inthepage",view_type:p});const E=_(e);E&&o(E),t(),n==null||n()},children:[r.jsx(V,{className:"mr-1",size:"middle",name:"IcDuplicate"}),r.jsx("span",{className:"text-t2",children:"拷贝视图"})]}),x.length>1&&r.jsxs("button",{className:"h-8 px-1 flex w-full items-center animate-hover rounded",onClick:()=>{f.warning({title:r.jsx(r.Fragment,{children:"是否确认删除该视图？"}),confirm:()=>{g(e),t(),n==null||n()}})},children:[r.jsx(V,{className:"mr-1",size:"middle",name:"IcTrash"}),r.jsx("span",{className:"text-t2",children:"删除视图"})]})]}):null},pP=({uuid:e})=>{var u;const{viewId:t,changeView:n,managerReadonly:s,isLocked:a}=Ne(),o=Ce(({collectionViews:f})=>f[e],[e]);V$();const i=ie(),l=y.useRef((u=o==null?void 0:o.title)!=null?u:"");y.useEffect(()=>{var f;l.current=(f=o==null?void 0:o.title)!=null?f:""},[o==null?void 0:o.title]);const c=(f,h)=>{s||a||i.dropdown({popcorn:f,placement:"bottom",closeBeforeCallBack(){const p=l.current;p!==h.title&&ic(e,{title:p})},content({onCloseModal:p}){return r.jsx(xq,{viewId:e,onCloseModal:p,onClose:()=>{},viewTitleRef:l})}})};if(!o)return null;const d=t===e;return r.jsx("div",{"data-disable-select":!0,className:R("flex items-center mr-3 text-grey3 h-full",d&&"border-b-2 border-grey1 text-grey1 pt-0.5"),children:r.jsxs("button",{className:"flex items-center p-1 text-t2-medium animate-hover",onContextMenu:f=>{f.preventDefault(),f.stopPropagation(),c(f.currentTarget,o)},onClick:f=>{d?c(f.currentTarget,o):n(e)},children:[r.jsx(V,{className:"mr-1",name:Ga[o.type],size:"middle"}),r.jsx("span",{className:"max-w-[150px] text-ellipsis",children:o.title||wl[o.type]})]})})},A3e=({onClose:e})=>{const{viewParentId:t,managerReadonly:n,readonly:s,isLocked:a}=Ne(),o=ft(t,c=>{var d;return(d=c==null?void 0:c.views)!=null?d:[]}),i=Oe(),l=_q();return r.jsxs("div",{className:"w-[240px] next-modal-scroll",children:[r.jsx(br,{disabled:a||s||n,items:o.map(c=>({id:c})),renderItemContent:({item:c})=>r.jsx(D3e,{viewId:c.id,onClose:e}),onChange:c=>{i(()=>{_e(t,{views:c.map(d=>d.id)})})}}),!n&&!a&&r.jsxs(r.Fragment,{children:[r.jsx(Cr,{}),r.jsxs("button",{className:"flex p-2 w-full items-center text-t2 animate-hover",onClick:c=>l(c.currentTarget,e),children:[r.jsx(V,{className:"mr-1",name:"IcAdd",size:"middle"}),"创建视图"]})]})]})},yq=({className:e})=>{const{pageManager:t,viewParentId:n,viewId:s,isLocked:a,readonly:o}=Ne(),i=_q(),l=Oe(),c=ie(),d=ft(n,E=>{var C;return(C=E==null?void 0:E.views)!=null?C:[]}),[u,f]=y.useState(d.length),h=y.useRef(null),p=y.useRef(null),g=Ce(({collectionViews:E})=>E[s],[s]),{width:_}=bl(t==null?void 0:t.current),{width:x}=bl(p.current),F=pt();y.useEffect(()=>{const E=t==null?void 0:t.current,C=E==null?void 0:E.lastElementChild,k=p.current;if(!C||!k)return;const T=C.clientWidth,v=k.clientWidth,I=window.getComputedStyle(E),j=parseInt(I.paddingLeft,10),S=parseInt(I.paddingRight,10),D=E.clientWidth-j-S-T-150;if(v<D){f(d.length);return}let A=0,P=0;Array.from(k.children).reverse().find(L=>(A++,P+=L.clientWidth,v-P<D)),f(Math.max(d.length-A,1))},[t,u,x,d.length,_]);const b=E=>{c.dropdown({popcorn:E.currentTarget,placement:"bottom",content({onCloseModal:C}){return r.jsx(A3e,{onClose:C})}})};if(!g)return null;const w=d.slice(0,u);return w.includes(s)||(w.pop(),w.push(s)),r.jsxs(r.Fragment,{children:[r.jsx(br,{isHorizontalAxis:!0,strategy:tw,modifiers:[ew,H1],disabled:o||a,className:R("flex h-full flex-1",e),listRef:h,appendChild:u!==d.length?r.jsx("div",{className:R("flex items-center mr-2 text-t2"),onClick:b,children:r.jsxs("button",{className:"flex items-center text-grey4 animate-hover p-1 whitespace-nowrap",children:[d.length-u," 更多..."]})}):!(o||a)&&r.jsx("div",{className:R("flex items-center mr-2"),children:r.jsx("button",{className:"flex items-center text-grey4 animate-hover p-1",onClick:E=>i(E.currentTarget,()=>{},"bottom"),children:r.jsx(V,{name:"IcAdd",size:"middle"})})}),onDragStart:()=>Lb(),items:w.map(E=>({id:E})),renderItemContent:({item:E})=>r.jsx(pP,{uuid:E.id},E.id),onChange:E=>{l(()=>{const C=E.map(k=>k.id);_e(n,{views:C.concat(d.filter(k=>!C.includes(k)))})})}}),!F&&!o&&r.jsx(Xwe,{}),r.jsx("div",{className:"absolute opacity-0 flex top-0 right-0 overflow-hidden pointer-events-none ",ref:p,children:d.map(E=>r.jsx(pP,{uuid:E},E))})]})},R3e=({className:e})=>{var $;const{viewId:t,managerReadonly:n,readonly:s,viewType:a,pageManager:o,isLocked:i,collectionId:l}=Ne(),{enableAI:c}=xr(),d=mq(),u=Ln(),f=vs(t),h=f==null?void 0:f.format.formIllegal,p=dS(),{filterEnabled:g,sortersEnabled:_,groupEnabled:x,subGroupEnabled:F}=Ce(M=>{var ce,ae,de;const U=gn(t,M.blocks,M.collectionViews);if(!U)return{};const{view:z,collection:K,subGroupBy:W,groupBy:Y}=U,G=z0(z.format.filter,K.data.schema),te=((ce=z.format.sorters)!=null?ce:[]).filter(ke=>!ke.disable).length>0,Q=W0(l,M),ne=Q.includes((ae=Y==null?void 0:Y.property)!=null?ae:""),se=Q.includes((de=W==null?void 0:W.property)!=null?de:"");return{filterEnabled:G,sortersEnabled:te,groupEnabled:ne,subGroupEnabled:se}},[l,t]),b=ie(),w=m.CollectionViewType.FORM===(f==null?void 0:f.type),E=m.CollectionViewType.TABLE===(f==null?void 0:f.type),C=ea(Z4),k=y.useRef(($=f==null?void 0:f.title)!=null?$:"");y.useEffect(()=>{var M;k.current=(M=f==null?void 0:f.title)!=null?M:""},[f==null?void 0:f.title]);const T=(M,U=!1)=>{b.dropdown({popcorn:ra(M.currentTarget),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(qu,{isSubGroup:U})}})},v=M=>{b.dropdown({popcorn:ra(M.currentTarget),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(Vg,{})}})},I=M=>{b.dropdown({popcorn:ra(M.currentTarget),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(Ug,{})}})},j=M=>{b.dropdown({modalId:Ve.BITABLE_OPTION_MENU,popcorn:M.currentTarget,placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(v3e,{})}})},S=()=>{const M=bn(".block-content",u);M&&d(l,M)},D=M=>{b.dropdown({popcorn:M.currentTarget,placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content:({onCloseModal:U,popper:z})=>r.jsx(hq,{closeModal:U,popper:z})})},A=y.useRef(null),P=y.useRef(t);P.current=t;const L=M=>{var U;b.dropdown({popcorn:(U=A.current)!=null?U:document.body,placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],closeBeforeCallBack:()=>{var W;const z=k.current,K=(W=pe().collectionViews)==null?void 0:W[P.current];z!==(K==null?void 0:K.title)&&ic(P.current,{title:z})},content:({onCloseModal:z})=>r.jsx(nS,{viewTitleRef:k,defaultItemType:M,onCloseModal:z})})};y.useEffect(()=>{w&&C&&L(tS.FORM_LOGIC)},[w,C]);const O=bq();return r.jsxs("div",{className:R("flex items-center justify-between bg-white1 sticky top-0 flex-shrink-0",e),style:{height:gu},ref:o,children:[r.jsx(yq,{}),r.jsxs("div",{className:R("flex gap-2",h&&"pointer-events-none opacity-30"),children:[n?r.jsxs(r.Fragment,{children:[r.jsx(Fe,{popup:"筛选",children:r.jsx("button",{className:R("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",g&&"text-active_color"),onClick:I,children:r.jsx(V,{size:"middle",name:"IcFilter"})})}),r.jsx(Fe,{popup:"排序",children:r.jsx("button",{className:R("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",rc.tableSortManager,_&&"text-active_color"),onClick:v,children:r.jsx(V,{size:"middle",name:"IcDescending"})})}),r.jsx(Av,{})]}):r.jsxs(r.Fragment,{children:[r.jsx(Fq,{}),E&&c&&r.jsx("button",{className:"text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-[#A34DD9]",onClick:S,children:r.jsx(V,{size:"middle",name:"IcAiFill"})}),r.jsxs("button",{ref:A,className:"text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",onClick:()=>L(),children:[r.jsx(V,{size:"middle",className:"mr-1",name:"IcSettings"}),"视图设置"]}),a===m.CollectionViewType.CALENDAR&&p&&p.length>0&&r.jsxs("button",{className:"text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",onClick:D,children:[r.jsx(V,{size:"middle",className:"mr-1",name:"IcTitleDate"}),"无时间记录(",p.length,")"]}),a&&x&&![m.CollectionViewType.CALENDAR,m.CollectionViewType.FORM].includes(a)&&r.jsx(Fe,{popup:"分组",children:r.jsx("button",{className:R("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color"),onClick:M=>T(M),children:r.jsx(V,{size:"middle",name:"IcBoard"})})}),a===m.CollectionViewType.BOARD&&F&&r.jsx(Fe,{popup:"子分组",children:r.jsx("button",{className:R("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color"),onClick:M=>T(M,!0),children:r.jsx(V,{size:"middle",name:"IcSubGroup"})})}),a&&![m.CollectionViewType.FORM].includes(a)&&g&&r.jsx(Fe,{popup:"筛选",children:r.jsx("button",{className:R("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color"),onClick:I,children:r.jsx(V,{size:"middle",name:"IcFilter"})})}),a&&![m.CollectionViewType.FORM].includes(a)&&_&&r.jsx(Fe,{popup:"排序",children:r.jsx("button",{className:R("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color",rc.tableSortManager),onClick:v,children:r.jsx(V,{size:"middle",name:"IcDescending"})})}),r.jsx(Av,{}),r.jsx("button",{className:"text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",onClick:j,children:r.jsx(V,{size:"middle",name:"IcMore"})}),!i&&r.jsx(P3e,{})]}),!s&&a&&![m.CollectionViewType.FORM].includes(a)&&O()]})]})},bq=()=>{const{viewId:e,collectionId:t}=Ne(),n=ie(),s=Mi({ignoreSorters:!0}),a=()=>{s({viewId:e,where:{first:!0},openInRight:!0})},o=y.useCallback(c=>{if(c==null){console.warn("showTemplates element == null");return}n.dropdown({popcorn:c,placement:"bottom",modalId:Ve.BITABLE_TEMPLATE_RECORDS,modifiers:[{name:"preventOverflow",options:{padding:16}}],content:()=>r.jsx(j3e,{})})},[n]),i=y.useRef(null),l=Ed();return y.useEffect(()=>{let c=!1;const d=l.listen(u=>{var g;const f=Cd(u.search);if(f==null){c&&(c=!1,o(i.current));return}c=!1;const h=pe().blocks[f];if(h==null)return;const p=pe().blocks[t];p!=null&&h.isTemplate&&(g=p.templatePages)!=null&&g.includes(h.uuid)&&(c=!0)});return()=>d()},[t,l,o]),()=>r.jsxs("div",{className:"flex",ref:i,children:[r.jsx("button",{className:R("text-t2-medium flex items-center whitespace-nowrap rounded-l-l bg-active_color py-1 px-2 text-white hover:brightness-90"),onClick:a,children:"创建"}),r.jsx(Fe,{popup:"多维表模板",children:r.jsx("button",{className:R("flex px-1 items-center justify-center whitespace-nowrap rounded-r bg-active_color py-1 text-white hover:brightness-90 border-l border-l-0.1"),onClick:c=>o(c.currentTarget),children:r.jsx(V,{size:"middle",name:"IcArrowShow"})})})]})},Fq=()=>{const{viewId:e,readonly:t,collectionId:n,embed:s}=Ne(),a=vs(e),o=sS(),{format:i,type:l}=a||{},c=Jz();return t||l!==m.CollectionViewType.FORM?null:r.jsxs(r.Fragment,{children:[r.jsxs(Fe,{className:R("text-t2 animate-hover flex flex-shrink-0 items-center px-1",i!=null&&i.formShared?"text-active_color":"text-grey3"),onClick:d=>{o({popcorn:d.currentTarget,viewId:e,collectionId:n,placement:"bottom"})},children:[r.jsx(V,{name:"IcFormShare",size:"middle",className:"mr-1"}),i!=null&&i.formShared?"已开启分享":"分享收集表"]}),!s&&r.jsxs(Fe,{className:R("text-t2 animate-hover flex flex-shrink-0 items-center px-1 text-grey3"),onClick:()=>{c({viewId:e,collectionId:n})},children:[r.jsx(V,{name:"IcHide",size:"middle",className:"mr-1"}),"预览"]})]})},P3e=()=>{const e=Ln(),{viewId:t,readonly:n,collectionId:s}=Ne(),a=$g(),o=cf(),i=vs(t),{type:l}=i||{},c=d=>{me.event("bitable_property_create",{from_scene:"form"});const u=o({collectionId:s,viewId:t}),f=bn(".next-space-page",e),h=bn(".next-space-page .block-content",e);u&&(st({$newTableProperty:{propertyId:u,from:zn.FORM_PROPERTIES}}),a(u,d.currentTarget,zn.FORM_PROPERTIES,"bottom-start",()=>{f.scrollTo({top:h.clientHeight,behavior:"smooth"})}))};return n||l!==m.CollectionViewType.FORM?null:r.jsx(De,{className:"flex-shrink-0",colorType:"active",onClick:c,children:"创建"})},L3e=y.memo(()=>{var C,k;const{collectionId:e,readonly:t,viewParentId:n,viewId:s}=Ne(),a=ye(e,["data"],["icon","segments"]),o=a==null?void 0:a.data.icon,i=a==null?void 0:a.data.segments,l=!!((C=o==null?void 0:o.value)!=null&&C.trim()&&((k=o.type)!=null&&k.trim())),c=e!==n,d=ys(),u=li(s),f=Nn(),h=af(n),p=f(n,!0,oa),g=n4(n,"segments",Uu),_=s4(n,"segments",Uu),x=y.useRef(),F=y.useRef(NaN),b=La(e);y.useEffect(()=>{p.setReadonly(t||c)},[p,c,t]),y.useEffect(()=>(p[Pg]=x,p[fx]=F,xE(h,p),()=>{yE(h)}),[h,p]);const w=y.useRef(null);y.useEffect(()=>{const T=w.current;if(T)return T.addEventListener("inlinedinput",g),()=>{T.removeEventListener("inlinedinput",g)}},[g]),y.useEffect(()=>{t||e2(p,i)},[e,p,c,t,i]),y.useEffect(()=>{if(t)return;const T=p.onChange.subscribe(({previousContent:v,previousSelection:I})=>{const{content:j}=p;if(j===v)return;const S=mr(j);F.current!==p.revision&&(x.current=S,b(S,[v,I]),F.current=p.revision)});return()=>{T.unsubscribe()}},[p,t,b]);const E=y.useMemo(()=>c||t?r.jsx(fs,{className:"text-t1 inline whitespace-pre-wrap break-words align-middle font-semibold",plugins:oa,segments:i,placeholder:fo,interactable:!1}):r.jsx(a3,{className:R("animate-hover whitespace-pre-wrap rounded px-1.5 py-0.5 font-semibold focus:bg-black_006",Mn({outline:"0 !important"})),emptyClassName:Mn({selectors:{"&::after":{content:JSON.stringify(y_),pointerEvents:"none",color:"var(--grey4)",fontWeight:"bold"},"& > br":{display:"none"}}}),ref:w,model:p,spellCheck:!1,onKeyDown:T=>{Ie(["Enter","Shift+Enter"])(T)||_(T)}}),[_,p,c,t,i]);return c?r.jsxs(Fe,{popup:"点击访问原始多维表",className:R("text-h4 animate-hover relative mr-1 flex items-center rounded px-1.5 py-0.5 text-black whitespace-nowrap max-w-full overflow-auto"),onClick:T=>d(e,{forceOpenInRight:T.altKey,openWay:u,forceOpenNewTab:T.ctrlKey||T.metaKey}),children:[r.jsx(Fn,{trigger:!1,iconSize:20,className:"mr-1",tooltipClassName:"flex-shrink-0",hasOverlay:l,blockId:e,offset:[100,0],defaultIcon:r.jsx(V,{size:"normal",name:"IcPagelink"})}),E]}):r.jsx("div",{"data-disable-select":!0,className:"relative mr-1 max-w-full",children:E})}),B3e=({className:e})=>{var $;const{viewId:t,collectionId:n,managerReadonly:s,readonly:a,viewParentId:o,pageManager:i,viewType:l}=Ne(),c=og(t),d=vs(t),u=d==null?void 0:d.format.formIllegal,f=ie(),{enableAI:h}=xr(),p=mq(),g=Ln(),_=go(o),x=m.CollectionViewType.FORM===(d==null?void 0:d.type),F=m.CollectionViewType.TABLE===(d==null?void 0:d.type),b=Ce(({collectionViews:M})=>{var U,z;return(z=(U=M[t])==null?void 0:U.format.showTitle)!=null?z:!0},[t]),{filterEnabled:w,sortersEnabled:E,groupEnabled:C,subGroupEnabled:k}=Ce(M=>{var ce,ae,de;const U=gn(t,M.blocks,M.collectionViews);if(!U)return{};const{view:z,collection:K,groupBy:W,subGroupBy:Y}=U,G=z0(z.format.filter,K.data.schema),te=((ce=z.format.sorters)!=null?ce:[]).filter(ke=>!ke.disable).length>0,Q=W0(n,M),ne=Q.includes((ae=W==null?void 0:W.property)!=null?ae:""),se=Q.includes((de=Y==null?void 0:Y.property)!=null?de:"");return{filterEnabled:G,sortersEnabled:te,groupEnabled:ne,subGroupEnabled:se}},[n,t]),T=y.useRef(($=d==null?void 0:d.title)!=null?$:"");y.useEffect(()=>{var M;T.current=(M=d==null?void 0:d.title)!=null?M:""},[d==null?void 0:d.title]);const v=M=>{f.dropdown({popcorn:M.currentTarget,modalId:Ve.BITABLE_OPTION_MENU,placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(I3e,{})}})},I=y.useRef(null),j=y.useRef(t);j.current=t;const S=()=>{f.dropdown({popcorn:I.current||document.body,placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],closeBeforeCallBack(){var z;const M=T.current,U=(z=pe().collectionViews)==null?void 0:z[j.current];M!==(U==null?void 0:U.title)&&ic(j.current,{title:M})},content:({onCloseModal:M})=>r.jsx(nS,{viewTitleRef:T,onCloseModal:M})})},D=(M,U=!1)=>{f.dropdown({popcorn:ra(M.currentTarget),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(qu,{isSubGroup:U})}})},A=M=>{f.dropdown({popcorn:ra(M.currentTarget),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(Vg,{})}})},P=M=>{f.dropdown({popcorn:ra(M.currentTarget),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(Ug,{})}})},L=()=>{const M=bn('[data-block-id="'.concat(o,'"]'),g);M&&p(n,M)},O=bq();return y.useEffect(()=>{if(!i)return;const M=i.current,U=M==null?void 0:M.closest("[data-block-id]"),z=M==null?void 0:M.closest(".next-space-page");if(!M||!U||!z)return;const K=()=>{requestAnimationFrame(()=>{const W=U.getBoundingClientRect(),Y=z.getBoundingClientRect();if(W.top<Y.top){let G=Math.abs(Y.top-W.top);W.bottom-Y.top<M.clientHeight&&(G-=M.clientHeight-(W.bottom-Y.top)),M.style.transform="translate3d(0,".concat(Math.round(G+i8),"px,0)")}else M.style.transform="none"})};return z.addEventListener("scroll",K),window.addEventListener("resize",K),()=>{z.removeEventListener("scroll",K),window.removeEventListener("resize",K)}},[i]),r.jsxs("div",{className:R("group flex items-center justify-between flex-col",e),children:[r.jsxs("div",{className:"flex items-center justify-between w-full relative bg-white1 z-50",ref:i,onContextMenu:M=>{M.stopPropagation()},children:[r.jsx(yq,{className:"print:hidden"}),r.jsxs("div",{className:R("flex opacity-0 transition-opacity group-hover:opacity-100 print:hidden overflow-auto",c!==void 0&&"opacity-100"),children:[r.jsx(cS,{uuid:o}),!s&&r.jsxs(r.Fragment,{children:[r.jsx(Fq,{}),F&&h&&r.jsx(Fe,{popup:"AI",children:r.jsx("button",{className:"text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-[#A34DD9]",onClick:L,children:r.jsx(V,{size:"middle",name:"IcAiFill"})})}),r.jsxs("button",{className:"text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",ref:I,onClick:S,children:[r.jsx(V,{size:"middle",name:"IcSettings",className:"mr-1"}),"视图设置"]}),l&&![m.CollectionViewType.FORM].includes(l)&&w&&r.jsx(Fe,{popup:"筛选",children:r.jsx("button",{className:R("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color"),onClick:P,children:r.jsx(V,{size:"middle",name:"IcFilter"})})}),l&&![m.CollectionViewType.FORM].includes(l)&&E&&r.jsx(Fe,{popup:"排序",children:r.jsx("button",{className:R("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color",rc.tableSortManager),onClick:A,children:r.jsx(V,{size:"middle",name:"IcDescending"})})}),l&&C&&![m.CollectionViewType.CALENDAR,m.CollectionViewType.FORM].includes(l)&&r.jsx(Fe,{popup:"分组",children:r.jsx("button",{className:R("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color"),onClick:M=>D(M),children:r.jsx(V,{size:"middle",name:"IcBoard"})})}),l===m.CollectionViewType.BOARD&&k&&r.jsx(Fe,{popup:"子分组",children:r.jsx("button",{className:R("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color"),onClick:M=>D(M,!0),children:r.jsx(V,{size:"middle",name:"IcSubGroup"})})})]}),s&&r.jsxs(r.Fragment,{children:[r.jsx(Fe,{popup:"筛选",children:r.jsx("button",{className:R("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",w&&"text-active_color"),onClick:P,children:r.jsx(V,{size:"middle",name:"IcFilter"})})}),r.jsx(Fe,{popup:"排序",children:r.jsx("button",{className:R("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",rc.tableSortManager,E&&"text-active_color"),onClick:A,children:r.jsx(V,{size:"middle",name:"IcDescending"})})})]}),r.jsx(Av,{className:"mx-1"}),r.jsx(Fe,{popup:"以页面打开",children:r.jsx(AL,{to:_,className:"animate-hover flex p-1 items-center justify-center rounded text-grey3",children:r.jsx(V,{size:"middle",name:"IcMenuOpen"})})}),!u&&r.jsxs(r.Fragment,{children:[!s&&r.jsx(Fe,{popup:"菜单",children:r.jsx("button",{className:"animate-hover mx-1 flex p-1 items-center justify-center rounded text-grey3",onClick:v,children:r.jsx(V,{size:"middle",name:"IcMore"})})}),!a&&!x&&O()]})]})]}),b&&r.jsx("div",{className:"flex w-full py-1 border-t",children:r.jsx(L3e,{})})]})},O3e=({className:e,embed:t})=>t?r.jsx(B3e,{className:e}):r.jsx(R3e,{className:e}),wq=y.memo(O3e);f3e(wq);const M3e=(e,t)=>{const{blocks:n}=pe();return[...sc(e,n,t)].some(o=>{var i,l;return[m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER].includes((l=(i=n[o])==null?void 0:i.type)!=null?l:0)})},U3e=(e,t)=>{const{blocks:n}=pe();return[...sc(e,n,t)].some(a=>{var o;return((o=n[a])==null?void 0:o.type)===m.BlockType.MARK})},Eq=({id:e,root:t})=>{const n=Ja(),s=Un(),a=Ce(({blocks:l})=>{var u,f;let c=e;const d=l[e];return(d==null?void 0:d.type)===m.BlockType.REFERENCE_COLLECTION&&(c=(f=(u=d.data.ref)==null?void 0:u.uuid)!=null?f:""),l[c]},[e]),[o,i]=y.useState(s!==wt.PAGE_HISTORY&&!(a!=null&&a.local));return y.useEffect(()=>{if(o){const l=a==null?void 0:a.subNodes.some(c=>!J.blocks[c]);a&&l?n(a.uuid,{force:!0}).finally(()=>{i(!1)}):i(!1)}},[]),a?o?r.jsx(xs,{className:"h-[300px]"}):r.jsx(Uz,{extendsStore:!0,children:r.jsx(V3e,{collectionId:a.uuid,viewParent:e,root:t})}):r.jsx(wn,{id:e,className:"my-2",children:r.jsx(eE,{id:e})})},V3e=e=>{const{collectionId:t,viewParent:n}=e,s=y.useRef(null),a=y.useRef(null),o=lt(),i=Xu(n,o),l=M3e(n,o),c=We(t,!1),d=We(n,!1),u=Tl(n),[f,h]=iS(n,!0),p=vs(f),g=yx(),_=F8(f);lq(f),iq(t),y.useEffect(()=>{if(!c&&!f){const w=g(n,"表格",m.CollectionViewType.TABLE);w&&h(w)}},[g,h,c,f,n]);const x=y.useMemo(()=>{if(!(!t||!f||!p))return{viewId:f,tableCellWrap:_,collectionId:t,readonly:c,isLocked:u,managerReadonly:d,changeView:h,embed:!0,isColumnListChildren:i,isFoldListChildren:l,viewType:p.type,viewParentId:p.parentId,pageManager:a}},[h,t,i,l,d,c,_,p,f,u]),F=(p==null?void 0:p.type)&&![m.CollectionViewType.TIMELINE].includes(p.type);if(Gg(s,{enable:F}),!x)return null;const b=r.jsx($3e,{viewParent:n});return r.jsx(wn,{id:n,className:"my-2 line-default",children:r.jsx(rd.Provider,{value:x,children:r.jsxs(Oo,{children:[r.jsx(wq,{embed:!0}),b]})})})},$3e=e=>{const{viewId:t,isFoldListChildren:n,isColumnListChildren:s}=Ne(),{viewParent:a}=e,o=lt(),i=y.useRef(null),l=yr(),c=vs(t),d=uq(c==null?void 0:c.type),u=y.useRef(qn(()=>xn.emit("removeHoverMenu"),100,{leading:!0})),f=(c==null?void 0:c.type)&&![m.CollectionViewType.TIMELINE,m.CollectionViewType.FORM].includes(c.type),h=(c==null?void 0:c.type)&&![m.CollectionViewType.CALENDAR,m.CollectionViewType.FORM].includes(c.type),p=U3e(a,o),g=n9(),_=ye(o,["data"],["pageFixedWidth","directoryMenu"]),{pageFixedWidth:x=!0,directoryMenu:F}=(_==null?void 0:_.data)||{};Gg(i,{enable:f});const b=!s&&!n&&!p&&!x,w=b&&(c==null?void 0:c.type)===m.CollectionViewType.TABLE?"px-24":void 0,E=b&&(c==null?void 0:c.type)!==m.CollectionViewType.TABLE?"px-24":void 0;return r.jsx("div",{ref:i,onClick:C=>C.stopPropagation(),className:R("will-change-scroll",h&&"overflow-x-auto overflow-y-hidden",b&&"-mx-24 sm:-mx-12 sm:px-12",(F||g)&&"mr-0 pr-0",E),onScroll:u.current,children:r.jsx(c8.Provider,{value:i,children:r.jsx(d,{scrollRef:l,className:w})})},t)},H3e=e=>{const t=y.useRef(null),n=yr(),{mindMapStyle:s,mindMapLineStyle:a}=Fx(e.id),o=Fr();oCe(t);const i=Sj();return YU(n.current,l=>{var u;const[c,d]=o.getSize();if(l.width&&l.height&&(o.setSize(l.width,l.height),c&&d)){const f=Math.floor(l.width-c),h=Math.floor(l.height-d);(u=n.current)==null||u.scrollBy({left:f,top:h})}},"all"),y.useEffect(()=>{o.setRootId(e.id),o.setDirection(s,!0),o.setLineStyle(a)},[o,a,s,e.id]),y.useEffect(()=>{var c;if(!n.current||!t.current)return;const l=(c=n.current)==null?void 0:c.getBoundingClientRect();l&&o.setSize(l.width,l.height),o.setContainer(t.current),o.setScroller(n.current)},[o,n]),Gp(()=>{o.destroy()}),y.useEffect(()=>(kM(e.id,o),()=>{TM(e.id)}),[o,e.id]),r.jsxs("div",{className:"group",children:[r.jsxs(XH,{ref:t,id:e.id,children:[r.jsx(JH,{}),r.jsx(MF,{id:e.id,level:0}),r.jsx(QH,{})]}),r.jsx("div",{className:"group-hover:opacity-100 opacity-0 transition-opacity",children:r.jsx(HH,{id:e.id})}),!i&&r.jsx(xs,{className:"absolute left-0 top-0"})]})},z3e=({id:e,root:t})=>{const n=ye(e,[]),s=y.useRef(null),a=We(e),o=Qa(),i=go(e),l=ns(),{onRenderSize:c,changeSize:d,containerWidth:u,containerRef:f,defaultWidth:h,defaultHeight:p,defaultBlockFullWidth:g}=Nc({id:e,defaultWidth:uo,defaultHeight:330,root:t,defaultBlockFullWidth:!0}),_=rr(()=>new WU({getAllElement:()=>{var x;return(x=s.current)==null?void 0:x.querySelectorAll("[data-block-id]")},getCanvasPosition:(x,F,b)=>{if(s.current){const E=x.getState().scale*.01,C=s.current.querySelector(".node-drawer"),k=C==null?void 0:C.getBoundingClientRect();if(!k)return[F,b];const T=F-k.left,v=b-k.top;return[T/E,v/E]}return[F,b]},supportAppendChild:x=>B0(x),getLineColor:x=>rm(x)}));return y.useEffect(()=>{var F;const x=_.addScaleListener({onScaleChange:(b,w)=>{vM(b,w,!0)}});return _.zoom((F=IM(e,!0))!=null?F:80),x},[_,e]),n?r.jsx(wn,{id:e,className:"my-2 self-center w-full",blockRef:f,fullWidth:!t||o,horizontal:t,onDoubleClick:x=>{x.target instanceof Element&&x.target.closest("[data-ignore-double-click]")||l.push(i)},children:r.jsx(Ic,{className:"bg-grey9",resizeHeight:!0,readonly:a,doubleResize:t,defaultWidth:h||uo,defaultHeight:p,defaultBlockFullWidth:g,maxWidth:u,minHeight:250,resizeWidth:!1,onChange:d,onRenderSize:c,children:r.jsx(bg,{wait:800,waitMode:"debounce",children:r.jsx(jI.Provider,{value:!0,children:r.jsx(Su.Provider,{value:!0,children:r.jsx(jl.Provider,{value:_,children:r.jsxs(Oo,{children:[r.jsx(Ec.Provider,{value:s,children:r.jsx("div",{className:"w-full next-space-page embed-mind-page h-full overflow-hidden line-default",ref:s,"data-mind-page-id":e,style:{cursor:"pointer",fontFamily:BL},children:r.jsx(H3e,{id:e},e)})}),r.jsx(q3e,{id:e})]})})})})})})}):r.jsx(Fg,{})},q3e=({id:e})=>{const t=uh(),n=go(e);return r.jsx(B4,{renderList:[{title:"新窗口查看",icon:"IcMenuOpenNew",click:()=>window.open(n)},{title:"菜单",icon:"IcMore",click:s=>{t({blockId:e,blockNode:s.currentTarget,placement:"left",offset:[0,5]})},hidden:pt()}]})},G3e=({id:e,root:t})=>{const n=ye(e,["data","local"],["segments"]),s=Oe(),a=We(e);if(Ld({uuid:e}),!n)return null;const o=fe(n.data.segments);return r.jsx(wn,{id:e,horizontal:t,className:R("my-1",{"animate-hover":!a}),children:r.jsx(Bj,{readonly:a,content:o,onChange:i=>{const l=ht(i);s(()=>{_e(e,{data:{segments:l}})})},defaultOpenPanel:!!n.local})})},Cq=e=>{const t=Oe();return y.useCallback(n=>{t(()=>{_e(e,{data:{viewMode:n}})})},[e,t])},uS=e=>{var W,Y;const{uuid:t,isFile:n,readonly:s,ownerBlockId:a}=e,o=ye(t,["data"],["ref","viewMode"]),i=Qa(),l=ye(a,["data"],["ref","viewMode"]),c=ye(t,["data"],["segments"]),d=!!((W=o==null?void 0:o.data.ref)!=null&&W.uuid&&!c),u=fh(),f=DH(),h=xH({uuid:t}),p=ch({uuid:t}),g=C2(),_=((Y=l||o)==null?void 0:Y.data.viewMode)||fr.normal,x=Sw(o==null?void 0:o.spaceId),F=pt(),b=go(t),w=fe(c==null?void 0:c.data.segments),{extName:E}=rn(w),C=E.toLowerCase()==="pdf",k=eh(E),T=y.useRef(null),v=po(o==null?void 0:o.spaceId),{url:I}=bc(t,{isImage:!0}),j=sh(),{enableAI:S}=xr(),{role:D,illegal:A,allowDownload:P}=mt(t),L=ff(),O=y.useCallback(G=>{const ee=G.currentTarget.getBoundingClientRect();n?p({getBoundingClientRect:()=>ee}):h({getBoundingClientRect:()=>ee})},[n,p,h]),$=y.useCallback(()=>g(t),[g,t]),M=n&&!d&&(s?P:!0),U=G=>{if(A&&F){be.error(Ts);return}k&&k==="pdf"||!v&&k==="epub"?window.open("/".concat(F?"share/":"preview/").concat(G)):k==="image"?j({uuid:G,src:I}):u(G,a)},z=n?()=>U(t):void 0;let K={splitLine:[]};return A||(s?d||(K={openLink:b,onOpen:z,onDownLoad:M?$:void 0,splitLine:[],readonly:s}):K={onPdfAI:C&&S?()=>f(t):void 0,hiddenPreview:n&&!k,onDownLoad:M?$:void 0,viewMode:_,onReplace:!a&&n?O:void 0,openLink:b,readonly:s,onOpen:z},!a&&Xn(D,m.PermissionRole.COMMENTER)&&(o==null?void 0:o.type)!==m.BlockType.FOLDER&&Object.assign(K,{onAddComment:()=>{L({blockId:t})}})),{isMobileSize:i,illegal:A,isFail:d,toolBarProps:K,openFilePreview:U,onReplace:O,downLoad:$,domain:x,openLink:b,blockRef:T,hasOverlay:!!a}},W3e=e=>{const{value:t=fr.normal,onChange:n,small:s,hiddenPreview:a}=e,o=(c,d)=>{c.preventDefault(),t!==d&&(n==null||n(d))},i=a?[fr.normal,fr.card]:[fr.normal,fr.card,fr.preview],l={[fr.normal]:"标题视图",[fr.card]:"卡片视图",[fr.preview]:"预览视图"};return r.jsx("div",{className:"flex items-center",children:i.map(c=>r.jsx(Ys,{popup:l[c],size:s?20:30,className:R("rounded animate-hover",t===c&&"bg-black_006",s&&"mx-0.5"),onClick:d=>o(d,c),children:r.jsx(V,{name:"IcMenuView".concat(sL(c)),size:"middle"})},c))})},O1=y.memo(e=>{const{onPdfAI:t,onChangeViewModel:n,onReplace:s,onDownLoad:a,onAddComment:o,openLink:i,splitLine:l=[],className:c,viewMode:d,hiddenOpen:u,readonly:f,onOpen:h,small:p,hiddenPreview:g}=e,_=p?20:30;let x=r.jsx(r.Fragment,{});i&&!u&&(h?x=r.jsx(Ys,{popup:"全屏查看",size:_,className:"rounded animate-hover",onClick:h,children:r.jsx(V,{name:"IcMenuOpen",size:"middle"})}):x=r.jsx(Fu,{to:i,children:r.jsx(Ys,{popup:"全屏查看",size:_,className:"rounded animate-hover",children:r.jsx(V,{name:"IcMenuOpen",size:"middle"})})}));const F=r.jsx(Ys,{popup:"下载",size:_,onClick:a,className:R("rounded animate-hover",p&&"ml-2.5"),children:r.jsx(V,{name:"IcDownload",size:"middle"})});return f&&i&&!u?r.jsxs("span",{className:R("flex items-center h-full cursor-default",c),children:[a&&r.jsx(r.Fragment,{children:F}),x]}):f?null:r.jsxs("span",{className:R("flex items-center h-full cursor-default",c),children:[n&&r.jsx(W3e,{small:p,hiddenPreview:g,value:d,onChange:n}),t&&r.jsx(r.Fragment,{children:r.jsx(Ys,{popup:"PDF 助手",size:_,onClick:t,className:"rounded animate-hover",children:r.jsx(V,{name:"IcAi",size:"middle"})})}),o&&r.jsxs(r.Fragment,{children:[l.includes(1)&&r.jsx("div",{className:R("h-4 w-px bg-grey4 mx-4",p&&"mx-2.5")}),r.jsx(Ys,{popup:"添加评论",size:_,onClick:o,className:"rounded animate-hover",children:r.jsx(V,{name:"IcComment",size:"middle"})})]}),l.includes(1)&&r.jsx("div",{className:R("h-4 w-px bg-grey4 mx-4",p&&"mx-2.5")}),s&&r.jsx(Ys,{popup:"替换",size:_,onClick:s,className:"rounded animate-hover",children:r.jsx(V,{name:"IcTurnInto",size:"middle"})}),a&&F,l.includes(2)&&(s||a)&&!u&&r.jsx("div",{className:R("h-4 w-px bg-grey4 mx-4",p&&"mx-2.5")}),x]})}),Pv=y.memo(e=>{const{root:t,uuid:n,title:s,context:a,className:o,isFile:i,viewModelToolBarData:l,iconName:c,ownerBlockId:d}=e,{isFail:u,toolBarProps:f,domain:h,openFilePreview:p,blockRef:g,isMobileSize:_,hasOverlay:x}=uS(e),F=ys(),b=r.jsxs(r.Fragment,{children:[r.jsx(Fn,{hasOverlay:x,blockId:n,trigger:!i,iconSize:40,defaultIcon:r.jsx(V,{size:"xxxlarge",name:c})}),r.jsxs("div",{className:"flex flex-col justify-start max-full",children:[s&&r.jsx("div",{className:"w-full text-t1",children:s}),a&&r.jsx("div",{className:"text-t4 text-grey3",children:a})]})]});return r.jsxs(wn,{blockRef:g,id:d!=null?d:n,horizontal:t,className:R(u&&"opacity-50",o),"data-draggable":!0,children:[r.jsxs("div",{className:"h-[90px] border border-black/10 rounded !cursor-default animate-hover-black3 group flex items-center justify-between pl-3 pr-3.5 overflow-x-auto",children:[i?r.jsx("div",{className:"preview-file flex items-center h-full text-ellipsis py-3 flex-1 cursor-pointer overflow-hidden w-full",onClick:()=>p(n),children:b}):r.jsx("div",{onClick:w=>{F(n,{forceOpenInRight:w.altKey,forceOpenNewTab:w.ctrlKey||w.metaKey})},className:"flex w-full text-ellipsis py-3 flex-1 space-x-2",children:b}),r.jsxs(r.Fragment,{children:[r.jsx(O1,{className:R(_?"hidden":"hidden group-hover:flex"),splitLine:[1,2],...f,...l}),r.jsx(O1,{className:R(_?"flex":"flex group-hover:hidden"),...l,viewMode:f.viewMode,onDownLoad:f.onDownLoad,openLink:f.openLink,onOpen:f.onOpen})]})]}),r.jsx(ei,{blockId:n})]})}),lk="pr-10 cursor-pointer text-ellipsis flex w-full",M1=e=>{const{root:t,uuid:n,title:s,context:a,iconName:o,isFile:i,viewModelToolBarData:l,ownerBlockId:c}=e,{illegal:d,isFail:u,toolBarProps:f,openFilePreview:h,blockRef:p,isMobileSize:g,hasOverlay:_}=uS(e),x=ys(),F=r.jsxs(r.Fragment,{children:[r.jsx(Fn,{hasOverlay:_,trigger:!i,className:"mr-1 self-center",blockId:n,iconSize:18,defaultIcon:r.jsx(V,{size:"middle",name:o})}),r.jsxs("div",{className:"flex max-w-full",children:[r.jsxs("div",{className:"relative w-full text-t1-medium text-ellipsis",children:[s,r.jsx("span",{className:"absolute bottom-px left-0 h-px bg-grey5 w-full"})]}),r.jsx("span",{className:"ml-2 text-t4 self-center mt-1 text-grey3 flex-shrink-0",children:a})]})]});return r.jsxs(wn,{blockRef:p,id:c!=null?c:n,horizontal:t,className:R("my-px",u&&"opacity-50 text-grey3",d&&"opacity-30"),"data-draggable":!0,children:[r.jsxs("div",{className:"pl-0.5 line-default animate-hover group leading-9 flex justify-between items-center h-9 overflow-x-auto",children:[i?ot.print?r.jsx("a",{href:"".concat(_n(),"/").concat(um(),"/").concat(n),className:lk,children:F}):r.jsx("div",{className:R("preview-file",lk),onClick:()=>h(n),children:F}):r.jsx("div",{onClick:b=>{x(n,{forceOpenInRight:b.altKey,forceOpenNewTab:b.ctrlKey||b.metaKey})},className:lk,children:F}),!g&&r.jsx(O1,{splitLine:[1],...f,...l,className:"hidden group-hover:flex"})]}),r.jsx(ei,{blockId:n})]})},kq=y.memo(e=>{const{root:t,title:n,context:s,iconName:a,children:o,readonly:i,viewModelToolBarData:l,className:c,smallHeder:d,isFile:u,uuid:f,ownerBlockId:h}=e,p=ye(f,["data"]),g=eh(Cp(p==null?void 0:p.data.segments).extName),_=g==="video",x=g==="image",F=g==="pdf"||g==="epub",b=g==="epub",{isFail:w,toolBarProps:E,hasOverlay:C}=uS(e),{renderSize:k,onRenderSize:T,widthBreakPoints:v,changeSize:I,containerWidth:j,containerRef:S,isDisable:D,defaultHeight:A,defaultWidth:P,pageContentWidth:L}=Nc({root:t,id:f,defaultWidth:500,defaultHeight:140}),O=O4({width:P,maxWidth:L,height:A});return r.jsxs(wn,{blockRef:S,id:h!=null?h:f,horizontal:t,className:R("my-1",w&&"opacity-50",c),children:[r.jsxs("div",{className:R("rounded border border-black/10 !cursor-default flex flex-col max-w-full group",D&&"pointer-events-none"),children:[r.jsxs("div",{className:R("h-[60px] flex justify-between pl-2 py-3 pr-3.5 items-center",o&&"border-b border-black/10",d&&"py-2"),children:[r.jsxs("div",{className:"flex text-ellipsis",children:[r.jsx(Fn,{hasOverlay:C,trigger:!u,iconSize:20,className:"mr-2 mt-0.5 flex flex-shrink-0 w-6 h-6",blockId:f,defaultIcon:r.jsx(V,{size:"middle",name:a})}),r.jsxs("div",{className:R("flex flex-col",d&&"flex-row items-center"),children:[r.jsx("div",{className:"mr-2 text-t1",children:n}),r.jsx("div",{className:"text-t4 text-grey3",children:s})]})]}),r.jsx(O1,{className:"hidden group-hover:flex",small:d,splitLine:[1,2],...E,...l}),r.jsx(O1,{className:"flex group-hover:hidden",small:d,...l,...u?{onReplace:E.onReplace,onDownLoad:E.onDownLoad}:{openLink:E.openLink}})]}),r.jsx(Ic,{widthBreakPoints:v,resizeHeight:!_,readonly:i,fullHeight:_,defaultHeight:x?O.width:A,resizeWidth:!1,defaultBlockFullWidth:!0,maxWidth:j,defaultWidth:j,onChange:I,minHeight:130,childrenClassName:"flex flex-col overflow-hidden",onRenderSize:T,className:R((F||b)&&"pb-3"),children:o})]}),r.jsx(ei,{blockId:f,style:{width:k.width}})]})}),K3e=e=>{var b;const{fileName:t,progress:n,showNotFound:s,defaultOpenUploadPanel:a,uuid:o,readonly:i,ownerBlockId:l,root:c,size:d}=e,u=Bw(),f=ye(o,["data"],["ossName","link"]),h=n!==-1&&n!==100,p=hc(o),g=y.useRef(),_=lt(),x=y.useMemo(()=>Xu(o,_),[_,o]),{extName:F}=rn(t);return h?r.jsxs("div",{className:"flex items-center w-full h-12.5 py-2.5 pl-3 rounded bg-grey8 cursor-pointer my-1 mx-[2px]",children:[r.jsx(V,{size:"large",name:"IcUploadFile",className:"text-grey4"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"ml-2 text-t2 text-grey3",children:p==null?void 0:p.name}),r.jsxs("span",{className:"ml-2 text-t4 text-grey3",children:[n,"%"]})]})]}):!(f!=null&&f.data.ossName)&&!(f!=null&&f.data.link)?r.jsx(wn,{id:l||o,horizontal:c,className:"my-1",children:r.jsx(Pwe,{title:(p==null?void 0:p.status)===is.failure?[(b=p==null?void 0:p.name)!=null?b:"","上传失败"].join(""):void 0,uuid:o,ownerBlockId:l,readonly:i,defaultOpenPanel:a})}):r.jsx(Fe,{interactive:!u,lazyLoad:!0,onShow:w=>{g.current=w},theme:"none",popupClass:"next-modal",className:"w-full",offset:[0,8],placement:x?"left":"top-start",maxWidth:1e4,delay:[500,50],animation:"shift-away",popup:r.jsx(jj,{ownerBlockId:l,uuid:o,onCloseOutsideModel:()=>{var w;(w=g.current)==null||w.hide()}}),children:r.jsx(M1,{ownerBlockId:l,root:c,uuid:o,readonly:i,isFile:!0,iconName:Ya(F),title:s?"文件已被删除":r.jsx(Ad,{fileName:t}),context:s?"0 KB":As(d)})})};const Y3e=e=>r.jsx(vc,{defaultOpenPanel:e.defaultOpenPanel,readonly:e.readonly,iconProp:{name:"IcUploadAudio",size:"normal"},text:"添加音频",onClick:e.onClick,className:e.readonly?"cursor-default":"cursor-pointer"}),X3e=e=>{var g,_;const{id:t,ownerBlockId:n}=e,s=y.useRef(null),a=n!=null?n:t,o=We(a),i=e.progress!==-1&&e.progress!==100,l=ch({uuid:a}),c=AU(),[d,u]=y.useState(c()),f=kj(),h=M_e(),p=x=>{if(s.current||(s.current=x,!x))return;x.addEventListener("error",b=>{var C,k;const w=(C=b.target)==null?void 0:C.error.code,E=(k=b.target)==null?void 0:k.error.message;if(!(!b||!e.url)){if(E){be.error(E);return}switch(w){case MediaError.MEDIA_ERR_DECODE:be.error("视频解码时发生错误");break;case MediaError.MEDIA_ERR_NETWORK:be.error("加载失败");break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:be.error("浏览器不支持播放该音频源");break}}});const F=Ps(async()=>{d&&(x.pause(),await f(),x.play(),u(!1),x.removeEventListener("playing",F))},100);x.addEventListener("playing",F),x.addEventListener("waiting",()=>h.start()),x.addEventListener("playing",()=>h.stop())};return!e.url&&!i?r.jsx(wn,{id:a,horizontal:e.root,className:"my-1",children:r.jsx(Y3e,{readonly:o,defaultOpenPanel:e.defaultOpenPanel,onClick:x=>{l(x.currentTarget,"bottom")}})}):(g=e.url)!=null&&g.startsWith("blob")?null:r.jsxs(wn,{id:a,horizontal:e.root,className:"my-2.5",children:[r.jsxs("div",{"data-column-item-min-width":"230px",className:R("flex flex-col justify-center group",n&&"pl-1 border-dashed border-grey5 border-l-[2px]"),children:[r.jsxs(Fe,{equalWidth:!0,popupClass:"whitespace-pre-wrap w-full break-words",placement:"top",className:"overflow-x-auto",popup:r.jsx(Q3e,{id:t}),offset:[0,8],children:[r.jsx(DS.AudioPlayerControlSprite,{}),r.jsx(DS.Audio,{preload:"metadata",useRepeatButton:!0,src:(_=e.url)!=null?_:"",onDidMount:p,className:R("min-w-[350px]",Mn({selectors:{"&.ce6c17":{paddingRight:"12px",backgroundColor:"var(--white2)",border:"1px solid var(--grey6)"},"& .e0b58b":{backgroundColor:"var(--white2)"},"& .cc7be8":{backgroundColor:"var(--grey6)"},"& .c7b08a":{color:"var(--grey3)"},"& .a3d9e7":{display:"none"},"& .bff2b5.a45085 .ac7b4a":{backgroundColor:"var(--grey6)"}}}))})]}),i&&r.jsxs("div",{className:"absolute flex flex-row rounded-sm bg-black opacity-75 right-2",children:[r.jsx($4,{}),r.jsxs("div",{className:"text-white1 text-t4",children:[e.progress,"%"]})]}),e.externalLink&&r.jsx("div",{className:"absolute flex items-center top-3 right-3 bg-black/75 group-hover:opacity-100 opacity-0 rounded-sm",children:r.jsx(V,{size:"middle",className:"text-white1",name:"IcGlobeShare"})})]}),r.jsx(ei,{blockId:a})]})},Q3e=e=>{const t=ye(e.id,["data"],["segments"]);return r.jsx(r.Fragment,{children:fe(t==null?void 0:t.data.segments)})},Tq=({id:e,root:t,ownerBlockId:n})=>{var l;const s=ye(e,["data","local"],["link"]),a=hc(e),{url:o}=bc(e);return ot.print?r.jsx(lS,{uuid:e}):r.jsx(X3e,{ownerBlockId:n,externalLink:!!(s!=null&&s.data.link),root:t,id:e,progress:(l=a==null?void 0:a.progress)!=null?l:-1,url:o,defaultOpenPanel:!!(s!=null&&s.local)})},J3e=e=>{var t;return r.jsx(vc,{defaultOpenPanel:e.defaultOpenPanel,readonly:e.readonly,iconProp:{name:"IcUploadVideo",size:"normal"},text:(t=e.text)!=null?t:"添加视频",onClick:e.onClick,className:e.readonly?"cursor-default":"cursor-pointer"})},Z3e=96,eIe=480,tIe=e=>{var v,I;const{id:t,ownerBlockId:n,url:s,progress:a,root:o,defaultOpenPanel:i}=e,l=n!=null?n:t,c=ye(t,["data"],["format","localUrl","size","link"]),d=We(l),u=a!==-1&&!s,f=Qa(),h=ch({uuid:l}),{renderSize:p,onRenderSize:g,changeSize:_,containerWidth:x,containerRef:F,isDisable:b,defaultBlockFullWidth:w,defaultWidth:E,defaultHeight:C,widthBreakPoints:k}=Nc({id:l,root:o,defaultHeight:(I=(v=c==null?void 0:c.data.format)==null?void 0:v.height)!=null?I:eIe,fullPageContentWidth:!0}),T=()=>{c!=null&&c.data.link&&Xt(c.data.link)};return s?r.jsx(wn,{blockRef:F,id:l,horizontal:o,fullWidth:f,className:R("my-2.5 group",o&&"self-center"),children:r.jsxs(Ic,{fullHeight:!0,resizeWidth:!0,widthBreakPoints:k,doubleResize:o,readonly:d||b,defaultBlockFullWidth:w,minWidth:Z3e,maxWidth:x||void 0,defaultWidth:E||uo,defaultHeight:C,onChange:_,onRenderSize:g,outerLayoutClassName:R(n&&"pl-1 border-dashed border-grey5 border-l-[2px]"),className:R("max-w-full",u&&"bg-black",b&&"pointer-events-none"),customFooter:r.jsx(ei,{blockId:l,style:{width:p.width}}),children:[s&&r.jsx(Ij,{videoUrl:s}),u&&r.jsxs("div",{className:"absolute flex items-center px-1.5 right-2.5 top-2.5 rounded-sm bg-black1/75",children:[r.jsx($4,{}),r.jsxs("div",{className:"text-white text-t4",children:[a,"%"]})]}),(c==null?void 0:c.data.link)&&r.jsx("div",{className:"z-10 absolute flex items-center top-2.5 right-2.5 bg-black/75 group-hover:opacity-100 opacity-0 rounded-sm animate-click",onClick:T,children:r.jsx(V,{size:"middle",className:"text-white",name:"IcGlobeShare"})})]})}):r.jsx(wn,{id:l,horizontal:o,className:"my-1",children:r.jsx(J3e,{readonly:d,defaultOpenPanel:i,onClick:j=>{u||h(j.currentTarget,"bottom")},text:u?"".concat(a,"%"):void 0})})},vq=({id:e,root:t,ownerBlockId:n,children:s})=>{var d,u;const a=ye(e,["data","local"],["extName"]),o=ye(n,["local"]),i=hc(e),{url:l}=bc(e),c=ot.print;return r.jsxs(r.Fragment,{children:[c?r.jsx(lS,{uuid:e}):r.jsx(tIe,{id:e,ownerBlockId:n,extName:a==null?void 0:a.data.extName,root:t,progress:(d=i==null?void 0:i.progress)!=null?d:-1,url:l,defaultOpenPanel:!!((u=o||a)!=null&&u.local)}),s]})},fS=y.memo(e=>{const{id:t,root:n,ownerBlockId:s}=e,a=ye(t,["data","local"],["display"]),i=ye(s,["data","local"],["display"])||a,{illegal:l}=mt(i==null?void 0:i.uuid);if(Ld({uuid:t}),i!=null&&i.data.display&&!l){let c=()=>null;switch(i.data.display){case"image":{c=M4;break}case"video":{c=vq;break}case"audio":{c=Tq;break}case"file":return r.jsxs(r.Fragment,{children:[r.jsx(gP,{...e}),e.children]})}return r.jsxs(r.Fragment,{children:[r.jsx(c,{id:t,root:n}),e.children]})}else if(l)return r.jsxs(r.Fragment,{children:[r.jsx(M1,{uuid:t,root:n,ownerBlockId:s,isFile:!0,title:Ts,iconName:Ya("")}),e.children]});return r.jsxs(r.Fragment,{children:[r.jsx(gP,{...e}),e.children]})}),gP=({id:e,root:t,ownerBlockId:n})=>{var _,x;const s=ye(e,["data","local"],["segments","viewMode","ossName","size","localUrl","showEmptyCaption","link"]),a=ye(n,["data"],["viewMode"]),o=hc(e),i=We(n!=null?n:e),l=fe(s==null?void 0:s.data.segments),c=Cq(n||e),d=Bw(),u=!s,f=(o==null?void 0:o.status)===is.uploading,h=(_=a||s)==null?void 0:_.data.viewMode;let p=r.jsx(r.Fragment,{}),g="default";return!s||!s.data.ossName&&!s.data.link||f||h===fr.normal||!h?(p=r.jsx(K3e,{root:t,ownerBlockId:n,readonly:i,progress:(x=o==null?void 0:o.progress)!=null?x:-1,fileName:l,size:s==null?void 0:s.data.size,showNotFound:u,defaultOpenUploadPanel:!!(s!=null&&s.local),uuid:e}),!(s!=null&&s.data.ossName)&&!(s!=null&&s.data.link)&&(g=void 0)):h===fr.card?(p=r.jsx(nIe,{root:t,uuid:e,onReplace:()=>{},ownerBlockId:n,isFile:!0,showNotFound:u,readonly:i,title:l||qt(m.BlockType.FILE),context:As(s==null?void 0:s.data.size),iconName:Ya(rn(l).extName)}),g="small"):h===fr.preview&&(p=r.jsx(sIe,{root:t,uuid:e,onReplace:()=>{},ownerBlockId:n,isFile:!0,showNotFound:u,readonly:i,title:l||qt(m.BlockType.FILE),context:As(s==null?void 0:s.data.size),iconName:Ya(rn(l).extName)}),g="large"),r.jsx(Fe,{theme:"next-modal",placement:"top-end",interactive:!d,interactiveDebounce:0,animation:"shift-away",className:"my-1",popup:g&&!i&&!pt()?r.jsx(z4,{showType:g,onClick:F=>{switch(F){case"default":c("normal");break;case"small":c("card");break;case"large":c("preview");break}}}):void 0,children:p})},nIe=e=>{const{root:t,uuid:n,ownerBlockId:s,showNotFound:a,readonly:o}=e,i=ye(n,["data"],["segments","size"]),l=fe(i==null?void 0:i.data.segments),c=y.useRef(),d=lt(),u=y.useMemo(()=>Xu(n,d),[d,n]);return a?r.jsx(Pv,{root:t,uuid:n,onReplace:()=>{},ownerBlockId:s,isFile:!0,title:"文件已被删除",context:"0 KB",iconName:Ya(),readonly:o}):r.jsx(Fe,{lazyLoad:!0,onShow:f=>{c.current=f},theme:"none",popupClass:"next-modal",interactive:!0,className:"w-full",offset:[0,8],placement:u?"left":"top-start",maxWidth:1e4,delay:[500,50],animation:"shift-away",popperOptions:{modifiers:[{name:"flip",options:{fallbackPlacements:u?["left","right","bottom","bottom-start","top-start"]:["top-start","bottom-start","left","right"]}}]},popup:r.jsx(jj,{ownerBlockId:s,uuid:n,onCloseOutsideModel:()=>{var f;(f=c.current)==null||f.hide()}}),children:r.jsx(Pv,{root:t,uuid:n,onReplace:()=>{},ownerBlockId:s,isFile:!0,readonly:o,title:l||qt(m.BlockType.FILE),context:As(i==null?void 0:i.data.size),iconName:Ya(rn(l).extName)})})},sIe=e=>{const{uuid:t,ownerBlockId:n,root:s,readonly:a,title:o}=e,i=ye(t,["data"],["size"]),l=ng(),{extName:c}=rn(o),d=eh(c),{url:u,loading:f}=bc(t),h=po(i==null?void 0:i.spaceId),p=ya(),g=h&&d==="epub",_=y.useMemo(()=>Jo(u,c),[c,u]);return f?r.jsx(xs,{}):r.jsx(kq,{uuid:t,root:s,ownerBlockId:n,isFile:!0,smallHeder:!0,readonly:a,className:"group",title:u?o||qt(m.BlockType.FILE):"文件已被删除",context:u?As(i==null?void 0:i.data.size):"0 KB",iconName:Ya(c),children:u&&d&&!g?r.jsx("div",{className:R("flex justify-center h-full max-h-full w-full",{"pointer-events-none":l}),children:r.jsx(Nj,{uuid:t,downloadUrl:_,useSimpleImg:!0,embed:!0,style:{width:"100%"}})}):r.jsxs("div",{className:"flex flex-col items-center justify-center h-full bg-grey8 text-grey4 text-t2",children:[r.jsx(V,{name:"IcUploadImageFaild",size:"large",className:"mb-2"}),r.jsx("div",{children:u?g&&!pt()?"仅专业版/团队版支持预览":"文件不支持预览":"文件被删除"}),g&&!pt()&&r.jsx(De,{className:"mt-1 text-t2",onClick:()=>{p(Mt.view_epub)},children:"升级空间"})]})})},rIe=({id:e,root:t,children:n})=>{const{expand:s,toggle:a}=X4(e),o=ye(e,["subNodes"]),i=Nr(),l=Oe(),c=We(e);if(!o)return null;const d=f=>{f.stopPropagation(),l(()=>{const h=ut({},{parentId:o.uuid,after:o.uuid});i(h,0)})},u=ot.print||s;return r.jsxs(wn,{id:e,className:"my-px",horizontal:t,children:[r.jsxs("div",{className:R("block-has-icon-container ignore-focus-click flex-1 overflow-hidden",c&&"animate-click select-auto"),onClick:()=>{c&&a()},children:[r.jsx(Ex,{"data-no-cancel-selected":!0,className:"block-before-icon-mt",children:r.jsx("span",{className:"flex animate-hover",children:r.jsx(V,{size:"large",name:"IcToggleBlack",onClick:a,className:R("transition duration-150 cursor-pointer",{"rotate-90":u,"opacity-30":o.subNodes.length===0})})})}),r.jsx(Hi,{className:"self-start mr-4 flex-1 w-0",uuid:e,placeholder:"折叠列表"})]}),u&&r.jsx(ec,{blockId:e,children:o.subNodes.length?n:pt()?null:r.jsx("div",{className:"flex items-center w-full animate-hover cursor-pointer h-9 text-t2 p-1 my-px text-grey3 print:hidden",onClick:d,children:"内容为空，点击编辑"})})]})},aIe=()=>y.useCallback(async e=>{const t=await ve.editor.getDoc.raw(e);if(t.code!==200)return t.code;const{blocks:{[e]:n,...s}}=t.data;re(Tn.update({blocks:s}))},[]),Lv=({id:e,root:t,ownerBlockId:n})=>{var C,k;const s=ye(e,["subNodes","data"],["viewMode"]),a=ye(n,["data"],["ref","viewMode"]),o=We(e),i=!!((C=a==null?void 0:a.data.ref)!=null&&C.uuid&&!s),l=rE(e),c=(k=a==null?void 0:a.data.viewMode)!=null?k:s==null?void 0:s.data.viewMode,{illegal:d}=mt(e),u=Un(),f=U9(e),h=(s==null?void 0:s.subNodes.length)||0,p=Cq(n||e),g=y.useRef(),_=lt(),x=y.useMemo(()=>Xu(e,_),[_,e]),F=Bw();if(d)return r.jsx(M1,{uuid:e,root:t,ownerBlockId:n,isFile:!0,title:Ts,iconName:h?"IcFolderContent":"IcFolder"});if(f>0&&l.folder.length+l.files.length===0)return r.jsx(M1,{ownerBlockId:n,root:t,uuid:e,readonly:o,iconName:h?"IcFolderContent":"IcFolder",title:"文件夹上传中 还剩 ".concat(f," 个"),context:"".concat(h," 项内容")});const b={showNotFound:i,uuid:e,root:!!t,ownerBlockId:n,fileCount:h,readonly:o};let w=r.jsx(Fe,{lazyLoad:!0,interactive:!F,onShow:T=>{g.current=T},theme:"none",popupClass:"next-modal",offset:[0,5],placement:x?"left":"top-start",className:"w-full",maxWidth:1e4,delay:[500,50],animation:"shift-away",popup:r.jsx(Du,{pageId:e,isLink:!!n,onCloseOutsideModel:()=>{var T;(T=g.current)==null||T.hide()}}),children:r.jsx(oIe,{...b})}),E="default";return c===fr.card&&(w=r.jsx(Fe,{lazyLoad:!0,onShow:T=>{g.current=T},theme:"none",interactive:!0,popupClass:"next-modal",offset:[0,5],placement:x?"left":"top-start",className:"w-full",maxWidth:1e4,delay:[500,50],animation:"shift-away",popup:r.jsx(Du,{pageId:e,isLink:!!n,onCloseOutsideModel:()=>{var T;(T=g.current)==null||T.hide()}}),children:r.jsx(_P,{...b})}),E="small"),c===fr.preview&&(u===wt.PAGE_HISTORY&&(w=r.jsx(_P,{...b}),E="small"),w=r.jsx(lIe,{...b}),E="large"),r.jsx(Fe,{theme:"next-modal",placement:"top-end",className:"my-1",interactive:!0,animation:"shift-away",interactiveDebounce:0,popup:!o&&!pt()&&r.jsx(z4,{showType:E,onClick:T=>{switch(T){case"default":p("normal");break;case"small":p("card");break;case"large":p("preview");break}}}),children:w})},oIe=e=>{const{uuid:t,root:n,ownerBlockId:s,showNotFound:a,readonly:o,fileCount:i}=e,l=ye(t,["data","subNodes"],["segments"]),c=fe(l==null?void 0:l.data.segments)||qt(m.BlockType.FOLDER);return r.jsx(M1,{ownerBlockId:s,root:n,uuid:t,readonly:o,iconName:i?"IcFolderContent":"IcFolder",title:a?"文件夹已被删除":c,context:"".concat(i," 项内容")})},_P=e=>{const{uuid:t,ownerBlockId:n,root:s,fileCount:a,showNotFound:o,readonly:i}=e,l=ye(t,["data"],["segments"]),c=()=>{},d=fe(l==null?void 0:l.data.segments)||qt(m.BlockType.FOLDER);return r.jsx(Pv,{root:s,uuid:t,onReplace:c,ownerBlockId:n,readonly:i,title:o?"文件夹已被删除":d,context:"".concat(a," 项内容"),iconName:a?"IcFolderContent":"IcFolder"})},xP=e=>{const{block:t,readonly:n,clickFolder:s}=e,a=t.type===m.BlockType.FILE,o=fe(t.data.segments)||qt(t.type),i=rn(o),l=fh(),c=dh(),d=y.useRef(null),u=lY(d.current),f=sh(),{illegal:h}=mt(t.uuid),p=y.useCallback(()=>{if(a)if(Jt.pdf.test(i.extName))window.open("/".concat(pt()?"share/":"preview/").concat(t.uuid));else{if(_3(i.extName)){f({uuid:t.uuid});return}l(t.uuid)}else s==null||s(t.uuid,o)},[t.uuid,s,i.extName,o,a,l,f]),g=y.useCallback(_=>{_.preventDefault(),_.stopPropagation(),c([t.uuid])},[t.uuid,c]);return r.jsxs("div",{ref:d,className:"flex items-center justify-between px-1 cursor-pointer h-11 text-t2 animate-hover-black3",onClick:p,children:[r.jsxs("div",{className:"flex w-full items-center",children:[a?r.jsx(V,{name:Ya(i.extName),className:"ml-1 mr-2",size:"middle"}):r.jsx(Fn,{iconSize:20,blockId:t.uuid,className:"mr-2",defaultIcon:r.jsx(_s,{uuid:t.uuid,size:"middle"})}),r.jsx(Fe,{placement:"top-start",arrow:!0,className:"w-full pr-9",popup:o,children:a?r.jsx(Ad,{fileName:o}):r.jsx("span",{children:o})})]}),r.jsx("div",{className:"flex",children:!n&&!h&&r.jsx(V,{name:"IcDownload",onClick:g,className:R("transition-opacity rounded-sm animate-hover",u?"opacity-100":"opacity-0"),size:"middle"})})]})},iIe=e=>{const{navs:t,clickFolder:n}=e,s=ie(),a=(l,c)=>r.jsxs("div",{className:"flex items-center",children:[c!==0&&r.jsx("div",{className:"px-0.5 text-grey4",children:"/"}),r.jsx(Fe,{popup:l.title||qt(m.BlockType.FOLDER),onClick:()=>n(l.uuid,l.title),className:R("block rounded-sm animate-hover text-ellipsis max-w-[200px]",c!==0?"px-2":"px-0.5"),children:l.title||qt(m.BlockType.FOLDER)})]},l.uuid),o=Br(t).splice(1,t.length-2),i=l=>{s.dropdown({popcorn:l.currentTarget,placement:"bottom",offset:[0,4],content:({onCloseModal:c})=>r.jsx("div",{className:"w-44 p-2 next-modal overflow-y-auto max-h-[30vh]",children:o.map(d=>r.jsxs("div",{onClick:()=>{n(d.uuid,d.title),c()},className:"flex items-center p-2 rounded cursor-pointer animate-hover text-t2",children:[r.jsx(_s,{uuid:d.uuid,size:"middle",className:"mr-2"}),r.jsx("div",{className:"text-ellipsis",children:d.title||qt(m.BlockType.FOLDER)})]},d.uuid))})})};return t.length>3?r.jsxs(r.Fragment,{children:[a(t[0],0),r.jsx("span",{className:"px-0.5 text-grey4",children:"/"}),r.jsx(Ys,{popup:"查看折叠的页面路径",onClick:i,className:"rounded-sm cursor-pointer animate-hover",children:"..."}),a(An(t),t.length-2)]}):r.jsx(r.Fragment,{children:t.map((l,c)=>a(l,c))})},lIe=e=>{const{uuid:t,ownerBlockId:n,root:s,showNotFound:a,readonly:o}=e,[i,l]=y.useState(t),c=ye(t,["data","subNodes"],["segments"]),[d,u]=y.useState(),[f,h]=y.useState(!1),[p,g]=y.useState([]),_=aIe(),x=ns(),F=rE(i),b=U9(i),w=F.folder.length+F.files.length+b;y.useEffect(()=>{l(t),g([])},[t]),y.useEffect(()=>{var T;if(a&&!w||i===t&&((T=c==null?void 0:c.subNodes)!=null?T:0)===0){u(null);return}h(!0);const k=setTimeout(()=>{_(i).then(v=>{u(v),h(!1)})},500);return()=>{clearTimeout(k)}},[i,_,a,w,t,c==null?void 0:c.subNodes]);const E=(k,T)=>{g(v=>{const I=v.findIndex(j=>j.uuid===k);return t===k?[]:I===-1?(v.push({uuid:k,title:T}),v):(v.splice(I+1,v.length-I),v)}),l(k)},C=y.useMemo(()=>{const k=d===1403,T=r.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 h-full text-grey3 text-t2 bg-grey6",children:[r.jsx(V,{name:"IcUploadImageFaild",size:"large",className:"mb-2"}),r.jsx("span",{children:k?"无法访问该页面":"文件夹已被删除"}),k&&r.jsx("span",{className:"mt-1 text-grey3",children:"当前页面并未开启分享"})]});if(a)return T;switch(d){case 1403:case 3005:case 1600:return T;default:return null}},[d,a]);return r.jsx(kq,{root:s,uuid:t,ownerBlockId:n,readonly:o,title:r.jsx("div",{className:"flex items-center",children:a&&!w?"文件夹已被删除":r.jsx(iIe,{navs:[{uuid:t,title:fe(c==null?void 0:c.data.segments)},...p],clickFolder:E})}),context:"".concat(w," 项内容"),iconName:w?"IcFolderContent":"IcFolder",viewModelToolBarData:{onOpen:()=>{x.push("/".concat(i))}},children:r.jsx(Og,{uuid:i,children:d||a?C:w>0?r.jsxs("div",{className:"overflow-x-hidden overflow-y-auto",children:[r.jsx(cIe,{uuid:i}),F.folder.map(k=>r.jsx(xP,{readonly:o,block:k,clickFolder:E},k.uuid)),F.files.map(k=>r.jsx(xP,{readonly:o,block:k},k.uuid))]}):r.jsx("div",{className:"flex flex-col items-center justify-center h-full bg-grey8 text-grey4 text-t2",children:f?r.jsx(xs,{}):r.jsxs(r.Fragment,{children:[r.jsx(V,{name:"IcUploadImageFaild",size:"large",className:"mb-2"}),r.jsx("span",{children:"当前文件夹为空"})]})})})})},cIe=({uuid:e})=>{const t=M9(e);return r.jsx(r.Fragment,{children:t.map(n=>{var o,i;const s=(o=n.name)!=null?o:"",a=rn(s);return r.jsxs("div",{className:"relative flex px-2 py-3 text-t2 animate-hover-black3 group",children:[r.jsx(V,{name:Ya(a.extName),size:"middle",className:"mr-2"}),r.jsx(Ad,{className:"sm:leading-[15px]",fileName:s}),r.jsx(j4,{progress:(i=n.progress)!=null?i:-1,fail:n.status===is.failure,className:R("absolute z-10 h-[3px] w-full left-0 bottom-[0px] ")})]},n.key)})})},dIe=({id:e,root:t,children:n})=>{const s=ye(e,["data"],["level"]),a=Un();if(!s)return null;const{level:o=1}=s.data;return r.jsxs(wn,{id:e,TagName:"h".concat(o),horizontal:t,className:R("heading",a!==wt.PAGE_FEEDS&&{"mt-[25px] mb-px":o===1,"mt-[15px] mb-px":o===2,"my-2":o===3,"my-px":o===4}),children:[r.jsx(Hi,{className:R("w-full px-0.5",{"text-h1 py-1.5":o===1,"text-h2 py-2":o===2,"text-h3 py-0.5":o===3,"text-h4 py-0.5":o===4}),uuid:e,placeholder:"标题".concat(o)}),n&&r.jsx(ec,{blockId:e,children:n})]})},uIe=({id:e,root:t,children:n})=>{const[s]=Rd(e,{defaultOpen:!0}),a=Ce(i=>{const{blocks:l}=i;return t4(e,l)},[e]),o=ot.print||s;return r.jsxs("div",{className:"relative",children:[r.jsx(Y4,{id:e}),r.jsxs(wn,{id:e,className:"relative my-px",horizontal:t,children:[r.jsxs("div",{className:"block-has-icon-container flex-1",children:[r.jsx("div",{className:"min-w-[24px] mr-1 text-center inline-block dot",children:a}),r.jsx(Hi,{uuid:e,className:"self-start flex-1 w-0",placeholder:"编号列表"})]}),n&&o&&r.jsx(ec,{blockId:e,children:n})]})]})},vx=({id:e,root:t,ownerBlockId:n})=>{var u;const s=n!=null?n:e,{illegal:a}=mt(e),o=lt(),i=ye(e,["subNodes","data","hidden"],["format"]),l=(u=i==null?void 0:i.data.format)==null?void 0:u.cardFormat,c=i==null?void 0:i.hidden,d=Xu(s,o);return c?null:r.jsx(wn,{id:s,className:R("my-1",a&&"opacity-30",(l==null?void 0:l.showType)==="large"?d?"w-full":"w-fit":""),horizontal:t,"data-draggable":!0,children:r.jsx(iz,{id:e,root:t,ownerBlockId:n})},s)},fIe=({id:e,root:t,children:n})=>ye(e,["textColor"])?r.jsx(wn,{id:e,className:"py-1 my-px w-full pr-2",horizontal:t,children:r.jsxs("div",{className:"pl-2 border-l-4 border-solid border-current",children:[r.jsx(wn,{dropInChild:!0,bindId:!1,id:e,children:r.jsx(Hi,{uuid:e,placeholder:"引述文字",className:"w-full text-t1 px-0.5"})}),n]})}):null,mIe=({id:e,root:t})=>{var o,i,l,c;const n=ye(e,["data"],["ref","display"]),s=ye((o=n==null?void 0:n.data.ref)==null?void 0:o.uuid,[]);if(Ld({uuid:e}),!n)return null;let a=()=>r.jsx(r.Fragment,{});switch(n.data.display){case"image":{a=M4;break}case"file":{a=fS;break}case"folder":{a=Lv;break}case"video":{a=vq;break}case"audio":{a=Tq;break}case"linkPage":{(s==null?void 0:s.type)===m.BlockType.FOLDER?a=Lv:a=vx;break}default:(i=n.data.ref)!=null&&i.uuid&&s&&(a=_j(s.type))}return r.jsx(a,{id:(c=(l=n.data.ref)==null?void 0:l.uuid)!=null?c:"",root:t,ownerBlockId:e})},hIe={},Iq=()=>y.useCallback(async(e,t)=>{let n=hIe[e];return n||(n=mo(async()=>{var a;const s=await ve.editor.getDocBacklinks.raw(e);if(s.code===200){re(Tn.update({blocks:s.data.recordMap.blocks}));const o=dg(s.data.results,"pageId");return o.unshift({pageId:ks(t),uuid:t,spaceId:(a=J.blocks[t])==null?void 0:a.spaceId}),{result:o,pageCount:Number(s.data.backlinkPageCount)}}})),n},[]),yP=10,pIe=e=>{const{backLinks:t,total:n}=e,[s,a]=y.useState(t.length<=yP),o=y.useRef(null),i=s?t:RL(t,yP),l=t.length-i.length,c=n-t.length;return r.jsxs("div",{ref:o,className:"shadow-modal bg-white1 border border-grey6 rounded w-[400px] max-h-[65vh] overflow-scroll",children:[r.jsx(Um,{defaultIndex:-1,listenPriority:dr,containerRef:o,itemCount:i.length,children:d=>i.map((u,f)=>r.jsx(gIe,{uuid:u.uuid,pageId:u.pageId,selected:d===f},u.uuid))}),l>0&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-grey6 h-px w-full text-t4 "}),r.jsxs("div",{className:"flex py-4 items-center ml-4 cursor-pointer text-t4 text-grey3",onClick:()=>{a(!0)},children:["其他 ",l," 个页面"]})]}),s&&c>0&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-grey6 h-px w-full"}),r.jsxs("div",{className:"flex items-center text-t4 ml-4 text-grey3 py-4",children:[r.jsx(V,{name:"IcLock",size:"middle",style:{color:"var(--grey3)"}}),r.jsxs("div",{children:["还有 ",c," 个页面你暂无权限"]})]})]})]})},gIe=e=>{const{uuid:t="",pageId:n="",selected:s=!1,...a}=e,o=ye(n,["data","permissions"],["segments"]),i=ye(t,[]),l=lt(),c=Lw(),d=Dt(),u=eI(d.planType),{illegal:f}=mt(n),{permissions:h}=mt(t),p=go(n),g=ys(),_=y.useRef();return!o||!n||!t?null:r.jsx(Fe,{lazyLoad:!0,onShow:x=>{_.current=x},theme:"none",interactive:!0,popupClass:"next-modal",offset:[0,5],disabled:l===n,placement:"top",className:"w-full",maxWidth:1e4,delay:[500,50],animation:"shift-away",popup:r.jsx(Du,{pageId:n,blockId:t,onCloseOutsideModel:()=>{var x;(x=_.current)==null||x.hide()}}),children:r.jsxs(Fu,{to:"".concat(p,"#").concat(t),className:R("flex items-center text-t2-medium w-full animate-hover rounded-sm h-10  p-4 justify-between text-ellipsis",f&&"opacity-30",{"normal-bg":s}),...a,onClick:x=>{l!==n&&(x.preventDefault(),g(n,{hash:"#".concat(t),forceOpenInRight:x.altKey,forceOpenNewTab:x.ctrlKey||x.metaKey}))},children:[r.jsxs("div",{className:"flex items-center overflow-hidden",children:[r.jsx(Fn,{blockId:n,trigger:!1,iconSize:18,defaultIcon:r.jsx(_s,{uuid:n,size:"middle"})}),r.jsx("div",{className:"text-ellipsis underline ml-1 mr-1.5 text-black decoration-grey5",children:f?Ts:fe(o.data.segments)||qt(o.type)})]}),r.jsxs("div",{className:"flex text-t2",children:[h.every(x=>An([...c(t)])!==o.spaceId||u?!1:x.type===m.PermissionType.SPACE||x.type===m.PermissionType.GROUP?x.role===m.PermissionRole.NONE:x.type===m.PermissionType.USER?x.role!==m.PermissionRole.NONE&&x.userId===yt.uuid:!0)&&r.jsxs("span",{className:"flex items-center text-red text-t4-medium mr-1",children:[r.jsx(V,{name:"IcLock",size:"middle"}),r.jsx("span",{children:"仅我可见"})]}),(i==null?void 0:i.type)===m.BlockType.SYNC_CONTAINER&&r.jsx("div",{className:"px-1.5 bg-grey/20 rounded text-grey2/80",children:"源同步块"}),l===n&&r.jsx("div",{className:"ml-1 px-1.5 bg-grey/20 rounded text-grey2/80",children:"当前页"})]})]})})},_Ie=e=>{const{blockId:t,syncBlockId:n}=e,[s,a]=y.useState(e.backLinks),[o,i]=y.useState(e.total),l=A0(),c=uh(),d=ie(),u=I3(),f=Iq(),h=y.useContext(od),p=s9();y.useEffect(()=>{p(!1),s.length===0&&setTimeout(async()=>{const _=await f(t,n);_&&(Ls.unstable_batchedUpdates(()=>{a(_.result),i(_.pageCount)}),e.updateSyncInfo(_.result,_.pageCount))},1e3)},[s.length,t,f,e,p,n]),y.useEffect(()=>()=>{d.closeModal(Ve.SYNC_BLACK_LINK)},[d]);const g=uee(t)||u;return r.jsxs("div",{"data-no-cancel-selected":!0,className:R("flex items-center border border-grey6 rounded-sm shadow-modal bg-white1 text-t2 h-9 cursor-pointer","".concat(g?"hidden":"duration-300 opacity-100")),children:[r.jsxs("div",{className:"flex items-center p-2 animate-hover",onClick:async _=>{const x=_.currentTarget.getBoundingClientRect(),F=await f(t,n);F&&(Ls.unstable_batchedUpdates(()=>{a(F.result),i(F.pageCount)}),e.updateSyncInfo(F.result,F.pageCount),d.dropdown({modalId:Ve.SYNC_BLACK_LINK,offset:[-19,4],placement:"bottom",popcorn:{getBoundingClientRect:()=>x},content(){return r.jsx(od.Provider,{value:h,children:r.jsx(pIe,{backLinks:F.result,total:F.pageCount})})}}))},children:[o<=0&&r.jsx("div",{children:"暂无页面同步"}),!(o<=0)&&"".concat(o,"个页面正在同步"),r.jsx(V,{name:"IcArrowDown01",size:"normal",className:"text-grey4 pl-1"})]}),r.jsx("div",{className:"w-[1px] h-9 bg-grey6"}),r.jsx("div",{className:"animate-hover p-2",onClick:()=>{Lne(t),be.success({content:"已复制，你可以粘贴到任意页面生成同步块"}),p(!0),st({$focusedInSyncBlockId:""}),l()},children:"复制并同步"}),r.jsx("div",{className:"w-[1px] h-9 bg-grey6"}),r.jsx("div",{className:"animate-hover flex items-center p-2",onClick:_=>{c({blockId:t,blockNode:_.currentTarget,placement:"bottom-start",offset:[0,-5]})},children:r.jsx(V,{name:"IcMore",size:"middle"})})]})},Nq=({id:e,ownerBlockId:t,children:n})=>{const s=y.useRef(null),a=ie(),o=ln(),i=y.useRef(),l=t||e,c=We(l),{role:d}=mt(e),u=d9()===l,f=A0(),[h,p]=y.useState([]),[g,_]=y.useState(0),x=y.useRef(),F=y.useContext(od),b=Ce(({ui:{selectedBlocks:S}})=>l?S.length===1&&S.findIndex(D=>D.blockId===l)!==-1:!1,[l],{obsSelectBlocks:[{blockId:l}]}),w=Oe(),E=y.useMemo(()=>n===void 0?!0:Array.isArray(n)?n.length===0:!1,[n]),C=ye(e,[]),k=Nr(),v=!m0(Ve.DOC_HISTORY_MODAL_ID)&&(u||b)&&!c,I=!!C,j=Iq();return y.useEffect(()=>{I&&(pt()||j(l,e).then(S=>{var D;S&&(Ls.unstable_batchedUpdates(()=>{p(S.result),_(S.pageCount)}),t&&xn.emit("syncBlock",{uuid:t,pageId:(D=ks(e))!=null?D:"",spaceId:Ot()}))}))},[l,e,t,I,j]),y.useEffect(()=>()=>{x.current&&clearTimeout(x.current),a.closeModal("dropDownContent-sync")},[a]),y.useEffect(()=>{const S=D=>{const{uuid:A,pageId:P,spaceId:L}=D;h.length===0||h.some($=>$.pageId===P&&$.uuid!==e)||(p([...h,{uuid:A,pageId:P,spaceId:L}]),_($=>$+1))};return xn.on("syncBlock",S),()=>{xn.off("syncBlock",S)}},[h,e]),y.useEffect(()=>{if(pt())return;const S=s.current;S&&(x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{if(v){if(i.current)return;i.current=a.dropdown({id:"dropDownContent-sync",autoClose:!1,mask:!1,flip:!1,placement:"top-end",popcorn:S,closeBeforeCallBack:()=>{i.current=void 0},content({onCloseModal:D}){return r.jsx(od.Provider,{value:F,children:r.jsx(_Ie,{updateSyncInfo:(A,P)=>{Ls.unstable_batchedUpdates(()=>{p(A),_(P)})},syncBlockId:e,closeSyncMenu:D,backLinks:h,blockId:l,total:g})})}}).modalId}else i.current&&o(i.current,{noAnimation:!0})},50))},[f,o,e,a,v,l,h,g,F]),xIe(s,l),Gp(()=>{i.current&&o(i.current)}),C?r.jsx(wn,{id:l,className:"py-1",blockRef:s,"data-sync-count":"".concat(g),"data-sync-container-id":l,bindId:!u,children:r.jsxs("div",{className:R("px-[1px] rounded border border-transparent min-h-[36px]  ",{"border-red border-opacity-70":b&&!c},{"hover:border-red hover:border-opacity-40 focus-within:!border-red focus-within:!border-opacity-70":!c},{"flex items-center":E}),children:[E&&!c&&(d===m.PermissionRole.EDITOR||d===m.PermissionRole.WRITER)&&r.jsx(wn,{dropInChild:!0,className:"my-1",bindId:!1,id:l,children:r.jsx("div",{className:"cursor-pointer text-grey4",onClick:()=>{w(()=>{const S=ut({},{parentId:e,last:!0});k(S,0,void 0,{syncId:l})})},children:"点击或拖拽添加内容，然后粘贴到其他页面进行同步"})}),r.jsx(NI.Provider,{value:c,children:r.jsx(TO.Provider,{value:l,children:n})})]})}):null},xIe=(e,t)=>{y.useEffect(()=>{const n=e.current,s=o=>{if(o.target instanceof Element){if(o.target.closest("[data-no-cancel-selected]")||o.target.id===y0)return;const i=o.target.closest("[data-sync-container-id]");if(i instanceof HTMLElement&&i.dataset.syncContainerId===t)return;xt.$focusedInSyncBlockId===t&&st({$focusedInSyncBlockId:""}),Ht.removeEventListener("mousedown",s)}},a=()=>{xt.$focusedInSyncBlockId!==t&&(st({$focusedInSyncBlockId:t}),xn.emit("removeHoverMenu")),Ht.addEventListener("mousedown",s)};return n==null||n.addEventListener("focusin",a),()=>{n==null||n.removeEventListener("focusin",a),Ht.removeEventListener("mousedown",s)}},[t,e])},yIe=({id:e,root:t})=>{var i;const n=ye(e,["data"],["ref"]),s=ye((i=n==null?void 0:n.data.ref)==null?void 0:i.uuid,["subNodes"]),a=!!Ks(),o=y.useMemo(()=>s==null?void 0:s.subNodes.map(l=>r.jsx(Xm,{visibleRender:K_.innerHtml,id:l},l)),[s==null?void 0:s.subNodes]);return!n||!s||a?null:r.jsx(Nq,{id:s.uuid,root:t,ownerBlockId:e,children:o})},bP={startX:0,startY:0,minX:0,minY:0,minRowIndex:0,minColumnIndex:0,originRows:[""],maxRows:[""],originColumns:[""],maxColumns:[""],localBlock:new Set},bIe=120,FP=38,FIe=18,wP=40,EP={row:["加一行","快速加/减行"],column:["加一列","快速加/减列"],corner:["加一行和一列","快速加/减行和列"]},CP={row:"dragging-row",column:"dragging-col",corner:"dragging-nwse"},ck=({tableRef:e,tableId:t,type:n,indexRanges:s})=>{var w,E;const[{width:a,height:o},i]=y.useState({width:0,height:0}),l=Ce(({blocks:C,simpleTable:k})=>{var G,ee;const T=C[t];if(!T)return!1;const{hoveringCell:v,activityTableId:I}=k;if(!v||I!==t)return!1;const{subNodes:j,data:S}=T,{format:D={}}=S,A=(G=D.tableBlockColumnOrder)!=null?G:[],{rowIndex:P,columnIndex:L}=v,O=j[P],$=A[L];if(!O||!$)return!1;let M=0,U=0;const K=((ee=D.tableBlockRanges)!=null?ee:[]).find(({start:te})=>te&&te[0]===O&&te[1]===$);if(K){const{start:te,end:Q}=K;if(te&&Q&&te[1]&&Q[1]){const ne=A.indexOf(te[1]);M=A.indexOf(Q[1])-ne+1}if(te&&Q&&te[0]&&Q[0]){const ne=j.indexOf(te[0]);U=j.indexOf(Q[0])-ne+1}}const W=v.rowIndex+Math.max(0,U-1)===j.length-1,Y=v.columnIndex+Math.max(0,M-1)===A.length-1;return n==="row"?W:(n==="column"||W)&&Y},[n],{obsSimpleTable:!0}),[c,d]=y.useState(0),u=ye(t,["data","subNodes"],["format"]),[f,h]=y.useState(!1),{draggingInThisTable:p,draggingBar:g}=Ce(({simpleTable:C})=>({draggingInThisTable:C.activityTableId===t&&!!C.draggingBarType,draggingBar:C.activityTableId===t&&C.draggingBarType===n}),[t,n],{obsSimpleTable:!0}),_=y.useRef(AS(bP)),x=Oe(),F=(E=(w=u==null?void 0:u.data.format)==null?void 0:w.tableBlockColumnOrder)!=null?E:[];if(y.useLayoutEffect(()=>{setTimeout(()=>{if(!e.current)return;const C=e.current.getBoundingClientRect();i({width:C.width,height:C.height})})},[e,l,g,p,u==null?void 0:u.subNodes.length,F.length]),y.useEffect(()=>{var k;if(!e.current)return;const C=(k=e.current.closest('[data-virtuoso-scroller="true"]'))==null?void 0:k.parentElement;if(n!=="row"&&C){const T=parseInt(getComputedStyle(C).getPropertyValue("padding-left"),10);d(a+T)}},[l,e,n,a]),y.useEffect(()=>{if(!g)return;const C=()=>{var $,M;re(Ns.update({activityTableId:void 0,draggingBarType:void 0}));const v=document.getElementById("root");v==null||v.classList.remove(CP[n]);const I=_.current.originRows.slice(),j=_.current.originColumns.slice();_.current=AS(bP);const S=J.blocks[t];if(!S)return;const{subNodes:D,data:A}=S,{format:P}=A,L=($=P==null?void 0:P.tableBlockColumnOrder)!=null?$:[],O=(M=P==null?void 0:P.tableBlockColumnFormat)!=null?M:{};n==="corner"&&me.event("simpletable_add_drag"),n!=="row"&&_e(t,{data:{format:{tableBlockColumnOrder:j}}},!0),x(()=>{if(n!=="column"&&(D.length<I.length?I.filter(U=>!D.includes(U)).forEach(U=>{Ro(U)}):D.length>I.length&&(_e(t,{subNodes:I},!0),D.filter(U=>!I.includes(U)).reduce((U,z)=>{var K;return(K=J.blocks[z])!=null&&K.data.collectionProperties||ut({uuid:z,type:m.BlockType.TABLE_ROW},{parentId:t,after:U}),U},An(I)))),n!=="row")if(L.length<j.length){const U=L.reduce((z,K)=>{const W=O[K];return W&&(z[K]=W),z},{});_e(t,{data:{format:{tableBlockColumnOrder:L,tableBlockColumnFormat:U}}})}else L.length>j.length&&_e(t,{data:{format:{tableBlockColumnOrder:L}}})})},T=Ps(v=>{var W,Y,G,ee;const{minX:I,minY:j,startX:S,startY:D,maxRows:A,maxColumns:P,minRowIndex:L,minColumnIndex:O}=_.current;if(S===0&&D===0)return;const $=J.blocks[t];if(!$)return;const{subNodes:M,data:U}=$;if(n!=="column"&&(v.y>D+FIe||v.y<D))if(v.y<j)M.length>L+1&&_e(t,{subNodes:A.slice(0,L+1)},!0);else{const te=Math.ceil((v.y+FP-j)/FP),Q=te+L-A.length;if(Q>0)for(let ne=0;ne<Q;ne++){const se=ut({type:m.BlockType.TABLE_ROW},{parentId:t,last:!0},!0);_.current.localBlock.add(se),_.current.maxRows=(Y=(W=J.blocks[t])==null?void 0:W.subNodes.slice())!=null?Y:[]}else _e(t,{subNodes:A.slice(0,L+te)},!0)}const{format:z}=U,K=(ee=(G=z==null?void 0:z.tableBlockColumnOrder)==null?void 0:G.slice())!=null?ee:[];if(n!=="row"&&(v.x>S+wP||v.x<S-wP))if(v.x<I)K.length>O+1&&_e(t,{data:{format:{tableBlockColumnOrder:P.slice(0,O+1)}}},!0);else{const te=Math.ceil((v.x-I)/bIe),Q=te+O-P.length;if(Q>0){const ne=P.concat(Array.from(Array(Q)).map(()=>qe()));_e(t,{data:{format:{tableBlockColumnOrder:ne}}},!0),_.current.maxColumns=ne.slice()}else _e(t,{data:{format:{tableBlockColumnOrder:P.slice(0,O+te)}}},!0)}},32);return document.addEventListener("mouseup",C),document.addEventListener("mousemove",T),()=>{document.removeEventListener("mouseup",C),document.removeEventListener("mousemove",T)}},[g,t,e,x,n]),!u)return null;const b={};return n==="row"&&(b.style={width:a}),n==="corner"&&(b.style={left:c},b.key=c),n==="column"&&(b.style={left:c,height:o},b.key=c),r.jsx(Fe,{placement:"bottom",className:R("absolute items-end justify-end ml-3 opacity-0",!p&&"transition-opacity duration-100 hover:opacity-100",(l||g)&&"opacity-100",n==="corner"&&"w-[18px] h-[18px] bottom-2 pl-0.5",n==="row"&&"h-[18px] bottom-2",n==="column"&&"top-3 w-[18px] pl-0.5"),visible:g||f,popup:g?r.jsx("div",{className:"py-1 px-2 font-semibold",children:"".concat(F.length," × ").concat(u.subNodes.length)}):r.jsxs("div",{className:"py-1 px-2",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("span",{className:"text-white font-medium mr-1",children:"点击"}),r.jsx("span",{className:"text-grey4",children:EP[n][0]})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("span",{className:"text-white font-medium mr-1",children:"拖拽"}),r.jsx("span",{className:"text-grey4",children:EP[n][1]})]})]}),...b,children:r.jsx("div",{"data-disable-select":!0,className:R("flex-1 h-4 bg-grey7 flex items-center justify-center",g&&"bg-black/20",n==="corner"&&"rounded-full h-4 cursor-nwse-resize",n==="row"&&"rounded h-4 cursor-row-resize",n==="column"&&"rounded h-full cursor-col-resize"),onMouseEnter:()=>{!p&&h(!0)},onMouseLeave:()=>h(!1),onMouseDown:()=>{var T,v,I,j,S,D,A;re(Ns.update({activityTableId:t,draggingBarType:n,chosenCells:void 0}));const C=document.getElementById("root");C==null||C.classList.add(CP[n]),_.current.originRows=u.subNodes.slice(),_.current.maxRows=u.subNodes.slice(),_.current.originColumns=F.slice(),_.current.maxColumns=F.slice();const k=(T=e.current)==null?void 0:T.getBoundingClientRect();if(_.current.startX=(v=k==null?void 0:k.right)!=null?v:0,_.current.startY=(I=k==null?void 0:k.bottom)!=null?I:0,yk(u.subNodes,(P,L)=>{var $,M;if(_.current.minY)return;const O=J.blocks[P];if(O){const{collectionProperties:U={}}=O.data;if(Object.values(U).some(K=>K.length)){const K=($=e.current)==null?void 0:$.querySelector('[data-table-row-index="'.concat(L,'"]'));_.current.minY=(M=K==null?void 0:K.getBoundingClientRect().bottom)!=null?M:0;const W=Number(K==null?void 0:K.dataset.tableRowIndex),Y=Math.max(W,...s.map(G=>G[0][0]===W?G[1][0]:0));_.current.minRowIndex=Y}}}),!_.current.minY){const P=(j=e.current)==null?void 0:j.querySelector("tr");_.current.minY=(S=P==null?void 0:P.getBoundingClientRect().bottom)!=null?S:0}if(yk(_.current.originColumns,(P,L)=>{_.current.minX||u.subNodes.some(O=>{var z,K,W;const $=J.blocks[O];if(!$)return!1;const{collectionProperties:M={}}=$.data,U=(z=M[P])==null?void 0:z.length;if(U){const Y=(K=e.current)==null?void 0:K.querySelector('[data-table-column-index="'.concat(L,'"]'));_.current.minX=(W=Y==null?void 0:Y.getBoundingClientRect().right)!=null?W:0;const G=Number(Y==null?void 0:Y.dataset.tableColumnIndex),ee=Math.max(G,...s.map(te=>te[0][1]===G?te[1][1]:0));_.current.minColumnIndex=ee}return U})}),!_.current.minX){const P=(D=e.current)==null?void 0:D.querySelector("td");_.current.minX=(A=P==null?void 0:P.getBoundingClientRect().right)!=null?A:0}},onClick:C=>{C.stopPropagation(),h(!1),n==="corner"?me.event("simpletable_add_click"):me.event("simpletable_fastadd"),x(()=>{var k;if(n!=="column"&&ut({type:m.BlockType.TABLE_ROW},{parentId:t,last:!0}),n!=="row"){const{format:T}=u.data,v=(k=T==null?void 0:T.tableBlockColumnOrder)!=null?k:[];_e(t,{data:{format:{tableBlockColumnOrder:v.concat(qe())}}})}})},children:r.jsx(V,{name:"IcBtnNew",size:"xsmall",className:R(g?"!text-white":"text-grey3")})})})},wIe=(e,t)=>{const n=Oe(),s=y.useCallback((o,i)=>{var h,p;const{blocks:l}=pe(),c=l[e];if(!c)return;const u=(p=((h=c.data.format)!=null?h:{}).tableBlockColumnFormat)!=null?p:{},f={format:{tableBlockColumnFormat:{...u,[t]:{...u[t],width:o}}}};i?_e(e,{data:f},!0):n(()=>_e(e,{data:f}))},[t,e,n]),a=y.useMemo(()=>qn(o=>{s(o,!1)},300),[s]);return y.useCallback(o=>{s(o,!0),a(o)},[a,s])},EIe=({tableId:e,tableRef:t})=>{const{columns:n,subNodes:s,widths:a}=ft(e,o=>{var c,d,u;if(!o)return{columns:[],subNodes:[],widths:[]};const i=(d=(c=o==null?void 0:o.data.format)==null?void 0:c.tableBlockColumnOrder)!=null?d:[],l=i.map(f=>{var h,p,g,_;return(_=(g=(p=(h=o.data.format)==null?void 0:h.tableBlockColumnFormat)==null?void 0:p[f])==null?void 0:g.width)!=null?_:vF});return{columns:i,subNodes:(u=o==null?void 0:o.subNodes)!=null?u:[],widths:l}},[],{waitMode:"throttle"});return r.jsxs("div",{className:"absolute top-0 translate-x-2 translate-y-3 pointer-events-none",style:{height:"calc(100% - 30px)"},children:[r.jsx("div",{className:"absolute top-0 w-full h-full",children:s.map((o,i)=>r.jsx(TIe,{recordId:o,tableRef:t,tableId:e},i))}),r.jsx("div",{className:"flex h-full",children:a.map((o,i)=>{const l=n[i];return l?r.jsx(kIe,{width:o,propertyId:l,tableId:e},i):null})})]})},CIe=38,kIe=({width:e,tableId:t,propertyId:n})=>{const{isSelecting:s,isDragging:a,droppingPosition:o}=Ce(({simpleTable:c})=>{const{chosenCells:d,dropInfo:u}=c,f=(d==null?void 0:d.tableId)===t&&d.propertyId!==n&&(u==null?void 0:u.propertyId)===n?u==null?void 0:u.position:"";return{isSelecting:!!c.selecting,isDragging:!!c.draggingStart,droppingPosition:f}},[t,n],{obsSimpleTable:!0}),i=wIe(t,n),l=ZF(({offset:[c]})=>{const d=Math.floor(Math.max(c,CIe));i(d)},{from:e,preventDefault:!0});return s?null:r.jsx("div",{className:"relative top-0 left-1 transition-all ease-out",style:{width:e,height:"calc(100% - 10px)"},children:o?r.jsx("div",{className:R("absolute bg-black dark:bg-grey3 h-full w-[3px]",o==="left"&&"-translate-x-px -translate-y-px left-0 top-0",o==="right"&&"translate-x-px -translate-y-px right-0 top-0")}):r.jsx("div",{...l(),className:R("absolute top-px z-10 opacity-0 transition-opacity delay-150 h-full -right-[5px] w-[9px] pointer-events-auto",!a&&"hover:cursor-col-resize hover:opacity-100"),style:{touchAction:"none"},children:r.jsx("div",{className:"absolute left-[3px] top-0 w-[3px] -mt-px bg-black dark:bg-grey6 h-full"})})})},TIe=({recordId:e,tableId:t,tableRef:n})=>{const{isDragging:s,droppingPosition:a}=Ce(({simpleTable:l})=>{const{chosenCells:c,dropInfo:d}=l;return{droppingPosition:(c==null?void 0:c.tableId)===t&&c.recordId!==e&&(d==null?void 0:d.recordId)===e?d==null?void 0:d.position:"",isDragging:!!l.draggingStart}},[t,e],{obsSimpleTable:!0}),[o,i]=y.useState(0);return y.useEffect(()=>{var d,u;if(!s)return;const l=n.current;if(!l)return;const c=l.querySelector('[data-table-row-id="'.concat(e,'"]'));i((u=(d=c==null?void 0:c.parentElement)==null?void 0:d.clientHeight)!=null?u:0)},[e,s,n]),s?r.jsx("div",{className:"relative top-0 left-1",style:{height:o},children:r.jsx("div",{hidden:!a,className:R("absolute bg-black dark:bg-grey3 h-[3px] w-full",a==="top"&&"translate-x-px -translate-y-px top-0 left-0",a==="bottom"&&"translate-x-px translate-y-px bottom-0 left-0")})}):null},vIe=y.memo(({tableId:e,tableRef:t,indexRanges:n})=>{const{subNodes:s,tableBlockColumnOrder:a,tableBlockRanges:o}=G4(e),i=yr(),l=y.useMemo(()=>o.reduce((u,{start:f,end:h})=>{var T,v;if(!f||!h)return u;const[p,g]=f,[_,x]=h;if(!p||!g||!_||!x)return u;const F=s.indexOf(p),b=a.indexOf(g),w=s.indexOf(_),E=a.indexOf(x);u[p]={...(T=u[p])!=null?T:{},[g]:{colSpan:E-b+1,rowSpan:w-F+1}};const C=s.slice(F,w+1),k=a.slice(b,E+1);for(const I of C)for(const j of k)I===p&&j===g||(u[I]={...(v=u[I])!=null?v:{},[j]:{colSpan:0,rowSpan:0}});return u},{}),[s,a,o]),c=y.useMemo(()=>Ps(u=>{var x,F;const{hoveringCell:f,draggingStart:h,draggingBarType:p}=J.simpleTable;if(h||p)return;const _=u.target.closest("td");if(_){const b=Number((x=_.dataset.tableRowIndex)!=null?x:0),w=Number((F=_.dataset.tableColumnIndex)!=null?F:0);(!f||f.rowIndex!==b||f.columnIndex!==w)&&re(Ns.update({activityTableId:e,hoveringCell:{rowIndex:b,columnIndex:w}}))}},50,{leading:!0,trailing:!0}),[e]),d=y.useMemo(()=>Ps(()=>{const{draggingStart:u}=J.simpleTable;u||re(Ns.update({hoveringCell:void 0}))},50,{leading:!0,trailing:!0}),[]);return i.current?r.jsx(cY,{className:"mt-3 ml-3 mr-1 mb-7",overscan:Dn,computeItemKey:u=>u,increaseViewportBy:o.length?1/0:i.current.clientHeight,customScrollParent:i.current,totalCount:s.length,components:{Table:y.memo(u=>r.jsx("table",{...u,className:"w-max",ref:t,onMouseMove:c,onMouseLeave:d}),In),TableRow:y.memo(u=>{const f=u["data-index"],h=s[f];return h?r.jsx(Qj.Provider,{value:{tableId:e,recordId:h,spans:l,indexRanges:n},children:r.jsx("tr",{...u,className:"align-baseline"})}):null},In)},itemContent:u=>{var h;const f=(h=s[u])!=null?h:"";return a.map((p,g)=>{var x,F;const _=(F=(x=l[f])==null?void 0:x[p])!=null?F:{};return _.colSpan===0||_.rowSpan===0?null:r.jsx(dz,{span:_,propertyId:p,rowIndex:u,columnIndex:g},"".concat(f,"-").concat(p))})}}):null},In),IIe=({tableRef:e,tableId:t})=>{const n=!cz(t),{width:s=-9999}=bl(e.current,"width"),[a,o]=y.useState(0),i=Oe(),l=ie(),c=y.useRef(),d=lt(),u=ft(d,h=>h==null?void 0:h.data.pageFixedWidth);y.useEffect(()=>{const h=()=>{var g;const p=document.querySelector('[data-block-id="'.concat(t,'"]'));o((g=p==null?void 0:p.clientWidth)!=null?g:-9999)};return setTimeout(h,100),window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[t,u]);const f=(s>a?a:s)-88;return r.jsxs("div",{"data-no-cancel-selected":!0,className:R("absolute z-20 flex -top-8 h-8 items-center next-modal transition-opacity",n?"opacity-0 pointer-events-none":"opacity-100"),style:{left:f},children:[r.jsx(Fe,{popup:"自适应宽度",offset:[0,8],onClick:h=>{var F,b;if(h.stopPropagation(),n)return;const p=(b=(F=J.blocks[t])==null?void 0:F.data.format)!=null?b:{},{tableBlockColumnFormat:g={},tableBlockColumnOrder:_=[]}=p,x=_.length;me.event("simpletable_width"),i(()=>{_e(t,{data:{format:{tableBlockColumnFormat:_.reduce((w,E)=>(w[E]={...g[E],width:(a-28)/x},w),{})}}})})},className:"flex w-9 items-center justify-center border-r border-black_006 animate-click",children:r.jsx(V,{name:"IcTableFitWidth",size:"middle"})}),r.jsxs("div",{ref:c,onClick:h=>{h.stopPropagation(),!n&&l.dropdown({modalId:Ve.TABLE_HEADER_MENU_LIST,popcorn:c.current,placement:"bottom",offset:[0,15],mask:!1,content(){return r.jsx(NIe,{tableId:t})}})},className:"flex w-[50px] items-center justify-center animate-click",children:[r.jsx(V,{name:"MIcTableHeader",size:"middle"}),r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall",className:"text-grey4 ml-1.5"})]})]})},NIe=({tableId:e})=>{const t=ft(e,a=>{var o,i;return(i=(o=a==null?void 0:a.data)==null?void 0:o.format)!=null?i:{}}),n=Oe(),s=[{type:H.TEXT_SWITCH,data:{title:"标题行",switch:t.tableBlockRowHeader,icon:"IcTableHeaderRow",noCancelSelected:!0,onSwitch:a=>{me.event("simpletable_titlerow",{openclose:a?"open":"close"}),n(()=>{_e(e,{data:{format:{tableBlockRowHeader:a}}})})}}},{type:H.TEXT_SWITCH,data:{title:"标题列",switch:t.tableBlockColumnHeader,icon:"IcTableHeaderColumn",noCancelSelected:!0,onSwitch:a=>{me.event("simpletable_titlecolumn",{openclose:a?"open":"close"}),n(()=>{_e(e,{data:{format:{tableBlockColumnHeader:a}}})})}}}];return r.jsx(ze,{className:"py-[5px] rounded-r w-60 next-modal",items:s})},kP={left:0,width:0,height:0,top:0},TP=12,Iy=12,vP={},IP=1,jIe=({root:e,tableRef:t,tableId:n,indexRanges:s})=>{const{recordId:a,propertyId:o}=Ce(({simpleTable:C})=>{const{chosenCells:k}=C;return!k||n!==k.tableId?vP:k},[n],{obsSimpleTable:!0}),[i,l]=y.useState(kP),{width:c=-9999}=bl(t.current,"width"),d=Ce(({simpleTable:C})=>{const{chosenCells:k,draggingStart:T}=C;return n===(k==null?void 0:k.tableId)&&!!T},[n],{obsSimpleTable:!0}),u=y.useRef(kP),f=y.useRef([]),h=y.useRef(),p=y.useRef(),g=Oe(),_=e?96:0,x=_+TP,F=_h(a),b=_h(o),w=y.useCallback(()=>{var D,A,P,L,O;const C=t.current;if(!C)return;const k=C.querySelector(".table-selector");if(!k)return;const T=k.closest("td");if(!T)return;let v=TP;const I=(D=C.closest('[data-virtuoso-scroller="true"]'))==null?void 0:D.parentElement;I&&(v+=parseInt(getComputedStyle(I).getPropertyValue("padding-left"),10));const j=T.getBoundingClientRect(),S={top:F?T.offsetTop-C.offsetTop+11:12,left:T.offsetLeft-1+v,width:F?C.clientWidth-.2:j.width+1,height:F?j.height+IP:C.clientHeight};if(l(S),u.current=S,b){const $=J.blocks[n],M=(A=$==null?void 0:$.data.format)!=null?A:{},U=((P=M.tableBlockColumnOrder)!=null?P:[]).map(K=>{var W,Y,G;return(G=(Y=(W=M.tableBlockColumnFormat)==null?void 0:W[K])==null?void 0:Y.width)!=null?G:vF});let z=((L=U[0])!=null?L:0)+_+9;f.current=U.map((K,W)=>(W&&(z+=K),z))}if(F){const $=C.querySelectorAll("tr"),M=Array.from($).map(z=>{const{height:K}=z.getBoundingClientRect();return K});let U=((O=M[0])!=null?O:0)+Iy;f.current=M.map((z,K)=>(K&&(U+=z),U))}},[t,F,b,n,_]);y.useEffect(()=>{w()},[w,c,a,o,d]),y.useEffect(()=>{const C=I=>{I.target.closest(".table-handle")&&(p.current={initX:I.pageX,initY:I.pageY})},k=()=>{var L;p.current=void 0,document.onselectstart=function(){return!0};const I=()=>{h.current=void 0,re(Ns.update({draggingStart:void 0,dropInfo:void 0}))},{blocks:j,simpleTable:S}=J,{chosenCells:D,dropInfo:A}=S;if(!D||n!==D.tableId)return;const P=j[n];if(P&&A){if(_h(a)&&!ol(A.recordId)&&a!==A.recordId){const O=P.subNodes.findIndex(z=>z===a);if(s.some(z=>z[0][0]<=O&&O<=z[1][0]&&z[0][0]!==z[1][0])){be.warning("有合并的单元格不支持移动"),I();return}const M=h.current,U={parentId:n};M==="top"&&(U.before=A.recordId),M==="bottom"&&(U.after=A.recordId),g(()=>{il([a],U)})}if(_h(o)&&!ol(A.propertyId)){const{format:O}=P.data,$=(L=O==null?void 0:O.tableBlockColumnOrder)!=null?L:[];if(o!==A.propertyId){const M=$.findIndex(Y=>Y===o);if(s.some(Y=>Y[0][1]<=M&&M<=Y[1][1]&&Y[0][1]!==Y[1][1])){be.warning("有合并的单元格不支持移动"),I();return}const z=$.filter(Y=>Y!==o),K=h.current,W=z.indexOf(A.propertyId);K==="left"&&z.splice(W,0,o),K==="right"&&z.splice(W+1,0,o),g(()=>{_e(n,{data:{format:{tableBlockColumnOrder:z}}})})}}}I()},v=Ps(I=>{var W,Y;if(!o&&!a||!p.current)return;(Math.abs(I.pageX-p.current.initX)>5||Math.abs(I.pageY-p.current.initY)>5)&&re(Ns.update({draggingStart:p.current}));const{chosenCells:j,draggingStart:S}=J.simpleTable;if(!j||!S||n!==j.tableId)return;const{x:D,y:A}=I,{initX:P=-999,initY:L=-999}=S,{top:O=0,left:$=0,right:M=0,bottom:U=0,height:z=0,width:K=0}=(Y=(W=t.current)==null?void 0:W.getBoundingClientRect())!=null?Y:{};_h(j.recordId)&&(h.current=L>A?"top":"bottom",l(G=>{const ee=A-O-G.height/2+Iy;return A>U-G.height?{...G,top:Math.min(ee,z-G.height+Iy)}:{...G,top:Math.max(ee,Iy)}})),_h(j.propertyId)&&(h.current=P>D?"left":"right",l(G=>{const ee=D-$+x-G.width/2;return D>M-G.width?{...G,left:Math.min(ee,K+x-G.width)}:{...G,left:Math.max(ee,x)}})),Math.abs(D-P)<20&&Math.abs(A-L)<15&&(h.current=void 0)},16);return document.addEventListener("mousedown",C,!0),document.addEventListener("mousemove",v),document.addEventListener("mouseup",k,!0),()=>{document.removeEventListener("mousedown",C,!0),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",k,!0)}},[x,s,w,d,o,a,n,t,g]),y.useEffect(()=>{var D,A,P;const C=h.current;if(!C){re(Ns.update({dropInfo:void 0}));return}const{draggingStart:k,chosenCells:T,dropInfo:v}=J.simpleTable;if(!d||!k||!T)return;const{tableId:I}=T,j=J.blocks[I];if(!j)return;let S=-1;if(F){const{top:L}=i;f.current.some((M,U)=>(C==="top"?L<M:L+i.height-IP<=M)?(S=U,!0):!1);const O=j.subNodes.indexOf((D=v==null?void 0:v.recordId)!=null?D:"");s.some(M=>{const U=M[0][0],z=M[1][0],K=C==="top"?U<S:U<=S,W=C==="top"?S<=z:S<z;return K&&W})?re(Ns.update({activityTableId:I,dropInfo:void 0})):(O!==S||(v==null?void 0:v.position)!==C)&&re(Ns.update({activityTableId:I,dropInfo:{propertyId:void 0,recordId:j.subNodes[S],position:C}}))}if(b){const{left:L}=i;f.current.some((z,K)=>(C==="left"?L<z:L+i.width<=z)?(S=K,!0):!1);const{format:O}=j.data,$=(A=O==null?void 0:O.tableBlockColumnOrder)!=null?A:[],M=$.indexOf((P=v==null?void 0:v.propertyId)!=null?P:"");s.some(z=>{const K=z[0][1],W=z[1][1],Y=C==="left"?K<S:K<=S,G=C==="left"?S<=W:S<W;return Y&&G})?re(Ns.update({activityTableId:I,dropInfo:void 0})):(M!==S||(v==null?void 0:v.position)!==C)&&re(Ns.update({activityTableId:I,dropInfo:{propertyId:$[S],recordId:void 0,position:C}}))}},[d,i,n,s,F,b]);const E=y.useMemo(()=>{var T,v;if(!d)return"";let C="";const k=(T=t.current)==null?void 0:T.cloneNode(!0);if(k){const I=document.createElement("div");I.appendChild(k);const j=(v=I.firstElementChild)==null?void 0:v.querySelectorAll(".shadow-button");j==null||j.forEach(S=>S.remove()),C+=I.innerHTML}return C},[d,t]);return!a&&!o?null:r.jsxs("div",{className:R("absolute pointer-events-none border",d?"border-none":"border-black dark:border-grey3"),style:i,children:[d&&r.jsx("div",{className:R("absolute z-10 table-handle shadow-button bg-black dark:bg-grey3",F?"top-1/2 -left-[9px] -mt-[13px]":"-top-[13px] left-1/2 -ml-2 rotate-90"),children:r.jsx(V,{name:"IcMenu",className:"text-white",size:"xsmall"})}),E&&r.jsx("div",{className:"overflow-hidden border border-black dark:border-grey3 shadow-md",style:{width:u.current.width,height:u.current.height,backgroundColor:"var(--grey9)"},children:r.jsx("div",{style:{transform:"translateX(-".concat(F?2:u.current.left-_-10,"px) translateY(-").concat(F?u.current.top-10:2,"px)")},dangerouslySetInnerHTML:{__html:E}})})]})},SIe=({id:e,root:t,children:n})=>{const s=y.useRef(null),a=We(e),{isDragging:o,isDraggingBar:i}=Ce(({simpleTable:p})=>({isDragging:!!p.draggingStart,isDraggingBar:!!p.draggingBarType}),[],{obsSimpleTable:!0}),l=y.useRef(null),c=cz(e);Gg(l),a$(e),y.useEffect(()=>{const p=document.getElementById("root");o?p==null||p.classList.add("dragging"):p==null||p.classList.remove("dragging")},[o]);const d=lz(e),u=y.useMemo(()=>({tableRef:s,tableId:e,indexRanges:d}),[e,d]),{wait:f,waitMode:h}=Ce(({simpleTable:p})=>{const{activityTableId:g}=p;return g===e||c?{wait:50,waitMode:"throttle"}:{wait:500,waitMode:"debounce"}},[e],{obsSimpleTable:!0});return r.jsxs(r.Fragment,{children:[r.jsx(wn,{id:e,horizontal:t,children:r.jsxs(bg,{wait:f,waitMode:h,children:[r.jsxs("div",{className:R("overflow-x-auto overflow-y-hidden relative",t&&"-ml-[104px] pl-24 sm:-ml-12 sm:pl-12"),ref:l,onScroll:()=>xn.emit("removeHoverMenu"),children:[r.jsx(vIe,{...u}),!a&&r.jsxs(r.Fragment,{children:[r.jsx(jIe,{root:t,...u}),r.jsx(EIe,{...u}),!o&&r.jsxs(r.Fragment,{children:[r.jsx(ck,{type:"row",...u}),r.jsx(ck,{type:"column",...u}),r.jsx(ck,{type:"corner",...u})]})]})]}),!a&&!i&&r.jsx(IIe,{...u})]})}),n]})},DIe=({id:e,root:t,children:n})=>{const[s,a]=Rd(e),o=r$(e),i=ye(e,["subNodes","data"],["segments"]),l=jg(),c=ie(),d=uh(),u=Array.isArray(n)&&n.length>0,f=We(e),h=Nr(),p=rr(qe);if(!i||ot.print)return null;const g=(b=!s)=>a(b,!1),_=b=>{c.dropdown({popcorn:b.currentTarget,content:({onCloseModal:w})=>r.jsx(gH,{items:[gE],blockId:e,onCloseModal:w,disabledHasRecently:!0,onColorSelect:E=>{me.event("tempbutton_changecolor",{color:E.desc})}})})},x=async b=>{var I,j;if(b.stopPropagation(),!i.subNodes.length||f)return;const w=J.blocks[i.parentId],E=(I=w==null?void 0:w.subNodes.findIndex(S=>S===e))!=null?I:0,C=w==null?void 0:w.subNodes[E-1],k=An(w==null?void 0:w.subNodes)===e&&ll(w==null?void 0:w.subNodes)!==e&&C,v=(j=(await l(i.subNodes,{after:k?C:e,prefixName:!1}))[0])==null?void 0:j.block;v&&h(v.uuid,fe(v.data.segments).length),me.event("click_tempbutton")},F=b=>{b.stopPropagation();const w=ut({type:m.BlockType.TEXTAREA},{parentId:e});h(w,0)};return r.jsxs(wn,{id:e,className:"my-px",horizontal:t,children:[r.jsxs("div",{className:R("block-has-icon-container py-1.5 animate-hover items-center px-0.5 group pr-2",f&&"cursor-default"),onClick:x,children:[r.jsx(Ex,{className:"mr-1.5",children:r.jsx(V,{size:"middle",name:"IcAddBoard"})}),r.jsx("span",{className:"text-ellipsis w-full text-t1 pr-1",children:r.jsx(ci,{uuid:p,className:"text-ellipsis",segments:i.data.segments,readonly:!0,placeholder:"请填写模板按钮名称"})}),!f&&r.jsxs("span",{className:"flex items-center group-hover:opacity-100 opacity-0 transition-opacity",onClick:b=>b.stopPropagation(),children:[r.jsx(Fe,{popup:"编辑",className:"animate-hover",onClick:()=>g(!0),children:r.jsx(V,{name:"MIcListSeetings",size:"middle"})}),r.jsx(Fe,{popup:"菜单",className:"ml-2 animate-hover text-grey3",onClick:b=>{d({blockId:e,offset:[8,0],blockNode:b.currentTarget})},children:r.jsx(V,{name:"IcMore",size:"middle"})})]})]}),s&&r.jsxs("div",{className:"border border-grey6 rounded text-t2 bg-white1",children:[r.jsxs("div",{className:"h-12 flex items-center justify-between px-3 text-black",children:[r.jsx("span",{children:"编辑模板按钮"}),r.jsx(De,{className:"text-t2-medium",colorType:"active",onClick:()=>g(),children:"关闭"})]}),r.jsx(Cr,{className:"my-2.5"}),r.jsxs("div",{children:[r.jsxs("div",{className:"h-12 px-3 text-grey3 flex items-center justify-between",children:[r.jsx("span",{children:"模板按钮名称"}),r.jsxs("span",{className:"flex items-center cursor-pointer",onClick:_,children:[r.jsx(V,{name:"IcColor",size:"middle",className:"mr-1"}),"颜色"]})]}),r.jsx("div",{className:"mx-3 bg-grey8 rounded flex items-center py-1.5",children:r.jsx(Hi,{uuid:e,toolbar:!1,comments:!1,className:"break-normal overflow-y-auto cursor-text px-2 w-full min-h-[24px]",placeholder:"请填写模板按钮名称",keydownOption:l0e,onKeyDown:b=>{Ie("mod+a")(b)&&o(b.nativeEvent)}})}),r.jsx(Cr,{className:"my-2.5"}),r.jsx("div",{className:"h-12 px-3 text-grey3 flex items-center",children:"模板内容"}),r.jsx("div",{className:"px-3 pb-5",children:r.jsx("div",{className:"bg-grey8 rounded p-1.5 text-black",children:u?n:r.jsx(wn,{dropInChild:!0,bindId:!1,id:e,children:r.jsx("div",{className:"flex items-center text-black",onClick:F,children:"创建文字或’/‘命令，也可以拖拽块至此处"})})})})]})]})]})},AIe=({id:e,children:t,root:n})=>{const s=ye(e,["data"],["segments"]),{enableAI:a}=xr(),{alwaysShowPlaceHolder:o,placeHolder:i}=sg(e,{defaultPlaceholder:a?"按空格使用 AI，输入文字或 '/' 命令":"输入文字或 '/' 命令"});return s?r.jsxs(wn,{id:e,horizontal:n,className:"my-px",children:[r.jsx(Hi,{className:"px-0.5 py-1 text-t1 group",alwaysShowPlaceholder:o,uuid:e,placeholder:i}),t&&r.jsx(ec,{blockId:e,children:t})]}):null},RIe=({id:e,root:t,children:n})=>{const[s]=Rd(e,{defaultOpen:!0}),a=ye(e,["data"],["checked"]),o=Oe(),i=We(e);if(!a)return null;const{checked:l}=a.data,c=ot.print||s;return r.jsxs("div",{className:"relative",children:[r.jsx(Y4,{id:e}),r.jsxs(wn,{id:e,horizontal:t,className:"my-px relative",children:[r.jsxs("div",{className:"block-has-icon-container",children:[r.jsx(Ex,{className:"block-before-icon-mt",children:r.jsx(_a,{size:"large",checked:l,onClick:d=>{i||(d.stopPropagation(),o(()=>{wI({data:{checked:!l}},e)}))}})}),r.jsx(Hi,{uuid:e,className:R("flex-1 w-0 mr-4",l?"opacity-50":"no-underline",{"line-through":l}),placeholder:"待办列表"})]}),n&&c&&r.jsx(ec,{blockId:e,children:n})]})]})},PIe="54px",LIe="50px",BIe="36px",OIe="32px",MIe=({id:e,root:t,children:n})=>{const{expand:s,toggle:a}=X4(e),o=ye(e,["data","subNodes"]),i=Nr(),l=Oe(),c=We(e);if(!o)return null;const d=p=>{p.stopPropagation(),l(()=>{const g=ut({},{parentId:o.uuid,after:o.uuid});i(g,0)})},{level:u=1}=o.data,f=ot.print||s;let h=PIe;switch(u){case 2:h=LIe;break;case 3:h=BIe;break;case 4:h=OIe;break}return r.jsxs(wn,{TagName:"h".concat(u),id:e,className:"my-px",horizontal:t,children:[r.jsxs("div",{className:R("block-has-icon-container ignore-focus-click flex-1 overflow-hidden",c&&"animate-click select-auto"),onClick:()=>c&&a(),style:{lineHeight:h},children:[r.jsx(Ex,{"data-no-cancel-selected":!0,className:R({"mt-4":u===1,"mt-3.5":u===2,"mt-1.5":u===3,"mt-1":u===4}),children:r.jsx("span",{className:"flex animate-hover",children:r.jsx(V,{size:"large",name:"IcToggleBlack",onClick:a,className:R("transition duration-150 cursor-pointer",{"rotate-90":f,"opacity-30":o.subNodes.length===0})})})}),r.jsx(Hi,{className:R("self-start mr-4 flex-1 w-0",{"text-h1 py-1.5":u===1,"text-h2 py-2":u===2,"text-h3 py-0.5":u===3,"text-h4 py-0.5":u===4}),uuid:e,placeholder:"折叠标题".concat(u)})]}),f&&r.jsx(ec,{blockId:e,children:o.subNodes.length?n:pt()?null:r.jsx("div",{className:"flex items-center w-full animate-hover cursor-pointer h-9 text-t2 p-1 my-px text-grey3 print:hidden",onClick:d,children:"内容为空，点击编辑"})})]})},UIe=e=>{var a,o,i;const t=ye(e.id,["data","local"],["format"]),n=We(e.id),s=ie();return Ld({uuid:e.id,callback:fH}),(i=(o=(a=t==null?void 0:t.data.format)==null?void 0:a.chartFormat)==null?void 0:o.ref)!=null&&i.uuid?r.jsx(r.Fragment,{children:e.children}):r.jsx(vc,{defaultOpenPanel:!!(t!=null&&t.local),readonly:n,onClick:()=>{s.modal({modalId:Ve.CHART_PANEL_ID,autoClose:!1,className:"rounded-md",content:()=>r.jsx(E2,{id:e.id})})},iconProp:{name:"IcChartLine",size:"normal"},text:"添加数据图表"})},VIe=({id:e,root:t})=>{var C,k,T;const n=We(e),s=Ja(),a=Ce(v=>{var j,S,D,A;const{blocks:I}=v;return(A=(D=(S=(j=I[e])==null?void 0:j.data.format)==null?void 0:S.chartFormat)==null?void 0:D.ref)==null?void 0:A.uuid},[]),o=Ce(v=>{var j,S,D,A;const{blocks:I}=v;return(A=(D=(S=(j=I[e])==null?void 0:j.data.format)==null?void 0:S.chartFormat)==null?void 0:D.ref)==null?void 0:A.viewId},[]),i=Ce(v=>{var j;const{blocks:I}=v;return(j=I[e])==null?void 0:j.data.format},[]),l=ss(),c=y.useContext(Qp),d=ja(c==null?void 0:c.current,{type:"width"}).width,u=qU(e,d||Number.MAX_SAFE_INTEGER,!!t),f=(k=(C=i==null?void 0:i.chartFormat)==null?void 0:C.border)!=null?k:!0,{renderSize:h,onRenderSize:p,changeSize:g,containerWidth:_,isDisable:x,defaultBlockFullWidth:F,defaultWidth:b,defaultHeight:w,widthBreakPoints:E}=Nc({id:e,root:t,defaultHeight:(T=i==null?void 0:i.height)!=null?T:360});return y.useEffect(()=>{(async()=>{a&&!C5(a)&&await s(a)})()},[a,s,l,o]),r.jsx(wn,{className:"my-1",id:e,fullWidth:!a,horizontal:t,style:u,children:r.jsx(UIe,{id:e,children:r.jsx(Ic,{outerLayoutStyle:ot.print?{width:"90%"}:void 0,resizeWidth:!0,resizeHeight:!0,widthBreakPoints:E,readonly:n||x,defaultBlockFullWidth:F,minWidth:220,minHeight:200,maxWidth:_||void 0,defaultWidth:b||uo,defaultHeight:w,onChange:g,onRenderSize:p,className:R("max-w-full",x&&"pointer-events-none"),customFooter:r.jsx(ei,{blockId:e,style:{width:ot.print?"90%":h.width}}),children:r.jsx("div",{className:R("rounded w-full h-full",{border:f}),children:r.jsxs(i5.Provider,{value:{isInit:!1,$state:o5,once:!1},children:[r.jsx(pH,{id:e}),r.jsx(E4,{blockId:e,className:"z-[12] opacity-0 group-hover:opacity-100 next-modal absolute right-0 top-0"})]})})})})})};rs(m.BlockType.FILE,fS);rs(m.BlockType.FOLD_LIST,rIe);rs(m.BlockType.TOGGLE_HEADER,MIe);rs(m.BlockType.TEMPLATE,DIe);rs(m.BlockType.HEADER,dIe);rs(m.BlockType.IMAGE,M4);rs(m.BlockType.COLUMN_LIST,x3e);rs(m.BlockType.COLUMN,g3e);rs(m.BlockType.MARK,tTe);rs(m.BlockType.ORDER_LIST,uIe);rs(m.BlockType.REFERENCE_COLLECTION_PAGE,vx);rs(m.BlockType.COLLECTION_VIEW_PAGE,vx);rs(m.BlockType.PAGE,vx);rs(m.BlockType.COLLECTION_VIEW,Eq);rs(m.BlockType.REFERENCE_COLLECTION,Eq);rs(m.BlockType.QUOTE,fIe);rs(m.BlockType.TEXTAREA,AIe);rs(m.BlockType.DIVIDER,y3e);rs(m.BlockType.TODO,RIe);rs(m.BlockType.LIST,eTe);rs(m.BlockType.FOLDER,Lv);rs(m.BlockType.REFERENCE,mIe);rs(m.BlockType.BOOKMARK,p3e);rs(m.BlockType.EMBED,b3e);rs(m.BlockType.EQUATION,G3e);rs(m.BlockType.CODE,RCe);rs(m.BlockType.EXTERNAL_FILE,fS);rs(m.BlockType.TABLE,SIe);rs(m.BlockType.SYNC_CONTAINER,Nq);rs(m.BlockType.SYNC_REFERENCE,yIe);rs(m.BlockType.MIND_MAPPING_PAGE,vx);rs(m.BlockType.MIND_MAPPING,z3e);rs(m.BlockType.AD,m3e);rs(m.BlockType.CHART,VIe);const jq=()=>{const{getState:e,dispatch:t}=ss(),n=Oe(),s=(a,o=m.CollectionViewType.TABLE)=>{n(()=>{const i=qe(),l=qe(),c=qe(),d=o===m.CollectionViewType.TIMELINE,u=o===m.CollectionViewType.CALENDAR,f=o===m.CollectionViewType.FORM,h=jE(),p=e().blocks[a];if(!p)return;p.subNodes.forEach(w=>{Ro(w)});const g=[],_={title:{name:"标题",type:m.CollectionSchemaType.TITLE},[i]:{name:"分类",type:m.CollectionSchemaType.SELECT,options:h}};g.push({property:"title",visible:!0},{property:i,visible:!0}),(d||u)&&(_[l]={name:"开始时间",type:m.CollectionSchemaType.DATE},_[c]={name:"结束时间",type:m.CollectionSchemaType.DATE},g.push({property:l,visible:!0},{property:c,visible:!0})),_e(a,{type:m.BlockType.COLLECTION_VIEW_PAGE,local:!0,data:{schema:_,collectionPageProperties:g}});let x=[];!u&&!f&&(x=[5,3,1].map(w=>{const E={[i]:[]};if(d){const C=new Date(Date.now()-w*Kn);E[l]=[Gn({from:C})],E[c]=[Gn({from:new Date(C.getTime()+5*Kn)})]}return ut({type:m.BlockType.PAGE,data:{segments:[],collectionProperties:E}},{parentId:a},!1,!0)}));const F=[{property:"title",visible:!0},{property:i,visible:o===m.CollectionViewType.TABLE}];(d||u)&&F.push({property:l,visible:!1},{property:c,visible:!1});let b={};switch(o){case m.CollectionViewType.TABLE:b=Hu({tableProperties:F});break;case m.CollectionViewType.BOARD:b=Lp({groupProperty:i,boardProperties:F,options:h});break;case m.CollectionViewType.GALLERY:b=m2({galleryProperties:F});break;case m.CollectionViewType.LIST:b=h2({listProperties:F});break;case m.CollectionViewType.TIMELINE:b=Bp({timelineProperties:F,timelineBy:l,timelineByEnd:c});break;case m.CollectionViewType.CALENDAR:b=Op({calendarProperties:F,calendarBy:l,calendarByEnd:c});break;case m.CollectionViewType.FORM:b=Jj({formProperties:F});break}Io({title:"默认视图",format:b,pageSort:x,type:o},{parentId:a}),f&&Io({title:"表格",format:Hu({tableProperties:F}),pageSort:[],type:m.CollectionViewType.TABLE},{parentId:a}),t(x9())})};return y.useCallback(s,[t,e,n])},$Ie=({uuid:e})=>{const t=Js(),n=ie(),s=Oe(),a=jq(),o=YE(e),{isTemplate:i,collectionId:l,templatePages:c}=q1e(e),d=y.useRef(),u=Nr(),f=T4(),h=gq(),p=Hm(),g=Ja(),_=ih(),x=lt(),[F,b]=y.useState(r.jsx(r.Fragment,{})),{enableAI:w}=xr(),E=Ui(),C=()=>{s(()=>{const I=ut({},{parentId:e,last:!0});u(I,0)}),t(Je.GUIDE_FIRST_TIME_CREATED_PAGE,ct.basicList),t(Je.CREATE_NEW_PAGE,ct.basicList)},k=()=>{s(()=>{_e(e,{type:m.BlockType.FOLDER}),t(Je.CREATE_FOLDER_AND_UPLOAD,ct.basicList,{step1:!0})}),t(Je.GUIDE_FIRST_TIME_CREATED_FOLDER,ct.basicList)},T=()=>{s(()=>{_e(e,{type:m.BlockType.MIND_MAPPING_PAGE}),_({parentId:e,last:!0},x),_({parentId:e,last:!0},x),_({parentId:e,last:!0},x)}),t(Je.CREATE_MIND_MAP,ct.advancedList)},v=cL([{title:"页面",icon:"IcPageEmpty",group:!1,onClick:()=>{me.event("pagetype_select",{type_select:m.BlockType.PAGE}),C()}},{title:"让 AI 快捷起草",isHidden:!w,icon:"IcAi",group:!1,onClick:()=>{s(()=>{const I=ut({},{parentId:e,last:!0});setTimeout(()=>{const j=document.querySelector('[data-block-id="'.concat(I,'"]'));j&&E({popcorn:j,blockId:I,from:ho.EmptyAi,editorScene:it.PageEmpty})},0)})}},{title:"文件夹",icon:"IcFolder",group:!1,onClick:()=>{me.event("pagetype_select",{type_select:m.BlockType.FOLDER}),k()}},{title:"思维导图",icon:"IcMindmap",group:!1,onClick:()=>{me.event("pagetype_select",{type_select:m.BlockType.MIND_MAPPING_PAGE}),T()}},{title:"从模板库选择创建",icon:"IcTemplate",group:!1,isHidden:!1,onClick:()=>{n.modal({modalId:Ve.TEMPLATE_CENTER,content:()=>r.jsx(fp,{onlyShowTab:"template",from:"page",targetId:x})})}},{title:"导入",icon:"IcImport",group:!1,isHidden:!1,onClick:()=>{n.modal({content:()=>r.jsx(yz,{pageId:e,from:"page"})})}},{title:"多维表",group:!0},...jF.map(({type:I,name:j})=>({title:j,icon:Ga[I],group:!1,onClick:()=>{switch(me.event("pagetype_select",{type_select:m.BlockType.COLLECTION_VIEW_PAGE,view_type:I}),me.event("bitable_create",{from_scene:"empty",view_type:I}),a(e,I),t(Je.GUIDE_FIRST_TIME_CREATED_COLLECTION,ct.basicList),I){case m.CollectionViewType.TABLE:t(Je.CREATE_BITABLE_EXPLORE,ct.basicList);break;case m.CollectionViewType.GALLERY:t(Je.CREATE_GALLERY_VIEW,ct.advancedList,{step1:!0});break;case m.CollectionViewType.CALENDAR:t(Je.GUIDE_FIRST_TIME_CALENDAR_VIEW,ct.advancedList),t(Je.CREATE_CALENDAR_VIEW,ct.advancedList);break;case m.CollectionViewType.TIMELINE:t(Je.GUIDE_FIRST_TIME_TIMELINE_VIEW,ct.advancedList),t(Je.CREATE_TIMELINE_VIEW,ct.advancedList);break;case m.CollectionViewType.FORM:t(Je.GUIDE_FIRST_TIME_COLLECTION_VIEW,ct.advancedList),t(Je.CREATE_FORM_VIEW,ct.advancedList);break}}}))],I=>!I.isHidden);return y.useEffect(()=>{b(r.jsx(r.Fragment,{children:o?c.length>=1?"，或从下方选择模板应用":i?"":r.jsxs(r.Fragment,{children:["，或",r.jsx("span",{className:"underline cursor-pointer underline-offset-2",onClick:I=>{I.stopPropagation(),n.modal({modalId:Ve.TEMPLATE_CENTER,content:()=>r.jsx(fp,{onlyShowTab:"template",from:"record",targetId:x})})},children:"从模板库选择创建"})]}):"，或从下方选择页面类型"}))},[o,i,n,x,c.length]),r.jsxs("div",{className:"line-default text-grey4",ref:d,children:[r.jsxs("div",{className:"my-0.5 px-0.5 mb-6 py-1.5 cursor-text",onClick:C,children:["按回车开始编辑",!i&&F]}),o&&!i&&c.length>=1&&r.jsxs(r.Fragment,{children:[c.map(I=>r.jsxs("div",{className:R("flex items-center flex-1 p-1 rounded cursor-pointer h-9 hover:text-grey4 animate-hover"),onClick:async()=>{n.loading({modalId:e});const j=[];s(()=>{s7(e,I,j)},{noThrottle:!0}),await Promise.all(j.map(S=>S())),await g(e,{force:!0}),n.closeModal(e)},children:[r.jsx(Fn,{iconSize:18,blockId:I,className:"w-5 h-5 mr-1",placement:"bottom-start",defaultIcon:r.jsx(_s,{uuid:I,size:"middle"})}),r.jsx(yl,{uuid:I})]},I)),r.jsxs("div",{className:R("flex items-center flex-1 p-1 rounded cursor-pointer h-9 hover:text-grey4 animate-hover"),onClick:()=>{f(e)},children:[r.jsx(V,{name:"IcPageEmpty",size:"middle",className:"mr-1"}),r.jsx("span",{className:"text-t1",children:"空白页面"})]}),r.jsxs("div",{className:R("flex items-center flex-1 p-1 rounded cursor-pointer h-9 hover:text-grey4 animate-hover"),onClick:()=>{if(l!=null){const I=h(l);p(I,{state:{noticeBannerShowBackButton:!0}})}},children:[r.jsx(V,{name:"IcAdd",size:"middle",className:"mr-1"}),r.jsx("span",{className:"text-t1",children:"创建模板记录"})]}),!i&&!0&&r.jsxs("div",{className:R("flex items-center flex-1 p-1 rounded cursor-pointer h-9 hover:text-grey4 animate-hover"),onClick:()=>{n.modal({modalId:Ve.TEMPLATE_CENTER,content:()=>r.jsx(fp,{onlyShowTab:"template",from:"record",targetId:x})})},children:[r.jsx(V,{name:"IcTemplate",size:"middle",className:"mr-1"}),r.jsx("span",{className:"text-t1",children:"从模板库选择创建"})]})]}),!o&&r.jsx(Um,{defaultIndex:0,listenPriority:iw,containerRef:d,itemCount:v.length,children:(I,j)=>v.map((S,D)=>S.isHidden?null:S.group?r.jsx("div",{"list-item-inactive":"",className:"flex items-center mt-4 h-9 text-t2",children:S.title},D):r.jsxs("div",{className:R("flex items-center p-1 h-9 animate-hover",D===I&&"bg-black_006 text-grey3"),onClick:S.onClick,onMouseEnter:()=>j(D),children:[S.icon&&r.jsx(V,{size:"middle",className:"mr-2",name:S.icon}),S.title,S.isBeta&&r.jsx("span",{className:"text-t2 px-1.5 bg-grey/20 rounded-sm ml-2 text-grey2 inline-flex items-center",children:"Beta"}),r.jsx(V,{size:"middle",className:R("ml-auto opacity-0 transition-opacity mr-1",D===I&&"opacity-100"),name:"IcEnter"})]},D))})]})},HIe=y.memo(({uuid:e})=>r.jsx(Xm,{root:!0,id:e},e)),zIe=y.memo(({uuid:e,className:t,readonly:n})=>{var F;const s=y.useRef(null);DEe(s);const a=y.useRef(null),{isVirtualListMode:o}=$N(),i=y8(),l=(F=ye(e,["subNodes"],[],{enableAuditTime:!1}))==null?void 0:F.subNodes,c=hw(),{allowDuplicate:d}=mt(e),u=_0(b=>{var w;return(w=b.setting)==null?void 0:w.enableHighPerformance}),f=lt(),{blockCount:h}=ox(f),p=_8(),g=yr(),[_,x]=y.useState(g.current);return N4({container:g}),y.useEffect(()=>{x(g.current)},[g]),y.useEffect(()=>{p(!1),!ot.print&&(h<500||c||(u||h>=5e3)&&i({isVirtualListMode:!0,virtualRef:a,subNodes:l||[]}))},[]),_?r.jsx("div",{"data-page-id":e,className:R("next-space-page-content block-list pt-5",!ot.print&&"relative flex flex-col flex-shrink-0",t),ref:s,children:r.jsxs(Qp.Provider,{value:s,children:[o?r.jsx(qIe,{subNodes:l,virtualRef:a,container:_}):r.jsx($ge,{root:!0,subNodes:l},e),r.jsx($p,{readonly:n}),!n&&r.jsx(zu,{type:"page"}),(!n||d)&&r.jsx(Di,{}),!n&&!(l!=null&&l.length)&&!ot.print&&r.jsx($Ie,{uuid:e})]})}):null},yn),mS=y.memo(zIe,yn);GEe(mS);Yue(mS);wie(fq);vwe(fq);const qIe=y.memo(e=>{const{virtualRef:t,subNodes:n=[],container:s}=e,a=l5(),o=y.useCallback((l,c)=>r.jsx(HIe,{uuid:c}),[]),i=y.useCallback(({children:l,...c})=>r.jsx("div",{...c,children:l}),[]);return r.jsx(qs,{ref:t,customScrollParent:s,overscan:1e3,increaseViewportBy:1e3,data:n,computeItemKey:(l,c)=>c,defaultItemHeight:100,components:a?{}:{Item:y.memo(i)},itemContent:o})}),GIe=({time:e=0,prefix:t="",onFinish:n,onChange:s,className:a=""})=>{const[o,i]=y.useState(e);return y.useEffect(()=>{o===0&&n&&n(!0)},[o,n]),y.useEffect(()=>{s&&s(o)},[o,s]),y.useEffect(()=>{i(o);const l=setInterval(()=>{i(c=>c<1?(clearInterval(l),0):c-1)},1e3);return()=>{i(0)}},[]),r.jsxs("span",{className:a,children:["".concat(t," "),o,"s"]})},Ix=({onSendVerifyCode:e,autoClick:t,showIcon:n=!0,className:s,disable:a,sendText:o,resendText:i,countDownPrefix:l})=>{const[c,d]=y.useState(!1),[u,f]=y.useState(o!=null?o:"获取验证码"),h=y.useRef(null),p=y.useCallback(()=>{d(!1)},[]);return y.useEffect(()=>{var g;t&&((g=h.current)==null||g.click())},[t]),r.jsx("button",{ref:h,disabled:a,className:rw("text-t4 mr-1 flex h-full w-full items-center font-normal text-black h-lg:text-t2",s,{"opacity-50 cursor-not-allowed":a}),type:"button",onClick:async()=>{c||!await e()||(d(!0),f(i!=null?i:"重新获取验证码"))},children:c?r.jsx(GIe,{time:60,className:"text-grey3",prefix:l!=null?l:"倒计时",onFinish:p}):r.jsxs(r.Fragment,{children:[u,n&&r.jsx("img",{src:Wb.IcLoginCode,className:"ml-1 h-3 w-3 dark:invert dark:opacity-50"})]})})};var Bv=(e=>(e[e.BY_ACCOUNT=0]="BY_ACCOUNT",e[e.BY_OLD_PASSWORD=1]="BY_OLD_PASSWORD",e))(Bv||{});const WIe=e=>{const[t,n]=y.useState(!1),[s,a]=y.useState(!1),{password:o,passwordError:i,newPassword:l,newPasswordError:c,verifyCode:d,setVerifyCode:u,verifyCodeError:f,setPassword:h,setNewPassword:p,settingPassword:g}=KIe(e.type,e.phone),_=async x=>{x.preventDefault(),await g()&&e.onSuccess()};return e.type===0&&e.phone?r.jsxs("div",{className:"next-modal p-7",children:[r.jsx("div",{className:"text-t1-medium ",children:"设置密码"}),r.jsx(Ct,{inputType:t?"text":"password",warning:i,className:"w-full h-9 mt-5",inputClassName:"opacity-50",value:o,placeholder:"请输入新的密码",onChange:h,addonAfter:r.jsx(V,{onClick:x=>{x.preventDefault(),x.stopPropagation(),n(!t)},name:t?"IcHide":"IcShow",className:"cursor-pointer absolute right-2.5 text-grey3",size:"middle"})}),r.jsx("div",{className:"text-t2 text-grey3 mt-2.5",children:"6-16位密码，需包含数字、英文大写字母和小写字母"}),r.jsx(Ct,{readonly:!0,className:"w-full h-9 mt-5",inputClassName:"opacity-50",value:e.phone}),r.jsx(Ct,{autoFocus:!0,type:"number",value:d,maxLength:6,warning:f,className:"w-full h-9 mt-5 px-3",inputClassName:"opacity-50 px-0",placeholder:"请输入验证码",onChange:x=>u(x.toString()),addonAfter:r.jsx(Ix,{onSendVerifyCode:()=>{var x;return ve.infra.createPhoneCaptcha((x=e.phone)!=null?x:"",{type:m.CaptchaSendType.RESET_PASSWORD})}})}),r.jsx(De,{onClick:async()=>{await g()&&e.onSuccess()},colorType:"active",className:"mt-6",children:"完成绑定"})]}):r.jsxs("form",{className:"px-7 pb-7",onSubmit:_,children:[r.jsx("div",{className:"text-t4 text-grey3 mt-9",children:"原密码"}),r.jsx(Ct,{inputType:t?"text":"password",warning:i,className:"w-full h-9 mt-5",inputClassName:"opacity-50",value:o,placeholder:"请输入原密码",onChange:h,addonAfter:r.jsx(V,{onClick:x=>{x.preventDefault(),x.stopPropagation(),n(!t)},name:t?"IcHide":"IcShow",className:"cursor-pointer absolute right-2.5 text-grey3",size:"middle"})}),r.jsx("div",{className:"text-t4 text-grey3 mt-6",children:"新密码"}),r.jsx(Ct,{inputType:s?"text":"password",warning:c,className:"w-full h-9 mt-5",inputClassName:"opacity-50",value:l,placeholder:"请输入新的密码",onChange:p,addonAfter:r.jsx(V,{onClick:x=>{x.preventDefault(),x.stopPropagation(),a(!s)},name:s?"IcHide":"IcShow",className:"cursor-pointer absolute right-2.5 text-grey3",size:"middle"})}),r.jsx("div",{className:"text-t2 text-grey3 mt-2.5",children:"6-16位密码，需包含数字、英文大写字母和小写字母"}),r.jsx(De,{onClick:_,type:"submit",colorType:"active",className:"mt-6",children:"设置密码"})]})},KIe=(e,t)=>{const[n,s]=y.useState(t!=null?t:""),[a,o]=y.useState(""),[i,l]=y.useState(""),[c,d]=y.useState(""),[u,f]=y.useState(""),[h,p]=y.useState(""),[g,_]=y.useState(""),x=Ut(),F=()=>ca.VerifyCode.test(a)?!0:(l("验证码错误"),!1),b=()=>!c||!ca.Password.test(c)?(f("密码格式有误"),!1):!0,w=()=>!h||!ca.Password.test(h)?(_("密码格式有误"),!1):!0;return{phone:n,password:c,passwordError:u,newPassword:h,newPasswordError:g,verifyCode:a,verifyCodeError:i,setPassword:d,setNewPassword:p,settingPassword:async()=>{if(b()){if(e===0)return F()?ve.infra.resetUserPasswordByPhone(n,{captcha:a,password:qf(c)}):void 0;if(w())return await ve.infra.resetUserPassword(x.uuid,{old:qf(c),new:qf(h)})}},setVerifyCode:o}},YIe=({onClick:e,onError:t,autoClick:n,sendCode:s,className:a})=>{const[o,i]=y.useState(!1),[l,c]=y.useState(!1),[d,u]=y.useState("获取验证码"),f=y.useRef(!1),h=y.useCallback(async()=>{if(e==null||e(),!f.current){f.current=!0;try{await s(),c(!0),u("重新获取验证码")}catch(g){f.current=!1,t==null||t(g.message)}}},[e,t,s]),p=y.useCallback(()=>{c(!1),f.current=!1},[]);return y.useEffect(()=>{n?h().then(()=>i(!0)):i(!0)},[]),r.jsx("button",{className:R("flex items-center w-full h-full font-normal text-black text-t4",{hidden:!o},a),type:"button",onClick:h,children:l?r.jsx(u3,{time:60,className:"text-grey3",prefix:"倒计时",onFinish:p}):r.jsxs(r.Fragment,{children:[d,r.jsx(V,{className:"ml-1 animate__animated animate__headShake",name:"IcLoginCode",size:"xxsmall"})]})})},XIe=e=>{const{account:t,type:n=0,...s}=e,a=async()=>{wu()?await ve.infra.emailCaptcha({email:t,type:n}):await ve.infra.createPhoneCaptcha(t,{type:n})};return r.jsx(YIe,{sendCode:a,...s})},QIe=e=>{const[t,n]=y.useState(""),[s,a]=y.useState(),o=y.useRef(null);return r.jsxs("div",{className:"w-[400px] p-10",children:[r.jsx("div",{className:"text-t1-medium",children:"输入验证码完成注销"}),r.jsx("div",{className:"my-4",children:"已向注册手机号".concat(Cm(e.account),"发送验证码")}),r.jsx(Ct,{disableFloat:!0,maxLength:6,inputRef:o,className:"w-full h-[50px] mb-5 h-md:text-h4 px-3",inputClassName:"h-full px-0 text-t2",placeholder:"请输入验证码",onEnter:()=>{},value:t,onChange:i=>{n(i.toString())},warning:s,addonAfter:r.jsx(XIe,{autoClick:!0,onClick:()=>{var i;return(i=o.current)==null?void 0:i.focus()},account:e.account,type:m.CaptchaSendType.REMOVE_ACCOUNT,onError:i=>{var l;a(i),(l=o.current)==null||l.focus()}})}),r.jsx(De,{className:"mb-3 font-medium w-full",colorType:"red",disable:t.length===0,onClick:async()=>{const i=await ve.infra.removeUser.raw(yt.uuid,{captcha:t.trim(),reasons:e.reasonInfo.reasons,otherReason:e.reasonInfo.otherReason});if(i.code!==200){a(i.msg),me.event("close_account",{is_success:!1,close_reason:i.msg});return}e.onConfirm()},children:"确定注销"}),r.jsx(De,{className:"font-medium w-full",onClick:()=>{e.cancel(),dY(new Error("cancel"))},children:"取消"})]})},NP=100,JIe=["产品功能复杂，很难上手","部分使用需求未被满足","产品体验不佳","安全/隐私问题"],ZIe=e=>{const[t,n]=y.useState([!1]),[s,a]=y.useState(""),o=t.every(i=>!i&&s.length===0);return r.jsxs("div",{className:"flex flex-col w-[400px] px-[30px] overflow-y-auto",children:[r.jsx("div",{className:"text-center text-t1-medium mt-10",children:"注销服务"}),r.jsxs("div",{className:"mt-5 mb-1.5 text-t2",children:["亲爱的用户，请留下你的注销原因，",Na," 团队将持续改进服务。"]}),JIe.map((i,l)=>r.jsx(Ll,{className:"mt-3 ",onCheck:c=>{const d=t.slice(0);d[l]=c,n(d)},content:i},l)),r.jsxs("div",{className:"relative my-2 h-[112px]",children:[r.jsx("textarea",{placeholder:"其他(选填)",className:"py-2 px-3 w-full bg-grey9 rounded border border-grey6 focus-within-border text-t2 resize-none",rows:4,maxLength:NP,onChange:i=>a(i.target.value.trim())}),r.jsxs("div",{className:"absolute right-3 bottom-2",children:[s.length," ",r.jsx("span",{className:"text-grey3",children:"/ ".concat(NP)})]})]}),r.jsx(De,{className:"mb-4",disable:o,colorType:"active",onClick:()=>{e.onNext(t,s)},children:"继续"}),r.jsx(De,{onClick:e.onCancel,className:"mb-5",children:"取消"})]})},eNe=()=>{const e=sNe(),t=tNe(),n=rNe(),s=aNe(),a=oNe(),o=nNe(),i=rI(),l=async()=>{try{const{nickname:c}=xa();await t(),await o("删除".concat(c,"帐户和所有工作区数据")),await e(),await n();const d=await s();await a(d);const u=[];d.reasons.forEach((f,h)=>{f&&u.push(h.toString())}),d.otherReason&&u.push(d.otherReason),me.event("close_account",{is_success:!0,close_reason:u.join(";")}),be.success("注销成功"),setTimeout(async()=>{await i(),Er(Nt.login)},1e3)}catch(c){}};return y.useCallback(l,[i,o,s,n,t,e,a])},tNe=()=>{const e=ie(),t=a5(),n=Ut(),{editor:s}=pg(n.uuid);return y.useCallback(()=>new Promise((a,o)=>{const{nickname:i}=xa();e.warning({colorType:"red",maxWidth:400,title:"即将注销您的 ".concat(Na," 帐户"),content:s?r.jsxs(r.Fragment,{children:[r.jsx("span",{children:"注意即将销毁帐户下所有空间数据，如果只是删除空间请点击"}),r.jsx("span",{className:"text-red underline animate-click underline-offset-4 mx-1",onClick:t,children:"删除空间"})]}):"注意即将销毁帐户下所有空间数据，如果只是删除空间请前往「空间设置」继续操作",confirmText:"继续注销 @".concat(i),confirm:a,cancelText:"取消",cancel:()=>{o(new Error("cancel"))}})}),[s,t,e])},nNe=()=>{const e=ie();return y.useCallback(t=>new Promise((n,s)=>{let a="";e.warning({colorType:"red",maxWidth:400,title:"永久删除您的整个帐户？",className:"select-none",content:r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 text-grey3",children:"此操作无法撤消。这将永久删除您的整个帐户。所有私人工作区都将被删除，您将从所有共享工作区中删除。"}),r.jsx("div",{className:"py-5 text-t2-bold",children:"请输入：".concat(t)}),r.jsx(Ct,{className:"h-10",autoFocus:!0,placeholder:t,onChange:o=>a=o})]}),confirmText:"继续",confirm:()=>{if(a.toLocaleLowerCase()===t.toLocaleLowerCase())n();else throw be.error("输入错误"),new Error("confirm")},cancelText:"取消",cancel:()=>{s(new Error("cancel"))}})}),[e])},sNe=()=>{const e=ie();return y.useCallback(()=>new Promise((t,n)=>{e.warning({colorType:"active",maxWidth:400,title:r.jsx(ul,{popup:"查看注销帐户帮助",link:_i.cancelAccount,children:"注销须知"}),content:r.jsxs("div",{className:"flex flex-col items-start text-left",children:[r.jsxs("div",{children:["亲爱的 ",Na," 用户，我们对你的注销深表遗憾。"]}),r.jsxs("div",{children:["在你提交注销申请生效前，请确保你已知悉以下内容，",Na," 团队有权进行验证:"]}),r.jsxs("ul",{className:"ml-4 mt-5",style:{listStyle:"disc"},children:[r.jsx("li",{children:"该帐户下所有权益视为默认放弃，包含积分、已购买的订阅付费等"}),r.jsxs("li",{children:["若该帐户存在纠纷，如帐户封禁、投诉举报、诉讼等，",Na," 有权配合后续追诉"]})]})]}),confirmText:"我已知晓",confirm:()=>{t()},cancelText:"取消",cancel:()=>{n(new Error("cancel"))}})}),[e])},rNe=()=>{const e=ie();return y.useCallback(()=>new Promise((t,n)=>{e.warning({maxWidth:400,colorType:"active",title:"注销服务",content:r.jsxs("div",{className:"text-left",children:[r.jsx("div",{children:"请确保你已妥善处理空间及数据，注销后将导致:"}),r.jsxs("ul",{className:"ml-4 mt-5",style:{listStyle:"disc"},children:[r.jsx("li",{children:"自动退出所有多人空间（包含已邀请空间成员及外部协作者的团队空间/个人空间），已有数据不会失效"}),r.jsx("li",{children:"仅含自己的空间，将永久删除空间所有数据"})]})]}),confirmText:"继续",confirm:()=>{t()},cancelText:"取消",cancel:()=>{n(new Error("cancel"))}})}),[e])},aNe=()=>{const e=ie(),t=ln();return y.useCallback(()=>new Promise((n,s)=>{const{modalId:a}=e.modal({autoClose:!1,keyboard:!1,content:()=>r.jsx(ZIe,{onCancel:()=>{s(new Error("cancel")),t(a)},onNext:(o,i)=>{const l=[];o.forEach((c,d)=>{c&&l.push(d.toString())}),n({reasons:l,otherReason:i}),t(a)}})})}),[t,e])},oNe=()=>{const e=ie(),t=ln();return y.useCallback(n=>new Promise((s,a)=>{const{modalId:o}=e.modal({autoClose:!1,keyboard:!1,content:()=>{var i;return r.jsx(QIe,{reasonInfo:n,account:(i=yt.phone)!=null?i:yt.email,onConfirm:()=>{t(o),s()},cancel:()=>{t(o),a(new Error("cancel"))}})}})}),[t,e])},iNe=e=>{const[t,n]=y.useState(),[s,a]=y.useState(""),o=async(l,c)=>{if(!l)return;const d=await Zt.request.infra.wechatAuthorization({code:l,type:c});return i(d)},i=async l=>{if(l.status===m.RegisterStatus.UN_REGISTERED&&l.authorizationCode)a(l.authorizationCode),n(la.NEED_BIND_PHONE);else if(l.status===m.RegisterStatus.REGISTERED&&l.authorizationCode)return n(la.CAN_LOGIN),await Zt.request.infra.loginAuthorizationCode({type:e,code:l.authorizationCode})};return{accountStatus:t,authorizationCode:s,tryLogin:o,updateAccountState:i}},lNe=e=>{const{accountStatus:t,authorizationCode:n,tryLogin:s}=iNe(m.UserAuthorizationType.WECHAT),a=iM(e.switchViewType),{switchViewType:o}=e;return cNe("wechat_login_container"),y.useEffect(()=>{switch(t){case la.NEED_BIND_PHONE:{n&&o({type:zo.BIND_PHONE,props:{authorization:{code:n,type:m.UserAuthorizationType.WECHAT}}});break}}},[n,e,t,o]),y.useEffect(()=>{const i=async l=>{var c;try{const d=l.data;if((d==null?void 0:d.state)===ML){if(e.onAuth){e.onAuth(d.code);return}const u=await s(d.code,"web");if(!u)return;(!e.complete||a(u))&&((c=e.onSuccess)==null||c.call(e,u))}}catch(d){}};return window.addEventListener("message",i),()=>{window.removeEventListener("message",i)}},[a,e,o,s]),r.jsxs("div",{className:"next-modal flex w-full flex-col items-center pb-8",children:[!e.onAuth&&r.jsx("img",{src:Wb.IcTitleClose,onClick:()=>{o({type:zo.LOGIN})},className:"mr-4 mt-4 h-5 w-5 self-end cursor-pointer dark:invert"}),r.jsx("img",{src:Wb.wechatLogoLogin,className:"mt-6"}),r.jsx("div",{id:"wechat_login_container",className:"mt-6"})]})},cNe=e=>{y.useLayoutEffect(()=>{let t;t=setInterval(()=>{typeof window.WxLogin=="function"&&(t&&clearInterval(t),window.WxLogin({self_redirect:!0,id:e,appid:Zt.wechatId,scope:"snsapi_login",redirect_uri:"".concat(location.origin,"/auth-callback"),state:ML,style:"",href:""}))},50)},[e])};if(typeof document<"u"&&!document.getElementById("wechat_login_js")){const t=document.createElement("script");t.id="wechat_login_js",t.src="https://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js",document.body.appendChild(t)}const Sq=()=>{const e=y.useCallback(async(n,s,a)=>{var i;const o=await Zt.request.infra.emailAuthorization({email:s,captcha:a,type:m.CaptchaSendType.BIND_NEW});if(o.nickname){Zt.message.success("该账号已被昵称 ".concat(o.nickname," 的帐户绑定"));return}return Zt.request.infra.bindThirdAccount(n,{type:m.UserAuthorizationType.EMAIL,code:(i=o.authorizationCode)!=null?i:""})},[]),t=y.useCallback(async(n,s)=>{var o;const a=await Zt.request.infra.wechatAuthorization({code:s,type:"web"});return Zt.request.infra.bindThirdAccount.raw(n,{type:m.UserAuthorizationType.WECHAT,code:(o=a.authorizationCode)!=null?o:""})},[]);return{bindEmail:e,bindWechat:t}},dNe={primary:"bg-black2 border-black text-white-base",secondary:"bg-white dark:bg-transparent text-black border-grey6",red:"bg-white1 text-red border-red",white:"bg-transparent text-black border-white",active:"bg-active_color text-white border-transparent"},uNe={primary:"hover:opacity-90",secondary:"hover:brightness-90 dark:hover:bg-black_003",red:"hover:bg-red/10",white:"hover:bg-black_003",active:"hover:brightness-90 text-t2-bold dark:hover:brightness-110"},DRe=fn.memo(e=>{const{colorType:t="secondary",disable:n,onClick:s,autoFocus:a=!1,className:o,children:i,...l}=e;return r.jsx("button",{...l,onClick:s,autoFocus:a,disabled:n,className:rw("flex justify-center items-center rounded-md border outline-none",dNe[t],n?"opacity-30 cursor-not-allowed":uNe[t],o),children:i})}),fNe={auto:"h-full w-full text-t1",middle:"w-80 h-12 text-t1",large:"h-8 px-3.5 text-t2"},mNe={primary:"bg-black1 border-black text-white dark:border-grey6",secondary:"bg-white dark:bg-transparent text-black border-grey6",red:"bg-white1 text-red border-red",white:"bg-transparent text-black border-grey5 dark:border-grey6",active:"bg-active_color text-white border-transparent"},hNe={primary:"hover:opacity-90 dark:hover:brightness-110",secondary:"hover:brightness-90 dark:hover:bg-black_003",red:"hover:bg-red/10",white:"hover:bg-black_003",active:"hover:brightness-90 text-t2-bold dark:hover:brightness-110"},D2=fn.memo(e=>{const{colorType:t="secondary",disable:n,onClick:s,autoFocus:a=!1,size:o="large",className:i,children:l,...c}=e;return r.jsx("button",{...c,onClick:s,autoFocus:a,disabled:n,className:rw("flex justify-center items-center rounded border outline-none",fNe[o],mNe[t],n?"opacity-30 cursor-not-allowed":"".concat(hNe[t]," animate-click"),i),children:l})}),A2=e=>{var ne,se,ce;const[t,n]=y.useState(e==null?void 0:e.accountStatus),[s,a]=y.useState((ne=e==null?void 0:e.account)!=null?ne:""),[o,i]=y.useState(""),[l,c]=y.useState(""),[d,u]=y.useState(""),[f,h]=y.useState((se=e==null?void 0:e.password)!=null?se:""),[p,g]=y.useState(""),[_,x]=y.useState(e==null?void 0:e.authorization),[F,b]=y.useState(),[w,E]=y.useState((ce=e==null?void 0:e.newInviteCode)!=null?ce:""),[C,k]=y.useState("tmp"),T=t===la.CAN_LOGIN,v=t===la.CAN_SIGN,I=y.useCallback(ae=>{c(ae.trim()),u("")},[]),j=y.useCallback(ae=>{h(ae.trim()),g("")},[]),S=y.useCallback(ae=>{a(ae.trim()),i(""),I(""),n(de=>{if(de===la.NEED_BIND_PHONE)return de;k("tmp")})},[I]),D=y.useCallback(ae=>{E(ae)},[]),A=async()=>{if(!P())return;const ae=de=>{de===m.PhoneCheckStatus.CAN_LOGIN?n(la.CAN_LOGIN):n(la.CAN_SIGN)};if(ca.Email.test(s)){const de=await Zt.request.infra.checkEmail({email:s});return ae(de.status),de}else if(ca.Mobile.test(s)){const de=await Zt.request.infra.checkPhone(s);return ae(de.status),de}i("账号格式不正确")},P=()=>!ca.Email.test(s)&&!ca.Mobile.test(s)?(i("账号格式不正确"),!1):!0,L=()=>ca.VerifyCode.test(l)?e!=null&&e.inviteCodeRequired&&!la.CAN_LOGIN&&!w?(u("邀请码不能为空"),!1):!0:(u("验证码错误"),!1),O=()=>!f||!ca.Password.test(f)?(g("密码格式有误"),!1):!0,$=y.useCallback(()=>ca.Mobile.test(s),[s]),M=()=>ca.Email.test(s),U=async ae=>{if(!P())return;if($()){const ke=await Zt.request.infra.createPhoneCaptcha.raw(s,{type:ae});if(ke.code!==200){u(ke.msg);return}Zt.message.success("验证码已发送")}else{const ke=await Zt.request.infra.emailCaptcha.raw({email:s,type:ae});if(ke.code!==200){u(ke.msg);return}Zt.message.success("验证码已发送")}return!0},z=async()=>{var ae;if(L()&&!(t===la.CAN_SIGN&&!O())){if($())return K();if(M()){const de=await Zt.request.infra.emailAuthorization({email:s,captcha:l,type:m.CaptchaSendType.SIGNUP});x({code:(ae=de.authorizationCode)!=null?ae:"",type:m.UserAuthorizationType.EMAIL}),n(la.NEED_BIND_PHONE)}}},K=async()=>{var ke;if(!L())return;const ae=f?qf(f):void 0,de=await Zt.request.infra.usersRegister.raw({type:(ke=_==null?void 0:_.type)!=null?ke:m.UserAuthorizationType.PHONE,phone:s,captcha:l,password:ae,inviteCode:w!=null?w:void 0,authorizationCode:_==null?void 0:_.code,promotionChannel:F,validate:C});if(de.code===200)return F&&Zt.request.infra.behaviorReport.raw({topic:"activity",business:{type:"enter",activeFrom:"new_activation"}}),Zt.event("user_register",{is_success:!0,activation_channel:w?"邀请":"其它",promotion_channel:F,...eX()},!0),Zt.event("config",{user_unique_id:de.data.uuid},!0),Zt.afterLogin(),await Ik(800),de.data;if(Zt.event("user_register",{is_success:!1,fail_reason:de.code}),de.code===1009){n(la.BIND_FAIL);return}if(de.code===1003){Zt.message.error("恶意注册已拦截，如有疑问请联系客服");return}await Ik(800),Zt.message.error(de.msg)},W=async()=>{if(!P()||!L())return;const ae=await Zt.request.infra.loginCaptcha.raw({account:s,captcha:l});if(ae.code!==200){u(ae.msg);return}return Zt.event("config",{user_unique_id:ae.data.uuid},!0),Zt.afterLogin(),ae.data},Y=async()=>{if(t===void 0){const de=await A();if((de==null?void 0:de.status)===m.PhoneCheckStatus.CAN_SIGN)return}if(!ca.Email.test(s)&&!ca.Mobile.test(s)){i("账号格式不正确");return}if(!ca.Password.test(f)){g("账号或密码错误");return}const ae=await Zt.request.infra.loginPassword.raw({account:s,password:qf(f)});if(ae.code===200)return Zt.event("config",{user_unique_id:ae.data.uuid},!0),Zt.afterLogin(),ae.data;g(ae.msg)},G=async()=>{if(!P()||!L()||!O())return;const ae=$();if(t===la.CAN_SIGN){const de=await z();if(de)return de;!ae&&n(la.NEED_BIND_PHONE)}else{const de=qf(f);ae?await Zt.request.infra.resetUserPasswordByPhone(s,{password:de,captcha:l}):await Zt.request.infra.resetUserPasswordByEmail({email:s,password:de,captcha:l});const ke=await Zt.request.infra.loginPassword({account:s,password:de});return Zt.event("config",{user_unique_id:ke.uuid},!0),Zt.afterLogin(),ke}},ee=()=>{switch(t){case la.CAN_LOGIN:return W();case la.CAN_SIGN:return z();case la.NEED_BIND_PHONE:return K();case void 0:A();break}},te=$()||M();return{canSendVerifyCode:y.useMemo(()=>v&&e!=null&&e.inviteCodeRequired?!!w:te,[w,v,e==null?void 0:e.inviteCodeRequired,te]),isToLogin:T,isToRegister:v,accountStatus:t,account:s,accountError:o,verifyCode:l,verifyCodeError:d,password:f,passwordError:p,inviteCode:w,authorization:_,yidunCaptcha:C,setVerifyCodeError:u,setVerifyCode:I,setAccountStatus:n,next:ee,setAccount:S,sendVerifyCode:U,setInviteCode:D,setPassword:j,loginByPassword:Y,setAuthorization:x,resetPassword:G,setPromotionChannel:b,isPhoneNumber:$,checkAccount:P,checkVerifyCode:L,setPasswordError:g,setYidunCaptcha:k}},U1=e=>{var I;const{type:t="text",visible:n=!0,showBorder:s=!0,value:a,onChange:o,placeholder:i,addonAfter:l,addonBefore:c,maxLength:d,autoFocus:u,warning:f,inputRef:h,onEnter:p,defaultValue:g,onBlur:_,onFocus:x,selection:F,style:b,readonly:w=!1,onClick:E,onKeyDown:C}=e,k=y.useRef(!1),T=y.useRef(null),v=j=>{if(!o)return;const S=j.target.value;let D;const A=/^\d+$/.test(S);if(t==="text")D=S;else if(t==="number")if(A||!S)D=S;else return;o(D)};return y.useEffect(()=>{var j,S;h&&(h.current=T.current),(F==null?void 0:F[0])!==void 0&&F[1]!==void 0&&((j=T.current)==null||j.setSelectionRange(F[0],F[1])),u&&((S=T.current)==null||S.focus())},[]),r.jsxs("div",{style:b,className:fb("flex items-center rounded relative box-border bg-grey8 text-t2 border border-grey6",{hidden:!n,"border-red":f,"focus-within-border":s&&!f,"border-none":!s},e.className),onClick:()=>{var j;!w&&!c&&!l&&((j=T.current)==null||j.focus())},children:[r.jsx("input",{ref:T,spellCheck:!1,className:fb("align-middle cursor-text text-t1 flex-grow text-black outline-none bg-transparent placeholder-grey4 w-full",e.inputClassName),type:(I=e.inputType)!=null?I:"text",onKeyDown:j=>{if(C)C(j);else{if(j.stopPropagation(),k.current)return;Ie("enter")(j)&&p&&p(j)}},disabled:w,onFocus:()=>{w||x==null||x()},onBlur:()=>_==null?void 0:_(),onClick:j=>{var S;E==null||E(),(S=T.current)==null||S.focus(),j.stopPropagation()},autoFocus:u,maxLength:d||-1,value:a,defaultValue:g,placeholder:i,onInput:v,onCompositionStart:()=>k.current=!0,onCompositionEnd:()=>k.current=!1}),l&&r.jsx("span",{className:"flex items-center justify-center h-full pl-2 whitespace-nowrap",children:l}),f&&r.jsx("span",{className:"absolute -bottom-5 mb-0.5 text-red left-2 text-t4",children:f})]})},pNe=e=>{const{isEmail:t,onSuccess:n,authorizationCode:s,userId:a,type:o}=e,{account:i,accountError:l,setVerifyCodeError:c,setAccount:d,verifyCode:u,verifyCodeError:f,setVerifyCode:h,sendVerifyCode:p}=A2(),g=()=>{(t?Zt.request.infra.changeBindEmail.raw(a,{email:i,captcha:u,type:o,code:s}):Zt.request.infra.changeBindPhone.raw(a,{phone:i,captcha:u,type:o,code:s})).then(_=>{_.code===200?n==null||n():c(_.msg)})};return r.jsxs("div",{className:"next-modal pt-10 pb-5 px-7 flex flex-col items-center min-w-[400px]",children:[r.jsx("div",{className:"mb-5 text-t1-medium",children:t?"换绑邮箱":"换绑手机号"}),r.jsx(U1,{autoFocus:!0,warning:l,value:i,className:"w-full mb-5 px-3",inputClassName:"h-8",onChange:_=>d(_.toString())}),r.jsx(U1,{type:"number",className:"w-full mb-8 px-3",inputClassName:"h-8",maxLength:6,value:u,warning:f,onChange:_=>h(_.toString()),addonAfter:r.jsx(Ix,{showIcon:!1,onSendVerifyCode:()=>p(m.CaptchaSendType.CHANGE_BIND)})}),r.jsx(D2,{className:"self-start px-5",colorType:"active",disable:!i||!u,onClick:()=>g(),children:"完成绑定"})]})},gNe=e=>{const{userId:t,onSuccess:n}=e,{password:s,setPassword:a,passwordError:o,setPasswordError:i}=A2(),l=async()=>{if(!ca.Password.test(s)){i("密码不对");return}const c=await Zt.request.infra.passwordAuthorization.raw({uuid:t,password:qf(s)});c.code===200?c.data.authorizationCode&&(n(c.data.authorizationCode),i("验证失败")):i(c.msg)};return r.jsxs("div",{className:"next-modal pt-10 pb-5 px-7 flex flex-col items-center min-w-[400px]",children:[r.jsx("div",{className:"mb-5 text-t1-medium",children:"验证登录密码"}),r.jsx(U1,{autoFocus:!0,inputType:"password",value:s,className:"mb-10 w-full",placeholder:"请输入当前登录密码",inputClassName:"px-3 h-8 text-t2",onEnter:()=>void l(),warning:o,onChange:c=>a(c.toString())}),r.jsx(D2,{disable:!s,className:"text-t2 h-8",size:"auto",onClick:()=>void l(),children:"下一步"})]})},Dq=()=>async e=>{const{account:t,isEmail:n,code:s,onError:a,type:o}=e,i=await(n?Zt.request.infra.emailAuthorization.raw({email:t,captcha:s,type:o}):Zt.request.infra.phoneAuthorization.raw({phone:t,captcha:s,type:o}));if(i.code===200)return i.data;a==null||a(i.msg)},_Ne=e=>{const{phone:t,onSuccess:n}=e,s=Dq(),{sendVerifyCode:a,verifyCode:o,setVerifyCode:i,verifyCodeError:l,setVerifyCodeError:c}=A2({account:t}),d=async()=>{if(!ca.VerifyCode.test(o)){c("验证码错误");return}const u=await s({account:t,code:o,type:m.CaptchaSendType.CHANGE_BIND,onError:c});u!=null&&u.authorizationCode&&n(u.authorizationCode)};return r.jsxs("div",{className:"next-modal pt-10 pb-5 px-7 flex flex-col items-center min-w-[400px]",children:[r.jsx("div",{className:"mb-5 text-t1-medium",children:"验证手机号"}),r.jsxs("div",{className:"mb-5 text-t2",children:["已向注册手机号",t,"发送验证码"]}),r.jsx(U1,{value:o,maxLength:6,type:"number",className:"mb-10 w-full",placeholder:"请输入验证码",inputClassName:"px-3 h-8 text-t2",onEnter:()=>void d(),warning:l,onChange:u=>i(u.toString()),addonAfter:r.jsx(Ix,{autoClick:!0,className:"mr-3",showIcon:!1,onSendVerifyCode:()=>a(m.CaptchaSendType.LOGIN)})}),r.jsx(D2,{className:"text-t2 h-8",size:"auto",onClick:()=>void d(),children:"下一步"})]})},Aq=()=>{WY({cx:R,request:ve,event(e,t,n){me.event(e,t,n)},message:be,EmojiIcon:e=>{var t;return r.jsx(na,{iconSize:(t=e.size)!=null?t:24,emojiStr:e.value,disableHover:!0})},afterLogin:()=>{},wechatId:"wx7de87594073bf09f",origin:e0,cdnHost:Lo})},xNe=e=>{const{email:t,setEmail:n,emailError:s,verifyCode:a,setVerifyCode:o,verifyCodeError:i,bind:l,sendVerifyCode:c}=yNe();return r.jsxs("div",{className:"p-7 w-[400px]",children:[r.jsx("div",{className:"text-t1-medium ",children:"绑定邮箱"}),r.jsx(Ct,{autoFocus:!0,warning:s,className:"w-full h-9 mt-5",inputClassName:"opacity-50",value:t,placeholder:"请输入邮箱",onChange:n}),r.jsx(Ct,{type:"number",value:a,maxLength:6,warning:i,className:"w-full h-9 mt-5 px-3",inputClassName:"opacity-50 px-0",placeholder:"请输入验证码",onChange:d=>o(d.toString()),addonAfter:r.jsx(Ix,{onSendVerifyCode:()=>c()})}),r.jsx(De,{onClick:async()=>{await l()&&e.onSuccess()},colorType:"active",className:"mt-6",children:"完成绑定"})]})};Aq();const yNe=()=>{const[e,t]=y.useState(""),[n,s]=y.useState(),[a,o]=y.useState(""),[i,l]=y.useState(""),{bindEmail:c}=Sq(),d=()=>Gl.Email.test(e)?!0:(s("邮箱格式不正确"),!1),u=()=>Gl.VerifyCode.test(a)?!0:(l("验证码错误"),!1);return{email:e,emailError:n,verifyCode:a,verifyCodeError:i,setEmail:t,setVerifyCode:o,sendVerifyCode:async()=>{if(d())return ve.infra.emailCaptcha({email:e,type:m.CaptchaSendType.BIND_NEW})},bind:async()=>{if(d()&&u())return c(yt.uuid,e,a)}}},bNe={[m.UserAuthorizationType.WECHAT]:"微信",[m.UserAuthorizationType.QQ]:"QQ",[m.UserAuthorizationType.APPLE]:"苹果账号",[m.UserAuthorizationType.EMAIL]:"邮箱",[m.UserAuthorizationType.PHONE]:"手机",[m.UserAuthorizationType.PASSWORD]:"密码"},FNe=()=>{const e=ie(),t=Nd();return y.useCallback(n=>{e.warning({title:"是否确认解除绑定?",content:"将无法继续使用".concat(bNe[n],"登录当前FlowUs账号"),confirmText:"确认",confirm:async()=>{await ve.infra.unbindAccount(yt.uuid,{type:n}),await t(),be.success("解绑成功")}})},[t,e])},{WechatLoginElectron:wNe}=Qn(()=>Pe(()=>import("./wechat-login-electron-af83311b.js"),["assets/wechat-login-electron-af83311b.js","assets/vendor-2890c4d6.js"])),ENe=gs.check?wNe:lNe,CNe=()=>{const e=ie(),t=FNe(),n=Nd(),{bindWechat:s}=Sq();return y.useCallback((a,o)=>{var c,d,u,f;const i=yt;if(o===m.UserAuthorizationType.EMAIL&&((c=i.ext)!=null&&c.email)||o===m.UserAuthorizationType.WECHAT&&((d=i.ext)!=null&&d.wechat)||o===m.UserAuthorizationType.QQ&&((u=i.ext)!=null&&u.qq)||o===m.UserAuthorizationType.APPLE&&((f=i.ext)!=null&&f.apple)){t(o);return}const l=async()=>{await n(),be.success("绑定成功")};o===m.UserAuthorizationType.EMAIL?e.modal({content:({onCloseModal:h})=>r.jsx(xNe,{onSuccess:async()=>{l(),h()}})}):o===m.UserAuthorizationType.WECHAT?e.modal({content:({onCloseModal:h})=>r.jsx("div",{className:"w-[400px]",children:r.jsx(ENe,{onAuth:async p=>{const g=await s(yt.uuid,p);g.code===200?l():g.code===1009?be.error("该微信已注册"):be.error(g.msg),h()},switchViewType:()=>{}})})}):(o===m.UserAuthorizationType.QQ||o===m.UserAuthorizationType.APPLE)&&be.warning("请在移动端进行绑定")},[s,n,e,t])},kNe=e=>{const{email:t,onSuccess:n}=e,s=Dq(),{sendVerifyCode:a,verifyCode:o,setVerifyCode:i,verifyCodeError:l,setVerifyCodeError:c}=A2({account:t}),d=async()=>{if(!ca.VerifyCode.test(o)){c("验证码错误");return}const u=await s({account:t,isEmail:!0,code:o,type:m.CaptchaSendType.CHANGE_BIND,onError:c});u!=null&&u.authorizationCode&&n(u.authorizationCode)};return r.jsxs("div",{className:"next-modal pt-10 pb-5 px-7 flex flex-col items-center min-w-[400px]",children:[r.jsx("div",{className:"mb-5 text-t1-medium",children:"验证邮箱"}),r.jsx("div",{className:"mb-5 text-t2",children:t}),r.jsx(U1,{value:o,maxLength:6,type:"number",className:"mb-10 w-full",placeholder:"请输入验证码",inputClassName:"px-3 h-8 text-t2",onEnter:()=>void d(),warning:l,onChange:u=>i(u.toString()),addonAfter:r.jsx(Ix,{autoClick:!0,className:"mr-3",showIcon:!1,onSendVerifyCode:()=>a(m.CaptchaSendType.CHANGE_BIND)})}),r.jsx(D2,{className:"text-t2 h-8",size:"auto",onClick:()=>void d(),children:"下一步"})]})},TNe=()=>{const e=Ut(),t=Rq();return r.jsx(dt.Item,{leftChild:r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{children:"手机号"}),r.jsx("div",{className:"text-t4 text-grey3",children:e.phone})]}),rightChild:r.jsx(De,{onClick:()=>t("phone"),children:"换绑手机号"})})},Rq=()=>{const e=Ut(),t=ie(),n=Nd(),s=ug();return y.useCallback(a=>{const o=a==="phone",i=()=>{t.warning({title:o?"确认换绑当前手机号？":"确认换绑当前邮箱？",confirmText:"确认",cancelText:"取消",minWidth:400,content:r.jsxs("div",{className:"mb-10",children:[r.jsx("div",{children:o?"换绑后，将无法继续通过以下手机号进行验证登录":"换绑后，将无法继续通过以下邮箱进行验证登录"}),r.jsx("div",{children:o?e.phone:e.email})]}),confirm:l})},l=()=>{t.warning({title:"身份验证",confirmText:o?"通过原手机号验证":"通过原邮箱验证",cancelText:"通过登录密码验证",colorType:"active",minWidth:400,content:r.jsxs("div",{className:"mb-10",children:[r.jsx("div",{className:"mb-1.5",children:"为保障账号安全，请选择验证方式"}),r.jsx("div",{className:"text-grey3 text-t4",children:"无法接收验证码、忘记密码？请联系人工客服处理"})]}),confirm:()=>{c()},cancel:()=>{d()}})},c=()=>{t.modal({content:f=>o?r.jsx(_Ne,{phone:e.phone,onSuccess:h=>{f.onCloseModal(),u(h,m.UserAuthorizationType.PHONE)}}):r.jsx(kNe,{email:e.email,onSuccess:h=>{f.onCloseModal(),u(h,m.UserAuthorizationType.EMAIL)}})})},d=()=>{t.modal({content:f=>r.jsx(gNe,{userId:e.uuid,onSuccess:h=>{f.onCloseModal(),u(h,o?m.UserAuthorizationType.PHONE:m.UserAuthorizationType.PASSWORD)}})})},u=(f,h)=>{t.modal({content:p=>r.jsx(pNe,{type:h,isEmail:!o,authorizationCode:f,userId:e.uuid,onSuccess:async()=>{p.onCloseModal(),await n(),be.success("登录已失效，请重新登录"),s()}})})};i()},[e.email,e.phone,e.uuid,n,s,t])},Pq=Mr(void 0),vNe=()=>ea(Pq),INe=()=>{const e=So(Pq);return y.useCallback(async()=>{await ve.infra.isAuthentication().then(t=>e(t))},[e])},NNe=()=>{const e=vNe(),t=(e==null?void 0:e.status)===2,n=INe();y.useEffect(()=>{n()},[n]);const s=()=>{F0(ds.authentication)};return r.jsx(dt.Item,{leftChild:r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{children:t?["Hi, ",e.name,e.type==="student"?"同学":"老师"].join(""):"学生教师认证"}),r.jsx("div",{className:"text-t4 text-grey3",children:t?"".concat(e.schoolName):"立即认证，解锁更多福利"})]}),rightChild:r.jsx(De,{onClick:s,disable:t,children:t?"已认证":"立即认证"})})},hS=()=>{const e=Pm(),t=Ut();return y.useCallback(async n=>{var a;const s=(a=t.setting)!=null?a:{};await e({setting:{...s,...n}})},[t.setting,e])},jNe=()=>{const e=ie(),{handleSubmit:t,register:n}=Jv(),s=hS();return y.useCallback(()=>{e.modal({content:a=>r.jsxs("form",{className:"p-5 space-y-5 text-t1-medium w-72",onSubmit:t(async o=>{if(!ca.VerifyCode.test(o.pin)){be.error("PIN 码格式错误");return}await s({pin:I_.MD5(o.pin).toString()}),be.success("设置成功"),a.onCloseModal()}),children:[r.jsx("div",{children:"设置 PIN 码"}),r.jsx(y3,{inputProps:n("pin",{required:!0}),autoFocus:!0,className:"h-8 textSecurity",maxLength:6,placeholder:"输入 6 位数字"}),r.jsx(De,{colorType:"active",children:"完成"})]})})},[t,e,n,s])},SNe=()=>{const e=Ut(),t=Rq();return r.jsx(dt.Item,{leftChild:r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{children:"邮箱"}),r.jsx("div",{className:"text-t4 text-grey3",children:e.email})]}),rightChild:r.jsx(De,{onClick:()=>t("email"),children:"换绑邮箱"})})},DNe=()=>{var b,w,E,C,k,T,v,I,j,S,D,A,P,L,O;const e=ug(),t=Za(),n=Ut(),s=Pm(),[a,o]=y.useState(n.nickname),[i,l]=y.useState(n.avatar||""),{setClickMaskClose:c}=an(Ws),d=Uo(),u=eNe(),f=ie(),h=CNe(),p=jNe(),g=Nd(),_=async()=>{const $=a.trim();hp($,"").length>=2&&hp($,"").length<=20?(await s({nickname:$,avatar:i}),t(),be.success("保存成功")):be.error("昵称长度应为2-20个字符")},x=$=>{const M=$.target.files;if(!M)return;const U=M[0];be.loading({key:vu.UPLOAD_ICON,content:"上传中..."}),d({file:U,type:"public",searchType:"avatar",onComplete:z=>{be.closeMessage(vu.UPLOAD_ICON),z.success&&($.target.value="",be.success("上传完成"),l(z.ossName))}})},F=()=>{f.modal({content({onCloseModal:$}){return r.jsx(WIe,{phone:n.phone||n.email,type:n.password?Bv.BY_OLD_PASSWORD:Bv.BY_ACCOUNT,onSuccess:async()=>{await g(),be.success("设置成功"),$(),be.success("登录已失效，请重新登录"),e()}})}})};return y.useEffect(()=>{c(n.nickname===a&&i===(n.avatar||""))},[a,n.nickname,c,n.avatar,i]),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:dt.commonStyles.container,children:[r.jsx(dt.Header,{title:"账号设置",name:"头像"}),r.jsxs("div",{className:"mt-4 flex flex-row items-center justify-between",children:[r.jsx(ar,{name:n.nickname,color:n.backgroundColor,icon:{type:"upload",value:i},className:"rounded-full mb-3.5 text-white",imgClassName:"rounded-full",iconSize:60,style:{fontSize:"30px"}}),r.jsxs("div",{className:"flex flex-row space-x-5",children:[r.jsx(De,{className:R({hidden:!i}),onClick:()=>l(""),children:"移除头像"}),r.jsx(De,{className:"px-0",children:r.jsxs("label",{className:"cursor-pointer py-1.5 px-4",children:["上传头像",r.jsx("input",{className:"hidden",type:"file",accept:"image/*",onChange:x})]})})]})]}),r.jsx(dt.SettingDivider,{className:"mb-2.5"}),r.jsx("div",{className:dt.commonStyles.name,children:"昵称"}),r.jsx(Ct,{maxLength:20,className:dt.commonStyles.input,value:a,inputClassName:"h-8",placeholder:"请输入你的昵称，长度需在2-20个字符之间",...Gs(Hs.settingAccountInput),onEnter:()=>_(),onChange:$=>o("".concat($))}),r.jsx(dt.SettingDivider,{}),r.jsxs(r.Fragment,{children:[r.jsx(SNe,{}),r.jsx(dt.SettingDivider,{})]}),r.jsxs(r.Fragment,{children:[r.jsx(TNe,{}),r.jsx(dt.SettingDivider,{})]}),r.jsxs(r.Fragment,{children:[r.jsx(NNe,{}),r.jsx(dt.SettingDivider,{})]}),r.jsxs(r.Fragment,{children:[r.jsx(dt.Item,{leftChild:"登录密码",rightChild:r.jsx(De,{onClick:F,children:n.password?"修改密码":"设置密码"})}),r.jsx(dt.SettingDivider,{})]}),r.jsxs(r.Fragment,{children:[r.jsx(dt.Item,{leftChild:r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{children:"PIN"}),r.jsx("div",{className:"text-t4 text-grey3",children:"锁屏 PIN 码"})]}),rightChild:r.jsx(De,{onClick:p,children:(b=n.setting)!=null&&b.pin?"修改 PIN 码":"添加 PIN 码"})}),r.jsx(dt.SettingDivider,{})]}),r.jsxs(r.Fragment,{children:[r.jsx(dt.Item,{leftChild:r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{children:"邮箱"},"email"),((w=n.ext)==null?void 0:w.email)&&r.jsx("div",{className:"text-t4 text-grey3",children:n.ext.email.id})]}),rightChild:r.jsx(De,{onClick:$=>{h($,m.UserAuthorizationType.EMAIL)},children:(E=n.ext)!=null&&E.email?"解除绑定":"绑定邮箱"})}),r.jsx(dt.SettingDivider,{})]}),r.jsxs(r.Fragment,{children:[r.jsx(dt.Item,{leftChild:r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{children:"微信"}),((C=n.ext)==null?void 0:C.wechat)&&r.jsx("div",{className:"text-t4 text-grey3",children:(T=(k=n.ext)==null?void 0:k.wechat)==null?void 0:T.nickname})]}),rightChild:r.jsx(De,{onClick:$=>{h($,m.UserAuthorizationType.WECHAT)},children:(v=n.ext)!=null&&v.wechat?"解除绑定":"绑定微信"})}),r.jsx(dt.SettingDivider,{})]}),r.jsxs(r.Fragment,{children:[r.jsx(dt.Item,{leftChild:r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{children:"QQ"}),((j=(I=n.ext)==null?void 0:I.qq)==null?void 0:j.nickname)&&r.jsx("div",{className:"text-t4 text-grey3",children:n.ext.qq.nickname})]}),rightChild:r.jsx(De,{onClick:$=>{h($,m.UserAuthorizationType.QQ)},children:(S=n.ext)!=null&&S.qq?"解除绑定":"绑定QQ"})}),r.jsx(dt.SettingDivider,{})]}),r.jsxs(r.Fragment,{children:[r.jsx(dt.Item,{leftChild:r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{children:"Apple ID"}),((D=n.ext)==null?void 0:D.apple)&&r.jsx("div",{className:"text-t4 text-grey3",children:((A=n.ext)==null?void 0:A.apple.nickname)||((P=n.ext)==null?void 0:P.apple.email)||((L=n.ext)==null?void 0:L.apple.id)})]}),rightChild:r.jsx(De,{onClick:$=>{h($,m.UserAuthorizationType.APPLE)},children:(O=n.ext)!=null&&O.apple?"解除绑定":"绑定Apple ID"})}),r.jsx(dt.SettingDivider,{})]}),r.jsx(dt.Item,{leftChild:r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{children:"注销帐户"}),r.jsx("div",{className:"text-t4 text-grey3",children:"退出所有空间，仅有自己的空间将会被彻底删除。不可恢复"})]}),rightChild:r.jsx(De,{colorType:"red",onClick:()=>{u()},children:"注销帐户"})})]}),r.jsx(dt.FooterBar,{cancel:()=>t(),confirm:_})]})},jP=e=>{const{addonBefore:t,text:n,active:s,onClick:a,staticStyle:o,activeStyle:i="icon",addonAfter:l,className:c,description:d,showPopup:u,dataTestId:f,badge:h,...p}=e;return r.jsxs("div",{onClick:a,...Gs(f),...p,className:R("flex relative items-center justify-between h-10 cursor-pointer px-2 rounded",o?"text-grey3":"text-black",i==="bg"?!s&&"animate-hover hover:bg-black_003":"animate-hover",s&&i==="bg"&&"normal-bg",c),children:[r.jsxs("div",{className:"flex items-center w-10/12",children:[r.jsx("span",{className:"mr-2 flex items-center text-grey3",children:t}),r.jsxs("div",{className:"w-full text-ellipsis",children:[r.jsx(Fe,{popup:u?n:"",className:"text-ellipsis block w-fit max-w-full",children:n}),d&&r.jsx("div",{className:"text-ellipsis text-grey3 text-t4 mt-px w-full",children:d})]})]}),s&&i==="icon"&&r.jsx(V,{name:"IcCheck02",size:"middle"}),l,h]})},ANe=y.memo(()=>{const e=ie(),t=Za(),{currentSettingMenu:n,setCurrentSettingMenu:s}=an(Ws),a=Ut(),o=hg(),{editor:i}=o(a.uuid),l=ug(),c=ai(),d=YB(),u=h9(),{showOnce:f,close:h}=FB(L9.SettingProfitRedPoint,{endDay:-1,enable:!0}),p=_=>{_===Kt.profit&&h(),s(_)},g=y.useMemo(()=>{const _=[{type:Kt.line,name:"账号"},{type:Kt.account,icon:"IcUser",name:"账号设置"},{type:Kt.general,icon:"IcGeneralSetting",name:"通用设置"},{type:Kt.integral,icon:"IcGift",name:"活动中心",hidden:!1,badge:d||u?r.jsx("span",{className:"flex items-center absolute right-2.5 top-[calc(50%-5px)] text-t4-bold w-2.5 h-2.5 bg-red rounded-full"}):void 0},{type:Kt.profit,icon:"IcCoin",name:"邀请返佣",hidden:!1,badge:f?r.jsx(_l,{text:"💰赚佣金",absolute:!1,className:"!rounded pointer-events-none"}):void 0},{name:"空间",type:Kt.line}];return i&&_.push({icon:"IcSpace",type:Kt.spaceInfo,name:"空间信息"}),_.push({icon:"IcSettings",type:Kt.space,name:"空间设置"}),c||(_.push({icon:"IcMember",type:Kt.members,name:"成员"}),_.push({icon:"IcGlobeShare",type:Kt.sharePage,name:"公开分享"}),_.push({badge:void 0,icon:"IcUpgrade",type:Kt.upgrade,name:"升级"}),i&&_.push({hidden:!1,badge:void 0,icon:"IcShoppingCart",type:Kt.order,name:"订单"})),_},[i,u,d,c,f]);return r.jsxs("div",{className:"flex flex-col shrink-0 px-2 pt-3 w-[20%] min-w-[200px] text-grey3 border-r border-black_006 text-t2 overflow-y-auto",children:[r.jsxs("div",{className:"flex-1",children:[g.map((_,x)=>_.hidden?null:_.type===Kt.line?r.jsx("span",{className:"flex items-center px-2 h-9 text-t2",children:_.name},x):r.jsx(jP,{dataTestId:_.name,activeStyle:"bg",active:_.type===n,text:_.name,onClick:()=>p(_.type),addonBefore:r.jsx(V,{name:_.icon,size:"middle"}),badge:_.badge},x)),r.jsx(dt.SettingDivider,{className:"my-2.5","list-item-inactive":""}),r.jsx(jP,{staticStyle:!0,text:"退出登录",onClick:()=>{e.loading({title:"正在退出",keyboard:!1}),me.logout(),t(),l()},addonBefore:r.jsx(V,{name:"IcLogOut",size:"middle"})})]}),r.jsxs("div",{className:"px-2 text-grey4 text-t3 space-y-2 pb-5",children:[r.jsxs("div",{className:"flex flex-col space-y-2",children:[r.jsx("a",{className:"underline underline-offset-4",target:"_blank",href:ds.userAgreement,rel:"noreferrer",children:"用户协议"}),r.jsx("a",{className:"underline underline-offset-4",target:"_blank",href:ds.privacyPolicy,rel:"noreferrer",children:"隐私条款"})]}),r.jsx(PNe,{}),r.jsx(RNe,{})]})]})}),RNe=y.memo(()=>{const e=rI(),t=async()=>{await e()};return r.jsx(Fe,{arrow:!0,popup:"用久了有点卡顿？点我试试",className:"text-active_color animate-click",onClick:t,children:"清理缓存重启"})}),PNe=y.memo(()=>{const e=m4();return r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:["版本：","1.126.0-2024/12/10 20:49:13"]}),e&&r.jsx(r.Fragment,{children:r.jsxs("div",{children:["PC版本：",e]})})]})}),Zn=({title:e,description:t,showSpacePlan:n,from:s,rightPart:a,showSplitLine:o=!0,className:i,titleClassName:l,upgradeTip:c,showUpgradeDialog:d})=>{const u=po(),{setCurrentSettingMenu:f,setIsFrom:h}=an(Ws),p=Dt(),g=df(),_=d!=null?d:u;return r.jsxs("div",{className:R("mt-2.5",i),children:[o&&r.jsx(dt.SettingDivider,{}),e&&r.jsxs("div",{className:"flex items-center justify-between py-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:R("text-t2 text-black",l),children:e}),n&&_&&r.jsx("div",{onClick:()=>{s&&h(s),g(()=>{f(Kt.upgrade)},{title:c})},className:"bg-grey6 text-t4 text-grey3 animate-hover ml-2 rounded-sm px-1.5 py-0.5",children:Zo(p.planType)})]}),a]}),t&&r.jsx("div",{className:"text-t3 text-grey3",children:t})]})},Lq=qe(),Bq=qe(),Ov=qe(),SP=e=>!!(e!==void 0&&[m.BlockType.PAGE,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW].includes(e)),LNe=()=>{var C;const e=y.useRef(null),t=j5(),n=_I(),s=ie(),a=Ut(),o=Y3(),i=Nd(),l=Pm(),c=()=>{const k=uY(Object.values(l0.getState()).filter(v=>!Uw(Td[v.spaceId])),["createBy"],["desc"]),T=k.filter(v=>v.setting.clipperPage);return T.length>0?An(T):ll(k)},[d,u]=y.useState(()=>{var k;return a.clipperLocation?a.clipperLocation:(k=c())==null?void 0:k.setting.clipperPage}),f=ye(d,["data"],["segments"]),[h,p]=y.useState((f==null?void 0:f.spaceId)||((C=c())==null?void 0:C.spaceId)||Ot()),g=o.find(k=>k.uuid===h),_=Ab(h),x=_g(),F=k=>{u(k),n(async()=>{x(_,{setting:{clipperPage:k}}),await l({clipperLocation:k}),await i(),be.success("保存成功")})},b=async k=>{var I,j,S;p(k);const T=Ab(k),v=(I=K9(T))==null?void 0:I.setting.clipperPage;u(v),v&&v!==a.clipperLocation?(await l({clipperLocation:v}),be.success("保存成功")):v||(await es(200),(S=(j=e==null?void 0:e.current)==null?void 0:j.click)==null||S.call(j))},w=k=>{s.dropdown({modalId:Lq,popcorn:k.currentTarget,placement:"bottom-end",offset:[0,8],content:()=>r.jsx(MNe,{onItemClick:b})})},E=k=>{h&&s.dropdown({modalId:Bq,popcorn:k.currentTarget,placement:"bottom-end",offset:[0,8],content:()=>r.jsx(BNe,{spaceId:h,onItemClick:T=>{F(T)}})})};return y.useEffect(()=>{!d||J.blocks[d]||t(d)},[t,d]),y.useEffect(()=>{f!=null&&f.spaceId&&p(f.spaceId)},[f==null?void 0:f.spaceId]),r.jsxs(r.Fragment,{children:[r.jsx(dt.Item,{leftChild:"设置剪藏保存位置"}),r.jsx(dt.Item,{leftChild:"选择空间",rightChild:r.jsx(dt.DropdownButton,{onClick:w,content:g?r.jsxs("div",{className:"flex items-center",children:[r.jsx(Fn,{iconSize:18,blockId:g.uuid,trigger:!1}),r.jsx("span",{className:"ml-2",children:g.title})]}):r.jsx("div",{className:"text-grey3",children:"请选择"})})}),r.jsx(dt.Item,{leftChild:"添加到",rightChild:r.jsx(dt.DropdownButton,{onClick:E,disabled:!g,content:r.jsx("div",{ref:e,children:g?f?r.jsxs("div",{className:"flex items-center",children:[r.jsx(Fn,{iconSize:18,blockId:f.uuid,trigger:!1}),r.jsx("span",{className:"ml-2",children:fe(f==null?void 0:f.data.segments)||qt(f.type)})]}):r.jsx("div",{className:"text-grey3",children:"新建我的剪藏"}):r.jsx("div",{className:"text-grey3",children:"请先选择空间"})})})}),r.jsx(UNe,{})]})},BNe=e=>{const t=ie(),{onItemClick:n,spaceId:s}=e,[a,o]=y.useState([]),i=c=>{var f;const{role:d}=mn(c),u=J.blocks[c];if(u){if(!SP(u==null?void 0:u.type)){be.error("只能选择页面或收藏多维表");return}if(!Xn(d,m.PermissionRole.WRITER)){be.error("对该页面无可编辑权限");return}(f=u.data.format)!=null&&f.isCutStoreContainer||_e(c,{data:{format:{isCutStoreContainer:!0}}}),n(c),t.closeModal(Bq)}},l=()=>{t.modal({modalId:Ov,content:()=>r.jsx(ONe,{spaceId:s,onSelect:i})})};return y.useEffect(()=>{ve.editor.querySpaceVisitsHistory(s,0).then(c=>{var d,u;if((d=c==null?void 0:c.recordMap)!=null&&d.blocks){re(Tn.update({blocks:c.recordMap.blocks}));const f=[];(u=c.results)==null||u.forEach(({uuid:h})=>{var g,_;const p=(_=(g=c.recordMap)==null?void 0:g.blocks)==null?void 0:_["".concat(h)];p&&p.status===m.BlockStatus.NORMAL&&f.push(fg(p))}),o((f!=null?f:[]).filter(h=>SP(h==null?void 0:h.type)))}})},[s]),r.jsx(jN,{className:"next-modal py-2.5 relative",searchType:"page",defaultValue:a,onSelect:({uuid:c})=>i(c),placeholder:"搜索页面",spaceId:s,footer:r.jsxs("div",{className:"absolute bottom-0 w-full flex items-center h-10 px-4 bg-white2 border-t border-grey6 text-t2 text-grey3 cursor-pointer rounded-tl-none rounded-tr-none",onClick:l,children:[r.jsx(V,{size:"middle",name:"IcAdd",className:"mr-2"}),"新建收藏列表"]})})},ONe=e=>{const t=ie(),n=jd(),s=jq(),a=Oe(),[o,i]=y.useState("我的剪藏"),{spaceId:l,onSelect:c}=e,d=()=>{a(()=>{const u=n(m.BlockType.PAGE,{parentId:l,last:!0},Ss.PRIVATE);if(!u){be.error("没有权限，创建失败");return}const f=zw(!0);_e(u,{data:{icon:{type:"emoji",value:f},segments:ht(o),format:{isCutStoreContainer:!0}}}),s(u,m.CollectionViewType.GALLERY),c(u)}),t.closeModal(Ov)};return r.jsxs("div",{className:"next-modal p-2.5 w-80",children:[r.jsx(Ct,{autoFocus:!0,value:o,onChange:i,className:"h-8 my-3 mx-1",placeholder:"请输入页面名"}),r.jsxs("div",{className:"flex pt-1 justify-end",children:[r.jsx(De,{colorType:"secondary",onClick:()=>t.closeModal(Ov),children:"取消"}),r.jsx(De,{className:"ml-2.5",colorType:"active",onClick:d,children:"创建"})]})]})},MNe=e=>{const{onItemClick:t}=e,n=ln(),[s,a]=y.useState(""),o=Y3(),i=y.useMemo(()=>o.map(c=>({type:H.SEARCH,data:{...c,type:"SPACE",title:c.title,icon:c.icon,backgroundColor:c.backgroundColor}})),[o]),l=c=>{if(Uw(c)){be.error("对该空间无可编辑权限");return}t(c.uuid),n(Lq)};return r.jsx(ze,{items:i,className:"w-64 next-modal",scrollClassName:"overflow-y-auto max-h-64 pb-2",onItemClick:c=>{l(c.data)},customHeader:r.jsx(Ct,{className:"h-8 m-2.5",placeholder:"搜索空间",autoFocus:!0,value:s,onChange:a})})},UNe=()=>r.jsx(Zn,{title:"使用微信剪藏",description:"通过微信剪藏助手，发送信息到FlowUs",rightPart:r.jsx(ul,{link:ds.weChatClipper,linkContainer:!0,className:"text-active_color border-b border-active_color",iconClassName:"hidden",children:"如何使用剪藏？"})}),VNe=()=>{const e=Ut(),t=Pm();return e?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2",children:"通知偏好"}),r.jsx(Zn,{showSplitLine:!1,title:"协作通知",description:"开启后，可以收到空间成员的实时协作通知",rightPart:r.jsx(en,{open:!e.setting.closeCollaborativeNotification,onSwitch:n=>{t({setting:{closeCollaborativeNotification:!n}})}})}),r.jsx(Zn,{showSplitLine:!1,title:"分享通知",description:"开启后，可以收到分享页面的实时动态推送",rightPart:r.jsx(en,{open:!e.setting.closeShareNotification,onSwitch:n=>{t({setting:{closeShareNotification:!n}})}})}),r.jsx(Zn,{showSplitLine:!1,title:"订阅通知",description:"开启后，可以收到个人订阅页面的动态推送",rightPart:r.jsx(en,{open:!e.setting.closeSubscribeNotification,onSwitch:n=>{t({setting:{closeSubscribeNotification:!n}},!0)}})}),r.jsx(Zn,{showSplitLine:!1,title:"收件箱通知",description:"开启后，可以收到端内重要功能更新提醒与限时优惠活动推送通知",rightPart:r.jsx(en,{open:!e.setting.closeInboxNotification,onSwitch:n=>{t({setting:{closeInboxNotification:!n}})}})})]}):null},$Ne={default:"默认字体",lxgwWenKai:"霞鹜文楷",sourceHanSerif:"思源宋体",loraVariable:"Lora",dmMono:"DM Mono"},HNe={default:"默认布局",compact:"紧密布局",loose:"宽松布局"},zNe=()=>{var _,x;Pa();const e=ya(),t=ie(),n=Id(),s=_g(),a=po(),o=Dt(),i=df(),l=a?"default":(_=n==null?void 0:n.setting.fontFormat)!=null?_:"default",c=a?"default":(x=n==null?void 0:n.setting.pageLayout)!=null?x:"default",d=Oe(),u=F=>{if(a&&["lxgwWenKai","sourceHanSerif","loraVariable","dmMono"].includes(F)){i(()=>{e(Mt.custom_font_layout)});return}d(()=>{n&&s(n.uuid,{setting:{fontFormat:F}})})},f=F=>{if(a&&(F==="compact"||F==="loose")){i(()=>{e(Mt.custom_font_layout)});return}d(()=>{n&&s(n.uuid,{setting:{pageLayout:F}})})},h=F=>{t.dropdown({popcorn:F.currentTarget,content:({onCloseModal:b})=>r.jsx(ze,{className:"next-modal w-36 py-2.5",items:xT.map((w,E)=>({type:H.OPERATION,data:{title:w.title,value:w.value,selected:l===w.value,rightText:a&&E!==0?r.jsx(_l,{absolute:!1}):"",className:E===1?"font-[".concat($c.lxgwWenKai,"]"):E===2?"font-[".concat($c.sourceHanSerif,"]"):""}})),onItemClick:(w,E)=>{const C=xT[E];C&&u(C.value),b()}})})},p=F=>{t.dropdown({popcorn:F.currentTarget,content:({onCloseModal:b})=>r.jsx(ze,{className:"next-modal w-36 py-2.5",items:sA.map((w,E)=>({type:H.OPERATION,data:{title:w.title,value:w.value,selected:c===w.value,rightText:a&&E!==1?r.jsx(_l,{absolute:!1}):""}})),onItemClick:(w,E)=>{const C=sA[E];C&&f(C.value),b()}})})};let g="";return Rw(o.planType)||(g="专业版"),r.jsxs(r.Fragment,{children:[r.jsx(dt.SettingDivider,{}),r.jsxs("div",{className:"flex items-center mt-5",children:[r.jsx("div",{className:"text-t2 ",children:"新建页面字体及布局设置"}),g&&r.jsx("div",{className:"px-1.5 py-0.5 text-center ml-2 rounded text-t2 text-grey2 bg-grey/20",children:g})]}),r.jsx("div",{className:"text-t3 mt-1 text-grey3",children:"新建文档/多维表页面会默认为指定样式，仅在当前空间账号下生效"}),r.jsx(Zn,{showSplitLine:!1,title:"字体样式",rightPart:r.jsx(dt.DropdownButton,{onClick:h,content:$Ne[l!=null?l:"default"]})}),r.jsx(Zn,{className:"mt-0",showSplitLine:!1,title:"布局样式",rightPart:r.jsx(dt.DropdownButton,{onClick:p,content:HNe[c!=null?c:"default"]})})]})},qNe=()=>{var i,l;const e=ie(),t=Ut(),n=hS(),s=(l=(i=t.setting)==null?void 0:i.pageWidthMode)!=null?l:Mb.FIXED,a=nA.find(c=>c.value===s),o=c=>{e.dropdown({popcorn:c.currentTarget,content:({onCloseModal:d})=>r.jsx(ze,{className:"next-modal w-36 py-2.5",items:nA.map(u=>({type:H.OPERATION,data:{title:u.title,value:u.value,selected:s===u.value}})),onItemClick:u=>{n({pageWidthMode:u.data.value}),d()}})})};return r.jsx(Zn,{title:"新建页面宽度",description:"新建文档页面会默认为指定方式",rightPart:r.jsx(dt.DropdownButton,{onClick:o,content:a==null?void 0:a.title})})},GNe=()=>{var h,p,g,_,x,F,b;const e=Nd(),t=Za(),n=ie(),s=i9(),a=Ut(),o=hS(),i=eA.find(w=>w.value===s);xoe(),tle();const l=(p=(h=a.setting)==null?void 0:h.openPageMode)!=null?p:tE.JUMP,c=tA.find(w=>w.value===l),d=w=>{n.dropdown({popcorn:w.currentTarget,content:({onCloseModal:E})=>r.jsx(ze,{className:"next-modal w-36 py-2.5",items:eA.map((C,k)=>({type:H.OPERATION,data:{title:C.title,value:C.value,selected:(i==null?void 0:i.value)===C.value,tip:k===0?void 0:"".concat(Ds,"+Shift+L")}})),onItemClick:C=>{ts(OB,C.data.value),st({$theme:C.data.value}),E()}})})},u=w=>{n.dropdown({popcorn:w.currentTarget,content:({onCloseModal:E})=>r.jsx(ze,{className:"next-modal w-36 py-2.5",items:tA.map((C,k)=>({type:H.OPERATION,data:{title:C.title,value:C.value,selected:l===C.value,tip:k===0?void 0:[q1?"Alt":"Option","+点击"].join("")}})),onItemClick:C=>{o({openPageMode:C.data.value}),E()}})})},f=async()=>{const w="exportLocalData";be.exists(w)||(be.loading({key:w,content:"正在导出数据"}),await _te(),await xte(),be.success("已导出数据"),be.closeMessage(w))};return y.useEffect(()=>{e()},[e]),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:dt.commonStyles.container,children:[r.jsx(dt.Header,{title:"通用设置"}),r.jsx(dt.Item,{leftChild:"主题",rightChild:r.jsx(r.Fragment,{children:r.jsx(dt.DropdownButton,{onClick:d,content:i==null?void 0:i.title})})}),!1,r.jsx(dt.SettingDivider,{className:"mb-2.5"}),r.jsx(VNe,{}),r.jsxs(r.Fragment,{children:[r.jsx(dt.SettingDivider,{className:"mb-2.5"}),r.jsx(LNe,{})]}),r.jsx(Zn,{title:"默认页面打开方式",description:"单击页面默认会以指定的方式打开",rightPart:r.jsx(dt.DropdownButton,{onClick:u,content:c==null?void 0:c.title})}),r.jsx(Zn,{title:"使用右侧栏显示新建页面",description:"开启后，新建页面会显示在右侧栏中",rightPart:r.jsx(en,{open:!!((g=a.setting)!=null&&g.useRightPageByNew),onSwitch:w=>{o({useRightPageByNew:w})}})}),r.jsx(qNe,{}),r.jsx(Zn,{title:"新建页面目录",description:"新建文档页面的目录开启状态",rightPart:r.jsx(en,{open:!!((_=a.setting)!=null&&_.directoryMenu),onSwitch:w=>{o({directoryMenu:w})}})}),r.jsx(zNe,{}),r.jsx(Zn,{title:"内容预览浮窗",description:"对页面/文件及引用内容支持浮窗预览",rightPart:r.jsx(en,{open:((x=a.setting)==null?void 0:x.previewDialog)===void 0||((F=a.setting)==null?void 0:F.previewDialog),onSwitch:async w=>{o({previewDialog:w})}})}),r.jsx(Zn,{title:"高性能模式",description:"开启后，部分内容量大的页面将以高性能模式运行，但会无法使用一些功能，例如浏览器自带的搜索功能",rightPart:r.jsx(en,{open:!!((b=a.setting)!=null&&b.enableHighPerformance),onSwitch:w=>{o({enableHighPerformance:w})}})}),r.jsx(Zn,{title:"导出本地错误日志",description:"出现错误警告时，导出数据信息以便与开发者协助排查问题",rightPart:r.jsx(De,{onClick:f,children:"导出"})})]}),r.jsx(dt.FooterBar,{cancel:()=>t(),cancelText:"关闭"})]})},WNe=()=>{const e=WE(),t=KB();if(t.length===0)return null;const n=o=>{o.uuid&&(me.event("online_activity_click",{activity_id:o.uuid}),F0(o.link),e(o.uuid,{onlyViewed:!0}))},s=o=>{o.link&&Xt(o.link,{message:"已复制链接"})},a=(o,i="")=>r.jsx("span",{className:R("absolute -top-px -left-px text-t4 bg-black-base text-white px-2.5 py-0.5 flex items-center justify-center rounded-tl rounded-br",i),children:o});return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex mt-2.5 items-center text-t2 h-9 top-0",children:"线上活动"}),t.map(o=>{var u,f;const i=o.status==="abandoned",l=o.status==="completed",c=!o.viewed&&!i;let d=r.jsx(r.Fragment,{});return i?d=a("已下线"):c?d=a("NEW","top-0 left-0"):l&&(d=a("已完成")),r.jsx("div",{className:R("flex h-[110px] mb-2.5 items-center w-full cursor-pointer p-1.5"),onClick:()=>n(o),children:r.jsxs("div",{className:R("flex items-center border w-full rounded relative p-1.5",{"border-active_color/20 bg-active_color/10":c,"border-black/10":["completed","abandoned"].includes("".concat(o.status))}),children:[r.jsx("div",{className:"h-[98px] mr-4 bg-grey6 w-[160px] bg-cover bg-center",style:{backgroundImage:"url(".concat((f=(u=o.resourceList)==null?void 0:u[0])==null?void 0:f.imgUrl,")")},children:d}),r.jsxs("div",{className:"flex items-center justify-between w-[calc(100%-160px-22px)]",children:[r.jsxs("div",{className:R("overflow-hidden flex flex-col w-full",i&&"opacity-60"),children:[r.jsx("div",{className:"text-t2-medium text-ellipsis mb-1.5",children:o.name}),r.jsx("div",{className:"text-t2 text-grey3 text-ellipsis mb-2",children:o.synopsis}),r.jsxs("div",{className:"text-t4 text-grey3 mt-auto flex items-center",children:[r.jsx(V,{name:"IcTitleTime",size:"middle",className:"mr-0.5"}),o.type==="standing"?"长期活动":r.jsxs(r.Fragment,{children:[o.startTime&&ue(o.startTime).format("MM月DD日"),o.endTime&&" - ".concat(ue(o.endTime).format("MM月DD日"))]})]})]}),r.jsx(Ys,{className:"self-start",size:20,children:o.link&&!i&&r.jsx(V,{name:"IcFormShare",size:"middle",className:R("cursor-pointer",c?"text-active_color":"text-grey3"),onClick:h=>{h.stopPropagation(),s(o)}})})]})]})},o.uuid)})]})},Oq=()=>gm({getApi:ve.infra.totalDistributionAllianceVipInWallet,enable:!0}),KNe=()=>{const e=y.useRef(null),[t,n]=y.useState({total:0,list:[]});y.useEffect(()=>{s(1)},[]);const s=async a=>{const o=await ve.infra.creditIncomes(a,20);n(i=>({total:o.total,list:a===1?o.list:[...i.list,...o.list]}))};return r.jsx("div",{ref:e,className:"flex flex-col overflow-y-auto flex-1 min-w-[500px] h-[600px]",children:r.jsxs(xd,{className:"flex flex-col px-5",pageStart:1,initialLoad:!1,useWindow:!1,loadMore:s,getScrollParent:()=>e.current,hasMore:t.total>t.list.length,children:[r.jsx("div",{className:"flex mt-2.5 items-center text-t2 h-9",children:"积分记录"}),t.list.map(a=>r.jsxs("div",{className:"flex w-full justify-between items-center",children:[r.jsxs("div",{className:"flex flex-col justify-center h-14",children:[r.jsx("div",{className:"text-t2",children:a.title}),a.createdAt&&r.jsx("div",{className:"text-grey3 text-t4",children:K_e(a.createdAt)})]}),r.jsxs("div",{className:"text-t2 flex flex-col items-end",children:[r.jsx("span",{children:a.score?a.score<0?a.score:"+".concat(a.score):""}),a.score===0&&r.jsx("span",{className:"text-t4 text-grey3",children:"积分达到上限"})]})]},a.id)),!t.list.length&&r.jsx("div",{className:"text-t2 text-grey4 mt-2",children:"暂无记录，快去邀请好友吧～"})]})})},YNe=()=>{const e=ie();return y.useCallback(()=>{e.modal({content:KNe})},[e])},XNe="商品名称",QNe="商品图片",JNe="积分数量",ZNe="是否上架",eje="关联商品类型ID",tje="3795336f-c9d4-4396-b3b4-e7fa5be57a5f",nje=async()=>pye(tje,{filter:(e,t,n)=>l_(e,n,ZNe).toUpperCase()==="YES",convertToTargets:(e,t,n)=>e.map(s=>({recordId:s.uuid,waresId:l_(s,n,eje),name:l_(s,n,XNe),ossName:l_(s,n,QNe),score:l_(s,n,JNe)}))}),Mq=e=>{const[t,n]=y.useState(!0),[s,a]=y.useState();return y.useEffect(()=>{s||mo(async()=>{const o=await Vs.fetchImageUrl({blockId:e.blockId,ossName:e.ossName});o&&a(o),n(!1)},"oss")},[e.blockId,e.ossName,s]),r.jsxs("div",{className:R("flex justify-center items-center w-full h-[100px]",e.className),onClick:e.onClick,children:[t&&r.jsx($s,{className:"w-10 h-10"}),!t&&r.jsx("img",{className:"rounded-t-md object-contain w-full h-full",src:s})]})},Uq=()=>{const e=ie();return y.useCallback(async(t,n)=>{const s=await ve.infra.integralExchange({itemId:t});return s&&(RO(),e.warning({confirm:n,content:r.jsx("div",{className:"text-h4",children:"兑换成功"}),colorType:"active",noCancel:!0})),s},[e])},sje=()=>{const e=ie(),t=Pw(),[n]=gm({getApi:()=>ve.infra.exchangeRecordList(1,10,t)});return r.jsxs("div",{className:"w-[600px] h-[400px] overflow-hidden",children:[r.jsxs("div",{className:"px-7 flex items-center justify-between",children:[r.jsx("div",{className:"flex items-center h-[50px]",children:r.jsx("span",{className:"text-t2-medium",children:"兑换记录"})}),r.jsx("div",{className:"flex items-center",children:r.jsx(V,{className:"cursor-pointer ml-5",size:"middle",name:"IcClose",onClick:()=>{vn.defaultWare,e.closeModal(Ve.WARE_RECORD)}})})]}),r.jsx("div",{className:"h-px bg-grey6 w-[full]"}),r.jsx("div",{className:"px-7 h-[calc(100%-50px)] overflow-auto py-5 space-y-5",children:n==null?void 0:n.list.map((s,a)=>r.jsxs("div",{className:"relative rounded border border-grey7 p-4 flex items-center",children:[r.jsx("img",{src:vn.defaultWare,className:"rounded w-20 h-20 object-cover"}),r.jsxs("div",{className:"ml-5 space-y-0.5",children:[r.jsx("div",{className:"text-t1-medium",children:s.itemName}),r.jsx("div",{className:"text-t4 text-grey4",children:"订单编号: ".concat(s.id)}),s.createdAt&&r.jsx("div",{className:"text-t4 text-grey4",children:"订单日期: ".concat(ue(s.createdAt).format("YYYY-MM-DD"))}),r.jsx("div",{className:"text-t4 text-grey4",children:"实付: ".concat(s.total)})]}),r.jsx("div",{className:"absolute right-4 top-4 text-active_color",children:s.status===1?"兑换成功":"兑换失败"})]},a))})]})},rje=e=>{const t=ie(),{integralInfo:n}=Xw(),s=Uq(),[a]=gm({getApi:nje,defaultValue:[]});return r.jsxs("div",{className:"h-full overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between border-b",children:[r.jsxs("div",{className:"flex items-center py-2.5 space-x-1",children:[r.jsx("span",{className:"text-t1-medium",children:"积分兑换商城（当前积分:".concat(n==null?void 0:n.currentScore,"）")}),r.jsxs(Cs,{popup:"兑换后到我的卡券,或者升级付费时选取对应的优惠券",children:[r.jsx(V,{className:"text-grey4",size:"middle",name:"IcInviteHelp"}),r.jsx("span",{className:"text-t3 text-grey4",children:"兑换方式"})]})]}),r.jsxs("div",{className:"flex items-center space-x-1 text-t2",children:[r.jsx("span",{className:"animate-click text-active_color",onClick:()=>{t.modal({modalId:Ve.WARE_RECORD,content:()=>r.jsx(sje,{})})},children:"兑换记录"}),r.jsx(V,{className:"animate-click",size:"middle",name:"IcToastClose",onClick:()=>{t.closeModal(Ve.SCORE_SHOP)}})]})]}),r.jsx("div",{className:"grid gap-5 grid-cols-3 items-start justify-center overflow-auto h-full pt-5 pb-20",children:a==null?void 0:a.map((o,i)=>r.jsxs("div",{className:"animate-hover border border-grey7 rounded-md",onClick:()=>{e.onSelectWares(o)},children:[r.jsx(Mq,{blockId:o.recordId,ossName:o.ossName,className:"h-[200px]"}),r.jsxs("div",{className:"py-2.5",children:[r.jsx(Cs,{popup:o.name,children:r.jsx("div",{className:"w-full text-ellipsis mt-2.5 text-t3-medium px-2.5",children:o.name})}),r.jsxs("div",{className:"mt-2 flex items-center justify-between px-2.5",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-t1-medium",children:o.score}),r.jsx("span",{className:"text-t4",children:"积分"})]}),r.jsx(De,{className:"h-6",colorType:"active",onClick:l=>{l.stopPropagation(),s(o.waresId)},children:"兑换"})]})]})]},i))})]})},aje=e=>{const t=Ja(),n=y.useRef(null),s=Uq();return y.useEffect(()=>{t(e.wares.recordId)},[t,e.wares.recordId]),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"px-6 flex items-center justify-between",children:[r.jsx("div",{className:"flex items-center py-2.5",children:r.jsx("span",{className:"text-t1-medium",children:e.wares.name})}),r.jsx(V,{className:"animate-click",size:"middle",name:"IcToastClose",onClick:()=>{e.onClose()}})]}),r.jsx("div",{className:"h-px bg-grey6 w-full"}),r.jsxs("div",{className:"h-full overflow-auto",children:[r.jsx("div",{className:"w-full flex justify-center",children:r.jsx(Mq,{className:"mt-2.5 w-[540px] h-[240px]",blockId:e.wares.recordId,ossName:e.wares.ossName})}),r.jsx("div",{className:"px-7 my-5 max-h-[150px] flex-1 text-t2",ref:n,children:r.jsx(Mo.Provider,{value:wt.UPDATE_LOG,children:r.jsx(Ec.Provider,{value:n,children:r.jsx(mS,{uuid:e.wares.recordId,readonly:!0})})})})]}),r.jsxs("div",{className:"px-6 py-4 border-t flex items-center justify-between",children:[r.jsx("div",{className:"text-h3",children:"".concat(e.wares.score,"积分")}),r.jsx(De,{colorType:"active",className:"h-10 w-[210px]",onClick:async()=>{s(e.wares.waresId,e.onClose)},children:"立即兑换"})]})]})},oje=()=>{const e=ie();return r.jsx("div",{className:"w-4xl h-[70vh] px-6",children:r.jsx(rje,{onSelectWares:t=>{e.modal({content:({onCloseModal:n})=>r.jsx(aje,{wares:t,onClose:n})})}})})},ije=()=>{const{setCurrentSettingMenu:e}=Jw(),{integralInfo:t}=Xw(),n=ie(),s=dN(),a=h9(),o=YNe(),[i]=Oq(),l=()=>{e(Kt.profit)},c=()=>{n.modal({modalId:Ve.SCORE_SHOP,content:()=>r.jsx(oje,{})})},d=[{hidden:!1,className:"bg-yellow/10 border-yellow/20",title:r.jsxs(r.Fragment,{children:[r.jsx("span",{children:"我的积分"}),r.jsx("span",{className:"text-t1-medium mx-1",children:t==null?void 0:t.currentScore}),!!(t!=null&&t.todayScore)&&r.jsxs("span",{className:"text-t4-bold text-white1 bg-yellow px-1 py-px rounded-sm",children:["今日 +",t.todayScore]})]}),descClass:"text-yellow",emoji:"💎",desc:r.jsxs("div",{className:"space-x-2",children:[r.jsx("span",{children:"去兑换"}),r.jsx("span",{className:"text-t4-medium text-grey3",onClick:u=>{u.stopPropagation(),o()},children:"积分历史"})]}),onClick:c},{className:"bg-green/10 border-green/20",title:"我的卡券",emoji:"🎫",point:a,descClass:"text-green",desc:"去查看",onClick:s},{className:"bg-blue/10 border-blue/20",hidden:!1,title:r.jsxs("div",{className:"space-x-1",children:[r.jsx("span",{children:"我的收益"}),r.jsxs("span",{children:[(i==null?void 0:i.totalAmount)||0,"元"]})]}),emoji:"💰",desc:"去提现",descClass:"text-blue",onClick:l}];return r.jsx("div",{className:"grid grid-cols-3 gap-x-2 mt-1",children:d.map(u=>r.jsxs("div",{className:R("border rounded flex-1 py-4 px-3 flex justify-between animate-click",u.className),onClick:u.onClick,hidden:u.hidden,children:[r.jsxs("div",{children:[r.jsxs("div",{className:"text-t1-medium flex items-center space-x-1.5",children:[r.jsx(Ys,{size:24,className:"self-start",children:r.jsx(na,{emojiStr:u.emoji,iconSize:20,disableHover:!0})}),r.jsx("div",{children:u.title}),r.jsx("span",{hidden:!u.point,className:"w-2.5 h-2.5 bg-red rounded-full"})]}),r.jsx("div",{className:R("text-t2-medium mt-1.5 ml-7",u.descClass),children:u.desc})]}),r.jsx(Ys,{size:24,className:"text-grey3 text-t4 self-center",children:r.jsx(V,{size:"xxxsmall",name:"IcArrowUnfold",className:"ml-1"})})]},u.className))})},lje=({onCloseModal:e})=>{var d;const t=Js(),n=Jre(Je.GUIDE_FIRST_TIME_CREATED_SPACE),[s,a]=y.useState(0),[o,i]=y.useState(!1),l=(n==null?void 0:n.resourceList)||[];y.useEffect(()=>{s===l.length-1&&i(!0)},[s,l.length]);const c=()=>{e(),o&&t(Je.GUIDE_FIRST_TIME_CREATED_SPACE,ct.basicList,{completed:!0})};return r.jsxs("div",{className:"bg-grey9 pb-8 rounded-md",children:[r.jsxs("div",{className:"flex justify-between items-center h-20 px-7",children:[r.jsxs("a",{href:ds.integralRule,target:"_blank",rel:"noreferrer",className:"text-t2 text-grey3 flex items-center",children:[r.jsx(V,{name:"IcInviteInfo",className:"mr-1",size:"middle"}),"积分规则"]}),r.jsxs("span",{className:"text-h2",children:["观看完成可领积分 ",r.jsxs("span",{className:"text-active_color",children:["+",n==null?void 0:n.score]})]}),r.jsx("span",{className:"text-t2 cursor-pointer",onClick:()=>c(),children:"关闭"})]}),r.jsxs("div",{className:"px-20 relative",children:[r.jsx(V,{name:"MIcBtnPre",size:"auto",className:R("swiper-pre absolute top-1/2 z-10 w-16 h-16 animate-click left-11",s===0&&"opacity-30 pointer-events-none")}),r.jsx(V,{name:"MIcBtnNext",size:"auto",className:R("swiper-next absolute top-1/2 z-10 w-16 h-16 animate-click right-11",l.length-1===s&&"opacity-30 pointer-events-none")}),r.jsx(NL,{navigation:{nextEl:".swiper-next",prevEl:".swiper-pre"},mousewheel:!0,className:"max-h-[560px] h-[60vh] w-[896px] mb-2.5 rounded-xl border border-black_006",slidesPerView:"auto",keyboard:{enabled:!0,onlyInViewport:!0},modules:[fY,mY,hY],onActiveIndexChange:u=>a(u.realIndex),children:l.map(u=>r.jsx(jL,{className:"bg-no-repeat bg-contain bg-center",style:{backgroundImage:"url(".concat(u.imgUrl,")")}},u.content))}),r.jsx("div",{className:"mb-4 flex justify-center",children:l.map((u,f)=>r.jsx("span",{className:R("h-2 w-2 rounded-full mx-1",f===s?"bg-active_color":"bg-grey5")},f))})]}),r.jsx("div",{className:"px-20 text-xl min-h-[56px] flex items-center justify-center",children:(d=l[s])==null?void 0:d.content}),r.jsx(De,{disable:!o,onClick:()=>c(),colorType:"active",size:"large",className:"w-96 mt-6 mx-auto",children:"完成"})]})},cje=()=>{const e=ie(),t=ln();return y.useCallback(n=>{e.modal({modalId:Je.GUIDE_FIRST_TIME_CREATED_SPACE,className:"shadow-light",autoClose:!1,keyboard:!1,content:()=>r.jsx(lje,{onCloseModal:()=>{t(Je.GUIDE_FIRST_TIME_CREATED_SPACE),n==null||n()}})})},[t,e])},dje=()=>{const e=cje(),{basicList:t,advancedList:n}=Zre(),s=Za(),a=ie();if(t.length===0&&n.length===0||[...t,...n].every(l=>l.status==="completed"))return null;const o=l=>{if(l.uuid){if(me.event("online_activity_click",{activity_id:l.uuid}),l.uuid===Je.GUIDE_FIRST_TIME_CREATED_SPACE){e();return}F0(l.link)}},i=l=>{const c=l.status==="completed";return r.jsxs(Fe,{popup:l.link&&l.synopsis,followCursor:"horizontal",arrow:!0,plugins:[pY],className:"flex px-3 py-2 cursor-pointer group",onClick:()=>o(l),children:[r.jsx(V,{name:"IcBullrted",size:"large",className:"mr-1"}),r.jsxs("div",{className:"flex-1 text-t2",children:[l.name," ",r.jsxs("span",{className:"text-active_color text-t4",children:["⭐️+",l.score]})]}),r.jsx("div",{className:R("flex-shrink-0 ml-auto flex",!c&&"opacity-0 group-hover:opacity-100"),children:c?r.jsx(V,{name:c?"IcCircleCheck":"IcCircleCheckbox",size:"large",className:R(c&&"text-active_color")}):r.jsx("span",{className:"text-t3 text-active_color",onClick:d=>{d.stopPropagation(),d.preventDefault(),s(),l.uuid===Je.COPY_PAGE_FROM_TEMPLATE&&a.modal({modalId:Ve.TEMPLATE_CENTER,content:()=>r.jsx(fp,{onlyShowTab:"template",from:"quickSetting"})})},children:l.uuid===Je.MOBILE_SORT_BLOCK||l.uuid===Je.MOBILE_SHARE_LONG_PAGE_IMAGE?"去登录":"去完成"})})]})};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex my-2.5 items-center text-t2 h-9 top-0",children:["解锁功能赚积分",r.jsx("span",{className:"ml-2.5 flex items-center relative text-t3 py-px px-1.5 text-white bg-red rounded-sm after:content-[''] after:inline-block after:w-[7px] after:h-[7px] after:bg-red after:rotate-45 after:absolute after:-left-0.5",children:"新用户专享"})]}),r.jsxs("div",{className:"flex",children:[r.jsxs("div",{className:"w-full py-2.5 border border-black/10 rounded",children:[r.jsx("div",{className:"h-9 flex items-center px-3 text-t2 text-grey3",children:"基础入门"}),t.map(l=>r.jsx(y.Fragment,{children:i(l)},l.uuid))]}),r.jsx("div",{className:"w-4 flex-shrink-0"}),r.jsxs("div",{className:"w-full py-2.5 border border-black/10 rounded",children:[r.jsx("div",{className:"h-9 flex items-center px-3 text-t2 text-grey3",children:"进阶操作"}),n.map(l=>r.jsx(y.Fragment,{children:i(l)},l.uuid))]})]})]})},uje=()=>{const e=Za(),t=tN(),n=y.useRef(null);return y.useEffect(()=>{RO(),t(),me.event("activity_center_show")},[t]),r.jsxs(r.Fragment,{children:[r.jsx("div",{ref:n,className:dt.commonStyles.container,children:r.jsxs(xd,{pageStart:1,initialLoad:!1,useWindow:!1,loadMore:()=>{},getScrollParent:()=>n.current,hasMore:!1,children:[r.jsx(dt.Header,{title:"活动中心",addonAfter:r.jsxs("a",{hidden:!1,href:ds.integralRule,target:"_blank",rel:"noreferrer",className:"flex items-center",children:[r.jsx(V,{name:"IcInviteInfo",size:"middle",className:"mr-1"}),"积分规则"]})}),r.jsx(ije,{}),r.jsx(dje,{}),r.jsx(WNe,{})]})}),r.jsx(dt.FooterBar,{cancelText:"关闭",cancel:()=>e()})]})},fje=e=>[St.freeTeam,St.team,St.smallTeam].includes(e),R2=e=>{var i;const{items:t,renderItemContent:n,foldLength:s=50}=e,[a,o]=y.useState(!1);return t.length>s&&!a?r.jsxs(r.Fragment,{children:[gY(t,0,s).map(l=>n(l)),r.jsxs("div",{className:"text-grey4 text-t3 flex items-center h-9 cursor-pointer",onClick:()=>o(!0),children:[r.jsx(V,{name:"IcArrowShow",size:"middle",className:"mr-2"}),["查看其他",t.length-s,"位",(i=e.moreContent)!=null?i:"成员"].join(" ")]})]}):r.jsxs(r.Fragment,{children:[t.map(l=>n(l)),t.length>s&&a&&r.jsxs("div",{className:"text-grey4 text-t3 flex items-center h-9 cursor-pointer",onClick:()=>o(!1),children:[r.jsx(V,{name:"IcArrowShow",size:"middle",className:"mr-2 rotate-180"}),"收起"]})]})},Vq=e=>r.jsxs("div",{className:R("flex flex-row",e.className),onClick:e.onClick,children:[r.jsx(V,{name:"IcBtnEdit",size:"middle"}),r.jsx("div",{className:"ml-0.5 text-t3 text-grey3",children:"添加备注"})]}),mje=()=>{const e=ie(),t=Dt(),{guestMaxLimit:n,guestMaxLimitDesc:s}=_c(),a=Ut(),o=$w(),l=hg()(a.uuid).editor,c=t.planType===St.freeTeam||t.planType===St.freePersonal,d=fje(t.planType),u=Zo(t.planType),f=kd(),h=Ce(({users:I})=>f.map(j=>I[j.userId]).filter(Boolean),[f]),[p,g]=y.useState(""),_=y.useMemo(()=>lc(h,p),[h,p]),{setCurrentSettingMenu:x,checkoutUpgraded:F}=an(Ws),b=Dt(),w=ba(),E=Ur(),[C,k]=y.useState(),T=y.useRef(),v=(I,j)=>{const S=f.find(D=>D.userId===j);S&&e.dropdown({placement:"bottom",offset:[0,4],popcorn:I.currentTarget,content:({onCloseModal:D})=>r.jsx(ze,{className:"py-2 w-[270px] next-modal",onItemClick:({type:A,data:P})=>{A===H.SEARCH&&window.open("/".concat(P.uuid))},items:[d?{type:H.TEXT_DESCRIPTION,data:{title:r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{name:"MIcSettingsMembers",size:"middle"}),r.jsx("div",{className:"ml-2",children:"升级为空间成员"})]}),onClick:async()=>{if(!E&&Object.keys(w).length>=T0().membersMaxLimit){F(Mt.extMember);return}await ve.infra.addSpaceMember(t.uuid,{userId:j}),o(t.uuid),st({$guestsList:xt.$guestsList.filter(A=>A.userId!==j)}),be.success("已成功升级为空间成员"),D()}}}:null,d?{type:H.LINE}:null,{type:H.TEXT_DESCRIPTION,data:{title:r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{name:"IcMenuLogout",size:"middle",className:"text-red"}),r.jsx("div",{className:"ml-2 text-red",children:"移除"})]}),onClick:async()=>{await ve.infra.removeSpaceGuest(t.uuid,{userId:j}),st({$guestsList:xt.$guestsList.filter(A=>A.userId!==j)}),be.success("已成功移除"),D()}}},{type:H.LINE},...S.guestPageIds.map(A=>{const P=J.blocks[A];if(!P)return null;const L=sc(A);return{type:H.SEARCH,data:{uuid:P.uuid,title:fe(P.data.segments)||qt(P.type),icon:P.data.icon,navs:L,type:P.type,backgroundColor:P.backgroundColor}}})].filter(Boolean)})})};return r.jsxs("div",{className:"mt-3.5",children:[l&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"my-2 text-t4 text-grey3 space-x-2",children:[r.jsx("span",{children:"当前空间计划为".concat(u,"空间，总共可邀请").concat(s,"名外部协作者")}),r.jsx("span",{hidden:!c,className:"text-active_color animate-click",onClick:()=>{t.planType===St.freePersonal?x(Kt.upgrade):F(Mt.extMember)},children:"升级获取更多席位"})]}),r.jsx(dt.SettingDivider,{className:"my-2.5"})]}),_.length||p?r.jsxs("div",{className:"flex top-0 shrink-0 items-center justify-between mt-2.5 h-9 text-t2",children:[r.jsx("div",{children:"人员信息"}),r.jsx(Ct,{className:"pl-3 pr-1.5 w-full max-w-[300px] h-8 rounded-full",inputClassName:"px-0",value:p,onChange:g,placeholder:"搜索人员、手机号",addonBefore:r.jsx(V,{size:"middle",name:"IcSearch",className:"text-grey4"}),addonAfter:p&&r.jsx(V,{size:"middle",name:"IcUploadCancel",onClick:()=>g(""),className:"text-grey4 cursor-pointer"})})]}):r.jsxs("div",{children:[r.jsx("div",{className:"text-[70px] leading-[80px]",children:"☕️"}),r.jsx("div",{className:"my-4 text-t2",children:"当前空间未邀请外部协作者"}),r.jsxs("div",{className:"text-grey3",children:[r.jsx("div",{children:"如何邀请外部协作者？"}),r.jsxs("div",{className:"mt-1 space-y-1",children:[r.jsx("div",{children:"1. 进入需要协作的页面"}),r.jsx("div",{children:"2. 点击页面右上角「分享」"}),r.jsx("div",{children:"3. 在输入框内输入手机号并设置权限"}),r.jsx("div",{children:"4. 完成邀请"})]})]})]}),r.jsx(R2,{foldLength:50,items:_,renderItemContent:I=>{var O,$;const j=I.uuid===a.uuid||l,S=f.find(M=>M.userId===I.uuid),D=(O=b.userRemark)==null?void 0:O[I.uuid],A={...I};let P=I.nickname||"客";const L=!!I.nickname||!!D;return D&&(P="".concat(D," ").concat(I.nickname?"(".concat(I.nickname,")"):"")),r.jsxs("div",{className:"group flex shrink-0 items-center h-[58px]",children:[r.jsx(Fl,{forceNickname:P,user:A,className:"mr-2 w-[30px] h-[30px] !text-t1"}),r.jsx("div",{className:"flex flex-col grow",children:C===I.uuid?r.jsx(Ct,{autoFocus:!0,maxLength:20,className:"pl-3 pr-1.5 w-full max-w-[300px] h-8 rounded-sm",inputClassName:"px-0",defaultValue:D,onChange:M=>{T.current=M},placeholder:"请输入备注",onEnter:M=>{M.target instanceof HTMLElement&&M.target.blur()},onBlur:async()=>{const M=T.current;T.current=void 0,k(void 0),M!==void 0&&(await ve.infra.addSpaceUserRemark(b.uuid,{[I.uuid]:M}),re(kw({uuid:b.uuid,patch:[{userId:I.uuid,markName:M}]})))}}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"mb-0.5 text-t2",children:L?P:A.phone}),j&&r.jsx(Vq,{className:"ml-1 cursor-pointer transition-opacity group-hover:opacity-100 opacity-0",onClick:()=>{k(I.uuid)}})]}),L&&r.jsx("span",{className:"text-grey3 text-t4",children:Cm(I.phone||I.email)})]})}),r.jsxs("div",{className:R("self-center flex items-center text-t2",j&&"cursor-pointer"),onClick:M=>j&&v(M,A.uuid),children:["".concat(($=S==null?void 0:S.guestPageIds.length)!=null?$:0,"个协作页面"),j&&r.jsx(V,{name:"IcArrowDown01",className:"ml-1",size:"xxxsmall"})]})]},A.uuid)}})]})},hje=()=>{const{spaceShareInfo:e}=Qu(),t=Ut();return"".concat(_n()).concat(Nt.login,"?").concat(dn.inviteTeam,"=").concat(e==null?void 0:e.inviterId,"&").concat(dn.inviteCode,"=").concat(t.inviteCode)},pje=()=>{const{spaceShareInfo:e}=Qu(),{memberMaxLimitDesc:t,membersMaxLimit:n}=_c(),s=Za(),a=Ur(),o=ba(),i=$w(),l=Object.values(o),c=ie(),d=Dt(),u=Ut(),f=hg(),h=r5(),p=f(u.uuid).editor,g=ns(),_=Dt(),x=ya(),F=K0(),[b,w]=y.useState(""),{checkoutUpgraded:E}=an(Ws),[C,k]=y.useState(),T=y.useRef(),v=y.useMemo(()=>{const U=F({keywords:b});return U.sort((z,K)=>z.spaceRole&&K.spaceRole?eD[K.spaceRole]-eD[z.spaceRole]:0),U},[b,F]),I=hje(),j=U=>l.some(z=>z.spaceRole===m.PermissionRole.EDITOR&&z.uuid!==U);y.useEffect(()=>{SD()},[p]);const S=async()=>{c.warning({title:"确认重置吗？",content:"重置后，之前的邀请链接将失效",confirm:async()=>{const U=await ve.infra.resetSpaceInvitation(d.uuid);be.success("重置成功"),SD({inviterId:U.uuid,createdAt:U.createdAt,expirationAt:U.expirationAt})}})},D=async()=>{c.warning({title:"成员达到上限",content:["本空间为",Zo(d.planType),"人上限，如需增加空间成员，请升级空间"],confirm:async()=>{x(Mt.importMember)}})},A=()=>{Xt(I,{message:"none"}),be.success("复制成功，快去分享给同事吧")},P=U=>{const z=U===u.uuid;if(z&&p&&!j(U)){if(a){c.warning({title:"当前空间还未到期，并且你是本空间唯一的管理员，无法离开空间",confirmText:"知道了"});return}c.warning({title:"确定删除空间？",content:"你是本空间唯一的管理员，无法离开，只能删除空间",countTime:10,confirmText:"确认",confirm:async()=>{await h(d.uuid),s(),Rb()||g.push(Nt.main)}});return}c.warning({title:z?"确定离开吗？":"确定移出吗？",content:z?"离开后将不能再访问当前空间":"移出后该用户将不能再访问当前空间",confirmText:z?"确认离开":"确认移出",confirm:async()=>{await ve.infra.removeSpaceMembers(d.uuid,{userId:U}),z?(be.success("你已离开该空间"),await p0(!0),Rb()||g.push(Nt.main)):await i(d.uuid)}})},L=async(U,z)=>{if(U===u.uuid){be.error("不能修改自己的权限");return}await ve.infra.setSpaceMemberRole(d.uuid,{userId:U,role:z}),i(d.uuid),be.success("修改成功")},O=(U,z)=>{const K=z===u.uuid,W=l.find(Y=>Y.uuid===z);W&&c.dropdown({placement:"bottom",offset:[0,4],popcorn:U.currentTarget,content:({onCloseModal:Y})=>r.jsx(ze,{className:"py-2 w-[270px] next-modal",onItemClick:()=>Y(),items:p?[{type:H.TEXT_DESCRIPTION,data:{title:"管理员",description:"仅管理员可以设置空间和邀请新成员",selected:W.spaceRole===m.PermissionRole.EDITOR,onClick:()=>void L(z,m.PermissionRole.EDITOR)}},{type:H.TEXT_DESCRIPTION,data:{title:"成员",selected:W.spaceRole!==m.PermissionRole.EDITOR,onClick:()=>void L(z,m.PermissionRole.WRITER)}},{type:H.LINE},{type:H.TEXT_DESCRIPTION,data:{title:r.jsx("div",{className:"text-red",children:K?"离开团队":"移出团队"}),onClick:()=>P(z)}}]:[{type:H.TEXT_DESCRIPTION,data:{title:r.jsx("div",{className:"text-red",children:"离开团队"}),onClick:()=>P(z)}}]})})},$=U=>{c.dropdown({popcorn:U.currentTarget,placement:"left",content:({onCloseModal:z})=>r.jsx(k8,{isGuest:!1,onReceiveGuestList:async K=>{if(n&&l.length+K.length>n){D();return}const{userIds:W,markNames:Y}=await T8(K);await ve.infra.setSpaceMemberRoleBatch(_.uuid,W),Object.entries(Y).length>0&&(await ve.infra.addSpaceUserRemark(_.uuid,Y),await i(_.uuid),be.success("导入成功"),z())}})})},M=async()=>{const U=v.map(Y=>[Y.nickname,Y.email||Y.phone]),z=_Y.unparse(U),K=new Blob([z],{type:"text/csv;charset=utf-8;"}),W=URL.createObjectURL(K);await cc(W),be.success("完成")};return r.jsxs("div",{className:"mt-3.5",children:[p&&n&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("span",{children:["空间成员席位：",t]}),r.jsx(De,{onClick:()=>E(Mt.members),children:"购买更多成员席位"})]}),r.jsxs("div",{className:"flex items-center h-9 mt-2.5 justify-between",children:[r.jsx("div",{className:"text-black text-t2",children:"邀请空间成员"}),r.jsxs("div",{className:"flex items-center space-x-4 text-active_color text-t3",children:[r.jsx("div",{hidden:!1,className:"animate-click",onClick:$,children:"批量导入空间成员"}),r.jsx("div",{className:"animate-click",onClick:M,children:"导出空间成员"})]})]}),r.jsxs("div",{className:R("mt-2 mb-[18px] text-t4 text-grey3",!(e!=null&&e.expirationAt)&&"opacity-0"),children:[ue(e==null?void 0:e.expirationAt).format("YYYY年MM月DD日"),"前，任何通过此链接邀请的人都可以进入当前空间，到达空间人数上限后将无法加入"]}),r.jsx(Ct,{readonly:!0,inputClassName:"h-8 text-black pr-0",value:I,addonAfter:r.jsxs(r.Fragment,{children:[r.jsx("span",{onClick:S,className:"flex justify-center items-center px-4 h-8 text-center text-black rounded-r-sm border-l border-grey6 animate-click text-t2-medium",children:"重置链接"}),r.jsx("span",{onClick:A,className:"flex justify-center items-center px-4 h-8 text-center text-black rounded-r-sm border-l border-grey6 animate-click text-t2-medium",children:"复制邀请链接"})]})}),r.jsx(dt.SettingDivider,{className:"my-2.5"})]}),r.jsxs("div",{className:"flex top-0 shrink-0 items-center justify-between mt-2.5 h-9 text-t2",children:[r.jsx("div",{children:"人员信息"}),r.jsx(Ct,{className:"pl-3 pr-1.5 w-full max-w-[300px] h-8 rounded-full",inputClassName:"px-0",value:b,onChange:w,placeholder:"搜索人员、手机号",addonBefore:r.jsx(V,{size:"middle",name:"IcSearch",className:"text-grey4"}),addonAfter:b&&r.jsx(V,{size:"middle",name:"IcUploadCancel",onClick:()=>w(""),className:"text-grey4 cursor-pointer"})})]}),r.jsx(R2,{foldLength:50,items:v,renderItemContent:U=>{var Y;const z=U.uuid===u.uuid||p,K=(Y=_.userRemark)==null?void 0:Y[U.uuid];let W=U.nickname;return K&&(W="".concat(K," (").concat(U.nickname||Po,")")),r.jsxs("div",{className:"group flex shrink-0 items-center h-[58px]",children:[r.jsx(Fl,{user:U,className:"mr-2 w-[30px] h-[30px] !text-t1"}),r.jsx("div",{className:"flex flex-col grow",children:C===U.uuid?r.jsx(Ct,{autoFocus:!0,maxLength:20,className:"pl-3 pr-1.5 w-full max-w-[300px] h-8 rounded-sm",inputClassName:"px-0",defaultValue:K,onChange:G=>{T.current=G},placeholder:"请输入备注",onEnter:G=>{G.target instanceof HTMLElement&&G.target.blur()},onBlur:async()=>{const G=T.current;T.current=void 0,k(void 0),G!==void 0&&(await ve.infra.addSpaceUserRemark(_.uuid,{[U.uuid]:G}),re(kw({uuid:_.uuid,patch:[{userId:U.uuid,markName:G}]})))}}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"mb-0.5 text-t2",children:W||Po}),z&&r.jsx(Vq,{className:"ml-1 cursor-pointer transition-opacity group-hover:opacity-100 opacity-0",onClick:()=>{k(U.uuid)}})]}),r.jsx("span",{className:"text-grey3 text-t4",children:Cm(U.phone||U.email)})]})}),r.jsxs("div",{className:R("self-center flex items-center text-t2",z&&"cursor-pointer"),onClick:G=>z&&O(G,U.uuid),children:[U.spaceRole===m.PermissionRole.EDITOR?"管理员":"成员",z&&r.jsx(V,{name:"IcArrowDown01",className:"ml-1",size:"xxxsmall"})]})]},U.uuid)}})]})},gje=()=>{const e=ie(),t=Dt(),n=Ut(),s=Oe(),a=g0(),{checkoutUpgraded:o}=an(Ws),i=Wte(),l=hg(),{editor:c}=l(n.uuid),{permissionGroups:d=[]}=t,[u,f]=y.useState(d),[h,p]=y.useState(""),[g,_]=y.useState("");y.useEffect(()=>{f(d)},[d]);const x=(k=[])=>{s(()=>{a(t.uuid,{permissionGroups:k})})},F=y.useRef(Ps(x,1e3)).current,b=(k,T,v)=>{const I=[];u.forEach(j=>{j.id===k?I.push({...j,[T]:v}):I.push(j)}),f(I),F(I)},w=()=>{const k={name:"",id:qe(),userIds:[]};me.event("new_group"),_(k.id),F([k,...u])},E=k=>{e.warning({title:"确定删除当前分组吗？",content:"如果有仅该组成员可管理的页面将会转移给你管理。",confirmText:"确认删除",colorType:"red",confirm:()=>{me.event("delete_group"),F(u.filter(T=>T.id!==k))}})},C=(k=[])=>{f(k),F(k)};return i?r.jsxs("div",{className:"mt-3.5",children:[r.jsxs("div",{className:"mb-9",children:[r.jsx("div",{className:"flex items-center mb-2.5 h-9",children:"你可以将任意成员组成 1 个或多个成员组，成员组可以帮你更方便的配置页面协作权限。"}),r.jsxs("div",{className:"flex justify-between items-center h-14",children:[c?r.jsx(De,{colorType:"active",className:"text-t2-medium",onClick:w,children:"创建成员组"}):r.jsx("div",{}),!!u.length&&r.jsx(Ct,{className:"pl-3 pr-1.5 w-full max-w-[300px] h-8 rounded-full",inputClassName:"px-0",value:h,onChange:p,placeholder:"搜索人员、手机号",addonBefore:r.jsx(V,{size:"middle",name:"IcSearch",className:"text-grey4"}),addonAfter:h&&r.jsx(V,{size:"middle",name:"IcUploadCancel",onClick:()=>p(""),className:"text-grey4 cursor-pointer"})})]}),!!u.length&&r.jsx(dt.SettingDivider,{})]}),r.jsx(br,{items:u,onChange:C,renderItemContent:({item:k,renderDragHandle:T})=>r.jsx(_je,{item:k,searchKeywords:h,lastCreateGroup:g,deleteGroup:E,renderDragHandle:T,updateGroupInfo:b})})]}):r.jsxs("div",{children:[r.jsx("div",{className:"h-9 text-t1-medium flex items-center mt-3.5",children:"升级空间开启成员组"}),r.jsx("div",{className:"text-t3 text-grey3 h-9 flex items-center mb-5",children:"你可以将任意成员组成 1 个或多个成员组，成员组可以帮你更方便的配置页面协作权限。"}),r.jsx(De,{className:"!text-t2-medium",colorType:"active",onClick:()=>o(Mt.group),children:"升级空间"})]})},_je=e=>{const{item:t,lastCreateGroup:n,searchKeywords:s,renderDragHandle:a,updateGroupInfo:o,deleteGroup:i}=e,l=ie(),c=Ut(),d=hg(),{editor:u}=d(c.uuid),f=K0(),h=Uo(),p=Dt(),g=y.useMemo(()=>f({keywords:s}).filter(C=>t.userIds.includes(C.uuid)),[f,s,t.userIds]),_=E=>{o(t.id,"userIds",E)},x=E=>{l.dropdown({popcorn:ra(E.currentTarget),placement:"bottom-start",content:({onCloseModal:C})=>r.jsx(xje,{defaultSelectIds:t.userIds,updateGroupMembers:_,onCloseModal:C})})},F=E=>{l.warning({title:"确认移除这位成员吗？",confirm:()=>{_(t.userIds.filter(C=>C!==E))}})},b=E=>{l.dropdown({popcorn:E.currentTarget,placement:"bottom-start",content:({onCloseModal:C})=>r.jsx(ze,{className:"py-2 w-[270px] next-modal",items:[{type:H.TEXT_DESCRIPTION,data:{title:r.jsxs("div",{className:"text-red",children:[r.jsx(V,{name:"IcTrash",size:"middle",className:"mr-2"}),"删除分组"]}),onClick:()=>{i(t.id),C()}}}]})})},w=E=>{E.preventDefault(),E.stopPropagation(),u&&l.dropdown({popcorn:E.currentTarget,placement:"bottom",content:({onCloseModal:C})=>r.jsx(_N,{showRecently:!1,onSelectEmoji:(k,T)=>{T||C(),o(t.id,"icon",{type:"emoji",value:k})},onUploadFile:k=>{C(),be.loading({key:vu.UPLOAD_ICON,content:"头像上传中..."}),h({file:k,type:"public",searchType:"avatar",onComplete(T){T.success&&(be.success("上传完成"),o(t.id,"icon",{type:"upload",value:T.ossName}))}})},onRemoveBtnClick:()=>{C(),o(t.id,"icon",{})}})})};return r.jsxs("div",{className:"mb-9",children:[r.jsxs("div",{className:"flex relative items-center h-9 group",children:[u&&a({className:"cursor-pointer flex items-center justify-center w-5 h-5 mr-1 text-grey4 absolute top-2 -left-7  opacity-0 group-hover:opacity-100 transition-opacity",popup:"长按拖拽"}),r.jsx(ar,{className:R("mr-2 text-h4",u&&"cursor-pointer"),name:t.name||"未",icon:t.icon,onClick:w}),r.jsx(oi,{singleLine:!0,readonly:!u,autoFocus:!t.name&&n===t.id,value:t.name,className:"whitespace-nowrap",boxClassName:"cursor-text rounded animate-hover text-ellipsis",placeholder:"请输入组名",fontClassName:R("text-t2-medium whitespace-nowrap text-ellipsis",!t.name&&"min-w-[70px]"),onChange:E=>o(t.id,"name",E.currentTarget.value)}),!!t.userIds.length&&r.jsxs("div",{className:"ml-2 text-grey3 text-t2 flex-shrink-0",children:[t.userIds.length,"位成员"]}),u&&r.jsx(V,{name:"IcMore",size:"middle",className:"text-grey3 ml-auto flex-shrink-0 animate-hover",onClick:b})]}),r.jsx(dt.SettingDivider,{}),r.jsxs(r.Fragment,{children:[r.jsx(R2,{foldLength:10,items:g,renderItemContent:E=>{var T;const C=(T=p.userRemark)==null?void 0:T[E.uuid];let k=E.nickname;return C&&(k="".concat(C," (").concat(E.nickname,")")),r.jsxs("div",{className:"flex items-center justify-between h-9 text-t2 group",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(Fl,{user:E,className:"mr-2 !text-t2-medium"}),k,E.spaceRole===m.PermissionRole.EDITOR&&r.jsx("span",{className:"ml-2 flex items-center px-1.5 bg-grey/20 text-grey3 rounded-sm h-5",children:"管理员"})]}),u&&r.jsx("span",{className:"text-red cursor-pointer opacity-0 group-hover:opacity-100",onClick:()=>F(E.uuid),children:"移出"})]},E.uuid)}}),u&&r.jsxs("div",{className:"flex items-center h-9 text-grey4 cursor-pointer",onClick:x,children:[r.jsx(V,{name:"IcAddBoard",className:"mr-2",size:"middle"}),"添加成员"]})]})]})},xje=e=>{const{updateGroupMembers:t,onCloseModal:n,defaultSelectIds:s=[]}=e,a=ba(),o=K0()({filterIds:s,users:a}),i=y.useRef(),[l,c]=y.useState(""),[d,u]=y.useState([]),f=F=>{c(""),u(b=>[...b,F])},h=F=>{u(b=>b.filter(w=>w!==F))},p=F=>{const b=An(d);Ie("BackSpace")(F)&&!l&&b&&h(b)},g=()=>{t([...s,...d]),n()},_=d.length>0,x=y.useMemo(()=>{const F=o.filter(b=>!d.includes(b.uuid));return lc(F,l)},[l,d,o]);return r.jsxs("div",{className:"w-[400px] next-modal",children:[r.jsxs("div",{className:"p-2.5 pb-1 border-b border-grey6",children:[r.jsxs("div",{className:"flex flex-wrap items-center",children:[d.map(F=>{const b=a[F];return b?r.jsxs("span",{className:"flex items-center mr-1.5 mb-1.5 cursor-default text-t2",children:[r.jsx(Fl,{user:b,className:"mr-2 !text-t2-medium"}),Rn(F)||Po,r.jsx(V,{name:"IcToastClose",size:"middle",className:"opacity-50",onClick:()=>h(F)})]},b.uuid):null}),r.jsx(Ct,{autoFocus:!0,showBorder:!1,className:"flex-1 mb-1.5 h-6 !bg-transparent min-w-[100px]",inputClassName:"px-0 text-t2",value:l,onChange:c,onKeyDown:p,placeholder:"搜索成员昵称"})]}),r.jsx("div",{className:"flex justify-end -translate-y-1",hidden:!_,children:r.jsx(De,{onClick:g,colorType:"active",className:"text-t2-medium",children:"添加"})})]}),r.jsxs("div",{ref:i,className:"overflow-y-auto p-2.5 w-[400px] max-h-[40vh]",children:[r.jsx(Um,{containerRef:i,itemCount:x.length,children:(F,b)=>x.map((w,E)=>r.jsxs("div",{onClick:()=>f(w.uuid),className:R("flex items-center h-10 text-t2 w-full px-1 cursor-pointer animate-hover rounded",F===E&&"normal-bg"),onMouseEnter:()=>b(E),children:[r.jsx(Fl,{user:w,className:"mr-2 !text-t2-medium"}),Rn(w.uuid)||Po]},w.uuid))}),!x.length&&r.jsx("div",{className:"flex items-center text-grey3 cursor-default text-t2",children:"无搜索结果"})]})]})},yje=()=>{const e=Za(),t=ba(),n=Object.values(t),s=kd();return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:dt.commonStyles.container,children:r.jsxs(xg,{tabBarClassName:"px-0",children:[r.jsx(Zr,{title:["成员",n.length?"（".concat(n.length,"）"):""].join(""),children:r.jsx(pje,{})}),r.jsx(Zr,{title:"成员组",children:r.jsx(gje,{})}),r.jsx(Zr,{title:"外部协作者（".concat(s.length,"）"),children:r.jsx(mje,{})})]})}),r.jsx(dt.FooterBar,{cancelText:"关闭",cancel:()=>e()})]})},bje=()=>{var h,p;const e=Za(),t=ie(),n=Dt(),s=y.useRef(null),a=y.useRef(0),[o,i]=y.useState(),l=(h=o==null?void 0:o.pendingList)==null?void 0:h[0],c=async(g=!1)=>{g||a.current++;const _=await ve.infra.getOrderList(a.current,20,n.uuid);i(x=>({..._,list:dg([...(x==null?void 0:x.list)||[],..._.list||[]],"id")}))},d=g=>{c(!0),rN({bizType:"order_finish",order_amount:l==null?void 0:l.total,order_channel:"card",is_from:Mt.order,order_new:g})},u=g=>{const _=Rw()?"yes":"no";t.modal({content:({onCloseModal:x})=>{var F;return r.jsx(HO,{orderId:g.id||"",onFinish:()=>{d(_),x()},onCloseModal:x,price:g.total||0,endTime:(F=g.expirationTime)!=null?F:0,remark:g.remark,customFooter:r.jsx(De,{className:"w-32 text-t2-medium",onClick:()=>x(),children:"确定"})})}})},f=g=>{t.warning({title:"确认取消订单吗？",content:"取消后，你也可以重斯下单",confirmText:"取消订单",cancelText:"我再想想",confirm:async()=>{be.loading({key:"cancelOrder",content:"正在取消订单"}),await ve.infra.cancelOrder(g),c(!0),be.closeMessage("cancelOrder"),be.success("取消成功")}})};return y.useEffect(()=>{c()},[]),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:R(dt.commonStyles.container,"overflow-y-hidden"),children:[r.jsx(dt.Header,{title:"订单",addonAfter:r.jsx("div",{hidden:!1,className:"flex items-center justify-center text-t2 text-black",children:r.jsx("a",{href:ds.applyInvoice,target:"_blank",rel:"noopener noreferrer",children:"开发票"})})}),l&&r.jsxs("div",{className:"flex items-center justify-between h-14 bg-active_color/10 text-active_color px-4",children:[r.jsx("div",{children:"有一笔订单（".concat(io(l.currencyUnit)).concat(l.total,"）待支付")}),r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx(De,{colorType:"secondary",onClick:()=>l.id&&f(l.id),className:"text-active_color border-active_color mr-5 animate-hover",children:"取消订单"}),r.jsx(De,{colorType:"active",onClick:()=>u(l),children:"查看订单"})]})]}),r.jsxs("div",{className:"flex flex-col justify-between items-center mt-5 overflow-y-hidden overscroll-x-auto flex-1",children:[r.jsxs("div",{className:"grid grid-cols-9 gap-x-2 w-full py-2",children:[r.jsx("div",{className:"col-span-3",children:"订单号"}),r.jsx("div",{className:"col-span-2",children:"订单内容"}),r.jsx("div",{className:"col-span-1",children:"金额"}),r.jsx("div",{className:"col-span-1",children:"操作人"}),r.jsx("div",{className:"col-span-2",children:"订单时间"})]}),r.jsx("div",{className:"w-full h-2.5 border-b border-grey6"}),r.jsx("div",{ref:s,className:"overflow-y-auto w-full flex-1 flex-shrink-0",children:r.jsx(xd,{pageStart:1,initialLoad:!1,useWindow:!1,loadMore:()=>c(),getScrollParent:()=>s.current,hasMore:o==null?void 0:o.more,children:(p=o==null?void 0:o.list)!=null&&p.length?r.jsx(r.Fragment,{children:o.list.map(g=>r.jsxs("div",{className:"grid grid-cols-9 gap-x-2 w-full py-2",children:[r.jsx("div",{className:"col-span-3 break-words",children:g.id}),r.jsxs("div",{className:"break-words col-span-2",children:[r.jsx("div",{children:g.description}),g.subDesc&&r.jsx("div",{className:"text-t4 text-grey3",children:g.subDesc})]}),r.jsxs("div",{className:"break-words col-span-1",children:[io(g.currencyUnit),g.total]}),r.jsx(Fe,{placement:"top-start",className:"col-span-1 text-ellipsis",popup:g.userName,children:g.userName}),r.jsx("div",{className:"break-words col-span-2",children:g.createdAt?ue(new Date(g.createdAt)).format(On):""})]},g.id))}):r.jsx("div",{className:"text-t4 text-center text-grey3 mt-3",children:"暂无订单"})})})]})]}),r.jsx(dt.FooterBar,{cancel:()=>e(),cancelText:"关闭"})]})},dk=qe(),Fje=e=>{const{onSuccess:t,payApi:n}=e,{register:s,handleSubmit:a}=Jv(),o=async l=>{be.exists(dk)||(be.loading({content:"开始提现",key:dk}),await n(l).finally(()=>{be.closeMessage(dk)}),t(),be.success("提现完成"))},i=[{key:"aliLogonId",placeholder:"支付宝帐户"},{key:"aliLogonUsername",placeholder:"支付宝真实姓名"},{key:"identityNumber",placeholder:"身份证号"}];return r.jsxs("form",{className:"p-4 space-y-5 px-6 w-96",onSubmit:a(o),children:[r.jsx("div",{className:"text-h4",children:"提现申请"}),r.jsxs("div",{className:"space-y-2.5",children:[i.map(l=>r.jsx(y3,{addonBefore:r.jsx("span",{className:"flex-shrink-0 text-t2 border-r pr-2 text-grey3",children:l.placeholder}),placeholder:"输入".concat(l.placeholder),className:"h-9 px-2 rounded ring-grey6",inputProps:s(l.key,{required:!0})},l.key)),r.jsxs("div",{className:"text-t4 text-grey3",children:[r.jsx("span",{children:"继续提现表示您已同意"}),r.jsx("a",{target:"_blank",href:vk.yzh,className:"text-active_color animate-click",rel:"noreferrer",children:"《共享经济合作伙伴协议》"})]}),r.jsx(De,{colorType:"active",className:"ml-auto",type:"submit",children:"提现"})]})]})},$q=()=>{const e=ie();return y.useCallback(t=>{const{type:n}=t,s=new JL,a=l=>ve.infra.withdrawFromWallet({...l,spaceId:t.spaceId}),o=ve.infra.withdrawMoneyForVipFromWallet,i=n==="space"?a:o;return e.modal({content:()=>r.jsx(Fje,{payApi:i,onSuccess:()=>{s.resolve()}})}),s.promise},[e])},Hq=e=>{const{type:t}=e,n=ln(),s=y.useCallback(async i=>{const l={page:0,user:1,all:2},c=await ve.infra.distributionAlliancePayRecords(i.pageIndex,i.pageSize,l[t]);return{list:c.results.map(u=>{var h;const f=(h=c.recordMap.users)==null?void 0:h[u.userId];return{...u,userInfo:f}}).filter(Boolean),more:c.more}},[t]),{titleList:a,dataList:o}=y.useMemo(()=>{const i={total:{title:"金额",id:"total",render:c=>"¥".concat(c.total)},type:{title:"佣金类型",id:"type",render:c=>c.from===0?"订阅分销":"空间会员"},name:{title:"付费用户昵称",id:"name",render:c=>{var d;return"".concat((d=c.userInfo)==null?void 0:d.nickname)}},status:{title:"状态",id:"status",render:c=>c.inProgress?"入账中":c.status===2?"已取消":c.status===0?"未付款":"已入账"},createdAt:{title:"时间",id:"createdAt",render:c=>ue(c.payAt).format("YYYY-MM-DD HH:mm")},pageFrom:{title:"页面来源",id:"sharePageId",render:c=>{var d;return r.jsx(Cs,{popup:c.sharePageId,className:"inline-block",children:r.jsx("a",{target:"_blank",href:"".concat(_n()).concat(Nt.share).concat(c.sharePageId),className:"text-active_color underline underline-offset-4",children:(d=c.sharePageId)==null?void 0:d.substring(0,8)})})}}},l=[];return t==="all"&&l.push(i.total,i.type,i.name,i.status,i.createdAt),t==="user"&&l.push(i.total,i.pageFrom,i.name,i.status,i.createdAt),t==="page"&&l.push(i.total,i.name,i.status,i.createdAt),{titleList:l,dataList:l}},[t]);return r.jsx(UO,{className:"min-w-[500px]",modalHeader:{title:"累计获得佣金",closeModal:()=>n(Ve.ORDER_RECORD_MODAL)},getApi:s,titleList:a,dateList:o})},wje=()=>{const e=Ut(),t=ie(),n=LT(),s=LT(),[a]=gm({getApi:()=>ve.infra.distributionAlliancePayRecords(1,1,1)}),[o]=gm({getApi:()=>ve.infra.distributionAlliancePayRecords(1,1,0)}),i="".concat(_n()).concat(Nt.login,"?").concat(dn.inviteCode,"=").concat(e.inviteCode),l=d=>{me.event(d===0?"invite_copylink":"invite_copycode")},c=d=>{t.modal({modalId:Ve.ORDER_RECORD_MODAL,content:()=>r.jsx(Hq,{type:d})})};return r.jsxs("div",{className:"space-y-2.5",children:[r.jsxs("div",{className:"py-4 border-b flex items-center justify-between",children:[r.jsx("div",{children:"空间会员佣金"}),r.jsxs("div",{className:"space-x-1 flex items-center animate-click",onClick:()=>c("user"),children:[r.jsxs("span",{children:["累计空间会员佣金奖励：",r.jsxs("span",{className:"text-t2-medium",children:[a==null?void 0:a.total," 单"]})]}),r.jsx(dt.Arrow,{})]})]}),r.jsxs("div",{className:"relative rounded border px-4 pt-10 pb-5",children:[r.jsx("span",{className:"absolute top-0 left-0 text-t3 bg-active_color text-white px-1.5 py-px rounded-sm",children:"方式一"}),r.jsx("div",{className:"mb-2.5",children:"新用户通过您的邀请、协作链接注册，或者通过拷贝您的页面注册，可获赠专属会员优惠及赠送时长券，对方使用此券升级为空间会员，您则获得20%的佣金奖励。"}),r.jsx(Ct,{value:"".concat(location.origin).concat(Nt.login,"?").concat(dn.inviteCode,"=").concat(e.inviteCode),inputClassName:"h-8 text-black",className:"overflow-hidden",readonly:!0,addonAfter:r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-8 bg-grey6 w-px"}),r.jsx(De,{id:n,className:"border-none rounded-none",onClick:()=>l(0),"data-clipboard-text":i,children:"复制链接"}),r.jsx("div",{className:"h-8 bg-grey6 w-px"}),r.jsx(De,{id:s,className:"border-none rounded-none",onClick:()=>l(1),"data-clipboard-text":e.inviteCode,children:"复制邀请码"})]})})]}),r.jsxs("div",{className:"relative rounded border px-4 pt-10 pb-5",children:[r.jsx("span",{className:"absolute top-0 left-0 text-t3 bg-black-base text-white px-1.5 py-px rounded-sm",children:"方式二"}),r.jsx("div",{className:"mb-2.5",children:"新用户通过访问您分享的任意文档页面，均可获赠专属会员优惠及赠送时长券，对方使用此券升级为空间会员，您则获得20%的佣金奖励。"}),r.jsx(ul,{className:"text-grey3",beforeIcon:!0,linkContainer:!0,link:ds.helperShare,children:"如何分享页面"})]}),r.jsxs("div",{className:"py-4 border-b flex items-center justify-between",children:[r.jsx("div",{children:"付费订阅佣金"}),r.jsxs("div",{className:"space-x-1 flex items-center animate-click",onClick:()=>c("page"),children:[r.jsxs("span",{children:["累计邀请付费订阅佣金奖励：",r.jsxs("span",{className:"text-t2-medium",children:[o==null?void 0:o.total," 单"]})]}),r.jsx(V,{className:"text-grey3",name:"IcArrowDateNext",size:"small"})]})]}),r.jsxs("div",{className:"relative rounded border px-4 pt-10 pb-5",children:[r.jsx("span",{className:"absolute top-0 left-0 text-t3 bg-active_color text-white px-1.5 py-px rounded-sm",children:"方式一"}),r.jsxs("div",{className:"mb-2.5 space-x-2 justify-between",children:[r.jsx("span",{children:"好友支付您开通了「分享有赏」的付费订阅文档，您可享受订阅金额的20%-50%的佣金奖励。"}),r.jsx("a",{href:ds.subscribeCenter,target:"_blank",className:"text-active_color animate-click",children:"去知识库分享"})]}),r.jsx(ul,{className:"text-grey3 inline-flex items-center",beforeIcon:!0,linkContainer:!0,link:ds.rebateRule,children:"分享有赏是什么？"})]})]})},Eje=()=>{const e=Za();return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:dt.commonStyles.container,children:[r.jsx(dt.Header,{title:"邀请返佣"}),r.jsx(Cje,{}),r.jsx(dt.SettingDivider,{}),r.jsx(wje,{})]}),r.jsx(dt.FooterBar,{cancelText:"关闭",cancel:()=>e()})]})},Cje=()=>{const e=ie(),t=$q(),[n]=Oq(),s=()=>{e.modal({modalId:Ve.ORDER_RECORD_MODAL,content:()=>r.jsx(Hq,{type:"all"})})},a=()=>{e.modal({modalId:Ve.ORDER_RECORD_MODAL,content:()=>r.jsx(kje,{})})};return r.jsxs("div",{className:"text-t2 py-4 space-y-2.5",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"space-y-2 animate-click",onClick:s,children:[r.jsxs("div",{className:"space-x-1 flex items-center",children:[r.jsx("span",{children:"累计获得佣金"}),r.jsx(dt.Arrow,{})]}),r.jsxs("span",{className:"space-x-1",children:[r.jsx("span",{children:"¥"}),r.jsx("span",{className:"text-h2",children:n==null?void 0:n.totalAmount.toFixed(2)})]})]}),r.jsx("div",{children:r.jsx(De,{onClick:()=>t({type:"user",spaceId:Ot()}),children:"提现"})})]}),r.jsxs("div",{className:"flex items-center space-x-24",children:[r.jsxs("div",{className:"flex flex-col space-y-1",children:[r.jsx("span",{children:"可提现金额"}),r.jsxs("span",{className:"space-x-1",children:[r.jsx("span",{children:"¥"}),r.jsx("span",{className:"text-h3",children:n==null?void 0:n.canWithdrawAmount.toFixed(2)})]})]}),r.jsxs(Fe,{popup:"5-7个工作日到账",className:"cursor-help flex flex-col space-y-1",children:[r.jsx("span",{className:"border-b border-dashed border-grey3",children:"入账中金额"}),r.jsxs("span",{className:"space-x-1",children:[r.jsx("span",{children:"¥"}),r.jsx("span",{className:"text-h3",children:n==null?void 0:n.inProgressAmount.toFixed(2)})]})]}),r.jsxs("div",{className:"flex flex-col space-y-1 animate-click",onClick:a,children:[r.jsxs("span",{children:[r.jsx("span",{children:"已提现金额"}),r.jsx(dt.Arrow,{})]}),r.jsxs("span",{className:"space-x-1",children:[r.jsx("span",{children:"¥"}),r.jsx("span",{className:"text-h3",children:n==null?void 0:n.alreadyWithdrawAmount.toFixed(2)})]})]})]})]})},kje=()=>{const e=ln(),t=async n=>{const s=await ve.infra.withdrawForVipOrderList(n.pageIndex,n.pageSize);return{more:s.more,list:s.list}};return r.jsx(UO,{className:"min-w-[500px]",modalHeader:{title:"提现记录",closeModal:()=>e(Ve.ORDER_RECORD_MODAL)},getApi:t,titleList:[{title:"金额"},{title:"提现状态"},{title:"时间"}],dateList:[{id:"total",render:n=>"¥".concat(n.total)},{id:"status",render:n=>{const s=n.status===2;return r.jsx("span",{className:R(s&&"text-red"),children:s?"提现失败":"提现成功"})}},{id:"createdAt",render:n=>ue(n.createdAt).format("YYYY-MM-DD HH:mm")}]})},Tje=e=>{const{pageId:t}=e,n=ye(t,["data"],["segments"]),s=y.useMemo(()=>fe(n==null?void 0:n.data.segments),[n==null?void 0:n.data.segments]),[a,o]=y.useState(""),i=K0(),[l,c]=y.useState({}),d=ie(),u=kd(),f=ba(),h=y.useMemo(()=>u.reduce((_,x)=>(_[x.userId]=x.userId,_),{}),[u]),p=(_,x)=>{!l||!Object.values(l).find(w=>w.uuid===x)||d.dropdown({placement:"bottom",offset:[0,4],popcorn:_.currentTarget,content:({onCloseModal:w})=>r.jsx(ze,{className:"py-2 w-[270px] next-modal",onItemClick:()=>w(),items:[{type:H.TEXT_DESCRIPTION,data:{title:r.jsx("div",{className:"text-red",children:"移除"}),onClick:()=>{c(E=>{const C={...E};return delete C[x],C}),e.onKickout(x),ve.infra.cancelSubscribe(t,{userId:x})}}}]})})},g=y.useMemo(()=>i({keywords:a,users:l}),[a,i,l]);return y.useEffect(()=>{t&&ve.infra.getSubscribeUserList(t).then(_=>{_.recordMap.users&&re(Ha.updateSpaceUsers({users:_.recordMap.users}));const x=_.results.reduce((F,b)=>{const w=J.users[b.userId];return w&&(F[w.uuid]=w),F},{});c(x)})},[t]),t?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"cursor-pointer flex items-center p-1 hover:bg-black_006 rounded",onClick:()=>{e.goBack()},children:r.jsx(V,{name:"IcArrowBack",size:"middle"})}),r.jsx("span",{className:"text-t2 text-grey3 ml-2",children:s})]}),r.jsx(dt.SettingDivider,{}),r.jsxs("div",{className:"flex top-0 shrink-0 items-center justify-between mt-2.5 h-9 text-t2",children:[r.jsx("div",{children:["订阅者信息（",g.length,"订阅）"].join("")}),r.jsx(Ct,{className:"pl-3 pr-1.5 w-full max-w-[200px] h-8 rounded",inputClassName:"px-0",value:a,onChange:o,placeholder:"搜索人员、手机号",addonBefore:r.jsx(V,{size:"middle",name:"IcSearch",className:"text-grey4"}),addonAfter:a&&r.jsx(V,{size:"middle",name:"IcUploadCancel",onClick:()=>o(""),className:"text-grey4 cursor-pointer"})})]}),r.jsx(R2,{moreContent:"订阅者",foldLength:50,items:g,renderItemContent:_=>{const x=_.nickname,F=f[_.uuid],b=h[_.uuid];return r.jsxs("div",{className:"group flex shrink-0 items-center h-[58px]",children:[r.jsx(Fl,{user:_,className:"mr-2 w-[30px] h-[30px] !text-t1"}),r.jsxs("div",{className:"flex flex-col grow",children:[r.jsx("div",{className:"flex items-center",children:r.jsx("span",{className:"mb-0.5 text-t2",children:x||Po})}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-grey3 text-t4",children:Cm(_.phone||_.email)}),F&&r.jsx("span",{className:"ml-1 p-0.5 rounded text-t4 bg-grey8",children:"空间成员"}),!F&&b&&r.jsx("span",{className:"ml-1 p-0.5 rounded text-t4 bg-grey8",children:"外部协作者"})]})]}),r.jsxs("div",{className:R("self-center flex items-center text-t2 cursor-pointer"),onClick:w=>p(w,_.uuid),children:["订阅者",r.jsx(V,{name:"IcArrowDown01",className:"ml-1",size:"xxxsmall"})]})]},_.uuid)}})]}):null},DP="only_watch_my_share_pages",vje=()=>{const e=y.useRef(null),[t,n]=y.useState(Bf(DP)==="true"),s=Dt(),[a,o]=y.useState(),[i,l]=y.useState(),c=y.useMemo(()=>t?i==null?void 0:i.filter(u=>{var f;return((f=J.blocks[u.uuid])==null?void 0:f.createdBy)===xa().uuid}):i,[t,i]);y.useEffect(()=>{s.uuid&&ve.infra.getSpaceSharedPages(s.uuid).then(u=>{var h;re(Tn.update({blocks:u.recordMap.blocks}));const f=(h=u.results)==null?void 0:h.sort((p,g)=>{var F,b,w,E,C,k;const _=(w=(b=(F=u.recordMap.blocks)==null?void 0:F[p.uuid])==null?void 0:b.permissions.find(T=>T.type===m.PermissionType.PUBLIC))==null?void 0:w.createdAt;return((k=(C=(E=u.recordMap.blocks)==null?void 0:E[g.uuid])==null?void 0:C.permissions.find(T=>T.type===m.PermissionType.PUBLIC))==null?void 0:k.createdAt)-_});l(f)})},[s.uuid]);const d=y.useMemo(()=>{var f;const u=(f=c==null?void 0:c.length)!=null?f:0;return a?r.jsx(Tje,{pageId:a.uuid,goBack:()=>{o(void 0)},onKickout:()=>{l(h=>{const p=h==null?void 0:h.filter(g=>g.uuid!==a.uuid);return p?[...p,{...a,subscribedNum:a.subscribedNum-1}]:h}),o({...a,subscribedNum:a.subscribedNum-1})}}):r.jsxs(r.Fragment,{children:[r.jsx(dt.Header,{title:"公开分享"}),r.jsx(dt.Item,{leftChild:"所有正在公开分享的页面（".concat(u,"）"),rightChild:r.jsx(r.Fragment,{children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{className:R(t?"text-active_color":"dark:text-white"),name:t?"IcCheckboxCheck":"IcCheckbox",size:"middle",onClick:()=>{ts(DP,t?"false":"true"),n(!t)}}),r.jsx("span",{className:"ml-1 text-t3",children:"只看我创建的页面"})]})})}),r.jsx(dt.SettingDivider,{}),r.jsx("div",{className:"mt-2.5 space-y-2",children:r.jsx(qs,{customScrollParent:e.current||void 0,totalCount:u,overscan:100,itemContent:h=>{const p=c==null?void 0:c[h];return p?r.jsx(Ije,{uuid:p.uuid,subscribedNum:p.subscribedNum,gotoSubscribePage:()=>{o(p)}}):null}})})]})},[t,c,a]);return r.jsx("div",{className:dt.commonStyles.container,ref:e,children:d})},zq=e=>{const{password:t,allowSubscribe:n,allowDuplicate:s,allowDownload:a,allowSeo:o,publicRole:i,accessFee:l=0}=mt(e);return[{icon:"IcMoney",desc:"付费设置",status:l>0?"付费分享":"免费分享",isHidden:!1,enable:l>0},{icon:"IcLock",desc:"开启密码",status:t?"已开启":"未开启",enable:t},{icon:"IcSubscription",desc:"页面订阅",status:n?"允许":"未开启",isHidden:!1,enable:n},{icon:"IcCopy",desc:"页面拷贝",status:s?"允许":"未开启",enable:s},{icon:"IcMenuPrint",desc:"页面下载、打印",status:a?"允许":"未开启",enable:a},{icon:"IcComment",desc:"开启评论",status:i===m.PermissionRole.COMMENTER?"已开启":"未开启"},{icon:"IcMenuOriginalLink",desc:"搜索引擎推广",status:o?"允许":"未开启",enable:o}].filter(c=>!c.isHidden)},Ije=e=>{const{uuid:t,subscribedNum:n}=e,s=ye(t,["permissions"]),a=ns(),o=Za(),{illegal:i,role:l,allowSubscribe:c}=mt(t),d=i?Ts:r.jsx(yl,{uuid:t}),u=l===m.PermissionRole.WRITER||l===m.PermissionRole.EDITOR,f=y.useMemo(()=>{const _=s==null?void 0:s.permissions.find(x=>x.type===m.PermissionType.PUBLIC);return _==null?void 0:_.createdAt},[s==null?void 0:s.permissions]),h=zq(t),p=async()=>{tn(s==null?void 0:s.type)?Xt("".concat(_n()).concat(u?"/":Nt.share).concat(t)):Xt("".concat(_n()).concat(u?Nt.preview:Nt.share).concat(t))},g=()=>{tn(s==null?void 0:s.type)?a.push("".concat(u?"/":Nt.share).concat(t)):a.push("".concat(u?Nt.preview:Nt.share).concat(t)),o()};return r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"min-w-[20px] max-w-[300px] flex items-center cursor-pointer animate-hover p-1 space-x-1",onClick:g,children:[r.jsx(Fn,{blockId:t,trigger:!1,iconSize:18,defaultIcon:r.jsx(_s,{uuid:t,size:"middle"})}),r.jsx("span",{className:"text-ellipsis",children:d})]}),r.jsx("div",{className:"flex items-center p-1 animate-hover",onClick:()=>{p()},children:r.jsx(V,{name:"IcLink",size:"middle"})})]}),r.jsx("div",{className:"ml-8",children:r.jsx(W4,{pageId:t,styleVariant:"messages",hideIfPageIsRoot:!0})}),r.jsxs("div",{className:"mt-0 ml-9 flex items-center justify-between ",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsxs("span",{className:"text-t4 text-grey3 space-x-1",children:[r.jsx("span",{children:ue(f).format("YY-MM-DD HH:mm")}),r.jsx("span",{children:"分享"})]}),c&&r.jsxs("div",{className:"flex items-center ml-2 animate-hover p-1 text-grey3 space-x-1",onClick:()=>{e.gotoSubscribePage()},children:[r.jsx("span",{className:"text-t4",children:n?"".concat(n," 人订阅"):"无人订阅"}),r.jsx(V,{name:"IcArrowUnfold",size:"xxxsmall"})]})]}),r.jsx(Fe,{interactive:!0,theme:"none",popupClass:"next-modal",animation:"shift-away",maxWidth:"unset",placement:"left",popup:r.jsx(Nje,{pageId:t,gotoPage:g,isWriter:u}),children:r.jsx("div",{className:"flex items-center self-end space-x-3",children:h.map(_=>r.jsx(V,{name:_.icon,size:"small",className:R({"text-grey4":!_.enable})}))})})]}),r.jsx("div",{className:"border-b border-grey6 w-full h-px mt-2"})]})},Nje=e=>{const{pageId:t,gotoPage:n,isWriter:s}=e,a=zq(t);return r.jsxs("div",{className:"w-[360px] pt-2",children:[r.jsx("div",{className:"w-full px-4 select-none",children:a.map((o,i)=>r.jsxs("div",{className:"flex items-center h-10 justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{size:"middle",name:o.icon}),r.jsx("span",{className:"text-t2 ml-2",children:o.desc})]}),r.jsx("span",{className:R("text-t2",{"text-grey3":!o.enable}),children:o.status})]},i))}),s&&r.jsxs("div",{className:"px-4 flex items-center h-10 border-t border-grey6 cursor-pointer hover:bg-black_006",onClick:n,children:[r.jsx(V,{size:"middle",name:"IcTitleShare",className:"text-grey3"}),r.jsx("span",{className:"ml-2 text-t2 text-grey3",children:"修改分享权限设置"})]})]})},jje=()=>{const{aiRestUsage:e,usage:t,gpt3_5:n,pdf:s}=Mm(),a=y.useRef(null),o=Vw(),i=Ur(),[l,c]=y.useState([]);y.useEffect(()=>{d(1)},[]);const d=async u=>{const f=Ot(),h=await ve.infra.getSpaceAiDetail(f,u,20);c(h)};return n.monthUsed+s.monthUsed,o?n.monthLimit-n.monthUsed:n.dayLimit-n.todayUsed,o?s.dayLimit-s.todayUsed:s.monthLimit-s.monthUsed,r.jsxs("div",{className:"py-[5px] max-h-[60vh] min-w-[500px] flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between h-[50px] px-7 flex-shrink-0",children:[r.jsxs("div",{className:"text-h4",children:[pm," 用量详情"]}),r.jsxs("p",{className:"text-t2 text-grey3",children:["已使用 ",t,"次/",i?"无限":e,"次"]})]}),r.jsx("div",{className:"bg-grey6 h-px my-1 w-full flex-shrink-0"}),r.jsx("div",{ref:a,className:"overflow-y-auto h-full",children:r.jsxs(xd,{className:"flex flex-col px-7 space-y-2",pageStart:1,initialLoad:!1,useWindow:!1,loadMore:d,getScrollParent:()=>a.current,children:[r.jsxs("div",{className:"text-t2 h-10 flex items-center",children:[r.jsx("span",{className:"w-40",children:"记录类型"}),r.jsx("span",{className:"w-28",children:"请求量（次）"}),r.jsx("span",{className:"w-28",children:"使用量"}),r.jsx("span",{className:"w-40",children:"生效时间"}),r.jsx("span",{className:"w-40",children:"记录时间"})]}),r.jsx("div",{className:"bg-grey6 h-px my-1 space-y-2"}),l.map(u=>{var f,h;return r.jsxs("div",{className:"flex w-full justify-between items-center h-10",children:[r.jsxs("div",{className:"text-t2 w-40 flex flex-col",children:[u.title,((f=u.endAt)!=null?f:0)>0&&r.jsxs("span",{className:"text-t4 text-grey3 w-[140px]",children:["有效期至 ",ue(u.endAt).format(Et)]})]}),r.jsx("div",{className:"text-t2 w-28",children:u.count}),r.jsxs("div",{className:"text-t2 w-28",children:[((h=u.usage)!=null?h:0)>0&&"+",u.usage]}),u.createdAt&&r.jsx("div",{className:"text-t2 w-40",children:ue(u.createdAt).format("YYYY/MM/DD HH:mm")}),u.updatedAt&&r.jsx("div",{className:"text-t2 w-40",children:ue(u.updatedAt).format("YYYY/MM/DD HH:mm")})]},u.updatedAt)}),!l.length&&r.jsx("div",{className:"text-t2 text-grey4 mt-2",children:"暂无记录"})]})})]})},Sje=()=>{const e=Mm(),t=ie();Vw();const n=Q0(),{enableAI:s}=xr(),a=Ur();Jw();const o=y.useCallback(()=>{t.modal({modalId:Ve.ORDER_LIST_SUPPORT,content:()=>r.jsx(yoe,{title:B_,subTitle:"购买".concat(B_),orderType:"aiUsage",openUpgradeModal:n})})},[t,n]),i=()=>{t.modal({content:()=>r.jsx(jje,{})})},l=y.useMemo(()=>e.monthlyEndDate?r.jsxs("span",{className:"animate-click",onClick:()=>o(),children:["失效日期 ",ue(e.monthlyEndDate).format(On)]}):null,[o,e.monthlyEndDate]);return r.jsxs(r.Fragment,{children:[r.jsx(Zn,{title:pm,rightPart:a?"无限次":""}),!a&&r.jsxs("div",{className:"flex items-center text-t3 h-9",children:[r.jsxs("span",{className:"mr-4",children:["已使用 ",e.usage,"次/",a?"无限":e.aiRestUsage,"次"]}),r.jsxs("button",{hidden:!s,className:"ml-auto mr-[5px] flex items-center",onClick:i,children:[r.jsx("span",{className:"text-t3 text-grey3",children:"查看详情"}),r.jsx(V,{name:"IcArrowUnfold",size:"xxxsmall",className:"text-grey3"})]})]}),!a&&r.jsxs("div",{className:"bg-grey9 rounded py-2 px-4 text-t2 text-grey3 mt-2.5 flex justify-between",children:[r.jsxs("div",{className:"space-x-1",children:[r.jsx("span",{children:B_}),r.jsx("span",{className:"text-active_color underline underline-offset-2 animate-click",onClick:()=>n(),children:"购买查询额度"})]}),l]})]})},Dje=()=>{const{setCurrentSettingMenu:e}=an(Ws),t=Dt();return r.jsxs("div",{className:"flex h-20 items-center",children:[r.jsx("div",{className:"rounded-md border border-black_006 p-1",children:r.jsx(ar,{name:t.title,color:t.backgroundColor,icon:t.icon,iconSize:50,className:"h-[50px] w-[50px]",style:{fontSize:"30px"}})}),r.jsxs("div",{className:"ml-4 flex-1 flex flex-col justify-center",children:[r.jsx("div",{className:"text-t1-medium",children:t.title}),r.jsx("div",{className:"text-t3 mt-1",children:t.domain?r.jsxs(r.Fragment,{children:[dw,"/",t.domain]}):r.jsx(r.Fragment,{children:" "})})]}),r.jsx(De,{className:"self-center mr-4",onClick:()=>{Xt(t.uuid,{message:"已复制空间 ID"})},children:"复制空间 ID"}),r.jsx(De,{className:"self-center",onClick:()=>{e(Kt.space)},children:"信息设置"})]})},qq=e=>{var v,I;const{type:t}=e,n=Ur(),s=Dt(),a=ya(),o=fN(),i=Mm(),l=Number(Math.min(rD((v=i==null?void 0:i.currentCapacity)!=null?v:0,(I=i==null?void 0:i.maxCapacity)!=null?I:0),100).toFixed(0)),{blocksMaxLimit:c,blocksUsage:d,blocksIsMax:u}=_c(),f=Number(Math.min(rD(d,c),100).toFixed(0)),h=Ut(),g=ba()[h.uuid],_=$E(Qm.SPACE_CAPACITY,{endDay:-1}),{showOnce:x}=_;if((g==null?void 0:g.spaceRole)!==m.PermissionRole.EDITOR)return null;const F="linear-gradient(to right, ".concat((l>=80,"".concat(x_.yellow))," ").concat(l,"%, var(--black-10) ").concat(l,"%)"),b="linear-gradient(to right, ".concat((f>=80,"".concat(x_.yellow))," ").concat(f,"%, var(--black-10) ").concat(f,"%)"),w=Zo(s.planType),E=As(i==null?void 0:i.maxCapacity),C=f>=80,k=l>=80,T={block:{popup:"当前空间计划为".concat(w,"空间，总共可使用 ").concat(c," 个块。一段文本、一个简单表格、一条分割线等等，都被称为“块”。\n\n").concat(["免费块已使用","".concat(d,"/").concat(c)].join(" ")),desc:"免费块",rightDesc:"".concat(d,"块/").concat(c,"块"),progress:f,backgroundImage:b,hidden:!C||n},capacity:{popup:"当前空间计划为".concat(w,"空间，总共可使用").concat(E,"容量。回收站中的页面和文件也会占有空间容量。"),desc:n?"空间容量":"免费空间容量",hidden:!k,rightDesc:"".concat(As(i==null?void 0:i.currentCapacity),"/").concat(E),progress:l,backgroundImage:F}};if(t==="setting")return r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:["总容量 ",As(i==null?void 0:i.maxCapacity),"，",r.jsxs("span",{className:l>=80?"text-red":"",children:["已使用 ",As(i==null?void 0:i.currentCapacity)," ",l,"%"]})]}),r.jsx("div",{className:"h-9 flex items-center",children:r.jsx("div",{style:{width:"100%",maxWidth:400,height:5,backgroundImage:F}})})]});if(t==="header"){if(l<100||!x)return null;const j={title:"达到空间储存容量上限",button:n?"购买容量":"立即升级",bg:"bg-yellow/10 text-black",popup:T.capacity.popup,desc:r.jsxs(r.Fragment,{children:["当前",w,"容量上限为",E,"容量，",n?r.jsx(r.Fragment,{children:"购买容量包"}):r.jsx(r.Fragment,{children:"升级获得更多空间容量"})]})};return u&&os(j,{title:"达到空间块数上限",button:"立即升级",bg:"bg-yellow/10 text-black",popup:T.block.popup,desc:r.jsxs(r.Fragment,{children:[w,"仅提供 ",c," 免费块， 升级获得更多块"]})}),r.jsxs(RR.Bar,{className:j.bg,children:[r.jsxs("div",{children:[r.jsxs("div",{className:"text-t2-medium flex items-center space-x-1",children:[r.jsx("span",{children:j.title}),r.jsx(Fe,{className:"text-grey3",popup:j.popup,children:r.jsx(V,{size:"small",name:"IcQuestion"})})]}),r.jsx("div",{className:"text-grey3",children:j.desc})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(De,{className:"ml-3",colorType:"primary",onClick:()=>{n&&k?o({isFrom:Mt.capacity_header}):a(Mt.capacity_header)},children:j.button}),r.jsx(RR.OnceOneDay,{..._})]})]})}return n?null:!k&&!C?r.jsx("div",{className:"p-1",children:r.jsxs("div",{className:"px-2 py-2 animate-click space-x-2 text-grey3 text-t2-medium flex items-center rounded bg-white2",onClick:()=>a(Mt.cataFile),children:[r.jsx(V,{size:"middle",name:"IcUpgrade"}),r.jsxs("div",{children:[r.jsx("span",{children:"升级享受更好体验，"}),r.jsx("span",{className:"text-black underline underline-offset-2",children:"去升级"})]})]})}):r.jsx("div",{className:"p-1",children:r.jsxs("div",{className:"space-y-2 bg-white2 p-2 rounded text-grey3 text-t4",children:[[T.block,T.capacity].map(j=>j.hidden?null:r.jsxs(Fe,{className:"w-full flex flex-col",placement:"right",arrow:!0,popupClass:"py-1 px-2",popup:j.popup,children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"whitespace-nowrap space-x-1",children:[r.jsx("span",{className:"text-black text-t2-medium",children:j.desc}),r.jsx(V,{size:"small",name:"IcQuestion"})]}),r.jsx("div",{className:"text-right line-clamp-1",children:j.rightDesc})]}),r.jsxs("div",{className:"flex items-center justify-center gap-2",children:[r.jsx("div",{className:"h-1 w-full rounded-full",style:{backgroundImage:j.backgroundImage}}),r.jsxs("div",{children:[j.progress,"%"]})]})]},j.popup)),r.jsxs("div",{className:"text-center text-t2-medium animate-click",onClick:()=>a(Mt.cataFile),children:[r.jsx("span",{children:"升级获取更多容量，"}),r.jsx("span",{className:"text-black underline underline-offset-2",children:"去升级"})]})]})})},Gq=qe(),Aje=()=>{const e=y.useRef(null),t=Dt(),n=ie(),s=async a=>{var c,d,u;const o=await ve.infra.getResourcesList(t.uuid,a.pageIndex,a.pageSize),i=(c=o.recordMap)==null?void 0:c.blocks;(d=o.recordMap)!=null&&d.blocks&&re(Tn.update({blocks:i})),(u=o.recordMap)!=null&&u.collectionViews&&re(kl.update(o.recordMap.collectionViews));const l=o.results.map(f=>({...f,nav:CM(i,f.blockId)}));return{list:l,more:l.length!==0}};return r.jsxs(Og,{uuid:t.uuid,children:[r.jsxs("div",{className:"flex items-center justify-between px-2.5 py-2 border-b text-t2-medium",children:[r.jsx("span",{children:"空间文件"}),r.jsx(V,{onClick:()=>n.closeModal(Gq),size:"middle",name:"IcToastClose",className:"animate-hover animate-click"})]}),r.jsx("div",{ref:e,className:"max-h-120 overflow-auto w-125 py-2 px-1",children:r.jsx(Qw,{className:"space-y-2",container:e,getApi:s,renderItem:a=>r.jsx(Rje,{...a})})})]})},Rje=y.memo(e=>{const t=ie(),{blockId:n,size:s,nav:a=[],fileName:o}=e,i=fh(),l=cr(n),c=fe(l==null?void 0:l.data.segments)||o||HB,{extName:d}=Cp(l==null?void 0:l.data.segments),u=()=>{i(n)},f=h=>{t.modal({content:p=>r.jsxs("div",{className:"flex flex-col h-[80vh] w-[80vw]",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 text-t1-medium bg-white1",children:[r.jsx("div",{children:"预览页面"}),r.jsx(V,{className:"animate-hover animate-click",size:"middle",name:"IcBannerClose",onClick:()=>p.onCloseModal()})]}),r.jsx("div",{className:"h-full w-full",children:r.jsx(tM,{id:h})})]})})};return r.jsxs("div",{className:"w-full py-1 px-2 space-x-2.5 flex items-center animate-hover animate-click",onClick:u,children:[r.jsx(V,{size:"xlarge",name:Ya(d)}),r.jsxs("div",{className:"w-4/5 space-y-1",children:[r.jsxs("div",{className:"max-w-full text-t2-medium space-x-2 flex items-center",children:[r.jsx("span",{className:"text-ellipsis",children:c}),r2(n)&&r.jsx("span",{className:"text-red text-t5 whitespace-nowrap",children:"回收站"})]}),r.jsxs("div",{className:"space-x-2 text-grey3 text-t4 flex items-center",children:[!!a.length&&r.jsx("div",{className:"space-x-0.5 flex items-center flex-wrap",children:a.map((h,p)=>r.jsxs(y.Fragment,{children:[r.jsx(Cs,{popup:"预览文件所处页面",onClick:g=>{g.stopPropagation(),f(h.uuid)},className:"text-t4 text-grey1 px-0.5 animate-hover animate-click flex-shrink-0",children:oI(m.BlockType.PAGE,h==null?void 0:h.data.segments)}),a.length!==p+1&&r.jsx("span",{children:"|"})]},h.uuid))}),r.jsx("div",{className:"text-grey3 text-t4",children:As(s)})]})]})]})}),Pje=()=>{const e=ie();return y.useCallback(()=>{e.modal({modalId:Gq,keyboard:!1,content:()=>r.jsx(Aje,{})})},[e])},Lje=()=>{var h;const e=fN(),t=Qu(),n=Mm(),{setCurrentSettingMenu:s,setIsFrom:a}=an(Ws),o=ie(),i=Ur(),l=Pje(),c=()=>{s(Kt.upgrade),a(Mt.dashboard_file)},d=y.useCallback(()=>{o.modal({modalId:Ve.CAPACITY_ORDER_LIST_ID,content:()=>r.jsx(Bje,{})})},[o]),u=y.useMemo(()=>{var _;const p=(_=t.spacePlan)!=null&&_.endAt?ue(t.spacePlan.endAt).format(Et):void 0,g=[{title:"基础容量",size:n.baseCapacity,rightPart:p||"免费容量"}];return n.peopleCapacity&&g.push({title:"席位容量",size:n.peopleCapacity,rightPart:p}),i&&g.push({title:"补充容量",size:n.buyCapacity+n.giveCapacity,desc:r.jsx("span",{className:"ml-1 text-active_color animate-click",onClick:()=>e(),children:"购买容量包"}),rightPart:r.jsxs("div",{className:"flex items-center justify-between animate-click",onClick:d,children:[r.jsxs("span",{className:"text-red mr-1",hidden:!n.expirationCapacity,children:[As(n.expirationCapacity)," 即将到期"]}),r.jsx("span",{className:"w-4",hidden:!!n.expirationCapacity}),r.jsx(V,{name:"IcArrowUnfold",size:"xxxsmall"})]})}),g},[(h=t.spacePlan)==null?void 0:h.endAt,i,d,e,n.baseCapacity,n.buyCapacity,n.expirationCapacity,n.giveCapacity,n.peopleCapacity]),f=y.useMemo(()=>{let p="";const g=As(n.maxCapacity);return n.isNovice&&(p="新手期限制容量 ".concat(g,"，完成入门任务解锁免费容量 2GB")),i||(p="免费版限制容量 ".concat(g,"，升级到解锁全部容量 300GB")),p?r.jsx("div",{className:"bg-active_color_10 text-active_color h-9 px-4 text-t3 flex items-center mt-2.5",children:p}):null},[i,n.isNovice,n.maxCapacity]);return r.jsxs(r.Fragment,{children:[r.jsx(Zn,{title:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{children:"空间储存容量"}),r.jsxs("div",{className:"flex items-center space-x-0.5 text-grey3 animate-click",onClick:l,children:[r.jsx("span",{children:"查看"}),r.jsx(V,{name:"IcArrowDown01",size:"tiny",className:"-rotate-90"})]})]}),description:r.jsx(qq,{type:"setting"}),rightPart:!i&&r.jsx(De,{onClick:c,children:"升级扩容"})}),r.jsx("div",{className:"px-4 py-2 rounded bg-grey9 select-none",children:u.map((p,g)=>r.jsxs("div",{className:"h-7 flex items-center justify-between text-grey3",children:[r.jsxs("div",{children:[p.title," ",As(p.size)," ",p.desc]}),r.jsx("div",{children:p.rightPart})]},g))}),f]})},Bje=()=>{const e=ie(),t=fN(),n=y.useRef(null),s=Dt(),a=Mm(),o=c=>{e.closeModal(Ve.CAPACITY_ORDER_LIST_ID),t({planId:c})},i=async c=>{const d=await ve.infra.capacityList(c.pageIndex,c.pageSize,s.uuid);return{list:d.list,more:d.list.length===c.pageSize}},l=a.giveCapacity>0;return r.jsxs("div",{className:"w-125 py-1",children:[r.jsxs("div",{className:"h-12 flex items-center justify-between px-7",children:[r.jsx("span",{className:"text-h4",children:"补充容量"}),r.jsx("span",{className:"text-t2 animate-click text-active_color",onClick:()=>o(),children:"购买容量包"})]}),r.jsx(dt.SettingDivider,{}),r.jsxs("div",{className:"px-7 text-t2",children:[r.jsxs("div",{className:"grid grid-cols-6 h-10 items-center",children:[r.jsx("span",{className:"col-span-2",children:"容量套餐"}),r.jsx("span",{className:"col-span-2",children:"使用状态"}),r.jsx("span",{className:"col-span-2",children:"到期时间"})]}),r.jsx(dt.SettingDivider,{}),r.jsxs("div",{ref:n,className:"max-h-80 overflow-y-auto",children:[l&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"grid grid-cols-6 h-10 items-center",children:[r.jsxs("span",{className:"col-span-2",children:[As(a.giveCapacity)," "]}),r.jsx("span",{className:"col-span-2",children:"使用中"}),r.jsx("span",{className:"col-span-2",children:"2023/12/31 23:59"})]})}),r.jsx(Qw,{container:n,getApi:i,placeholder:l?"":"无容量包记录",renderItem:c=>r.jsxs("div",{className:R("grid grid-cols-6 h-10 items-center",c.status!==20&&"opacity-30"),children:[r.jsxs("span",{className:"col-span-2",children:[c.planPriceUnit,"GB ",r.jsx("span",{className:"text-active_color animate-click ml-1",hidden:c.status!==20,onClick:()=>o(c.planId),children:"续费"})]}),r.jsx("span",{className:"col-span-2",children:c.status===20||c.expirationTime&&c.expirationTime<Date.now()?"使用中":"已过期"}),r.jsx("span",{className:"col-span-2",children:ue(c.expirationTime).format(On)})]},c.id)})]})]})]})},Oje=()=>{var p;const{setCurrentSettingMenu:e,setIsFrom:t}=an(Ws),n=Ur(),s=ba(),a=Dt(),o=Object.values(s),i=kd(),l=r.jsx("span",{className:"mx-4 text-grey3 text-t2",children:"|"}),{isMaxGuests:c,membersMaxLimit:d,memberMaxLimitDesc:u,guestMaxLimitDesc:f}=_c(),h=y.useMemo(()=>o.length>=d,[d,o.length]);return r.jsx(r.Fragment,{children:r.jsx(Zn,{title:"空间成员与外部协作者",description:r.jsx(dt.Item,{leftChild:r.jsxs("div",{className:"flex whitespace-nowrap mr-2",children:[r.jsxs("div",{children:["空间成员"," ",r.jsxs("span",{className:R(h&&"text-red"),children:[o.length,"/",u]})]}),l,r.jsxs("div",{className:"flex",children:["空间成员组"," ",r.jsx("span",{children:((p=a.permissionGroups)==null?void 0:p.length)||0})]}),l,r.jsxs("div",{children:["外部协作者"," ",r.jsxs("span",{className:R(c&&"text-red"),children:[i.length,n?"":"/".concat(f)]})]})]}),rightChild:r.jsx(De,{onClick:()=>{e(Kt.upgrade),t(Mt.dashboard_member)},children:"购买更多成员席位"})})})})},p_=({planType:e,color:t,right:n})=>r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:R("text-t3-medium py-px px-1.5 mr-2 rounded text-white",!t&&"text-grey3-base bg-[#A2A4A633]",t==="green"&&"bg-green",t==="purple"&&"bg-purple",t==="pink"&&"bg-pink_purple",t==="black"&&" bg-[#3D3D3D]"),children:Zo(e)}),r.jsx("div",{className:"text-t3 text-grey3",children:n})]}),Mje=()=>{const{spacePlan:e}=Qu(),{setCurrentSettingMenu:t,setIsFrom:n}=an(Ws),s=Dt(),a=Zw(),o=_c(),[i,l]=y.useMemo(()=>{const c=()=>{const d=ue(e==null?void 0:e.endAt).diff(ue(),"day");return r.jsxs(r.Fragment,{children:["有效期至 ",ue(e==null?void 0:e.endAt).format(Et),"，",r.jsxs("span",{className:d<=5?"text-red":"",children:["剩余 ",d," 天"]})]})};return s.planType===St.freePersonal?[r.jsx(p_,{planType:s.planType,right:o.blocksMaxLimit===1/0?void 0:"块数限制 ".concat(o.blocksMaxLimit,"，免费块剩余 ").concat(o.blocksStock," 个")}),r.jsx(De,{onClick:()=>{t(Kt.upgrade),n(Mt.dashboard_plan)},children:"升级使用更多功能"})]:s.planType==="personal"?[r.jsx(p_,{color:"green",planType:s.planType,right:r.jsxs(r.Fragment,{children:[c(),r.jsx("span",{hidden:!1,className:"text-active_color ml-2 animate-click",onClick:()=>a(St.pro,Mt.dashboard_plan),children:"立即续费"})]})})]:s.planType==="freeTeam"?[r.jsx(p_,{planType:s.planType,color:"pink",right:"块数限制 ".concat(o.blocksMaxLimit,"，免费块剩余 ").concat(o.blocksStock," 个")}),r.jsx(De,{onClick:()=>{t(Kt.upgrade),n(Mt.dashboard_plan)},children:"升级使用更多功能"})]:s.planType===St.smallTeam?[r.jsx(p_,{color:"purple",planType:s.planType,right:r.jsxs(r.Fragment,{children:[c(),r.jsx("span",{className:"text-active_color ml-2 animate-click",onClick:()=>a(St.smallTeam,Mt.dashboard_plan),children:"立即续费"})]})})]:s.planType===St.team?[r.jsx(p_,{color:"black",planType:s.planType,right:r.jsxs(r.Fragment,{children:[c(),r.jsx("span",{hidden:!1,className:"text-active_color ml-2 animate-click",onClick:()=>a(St.team,Mt.dashboard_plan),children:"立即续费"})]})})]:[]},[s.planType,e==null?void 0:e.endAt,t,n,a,o.blocksMaxLimit,o.blocksStock]);return r.jsxs(r.Fragment,{children:[r.jsx(Zn,{title:"空间计划"}),r.jsx(dt.Item,{leftChild:i,rightChild:l})]})},Uje=()=>r.jsxs(tB,{active:0,className:"w-[70vw] px-4 h-[500px]",childrenClassName:"h-[calc(100%-50px)]",children:[r.jsx(Sk,{title:"收支明细",children:r.jsx($je,{})}),r.jsx(Sk,{title:"提现记录",children:r.jsx(Vje,{})})]}),Vje=()=>{const[e,t]=y.useState();if(y.useEffect(()=>{ve.infra.getWithdrawOrderList(1,365,Ot()).then(s=>{t(s.list)})},[]),e===void 0)return null;const n=s=>{switch(s){case 0:return"可提现";case 1:return"已提现";default:return"已取消"}};return r.jsxs("div",{className:"h-full px-1 flex flex-col justify-between items-center overflow-y-hidden overscroll-x-auto flex-1",children:[r.jsxs("div",{className:"grid grid-cols-10 gap-x-2 w-full py-2.5 text-t2 border-b",children:[r.jsx("div",{className:"col-span-3",children:"记录内容"}),r.jsx("div",{className:"col-span-1",children:"状态"}),r.jsx("div",{className:"col-span-1",children:"金额"}),r.jsx("div",{className:"col-span-3",children:"收款帐户"}),r.jsx("div",{className:"col-span-2",children:"创建时间"})]}),r.jsxs("div",{className:"overflow-y-auto w-full h-full",children:[e.map((s,a)=>{var o,i,l,c,d;return s.total,r.jsxs("div",{className:"grid grid-cols-10 gap-x-2 w-full py-2.5 text-t2",children:[r.jsx("div",{className:"col-span-3 break-words",children:(o=s.description)!=null?o:"空"}),r.jsx("div",{className:"break-words col-span-1",children:r.jsx("div",{children:n(s.status)})}),r.jsxs("div",{className:"break-words col-span-1",children:[io(void 0),s.total]}),r.jsx(Fe,{className:"col-span-3",popup:Rn((i=s.userId)!=null?i:""),children:r.jsx("div",{className:"text-ellipsis",children:"".concat(Rn((l=s.userId)!=null?l:""),"(").concat((d=J.users[(c=s.userId)!=null?c:""])==null?void 0:d.phone,")")})}),r.jsx("div",{className:"break-words col-span-2",children:s.createdAt?ue(new Date(s.createdAt)).format(On):""})]},a)}),e.length===0&&r.jsx("div",{className:"text-t4 text-center text-grey3 mt-3",children:"暂无提现记录"})]})]})},$je=()=>{const[e,t]=y.useState();if(y.useEffect(()=>{ve.infra.getSharePaidRecords(Ot(),1,500).then(s=>{s.recordMap.blocks&&re(Tn.update({blocks:s.recordMap.blocks})),s.recordMap.users&&re(Ha.updateSpaceUsers({users:s.recordMap.users})),t(s.results)})},[]),e===void 0)return null;const n=s=>{switch(s){case 0:return"未付款";case 2:return"已取消";default:return"已支付"}};return r.jsxs("div",{className:"h-full px-1 flex flex-col justify-between items-center overflow-y-hidden overscroll-x-auto flex-1",children:[r.jsxs("div",{className:"grid grid-cols-10 gap-x-2 w-full py-2.5 text-t2 border-b",children:[r.jsx("div",{className:"col-span-3",children:"页面来源"}),r.jsx("div",{className:"col-span-1",children:"类型"}),r.jsx("div",{className:"col-span-1",children:"金额"}),r.jsx("div",{className:"col-span-3",children:"付款人"}),r.jsx("div",{className:"col-span-2",children:"创建时间"})]}),r.jsxs("div",{className:"overflow-y-auto w-full h-full",children:[e.map((s,a)=>{var o,i,l,c,d;return s.blockId,r.jsxs("div",{className:"grid grid-cols-10 gap-x-2 w-full py-2.5 text-t2",children:[r.jsx("div",{className:"col-span-3 break-words",children:r.jsx(Hje,{id:(o=s.blockId)!=null?o:""})}),r.jsx("div",{className:"break-words col-span-1",children:r.jsx("div",{children:n(s.status)})}),r.jsxs("div",{className:"break-words col-span-1",children:[io(void 0),s.total]}),r.jsx(Fe,{className:"col-span-3",popup:Rn((i=s.userId)!=null?i:""),children:r.jsx("div",{className:"text-ellipsis",children:"".concat(Rn((l=s.userId)!=null?l:""),"(").concat((d=J.users[(c=s.userId)!=null?c:""])==null?void 0:d.phone,")")})}),r.jsx("div",{className:"break-words col-span-2",children:s.createdAt?ue(new Date(s.createdAt)).format(On):""})]},a)}),e.length===0&&r.jsx("div",{className:"text-t4 text-center text-grey3 mt-3",children:"暂无收支明细"})]})]})},Hje=e=>{var i;const{illegal:t}=mt(e.id),s=ye(e.id,["data"],["segments"])?r.jsx(yl,{uuid:(i=e.id)!=null?i:""}):"无法访问",a=ys(),o=l=>{a(e.id,{forceOpenNewTab:!0})};return r.jsx(Nv,{id:e.id,title:s,illegal:t,onClick:o})},zje=()=>{const e=$q(),[t,n]=y.useState(),s=ie();return y.useEffect(()=>{const a=Ot();ve.infra.getTotalInWallet(a).then(n)},[]),t?r.jsx("div",{children:r.jsx(Zn,{title:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{children:"空间收益统计"}),r.jsxs("div",{className:"flex items-center space-x-0.5 text-grey3 animate-click",onClick:()=>{s.modal({content:()=>r.jsx(Uje,{})})},children:[r.jsx("span",{children:"查看收支记录"}),r.jsx(V,{name:"IcArrowDown01",size:"tiny",className:"-rotate-90"})]})]}),description:r.jsx("div",{className:"w-[360px]",children:r.jsxs("div",{className:"text-t2 px-4 py-2 bg-grey9 rounded space-y-2",children:[r.jsxs("div",{className:"text-t2-medium flex space-x-2",children:[r.jsx("span",{children:"可提现"}),r.jsx("span",{children:t.canWithdrawAmount})]}),r.jsxs(Cs,{popup:"5-7个工作日到账",className:"inline-flex space-x-2 cursor-help",children:[r.jsx("span",{className:"underline underline-offset-4",children:"待结算"}),r.jsx("span",{children:t.inProgressAmount})]}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("span",{children:"总收入"}),r.jsx("span",{children:t.totalAmount})]}),r.jsxs("div",{className:"text-t5-medium",children:[r.jsx("span",{children:"满10元可申请提现，每日限申请1次"}),r.jsx("a",{className:"ml-2 text-t5 underline",href:"https://flowus.cn/share/b4260aa6-d685-4e88-8b9b-0d15c21d60e2",target:"_blank",children:"了解费用详细说明"})]})]})}),rightPart:r.jsx(De,{colorType:"active",onClick:()=>e({type:"space",spaceId:Ot()}),children:"立即提现"})})}):null},qje=()=>{const e=Za(),{enableAI:t}=xr();return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:dt.commonStyles.container,children:[r.jsx(dt.Header,{title:"空间信息"}),r.jsxs("div",{className:"py-2.5",children:[r.jsx(Dje,{}),r.jsx(Mje,{}),r.jsx(zje,{}),r.jsx(Lje,{}),r.jsx(Oje,{}),t&&r.jsx(Sje,{})]})]}),r.jsx(dt.FooterBar,{cancelText:"关闭",cancel:()=>e()})]})},Gje=()=>{const{spaceSettingState:{commentAlignment:e}}=an(Ws),t=Dt(),n=g0(),s=ie(),a=o=>{s.dropdown({popcorn:o.currentTarget,placement:"bottom",content:({onCloseModal:i})=>r.jsx(Wje,{commentAlignment:e,onChangeCommentAlignment:l=>{i(),hn(()=>{n(t.uuid,{setting:{...t.setting,commentAlignment:l}})})}})})};return r.jsx(Zn,{title:"页面评论位置",description:"创建新页面时，评论默认位置",rightPart:r.jsxs("button",{className:"text-t2 text-black flex items-center",onClick:a,children:[e==="top"?"页面顶部":"页面底部",r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall",className:"ml-1"})]})})},Wje=e=>{const t=[{type:"top",title:"页面顶部"},{type:"bottom",title:"页面底部"}].map(n=>({type:H.OPERABLE_BLOCK_TEXT,data:{...n,selected:n.type===e.commentAlignment}}));return r.jsx(ze,{className:"rounded-r next-modal py-1.5 w-[160px]",items:t,onItemClick:n=>{e.onChangeCommentAlignment(n.data.type)}})},Kje=()=>{const{spaceSettingState:{startDay:e,setStartDay:t}}=an(Ws),n=ie(),s=a=>{n.dropdown({popcorn:a.currentTarget,placement:"bottom",content:()=>r.jsx(Yje,{startDay:e,setStartDay:t})})};return r.jsx(Zn,{title:"日期设置",description:"设置每周起始日，仅影响日历显示方式",rightPart:r.jsxs("button",{className:"text-t2 text-black flex items-center",onClick:s,children:[e===m.DaySetting.MON?"周一":"周日",r.jsx(V,{name:"IcArrowDown01",size:"xxxsmall",className:"ml-1"})]})})},Yje=({startDay:e,setStartDay:t})=>{const[n,s]=y.useState(e),a=[{type:m.DaySetting.MON,title:"周一"},{type:m.DaySetting.SUN,title:"周日"}].map(o=>({type:H.OPERABLE_BLOCK_TEXT,data:{...o,selected:o.type===n}}));return r.jsx(ze,{className:"rounded-r next-modal py-1.5 w-[120px]",items:a,onItemClick:o=>{s(o.data.type),t(o.data.type)}})},Xje=()=>{const{spaceSettingState:{disableFormNotification:e,setDisableFormNotification:t}}=an(Ws);return r.jsx(Zn,{title:"分享页通知提醒",description:"当分享页面有新增订阅或收集表提交表单时，工作空间中将收到通知",rightPart:r.jsx(en,{open:!e,onSwitch:n=>{t(!n)}})})},Qje=()=>{const{spaceSettingState:{showBackLink:e,setShowBackLink:t}}=an(Ws);return r.jsx(Zn,{title:"引用记录显示设置",description:"当前页面被其他页面引用时，显示引用记录",rightPart:r.jsx(en,{open:e,onSwitch:t})})},Jje=()=>{const e=Dt(),t=g0(),n=po(),s=s5(),a=y.useCallback(i=>{me.event("ad_switch_set",{is_open:i}),hn(()=>{t(e.uuid,{isShowAd:i})})},[e.uuid,t]),o=y.useMemo(()=>r.jsx(en,{open:s,onSwitch:a,disabled:n}),[n,s,a]);return r.jsx(Zn,{title:"分享页底部广告",showSpacePlan:!0,description:"关闭后，分享页面底部将不再显示广告",rightPart:o})},uk={[m.ShowInLinePageIconType.SHOW_ALL]:"显示所有图标",[m.ShowInLinePageIconType.SHOW_CUSTOM]:"仅显示自定义图标",[m.ShowInLinePageIconType.HIDE]:"隐藏图标"},Zje=()=>{const e=ie(),{spaceSettingState:t}=an(Ws),{inlinePageIcon:n,setInlinePageIcon:s}=t,a=o=>{e.dropdown({popcorn:o.currentTarget,content:i=>r.jsx(ze,{className:Ra,items:ka(uk).map(l=>({type:H.OPERABLE_BLOCK_TEXT,data:{key:l,selected:l===n,title:uk[l]}})),onItemClick:l=>{s(l.data.key),i.onCloseModal()}})})};return r.jsx(Zn,{title:"行内页面展示图标",description:"设置行内页面图标的显示和隐藏",rightPart:r.jsx(dt.DropdownButton,{onClick:a,content:uk[n]})})},e4e=({icon:e,setIcon:t})=>{const n=Dt(),s=ie(),a=Uo(),o=y.useCallback(i=>{i.preventDefault(),i.stopPropagation(),s.dropdown({popcorn:i.currentTarget,placement:"bottom",content:({onCloseModal:l})=>r.jsx(_N,{showRecently:!1,onSelectCustomIcon:(c,d)=>{d||l(),t({type:"icon",value:c})},onSelectEmoji:(c,d)=>{d||l(),t({type:"emoji",value:c})},onUploadFile:c=>{l(),be.loading({key:vu.UPLOAD_ICON,content:"头像上传中..."}),a({file:c,type:"public",searchType:"spaceIcon",onComplete:d=>{be.closeMessage(vu.UPLOAD_ICON),d.success&&(be.success("上传完成"),t({type:"upload",value:d.ossName}))}})},onRemoveBtnClick:()=>{t({}),l()}})})},[s,t,a]);return r.jsx(r.Fragment,{children:r.jsxs("div",{className:"mt-4 flex flex-row items-center justify-between",children:[r.jsx("div",{className:"mb-3.5 rounded-md border border-black_006 p-1",children:r.jsx(ar,{name:n.title,color:n.backgroundColor,icon:e,iconSize:50,className:"!h-[50px] w-[50px]",style:{fontSize:"30px"}})}),r.jsxs("div",{className:"flex space-x-5",children:[e&&r.jsx(De,{onClick:()=>t({}),children:"移除空间头像"}),r.jsx(De,{onClick:o,children:"上传空间头像"})]})]})})},t4e=()=>{const{spaceSettingState:{domain:e="",checkDomain:t,domainStatus:n}}=an(Ws),s=y.useMemo(()=>{switch(n){case ro.CHECKING:return r.jsxs("div",{className:"text-t4 flex items-center opacity-100 transition-all",children:[r.jsx(V,{className:"text-grey4 ml-2.5 mr-1 animate-spin align-middle text-xl leading-none",name:"IcNaviLoading",size:"middle"}),r.jsx("span",{className:"text-grey4 whitespace-nowrap",children:"检测中..."})]});case ro.CAN_USE:return r.jsxs("div",{className:"text-t4 text-active_color flex items-center opacity-100 transition-all",children:[r.jsx(na,{className:"ml-2.5 mr-1",iconSize:14,emojiStr:"👌",disableHover:!0}),r.jsx("span",{className:"whitespace-nowrap",children:"域名可用"})]});case ro.CAN_NOT_USE:return r.jsxs("div",{className:"text-t4 text-red flex items-center opacity-100 transition-all",children:[r.jsx(na,{className:"ml-2.5 mr-1",iconSize:14,emojiStr:"⚠️",disableHover:!0}),r.jsx("span",{className:"whitespace-nowrap",children:fT[ro.CAN_NOT_USE]})]});case ro.LEN_NOT_RIGHT:return r.jsxs("div",{className:"text-t4 text-red flex items-center opacity-100 transition-all",children:[r.jsx(na,{className:"ml-2.5 mr-1",iconSize:14,emojiStr:"⚠️",disableHover:!0}),r.jsx("span",{className:"whitespace-nowrap",children:fT[ro.LEN_NOT_RIGHT]})]});default:return null}},[n]);return r.jsxs(r.Fragment,{children:[r.jsx(Zn,{title:"空间域名",description:"页面分享链接支持自定义域名，且旧链接仍然生效。链接将显示为：".concat(dw,"/").concat(e)}),r.jsxs("div",{className:"mt-2 flex items-center",children:[r.jsx("div",{className:"bg-grey8 text-t2 border-grey6 relative flex w-80 items-center rounded-sm border",children:r.jsx("input",{spellCheck:!0,placeholder:"请输入英文域名",className:"text-t2 h-7.5 placeholder-grey4 w-full flex-grow cursor-text bg-transparent px-2 align-middle text-black outline-none",value:e,maxLength:31,onChange:a=>{const o=a.target.value.trim();/^[a-z0-9_-]*$/.test(o)&&t(a.target.value.trim())}})}),s]})]})},n4e=()=>{const{spaceSettingState:{domain:e="",publicHomePage:t="",setPublicHomePage:n,setShowPublicHomePage:s,showPublicHomePage:a}}=an(Ws),o=Dt(),[i,l]=y.useState(""),[c,d]=y.useState("设置任意公开分享中的页面为公开主页"),[u,f]=y.useState(!1),[h,p]=y.useState(!1),{setCurrentSettingMenu:g}=an(Ws),[_,x]=y.useState([]),F=y.useRef([]),b=ye(t,["data"],["segments"]),w=!!b,[E,C]=y.useState(!1),k=po(),T=Sw(b==null?void 0:b.spaceId),v=px(),I=(e||"").trim(),j=u&&!I,S=[I||"英文域名",dw].join("."),D=df(),A=()=>{Xt(S)},P=y.useMemo(()=>qn(async L=>{if(!L){x(F.current);return}C(!0);const{results:O,recordMap:$}=await ve.infra.searchDocs(o.uuid,{query:L,filters:{isPublic:!0,isTitleOnly:!0},perPage:50,page:1});if(C(!1),O.length&&$){const M=$.blocks;M&&(re(Tn.update({blocks:M})),x(O.map(({uuid:U})=>M[U])))}else x([])},200),[o.uuid]);return y.useEffect(()=>{P(i)},[P,i]),y.useEffect(()=>{if(u&&F.current.length===0){const O=Hw(J.blocks,o.uuid).filter($=>{const M=J.blocks[$];return M?M.permissions.some(U=>U.type===m.PermissionType.PUBLIC):!1});F.current=O.map($=>J.blocks[$]),x(F.current)}},[u,I,o.uuid,i]),y.useEffect(()=>{t&&!w&&Db(t).then(L=>{L.code===200&&re(Tn.update({blocks:{[L.data.uuid]:L.data}}))})},[w,t]),r.jsxs(r.Fragment,{children:[r.jsx(Zn,{title:"公开主页",showSpacePlan:!0,from:Mt.homepage,description:r.jsxs("div",{className:"flex items-center",children:["访问",I?r.jsx(Fe,{popup:"点击复制链接",className:"animate-hover mx-1 px-0.5 underline",onClick:A,children:S}):" ".concat(S," "),"即可查看当前空间的公开主页"]})}),b?r.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(Fn,{className:"mr-1",blockId:t,trigger:!1}),r.jsx(Fu,{to:"".concat(T,"/").concat(b.uuid),className:"text-t1 animate-hover px-2",children:fe(b.data.segments)||qt(b.type)})]}),r.jsx(De,{onClick:()=>n(""),children:"移除"})]}):r.jsx(h0,{visible:h,onChange:p,placement:"bottom-start",content:I?r.jsx("div",{className:"next-modal mt-1 w-60 py-2",children:E?r.jsx("div",{className:"text-t3 text-grey3 flex items-center px-2",children:r.jsx($s,{size:"middle"})}):_.length===0?r.jsx("div",{className:"text-t3 text-grey3 px-2",children:i?"无相关结果":"暂无公开分享中的页面"}):r.jsx(ze,{onItemClick:L=>{n(L.data.uuid),p(!1),l("")},items:_.map(L=>({type:H.SEARCH,data:{uuid:L.uuid,title:fe(L.data.segments)||qt(L.type),icon:L.data.icon,type:L.type,backgroundColor:L.backgroundColor,navs:v(L.uuid)}}))})}):r.jsx(r.Fragment,{}),children:r.jsxs("div",{className:"bg-grey8 text-t2 border-grey6 mt-4 flex w-full items-center rounded-sm border",children:[u&&I&&r.jsx(V,{size:"normal",name:"IcSearch",className:"text-grey4 ml-3"}),r.jsx("input",{spellCheck:!0,onFocus:()=>{if(k){D(()=>{g(Kt.upgrade)});return}d(I?"搜索公开分享中的页面":"请先设置空间域名👆"),f(!0),p(!0)},onBlur:()=>{d("设置任意公开分享中的页面为公开主页"),f(!1)},placeholder:c,className:R("text-t2 h-7.5 placeholder-grey4 w-full flex-grow cursor-text bg-transparent px-2 align-middle text-black outline-none",{"placeholder:text-red caret-transparent":j}),value:i,onChange:L=>{if(j)return;const O=L.target.value.trim();l(O)}})]})}),r.jsxs("div",{className:"flex items-center justify-between mt-3.5",children:[r.jsx("div",{className:"text-t3 text-grey3",children:"允许从任意分享页面访问公开主页"}),r.jsx(en,{open:!!a,onSwitch:L=>{s(L)}})]})]})},s4e=()=>{const{spaceSettingState:{spaceName:e,setSpaceName:t,saveSpaceSetting:n}}=an(Ws);return r.jsxs(r.Fragment,{children:[r.jsx(dt.SettingDivider,{className:"mb-2.5"}),r.jsx("div",{className:dt.commonStyles.name,children:"空间名"}),r.jsx(Ct,{...Gs(Hs.settingSpaceInput),maxLength:20,placeholder:"请输入空间名，长度需在2-20个字符之间",className:dt.commonStyles.input,value:e||"",onChange:s=>t(s||""),onEnter:n})]})},r4e=()=>{const{spaceSettingState:{abandonedPublicShare:e,abandonedGuest:t,abandonedExport:n,openWatermark:s,openImageWatermark:a,imageWatermarkText:o,setImageWatermarkText:i}}=an(Ws),l=Dt(),c=g0(),d=!h1(l.planType);return r.jsxs("div",{className:"mt-4",children:[r.jsx(dt.SettingDivider,{}),r.jsx(Zn,{showUpgradeDialog:d,showSplitLine:!1,showSpacePlan:!0,from:Mt.space_security,upgradeTip:"升级「团队版」可使用安全性选项功能",title:r.jsx(ul,{showBuildin:!0,iconClassName:"pointer-events-none",popup:"升级「团队版」可使用安全性选项功能",children:"安全性选项"}),titleClassName:"text-t1-medium text-red"}),r.jsx(Zn,{className:"mt-0",showSplitLine:!1,title:"禁止页面公开分享",description:"开启后，团队空间所有页面（包括个人页面）均无法开启分享(已开启分享的页面不受影响)",rightPart:r.jsx(Fe,{popup:"仅管理员可设置",delay:1500,children:r.jsx(en,{disabled:d,open:e,onSwitch:u=>{hn(()=>{c(l.uuid,{setting:{...l.setting,abandonedPublicShare:u}})})}})})}),r.jsx(Zn,{showSplitLine:!1,title:"禁止添加外部协作者",description:"开启后，团队空间所有页面（包括个人页面）都不允许邀请外部协作者进行查看和编辑(已邀请过的协作者不受影响)",rightPart:r.jsx(Fe,{popup:"仅管理员可设置",delay:1500,children:r.jsx(en,{disabled:d,open:t,onSwitch:u=>{hn(()=>{c(l.uuid,{setting:{...l.setting,abandonedGuest:u}})})}})})}),r.jsx(Zn,{showSplitLine:!1,title:"禁止导出",description:"开启后，空间所有成员将不能导出页面",rightPart:r.jsx(Fe,{popup:"仅管理员可设置",delay:1500,children:r.jsx(en,{disabled:d,open:n,onSwitch:u=>{hn(()=>{c(l.uuid,{setting:{...l.setting,abandonedExport:u}})})}})})}),r.jsx(Zn,{showSplitLine:!1,title:"空间水印",description:"开启后，页面背景会有「用户昵称 - 手机尾号后4位」的水印标识",rightPart:r.jsx(Fe,{popup:"仅管理员可设置",delay:1500,children:r.jsx(en,{disabled:d,open:s,onSwitch:u=>{hn(()=>{c(l.uuid,{setting:{...l.setting,openWatermark:u}})})}})})}),r.jsx(Zn,{showSplitLine:!1,title:"图片水印",description:r.jsxs("span",{children:["开启后，",r.jsx("span",{className:"text-black text-t3-medium",children:"分享页"}),"的图片会加上水印标识",a&&r.jsx(Ct,{focusWidthBorder:!1,maxLength:20,placeholder:"请输入文字水印",className:"w-full h-7 mt-2 ",inputClassName:"text-grey3",value:o,onChange:u=>{i(u)}})]}),rightPart:r.jsx(Fe,{popup:"仅管理员可设置",delay:1500,children:r.jsx(en,{disabled:d,open:a,onSwitch:u=>{hn(()=>{c(l.uuid,{setting:{...l.setting,openImageWatermark:u}})})}})})})]})},a4e=()=>{const{spaceSettingState:{enableRecommend:e,setRecommend:t}}=an(Ws),n=Dt();return eI(n.planType)?null:r.jsx(Zn,{title:"智能推荐模版",description:"关闭后，新建空白页面将不进行相关模板推荐",rightPart:r.jsx(en,{open:e,onSwitch:t})})},o4e=()=>{const e=Za(),{spaceSettingState:t}=an(Ws),{saveSpaceSetting:n,leavingSpace:s,handleDeleteSpace:a,isLastEditorUser:o,icon:i,setIcon:l,spaceEditor:c,isGuest:d,freeTeam:u}=t;return c?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:dt.commonStyles.container,children:[r.jsx(dt.Header,{title:"空间设置",name:"空间头像"}),r.jsx(e4e,{icon:i,setIcon:l}),r.jsx(s4e,{}),r.jsx(t4e,{}),r.jsx(n4e,{}),r.jsx(Kje,{}),r.jsx(Xje,{}),r.jsx(Jje,{}),r.jsx(Qje,{}),r.jsx(Gje,{}),r.jsx(r4e,{}),r.jsx(a4e,{}),r.jsx(Zje,{}),r.jsxs("div",{className:"mt-4 flex justify-end",children:[u&&!o&&r.jsx(De,{className:"mr-5",...Gs(Hs.settingSpaceDelete),onClick:s,children:"离开空间"}),r.jsx(De,{...Gs(Hs.settingSpaceDelete),colorType:"red",className:"mb-10",onClick:a,children:"删除空间"})]})]}),r.jsx(dt.FooterBar,{cancel:()=>e(),confirm:n})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:dt.commonStyles.container,children:[r.jsx(dt.Header,{title:"空间设置"}),r.jsx("div",{className:"text-t3 text-grey3 mt-2",children:d?"当前为「外部协作者」身份，如需查看更多空间设置，可联系空间管理员将你升级为「空间成员」":"当前为「空间成员」身份，如需查看更多空间设置，可联系空间管理员将你升级为「空间管理员」"}),r.jsx(De,{onClick:s,className:"text-t2-medium mt-5 ml-auto",children:"离开空间"})]}),r.jsx(dt.FooterBar,{cancel:()=>e(),cancelText:"关闭"})]})},Wq=()=>{const e=Pn(),{spacePlan:t}=Qu(),{blocksMaxLimit:n}=_c(),s=ue(t==null?void 0:t.endAt).format("YYYY.MM.DD");return{content:y.useMemo(()=>{const o="有效期至".concat(s);let i=r.jsx(r.Fragment,{children:o});return e.planType===St.smallTeam&&(i=r.jsx(r.Fragment,{children:o})),e.planType===St.freeTeam&&(i=r.jsx(r.Fragment,{children:"，免费块数".concat(n,"，升级获得无限块和更多空间存储容量")})),e.planType===St.freePersonal&&(i=r.jsx(r.Fragment,{children:"".concat(o)})),i},[n,e.planType,s]),currentSpace:e,timeFormat:s}},i4e=()=>{const e=Zw(),t=Ur(),{currentSpace:n}=Wq(),s=(n==null?void 0:n.planType)===St.team;return y.useCallback(()=>{e(t&&s?St.team:St.pro)},[t,s,e])},l4e=()=>{const{memberMaxLimitDesc:e}=_c(),t=i4e(),{content:n,currentSpace:s}=Wq();return s?r.jsxs("div",{className:"text-t2 h-10 flex items-center space-x-2 text-grey3 flex-shrink-0",children:[r.jsxs("div",{className:"whitespace-nowrap space-x-2",children:[r.jsx("span",{children:"当前版本"}),r.jsxs("span",{className:"text-t2-bold text-black",children:[Zo(s.planType),"空间"]}),r.jsx("span",{children:"席位"}),r.jsx("span",{className:"text-t2-bold text-black",children:e})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{children:n}),r.jsx(De,{onClick:t,children:"购买更多成员席位"})]})]}):null},c4e=()=>{const e=Mm(),t=Q0(),n=Ur(),{enableAI:s}=xr(),a=n?"":"升级可享用无限使用次数",o=()=>{t({isFrom:Mt.package})};return r.jsxs(r.Fragment,{children:[r.jsx(l4e,{}),r.jsx(dt.SettingDivider,{className:"mb-2.5"}),s&&r.jsxs(r.Fragment,{children:[r.jsx(dt.Item,{leftChild:pm,rightChild:n?"无限次":""}),!n&&r.jsx(dt.Item,{leftChild:"已使用 ".concat(e.usage,"次/").concat(e.aiRestUsage,"次"),rightChild:n?r.jsx(r.Fragment,{}):r.jsxs(De,{onClick:o,children:["购买 ",B_]})}),!n&&r.jsx(dt.Item,{leftChild:"购买 ".concat(B_,"，空间每日使用上限可拓展至最少100次；").concat(a)}),r.jsx(dt.SettingDivider,{className:"mt-2.5 mb-5"})]})]})},d4e=c4e,u4e=()=>{const{upgradeAiPanel:e,setUpgradeAiPanel:t}=an(Ws),n=dN(),s=Za(),a=y.useMemo(()=>e?r.jsx(m4e,{}):r.jsx(f4e,{}),[e]);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:R(dt.commonStyles.container,"pb-0 px-[30px]"),children:[r.jsx(dt.Header,{title:r.jsxs("div",{className:R("flex items-center",e&&"animate-click"),onClick:()=>t(!1),children:[e&&r.jsx(V,{name:"IcArrowDateBack",size:"middle"}),r.jsx("span",{children:"空间升级"})]}),addonAfter:r.jsx("div",{className:"text-active_color animate-click",onClick:n,children:"空间激活码"})}),a]}),r.jsx(dt.FooterBar,{cancelText:"关闭",cancel:()=>s()})]})},f4e=()=>{const e=Dt(),{isFrom:t}=an(Ws),{enableAI:n}=xr();return y.useEffect(()=>{me.event("package_show",{is_from:t===Mt.package?"set":t})},[e.uuid]),r.jsxs(r.Fragment,{children:[n&&r.jsx(d4e,{}),r.jsx("div",{className:"border border-grey5 mb-5",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsx(qoe,{})})})]})},m4e=()=>{const{switchPayType:e,setSwitchPayType:t}=CO({defaultTimeType:"month"}),n=Vw(),s=Q0(),[a,o]=y.useState([]),i=Kae(e),l=y.useCallback(u=>a.find(f=>f.monthNum===u),[a]),c=y.useMemo(()=>{var u;return(u=l(e==="year"?12:1))==null?void 0:u.currentPrice},[e,l]);y.useEffect(()=>{ve.infra.aiUsagePlanList(Ot()).then(u=>{u.list&&o(u.list)})},[]);const d=y.useMemo(()=>[{title:"免费权益",price:"0",unit:"/空间/".concat(i),btn:n?null:r.jsx(De,{disable:!0,className:"w-full",children:"当前版本"})},{title:"专业权益",price:c,unit:"/空间/".concat(i),btn:r.jsx(De,{colorType:"active",className:"w-full",onClick:()=>s(),children:n?"续费":"升级"})}],[i,n,c,s]);return r.jsxs("div",{className:"border mt-2.5",children:[r.jsxs("div",{className:R("grid grid-cols-3 h-44 divide-x border-b opacity-0 transition-opacity",a.length&&"opacity-100"),children:[r.jsx(kO,{payType:e,onSwitch:t}),d.map((u,f)=>r.jsxs("div",{className:R("p-2.5 space-y-5",f%2===0&&"bg-black_003"),children:[r.jsx("div",{className:"text-h4 text-black",children:u.title}),r.jsxs("div",{children:[r.jsxs("span",{className:"text-h2 text-black",children:["$",u.price]}),r.jsx("span",{className:"text-grey4 ml-1",children:u.unit})]}),u.btn]},u.title))]}),r.jsx(GO,{type:"ai"})]})},h4e=()=>{const e=Nd(),t=Za(),{clickMaskClose:n,currentSettingMenu:s}=Jw(),a=Dt(),o=$w(),[i,l]=y.useState(!1),c=y.useCallback(()=>{n&&t()},[n,t]);return y.useEffect(()=>{const d=u=>{Ie("esc")(u)&&(u.stopPropagation(),u.preventDefault(),c())};return document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}},[c]),y.useEffect(()=>{o(a.uuid),a.permissions&&O0(a.uuid),l(!0)},[]),y.useEffect(()=>{e()},[e]),y.useEffect(()=>t,[t]),i?r.jsx("div",{className:"flex justify-center items-center w-screen h-screen",onClick:c,onMouseDown:d=>d.stopPropagation(),children:r.jsxs("div",{className:"flex overflow-y-auto w-[85vw] h-[85vh] min-h-[300px] max-w-[1200px] max-h-[700px] next-modal",onClick:d=>d.stopPropagation(),children:[r.jsx(ANe,{}),r.jsxs("div",{className:"flex relative flex-col pt-2.5 w-full h-full text-t2 overflow-x-hidden min-w-[550px]",children:[s===Kt.account&&r.jsx(DNe,{}),s===Kt.general&&r.jsx(GNe,{}),s===Kt.integral&&r.jsx(uje,{}),s===Kt.profit&&r.jsx(Eje,{}),s===Kt.spaceInfo&&r.jsx(qje,{}),s===Kt.space&&r.jsx(o4e,{}),s===Kt.members&&r.jsx(yje,{}),s===Kt.upgrade&&r.jsx(u4e,{}),s===Kt.sharePage&&r.jsx(vje,{}),s===Kt.order&&r.jsx(bje,{})]})]})}):null},p4e=e=>{const t=ie(),n=oae(),s=y.useCallback(a=>{t.modal({modalId:Ve.SETTING,autoClose:!1,forceUpdate:!0,containerClassName:"!overflow-hidden",disableDefaultStyle:!0,closeAfterCallBack:()=>{eN("$settingState",{open:!1})},content:()=>r.jsx(Ws,{...a,children:r.jsx(h4e,{})})})},[t]);return y.useEffect(()=>{n.open?s(n):t.closeModal(Ve.SETTING)},[n]),r.jsx(r.Fragment,{children:e.children})},g4e=(e,t,n)=>{const s=Id(),a=m9();return Ce(({blocks:o})=>_4e(e,t,o,s,n),[e,t,a,s==null?void 0:s.sharePages,n])},_4e=(e,t,n,s,a)=>{const o=Hw(n,e),i=new Set([...o,...xt.$sharedPages]),l=[],c=[],d=[];i.forEach(f=>{const h=n[f];if(!h||h.status!==m.BlockStatus.NORMAL)return;const{roleWithoutPublic:p}=mn(f);if(p===m.PermissionRole.NONE)return;const{permissions:g}=h,_=k5(g.filter(b=>b.role!==m.PermissionRole.NONE));if(h.parentId!==h.spaceId){d.push(f);return}const x=_.find(b=>b.type===m.PermissionType.SPACE);if(!a&&x){l.push(f);return}if(_.find(b=>b.userId===t)&&_.length===1){c.push(f);return}d.push(f)});const u=[];return s&&s.sharePages.forEach(f=>d.includes(f)&&u.push(f)),d.forEach(f=>!u.includes(f)&&u.push(f)),{team:l,person:c,share:u}},x4e=()=>{var c,d;const e=Dt(),t=Ut(),n=ai(),s=g4e(e.uuid,t.uuid,n),a=localStorage.getItem("tryPageId"),o=s.team.concat(s.person),i=o.findIndex(u=>u===a);return(d=(c=o[i+1])!=null?c:o[0])!=null?d:""},y4e=({errorMessage:e})=>{const t=x4e(),n=ug(),s=()=>{ts("tryPageId",t),gs.check?Zp(Ca.Reload):Er("/".concat(t))},a=()=>{n()};return r.jsxs("div",{className:"fixed flex-col left-0 top-0 w-full h-full flex items-center justify-center z-50 bg-white1",children:[r.jsxs("p",{hidden:gs.check,children:["出现意外错误。请确保浏览器没有开启广告插件，或已将",Na,"加入至广告插件白名单内"]}),e&&r.jsx("p",{className:"px-20 my-4 select-text max-h-[20vh] overflow-auto",children:e}),r.jsx(De,{colorType:"primary",className:"mb-5 w-52",onClick:s,children:"重新加载"}),r.jsx(De,{colorType:"black",className:"w-52",onClick:a,children:"清理缓存"})]})},b4e=e=>{const{children:t}=e,[n,s]=y.useState("");return r.jsx(xY,{onError:a=>s(JSON.stringify(a.stack)),fallback:r.jsx(y4e,{errorMessage:n}),children:r.jsx(y.Suspense,{fallback:r.jsx(xs,{fixed:!0}),children:t})})},F4e=()=>{y.useEffect(()=>{if(!gs.check)return;const e=t=>{var s;const{className:n}=t.target;(s=n==null?void 0:n.includes)!=null&&s.call(n,"drag-container")&&Zp(Ca.Zoom)};return document.addEventListener("dblclick",e,!0),()=>{document.removeEventListener("dblclick",e,!0)}},[])},w4e=()=>{F4e();const e=m4(),{pathname:t}=_d(),n=ie();y.useEffect(()=>{const s=async()=>{const a=await Eb(Ca.IsFullScreen);a&&q1&&be.success("已切换全屏，按F11退出全屏模式"),hy({isFullscreen:a})};xh(Ca.OnFullScreenToggle,s),xh(Ca.UpdateDownloadComplete,()=>{hy({isUpdateReload:!0})}),xh(Ca.UpdateAvailable,()=>{hy({isUpdateAvailable:!0})}),xh(Ca.UpdateNotAvailable,()=>{hy({isUpdateAvailable:!1})}),s()},[]),y.useEffect(()=>{Zp(Ca.CheckForUpdates),xh(Ca.Log,(s,...a)=>{console.log(a)}),xh(Ca.Message,(s,...a)=>{console.log(a)})},[]),y.useEffect(()=>{},[e,n]),y.useEffect(()=>{gs.check&&(console.log("当前版本号",e),console.log("当前页面路径",t))},[e,t])},E4e=()=>{y.useEffect(()=>{let e=setTimeout(()=>{},0);const t=()=>{st({$isCtrlKeyDown:!1}),clearTimeout(e)},n=a=>{a==null||a.preventDefault(),t(),Ht.removeEventListener("keyup",n)},s=a=>{if(Ie(["mod","ctrl"],{byKey:!0})(a)){if(xt.$isCtrlKeyDown)return;t(),e=setTimeout(()=>{a.preventDefault(),st({$isCtrlKeyDown:!0})},300),Ht.addEventListener("keyup",n)}else t(),n()};return Ht.addEventListener("keydown",s),Ht.addEventListener("blur",n),()=>{clearTimeout(e),st({$isCtrlKeyDown:!1}),Ht.removeEventListener("keydown",s),Ht.removeEventListener("keyup",n),Ht.removeEventListener("blur",n)}},[])},C4e=()=>{const e=ie(),t=_o(),n=(s=Ot())=>{e.warning({modalId:Ve.MAXIMUM_CAPACITY_DIALOG,title:"试用块数已达上限",confirmText:"升级获得无限块",forceUpdate:!0,maxWidth:350,colorType:"active",footer:r.jsxs("div",{className:"text-t3 text-grey3 mt-2.5",children:["块数量每15分钟自动更新，你可以",r.jsx("span",{className:"mx-0.5 animate-click underline underline-offset-2",onClick:async()=>{be.loading({key:"refreshCount",content:"正在刷新计数"}),await bI(s),be.closeMessage("refreshCount"),be.success("刷新计数成功"),e.closeModal(Ve.MAXIMUM_CAPACITY_DIALOG)},children:"刷新计数"}),"后重试"]}),confirm:()=>{if(s!==Ot()){be.success("正在切换空间，稍等片刻...");const a=new URLSearchParams;a.set(dn.spaceId,s),a.set(dn.openDialog,Hb.openUpgradeSpace),window.location.href="".concat(window.location.origin,"?").concat(a.toString());return}t({from:Mt.spaceSetBlock,defaultMenuType:Kt.upgrade})}})};y.useEffect(()=>{xn.on("modalId",({modalId:s,spaceId:a})=>{es(100).then(()=>{switch(s){case Ve.MAXIMUM_CAPACITY_DIALOG:n(a);break}})})},[])},k4e=()=>{y.useEffect(()=>{const e=qn(n=>{const{offsetWidth:s,offsetHeight:a}=n.target;st({$isMobileSize:s<=640,$bodyHeight:a,$bodyWidth:s})},500,{leading:!0,trailing:!0});return Ku.observe(document.body,e)},[])},T4e=e=>{const t=i3.inviteCode.get(),n=o3(Kp.SHARE_INVITE_PAGE_ID);t&&ve.infra.claimExclusiveCoupon.raw({inviteCode:t.slice(0,6),newUser:e,sharePageId:n})},v4e=()=>{const e=sne(),t=Nd();return y.useCallback(async(n=!1)=>{const s=await t();if(s.code===200){T4e(!1),s.data.uuid&&(ts(KY,s.data.uuid),me.login(s.data.uuid));const a=await H9(Nb|jb|Sb,!1,n);return n||e(),a}n||e()},[t,e])},I4e=()=>{y.useEffect(()=>{const e=document.querySelector("#splash");e&&setTimeout(()=>{e.remove()},300)},[])};var Qh=(e=>(e[e.NONE=0]="NONE",e[e.TRANSFERRING=1]="TRANSFERRING",e[e.SOME_FAIL=2]="SOME_FAIL",e[e.ALL_SUCCESS=3]="ALL_SUCCESS",e))(Qh||{});const ARe={3:{name:"IcSuccess",color:"#3BD65D"},2:{name:"IcError",color:"#EB5757"},1:{name:"IcLoading",color:"#18A0FB"},0:{name:"",color:"#18A0FB"}},N4e=()=>{const{succeeded:e,failed:t,transferring:n}=j4e();return n>0?Qh.TRANSFERRING:t>0?Qh.SOME_FAIL:e>0?Qh.ALL_SUCCESS:Qh.NONE},j4e=()=>{const{succeeded:e,failed:t,transferring:n,tasks:s}=S4e(),{succeeded:a,failed:o,transferring:i,tasks:l}=D4e(),{succeeded:c,failed:d,transferring:u,tasks:f}=A4e(),{succeeded:h,failed:p,transferring:g,tasks:_}=R4e(),x=[...s,...l,...f,..._].sort((F,b)=>!F.createdAt||!b.createdAt?0:b.createdAt-F.createdAt);return{succeeded:e+a+c+h,transferring:n+i+u+g,failed:t+o+d+p,tasks:x}},S4e=()=>{const e=mte(),t=Object.keys(e);let n=0,s=0,a=0;const o=[];return t.forEach(i=>{const l=e[i];if(l&&l.createdAt&&l.inTransferList){switch(l.status){case is.failure:a++;break;case is.uploading:s++;break;case is.success:n++;break}o.push({id:l.key,createdAt:l.createdAt,taskType:"upload"})}}),{transferring:s,succeeded:n,failed:a,tasks:o}},D4e=()=>{const e=nd(()=>du.onChange.pipe(sd(()=>du.tasks)),du.tasks),t=e.map(n=>({id:n.id,taskType:"download",createdAt:n.startTime*1e3}));return{succeeded:e.filter(n=>n.state==="completed").length,transferring:e.filter(n=>n.state==="progressing").length,failed:e.filter(n=>n.state==="interrupted").length,tasks:t}},A4e=()=>({transferring:0,succeeded:0,failed:0,tasks:[]}),R4e=()=>({transferring:0,succeeded:0,failed:0,tasks:[]}),P4e=()=>{const{pathname:e}=_d(),t=hN(),n=N4e(),s=xw();y.useEffect(()=>{if(s||n!==Qh.NONE)return;const a=ue().diff(xt.$lastRefreshTime,"hours");(xt.$readyUpdate||a>=24)&&(gs.check?Zp(Ca.Reload):location.reload())},[e]),y.useEffect(()=>{if(t)return()=>{}},[t])},Kq=K1("$screenLock",()=>({enable:!1})),L4e=Qs(Kq),B4e=()=>Kq(e=>e.enable);var $d=(e=>(e.CLOSE_CHAT_PANEL="CLOSE_CHAT_PANEL",e.OPEN_UPGRADE_AI="OPEN_UPGRADE_AI",e.OPEN_UPGRADE_SPACE="OPEN_UPGRADE_SPACE",e.OPEN_BLOCK_PAGE="OPEN_BLOCK_PAGE",e.UPLOAD_FILE="UPLOAD_FILE",e.CHAT_PANEL_WIDTH="CHAT_PANEL_WIDTH",e.SEND_QUESTION="SEND_QUESTION",e))($d||{});const pS=Mr(!1);Mr(!1);Mr(!0);const Yq=e=>typeof e=="string"&&e.includes("right"),gS=()=>pp(pS),_S=()=>So(pS),Xq=()=>ea(pS),O4e=()=>{const e=_S(),t=Q0(),n=ya(),s=ys(),a=jd(),o=_g();y.useEffect(()=>{const i=l=>{var c;switch(l.data.type){case $d.CLOSE_CHAT_PANEL:e(!1);break;case $d.OPEN_BLOCK_PAGE:s(l.data.data.uuid,{forceOpenNewTab:!0});break;case $d.OPEN_UPGRADE_AI:t({isFrom:Mt.ai_max});break;case $d.OPEN_UPGRADE_SPACE:n(Mt.ai_max);break;case $d.UPLOAD_FILE:{const{fileName:d,fileSize:u,ossName:f,fileId:h}=l.data.value,{extName:p}=rn(d),g=Pn(),_=Iu();let x=(c=_==null?void 0:_.setting.aiFolderId)!=null?c:"";const F=J.blocks[x];if(!(F&&F.status===m.BlockStatus.NORMAL)||!Xn(mn(x).role,m.PermissionRole.WRITER)){if(x=a(m.BlockType.FOLDER,{parentId:g.uuid,last:!0},Ss.PRIVATE,ht("空间问问-上传文件夹(请勿删除)")),!x)return;_&&hn(()=>{o(_.uuid,{setting:{aiFolderId:x}})})}hn(()=>{ut({uuid:h,type:m.BlockType.FILE,data:{extName:p,ossName:f,segments:ht(d),size:u}},{parentId:x!=null?x:"",first:!0})});break}case $d.CHAT_PANEL_WIDTH:{xn.emit("aiPageWidth",l.data.value);break}case $d.SEND_QUESTION:{me.event("send_ai_question",l.data.value);break}}};return window.addEventListener("message",i),()=>{window.removeEventListener("message",i)}},[a,s,t,n,e,o])},M4e=({Component1:e,Component2:t})=>{const n=r.jsx(e,{});return n.type&&n.type()===null?r.jsx(t,{}):n},Qq=e=>{const t=J.blocks[e];return Eu()&&(t==null?void 0:t.status)!==m.BlockStatus.NORMAL},U4e=e=>{const{className:t,uuid:n}=e,s=ie(),a=async()=>{const i=be.loading("推送中");await ve.infra.subscribePublishChange(n),be.closeMessage(i),be.success("推送成功")},o=()=>{s.warning({title:"确认推送给所有订阅者吗？",confirmText:"发布推送",confirm:a})};return r.jsx(De,{className:R("flex-shrink-0",t),onClick:o,children:"发布"})},Jq=48,Zq=5,V4e=({className:e})=>{const t=lt(),[n,s]=y.useState({}),[a,o]=y.useState(0),i=D3(),l=Pw(),c=ba(),d=Ce(()=>Object.entries(i).filter(([g,_])=>_.pageId===t&&_.userId!==l).reduce((g,[_,x])=>(g[_]={...kn(x,"activityTime","blockId"),lastVisitTime:x.activityTime},g),{}),[i,l,t]);y.useEffect(()=>{var g;(g=J.blocks[t])!=null&&g.local||!t||(st({$membersStates:{}}),ve.editor.getDocVisits.raw(t).then(_=>{if(_.code===200){const x=Date.now(),F=_.data.visits.filter(b=>b.userId!==yt.uuid).reduce((b,w)=>(b[w.userId]={userId:w.userId,pageId:t,present:w.present&&x-w.visitedAt<Y_,lastVisitTime:w.visitedAt},b),{});s(F)}}))},[t]),y.useEffect(()=>{const g={};for(const[_,x]of Object.entries(n)){const F=d[_];F&&F.userId===_&&F.pageId===x.pageId&&F.lastVisitTime>x.lastVisitTime&&(g[_]=F)}Object.entries(g).length>0&&s({...n,...g})},[d,n]),y.useEffect(()=>{const g=setInterval(()=>{o(Date.now())},Y_);return()=>{clearInterval(g)}},[o]);const u=y.useMemo(()=>{const g={},_=Date.now(),x=b=>{b&&b.present&&b.lastVisitTime+Y_<_&&(b.present=!1)};for(const[b,w]of Object.entries(n))g[w.userId]={...w},x(g[w.userId]);for(const[b,w]of Object.entries(d))g[w.userId]={...w},x(g[w.userId]);const F=Object.entries(g).map(([b,w])=>w).sort((b,w)=>b.present&&w.present?w.lastVisitTime-b.lastVisitTime:b.present?-1:w.present?1:w.lastVisitTime-b.lastVisitTime);return F.unshift({userId:yt.uuid,pageId:t,present:!0,lastVisitTime:Date.now()}),F.filter(b=>c[b.userId])},[d,t,n,a]);if(u.length<=1)return null;const f=RL(u,Zq),h=u.length-f.length,p=SL(u,h);return r.jsxs("div",{className:R("flex items-center relative transition-all h-9",e),children:[r.jsx(r.Fragment,{children:f.map((g,_)=>r.jsx(H4e,{memberInfo:g,index:_},_))}),h>0&&r.jsx(Fe,{hideOnClick:!1,theme:"members-tooltip",maxWidth:260,interactive:!0,className:"ml-1",placement:"bottom",popup:r.jsx(q4e,{memberInfos:p}),children:r.jsx("div",{className:"cursor-pointer text-t2 text-grey4",children:"+".concat(h)})})]})},$4e=y.memo(V4e),H4e=e=>{var o,i;const t=Pi(e.memberInfo.userId),n=(o=D3()[e.memberInfo.userId])==null?void 0:o.blockId,s=_r(e.memberInfo.userId);if(!t)return r.jsx("div",{className:"w-6 h-6 -ml-2 rounded-full text-white shadow-sm"});const a=e.index>0&&e.memberInfo.present&&n;return r.jsx(Fe,{style:{zIndex:Zq-e.index},className:"-ml-1.5",placement:"bottom",onClick:()=>{const l=xt.$membersStates[t.uuid];l&&eG(l.blockId)},popup:r.jsx(z4e,{userId:e.memberInfo.userId,lastVisitTime:e.memberInfo.lastVisitTime,username:s,type:e.index===0?"self":e.memberInfo.present?"present":"absent"}),children:r.jsx("div",{className:"bg-white1 rounded-full inline-block",children:r.jsx(ar,{className:R("rounded-full text-white shadow-sm transition",{"hover:scale-[1.3]":a,"opacity-30":!e.memberInfo.present,"cursor-pointer":e.index!==0&&e.memberInfo.present&&((i=xt.$membersStates[t.uuid])==null?void 0:i.blockId),"w-[26px] h-[26px]":t.avatar}),name:s,color:t.backgroundColor,icon:{type:"upload",value:t.avatar},imgClassName:"rounded-full",iconSize:26})})})},z4e=e=>{var n;const t=!!((n=xt.$membersStates[e.userId])!=null&&n.blockId);return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t4-medium",children:e.username}),e.type==="present"&&t&&r.jsx("div",{className:"text-t4-medium text-grey4",children:"点击查看TA在看什么"}),e.type==="present"&&!t&&r.jsx("div",{className:"text-t4-medium text-grey4",children:"正在浏览"}),e.type==="absent"&&e.lastVisitTime&&r.jsxs("div",{className:"text-t4-medium text-grey4",children:[LU(Date.now()-e.lastVisitTime),"看过"]})]})},eG=e=>{const t=document.querySelector(".block-list");if(!t)return;const n=t.querySelector('[data-block-id="'.concat(e,'"]'));n==null||n.scrollIntoView({behavior:"smooth",block:"center"})},q4e=e=>{const t=e.memberInfos.filter(s=>s.present).sort((s,a)=>{var o;return(o=xt.$membersStates[s.userId])!=null&&o.blockId?-1:1}),n=e.memberInfos.filter(s=>!s.present);return r.jsxs("div",{className:"w-60 p-2 space-y-2 text-ellipsis",children:[t.length>0&&r.jsx("div",{className:"text-t4-medium text-grey4",children:"正在浏览"}),t.map(s=>{const a=xt.$membersStates[s.userId],o=s.present&&(a==null?void 0:a.blockId),i=J.users[s.userId],l=Rn(s.userId);return i?r.jsx("div",{className:R("flex items-center justify-between",{"cursor-pointer":o}),onClick:()=>{a&&eG(a.blockId)},children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(ar,{className:R("rounded-full text-white"),name:l,color:i.backgroundColor,icon:{type:"upload",value:i.avatar},imgClassName:"rounded-full"}),r.jsx("div",{className:"ml-2 text-t4-medium text-ellipsis max-w-[150px]",children:l})]})},s.userId):null}),n.length>0&&r.jsx("div",{className:"text-t4-medium text-grey4",children:"上次浏览"}),n.map(s=>{const a=J.users[s.userId],o=Rn(s.userId);return a?r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center ",children:[r.jsx(ar,{className:R("rounded-full text-white"),name:o,color:a.backgroundColor,icon:{type:"upload",value:a.avatar},imgClassName:"rounded-full"}),r.jsx("div",{className:"ml-2 text-t4-medium text-ellipsis max-w-[150px]",children:o})]}),s.lastVisitTime&&r.jsx("div",{className:"text-t4-medium text-grey4",children:LU(Date.now()-s.lastVisitTime)})]},s.userId):null})]})},tG=e=>Ce(({blocks:t})=>{var n;return wu()?!1:(n=t[e])==null?void 0:n.subNodes.some(s=>{var a;return(a=t[s])==null?void 0:a.data.isByAI})},[],{waitMode:"debounce",wait:1e4}),nG=()=>{const e=lt(),t=ye(e,[]),n=pt(),s=Ut(),a=Ur(t==null?void 0:t.spaceId);return n?r.jsxs(r.Fragment,{children:[r.jsx("span",{hidden:!s.uuid&&a,className:"w-px mx-2 h-3.5 bg-grey6 flex-shrink-0"}),r.jsx("div",{hidden:!s.uuid&&a,className:"cursor-pointer text-t2-medium flex-shrink-0 bg-white dark:bg-transparent text-black",onClick:()=>Er(r1()),children:r.jsx("div",{children:s.uuid?"返回空间":"前往 ".concat(Na)})})]}):r.jsx(r.Fragment,{})},G4e=()=>{const e=lt(),n=!!Ut().uuid,s=ft(e,f=>f==null?void 0:f.type),{roleWithoutPublic:a,publicRole:o,illegal:i}=mt(e),l=Nm(),c=!!(a!==Tk.PermissionRole.NONE&&tn(s)),d=pt(),u=SU();return!(d&&!i&&o===Tk.PermissionRole.COMMENTER)||l?null:r.jsx(Fe,{popup:"评论",children:r.jsx(Ys,{size:30,className:"text-t2-medium flex-shrink-0 animate-click animate-hover",onClick:()=>{u()&&(n&&c&&bI(Ot()),st({$allowCommentInSharePage:!0}))},children:r.jsx(V,{name:"IcComment",size:"middle"})})})};function W4e(e){const{className:t,children:n}=e;return r.jsx("div",{className:R("h-[60px] w-full bg-grey8 flex-shrink-0 text-grey3 flex items-center justify-center sticky cursor-default top-0 left-0 z-20",t),children:n})}const K4e=5,Y4e=()=>{const e=Id();return mc(t=>{var i;const n=e==null?void 0:e.spaceId;if(!n)return;const s=t[n];if(!s||!n5(n))return;const o=(i=s.customTemplates)==null?void 0:i.filter(l=>!r2(l)).length;return K4e<=o})};var xS=(e=>(e[e.UN_RESOLVE_COMMENT=0]="UN_RESOLVE_COMMENT",e[e.RESOLVE_COMMENT=1]="RESOLVE_COMMENT",e))(xS||{});let sG=0;const rG=e=>{sG=e},RRe=e=>{const{pageId:t}=e,n=We(t,!1,!0),[s,a]=y.useState(sG),o=Nm(),{unresolvedDiscussions:i,resolvedDiscussions:l}=Ce(u=>{const f=[];for(const p in u.discussions){const g=u.discussions[p];g!=null&&g.status===m.BlockStatus.NORMAL&&ww(g.parentId,u)===t&&f.push(g)}const h=p=>{const g=f.filter(_=>p?_.resolved:!_.resolved);return g.sort(pi(Hr(_=>_.createdAt))),g};return{resolvedDiscussions:h(!0),unresolvedDiscussions:h(!1)}},[t],{wait:500,allDiscussions:!0}),c=s===0?i:l,d=s===0;return r.jsx(CV.Provider,{value:!0,children:r.jsxs("div",{className:"h-full flex flex-col items-stretch",children:[r.jsx("div",{className:"h-[50px] border-b border-b-grey6 text-t2-medium",children:r.jsxs("div",{className:"h-full flex items-center space-x-4 mx-4",children:[r.jsx("span",{className:R("cursor-pointer",d&&"underline underline-offset-[19.5px]"),onClick:()=>{a(0)},children:"当前评论区"}),r.jsx("span",{className:R("cursor-pointer",!d&&"underline underline-offset-[19.5px]"),onClick:()=>{a(1)},children:"已解决评论"})]})}),r.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto",children:c.length===0?r.jsx("div",{className:"h-full flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-[70px] leading-[98px]",children:"👀"}),r.jsx("div",{className:"text-t1 text-grey3 leading-[22px]",children:d?"没有未解决评论":"没有已解决评论"})]})}):r.jsx("div",{className:"",children:c.map(u=>d?r.jsx(I1,{showReplyEditor:!1,className:"px-4",readonly:n,allowCommentInSharePage:o,draftKey:"PageOpenDiscussion:".concat(u.uuid),discussionId:u.uuid},u.uuid):r.jsx(TV,{hideBlockContext:!0,discussionId:u.uuid,className:"p-[15px] border-b",readonly:n},u.uuid))})})]})})},PRe=({id:e,title:t,children:n,type:s=Ss.PRIVATE,showCreateButton:a=!0,tooltipDesc:o,addonAfter:i})=>{const l=Ot(),c=!!P_e(),d="".concat(Yne,":").concat(l,":").concat(s),[u,f]=y.useState(()=>{let _=!1;if(c)return _;try{const x=localStorage.getItem(d);x&&(_=JSON.parse(x))}catch(x){}return _}),h=jd(),p=ns(),g=_=>{if(_.stopPropagation(),s===Ss.PRIVATE||s===Ss.SPACE){u&&f(!1),me.event("page_new",{group_category:s});const x=h(m.BlockType.PAGE,{parentId:l,first:!0},s);p.push("/".concat(x))}};return r.jsxs("div",{id:e,children:[r.jsxs("div",{className:"z-10 sticky bg-aside flex items-center justify-between top-0 py-0.5 text-t4-medium text-grey3",children:[r.jsx(Fe,{offset:[2,4],placement:"right",maxWidth:500,popup:r.jsx(AP,{title:u?"点击展开":"点击收起",text:o}),children:r.jsx("div",{className:"px-1.5 ml-3 rounded-sm cursor-pointer animate-hover",onClick:()=>{c||ts(d,JSON.stringify(!u)),f(!u)},children:t})}),r.jsxs("div",{children:[(s===Ss.PRIVATE||s===Ss.SPACE)&&a&&r.jsx(r.Fragment,{children:r.jsx(Fe,{popup:r.jsx(AP,{title:"创建新页面",text:o}),placement:"right",className:R("transition-all flex items-center pr-3 opacity-0 add-page",Kne[s]),children:r.jsx("button",{...Gs(s===Ss.PRIVATE?Hs.asideTocHeaderCreateByPrivate:Hs.asideTocHeaderCreateBySpace),onClick:g,className:"rounded-sm cursor-pointer animate-hover",children:r.jsx(V,{size:"small",name:"IcAdd",className:"block"})})})}),i]})]}),r.jsx(aG.Provider,{value:s,children:!u&&r.jsx(r.Fragment,{children:n})})]})},AP=({title:e,text:t})=>r.jsxs("div",{className:"p-1",children:[r.jsx("div",{children:e}),t&&r.jsx("div",{className:"text-gray-300",children:t})]}),aG=y.createContext(Ss.PRIVATE),X4e=()=>y.useContext(aG),Mv=async e=>{await ve.editor.leaveDoc(e),re(r0({uuid:e,ignoreOp:!0}))},fk=new Set,Q4e=({uuid:e,popcorn:t,close:n,isInFavoriteTop:s,groupType:a,isRoot:o})=>{var M,U;const i=nI(e),l=Ut(),c=ye(e,["data","createdBy"],["segments","ref"]),d=Yl(c),u=Oe(),f=Pd(),h=ie(),p=jg(),g=hx(e),_=(c==null?void 0:c.type)===m.BlockType.FILE,{illegal:x,role:F}=mt(e),b=We(e),w=Mw(e),E=k0(e),C=ns(),k=pt(),T=ai(),v=ys(),I=Js(),j=II(),S=y.useMemo(()=>{var z;return(z=nT(e))!=null?z:e},[e]),D=()=>{me.event("rename_click",{group_category:a}),h.dropdown({popcorn:t,placement:"bottom-start",content({onCloseModal:z}){return c?r.jsx(Z4e,{close:z,uuid:e}):null}})};let A;if(k)A=[{type:H.OPERATION,data:{icon:"IcLink",title:"复制页面访问链接",onClick:()=>{const z=k?"share/":"";Xt("".concat(_n(),"/").concat(z).concat(e))}}}];else if(_)A=[{type:H.OPERATION,data:{icon:"IcQuickAccessRemove",title:"取消快速访问",onClick:()=>{u(()=>{me.event("favorite_cancel_click"),L_(e,{parentId:yt.currentSpaceViewId})})}},isHidden:!i}];else{const z=d&&!J.blocks[(U=(M=c==null?void 0:c.data.ref)==null?void 0:M.uuid)!=null?U:""];A=[{type:H.OPERATION,data:{icon:"IcTrash",title:"删除",onClick:()=>{me.event("delete_click"),u(()=>{gr(e),c&&Ib(c)&&C.push(j(c.parentId))})}},isHidden:s||!E||!(F===m.PermissionRole.EDITOR||F===m.PermissionRole.WRITER)},{type:H.OPERATION,data:{icon:"IcQuickAccessRemove",title:"取消快速访问",onClick:()=>{me.event("favorite_cancel_click"),u(()=>{L_(e,{parentId:yt.currentSpaceViewId})})}},isHidden:!i},{type:H.OPERATION,data:{icon:"IcQuickAccess",title:"添加到快速访问",onClick:()=>{me.event("favorite_click"),u(()=>{N5(e,{first:!0,parentId:yt.currentSpaceViewId}),I(Je.ADD_TO_FAVORITE,ct.advancedList)})}},isHidden:i||d},{type:H.OPERATION,data:{icon:"IcDuplicate",title:"拷贝副本",onClick:()=>{me.event("copy_click"),p([e])}},isHidden:s||!E||T&&o||z},{type:H.OPERATION,data:{icon:"IcLink",title:"复制页面访问链接",onClick:()=>{const K=k?"share/":"";Xt("".concat(_n(),"/").concat(K).concat(e))}}},{type:H.OPERATION,data:{icon:"IcEdit02",title:"重命名",onClick:D},isHidden:d||b},{type:H.LINE,data:{},disableClick:!0,isHidden:!w||z},{type:H.OPERATION,data:{icon:"IcMove",title:"移动到",onClick:()=>{me.event("moveto_menu_click",{group_category:a}),f({popcorn:t,uuid:e})}},isHidden:!w||z}],a===Ss.SHARE&&o&&T&&(A.unshift({type:H.LINE,data:{},disableClick:!0,isHidden:!1}),A.unshift({type:H.OPERATION,data:{icon:"MIcSettingsLogout",title:"退出协作",onClick:()=>{Mv(e)}},isHidden:!1}))}!c&&s?A=[{type:H.OPERATION,data:{icon:"IcQuickAccessRemove",title:"取消快速访问",onClick:()=>{me.event("favorite_cancel_click"),u(()=>{L_(e,{parentId:yt.currentSpaceViewId})})}}}]:x&&(a===Ss.SHARE&&o&&T?A=[{type:H.OPERATION,data:{icon:"MIcSettingsLogout",title:"退出协作",onClick:()=>{Mv(e)}}}]:A=[{type:H.OPERATION,data:{icon:"IcTrash",title:"彻底删除",onClick:()=>g()},isHidden:b}]);const P={type:H.OPERATION,isHidden:_||o1(),data:{icon:"IcOpenInSide",title:"在侧边栏中打开",onClick:()=>v(e,{forceOpenInRight:!0})}},L=!fk.has(S),O=S===e,$={type:H.OPERATION,isHidden:!o1()||!O||a===Ss.RECOMMEND,data:{tip:"取消订阅后下次访问不再显示",icon:"MIcSettingsLogout",title:L?"取消订阅":"订阅",onClick:async()=>{var K;const z=(K=nT(e))!=null?K:e;await nB({targetId:z,subscribed:!L,addSubscribe:ve.infra.addSubscribe,cancelSubscribe:ve.infra.cancelSubscribe,user:l,openDialog:h.warning,callback:W=>W&&location.reload()},{pageId:e,needPay:!1,userId:xa().uuid,createdBy:c==null?void 0:c.createdBy,spaceId:c==null?void 0:c.spaceId,event:me.event}),L?fk.add(z):fk.delete(z)}}};return A.unshift($),A.unshift(P),r.jsx(ze,{className:"w-56 py-2 rounded-r next-modal",items:A,onItemClick:()=>n()})},J4e=({uuid:e,deep:t})=>{const n=ie(),s=X4e(),a=s===Ss.FAVORITE&&t===0;return y.useCallback(o=>{me.event("pagemenu_click",{group_category:s}),o.preventDefault(),o.stopPropagation(),n.dropdown({popcorn:_m(o),placement:"bottom-start",offset:[4,4],content({onCloseModal:i}){return r.jsx(Q4e,{groupType:s,isInFavoriteTop:a,uuid:e,popcorn:_m(o),close:i,isRoot:t===0})}})},[t,s,a,n,e])},LRe=e=>{const t=J4e(e);return r.jsx(Fe,{popup:"展开菜单",children:r.jsx("button",{...Gs(Hs.asideItemMore),className:"items-center justify-center hidden rounded-sm animate-hover group-hover:flex w-5 h-5",onClick:t,children:r.jsx(V,{name:"IcMore",className:"text-grey3",size:"small"})})})},Z4e=({uuid:e,close:t})=>{const n=ye(e,["data"],["segments"]),s=Oe();return y.useEffect(()=>{const a=o=>{o.code==="Enter"&&t()};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[t]),n?r.jsx("div",{className:"next-modal flex items-center p-1 rounded-t",style:{width:"365px"},children:r.jsx(Ct,{autoFocus:!0,showBorder:!1,defaultValue:fe(n.data.segments),onEnter:t,onChange:a=>{s(()=>{_e(e,{data:{segments:ht(a)}})})},placeholder:qt(n.type),className:"w-full h-8 bg-grey8"})}):null},RP=({filterUserNoInSpace:e,searchText:t="",activeIndex:n,permissions:s,showRight:a,selectUser:o,showType:i,className:l})=>{var p;const c=Dt(),d=lE(),u=kd(),f=ba(),h=y.useCallback(g=>{var F,b,w,E;const _={index:(F=g.index)!=null?F:0,type:g.type,role:g.role,isGuest:g.isGuest};if(g.type===m.PermissionType.SPACE){if(_.id="space",_.backgroundColor=c.backgroundColor,_.name=c.title,_.usersNum=(w=(b=c.permissions)==null?void 0:b.length)!=null?w:0,_.icon=c.icon,t){const C=Object.entries(d).map(([k,T])=>T);_.userNames=lc(C,t).map(k=>Rn(k.uuid))}}else if(g.type===m.PermissionType.USER&&g.userId){const C=d[g.userId];if(!C||e&&!f[C.uuid]&&!g.isGuest)return null;_.id=C.uuid,_.name=Rn(C.uuid),_.backgroundColor=C.backgroundColor,_.icon={type:"upload",value:C.avatar},_.phone=C.phone,_.isGuest=g.isGuest||!!t&&!f[C.uuid],_.isGuestInSpace=u.some(k=>k.userId===C.uuid)}else if(g.type===m.PermissionType.GROUP&&g.groupId){const C=(E=c.permissionGroups)==null?void 0:E.find(k=>k.id===g.groupId);if(!C)return null;if(_.id=C.id,_.name=C.name||F3,_.usersNum=C.userIds.length,_.icon=C.icon,t){const k=C.userIds.map(T=>d[T]).filter(T=>!!T);_.userNames=lc(k,t).map(T=>Rn(T.uuid))}}const x=g.type===m.PermissionType.USER&&!!g.userId&&g.isGuest;switch(i){case"all":return _;case"onlySpaceUser":return x?null:_;case"onlyGuest":return x?_:null}return _},[i,c.backgroundColor,c.title,(p=c.permissions)==null?void 0:p.length,c.icon,c.permissionGroups,t,d,e,f,u]);return r.jsx("div",{className:R("flex items-center flex-wrap",l),children:s.map(g=>{var w,E,C;const _=h(g);if(!_)return null;const x=(E=(w=_.userNames)==null?void 0:w.length)!=null?E:0,F=g.type===m.PermissionType.USER?"rounded-full":"",b=!_.isGuest&&!!t&&_.role&&_.role!==m.PermissionRole.NONE;return r.jsxs("div",{className:R("relative flex items-center justify-between h-10 rounded px-1",!b&&o&&"cursor-pointer animate-click",_.index===n&&"normal-bg"),onClick:()=>!b&&o&&o({...g,name:_.name||_.phone}),children:[b&&r.jsx("div",{className:"absolute inset-0 bg-white1 opacity-70 cursor-not-allowed"}),r.jsxs("div",{className:R("flex items-center w-full",b&&_.role&&"w-60"),children:[r.jsx(ar,{color:_.backgroundColor||Do.grey,name:_.name||(_.isGuest?"客":Po),icon:_.icon,className:"mr-2 w-[20px] h-[20px] text-white !text-t1 ".concat(F),imgClassName:F}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex text-t2",children:[r.jsx("div",{className:"flex items-center max-w-[160px] text-ellipsis",children:r.jsx("div",{children:_.name||(_.isGuest?_.phone:Po)})}),_.usersNum!==void 0&&r.jsx("div",{className:"flex-shrink-0",children:"（".concat(_.usersNum," 人）")})]}),!!x&&r.jsxs("span",{className:"text-t4 text-grey3 line-clamp-1",children:[r.jsx("span",{className:"mr-1",children:"包含:"}),(C=_.userNames)==null?void 0:C.map((k,T)=>r.jsxs("span",{className:R(T!==x-1&&"mr-1"),children:[r.jsx(X1,{text:k,search:t}),T!==x-1&&","]},"".concat(k,"-").concat(T)))]})]})]}),!a&&_.isGuest&&!_.isGuestInSpace&&r.jsx("div",{className:"text-t4 text-grey3 flex-shrink-0",children:"未加入该空间"})]},_.id)})})},ps=e=>r.jsxs("div",{className:"w-full h-9 flex items-center justify-between",children:[r.jsx("span",{className:"text-t3 text-grey3",children:e.leftNode}),r.jsx("span",{className:"text-t3",children:e.rightNode})]}),Zg=e=>r.jsxs("div",{className:"w-full h-9 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-t3",children:e.title}),e.showHelpIcon&&!0&&r.jsx(V,{className:"cursor-pointer ml-1",name:"IcInviteHelp",size:"middle",onClick:e.onClickHelpIcon})]}),r.jsx(V,{size:"normal",className:"select-none",name:e.expand?"IcArrowHide":"IcArrowShow",onClick:()=>{e.onExpand(!e.expand)}})]}),eSe=()=>{const e=lt(),[t,n]=y.useState(),s=aI(i=>{var l;return(l=i.blocks[e])==null?void 0:l.type});let a=nSe;ga(s)?a=rSe:s===m.BlockType.FOLDER&&(a=sSe);const o=y.useCallback(i=>{n(i)},[]);return r.jsxs("div",{className:"w-full overflow-auto",children:[r.jsx(tSe,{pageId:e,historyCount:t}),r.jsx("div",{className:"w-full bg-grey6 h-px my-2"}),r.jsx(a,{pageId:e,showHelpIcon:!0,onClickHelpIcon:()=>{window.open(ds.dataPanel)}}),r.jsx("div",{className:"w-full bg-grey6 h-px my-2"}),r.jsx(aSe,{pageId:e,showHelpIcon:!0,onHistoryCount:o,onClickHelpIcon:()=>{window.open(ds.shareDataPanel)}}),r.jsx(oSe,{pageId:e,showHelpIcon:!1,onClickHelpIcon:()=>{window.open(ds.collaborateInfo)}})]})},tSe=e=>{var o,i,l,c;const[t,n]=y.useState(!0),s=ye(e.pageId,["createdBy","createdAt","updatedBy","updatedAt"]),a=ie();return r.jsxs("div",{className:"w-full px-3",children:[r.jsx(Zg,{title:"基本信息",expand:t,onExpand:n,showHelpIcon:e.showHelpIcon,onClickHelpIcon:e.onClickHelpIcon}),t&&r.jsxs(r.Fragment,{children:[r.jsx(ps,{leftNode:"创建者",rightNode:r.jsx(si,{userId:(o=s==null?void 0:s.createdBy)!=null?o:"",className:"text-t2 !mx-0 !px-0"})}),r.jsx(ps,{leftNode:"创建时间",rightNode:BR((i=s==null?void 0:s.createdAt)!=null?i:0)}),r.jsx(ps,{leftNode:"最后编辑者",rightNode:r.jsx(si,{userId:(l=s==null?void 0:s.updatedBy)!=null?l:"",className:"text-t2 !mx-0 !px-0",size:"small"})}),r.jsx(ps,{leftNode:"最后编辑时间",rightNode:BR((c=s==null?void 0:s.updatedAt)!=null?c:0)}),r.jsx(ps,{leftNode:"页面版本",rightNode:r.jsxs("div",{className:"flex items-center",children:[e.historyCount===void 0?r.jsx(xs,{className:"w-5 h-5",size:"middle"}):r.jsx("span",{className:"whitespace-pre-wrap",children:"第".concat(e.historyCount,"版")}),r.jsx("div",{className:"ml-2 flex justify-end items-center h-10 text-t3 text-active_color w-full text-right underline underline-offset-2 ",children:r.jsx("span",{className:"cursor-pointer",onClick:()=>{a.modal({modalId:Ve.DOC_HISTORY_MODAL_ID,content:()=>r.jsx(xj,{docId:e.pageId})})},children:"查看页面历史"})})]})})]})]})},nSe=e=>{var c;const[t,n]=y.useState(!0),s=ye(e.pageId,["subNodes"]),{wordCount:a,blockCount:o}=ox(e.pageId),i=yse(e.pageId).length,l=y.useMemo(()=>{let d=0,u=0;const f=p=>{var _;const g=J.blocks[p];tn(g==null?void 0:g.type)||(g!=null&&g.data.ossName&&(g==null?void 0:g.type)===m.BlockType.FILE&&(d++,u+=(_=g==null?void 0:g.data.size)!=null?_:0),g==null||g.subNodes.forEach(f))};s==null||s.subNodes.forEach(f);const h=As(u);return"".concat(d,"（共计 ").concat(h,"）")},[s==null?void 0:s.subNodes]);return r.jsxs("div",{className:"w-full px-3",children:[r.jsx(Zg,{title:"页面内容数据统计",expand:t,onExpand:n,showHelpIcon:e.showHelpIcon,onClickHelpIcon:e.onClickHelpIcon}),t&&r.jsxs(r.Fragment,{children:[r.jsx(ps,{leftNode:"字数统计",rightNode:a}),r.jsx(ps,{leftNode:"块数统计",rightNode:o}),[m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE].includes((c=s==null?void 0:s.type)!=null?c:0)?r.jsx(ps,{leftNode:"节点数",rightNode:r.jsx(vU,{blockId:e.pageId,mindMapId:e.pageId})}):r.jsx(ps,{leftNode:"子页面数",rightNode:i}),r.jsx(ps,{leftNode:"文件数",rightNode:l})]})]})},sSe=e=>{const[t,n]=y.useState(!0),s=ye(e.pageId,["subNodes"]),{blockCount:a}=ox(e.pageId),o=y.useMemo(()=>s==null?void 0:s.subNodes.filter(l=>{var c;return((c=J.blocks[l])==null?void 0:c.type)===m.BlockType.FOLDER}).length,[s==null?void 0:s.subNodes]),i=y.useMemo(()=>{let l=0,c=0;s==null||s.subNodes.forEach(u=>{var h;const f=J.blocks[u];f!=null&&f.data.ossName&&(f==null?void 0:f.type)===m.BlockType.FILE&&(l++,c+=(h=f==null?void 0:f.data.size)!=null?h:0)});const d=As(c);return"".concat(l,"（共计 ").concat(d,"）")},[s==null?void 0:s.subNodes]);return r.jsxs("div",{className:"w-full px-3",children:[r.jsx(Zg,{title:"页面内容数据统计",expand:t,onExpand:n,showHelpIcon:e.showHelpIcon,onClickHelpIcon:e.onClickHelpIcon}),t&&r.jsxs(r.Fragment,{children:[r.jsx(ps,{leftNode:"块数统计",rightNode:a}),r.jsx(ps,{leftNode:"文件夹",rightNode:o}),r.jsx(ps,{leftNode:"文件数",rightNode:i})]})]})},rSe=e=>{var c,d,u;const[t,n]=y.useState(!0),s=ye(e.pageId,["subNodes","views","data"],["collectionPageProperties"]),{blockCount:a}=ox(e.pageId),[o]=iS(e.pageId,!0),[i=[]]=Fa(o),l=aI(f=>{let h=0;const p=f.blocks[e.pageId];return i.forEach(g=>{g.type===m.CollectionSchemaType.FILE&&(p==null||p.subNodes.forEach(_=>{var b,w;const x=f.blocks[_],F=(b=x==null?void 0:x.data.collectionProperties)==null?void 0:b[g.property];h+=(w=F==null?void 0:F.filter(E=>E.type===m.TextType.URL&&E.url).length)!=null?w:0}))}),h});return r.jsxs("div",{className:"w-full px-3",children:[r.jsx(Zg,{title:"页面内容数据统计",expand:t,onExpand:n,showHelpIcon:e.showHelpIcon,onClickHelpIcon:e.onClickHelpIcon}),t&&r.jsxs(r.Fragment,{children:[r.jsx(ps,{leftNode:"块数统计",rightNode:a}),r.jsx(ps,{leftNode:"多维表记录数",rightNode:(c=s==null?void 0:s.subNodes.length)!=null?c:0}),r.jsx(ps,{leftNode:"视图数",rightNode:(u=(d=s==null?void 0:s.views)==null?void 0:d.length)!=null?u:0}),r.jsx(ps,{leftNode:"多维表属性列",rightNode:i.length}),r.jsx(ps,{leftNode:"文件媒体列文件数",rightNode:l})]})]})},aSe=e=>{const t=Ln(),[n,s]=y.useState(!0),[a,o]=y.useState(!0),{shared:i,password:l,publicRole:c,allowSelectionCopy:d,allowDuplicate:u,allowDownload:f,allowSeo:h,allowSubscribe:p}=mt(e.pageId),[g,_]=y.useState(),x=c===m.PermissionRole.COMMENTER,F=[i?"已开启分享":"未开启分享",l?"已设置密码访问":"密码访问未开启"].join(" | "),b=p?"允许订阅":"未允许订阅",w=h?"已开启搜索引擎推广":"未开启搜索引擎推广",{onHistoryCount:E}=e;y.useEffect(()=>{ve.editor.getDocInfo(e.pageId).then(T=>{_(T),E==null||E(T.historyNum)}).finally(()=>{o(!1)})},[E,e.pageId,i]),y.useEffect(()=>{i&&O0(Ot())},[i]);const C=Ce(T=>{let v=0;const I=(j,S)=>{var A;const D=T.blocks[j];tn(D==null?void 0:D.type)&&!S||((A=D==null?void 0:D.discussions)==null||A.forEach(P=>{const L=T.discussions[P];if(L!=null&&!L.resolved)for(const O of L.comments){const $=T.comments[O];$!=null&&$.status===m.BlockStatus.NORMAL&&(v+=1)}}),D==null||D.subNodes.forEach(P=>I(P,!1)))};return I(e.pageId,!0),v},[e.pageId]),k=T=>{const v=bn("[data-test-id=".concat(Hs.driveFileShare,"]"),t);v instanceof HTMLElement&&v.click(),T&&setTimeout(()=>{const I=document.querySelector(".invite-bar");I instanceof HTMLElement&&I.click()},0)};return i?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"w-full px-3 relative",children:[r.jsx(Zg,{title:"页面分享数据统计",expand:n,onExpand:s,showHelpIcon:e.showHelpIcon,onClickHelpIcon:e.onClickHelpIcon}),n&&r.jsxs(r.Fragment,{children:[r.jsx(ps,{leftNode:"当前订阅人数",rightNode:g==null?void 0:g.currentSubscribedNum}),r.jsx(ps,{leftNode:"累计订阅人数",rightNode:g==null?void 0:g.totalSubscribedNum}),r.jsx(ps,{leftNode:"累积查看次数",rightNode:g==null?void 0:g.totalViewNum}),r.jsx(ps,{leftNode:"累计访问人次",rightNode:g==null?void 0:g.userViewNum}),r.jsx(ps,{leftNode:"累计拷贝副本次数",rightNode:g==null?void 0:g.copyNum}),r.jsx(ps,{leftNode:"累计评论次数",rightNode:C}),r.jsxs("div",{className:"hidden border-grey5 border h-8 items-center justify-center rounded",children:[r.jsx("span",{className:"text-t2",children:"更多详细数据"}),r.jsx("div",{className:"relative",children:r.jsx(_l,{className:"left-1.5 right-[undefined] top-[-8px]"})})]}),r.jsx(ps,{leftNode:"分享状态",rightNode:F}),r.jsx(ps,{leftNode:"订阅状态",rightNode:b}),r.jsx(ps,{leftNode:"推广状态",rightNode:w}),i&&r.jsxs(r.Fragment,{children:[r.jsx(ps,{leftNode:"分享访问权限",rightNode:["任何获得分享链接的人都",x?"可评论":"可查看"].join(" ")}),d&&r.jsx(ps,{leftNode:"",rightNode:"已允许复制内容"}),u&&r.jsx(ps,{leftNode:"",rightNode:"已允许拷贝副本"}),f&&r.jsx(ps,{leftNode:"",rightNode:"已允许下载和打印"})]}),r.jsx("div",{className:"flex justify-end items-center h-10 text-t3 text-active_color w-full text-right underline underline-offset-2 ",children:r.jsx("span",{className:"cursor-pointer",onClick:()=>{k()},children:"修改分享设置"})}),a&&r.jsx(xs,{className:"absolute top-0"})]})]}),r.jsx("div",{className:"w-full bg-grey6 h-px my-2"})]}):null},oSe=e=>{var c,d;const[t,n]=y.useState(!0),s=Ln(),a=bj(e.pageId),o=u=>{const f=bn("[data-test-id=".concat(Hs.driveFileShare,"]"),s);f instanceof HTMLElement&&f.click(),u&&setTimeout(()=>{const h=document.querySelector(".invite-bar");h instanceof HTMLElement&&h.click()},0)},i=a==null?void 0:a.permissions.some(u=>u.isGuest),l=a==null?void 0:a.permissions.some(u=>!u.isGuest);return r.jsxs("div",{className:"w-full px-3",children:[r.jsx(Zg,{title:"协作信息",expand:t,onExpand:n,showHelpIcon:e.showHelpIcon,onClickHelpIcon:e.onClickHelpIcon}),t&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:R("flex items-start",{"items-baseline":!l}),children:[r.jsx("span",{className:"shrink-0 text-t3 text-grey3",children:"空间协作者"}),r.jsx("div",{className:"ml-2",children:l?r.jsxs(r.Fragment,{children:[r.jsx(RP,{showType:"onlySpaceUser",filterUserNoInSpace:!0,className:"-mt-2",permissions:(c=a==null?void 0:a.permissions)!=null?c:[]}),r.jsx("div",{className:"ml-1 flex items-center h-10 text-t3 text-active_color w-full text-right underline underline-offset-2",children:r.jsx("span",{className:"cursor-pointer",onClick:()=>{o()},children:"权限设置"})})]}):r.jsx("span",{className:"text-t3 text-grey3 -mt-4",children:"无"})})]}),r.jsxs("div",{className:R("flex items-start",{"items-baseline":!i}),children:[r.jsx("span",{className:"shrink-0 text-t3 text-grey3",children:"外部协作者"}),r.jsxs("div",{className:"ml-2",children:[i?r.jsx(RP,{showType:"onlyGuest",filterUserNoInSpace:!0,className:"-mt-2",permissions:(d=a==null?void 0:a.permissions)!=null?d:[]}):r.jsx("span",{className:"text-t3 text-grey3 -mt-4",children:"无"}),r.jsx("div",{className:"ml-1 flex items-center h-10 text-t3 text-active_color w-full text-right underline underline-offset-2",children:r.jsx("span",{className:"cursor-pointer",onClick:()=>{o(!0)},children:"邀请外部协作者"})})]})]})]})]})},oG=qp(()=>({})),iSe=Qs(oG),lSe=e=>oG(n=>{if(e)return n[e]}),cSe=e=>{iSe(Yn(t=>os(t,e)))},dSe=({className:e,from:t,to:n,onClick:s})=>r.jsxs("div",{className:"mt-1 px-1 animate-hover",onClick:s,children:[r.jsx("div",{children:r.jsxs("span",{className:R("text-t4 text-grey3",e),children:[r.jsx(V,{name:"IcAddDescription",size:"middle",className:"mr-1 align-middle relative bottom-[1px]"}),r.jsx("span",{children:"块说明"})]})}),r.jsx("div",{className:"flex items-center mt-1",children:r.jsx(oh,{segmentsA:t.data.caption,segmentsB:n.data.caption})})]});function uSe(e,t){return r.jsx(fs,{segments:t})}function fSe(e,t){switch(e.format){case"integer":return Math.round(t);case"twoDecimal":return Number(t).toFixed(2);case"thousandth":{const[n,s]=String(t).split(".");let a=ST(n!=null?n:"");return s&&(a=a.concat(".",s)),a}case"percent":return lo(t);default:return dE(t)}}function mSe(e,t){return r.jsx(_a,{size:"large",checked:!!t,className:"align-top"})}function hSe(e,{timestamp:t,noTimePart:n}){return n?ue(t).format(Et):ue(t).format(On)}function pSe(e,t){return r.jsx("div",{className:"flex items-center",children:t.map((n,s)=>{const a=Jp(n.url),o=r.jsx("span",{className:"rounded-sm text-ellipsis px-1.5 text-grey3 bg-white/50 ml-1.5 first:ml-0",children:n.text},s);return a&&n.uuid&&(!n.size||n.size<=xx)?r.jsx(ah,{uuid:n.uuid,ossName:n.url,defaultIcon:o,className:"h-5 min-w-[20px] min-h-[20px] cursor-pointer rounded-sm overflow-hidden ml-1.5 first:ml-0",options:{resizeWidth:40}},s):o})})}function gSe(e,t){const n=e.options[t];if(n==null)return null;const s=J1(n.color),a=ow(n.color);return r.jsx("span",{className:"inline-block rounded-sm text-ellipsis px-1.5",style:{color:a,backgroundColor:s},children:n.value})}function _Se(e,t){return t.map(n=>{const s=e.options[n];if(s==null)return null;const a=J1(s.color),o=ow(s.color);return r.jsx("span",{className:"inline-block rounded-sm text-ellipsis px-1.5 ml-1.5 first:ml-0",style:{color:o,backgroundColor:a},children:s.value},n)})}function xSe(e){const t=Pi(e.userId),n=_r(e.userId);return r.jsxs("span",{className:"inline-flex align-top py-1 ml-1.5 first:ml-0",children:[r.jsx(Fl,{user:t}),r.jsx("span",{className:"ml-1.5",children:n})]})}function ySe(e,t){return r.jsx(r.Fragment,{children:t.map(n=>r.jsx(xSe,{userId:n},n))})}function bSe(e,t){return r.jsx(r.Fragment,{children:t.map(n=>r.jsx(Ir,{uuid:n},n))})}function FSe(e,t){return t===void 0?r.jsx("span",{className:"text-grey4",children:Wa.isEmpty}):e instanceof zM?uSe(e,t):e instanceof $M?fSe(e,t):e instanceof RN?mSe(e,t):e instanceof MM?hSe(e,t):e instanceof UM?pSe(e,t):e instanceof PN?gSe(e,t):e instanceof VM?_Se(e,t):e instanceof GM?ySe(e,t):e instanceof HM?bSe(e,t):null}const yS=({className:e,view:t})=>r.jsx(AL,{to:"/".concat(t.parentId,"#").concat(t.uuid),children:r.jsxs("span",{className:R("text-t2-medium p-1 animate-hover",e),children:[r.jsx(V,{className:"mr-1 align-middle relative bottom-[1px]",name:Ga[t.type],size:"middle"}),r.jsx("span",{className:"max-w-[100px] text-ellipsis",children:t.title||wl[t.type]})]})}),gh=({pageId:e})=>r.jsx(Ir,{uuid:e,interactable:!0,showUnderLine:!1}),bS=({className:e,schema:t,onClick:n})=>r.jsxs("span",{className:R(n&&"animate-hover",e),children:[r.jsx(V,{name:un[t.type],size:"middle",className:"mr-1 align-middle relative bottom-[1px]"}),r.jsx("span",{children:t.name})]}),wSe=({userId:e})=>{const t=_r(e,"");return r.jsx(r.Fragment,{children:t})},ESe=()=>{const e=Dt();return r.jsx(r.Fragment,{children:e.title})},CSe=({userId:e})=>{const t=_r(e!=null?e:"");return r.jsx("span",{children:t})},kSe=({groupId:e})=>{var s;const n=(s=Dt().permissionGroups)==null?void 0:s.find(a=>a.id===e);return r.jsx("span",{children:(n==null?void 0:n.name)||F3})},GF=({block:e,diffAgainstTo:t})=>{var n;return e.type===m.BlockType.REFERENCE||e.type===m.BlockType.REFERENCE_COLLECTION||e.type===m.BlockType.REFERENCE_COLLECTION_PAGE?((n=e.data.ref)==null?void 0:n.uuid)==null?null:r.jsx("div",{className:"py-1",children:r.jsx(Ir,{uuid:e.data.ref.uuid,showUnderLine:!1})}):e.type===m.BlockType.PAGE||e.type===m.BlockType.FOLDER||e.type===m.BlockType.COLLECTION_VIEW||e.type===m.BlockType.COLLECTION_VIEW_PAGE?r.jsx("div",{className:"py-1",children:r.jsx(Ir,{uuid:e.uuid,showUnderLine:!1})}):e.type===m.BlockType.TABLE?r.jsxs("div",{className:"py-1 flex items-center",children:[r.jsx(V,{name:"IcMenuTable",size:"middle",className:"mr-1"}),r.jsx("div",{className:"text-t2",children:"简单表格"})]}):e.type===m.BlockType.SYNC_CONTAINER||e.type===m.BlockType.SYNC_REFERENCE?r.jsx("div",{className:"py-1.5 flex items-center border border-grey6 rounded-sm px-2",children:r.jsx("div",{className:"text-t2 text-grey3",children:"同步块"})}):r.jsx(TSe,{block:e,diffAgainstTo:t})},TSe=({block:e,diffAgainstTo:t})=>{const n=ss(),s=y.useMemo(()=>iG(e,n),[e,n]);return r.jsx(z1,{store:s,children:r.jsx(Mo.Provider,{value:wt.PAGE_FEEDS,children:r.jsx(Vo.Provider,{value:uc.PAGE_FEEDS,children:r.jsx(Oo,{children:r.jsx(L8.Provider,{value:t,children:r.jsx(Xm,{id:e.uuid})})})})})})},iG=(e,t)=>{const n=n3(Iw),s=new Proxy({},{get(i,l,c){return l===e.uuid?e:Reflect.get(t.getState().blocks,l,c)}}),a=new Proxy({},{get(i,l,c){return Reflect.get(t.getState().users,l,c)}}),o=yY(n,{blocks:s,users:a});return t.subscribe(()=>{o.replaceReducer(n)}),o},PP=({block:e})=>{const t=ss(),n=y.useMemo(()=>iG(e,t),[e,t]);return r.jsx(z1,{store:n,children:r.jsx(Mo.Provider,{value:wt.PAGE_FEEDS,children:r.jsx(Vo.Provider,{value:uc.PAGE_FEEDS,children:r.jsx(Oo,{children:r.jsx(Fn,{className:Mn({fontSize:"20px",lineHeight:"1"}),blockId:e.uuid,trigger:!1,defaultIcon:r.jsx(_s,{uuid:e.uuid,size:"middle"})})})})})})};function LP(e){return r.jsx("div",{className:"text-t2 leading-6 flex items-center",children:FSe(e.type,e.value)})}const vSe=({block:e,onClick:t})=>r.jsxs("div",{className:"mt-1 ml-1 animate-hover",onClick:t,children:[r.jsx("div",{className:"text-t4 text-grey3",children:"已删除"}),r.jsx("div",{className:"opacity-30 pointer-events-none",children:r.jsx(GF,{block:e})})]}),ISe=({block:e,onClick:t})=>r.jsx("div",{className:"mt-1 ml-1 animate-hover bg-active_color_10",onClick:t,children:r.jsx("div",{className:"opacity-80 pointer-events-none",children:r.jsx(GF,{block:e})})}),BP=({from:e,to:t,onClick:n})=>r.jsx("div",{className:"mt-1 ml-1 animate-hover",onClick:n,children:r.jsx("div",{className:"pointer-events-none",children:t!=null?r.jsx(GF,{block:t,diffAgainstTo:e==null?"created":e}):e!=null?r.jsx(GF,{block:e,diffAgainstTo:"deleted"}):null})}),NSe=({className:e,from:t,to:n,onClick:s})=>r.jsxs("div",{className:"mt-1 px-1 animate-hover",onClick:s,children:[r.jsx("div",{children:r.jsxs("span",{className:R("text-t4 text-grey3",s&&"animate-hover",e),children:[r.jsx(V,{name:"IcAddDescription",size:"middle",className:"mr-1 align-middle relative bottom-[1px]"}),r.jsx("span",{children:"文件重命名"})]})}),r.jsx("div",{className:"flex items-center mt-1",children:r.jsx(oh,{segmentsA:t.data.segments,segmentsB:n.data.segments})})]}),jSe=({className:e,from:t,to:n,onClick:s})=>r.jsxs("div",{className:"mt-1 px-1 animate-hover",onClick:s,children:[r.jsx("div",{children:r.jsxs("span",{className:R("text-t4 text-grey3",s&&"animate-hover",e),children:[r.jsx(V,{name:"IcAddDescription",size:"middle",className:"mr-1 align-middle relative bottom-[1px]"}),r.jsx("span",{children:"页面说明"})]})}),r.jsx("div",{className:"flex items-center mt-1",children:r.jsx(oh,{segmentsA:t.data.description,segmentsB:n.data.description})})]}),SSe=({className:e,from:t,to:n,onClick:s})=>r.jsxs("div",{className:"mt-1 px-1 animate-hover",onClick:s,children:[r.jsx("div",{children:r.jsxs("span",{className:R("text-t4 text-grey3",s&&"animate-hover",e),children:[r.jsx(V,{name:"IcTitleEmoji",size:"middle",className:"mr-1 align-middle relative bottom-[1px]"}),r.jsx("span",{children:"页面图标"})]})}),r.jsxs("div",{className:"flex items-center mt-1",children:[r.jsx(PP,{block:t}),r.jsx(V,{name:"IcDateEnd",size:"middle",className:"mx-2 text-grey3"}),r.jsx(PP,{block:n})]})]}),DSe=({className:e,from:t,to:n,onClick:s})=>r.jsxs("div",{className:"mt-1 px-1 animate-hover",onClick:s,children:[r.jsx("div",{children:r.jsxs("span",{className:R("text-t4 text-grey3 inline-flex items-center",s&&"animate-hover",e),children:[r.jsx(V,{name:"IcTitle",size:"middle",className:"mr-1 align-middle relative bottom-[1px]"}),r.jsx("span",{children:"标题"})]})}),r.jsx("div",{className:"flex items-center mt-1",children:r.jsx(oh,{className:"max-w-full break-words",segmentsA:t.data.segments,segmentsB:n.data.segments})})]});function ASe(e){const{schema:t,from:n,to:s,onClick:a}=e;return r.jsxs("div",{className:"mt-1 px-1 animate-hover",onClick:a,children:[r.jsx(bS,{className:"text-t4 text-grey3 mb-1.5 flex items-center",schema:t}),r.jsx(oh,{className:"mt-1 py-1",segmentsA:n,segmentsB:s})]})}function RSe(e){const{valueType:t,from:n,to:s,schema:a,onClick:o}=e,i=y.useRef(null),[l,c]=y.useState(!1);return y.useLayoutEffect(()=>{const d=i.current;d!=null&&d.scrollWidth>d.offsetWidth&&c(!0)},[]),r.jsxs("div",{className:"mt-1 px-1 animate-hover",onClick:o,children:[r.jsx(bS,{className:"text-t4 text-grey3 mb-1.5 flex items-center",schema:a}),r.jsxs("div",{ref:i,className:R("flex",l?"flex-col":"items-center"),children:[r.jsx(LP,{type:t,value:n}),r.jsx(V,{name:"IcDateEnd",size:"middle",className:"mx-2 text-grey3"}),r.jsx(LP,{type:t,value:s})]})]})}const PSe=({from:e,to:t,onClick:n})=>{var l,c;const s=(l=e==null?void 0:e.data.collectionProperties)!=null?l:{},a=(c=t==null?void 0:t.data.collectionProperties)!=null?c:{},o=new Set([...Object.keys(s),...Object.keys(a)]),i=[];for(const d of o){const u=s[d],f=a[d];hi(mi(u),mi(f))||i.push(r.jsx("div",{className:"mx-1 mt-1.5 max-w-full border border-grey6 p-2",children:r.jsx(oh,{segmentsA:u,segmentsB:f,className:"!break-words"})},i.length))}return i.length===0?null:r.jsx("div",{className:"mt-1 px-1 animate-hover flex flex-wrap",onClick:n,children:i})},lG=y.createContext(void 0),fi=({edits:e,action:t,subject:n,subjectFirst:s=!1,timestamp:a,header:o,badge:i,footer:l,changes:c})=>{const d=lt(),u=y.useContext(lG),f=CL(e.flatMap(F=>F.authors)),h=Pi(f[0]),[p,g]=y.useState(!1),_=ie(),x=Un();return r.jsxs("div",{className:R("flex items-start py-3 px-4 !cursor-default border-grey6",x===wt.NOTIFICATION?"animate-hover-black3":"border-b last:border-b-0 border-b-grey6"),children:[r.jsx(Fl,{user:h,className:R(x===wt.NOTIFICATION?"mr-1 text-t2":"mr-1 w-8 h-8")}),r.jsxs("div",{className:"flex-1 min-w-0 flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"text-t2 ml-1 break-words leading-5",children:[r.jsx("span",{className:"text-t2-medium mr-1.5",children:f.map((F,b)=>r.jsxs(fn.Fragment,{children:[r.jsx(wSe,{userId:F}),b!==f.length-1&&"、"]},F))}),s?r.jsxs(r.Fragment,{children:[n&&r.jsxs("span",{children:["在",n]}),r.jsx("span",{className:"ml-1",children:t})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mr-1",children:t}),n&&r.jsx("span",{children:n})]})]}),i]}),r.jsx("div",{className:"ml-1 text-t4 text-grey3",children:r.jsx(Fe,{popup:ue(a).format("YYYY/M/D HH:mm:ss"),className:"inline",children:r.jsx(Lj,{timestamp:a})})}),o,r.jsxs("div",{className:"mt-1.5",children:[p?c:c.slice(0,5),c.length>5&&!p&&r.jsx("div",{children:r.jsxs("button",{className:"px-1 mt-1 text-t2 text-grey4 animate-hover",onClick:()=>{g(!0)},children:["查看更多（",c.length-5,"条）"]})})]}),l]}),u!=null&&r.jsx(Fe,{popup:"查看此版本页面历史",children:r.jsx("button",{className:"animate-hover text-grey3",onClick:()=>{_.modal({modalId:Ve.DOC_HISTORY_MODAL_ID,content:()=>r.jsx(xj,{docId:d,initialSelectedSnapshotId:u})})},children:r.jsx(V,{name:"IcPageHistory",size:"middle"})})})]})},LSe=({pageActivity:e})=>{var a,o,i,l,c,d,u,f,h,p,g,_,x,F,b;const t=mx(),n=e.edits.slice(0),s=[];for(const w of n){const[E,C]=w.type==="blockCreated"?[void 0,(o=(a=w.blockData)==null?void 0:a.current)==null?void 0:o.blockValue]:w.type==="blockDeleted"?[(l=(i=w.blockData)==null?void 0:i.current)==null?void 0:l.blockValue,void 0]:[(d=(c=w.blockData)==null?void 0:c.before)==null?void 0:d.blockValue,(f=(u=w.blockData)==null?void 0:u.after)==null?void 0:f.blockValue],k=C!=null?C:E,T=()=>{const S=k==null?void 0:k.uuid;S&&t(S)};if(BSe(E,C)){hi(mi(E==null?void 0:E.data.segments),mi(C==null?void 0:C.data.segments))||s.push(r.jsx(BP,{from:E,to:C,onClick:T},s.length));continue}if(E!=null&&C!=null&&E.type===C.type&&!hi(mi(E.data.caption),mi(C.data.caption))){const S={...kn(E,"updatedAt","updatedBy","version"),data:kn(E.data,"caption")},D={...kn(C,"updatedAt","updatedBy","version"),data:kn(C.data,"caption")};if(hi(S,D)){s.push(r.jsx(dSe,{from:E,to:C,onClick:T},s.length));continue}}if((k==null?void 0:k.type)===m.BlockType.TABLE_ROW){RS(E==null?void 0:E.data.collectionProperties,PS)&&RS(C==null?void 0:C.data.collectionProperties,PS)||s.push(r.jsx(PSe,{from:E,to:C,onClick:()=>{const S=k.parentId;S&&t(S)}},s.length));continue}if(E!=null&&C!=null&&E.type===C.type&&E.type===m.BlockType.FILE&&!hi(mi(E.data.segments),mi(C.data.segments))){const S={...kn(E,"updatedAt","updatedBy","version","title"),data:kn(E.data,"segments")},D={...kn(C,"updatedAt","updatedBy","version","title"),data:kn(C.data,"segments")};if(hi(S,D)){s.push(r.jsx(NSe,{from:E,to:C,onClick:T},s.length));continue}}if(E!=null&&C!=null&&tn(E.type)&&tn(C.type)){hi(mi(E.data.segments),mi(C.data.segments))||s.push(r.jsx(DSe,{from:E,to:C,onClick:T},s.length)),hi((h=E.data.icon)!=null?h:{},(p=C.data.icon)!=null?p:{})||s.push(r.jsx(SSe,{from:E,to:C,onClick:T},s.length)),hi((g=E.data.description)!=null?g:[],(_=C.data.description)!=null?_:[])||s.push(r.jsx(jSe,{from:E,to:C,onClick:T},s.length));const S={findSchema(D,A){var P;return(P=w.blockSchema)==null?void 0:P[A]},findUser(D){return pe().users[D]},findRecord(D){return D===E.uuid?E:D===C.uuid?C:pe().blocks[D]}};for(const[D,A]of Object.entries((x=w.blockSchema)!=null?x:{})){if(A.type===m.CollectionSchemaType.TITLE||hm.includes(A.type)||GI.includes(A.type))continue;const P=(F=E.data.collectionProperties)==null?void 0:F[D],L=(b=C.data.collectionProperties)==null?void 0:b[D];if(A.type===m.CollectionSchemaType.TEXT){hi(mi(P),mi(L))||s.push(r.jsx(ASe,{schema:A,from:P,to:L,onClick:T},s.length));continue}const O=WM("",D,S),$=O.fromSegments(P),M=O.fromSegments(L);hB(so(O.compare.bind(O)))($,M)||s.push(r.jsx(RSe,{schema:A,valueType:O,from:$,to:M,onClick:T},s.length))}continue}const v=new Set([m.BlockType.TEXTAREA,m.BlockType.HEADER]);let I=E,j=C;I!=null&&Nw(I.type)&&fe(I.data.segments)===""&&(I=void 0),j!=null&&j.type===m.BlockType.TABLE&&(j=void 0),I!=null&&(v.has(I.type)?s.push(r.jsx(BP,{from:I,to:void 0,onClick:T},s.length)):s.push(r.jsx(vSe,{block:I,onClick:T},s.length))),j!=null&&s.push(r.jsx(ISe,{block:j,onClick:T},s.length))}return s.length===0?null:r.jsx(fi,{edits:e.edits,action:"编辑了",subject:r.jsx(gh,{pageId:e.parentId}),timestamp:e.endTime,changes:s})},BSe=(e,t)=>{if(e!=null&&t!=null){if(e.type!==t.type)return!1;if(e.type===m.BlockType.HEADER)return e.data.level===t.data.level;if(e.type===m.BlockType.MARK)return e.data.icon===t.data.icon;if(e.type===m.BlockType.TODO)return e.data.checked===t.data.checked}const n=e!=null?e:t;return n==null||n.type===m.BlockType.CODE?!1:Nw(n.type)},OSe=({edit:e})=>{if(!e.collectionPropertyData)return null;const t=(()=>{switch(e.type){case"collectionPropertyCreated":return"创建了属性";case"collectionPropertyChanged":return"编辑了属性";case"collectionPropertyDeleted":return"删除了属性";default:throw new Error("Assertion failed")}})();return r.jsx(fi,{edits:[e],action:t,subject:r.jsx(bS,{className:"p-1 text-t2-medium",schema:e.collectionPropertyData,onClick:()=>{}}),timestamp:e.timestamp,changes:[]})},MSe=({edit:e})=>{var t;return((t=e.collectionViewData)==null?void 0:t.current)==null?null:r.jsx(fi,{edits:[e],action:"新增了视图",subject:r.jsx(yS,{view:e.collectionViewData.current}),timestamp:e.timestamp,changes:[]})},USe=({edit:e})=>{var t;return((t=e.collectionViewData)==null?void 0:t.after)==null?null:r.jsx(fi,{edits:[e],action:"编辑了视图",subject:r.jsx(yS,{view:e.collectionViewData.after}),timestamp:e.timestamp,changes:[]})},VSe=({edit:e})=>{var t;return((t=e.collectionViewData)==null?void 0:t.current)==null?null:r.jsx(fi,{edits:[e],action:"删除了视图",subject:r.jsx(yS,{view:e.collectionViewData.current}),timestamp:e.timestamp,changes:[]})},mk=e=>{var h,p;const t=lt(),n=ns(),s=mx(),{discussionId:a,from:o,to:i}=e,l=i!=null?i:o,c=_r((h=l==null?void 0:l.updatedBy)!=null?h:""),d=Ce(g=>g.discussions[a],[a]),u=Un(),f=ln();return d==null||l==null?null:r.jsx("div",{className:R("flex",e.className),children:r.jsxs("div",{className:"flex-1 ml-1  animate-hover",onClick:()=>{const g=d.parentId,_=ww(g),x=g===_,F=()=>{var C;let b=0;if(((C=J.blocks[g])==null?void 0:C.status)!==m.BlockStatus.NORMAL)return;x&&gFe(_,!0);const w=setInterval(()=>{let k;if(x?k=bn('[data-comment-id="'.concat(l.uuid,'"]')):k=bn('[data-comment-block-id="'.concat(g,'"]')),b++,k&&k instanceof HTMLElement||b>15){if(x){const T=k==null?void 0:k.querySelector(".comment-text");T&&(T==null||T.setAttribute("style","border-color:var(--active_color);opacity: 100"),T==null||T.classList.add("animate__flash"),Ao(1500).then(()=>{T.classList.remove("animate__flash"),T.removeAttribute("style")})),k==null||k.scrollIntoView(),setTimeout(()=>{T==null||T.removeAttribute("style")},5e3)}else k==null||k.click();clearInterval(w)}},500),E=n.listen(()=>{E(),clearInterval(w)})};_!=null&&_!==t?(n.push("/".concat(_,"#").concat(g)),F()):x?F():s(d.parentId,{callback:b=>{b==="animateScrollEnd"&&F()}}),u===wt.NOTIFICATION&&f(Ve.MESSAGE_NOTIFICATION)},children:[r.jsxs("div",{className:"mb-1.5",children:[r.jsx("span",{className:"text-t2 text-grey3",children:c}),r.jsx("span",{className:"ml-1.5 text-t4 text-grey4",children:r.jsx(Fe,{popup:ue(l.updatedAt).format(On),className:"inline",children:r.jsx(Lj,{timestamp:(p=l.updatedAt)!=null?p:Date.now()})})})]}),r.jsx("div",{children:r.jsx(oh,{className:"whitespace-pre-wrap",segmentsA:o==null?void 0:o.text,segmentsB:i==null?void 0:i.text})})]})})},$Se=e=>{var i,l,c,d,u;const{pageActivity:t,alreadyRead:n=!0}=e,s=Ce(f=>{if(t.discussionId!=null)return f.discussions[t.discussionId]},[t.discussionId]),a=vV("all"),o=[];for(const f of t.edits)f.type==="commentCreated"?o.push(r.jsx(mk,{discussionId:f.discussionId,from:void 0,to:(i=f.commentData)==null?void 0:i.current},o.length)):f.type==="commentChanged"?o.push(r.jsx(mk,{discussionId:f.discussionId,from:(l=f.commentData)==null?void 0:l.before,to:(c=f.commentData)==null?void 0:c.after},o.length)):o.push(r.jsx(mk,{discussionId:f.discussionId,from:(d=f.commentData)==null?void 0:d.current,to:void 0},o.length));return s==null||o.length<=0?null:r.jsx(fi,{edits:t.edits,action:"发布了评论",subject:r.jsx(gh,{pageId:t.parentId}),subjectFirst:!0,timestamp:t.endTime,header:fe(s.context)===""?void 0:r.jsx("div",{className:"my-1.5 ml-1 border-l-[3px] border-l-yellow pl-2 line-clamp-3",children:r.jsx(fs,{className:"opacity-60",segments:s.context})}),badge:!n&&r.jsx("div",{className:"rounded-full w-2 h-2 bg-active_color"}),footer:s.status===m.BlockStatus.NORMAL&&((u=J.blocks[s.parentId])==null?void 0:u.status)===m.BlockStatus.NORMAL?r.jsx("div",{className:"ml-1 mt-3 mb-1.5",children:r.jsx(De,{onClick:f=>{a({popcorn:f.currentTarget,selector:h=>{var g;const p=h.discussions[(g=t.discussionId)!=null?g:""];return p==null?[]:p.status!==m.BlockStatus.NORMAL?[]:[p]},autoFocus:!0})},children:"回复"})}):void 0,changes:o})},HSe=({edit:e})=>r.jsx(fi,{edits:[e],action:"锁定了",subject:r.jsx(gh,{pageId:e.navigableBlockId}),timestamp:e.timestamp,changes:[]}),zSe=({edit:e})=>r.jsx(fi,{edits:[e],action:"解锁了",subject:r.jsx(gh,{pageId:e.navigableBlockId}),timestamp:e.timestamp,changes:[]}),qSe=({edit:e})=>r.jsx(fi,{edits:[e],action:"创建了",subject:r.jsx(gh,{pageId:e.navigableBlockId}),timestamp:e.timestamp,changes:[]}),GSe=({edit:e})=>r.jsx(fi,{edits:[e],action:"删除了",subject:r.jsx(Ir,{uuid:e.navigableBlockId,interactable:!0}),timestamp:e.timestamp,changes:[]}),WSe=({edit:e})=>r.jsx(fi,{edits:[e],action:"恢复了",subject:r.jsx(gh,{pageId:e.navigableBlockId}),timestamp:e.timestamp,changes:[]}),cG=({from:e,to:t})=>{const n=t!=null?t:e;if(n==null)return null;const s=(()=>e!==void 0&&t!==void 0?r.jsxs("div",{className:"flex items-center text-t2",children:[r.jsx("span",{children:r.jsx(Ny,{permission:e})}),r.jsx(V,{name:"IcDateEnd",size:"middle",className:"mx-2 text-grey3"}),r.jsx("span",{children:r.jsx(Ny,{permission:t})})]}):e!==void 0&&t===void 0?r.jsx("div",{className:"text-t2",children:r.jsx("span",{className:"line-through text-grey4",children:r.jsx(Ny,{permission:e})})}):t!==void 0&&e===void 0?r.jsx("div",{className:"text-t2",children:r.jsx("span",{className:"bg-active_color/10 text-active_color",children:r.jsx(Ny,{permission:t})})}):null)();return r.jsxs("div",{className:"mt-2 px-1",children:[r.jsx("div",{className:"text-t4 text-grey3",children:r.jsx(KSe,{permission:n})}),s]})},Ny=({permission:e})=>{if(e.type===m.PermissionType.ILLEGAL)return null;if(e.type===m.PermissionType.PUBLIC)return r.jsx(r.Fragment,{children:"可查看"});if(e.type===m.PermissionType.RESTRICTED)return r.jsx(r.Fragment,{children:"未开启"});switch(e.role){case m.PermissionRole.NONE:return r.jsx(r.Fragment,{children:"无权限"});case m.PermissionRole.READER:return r.jsx(r.Fragment,{children:"只读"});case m.PermissionRole.COMMENTER:return r.jsx(r.Fragment,{children:"可评论"});case m.PermissionRole.WRITER:return r.jsx(r.Fragment,{children:"可编辑"});case m.PermissionRole.EDITOR:return r.jsx(r.Fragment,{children:"所有权限"});default:return null}},KSe=({permission:e})=>{switch(e.type){case m.PermissionType.PUBLIC:case m.PermissionType.RESTRICTED:return r.jsx(r.Fragment,{children:E3});case m.PermissionType.ILLEGAL:return null;case m.PermissionType.SPACE:return r.jsx(ESe,{});case m.PermissionType.GROUP:return r.jsxs(r.Fragment,{children:["「",r.jsx(kSe,{groupId:e.groupId}),"」成员组"]});case m.PermissionType.USER:return r.jsx(CSe,{userId:e.userId});default:return null}},YSe=({pageActivity:e})=>{const t=e.edits.map((n,s)=>{const[a,o]=(()=>{var i,l,c,d;switch(n.type){case"permissionCreated":return[void 0,(i=n.permissionData)==null?void 0:i.current];case"permissionChanged":return[(l=n.permissionData)==null?void 0:l.before,(c=n.permissionData)==null?void 0:c.after];case"permissionDeleted":return[(d=n.permissionData)==null?void 0:d.current,void 0];default:throw new Error("Assertion failed")}})();return r.jsx(cG,{from:a,to:o},s)});return r.jsx(fi,{edits:e.edits,action:"修改了权限",subject:r.jsx(gh,{pageId:e.parentId}),timestamp:e.endTime,changes:t})},XSe=({pageActivity:e})=>{var n,s;const t=[];for(const a of e.edits)for(const o of(s=(n=a.permissionData)==null?void 0:n.calculatedChanges)!=null?s:[])t.push(r.jsx(cG,{from:o.before,to:o.after},t.length));return r.jsx(fi,{edits:e.edits,action:e.type==="permissionRestrictionCreated"?"修改权限为不再继承上级页面权限":"恢复了继承上级页面权限",timestamp:e.endTime,changes:t})},QSe=()=>{const e=rr(()=>({lastPageActivityId:void 0,initialLoaded:!1,pageActivities:[],blocks:{},loading:!1,more:!0})),t=_B(),n=lt(),s=y.useCallback(async()=>{var l;if(e.loading)return;e.loading=!0,t();const{lastPageActivityId:o}=e,i=await ve.editor.getDocActivities(n,o);if(i.results.length>=1){const{results:c}=i;e.lastPageActivityId=(l=c[c.length-1])==null?void 0:l.activityId,o===void 0&&(e.pageActivities=[]),e.pageActivities.push(...c)}i.recordMap.activities&&cSe(i.recordMap.activities),i.recordMap.blocks&&re(Tn.update({blocks:i.recordMap.blocks})),i.recordMap.discussions&&re(Oh.update(i.recordMap.discussions)),i.recordMap.comments&&re(z3.update(i.recordMap.comments)),e.initialLoaded=!0,e.loading=!1,e.more=i.more,t()},[n,t,e]),[a]=_L({loading:e.loading,hasNextPage:e.more,onLoadMore:s});return r.jsxs("div",{className:R("h-full flex flex-col",Mn({selectors:{"&:empty::after":{display:"block",content:"暂无动态",position:"absolute",fontSize:"14px",color:"var(--grey4)",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}})),children:[e.pageActivities.flatMap(o=>r.jsx(lG.Provider,{value:o.historyId,children:r.jsx(JSe,{pageActivityId:o.activityId})},o.activityId)),(e.loading||e.more)&&r.jsx("div",{className:"flex-1 min-h-[60px] overflow-hidden py-10",ref:a,children:r.jsx(xs,{})})]})},JSe=({pageActivityId:e})=>{const t=lSe(e);return t==null?null:t.type==="blockEdited"?r.jsx(LSe,{pageActivity:t}):t.type==="permissionsEdited"?r.jsx(YSe,{pageActivity:t}):t.type==="permissionRestrictionCreated"||t.type==="permissionRestrictionDeleted"?r.jsx(XSe,{pageActivity:t}):t.type==="commented"?r.jsx($Se,{pageActivity:t}):r.jsx(r.Fragment,{children:t.edits.map((n,s)=>r.jsx(ZSe,{edit:n},s))})},ZSe=({edit:e})=>{switch(e.type){case"blockCreated":case"blockChanged":case"blockDeleted":return null;case"pageLocked":return r.jsx(HSe,{edit:e});case"pageUnlocked":return r.jsx(zSe,{edit:e});case"pageCreated":return r.jsx(qSe,{edit:e});case"pageDeleted":return r.jsx(GSe,{edit:e});case"pageRestored":return r.jsx(WSe,{edit:e});case"collectionViewCreated":return r.jsx(MSe,{edit:e});case"collectionViewChanged":return r.jsx(USe,{edit:e});case"collectionViewDeleted":return r.jsx(VSe,{edit:e});case"collectionPropertyCreated":case"collectionPropertyChanged":case"collectionPropertyDeleted":return r.jsx(OSe,{edit:e});default:return null}};var FS=(e=>(e[e.PAGE_INFO=0]="PAGE_INFO",e[e.PAGE_FEED=1]="PAGE_FEED",e))(FS||{});let dG=0;const uG=e=>{dG=e},BRe=()=>{const e=y.useRef(null),[t,n]=y.useState(dG),s=t===1;return r.jsx(Ec.Provider,{value:e,children:r.jsxs("div",{className:"h-full flex flex-col items-stretch",children:[r.jsx("div",{className:"h-[50px] border-b border-b-grey6 text-t2-medium",children:r.jsxs("div",{className:"h-full flex items-center mx-4 space-x-7",children:[r.jsx("span",{className:R("cursor-pointer",!s&&"underline underline-offset-[19.5px]"),onClick:()=>{n(0)},children:"页面信息"}),r.jsx("span",{className:R("cursor-pointer",s&&"underline underline-offset-[19.5px]"),onClick:()=>{n(1)},children:"页面动态"})]})}),r.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto",children:[r.jsx("div",{style:{display:s?"block":"none"},children:r.jsx(QSe,{})}),r.jsx("div",{style:{display:s?"none":"block"},children:r.jsx(eSe,{})})]})]})})},eDe=e=>{const t=[{type:"top",title:"顶部"},{type:"bottom",title:"底部"}].map(n=>({type:H.OPERABLE_BLOCK_TEXT,data:{...n,selected:n.type===e.commentAlignment}}));return r.jsx(ze,{className:"rounded-r next-modal py-1.5 w-[160px]",items:t,onItemClick:n=>{e.onChangeCommentAlignment(n.data.type)}})},tDe=e=>{Pa();const t=df(),n=ya(),s=po(),{fontFormat:a,pageLayout:o}=NH(e.pageId),i=Oe(),l=d=>{var f;if(s&&["lxgwWenKai","sourceHanSerif","loraVariable","dmMono"].includes(d)){t(()=>{n(Mt.custom_font_layout)});return}let u="default";d==="lxgwWenKai"?u="LXGW_WenKai":d==="sourceHanSerif"?u="Source_Han_Serif_SCVF":d==="loraVariable"?u="loraVariable":d==="dmMono"&&(u="dmMono"),me.event("font_set",{font_type:u}),i(()=>{_e(e.pageId,{data:{format:{fontFormat:d}}})}),(f=e.onOperationFinish)==null||f.call(e)},c=d=>{var f;if(s&&(d==="compact"||d==="loose")){t(()=>{n(Mt.custom_font_layout)});return}let u="default";d==="compact"?u="tight":d==="loose"&&(u="loose"),me.event("font_set",{layout_set:u}),i(()=>{_e(e.pageId,{data:{format:{pageLayout:d}}})}),(f=e.onOperationFinish)==null||f.call(e)};return r.jsxs("div",{className:e.className,children:[!e.hideFontComponent&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t4 text-grey3",children:Wa.pageFont}),r.jsxs("div",{className:"grid grid-cols-3 gap-x-2",children:[r.jsx(hk,{title:"息流",desc:"默认",isSelected:a==="default",onClick:()=>{l("default")}}),r.jsx(hk,{title:"息流",desc:"霞鹜文楷",showPro:s,isSelected:a==="lxgwWenKai",style:{fontFamily:$c.lxgwWenKai},onClick:()=>{l("lxgwWenKai")}}),r.jsx(hk,{title:"息流",desc:"思源宋体",showPro:s,isSelected:a==="sourceHanSerif",style:{fontFamily:$c.sourceHanSerif},onClick:()=>{l("sourceHanSerif")}})]})]}),!e.hideLayoutComponent&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t4 text-grey3 mt-5",children:"页面布局"}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx(pk,{title:"紧密",showPro:s,src:vn.compactLayout,isSelected:o==="compact",onClick:()=>{c("compact")}}),r.jsx(pk,{title:"默认",src:vn.defaultLayout,isSelected:o==="default",onClick:()=>{c("default")}}),r.jsx(pk,{title:"宽松",showPro:s,src:vn.looseLayout,isSelected:o==="loose",onClick:()=>{c("loose")}})]})]})]})},hk=e=>r.jsxs("div",{className:R("relative flex flex-col justify-center items-center min-h-[60px] py-1 border border-solid mt-2.5 rounded cursor-pointer",{"border-active_color":e.isSelected,"border-grey6 ":!e.isSelected,"bg-active_color/5":e.isSelected}),style:e.style,onClick:e.onClick,children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-t2 text-center",children:e.title}),r.jsx("div",{className:"text-t4 mt-1 text-grey3 text-center",children:e.desc})]}),e.showPro&&r.jsx(_l,{})]}),pk=e=>r.jsxs("div",{className:R("relative flex flex-col justify-center items-center w-[66px] py-1 min-h-[44px] border-[1px] border-solid mt-2.5 rounded cursor-pointer",{"border-active_color":e.isSelected,"border-grey6 ":!e.isSelected,"bg-active_color/5":e.isSelected}),style:{borderColor:e.isSelected?"--active_color":void 0},onClick:e.onClick,children:[r.jsxs("div",{className:R("flex items-center",!1),children:[r.jsx("img",{src:e.src,className:"w-5"}),r.jsx("div",{className:"text-t4 text-grey3 text-center ml-1",children:e.title})]}),e.showPro&&r.jsx(_l,{})]}),fG=()=>{const e=lt(),t=ie(),n=pt(),s=We(e),a=ye(e,[]),o=k0(e),i=pt(),l=u=>{var h;if(d)return;me.event("page_menu_click",{page_type:(h=pe().blocks[e])==null?void 0:h.type,is_share:n});const f=u.currentTarget;t.dropdown({modalId:Ve.PAGE_HEADER_MENU_LIST,popcorn:f,placement:"bottom-end",offset:[0,15],content(){return r.jsx(nDe,{popcorn:f,uuid:e})}})},c=(a==null?void 0:a.type)!==m.BlockType.PAGE,d=!n&&(s||c&&!o);return r.jsx(Fe,{popup:"菜单",id:"page-header-more",...Gs(Hs.pageHeaderMore),disabled:d,onClick:l,className:R("p-1 flex items-center justify-center",d?"cursor-not-allowed":"animate-hover"),children:r.jsx(V,{size:"middle",name:"IcMore",className:R(d&&"opacity-20")})})},nDe=e=>{var Y,G,ee;const{popcorn:t,uuid:n}=e,s=Ln(),a=dh(),o=s2(n),i=ye(n,["data","updatedAt","updatedBy"],["pageFixedWidth","directoryMenu","format","isByAI"]),l=_r((Y=i==null?void 0:i.updatedBy)!=null?Y:""),{pageFixedWidth:c=!0,directoryMenu:d}=(i==null?void 0:i.data)||{},u=Pd(),f=Oe(),{selectedBlockHistory:h}=Nl(),p=k0(n),g=Tl(n),_=Mw(n),x=NV(n),F=ie(),b=ln(),w=hx(n),E=m9(),C=ai(),k=_4(n),T=Y4e(),v=ya(),I=Js(),j=_S(),S=_o(),D=(ee=(G=i==null?void 0:i.data.format)==null?void 0:G.commentAlignment)!=null?ee:"top",A=Ip("abandonedExport"),{illegal:P,role:L}=mt(n),O=[m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(L),$=pt(),M=(i==null?void 0:i.type)!==m.BlockType.PAGE,U=(i==null?void 0:i.type)===m.BlockType.COLLECTION_VIEW||(i==null?void 0:i.type)===m.BlockType.COLLECTION_VIEW_PAGE||(i==null?void 0:i.type)===m.BlockType.REFERENCE_COLLECTION||(i==null?void 0:i.type)===m.BlockType.REFERENCE_COLLECTION_PAGE,z=(i==null?void 0:i.type)===m.BlockType.FOLDER,K=_d();let W=x;return $||(P?W=[C&&E.includes(n)?{type:H.OPERATION,data:{icon:"MIcSettingsLogout",title:"退出协作",onClick:()=>{Mv(n)}}}:{type:H.OPERATION,data:{icon:"IcTrash",title:"彻底删除",onClick:()=>w()}},{type:H.LINE,isHidden:!O,data:{},disableClick:!0}]:W=[{type:H.TEXT_SWITCH,isHidden:M,data:{title:Wa.fixedWidth,switch:c,onSwitch:te=>{me.event("fixedwidth",{is_open:te}),f(()=>{_e(n,{data:{pageFixedWidth:te}})})}}},{type:H.TEXT_SWITCH,isHidden:M,data:{title:"页面目录",switch:d,onSwitch:te=>{var se,ce;if(me.event("float_catalog_switch",{is_open:te}),f(()=>{I(Je.CREATE_HEADER_BLOCK,ct.basicList,{step2:!0}),_e(n,{data:{directoryMenu:te}})}),!te||((se=yt.setting)==null?void 0:se.directoryMenu))return;const ne=parseInt((ce=sessionStorage.getItem("settingTipCount"))!=null?ce:"0",10);sessionStorage.setItem("settingTipCount",(ne+1).toString()),ne===2&&F.warning({title:"是否希望新建页面的目录自动打开?",content:"【设置】->【通用设置】->【新建页面目录】",cancelText:"取消",colorType:"active",confirmText:"现在就去设置",confirm:()=>{S({defaultMenuType:Kt.general,from:Mt.tip})}})}}},{type:H.LINE,isHidden:M||!p,data:{},disableClick:!0},{type:H.CUSTOM_RENDER,isHidden:ir(i==null?void 0:i.type),render:()=>r.jsx(tDe,{className:"px-4 my-3",pageId:n,hideLayoutComponent:U||z})},{type:H.LINE,isHidden:ir(i==null?void 0:i.type),data:{},disableClick:!0},{type:H.OPERATION,isHidden:ir(i==null?void 0:i.type),data:{icon:"IcComment",title:"页面评论位置",hasArrow:!0,renderSubMenu:()=>r.jsx(eDe,{commentAlignment:D,onChangeCommentAlignment:te=>{f(()=>{_e(n,{data:{format:{commentAlignment:te}}})})}})}},{type:H.OPERATION,isHidden:M&&!U&&!ir(i==null?void 0:i.type),data:{icon:g?"IcUnlock":"IcLock",title:g?U?"解锁多维表":"解锁页面":U?"锁定多维表":"锁定页面",tip:U?"锁定时，无法新增/修改多维表的配置、视图和属性，但可以新增/编辑记录。":"锁定时，无法编辑页面",onClick:()=>{me.event("page_lock",{is_open:!g}),f(()=>{_e(n,{data:{format:{locked:!g,lockedBy:yt.uuid}}})})},rightText:"".concat(Ds,"+L")}},{type:H.LINE,isHidden:M&&!U||z,data:{},disableClick:!0},{type:H.OPERATION,isHidden:!p||L===m.PermissionRole.READER||L===m.PermissionRole.NONE,data:{icon:"IcLink",title:"拷贝页面访问链接",onClick:qn(()=>{me.event("copy_page_link"),Xt("".concat(_n()).concat(K.pathname))},300,{leading:!0})}},{type:H.LINE,isHidden:M||o||!p,data:{},disableClick:!0},{type:H.OPERATION,isHidden:L===m.PermissionRole.READER||L===m.PermissionRole.NONE,data:{icon:"IcUndo",rightText:"".concat(Ds,"+Z"),title:"撤销",onClick:qn(()=>{me.event("undo_click"),re(jm())},300,{leading:!0})}},{type:H.OPERATION,isHidden:L===m.PermissionRole.READER||L===m.PermissionRole.NONE,data:{icon:"IcRedo",rightText:"".concat(Ds,"+Shift+Z"),title:"重做",onClick:qn(()=>{me.event("redo_click"),re(cg())},300,{leading:!0})}},{type:H.OPERATION,isHidden:L!==m.PermissionRole.EDITOR&&L!==m.PermissionRole.WRITER,data:{icon:"IcPageHistory",title:"页面历史",onClick:qn(()=>{F.modal({modalId:Ve.DOC_HISTORY_MODAL_ID,content:()=>r.jsx(xj,{docId:n})})},300,{leading:!0})}},{type:H.OPERATION,isHidden:!Xn(L,m.PermissionRole.WRITER),data:{icon:"IcCommentResolved",title:"已解决评论",onClick:qn(()=>{rG(xS.RESOLVE_COMMENT),j(s?"page-resolved-discussions-right":"page-resolved-discussions")},300,{leading:!0})}},{type:H.OPERATION,isHidden:o||!p||L===m.PermissionRole.READER||L===m.PermissionRole.NONE,data:{icon:"IcTrash",title:"删除",onClick:qn(()=>{me.event("delete_pageclick"),f(()=>{gr(n)})},300,{leading:!0})}},{type:H.LINE,data:{},disableClick:!0},{type:H.TEXT_SWITCH,isHidden:z||o||C||L===m.PermissionRole.READER||L===m.PermissionRole.NONE,data:{icon:"IcTemplate",iconSize:"small",title:"转换为模板",switch:k,context:Wt({title:"转换为模板后，空间成员可以在模板库看到并使用模板。有协作权限的成员可以在空页面上选择[从模板库选择创建]",image:"custom_template_tip"}),onSwitch:te=>{f(()=>{if(te){if(!T){me.event("temp_switch",{is_open:!0}),Sle(n,{parentId:Pn().uuid,first:!0}),_e(n,{data:{createdTemplateBy:yt.uuid}}),I(Je.CONVERT_TO_TEMPLATE,ct.advancedList);return}F.warning({title:r.jsx("div",{className:"mb-5",children:r.jsx("p",{className:"text-t1-medium mb-2.5",children:"已达到空间模板上限，升级空间解锁无限数量的模板。"})}),colorType:"active",confirmText:"升级空间",confirm:()=>{v(Mt.temp_max)}})}else me.event("temp_switch",{is_open:!1}),TN(n,{parentId:Pn().uuid})})}}},{type:H.OPERATION,isHidden:z||!1,data:{disable:A,icon:"IcExportPage",title:"导出页面",onClick:qn(()=>{F.modal({content:({onCloseModal:te})=>ir(i==null?void 0:i.type)?r.jsx(MH,{onCloseModal:te,id:n}):r.jsx(BH,{onCloseModal:te})})},300,{leading:!0})}},{type:H.LINE,isHidden:!_||z,data:{},disableClick:!0},{type:H.OPERATION,isHidden:!z,data:{icon:"IcDownload",title:"下载",onClick:()=>{a([n])}}},{type:H.OPERATION,isHidden:!_,data:{icon:"IcMove",rightText:"".concat(Ds,"+Shift+P"),title:"移动到",onClick:()=>{me.event("moveto_pageclick"),h([]),u({popcorn:t,uuid:n,placement:"bottom-end",offset:[0,15]})}}},{type:H.LINE,isHidden:!(O&&!$),data:{},disableClick:!0},{type:H.OPERATION,data:{icon:"IcInfo",title:"页面信息",onClick:()=>{uG(FS.PAGE_INFO),j(s?"page-feeds-right":"page-feeds")}}},{type:H.LINE,data:{},disableClick:!0}]),r.jsx(ze,{className:"py-1 rounded-r w-64 next-modal max-h-[90vh] overflow-auto",items:W,customFooter:O&&!$&&r.jsx(Zm,{name:l,updatedAt:i==null?void 0:i.updatedAt,showWordCount:(i==null?void 0:i.type)===m.BlockType.PAGE,showMindNodeCount:ir(i==null?void 0:i.type),isByAI:i==null?void 0:i.data.isByAI}),onItemClick:()=>b(Ve.PAGE_HEADER_MENU_LIST)})},mG=({className:e})=>{const[t,n]=gS(),s=Ln(),a=s&&t==="page-resolved-discussions-right"||!s&&t==="page-resolved-discussions";return r.jsx(Fe,{popup:t?"关闭评论列表":"查看评论列表",className:R("p-1 flex items-center justify-center animate-hover",a&&"bg-black_006",e),onClick:()=>{rG(xS.UN_RESOLVE_COMMENT),n(s?t!=="page-resolved-discussions-right"?"page-resolved-discussions-right":!1:t!=="page-resolved-discussions"?"page-resolved-discussions":!1)},children:r.jsx(V,{name:"IcComment",size:"middle"})})},hG=({className:e})=>{const[t,n]=gS(),s=Ln(),a=s&&t==="page-feeds-right"||!s&&t==="page-feeds";return r.jsx(Fe,{popup:t?"关闭页面信息":"查看页面信息",className:R("p-1 flex items-center justify-center animate-hover",a&&"bg-black_006",e),onClick:()=>{uG(FS.PAGE_INFO),n(s?t!=="page-feeds-right"?"page-feeds-right":!1:t!=="page-feeds"?"page-feeds":!1)},children:r.jsx(V,{name:"IcInfo",size:"middle"})})},sDe=()=>{var l;const e=lt(),t=Ln(),n=s2(e),s=Qq(e),a=ye(e,["isTemplate"]),o=Ed(),i=We(e);return r.jsxs(r.Fragment,{children:[t&&r.jsx(rDe,{}),r.jsx(qq,{type:"header"}),!s&&n&&r.jsx(Vj,{uuid:e}),(a==null?void 0:a.isTemplate)&&r.jsxs(W4e,{className:"flex justify-between text-t2",children:[(l=o.location.state)!=null&&l.noticeBannerShowBackButton?r.jsxs("button",{className:"text-grey3 ml-3 pl-1 pr-2 flex items-center animate-hover",onClick:()=>{o.goBack()},children:[r.jsx(V,{name:"IcArrowBack",size:"middle",className:"mt-[1px]"}),"返回"]}):r.jsx("span",{}),r.jsx("span",{className:"flex items-center",children:r.jsxs(r.Fragment,{children:["你正在",r.jsx(Ir,{className:"text-black",uuid:a.parentId,isLinkPage:!0,interactable:!0,autoIconSize:!0}),i?"查看":"编辑","模板记录"]})}),r.jsx("span",{})]})]})},rDe=()=>{const e=lt();tG(e);const t=ea(QN),s=Object.values(t).find(_=>_.checkRecord(e)),a=ns(),o=pw(),i=JZ(),l=YZ(),c=pt(),d=S3(),{role:u,illegal:f}=mt(e),h=uf(e),p=f||d,g=Xq();return y.useEffect(()=>{if(s==null)return;const _=gb(document,"keydown").subscribe(x=>{if(Ie("ctrl+shift+k")(x)){const F=s.prevRecord(e);if(F==null)return;a.push("/".concat(F)),x.preventDefault()}else if(Ie("ctrl+shift+j")(x)){const F=s.nextRecord(e);if(F==null)return;a.push("/".concat(F)),x.preventDefault()}});return()=>_.unsubscribe()},[a,e,s]),r.jsxs("div",{className:R("absolute top-0 left-0 w-full bg-white2 flex items-center justify-between z-50 px-4 text-black transition-all border-b border-transparent",Yq(g)&&"border-grey6"),style:{height:Jq},children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx(nk,{title:"关闭",text:"".concat(nC,"+Q"),icon:"IcClose",onClick:o}),r.jsx(nk,{title:"切换",text:"".concat(nC,"+'"),icon:"IcTitleSwitch",onClick:l}),r.jsx(nk,{title:"放大",text:"".concat(nC,"+F"),icon:"IcMenuOpen",onClick:i}),s!=null&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-0 border-l-[1px] border-grey6  h-[14px]"}),r.jsx(Fe,{popup:r.jsx(jv,{title:"上一条记录",text:"ctrl+Shift+K",className:"w-28"}),children:r.jsx("button",{className:"flex items-center justify-center w-5 h-5 rounded outline-none animate-hover disabled:opacity-30",disabled:s.prevRecord(e)==null,onClick:()=>{const _=s.prevRecord(e);_!=null&&a.push("/".concat(_))},children:r.jsx(V,{name:"IcArrowPagePrev",size:"middle"})})}),r.jsx(Fe,{popup:r.jsx(jv,{title:"下一条记录",text:"ctrl+Shift+J",className:"w-28"}),children:r.jsx("button",{className:"flex items-center justify-center w-5 h-5 rounded outline-none animate-hover disabled:opacity-30",disabled:s.nextRecord(e)==null,onClick:()=>{const _=s.nextRecord(e);_!=null&&a.push("/".concat(_))},children:r.jsx(V,{name:"IcArrowPageNext",size:"middle"})})})]}),r.jsx(cS,{uuid:e})]}),r.jsxs("div",{className:"flex item-center z-10 space-x-2",children:[!c&&!p&&!h&&r.jsx(tx,{showType:"button"}),!f&&(u===m.PermissionRole.WRITER||u===m.PermissionRole.EDITOR)&&r.jsx(mG,{}),!f&&(u===m.PermissionRole.WRITER||u===m.PermissionRole.EDITOR)&&r.jsx(hG,{}),!c&&!f&&r.jsx(KE,{uuid:e}),r.jsx(fG,{})]})]})},aDe=()=>{var c,d;const e=lt(),t=ye(e,[]),n=pc(t==null?void 0:t.spaceId),s=(c=Dw(t==null?void 0:t.spaceId))==null?void 0:c.showPublicHomePage,a=pt(),o=ns(),i=go((d=n.publicHomePage)!=null?d:"");return!t||!n||!a||!Rw(t==null?void 0:t.spaceId)||!s||!n.domain||!n.publicHomePage?null:r.jsx(Fe,{className:"flex items-center",popup:"空间公开主页",onClick:()=>{o.push(i),Xl.lastGoBackPath=i,Xl.tmpDisable=!0,setTimeout(()=>{Xl.tmpDisable=!1},500)},children:r.jsx(V,{name:"IcHome",size:"middle",className:"text-black"})})},pG=()=>y.useCallback(async e=>{var l,c,d;const{space:t,...n}=e,s=await ve.infra.searchDocs(t,n),a=(l=s.recordMap)==null?void 0:l.blocks;if(!a)return{hasMore:!1,results:[],total:(c=s.total)!=null?c:0};const o=u=>{const f=[];let h=a[u];for(;h&&h.spaceId!==h.uuid;)h=a[h.parentId],h&&tn(h.type)&&f.unshift(h);return f};re(Tn.update({blocks:a}));const i=[];return s.results.forEach(u=>{if(u.pageId){const f=o(u.pageId);i.push({...u,navs:f})}}),{hasMore:s.results.length===e.perPage,results:i,total:(d=s.total)!=null?d:0}},[]),gi=e=>{var t,n;return r.jsxs("div",{className:"flex flex-row items-center ".concat(e.className),style:e.style,onClick:e.onClick,children:[r.jsx(V,{size:"middle",name:e.name}),r.jsx("div",{className:"ml-2 ".concat((t=e.textConfig)==null?void 0:t.className),style:(n=e.textConfig)==null?void 0:n.style,children:e.text})]})},gG=()=>{const e=ie(),t=y.useRef();return y.useCallback((n,s,a)=>{e.dropdown({popcorn:n.target,placement:"bottom",closeBeforeCallBack:()=>{t.current&&s(t.current)},content:({onCloseModal:o})=>{const i=new Date;return i.setHours(0,0,0,0),r.jsx(I$,{includeTime:!1,showTimeSwitch:!1,date:a!=null?a:{from:i},selectRangeDate:!0,closeDatePicker:()=>{o()},onChange:(l,c)=>{t.current=l},onClear:()=>{}})}})},[e])},_G=()=>{const e=ie();return y.useCallback((t,n,s)=>{e.dropdown({popcorn:t.target,placement:"bottom",content:({onCloseModal:a})=>r.jsx(oDe,{existPeople:n,onSelectPerson:o=>{s(o),a()}})})},[e])},oDe=e=>{const[t,n]=y.useState(""),a=M0().filter(o=>!e.existPeople.includes(o.uuid));return r.jsx("div",{className:"w-[260px] py-2 next-modal",children:r.jsx(Yj,{customHeader:r.jsx(Ct,{autoFocus:!0,className:"h-8 mx-2.5 mb-2.5",placeholder:"搜索成员",onChange:o=>{n(o)}}),className:"py-1.5",search:t,users:a,onSelectPerson:e.onSelectPerson})})},xG=()=>{const e=ie();return y.useCallback((t,n,s)=>{const a=p1({ancestorId:Ot(),filterTypes:[m.BlockType.FILE]});e.dropdown({popcorn:t.target,placement:"bottom",content:({onCloseModal:o})=>r.jsx(oc,{filterItems:n,defaultValue:a,onSelect:i=>{s(i.uuid),o()}})})},[e])},OP=7*24*60*60*1e3,Bl="rounded pl-2 h-10 cursor-pointer hover:bg-black_006",iDe=e=>{const t=lt(),[n,s]=y.useState(e.defaultFilter),a=y.useCallback(A=>{s(P=>{const L=A(P);if(!L)return P;const O={...P,...L};return e.onFilterChange(O),O})},[e]),o=()=>{a(A=>({isTitleOnly:!A.isTitleOnly}))},i=xG(),l=_G(),c=gG(),d=y.useCallback(A=>{i(A,[],P=>{a(L=>{var $,M,U;if(((M=($=L.ancestors)==null?void 0:$.indexOf(P))!=null?M:-1)===-1)return{ancestors:[...(U=L.ancestors)!=null?U:[],P]}})})},[i,a]),u=y.useCallback(A=>{var P;l(A,(P=n.createdBy)!=null?P:[],L=>{a(O=>{var M,U,z;if(((U=(M=O.createdBy)==null?void 0:M.indexOf(L))!=null?U:-1)===-1)return{createdBy:[...(z=O.createdBy)!=null?z:[],L]}})})},[n.createdBy,l,a]),f=y.useCallback(A=>{c(A,P=>{a(()=>{var L;return{createdTime:{start:P.from.getTime(),end:(L=P.to)==null?void 0:L.getTime()}}})})},[c,a]),h=y.useCallback(A=>{c(A,P=>{a(()=>{var L;return{lastEditedTime:{start:P.from.getTime(),end:(L=P.to)==null?void 0:L.getTime()}}})})},[c,a]),p=y.useCallback(()=>{a(A=>{var P;return{createdBy:[...(P=A.createdBy)!=null?P:[],yt.uuid]}})},[a]),g=y.useCallback(()=>{const A=new Date(Date.now()-OP);A.setHours(0,0,0,0);const P=new Date;P.setHours(0,0,0,0),a(()=>({lastEditedTime:{start:A.getTime(),end:P.getTime()}}))},[a]),_=y.useCallback(()=>{a(A=>{var P;return{...A,ancestors:[...(P=A.ancestors)!=null?P:[],t]}})},[t,a]),{ancestors:x,createdBy:F,createdTime:b,lastEditedTime:w}=n,E=!(F!=null&&F.includes(yt.uuid)),C=!(x!=null&&x.includes(t)),k=y.useMemo(()=>{const A=new Date(Date.now()-OP);A.setHours(0,0,0,0);const P=new Date;return P.setHours(0,0,0,0),(w==null?void 0:w.start)!==A.getTime()||w.end!==P.getTime()},[w]),T=E||C||k,v=!(x!=null&&x.length),I=!(F!=null&&F.length),j=!b,S=!w,D=v||I||j||S;return r.jsxs("div",{className:"bg-grey9 px-2 text-t2 text-grey3 w-[220px] py-2.5 overflow-y-scroll flex-shrink-0",children:[r.jsxs("div",{className:"flex justify-between items-center h-10 ".concat(Bl),onClick:o,children:[r.jsx(gi,{name:"IcTitle",text:"只搜索标题"}),r.jsx(en,{bgClassName:"mr-2",open:!!n.isTitleOnly,onSwitch:o})]}),r.jsx(lDe,{filter:n,updateFilter:a}),T&&r.jsx("div",{className:"flex items-center mt-2.5 ml-2 h-9 select-none",children:"快速筛选"}),E&&r.jsx(gi,{className:Bl,name:"IcUser",text:"我创建的页面",onClick:p}),k&&r.jsx(gi,{className:Bl,name:"IcHistory",text:"上周编辑过的页面",onClick:g}),C&&r.jsx(gi,{className:Bl,name:"IcSearch",text:"在当前页面内搜索",onClick:_}),D&&r.jsx("div",{className:" flex items-center mt-2.5 ml-2 h-9 select-none",children:"自定义筛选"}),v&&r.jsx(gi,{className:Bl,name:"IcSearch",text:"在指定页面内搜索",onClick:d}),I&&r.jsx(gi,{className:Bl,name:"IcUser",text:"创建人",onClick:u}),j&&r.jsx(gi,{className:Bl,name:"IcHistory",text:"创建时间",onClick:f}),S&&r.jsx(gi,{className:Bl,name:"IcHistory",text:"最后编辑时间",onClick:h})]})},lDe=e=>{var h,p;const{updateFilter:t,filter:n}=e,s=_G(),a=gG(),o=xG(),i=g=>{let _;n.lastEditedTime&&n.lastEditedTime.start&&n.lastEditedTime.end&&(_={from:new Date(n.lastEditedTime.start),to:new Date(n.lastEditedTime.end)}),a(g,x=>{t(()=>{var F;return{lastEditedTime:{start:x.from.getTime(),end:(F=x.to)==null?void 0:F.getTime()}}})},_)},l=g=>{let _;n.createdTime&&n.createdTime.start&&n.createdTime.end&&(_={from:new Date(n.createdTime.start),to:new Date(n.createdTime.end)}),a(g,x=>{t(()=>{var F;return{createdTime:{start:x.from.getTime(),end:(F=x.to)==null?void 0:F.getTime()}}})},_)},c=(g,_)=>{var x;s(g,(x=n.createdBy)!=null?x:[],F=>{t(b=>{if(!b.createdBy)return b;if(_){const w=b.createdBy.indexOf(_);if(w!==-1){const E=b.createdBy.slice(0);return E.splice(w,1),E.splice(w,0,F),{createdBy:E}}}else return{createdBy:[...b.createdBy,F]};return b})})},d=g=>{t(_=>{if(!_.createdBy)return _;const x=_.createdBy.indexOf(g);if(x!==-1){const F=_.createdBy.slice(0);return F.splice(x,1),{createdBy:F}}return _})},u=(g,_)=>{var x;o(g,(x=n.ancestors)!=null?x:[],F=>{t(b=>{if(!b.ancestors)return b;if(_){const w=b.ancestors.indexOf(_);if(w!==-1){const E=b.ancestors.slice(0);return E.splice(w,1),E.splice(w,0,F),{ancestors:E}}}else return{ancestors:[...b.ancestors,F]};return b})})},f=g=>{t(_=>{if(!_.ancestors)return _;const x=_.ancestors.indexOf(g);if(x!==-1){const F=_.ancestors.slice(0);return F.splice(x,1),{ancestors:F}}return _})};return r.jsxs("div",{children:[r.jsx("div",{children:(h=n.createdBy)==null?void 0:h.map((g,_,x)=>r.jsxs("div",{children:[_===0&&r.jsx("div",{className:"flex items-center mt-2.5 ml-2 h-9 select-none",children:"创建人"}),r.jsxs("div",{className:"cursor-pointer rounded flex justify-between items-center pr-2 hover:bg-black_006",onClick:F=>{c(F,g)},children:[r.jsx(si,{className:"my-px px-2 py-1.5",userId:g}),r.jsx(V,{size:"normal",onClick:F=>{F.stopPropagation(),d(g)},name:"IcUploadCancel",className:"text-grey4",style:{width:"18px",height:"18px"}})]}),_===x.length-1&&r.jsx(gi,{className:"".concat(Bl," text-grey4"),name:"IcAddBoard",text:"添加人员",onClick:F=>{c(F)}})]},_))}),n.createdTime&&r.jsxs("div",{children:[r.jsx("div",{className:"flex items-center mt-2.5 ml-2 h-9 select-none text-center",children:"创建时间"}),r.jsxs("div",{className:"flex justify-between items-center cursor-pointer rounded hover:bg-black_006 pb-2",onClick:g=>{l(g)},children:[r.jsxs("div",{children:[r.jsx(gi,{className:"pl-2 h-10 text-black",name:"IcHistory",text:ue(n.createdTime.start).format(Et)}),r.jsxs("div",{className:"ml-9 text-black",children:["- ",ue(n.createdTime.end).format(Et)]})]}),r.jsx(V,{size:"normal",onClick:g=>{g.stopPropagation(),t(()=>({createdTime:void 0}))},name:"IcUploadCancel",className:"text-grey4 mr-2",style:{width:"18px",height:"18px"}})]})]}),n.lastEditedTime&&r.jsxs("div",{children:[r.jsx("div",{className:"flex items-center mt-2.5 ml-2 h-9 select-none text-center",children:"最后编辑"}),r.jsxs("div",{className:"flex justify-between items-center cursor-pointer rounded hover:bg-black_006 pb-2",onClick:g=>{i(g)},children:[r.jsxs("div",{children:[r.jsx(gi,{className:"pl-2 h-10 text-black",name:"IcHistory",text:ue(n.lastEditedTime.start).format(Et)}),r.jsxs("div",{className:"ml-9 text-black",children:["- ",ue(n.lastEditedTime.end).format(Et)]})]}),r.jsx(V,{size:"normal",onClick:g=>{g.stopPropagation(),t(()=>({lastEditedTime:void 0}))},name:"IcUploadCancel",className:"text-grey4 mr-2",style:{width:"18px",height:"18px"}})]})]}),r.jsx("div",{children:(p=n.ancestors)==null?void 0:p.map((g,_,x)=>r.jsxs("div",{children:[_===0&&r.jsx("div",{className:"flex items-center mt-2.5 ml-2 h-9 select-none",children:"页面内搜索"}),r.jsxs("div",{className:"cursor-pointer rounded py-1 pl-1 flex justify-between items-center hover:bg-black_006",onClick:F=>{u(F,g)},children:[r.jsx(Ir,{uuid:g,interactable:!1,className:"text-ellipsis pointer-events-none",showUnderLine:!1}),r.jsx(V,{size:"normal",onClick:F=>{F.stopPropagation(),f(g)},name:"IcUploadCancel",className:"text-grey4 mr-2",style:{width:"18px",height:"18px"}})]}),_===x.length-1&&r.jsx(gi,{className:"".concat(Bl," text-grey4"),name:"IcAddBoard",text:"添加页面",onClick:F=>{u(F)}})]},_))})]})},gk={[m.SearchDocSortType.RELEVANCE]:"按匹配度",[m.SearchDocSortType.LAST_EDITED_NEWEST]:"按创建时间 - 最近到最早",[m.SearchDocSortType.LAST_EDITED_OLDEST]:"按创建时间 - 最早到最近",[m.SearchDocSortType.CREATED_NEWEST]:"按最后编辑时间：最近到最早",[m.SearchDocSortType.CREATED_OLDEST]:"按最后编辑时间：最早到最近"},cDe=e=>{const t=ie(),n=s=>{const a=Object.keys(gk).map(o=>({type:H.OPERATION,data:{sortType:o,title:gk[o],hasArrow:e.sortType===o,arrow:r.jsx(V,{size:"normal",name:"IcCheck02"})}}));t.dropdown({popcorn:s.target,placement:"top",content:({onCloseModal:o})=>r.jsx("div",{className:"next-modal w-[246px] py-1",children:r.jsx(ze,{items:a,onItemClick:(i,l)=>{const c=a[l];c&&(e.onSwitchType(c.data.sortType),o())}})})})};return r.jsxs("div",{className:"ml-[2px] rounded-sm cursor-pointer px-1.5 py-[2px] flex text-t2-medium items-center text-grey3 text-center hover:bg-black_006",onClick:n,children:[r.jsx("div",{children:gk[e.sortType]}),r.jsx(V,{className:"ml-1",name:"IcArrowDown01",size:"tiny"})]})},dDe=e=>r.jsxs("div",{className:R("mx-[15px] flex items-center justify-between text-t2",e.className),children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"text-grey3",children:"排序:"}),r.jsx(cDe,{sortType:e.sortType,onSwitchType:e.onSwitchType})]}),e.showCurrentPageSwitch&&r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"text-t2 text-grey3",children:"在当前页面搜索"}),r.jsx(en,{bgClassName:"ml-2",open:e.searchInCurrentPage,onSwitch:e.onClickSearchInCurrentPage})]})]}),yG=e=>{var d;const t=ie(),n=pt(),s=lt(),a=ye(s,["data"],["segments"]),[o,i]=gS(),{enableAI:l}=xr();if(n||!l)return r.jsx("div",{className:"mt-2"});let c="";return e.keyword?c='问问AI"'.concat(e.keyword,'"'):e.showType==="space"?c="在「".concat(Pn().title,"」中问问AI"):e.showType==="page"?c="在「".concat((d=fe(a==null?void 0:a.data.segments))!=null?d:qt(a==null?void 0:a.type),"」中问问AI"):e.showType==="ai"&&(c='问问AI "知识库"'),r.jsxs("div",{className:R("flex items-center animate-hover",e.className),onClick:()=>{var u;if(t.closeModal(Ve.QUICK_SEARCH),o==="ai-chat"){xn.emit("aiPage",{prompt:(u=e.keyword)!=null?u:"",pageId:e.showType==="page"?s:""});return}me.event("ai-search"),i("ai-chat"),setTimeout(()=>{var f;(e.keyword||e.showType==="page")&&xn.emit("aiPage",{prompt:(f=e.keyword)!=null?f:"",pageId:e.showType==="page"?s:""})},300)},children:[r.jsx(V,{name:"MIcAiMiddleColor",size:"middle"}),r.jsx("div",{className:"text-t2-medium ml-1.5",children:c})]})},_k=new Map,MP=7;var Uv=(e=>(e.normal="normal",e.share="share",e))(Uv||{});const uDe=e=>{const t=mDe(),n=()=>{t(e)};return r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"w-px h-3.5 bg-grey6 flex-shrink-0"}),r.jsx(Fe,{popup:"快速查找文档或文件".concat(Ds,"+P"),className:"p-1 flex justify-center items-center animate-hover",children:r.jsx(V,{size:"middle",name:"IcSearch",onClick:n})})]})},UP={createdBy:[],ancestors:[]},fDe=e=>{const{type:t="normal",inPageId:n,rootPageId:s}=e,a=lt(),o=ye(a,[]),i=Ut(),l=rr(()=>{var h;return new Ai(localStorage,"recently_search".concat(i.uuid).concat((h=o==null?void 0:o.spaceId)!=null?h:Ot()),5)}),[c,d]=y.useState(()=>_k.has("".concat(n))?_k.get("".concat(n)):{searchRecord:l,type:t,view:t==="normal"?"RECENT":"RESULT",keyword:"",recent:[],result:{total:0,items:[],hasMore:!1,pageNo:1},sortType:m.SearchDocSortType.RELEVANCE,showFilter:!1,inPageId:n,rootPageId:s,filter:n?{ancestors:[n]}:UP}),u=y.useCallback((h,p)=>{d(g=>{if(h==="view"&&p==="RESULT"&&!g.keyword)return g;if(t==="share")switch(h){case"showFilter":return g;case"view":if(p==="RECENT")return{...g,view:"RESULT",result:{total:0,items:[],hasMore:!1,pageNo:1}};break}return{...g,[h]:p}})},[t]);y.useEffect(()=>{_k.set("".concat(n),c)},[c,n]),y.useEffect(()=>{const h=()=>{u("searchRecord",l)};return l.addChangeListener(h),()=>{l.removeChangeListener(h)}},[u,l]);const f={RECENT:gDe,RESULT:VP,LOADING:VP,NOT_FOUND:xDe}[c.view];return y.useEffect(()=>{c.showFilter||u("filter",n?{ancestors:[n]}:UP)},[n,a,u,c.showFilter]),y.useEffect(()=>()=>{me.event("search_cancel")},[]),r.jsxs("div",{className:"flex next-modal overflow-x-auto transition-all max-h-[630px] w-[90vw] max-w-[800px]",children:[r.jsxs("div",{className:R(c.showFilter?"w-[calc(100%-220px)]":"w-full"),children:[r.jsx(hDe,{state:c,patch:u}),r.jsx(f,{state:c,patch:u})]}),c.showFilter&&r.jsx(iDe,{defaultFilter:c.filter,onFilterChange:h=>{u("filter",h)}})]})},mDe=()=>{const e=ie();return t=>{me.event("search_click"),e.modal({modalId:Ve.QUICK_SEARCH,center:!1,containerClassName:"!pt-[10vh]",content:()=>r.jsx(fDe,{...t})})}},hDe=e=>{var x;const{state:{keyword:t,view:n,filter:s,sortType:a,type:o,inPageId:i},patch:l}=e,c=pG(),d=y.useRef(null),u=lt(),f=ye(u,["data"],["segments"]),h=pc((x=f==null?void 0:f.spaceId)!=null?x:Ot()),p=y.useRef(!1),g=F=>{F||(l("view","RECENT"),l("showFilter",!1)),l("keyword",F)},_=y.useRef(0);return tc(()=>{if(!t||p.current)return;(async b=>{var T;const w=++_.current,{total:E,results:C,hasMore:k}=await c({space:(T=f==null?void 0:f.spaceId)!=null?T:Ot(),page:1,perPage:10,query:b,source:o==="normal"?"quickFind":"quickFindPublic",sort:a,filters:s});w===_.current&&(C.length>0?(l("result",{total:E,items:C,hasMore:k,pageNo:1}),l("view","RESULT")):(l("result",{total:0,items:[],hasMore:k,pageNo:1}),l("view","NOT_FOUND")),l("showFilter",!0))})(t)},[a,s,t,l,f==null?void 0:f.spaceId,c],{wait:800}),y.useEffect(()=>{t&&l("view","LOADING")},[a,s,t,l]),r.jsx("div",{className:"pt-2.5 mx-2.5 relative",children:r.jsx(Ct,{selection:[0,t.length],onCompositionChange:F=>{p.current=F},inputRef:d,autoFocus:!0,className:"h-8 px-2.5",inputClassName:"pl-1",placeholder:i?"在「".concat(fe(f==null?void 0:f.data.segments)||qt(f==null?void 0:f.type),"」页面搜索"):"在「".concat(h.title,"」中搜索或问问 AI"),value:t,onFocus:()=>me.event("search_box_click"),onChange:F=>g(F),addonBefore:n==="LOADING"?r.jsx($s,{size:"middle",className:"text-grey4"}):r.jsx(V,{size:"middle",className:"text-grey4",name:"IcSearch"}),addonAfter:t&&r.jsx(V,{size:"middle",onClick:()=>{var F;l("showFilter",!1),g(""),(F=d.current)==null||F.focus()},name:"IcUploadCancel",className:"text-grey4"})})})},pDe=({filter:e})=>{const t=[];if(!e)return null;e.isTitleOnly&&t.push("只搜索标题"),e.pagesName&&e.pagesName.length>0&&e.pagesName.forEach((s,a,o)=>{t.push([a===0?"在":"",s,a!==o.length-1?", ":" 中搜索"].join(""))}),e.createdBy&&e.createdBy.length>0&&e.createdBy.forEach((s,a,o)=>{const i=Rn(s);i&&t.push([a===0?"由":"",i,a!==o.length-1?", ":" 创建"])}),e.createdTime&&t.push(["创建于"," ","".concat(ue(e.createdTime.start).format(Et),"-").concat(ue(e.createdTime.start).format(Et))].join("")),e.lastEditedTime&&t.push(["最后编辑于"," ","".concat(ue(e.lastEditedTime.start).format(Et),"-").concat(ue(e.lastEditedTime.start).format(Et))].join(""));let n="";return t.length>0&&(n="- ".concat(t.join("·"))),r.jsx("span",{className:"ml-2 text-t2 text-grey4",children:n})},gDe=e=>{const{state:{recent:t,searchRecord:n,keyword:s,inPageId:a},patch:o}=e,i=lt(),l=ye(i,[]),c=y.useRef(null),d=fh(),u=ln(),f=bG(),h=ys(),p={key:"RECENT_VISIT_TIMESTAMP",get:()=>{var w;return Number((w=localStorage.getItem(p.key))!=null?w:0)},set:w=>ts(p.key,String(w))},g=n.getSortItems(),_=async()=>{var D,A;const w=(D=l==null?void 0:l.spaceId)!=null?D:Ot(),E=p.get(),C=await ve.editor.querySpaceVisitsHistory(w,+E);if(typeof C!="object")return;const{results:k,recordMap:T}=C;if(!k||!T)return;const{blocks:v}=T;if(!v)return;re(Tn.update({blocks:v}));const I=P=>{if(P){const L=v[P];if(L)return L}},j=[];let S=0;for(let P=0;S<MP&&P<k.length;P++){const L=(A=k[P])==null?void 0:A.uuid,O=I(L);O&&j.length<MP&&(S++,j.push(O))}o("recent",j)};y.useEffect(()=>{_()},[]);const x=()=>{me.event("clear_recent_used"),p.set(Date.now()),o("recent",[])},F=w=>{const E=fe(w.data.segments);return E||qt(w.type)},b=(w,E)=>{me.event("recent_used",{page_type:w.type}),w.type===m.BlockType.FILE?(d(w.uuid),u(Ve.QUICK_SEARCH)):(h(w.uuid,{forceOpenInRight:E.forceOpenInRight,forceOpenNewTab:E.forceOpenNewTab}),E.forceOpenNewTab||u(Ve.QUICK_SEARCH))};return t.length===0&&n.length()===0?r.jsx("div",{className:"h-2.5"}):r.jsx("div",{className:"max-h-[600px] overflow-y-auto py-1 transition-all",ref:c,children:r.jsx(Um,{customItem:!0,defaultIndex:0,containerRef:c,listenPriority:dr,itemCount:t.length+n.length(),children:(w,E)=>r.jsxs(r.Fragment,{children:[r.jsx(yG,{showType:a?"page":"space",className:"h-10 px-4 py-1"}),r.jsx("div",{className:"group",children:t.map((C,k)=>r.jsxs("div",{children:[k===0&&r.jsxs("div",{className:"mt-2 mb-1 mx-[15px] flex items-center justify-between text-t2",children:[r.jsx("div",{className:"text-grey3",children:"最近浏览"}),r.jsx("div",{className:"px-2 text-grey4 text-center rounded animate-hover hidden group-hover:block",onClick:x,children:"清除"})]}),r.jsxs("div",{"list-item-custom":"",className:R("py-[9px] flex  mx-2 flex-row animate-hover",{"normal-bg":k===w}),onContextMenu:T=>{f(T,()=>b(C,{forceOpenNewTab:!0}))},onClick:T=>b(C,{forceOpenInRight:T.altKey,forceOpenNewTab:T.ctrlKey||T.metaKey}),onMouseEnter:()=>E(k),children:[r.jsx("div",{className:"ml-2 text-xl leading-none block",children:r.jsx(Fn,{blockId:C.uuid,trigger:!1,defaultIcon:r.jsx(_s,{uuid:C.uuid})})}),r.jsx("div",{className:R("flex flex-col justify-center ml-2 flex-1 max-w-[280px]"),children:r.jsx(j_,{className:"text-t2-medium block",children:F(C)})})]})]},k))}),r.jsx("div",{className:"group",children:g.map((C,k)=>{const T=k+t.length;return r.jsxs("div",{children:[k===0&&r.jsxs("div",{className:"mt-4 mb-1 mx-[15px] flex items-center justify-between text-t2",children:[r.jsx("div",{className:"text-grey3",children:"最近搜索"}),r.jsx("div",{className:"px-2 text-grey4 text-center rounded animate-hover hidden group-hover:block",onClick:()=>{n.clear()},children:"清除"})]}),r.jsxs("div",{"list-item-custom":"",className:R("group-scope py-[9px] flex  mx-2 flex-row animate-hover",{"normal-bg":T===w}),onMouseEnter:()=>E(T),onClick:()=>{o("keyword",C.key),C.value&&o("filter",kn(C.value,"pagesName"))},children:[r.jsx("div",{className:"ml-2 text-xl leading-none block",children:r.jsx(V,{name:"IcSearch",size:"middle"})}),r.jsx("div",{className:"flex flex-col justify-center ml-2 flex-1 text-t2-medium text-ellipsis",children:r.jsxs("span",{children:[C.key,r.jsx(pDe,{filter:C.value})]})}),r.jsx(V,{onClick:v=>{n.delete(C.key),v.stopPropagation()},name:"IcUploadCancel",className:"text-grey4 mr-2 transition-opacity opacity-0 group-scope-hover:opacity-100",size:"middle"})]})]},C.key)})})]})})})},VP=e=>{var I,j;const{state:{searchRecord:t,keyword:n,result:{items:s,hasMore:a,pageNo:o},sortType:i,filter:l,showFilter:c,type:d,rootPageId:u,inPageId:f},patch:h}=e,p=lt(),g=ye(p,[]),_=pG(),[x,F]=y.useState(!1),b=ln(),w=fh(),E=bG(),C=ys(),k=async()=>{var D;const S=(D=g==null?void 0:g.spaceId)!=null?D:Ot();F(!0);try{const{total:A,results:P,hasMore:L}=await _({space:S,page:o+1,perPage:10,sort:i,filters:l,query:n,source:d==="normal"?"quickFind":"quickFindPublic"}),O=[...s];O.push(...P),h("result",{total:A,items:O,hasMore:L,pageNo:o+1})}finally{F(!1)}},T=y.useRef(),v=(S,D)=>{var U,z,K;const A=J.blocks[(U=S.pageId)!=null?U:""];if(!A)return;me.event("search_result_click",{page_type:A.type});const P=J.blocks[S.uuid];let{pageId:L}=S;const{uuid:O}=S;let $=O;if((P==null?void 0:P.type)===m.BlockType.TABLE_ROW)$=P.parentId;else if(A.type===m.BlockType.FILE)w(A.uuid),b(Ve.QUICK_SEARCH);else if(S.pageId===S.uuid)$="";else{let W=A.uuid;const Y=ks(S.uuid);Y&&((z=J.blocks[Y])==null?void 0:z.type)===m.BlockType.MIND_MAPPING&&(W=Y),L=W}L&&C(L,{forceOpenInRight:D.forceOpenInRight,forceOpenNewTab:D.forceOpenNewTab,hash:$?"#".concat($):void 0}),b(Ve.QUICK_SEARCH);const M=(K=l==null?void 0:l.ancestors)==null?void 0:K.map(W=>{const Y=J.blocks[W],G=fe(Y==null?void 0:Y.data.segments);return G||qt(Y==null?void 0:Y.type)});t.put(n,{...l,pagesName:M})};return r.jsxs(r.Fragment,{children:[r.jsx(yG,{showType:f?"page":"space",className:"h-10 px-4 py-1 mt-2",keyword:n}),s.length>0&&r.jsx(dDe,{showCurrentPageSwitch:d==="share"&&p!==u,searchInCurrentPage:((I=l.ancestors)==null?void 0:I.length)===1&&((j=l.ancestors)==null?void 0:j[0])===p,onClickSearchInCurrentPage:S=>{S?h("filter",{...l,ancestors:[p]}):u&&h("filter",{...l,ancestors:[u]})},onShowFilter:()=>{h("showFilter",!0)},showFilter:c,sortType:i,onSwitchType:S=>{h("sortType",S)}}),r.jsxs("div",{ref:T,className:"max-h-[530px] overflow-y-auto pb-2 transition-all",children:[r.jsx(xd,{pageStart:1,initialLoad:!1,useWindow:!1,loadMore:k,getScrollParent:()=>T.current,hasMore:a,children:r.jsx(Um,{customItem:!0,defaultIndex:-1,containerRef:T,itemCount:s.length,children:S=>s.map((D,A)=>r.jsx(_De,{active:A===S,item:D,keyword:n,onClick:P=>{v(D,{forceOpenNewTab:P.metaKey||P.ctrlKey,forceOpenInRight:P.altKey})},onContextMenu:P=>{E(P,()=>v(D,{forceOpenNewTab:!0}))}},A))})}),x&&r.jsx("div",{className:"w-full flex justify-center",children:r.jsx($s,{size:"large"})})]})]})},_De=e=>{var l;const{item:t,active:n,keyword:s}=e,a=ye((l=t.pageId)!=null?l:"",["data"],["segments"]);if(!a)return null;const o=()=>{const c=fe(a.data.segments);return c||qt(a.type)},i=t.uuid===t.pageId;return r.jsxs("div",{"list-item-custom":"",className:R("py-[9px] flex flex-row animate-hover mx-2 rounded",{"normal-bg":n}),onContextMenu:e.onContextMenu,onClick:e.onClick,children:[r.jsx("div",{className:"ml-[15px] text-xl leading-none block",children:r.jsx(Fn,{blockId:a.uuid,trigger:!1,defaultIcon:r.jsx(_s,{uuid:a.uuid})})}),r.jsxs("div",{className:R("ml-2 overflow-hidden",!t.navs.length&&"flex flex-col justify-center"),children:[r.jsx(j_,{className:"text-t2 block",children:i?r.jsx(X1,{text:o(),search:s,className:"text-t2-medium"}):r.jsx("div",{className:"text-t2-medium",children:o()})}),r.jsx("div",{className:"mt-[2px] text-t4 text-grey3",hidden:!t.navs.length,children:r.jsx(x0,{navs:t.navs})}),!i&&r.jsx(hQ,{limitLen:50,text:t.hitText,search:s,className:"text-t2-medium",containerClassName:"text-ellipsis"})]})]},a.uuid)},xDe=()=>r.jsx("div",{className:"py-5 text-t2 text-grey4 text-center leading-[22px]",children:"无相关页面"}),bG=()=>{const e=ie();return y.useCallback((t,n)=>{e.dropdown({placement:"bottom-start",offset:[4,4],popcorn:_m(t),content:()=>r.jsx("div",{className:"next-modal w-[240px]",onClick:n,children:r.jsx("div",{className:"animate-hover rounded flex items-center p-2 cursor-pointer justify-between",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(V,{name:"IcMenuOpenNew",size:"middle"}),r.jsx("div",{className:"text-t2 ml-2",children:"新窗口打开"})]})})})})},[e])},yDe=()=>{const e=sE(),t=lt(),n=ye(t,["createdBy"]),s=Ut(),a=!!s.uuid,{allowSubscribe:o}=mt(t),[i,l]=gm({getApi:()=>ve.infra.getSubscribeStatus(t),defaultValue:!1,enable:a}),c=HE(t),d=y.useRef(null),u=ie(),f=kz({localKey:Qm.SUBSCRIBE_TIP,endDay:0});return y.useEffect(()=>{if(!a)return;new URLSearchParams(location.search).has("subscribe_popup")&&f(d,{content:"本文开启了订阅功能,点击即可订阅"})},[a,f]),y.useEffect(()=>{a&&l()},[t]),o?r.jsxs(r.Fragment,{children:[r.jsx(bDe,{}),r.jsx(De,{colorType:i?"active":"secondary",className:"text-t2-medium flex-shrink-0",onClick:async()=>{var p;if(!a){e();return}const h=(p=nT(t))!=null?p:t;await nB({targetId:h,subscribed:!i,addSubscribe:ve.infra.addSubscribe,cancelSubscribe:ve.infra.cancelSubscribe,user:s,openDialog:u.warning,callback:g=>g&&location.reload()},{pageId:t,needPay:c,userId:xa().uuid,createdBy:n==null?void 0:n.createdBy,spaceId:n==null?void 0:n.spaceId,event:me.event}),l()},children:r.jsx("span",{ref:d,children:i?"订阅中":"订阅"})})]}):null},bDe=()=>{const e=lt(),t=Qge(e);return r.jsx(r.Fragment,{children:r.jsx(De,{className:"relative overflow-visible",onClick:t,children:r.jsx("span",{children:"分享"})})})},FG=y.memo(e=>{const{emptyStyle:t}=e,n=lt(),s=We(n),a=Jm(n),o=tG(n),i=ye(n,["isTemplate"]),l=iee(),c=Ln(),d=S3(),u=Sg(),f=Xq(),h=HE(n),{role:p,illegal:g,allowDuplicate:_,allowShowBreadcrumb:x,allowShowSidebar:F,allowSubscribe:b,shared:w}=mt(n),E=g||d,C=pt(),k=uf(n),T=Qq(n),v=yw(),I=rx(),j=ax&&!I,S=Ce(P=>{let L=P.blocks[n],O=L;for(;L;){const $=P.blocks[L.parentId];if($!=null&&$.permissions.some(M=>M.shareShowSidebar)&&(O=$),$&&$.type!=="SPACE"){L=$;continue}break}return O==null?void 0:O.uuid},[n]),D=y.useMemo(()=>h?null:r.jsxs(r.Fragment,{children:[C&&!g&&b&&r.jsx(yDe,{}),r.jsx(G4e,{}),C&&!g&&_&&!k&&r.jsx(Fe,{popup:"拷贝到",className:"animate-click animate-hover",onClick:()=>{me.event("copytomyspace",{page_id:n}),u(n,{addCopyLimit:!0})},children:r.jsx(V,{size:"middle",name:"IcCopy"})}),!g&&(p===m.PermissionRole.WRITER||p===m.PermissionRole.EDITOR)&&r.jsx(mG,{})]}),[_,b,u,g,h,C,k,n,p]),A=y.useMemo(()=>{if(ot.print)return null;const P=C&&!x;let L=null;return i&&!((a==null?void 0:a.tag)==="NO_PERMISSION"||p===m.PermissionRole.NONE)||E?L=r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex overflow-hidden",children:[C&&r.jsx(VF,{showInSharePage:F}),C&&r.jsxs(r.Fragment,{children:[r.jsx(M4e,{Component1:aDe,Component2:Bg}),r.jsx("div",{className:"self-center ml-2 h-3 w-px bg-grey3"})]}),!T&&r.jsx(W4,{showHistoryButton:!C,ancestorId:Cb?qZ():P?n:void 0}),!C&&r.jsx(cS,{uuid:n})]}),(i&&[m.BlockType.PAGE,m.BlockType.FOLDER,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.REFERENCE_COLLECTION,m.BlockType.REFERENCE_COLLECTION_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE].includes(i.type)&&!c||E)&&!Cb&&r.jsx("div",{className:"relative flex items-center justify-end h-full flex-shrink-0",children:r.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[o&&!0&&C&&r.jsxs("p",{className:"text-grey4 text-t4 flex items-center",children:[r.jsx(V,{name:"IcNote",size:"middle"}),r.jsx("span",{children:"页面可能含有 AI 生成内容"})]}),r.jsx(FDe,{}),!s&&r.jsx($4e,{className:"px-2.5 flex-1 overflow-x-auto"},n),w&&b&&Xn(p,m.PermissionRole.EDITOR)&&r.jsx(U4e,{uuid:n}),!C&&!E&&!k&&r.jsx(tx,{showType:"button"}),D,!g&&(p===m.PermissionRole.WRITER||p===m.PermissionRole.EDITOR)&&r.jsx(hG,{}),!C&&!s&&!g&&r.jsx(KE,{uuid:n}),r.jsx(fG,{}),!T&&r.jsx(uDe,{type:C?Uv.share:Uv.normal,inPageId:n,rootPageId:C?S:void 0}),r.jsx(nG,{})]})})]}):L=r.jsx(wDe,{}),t&&(L=r.jsx(EDe,{})),L},[T,x,F,b,i,t,o,g,E,c,C,k,D,n,a==null?void 0:a.tag,s,p,S,w]);return ot.print||ot.blog?null:r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex w-full select-none",children:!ot.embed&&r.jsx("div",{className:R("flex justify-between items-center w-full px-4 bg-white1 transition-all border-b border-transparent",l?"duration-500 opacity-0":"duration-100 opacity-100",j&&v&&"pl-20",j&&!v&&"pl-4",j&&"drag-container",f&&!Yq(f)&&"border-grey6"),style:{height:Jq},children:A})}),r.jsx(sDe,{})]})}),FDe=()=>{const e=ie(),t=xw(),n=lee(),s=u9(),a=I3(),o=()=>{e.warning({title:"重置网络状态",content:r.jsxs("div",{className:"text-left",children:[r.jsx("p",{className:"mb-2",children:"  操作系统可能会误判网络状态，如果你的网络正常，点“确定”可以重置网络状态。"}),r.jsx("p",{children:"  如果重置后还是会复现，可以按此步骤切换网络状态"})]}),confirm:()=>{Ta.setStatus("online")},confirmText:"确定",cancelText:"取消"})};return s.backup?r.jsx(Fe,{popup:r.jsxs(r.Fragment,{children:["你的本地修改多次同步失败。请",r.jsx("strong",{children:"*备份*"}),"文档内容并尝试",r.jsx("strong",{children:"*刷新*"}),"页面。在同步恢复之前，你将无法继续编辑"]}),children:r.jsxs("span",{className:"inline-flex text-t2 px-3 py-1 rounded items-center text-white bg-red",children:[r.jsx(V,{className:"mr-1",name:"IcBadgeDanger",size:"middle"}),r.jsx("span",{children:"保存失败"})]})}):t?n?r.jsx(Fe,{className:"animate-click",popup:r.jsx("div",{children:"🤔 网络一切正常？点击立即恢复"}),onClick:o,children:r.jsxs("span",{className:"inline-flex text-t2 px-3 py-1 rounded items-center text-white bg-red",children:[r.jsx(V,{className:"mr-1",name:"IcTitleOffline",size:"middle"}),r.jsx("span",{children:"网络故障"})]})}):r.jsx(Fe,{className:"animate-click",popup:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{children:"离线中"}),r.jsx("p",{children:"🤔 网络一切正常？点击立即恢复"})]}),onClick:o,children:r.jsx(V,{className:"text-grey4",name:"IcTitleOffline",size:"middle"})}):n&&!a?r.jsx(Fe,{popup:"同步中",children:r.jsx(V,{className:"text-grey4 animate-spin",name:"IcRefresh",size:"middle"})}):null},wDe=()=>{const e=We(),t=lt(),n=Jm(t),s=pt();let a=null;return e||(n==null?void 0:n.tag)==="NO_PERMISSION"?s?a=r.jsx(Bg,{className:"sm:hidden"}):a=r.jsxs("div",{className:"flex items-center",children:[r.jsx(VF,{}),r.jsx(UF,{})]}):a=r.jsxs("div",{className:"flex items-center",children:[r.jsx(VF,{}),r.jsx(UF,{})]}),a},EDe=()=>r.jsxs(r.Fragment,{children:[r.jsx(UF,{}),r.jsx(Bg,{className:"sm:hidden"}),r.jsx(nG,{})]});e2e(FG);const CDe=6,kDe=()=>{const e=ie(),t=Ut(),n=ug();return r.jsxs("div",{className:"relative flex flex-col items-center justify-center h-screen space-y-5 bg-white2",children:[r.jsx(Fl,{user:t,className:"w-40 h-40"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(IB,{className:"h-8",size:CDe,placeholder:"输入 PIN 码解锁",showSwitchIcon:!1,success:s=>{I_.MD5(s).toString()===t.setting.pin?L4e({enable:!1}):be.error("PIN 码不正确")}}),r.jsxs(Cs,{placement:"right",popup:"可通过重新登录进入",onClick:()=>{e.warning({title:"忘记 PIN 码，可重新登录解锁",confirmText:"重新登录",confirm(){n()}})},className:"flex items-center justify-end text-t4 text-grey3 animate-click space-x-0.5",children:[r.jsx("span",{children:"忘记密码"}),r.jsx(V,{name:"IcInviteHelp",size:"small"})]})]}),r.jsx(Bg,{className:"absolute bottom-10"})]})},{PageOfflineEmpty:TDe}=Qn(()=>Pe(()=>import("./page-offline-empty-46f1efc4.js"),["assets/page-offline-empty-46f1efc4.js","assets/vendor-2890c4d6.js"])),{LoginWrapper:vDe}=Qn(()=>Pe(()=>import("./index-ea4f40c1.js"),["assets/index-ea4f40c1.js","assets/vendor-2890c4d6.js","assets/avatar-3c2baad9.js"])),{Create:IDe}=Qn(()=>Pe(()=>import("./create-44ca7545.js"),["assets/create-44ca7545.js","assets/vendor-2890c4d6.js"])),{FilePreviewPage:NDe}=Qn(()=>Pe(()=>import("./index-2eefdae0.js"),["assets/index-2eefdae0.js","assets/vendor-2890c4d6.js","assets/use-fetch-ai-config-c917d778.js","assets/index-c4474c11.js"])),{SharePage:jDe}=Qn(()=>Pe(()=>import("./index-58bab18b.js").then(e=>e.l),["assets/index-58bab18b.js","assets/vendor-2890c4d6.js","assets/index-c4474c11.js"])),{SubscribePage:SDe}=Qn(()=>Pe(()=>import("./index-ab3bf6d5.js"),["assets/index-ab3bf6d5.js","assets/vendor-2890c4d6.js","assets/index-58bab18b.js","assets/index-c4474c11.js"])),{Home:$P}=Qn(()=>Pe(()=>import("./home-5b59fb2b.js"),["assets/home-5b59fb2b.js","assets/vendor-2890c4d6.js","assets/use-fetch-ai-config-c917d778.js","assets/index-58bab18b.js","assets/index-c4474c11.js","assets/page-offline-empty-46f1efc4.js"])),{ShareFormPage:DDe}=Qn(()=>Pe(()=>import("./form-147d8cd1.js"),["assets/form-147d8cd1.js","assets/vendor-2890c4d6.js"])),{Callback:ADe}=Qn(()=>Pe(()=>import("./index-657e6eb9.js"),["assets/index-657e6eb9.js","assets/vendor-2890c4d6.js"])),{Notion:RDe}=Qn(()=>Pe(()=>import("./notion-642d4471.js"),["assets/notion-642d4471.js","assets/vendor-2890c4d6.js"])),{UpgradePage:PDe}=Qn(()=>Pe(()=>import("./index-61957fae.js"),["assets/index-61957fae.js","assets/vendor-2890c4d6.js"])),LDe=({children:e})=>r.jsx(y.StrictMode,{children:r.jsx(bY,{children:r.jsx(z1,{store:K3,children:r.jsx(yd,{children:r.jsx(Og,{children:r.jsx(Oo,{children:r.jsx(p4e,{children:e})})})})})})}),BDe=()=>{const e=ree(),[,t]=y.useState();return y.useEffect(()=>{e&&t(()=>{throw new Error(e)})},[e]),r.jsxs(FY,{children:[r.jsx(zi,{path:"/preview/:blockId?",component:NDe}),r.jsx(zi,{path:"/callback",component:ADe}),r.jsx(zi,{path:"/notion",component:RDe}),r.jsx(zi,{path:"/form",component:DDe}),r.jsx(zi,{path:"/login",component:vDe}),r.jsx(zi,{path:"/create",component:IDe}),r.jsx(zi,{path:"/upgrade",component:PDe}),r.jsx(zi,{path:["/subscribe/share","/subscribe/share/:blockId"],component:SDe}),r.jsx(zi,{path:["/share/:blockId","/:domain/share/:blockId"],component:jDe}),r.jsx(zi,{path:"/",component:$P}),r.jsx(zi,{path:["/:domain/:blockId","/:blockId?"],component:$P})]})},ODe=({children:e})=>{O4e(),w4e(),I4e(),EFe(),Cre(),kre(),k4e(),P4e(),E4e(),C4e();const t=xw(),n=v4e(),s=Yw(),a=ns(),[o,i]=y.useState(!0),l=_S(),c=eee(),d=B4e();y.useEffect(()=>{if(location.pathname==="/"&&Eu()){i(!1);return}if(!Qr(Nt.login)&&!Qr(Nt.callback)){const f=()=>{i(!1);const h=xa().uuid;h&&tX(h)};if(gs.check)n().finally(f);else{const h=location.pathname!==Nt.main;n(h).finally(f)}}else i(!1)},[n]),y.useEffect(()=>{me.event("predefinePageView")},[]),y.useEffect(()=>{setInterval(()=>{const f=Us(Date.now());xt.$today!==f&&st({$today:f})},30*60*1e3)},[]),y.useEffect(()=>{const f=h=>(h.type==="offline"?fetch("".concat(Lo,"gen_204"),{cache:"no-cache"}).then(()=>{Ta.setStatus("online")}).catch(()=>{navigator.onLine?Ta.setStatus("online"):Ta.setStatus("offline")}):Ta.setStatus("online"),h.type!=="offline"&&xt.$firstLoadPage&&location.reload(),!0);return Ht.addEventListener("online",f),Ht.addEventListener("offline",f),()=>{Ht.removeEventListener("online",f),Ht.removeEventListener("offline",f)}}),y.useEffect(()=>{const f=()=>{s==null||s(),re(at.updateSelectBlocks([])),l(!1),Hxe()},h=a.block((p,g)=>{var F,b,w,E;const _=p.pathname.slice(-36);if(!Wc(_))return;pD.lastPageId=(F=Cd(p.search))!=null?F:pD.lastPageId;const x=(E=Td[(w=(b=J.blocks[_])==null?void 0:b.spaceId)!=null?w:""])==null?void 0:E.domain;if(!Eu()&&x&&!p.pathname.startsWith("/".concat(x))){const C=g==="PUSH"?a.push:a.replace;return Qr(Nt.preview,"startsWith",p.pathname)||Qr(Nt.subscribe,"startsWith",p.pathname)?void 0:Qr(Nt.share,"startsWith",p.pathname)?(C("/".concat(x).concat(Nt.share).concat(_).concat(p.search).concat(p.hash)),!1):(C("/".concat(x,"/").concat(_).concat(p.search).concat(p.hash)),!1)}Xl.tmpDisable||(Xl.lastGoBackPath=g==="POP"?p.pathname:""),f()});return d&&f(),h},[d,a,s,l]);const u=y.useMemo(()=>d?r.jsx(kDe,{}):t&&c?r.jsxs(r.Fragment,{children:[r.jsx(FG,{}),r.jsx(TDe,{})]}):o?r.jsx(xs,{fixed:!0}):e,[e,c,o,t,d]);return r.jsxs(r.Fragment,{children:[gs.check&&!q1&&r.jsx("div",{className:"drag-container fixed w-full top-0 h-3.5 z-[8848]"}),r.jsx(b4e,{children:u})]})},MDe=()=>null;jve(Zz);OL();const UDe=ot.print;UDe&&ot.token&&ot.sig&&ot.userId&&(tm.set("next_auth",ot.token),tm.set("next_auth.sig",ot.sig),ts(s1,ot.userId));const VDe=()=>{if(location.pathname===Nt.main&&Eu())return!0},$De=async()=>{if(location.pathname===Nt.main)return gs.check||xb()?!1:(tI("".concat(_n()).concat(Nt.product).concat(location.search).concat(location.hash)),!0)},HDe=()=>{const{search:e,hash:t}=location,n=Nt.share,s=location.pathname.indexOf(n);if(s===-1)return;if(location.pathname.slice(s+n.length).length>36){const o=location.pathname.slice(0,s+n.length+36);return tI("".concat(o).concat(e).concat(t)),!0}},HP=()=>{Ls.render(r.jsx(LDe,{children:r.jsxs(ODe,{children:[r.jsx(BDe,{}),r.jsx(MDe,{})]})}),document.getElementById("root"))},zDe=()=>{LL()},qDe=()=>{if(!location.pathname.startsWith(QY))return;const e=new URLSearchParams(location.search),t=e.get(YY),n=e.get(XY);if(t&&n)return window.parent.postMessage({code:t,state:n}),!0};OL();IY({isBuildIn:!1,cdnHost:Lo});Aq();const zP="flowus";Fs.config({version:1,name:zP,storeName:zP,size:4980736});const GDe=async()=>{if(IQ())return;if(TCe(),qY(),zDe(),VDe()){HP();return}if(qDe())return;const t=eg();let n;!t&&(n=HDe(),n||(n=await $De(),n))||(LL(),HP())};GDe();{const e="production";wY({dsn:"https://1cc4406cb8a38b141a2fab1f100ec022@sentry.allflow.cn:443/5",autoSessionTracking:!0,tracesSampleRate:.5,ignoreErrors:["ResizeObserver loop limit exceeded","ResizeObserver loop completed with undelivered notifications.","Unexpected token '<'"],integrations:[EY(),CY()],environment:e,replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1,release:"582aec734b7f0b024b82d1a8b60184f8ae9ec2c7",beforeSend(t){const n=xa();return t.user={id:n.uuid,username:n.nickname},t}})}export{H9 as $,G9 as A,D2 as B,R as C,V as D,St as E,Nd as F,ie as G,ln as H,Wb as I,Ut as J,Y3 as K,cle as L,PAe as M,bT as N,Gs as O,JI as P,vn as Q,De as R,dn as S,Hs as T,s1 as U,tAe as V,Ct as W,_n as X,gp as Y,xa as Z,me as _,KDe as __vite_legacy_guard,vk as a,Ste as a$,sw as a0,Kp as a1,Xt as a2,ze as a3,H as a4,hc as a5,xr as a6,r9 as a7,G_e as a8,is as a9,Ja as aA,$w as aB,hn as aC,FG as aD,PH as aE,UB as aF,yt as aG,Ot as aH,lRe as aI,Sg as aJ,uw as aK,Xf as aL,mw as aM,t2e as aN,Mo as aO,wt as aP,S3 as aQ,mRe as aR,QI as aS,vAe as aT,II as aU,Db as aV,pe as aW,Sn as aX,Td as aY,qk as aZ,Pte as a_,$s as aa,pv as ab,N0 as ac,G3 as ad,lt as ae,Dt as af,ye as ag,A4 as ah,Y1 as ai,fe as aj,ot as ak,Fe as al,As as am,Ir as an,yAe as ao,re as ap,Tn as aq,st as ar,r2 as as,Dn as at,J as au,mt as av,Jm as aw,XO as ax,jd as ay,g0 as az,zo as b,Js as b$,Ib as b0,L0 as b1,k2 as b2,Qq as b3,o1 as b4,Fg as b5,ule as b6,Og as b7,mo as b8,Pn as b9,UN as bA,Jc as bB,Ri as bC,dI as bD,Bm as bE,YV as bF,ga as bG,$Ae as bH,Of as bI,sl as bJ,vD as bK,Om as bL,xne as bM,fne as bN,E5 as bO,oC as bP,xt as bQ,Nne as bR,at as bS,wne as bT,yne as bU,CU as bV,ID as bW,BAe as bX,VAe as bY,il as bZ,Ig as b_,dm as ba,yp as bb,bp as bc,kl as bd,Oe as be,Ss as bf,jE as bg,_e as bh,Io as bi,Jj as bj,Hu as bk,Zd as bl,tn as bm,U3 as bn,Tr as bo,r0 as bp,RAe as bq,_Ae as br,mn as bs,xI as bt,wi as bu,Fne as bv,HAe as bw,uI as bx,lr as by,zAe as bz,rw as c,xc as c$,_g as c0,Nl as c1,yue as c2,GE as c3,Lb as c4,Vi as c5,Tne as c6,No as c7,pne as c8,Bu as c9,MAe as cA,bne as cB,bn as cC,RV as cD,Id as cE,lF as cF,ls as cG,yse as cH,wAe as cI,XAe as cJ,xw as cK,bAe as cL,s9 as cM,x9 as cN,Vo as cO,uc as cP,NI as cQ,bg as cR,pz as cS,nse as cT,eee as cU,Qa as cV,n9 as cW,nRe as cX,pt as cY,yRe as cZ,DAe as c_,kF as ca,Je as cb,ct as cc,Uo as cd,ft as ce,Tl as cf,_ne as cg,BF as ch,ir as ci,y0 as cj,UAe as ck,cne as cl,rh as cm,Hj as cn,Ln as co,CAe as cp,rg as cq,Ce as cr,Ht as cs,wB as ct,u9 as cu,Ve as cv,xn as cw,vu as cx,ai as cy,Ho as cz,Bg as d,Hbe as d$,RO as d0,zne as d1,rne as d2,bI as d3,j5 as d4,tp as d5,_4e as d6,YAe as d7,Eu as d8,sRe as d9,i3 as dA,gm as dB,fo as dC,ar as dD,Jq as dE,bDe as dF,hN as dG,sE as dH,io as dI,bU as dJ,PO as dK,nT as dL,nB as dM,Cn as dN,K1 as dO,jAe as dP,ya as dQ,Eae as dR,Mt as dS,jRe as dT,tN as dU,j0 as dV,Kne as dW,gAe as dX,lg as dY,mne as dZ,ra as d_,wZ as da,Zp as db,Ca as dc,x4e as dd,dM as de,fs as df,rn as dg,Vs as dh,Jt as di,pye as dj,l_ as dk,xRe as dl,_Re as dm,us as dn,NZ as dp,FB as dq,S0 as dr,fAe as ds,dte as dt,wd as du,_Z as dv,qo as dw,cr as dx,Yge as dy,lse as dz,iAe as e,hRe as e$,g4e as e0,eI as e1,gr as e2,wRe as e3,hje as e4,o3 as e5,QDe as e6,Kt as e7,qbe as e8,_S as e9,m0 as eA,NAe as eB,SU as eC,mN as eD,Yf as eE,By as eF,Bne as eG,due as eH,aRe as eI,Yl as eJ,NCe as eK,GV as eL,Rg as eM,dRe as eN,jD as eO,Xa as eP,vRe as eQ,IRe as eR,kRe as eS,ICe as eT,mr as eU,Oae as eV,TRe as eW,Z8 as eX,iRe as eY,NRe as eZ,tRe as e_,_o as ea,pm as eb,Et as ec,JL as ed,LAe as ee,U$ as ef,In as eg,FRe as eh,du as ei,Ya as ej,Ad as ek,MT as el,VU as em,ZAe as en,eRe as eo,ks as ep,N4e as eq,j4e as er,Qh as es,ARe as et,SAe as eu,Un as ev,FAe as ew,I3 as ex,gS as ey,Pw as ez,dle as f,$u as f$,j1 as f0,fd as f1,t2 as f2,TZ as f3,oRe as f4,ut as f5,gn as f6,SE as f7,Rs as f8,o7 as f9,aj as fA,gRe as fB,jm as fC,U0 as fD,ml as fE,Ei as fF,Wa as fG,Oh as fH,z3 as fI,WAe as fJ,pRe as fK,Co as fL,Rp as fM,Kd as fN,Ns as fO,om as fP,uRe as fQ,oxe as fR,B1e as fS,a4 as fT,Dwe as fU,hke as fV,uh as fW,EZ as fX,pke as fY,_m as fZ,PV as f_,Cue as fa,QV as fb,kU as fc,bRe as fd,ht as fe,gue as ff,vr as fg,NE as fh,A2e as fi,nr as fj,Ene as fk,sr as fl,g1 as fm,Sa as fn,x1 as fo,oB as fp,Ze as fq,OA as fr,mg as fs,Lm as ft,rj as fu,jye as fv,Sye as fw,Z1 as fx,Qr as fy,v3 as fz,woe as g,Uk as g$,qAe as g0,x3 as g1,IZ as g2,xO as g3,L4e as g4,tfe as g5,Une as g6,jne as g7,xre as g8,A0 as g9,Ta as gA,Uv as gB,nx as gC,_r as gD,Ip as gE,FQ as gF,vt as gG,qS as gH,EM as gI,Jne as gJ,fh as gK,qt as gL,Fn as gM,_s as gN,j_ as gO,X1 as gP,Ts as gQ,x0 as gR,PU as gS,O5 as gT,px as gU,K0e as gV,hx as gW,rRe as gX,qq as gY,Ys as gZ,fp as g_,Nu as ga,Lr as gb,pw as gc,JZ as gd,YZ as ge,ys as gf,Cd as gg,pD as gh,Pd as gi,Gxe as gj,Ez as gk,ff as gl,FH as gm,w4 as gn,mDe as go,Y2e as gp,Q2e as gq,fke as gr,X2e as gs,Ui as gt,GAe as gu,w5 as gv,Nw as gw,cg as gx,it as gy,ho as gz,Er as h,RRe as h$,pAe as h0,Rn as h1,Po as h2,DZ as h3,TAe as h4,kAe as h5,rx as h6,q_e as h7,SRe as h8,ax as h9,Ds as hA,Ra as hB,nC as hC,yz as hD,Cs as hE,Qm as hF,mAe as hG,PRe as hH,m4 as hI,Zre as hJ,lo as hK,wl as hL,pG as hM,Mm as hN,hQ as hO,S4 as hP,ERe as hQ,CRe as hR,BR as hS,cRe as hT,Xw as hU,YB as hV,BZ as hW,Noe as hX,Xq as hY,t9 as hZ,BRe as h_,Rb as ha,dg as hb,br as hc,jP as hd,Zo as he,Cr as hf,YL as hg,Yp as hh,Pi as hi,co as hj,F3 as hk,IAe as hl,W4 as hm,lSe as hn,$Se as ho,go as hp,yl as hq,si as hr,Xm as hs,On as ht,Lj as hu,un as hv,rr as hw,_B as hx,cSe as hy,xh as hz,gs as i,xb as i$,I4 as i0,yw as i1,fRe as i2,yn as i3,gw as i4,od as i5,Oo as i6,CCe as i7,Qre as i8,GB as i9,Yg as iA,rd as iB,Qz as iC,iM as iD,pc as iE,L3 as iF,Uw as iG,dN as iH,Ws as iI,Goe as iJ,sT as iK,A2 as iL,UL as iM,la as iN,U1 as iO,aAe as iP,oAe as iQ,Ix as iR,ZDe as iS,eAe as iT,iNe as iU,ML as iV,lAe as iW,DRe as iX,QY as iY,EQ as iZ,rAe as i_,jU as ia,LL as ib,qY as ic,Y9 as id,b9 as ie,gc as ig,X4e as ih,iye as ii,OAe as ij,KAe as ik,J4e as il,P_e as im,EAe as io,We as ip,QZ as iq,eE as ir,LRe as is,j3 as it,tF as iu,hne as iv,Sb as iw,Yz as ix,VB as iy,Vz as iz,xs as j,sAe as j0,Ik as j1,ca as j2,qf as j3,eX as j4,GIe as j5,Na as k,Zt as l,wu as m,nAe as n,vw as o,ds as p,T4e as q,GY as r,ts as s,ve as t,R0 as u,be as v,es as w,Nt as x,r1 as y,p0 as z};
//# sourceMappingURL=index-78ca7972.js.map
